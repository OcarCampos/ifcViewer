import{L as Vt,V as M,a as Ot,P as Qe,T as $e,S as as,B as vt,b as Ut,G as vo,M as ht,I as Pe,C as Rt,c as it,d as Kt,F as qa,e as Er,f as xi,E as $f,g as Zg,R as qg,h as Qg,D as Ps,i as rn,j as Ny,A as Py,k as Mo,O as cs,l as hr,m as Kg,n as Ly,o as Do,Q as Ce,p as My,q as Ss,r as Ue,s as fi,t as kt,u as ki,v as Uo,w as qe,x as Xt,y as ws,z as Jg,W as Qa,H as ts,J as Cr,K as ur,N as Qt,U as Dy,X as Zs,Y as tE,Z as eE,_ as $d,$ as U_,a0 as B_,a1 as k_,a2 as Wd,a3 as iE,a4 as V_,a5 as ol,a6 as bn,a7 as z_,a8 as Y_,a9 as G_,aa as H_,ab as $_,ac as v0,ad as W_,ae as j_,af as X_,ag as Uy,ah as Z_,ai as q_,aj as Q_,ak as cI,al as ka,am as K_,an as J_,ao as tF,ap as al}from"./three-BN-2HLNt.js";import{I as is,a as Wf,b as Ii,H as _e,c as pi,d as on,e as ei,f as By,g as xr,h as bc,i as Tc,j as yc,k as vc,l as Rc,m as Nr,n as Ac,o as Sc,p as wc,q as _c,r as Fc,s as Oc,t as xc,S as ky,u as Vy,v as Ks,L as zy,F as Yy,w as Gy,x as Bo,y as Nc,z as Pc,A as ko,B as Me,C as Vi,D as Hy,E as $y,G as ff,J as pf,K as sE,M as Wy,N as jy,O as Xy,P as Zy,R as eF,Q as qy,T as iF,U as sF,V as Qy,W as Ky,X as nF}from"./web-ifc-DEYh0wF5.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();var rF=Object.defineProperty,oF=(r,t,e)=>t in r?rF(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,$r=(r,t,e)=>(oF(r,typeof t!="symbol"?t+"":t,e),e);const Ka=Math.min,An=Math.max,mf=Math.round,br=r=>({x:r,y:r}),aF={left:"right",right:"left",bottom:"top",top:"bottom"},cF={start:"end",end:"start"};function R0(r,t,e){return An(r,Ka(t,e))}function Hh(r,t){return typeof r=="function"?r(t):r}function Pn(r){return r.split("-")[0]}function jf(r){return r.split("-")[1]}function Jy(r){return r==="x"?"y":"x"}function t1(r){return r==="y"?"height":"width"}function Ro(r){return["top","bottom"].includes(Pn(r))?"y":"x"}function e1(r){return Jy(Ro(r))}function lF(r,t,e){e===void 0&&(e=!1);const i=jf(r),s=e1(r),n=t1(s);let o=s==="x"?i===(e?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[n]>t.floating[n]&&(o=If(o)),[o,If(o)]}function hF(r){const t=If(r);return[lI(r),t,lI(t)]}function lI(r){return r.replace(/start|end/g,t=>cF[t])}function uF(r,t,e){const i=["left","right"],s=["right","left"],n=["top","bottom"],o=["bottom","top"];switch(r){case"top":case"bottom":return e?t?s:i:t?i:s;case"left":case"right":return t?n:o;default:return[]}}function dF(r,t,e,i){const s=jf(r);let n=uF(Pn(r),e==="start",i);return s&&(n=n.map(o=>o+"-"+s),t&&(n=n.concat(n.map(lI)))),n}function If(r){return r.replace(/left|right|bottom|top/g,t=>aF[t])}function fF(r){return{top:0,right:0,bottom:0,left:0,...r}}function i1(r){return typeof r!="number"?fF(r):{top:r,right:r,bottom:r,left:r}}function Ja(r){const{x:t,y:e,width:i,height:s}=r;return{width:i,height:s,top:e,left:t,right:t+i,bottom:e+s,x:t,y:e}}function A0(r,t,e){let{reference:i,floating:s}=r;const n=Ro(t),o=e1(t),a=t1(o),c=Pn(t),l=n==="y",h=i.x+i.width/2-s.width/2,u=i.y+i.height/2-s.height/2,d=i[a]/2-s[a]/2;let f;switch(c){case"top":f={x:h,y:i.y-s.height};break;case"bottom":f={x:h,y:i.y+i.height};break;case"right":f={x:i.x+i.width,y:u};break;case"left":f={x:i.x-s.width,y:u};break;default:f={x:i.x,y:i.y}}switch(jf(t)){case"start":f[o]-=d*(e&&l?-1:1);break;case"end":f[o]+=d*(e&&l?-1:1);break}return f}const pF=async(r,t,e)=>{const{placement:i="bottom",strategy:s="absolute",middleware:n=[],platform:o}=e,a=n.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t));let l=await o.getElementRects({reference:r,floating:t,strategy:s}),{x:h,y:u}=A0(l,i,c),d=i,f={},p=0;for(let m=0;m<a.length;m++){const{name:g,fn:I}=a[m],{x:C,y:b,data:E,reset:T}=await I({x:h,y:u,initialPlacement:i,placement:d,strategy:s,middlewareData:f,rects:l,platform:o,elements:{reference:r,floating:t}});h=C??h,u=b??u,f={...f,[g]:{...f[g],...E}},T&&p<=50&&(p++,typeof T=="object"&&(T.placement&&(d=T.placement),T.rects&&(l=T.rects===!0?await o.getElementRects({reference:r,floating:t,strategy:s}):T.rects),{x:h,y:u}=A0(l,d,c)),m=-1)}return{x:h,y:u,placement:d,strategy:s,middlewareData:f}};async function s1(r,t){var e;t===void 0&&(t={});const{x:i,y:s,platform:n,rects:o,elements:a,strategy:c}=r,{boundary:l="clippingAncestors",rootBoundary:h="viewport",elementContext:u="floating",altBoundary:d=!1,padding:f=0}=Hh(t,r),p=i1(f),m=a[d?u==="floating"?"reference":"floating":u],g=Ja(await n.getClippingRect({element:(e=await(n.isElement==null?void 0:n.isElement(m)))==null||e?m:m.contextElement||await(n.getDocumentElement==null?void 0:n.getDocumentElement(a.floating)),boundary:l,rootBoundary:h,strategy:c})),I=u==="floating"?{x:i,y:s,width:o.floating.width,height:o.floating.height}:o.reference,C=await(n.getOffsetParent==null?void 0:n.getOffsetParent(a.floating)),b=await(n.isElement==null?void 0:n.isElement(C))?await(n.getScale==null?void 0:n.getScale(C))||{x:1,y:1}:{x:1,y:1},E=Ja(n.convertOffsetParentRelativeRectToViewportRelativeRect?await n.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:I,offsetParent:C,strategy:c}):I);return{top:(g.top-E.top+p.top)/b.y,bottom:(E.bottom-g.bottom+p.bottom)/b.y,left:(g.left-E.left+p.left)/b.x,right:(E.right-g.right+p.right)/b.x}}const mF=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(t){var e,i;const{placement:s,middlewareData:n,rects:o,initialPlacement:a,platform:c,elements:l}=t,{mainAxis:h=!0,crossAxis:u=!0,fallbackPlacements:d,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=Hh(r,t);if((e=n.arrow)!=null&&e.alignmentOffset)return{};const I=Pn(s),C=Ro(a),b=Pn(a)===a,E=await(c.isRTL==null?void 0:c.isRTL(l.floating)),T=d||(b||!m?[If(a)]:hF(a)),A=p!=="none";!d&&A&&T.push(...dF(a,m,p,E));const S=[a,...T],_=await s1(t,g),w=[];let F=((i=n.flip)==null?void 0:i.overflows)||[];if(h&&w.push(_[I]),u){const y=lF(s,o,E);w.push(_[y[0]],_[y[1]])}if(F=[...F,{placement:s,overflows:w}],!w.every(y=>y<=0)){var D,R;const y=(((D=n.flip)==null?void 0:D.index)||0)+1,U=S[y];if(U)return{data:{index:y,overflows:F},reset:{placement:U}};let H=(R=F.filter(k=>k.overflows[0]<=0).sort((k,X)=>k.overflows[1]-X.overflows[1])[0])==null?void 0:R.placement;if(!H)switch(f){case"bestFit":{var O;const k=(O=F.filter(X=>{if(A){const $=Ro(X.placement);return $===C||$==="y"}return!0}).map(X=>[X.placement,X.overflows.filter($=>$>0).reduce(($,et)=>$+et,0)]).sort((X,$)=>X[1]-$[1])[0])==null?void 0:O[0];k&&(H=k);break}case"initialPlacement":H=a;break}if(s!==H)return{reset:{placement:H}}}return{}}}};function n1(r){const t=Ka(...r.map(n=>n.left)),e=Ka(...r.map(n=>n.top)),i=An(...r.map(n=>n.right)),s=An(...r.map(n=>n.bottom));return{x:t,y:e,width:i-t,height:s-e}}function IF(r){const t=r.slice().sort((s,n)=>s.y-n.y),e=[];let i=null;for(let s=0;s<t.length;s++){const n=t[s];!i||n.y-i.y>i.height/2?e.push([n]):e[e.length-1].push(n),i=n}return e.map(s=>Ja(n1(s)))}const gF=function(r){return r===void 0&&(r={}),{name:"inline",options:r,async fn(t){const{placement:e,elements:i,rects:s,platform:n,strategy:o}=t,{padding:a=2,x:c,y:l}=Hh(r,t),h=Array.from(await(n.getClientRects==null?void 0:n.getClientRects(i.reference))||[]),u=IF(h),d=Ja(n1(h)),f=i1(a);function p(){if(u.length===2&&u[0].left>u[1].right&&c!=null&&l!=null)return u.find(g=>c>g.left-f.left&&c<g.right+f.right&&l>g.top-f.top&&l<g.bottom+f.bottom)||d;if(u.length>=2){if(Ro(e)==="y"){const F=u[0],D=u[u.length-1],R=Pn(e)==="top",O=F.top,y=D.bottom,U=R?F.left:D.left,H=R?F.right:D.right,k=H-U,X=y-O;return{top:O,bottom:y,left:U,right:H,width:k,height:X,x:U,y:O}}const g=Pn(e)==="left",I=An(...u.map(F=>F.right)),C=Ka(...u.map(F=>F.left)),b=u.filter(F=>g?F.left===C:F.right===I),E=b[0].top,T=b[b.length-1].bottom,A=C,S=I,_=S-A,w=T-E;return{top:E,bottom:T,left:A,right:S,width:_,height:w,x:A,y:E}}return d}const m=await n.getElementRects({reference:{getBoundingClientRect:p},floating:i.floating,strategy:o});return s.reference.x!==m.reference.x||s.reference.y!==m.reference.y||s.reference.width!==m.reference.width||s.reference.height!==m.reference.height?{reset:{rects:m}}:{}}}};async function EF(r,t){const{placement:e,platform:i,elements:s}=r,n=await(i.isRTL==null?void 0:i.isRTL(s.floating)),o=Pn(e),a=jf(e),c=Ro(e)==="y",l=["left","top"].includes(o)?-1:1,h=n&&c?-1:1,u=Hh(t,r);let{mainAxis:d,crossAxis:f,alignmentAxis:p}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),c?{x:f*h,y:d*l}:{x:d*l,y:f*h}}const r1=function(r){return{name:"offset",options:r,async fn(t){var e,i;const{x:s,y:n,placement:o,middlewareData:a}=t,c=await EF(t,r);return o===((e=a.offset)==null?void 0:e.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:s+c.x,y:n+c.y,data:{...c,placement:o}}}}},CF=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(t){const{x:e,y:i,placement:s}=t,{mainAxis:n=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:I,y:C}=g;return{x:I,y:C}}},...c}=Hh(r,t),l={x:e,y:i},h=await s1(t,c),u=Ro(Pn(s)),d=Jy(u);let f=l[d],p=l[u];if(n){const g=d==="y"?"top":"left",I=d==="y"?"bottom":"right",C=f+h[g],b=f-h[I];f=R0(C,f,b)}if(o){const g=u==="y"?"top":"left",I=u==="y"?"bottom":"right",C=p+h[g],b=p-h[I];p=R0(C,p,b)}const m=a.fn({...t,[d]:f,[u]:p});return{...m,data:{x:m.x-e,y:m.y-i,enabled:{[d]:n,[u]:o}}}}}};function Xf(){return typeof window<"u"}function Tr(r){return o1(r)?(r.nodeName||"").toLowerCase():"#document"}function wi(r){var t;return(r==null||(t=r.ownerDocument)==null?void 0:t.defaultView)||window}function Pr(r){var t;return(t=(o1(r)?r.ownerDocument:r.document)||window.document)==null?void 0:t.documentElement}function o1(r){return Xf()?r instanceof Node||r instanceof wi(r).Node:!1}function Js(r){return Xf()?r instanceof Element||r instanceof wi(r).Element:!1}function tn(r){return Xf()?r instanceof HTMLElement||r instanceof wi(r).HTMLElement:!1}function S0(r){return!Xf()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof wi(r).ShadowRoot}function $h(r){const{overflow:t,overflowX:e,overflowY:i,display:s}=ss(r);return/auto|scroll|overlay|hidden|clip/.test(t+i+e)&&!["inline","contents"].includes(s)}function bF(r){return["table","td","th"].includes(Tr(r))}function TF(r){return[":popover-open",":modal"].some(t=>{try{return r.matches(t)}catch{return!1}})}function nE(r){const t=rE(),e=Js(r)?ss(r):r;return e.transform!=="none"||e.perspective!=="none"||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(e.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(e.contain||"").includes(i))}function yF(r){let t=tc(r);for(;tn(t)&&!Zf(t);){if(nE(t))return t;if(TF(t))return null;t=tc(t)}return null}function rE(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Zf(r){return["html","body","#document"].includes(Tr(r))}function ss(r){return wi(r).getComputedStyle(r)}function qf(r){return Js(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function tc(r){if(Tr(r)==="html")return r;const t=r.assignedSlot||r.parentNode||S0(r)&&r.host||Pr(r);return S0(t)?t.host:t}function a1(r){const t=tc(r);return Zf(t)?r.ownerDocument?r.ownerDocument.body:r.body:tn(t)&&$h(t)?t:a1(t)}function c1(r,t,e){var i;t===void 0&&(t=[]);const s=a1(r),n=s===((i=r.ownerDocument)==null?void 0:i.body),o=wi(s);return n?(vF(o),t.concat(o,o.visualViewport||[],$h(s)?s:[],[])):t.concat(s,c1(s,[]))}function vF(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function l1(r){const t=ss(r);let e=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const s=tn(r),n=s?r.offsetWidth:e,o=s?r.offsetHeight:i,a=mf(e)!==n||mf(i)!==o;return a&&(e=n,i=o),{width:e,height:i,$:a}}function h1(r){return Js(r)?r:r.contextElement}function $a(r){const t=h1(r);if(!tn(t))return br(1);const e=t.getBoundingClientRect(),{width:i,height:s,$:n}=l1(t);let o=(n?mf(e.width):e.width)/i,a=(n?mf(e.height):e.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const RF=br(0);function u1(r){const t=wi(r);return!rE()||!t.visualViewport?RF:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function AF(r,t,e){return t===void 0&&(t=!1),!e||t&&e!==wi(r)?!1:t}function Eh(r,t,e,i){t===void 0&&(t=!1),e===void 0&&(e=!1);const s=r.getBoundingClientRect(),n=h1(r);let o=br(1);t&&(i?Js(i)&&(o=$a(i)):o=$a(r));const a=AF(n,e,i)?u1(n):br(0);let c=(s.left+a.x)/o.x,l=(s.top+a.y)/o.y,h=s.width/o.x,u=s.height/o.y;if(n){const d=wi(n),f=i&&Js(i)?wi(i):i;let p=d,m=p.frameElement;for(;m&&i&&f!==p;){const g=$a(m),I=m.getBoundingClientRect(),C=ss(m),b=I.left+(m.clientLeft+parseFloat(C.paddingLeft))*g.x,E=I.top+(m.clientTop+parseFloat(C.paddingTop))*g.y;c*=g.x,l*=g.y,h*=g.x,u*=g.y,c+=b,l+=E,p=wi(m),m=p.frameElement}}return Ja({width:h,height:u,x:c,y:l})}const SF=[":popover-open",":modal"];function d1(r){return SF.some(t=>{try{return r.matches(t)}catch{return!1}})}function wF(r){let{elements:t,rect:e,offsetParent:i,strategy:s}=r;const n=s==="fixed",o=Pr(i),a=t?d1(t.floating):!1;if(i===o||a&&n)return e;let c={scrollLeft:0,scrollTop:0},l=br(1);const h=br(0),u=tn(i);if((u||!u&&!n)&&((Tr(i)!=="body"||$h(o))&&(c=qf(i)),tn(i))){const d=Eh(i);l=$a(i),h.x=d.x+i.clientLeft,h.y=d.y+i.clientTop}return{width:e.width*l.x,height:e.height*l.y,x:e.x*l.x-c.scrollLeft*l.x+h.x,y:e.y*l.y-c.scrollTop*l.y+h.y}}function _F(r){return Array.from(r.getClientRects())}function f1(r){return Eh(Pr(r)).left+qf(r).scrollLeft}function FF(r){const t=Pr(r),e=qf(r),i=r.ownerDocument.body,s=An(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),n=An(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let o=-e.scrollLeft+f1(r);const a=-e.scrollTop;return ss(i).direction==="rtl"&&(o+=An(t.clientWidth,i.clientWidth)-s),{width:s,height:n,x:o,y:a}}function OF(r,t){const e=wi(r),i=Pr(r),s=e.visualViewport;let n=i.clientWidth,o=i.clientHeight,a=0,c=0;if(s){n=s.width,o=s.height;const l=rE();(!l||l&&t==="fixed")&&(a=s.offsetLeft,c=s.offsetTop)}return{width:n,height:o,x:a,y:c}}function xF(r,t){const e=Eh(r,!0,t==="fixed"),i=e.top+r.clientTop,s=e.left+r.clientLeft,n=tn(r)?$a(r):br(1),o=r.clientWidth*n.x,a=r.clientHeight*n.y,c=s*n.x,l=i*n.y;return{width:o,height:a,x:c,y:l}}function w0(r,t,e){let i;if(t==="viewport")i=OF(r,e);else if(t==="document")i=FF(Pr(r));else if(Js(t))i=xF(t,e);else{const s=u1(r);i={...t,x:t.x-s.x,y:t.y-s.y}}return Ja(i)}function p1(r,t){const e=tc(r);return e===t||!Js(e)||Zf(e)?!1:ss(e).position==="fixed"||p1(e,t)}function NF(r,t){const e=t.get(r);if(e)return e;let i=c1(r,[]).filter(a=>Js(a)&&Tr(a)!=="body"),s=null;const n=ss(r).position==="fixed";let o=n?tc(r):r;for(;Js(o)&&!Zf(o);){const a=ss(o),c=nE(o);!c&&a.position==="fixed"&&(s=null),(n?!c&&!s:!c&&a.position==="static"&&s&&["absolute","fixed"].includes(s.position)||$h(o)&&!c&&p1(r,o))?i=i.filter(l=>l!==o):s=a,o=tc(o)}return t.set(r,i),i}function PF(r){let{element:t,boundary:e,rootBoundary:i,strategy:s}=r;const n=[...e==="clippingAncestors"?NF(t,this._c):[].concat(e),i],o=n[0],a=n.reduce((c,l)=>{const h=w0(t,l,s);return c.top=An(h.top,c.top),c.right=Ka(h.right,c.right),c.bottom=Ka(h.bottom,c.bottom),c.left=An(h.left,c.left),c},w0(t,o,s));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function LF(r){const{width:t,height:e}=l1(r);return{width:t,height:e}}function MF(r,t,e){const i=tn(t),s=Pr(t),n=e==="fixed",o=Eh(r,!0,n,t);let a={scrollLeft:0,scrollTop:0};const c=br(0);if(i||!i&&!n)if((Tr(t)!=="body"||$h(s))&&(a=qf(t)),i){const u=Eh(t,!0,n,t);c.x=u.x+t.clientLeft,c.y=u.y+t.clientTop}else s&&(c.x=f1(s));const l=o.left+a.scrollLeft-c.x,h=o.top+a.scrollTop-c.y;return{x:l,y:h,width:o.width,height:o.height}}function _0(r,t){return!tn(r)||ss(r).position==="fixed"?null:t?t(r):r.offsetParent}function m1(r,t){const e=wi(r);if(!tn(r)||d1(r))return e;let i=_0(r,t);for(;i&&bF(i)&&ss(i).position==="static";)i=_0(i,t);return i&&(Tr(i)==="html"||Tr(i)==="body"&&ss(i).position==="static"&&!nE(i))?e:i||yF(r)||e}const DF=async function(r){const t=this.getOffsetParent||m1,e=this.getDimensions;return{reference:MF(r.reference,await t(r.floating),r.strategy),floating:{x:0,y:0,...await e(r.floating)}}};function UF(r){return ss(r).direction==="rtl"}const BF={convertOffsetParentRelativeRectToViewportRelativeRect:wF,getDocumentElement:Pr,getClippingRect:PF,getOffsetParent:m1,getElementRects:DF,getClientRects:_F,getDimensions:LF,getScale:$a,isElement:Js,isRTL:UF},I1=CF,g1=mF,E1=gF,C1=(r,t,e)=>{const i=new Map,s={platform:BF,...e},n={...s.platform,_c:i};return pF(r,t,{...s,platform:n})};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const jd=globalThis,oE=jd.ShadowRoot&&(jd.ShadyCSS===void 0||jd.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,aE=Symbol(),F0=new WeakMap;let b1=class{constructor(t,e,i){if(this._$cssResult$=!0,i!==aE)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(oE&&t===void 0){const i=e!==void 0&&e.length===1;i&&(t=F0.get(e)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&F0.set(e,t))}return t}toString(){return this.cssText}};const kF=r=>new b1(typeof r=="string"?r:r+"",void 0,aE),Jt=(r,...t)=>{const e=r.length===1?r[0]:t.reduce((i,s,n)=>i+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+r[n+1],r[0]);return new b1(e,r,aE)},VF=(r,t)=>{if(oE)r.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(const e of t){const i=document.createElement("style"),s=jd.litNonce;s!==void 0&&i.setAttribute("nonce",s),i.textContent=e.cssText,r.appendChild(i)}},O0=oE?r=>r:r=>r instanceof CSSStyleSheet?(t=>{let e="";for(const i of t.cssRules)e+=i.cssText;return kF(e)})(r):r;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:zF,defineProperty:YF,getOwnPropertyDescriptor:GF,getOwnPropertyNames:HF,getOwnPropertySymbols:$F,getPrototypeOf:WF}=Object,ec=globalThis,x0=ec.trustedTypes,jF=x0?x0.emptyScript:"",N0=ec.reactiveElementPolyfillSupport,sh=(r,t)=>r,gf={toAttribute(r,t){switch(t){case Boolean:r=r?jF:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,t){let e=r;switch(t){case Boolean:e=r!==null;break;case Number:e=r===null?null:Number(r);break;case Object:case Array:try{e=JSON.parse(r)}catch{e=null}}return e}},cE=(r,t)=>!zF(r,t),P0={attribute:!0,type:String,converter:gf,reflect:!1,hasChanged:cE};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),ec.litPropertyMetadata??(ec.litPropertyMetadata=new WeakMap);let Ma=class extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??(this.l=[])).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,e=P0){if(e.state&&(e.attribute=!1),this._$Ei(),this.elementProperties.set(t,e),!e.noAccessor){const i=Symbol(),s=this.getPropertyDescriptor(t,i,e);s!==void 0&&YF(this.prototype,t,s)}}static getPropertyDescriptor(t,e,i){const{get:s,set:n}=GF(this.prototype,t)??{get(){return this[e]},set(o){this[e]=o}};return{get(){return s?.call(this)},set(o){const a=s?.call(this);n.call(this,o),this.requestUpdate(t,a,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??P0}static _$Ei(){if(this.hasOwnProperty(sh("elementProperties")))return;const t=WF(this);t.finalize(),t.l!==void 0&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(sh("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(sh("properties"))){const e=this.properties,i=[...HF(e),...$F(e)];for(const s of i)this.createProperty(s,e[s])}const t=this[Symbol.metadata];if(t!==null){const e=litPropertyMetadata.get(t);if(e!==void 0)for(const[i,s]of e)this.elementProperties.set(i,s)}this._$Eh=new Map;for(const[e,i]of this.elementProperties){const s=this._$Eu(e,i);s!==void 0&&this._$Eh.set(s,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const s of i)e.unshift(O0(s))}else t!==void 0&&e.push(O0(t));return e}static _$Eu(t,e){const i=e.attribute;return i===!1?void 0:typeof i=="string"?i:typeof t=="string"?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var t;this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),(t=this.constructor.l)==null||t.forEach(e=>e(this))}addController(t){var e;(this._$EO??(this._$EO=new Set)).add(t),this.renderRoot!==void 0&&this.isConnected&&((e=t.hostConnected)==null||e.call(t))}removeController(t){var e;(e=this._$EO)==null||e.delete(t)}_$E_(){const t=new Map,e=this.constructor.elementProperties;for(const i of e.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return VF(t,this.constructor.elementStyles),t}connectedCallback(){var t;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(t=this._$EO)==null||t.forEach(e=>{var i;return(i=e.hostConnected)==null?void 0:i.call(e)})}enableUpdating(t){}disconnectedCallback(){var t;(t=this._$EO)==null||t.forEach(e=>{var i;return(i=e.hostDisconnected)==null?void 0:i.call(e)})}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$EC(t,e){var i;const s=this.constructor.elementProperties.get(t),n=this.constructor._$Eu(t,s);if(n!==void 0&&s.reflect===!0){const o=(((i=s.converter)==null?void 0:i.toAttribute)!==void 0?s.converter:gf).toAttribute(e,s.type);this._$Em=t,o==null?this.removeAttribute(n):this.setAttribute(n,o),this._$Em=null}}_$AK(t,e){var i;const s=this.constructor,n=s._$Eh.get(t);if(n!==void 0&&this._$Em!==n){const o=s.getPropertyOptions(n),a=typeof o.converter=="function"?{fromAttribute:o.converter}:((i=o.converter)==null?void 0:i.fromAttribute)!==void 0?o.converter:gf;this._$Em=n,this[n]=a.fromAttribute(e,o.type),this._$Em=null}}requestUpdate(t,e,i){if(t!==void 0){if(i??(i=this.constructor.getPropertyOptions(t)),!(i.hasChanged??cE)(this[t],e))return;this.P(t,e,i)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(t,e,i){this._$AL.has(t)||this._$AL.set(t,e),i.reflect===!0&&this._$Em!==t&&(this._$Ej??(this._$Ej=new Set)).add(t)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[n,o]of this._$Ep)this[n]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[n,o]of s)o.wrapped!==!0||this._$AL.has(n)||this[n]===void 0||this.P(n,this[n],o)}let e=!1;const i=this._$AL;try{e=this.shouldUpdate(i),e?(this.willUpdate(i),(t=this._$EO)==null||t.forEach(s=>{var n;return(n=s.hostUpdate)==null?void 0:n.call(s)}),this.update(i)):this._$EU()}catch(s){throw e=!1,this._$EU(),s}e&&this._$AE(i)}willUpdate(t){}_$AE(t){var e;(e=this._$EO)==null||e.forEach(i=>{var s;return(s=i.hostUpdated)==null?void 0:s.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Ej&&(this._$Ej=this._$Ej.forEach(e=>this._$EC(e,this[e]))),this._$EU()}updated(t){}firstUpdated(t){}};Ma.elementStyles=[],Ma.shadowRootOptions={mode:"open"},Ma[sh("elementProperties")]=new Map,Ma[sh("finalized")]=new Map,N0?.({ReactiveElement:Ma}),(ec.reactiveElementVersions??(ec.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ef=globalThis,Cf=Ef.trustedTypes,L0=Cf?Cf.createPolicy("lit-html",{createHTML:r=>r}):void 0,T1="$lit$",or=`lit$${Math.random().toFixed(9).slice(2)}$`,y1="?"+or,XF=`<${y1}>`,Ao=document,Ch=()=>Ao.createComment(""),bh=r=>r===null||typeof r!="object"&&typeof r!="function",lE=Array.isArray,ZF=r=>lE(r)||typeof r?.[Symbol.iterator]=="function",Yp=`[ 	
\f\r]`,cl=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,M0=/-->/g,D0=/>/g,Wr=RegExp(`>|${Yp}(?:([^\\s"'>=/]+)(${Yp}*=${Yp}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),U0=/'/g,B0=/"/g,v1=/^(?:script|style|textarea|title)$/i,qF=r=>(t,...e)=>({_$litType$:r,strings:t,values:e}),Tt=qF(1),ic=Symbol.for("lit-noChange"),Ae=Symbol.for("lit-nothing"),k0=new WeakMap,ho=Ao.createTreeWalker(Ao,129);function R1(r,t){if(!lE(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return L0!==void 0?L0.createHTML(t):t}const QF=(r,t)=>{const e=r.length-1,i=[];let s,n=t===2?"<svg>":t===3?"<math>":"",o=cl;for(let a=0;a<e;a++){const c=r[a];let l,h,u=-1,d=0;for(;d<c.length&&(o.lastIndex=d,h=o.exec(c),h!==null);)d=o.lastIndex,o===cl?h[1]==="!--"?o=M0:h[1]!==void 0?o=D0:h[2]!==void 0?(v1.test(h[2])&&(s=RegExp("</"+h[2],"g")),o=Wr):h[3]!==void 0&&(o=Wr):o===Wr?h[0]===">"?(o=s??cl,u=-1):h[1]===void 0?u=-2:(u=o.lastIndex-h[2].length,l=h[1],o=h[3]===void 0?Wr:h[3]==='"'?B0:U0):o===B0||o===U0?o=Wr:o===M0||o===D0?o=cl:(o=Wr,s=void 0);const f=o===Wr&&r[a+1].startsWith("/>")?" ":"";n+=o===cl?c+XF:u>=0?(i.push(l),c.slice(0,u)+T1+c.slice(u)+or+f):c+or+(u===-2?a:f)}return[R1(r,n+(r[e]||"<?>")+(t===2?"</svg>":t===3?"</math>":"")),i]};let hI=class A1{constructor({strings:t,_$litType$:e},i){let s;this.parts=[];let n=0,o=0;const a=t.length-1,c=this.parts,[l,h]=QF(t,e);if(this.el=A1.createElement(l,i),ho.currentNode=this.el.content,e===2||e===3){const u=this.el.content.firstChild;u.replaceWith(...u.childNodes)}for(;(s=ho.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const u of s.getAttributeNames())if(u.endsWith(T1)){const d=h[o++],f=s.getAttribute(u).split(or),p=/([.?@])?(.*)/.exec(d);c.push({type:1,index:n,name:p[2],strings:f,ctor:p[1]==="."?JF:p[1]==="?"?tO:p[1]==="@"?eO:Qf}),s.removeAttribute(u)}else u.startsWith(or)&&(c.push({type:6,index:n}),s.removeAttribute(u));if(v1.test(s.tagName)){const u=s.textContent.split(or),d=u.length-1;if(d>0){s.textContent=Cf?Cf.emptyScript:"";for(let f=0;f<d;f++)s.append(u[f],Ch()),ho.nextNode(),c.push({type:2,index:++n});s.append(u[d],Ch())}}}else if(s.nodeType===8)if(s.data===y1)c.push({type:2,index:n});else{let u=-1;for(;(u=s.data.indexOf(or,u+1))!==-1;)c.push({type:7,index:n}),u+=or.length-1}n++}}static createElement(t,e){const i=Ao.createElement("template");return i.innerHTML=t,i}};function sc(r,t,e=r,i){var s,n;if(t===ic)return t;let o=i!==void 0?(s=e._$Co)==null?void 0:s[i]:e._$Cl;const a=bh(t)?void 0:t._$litDirective$;return o?.constructor!==a&&((n=o?._$AO)==null||n.call(o,!1),a===void 0?o=void 0:(o=new a(r),o._$AT(r,e,i)),i!==void 0?(e._$Co??(e._$Co=[]))[i]=o:e._$Cl=o),o!==void 0&&(t=sc(r,o._$AS(r,t.values),o,i)),t}class KF{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:e},parts:i}=this._$AD,s=(t?.creationScope??Ao).importNode(e,!0);ho.currentNode=s;let n=ho.nextNode(),o=0,a=0,c=i[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new hE(n,n.nextSibling,this,t):c.type===1?l=new c.ctor(n,c.name,c.strings,this,t):c.type===6&&(l=new iO(n,this,t)),this._$AV.push(l),c=i[++a]}o!==c?.index&&(n=ho.nextNode(),o++)}return ho.currentNode=Ao,s}p(t){let e=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}}let hE=class S1{get _$AU(){var t;return((t=this._$AM)==null?void 0:t._$AU)??this._$Cv}constructor(t,e,i,s){this.type=2,this._$AH=Ae,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return e!==void 0&&t?.nodeType===11&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=sc(this,t,e),bh(t)?t===Ae||t==null||t===""?(this._$AH!==Ae&&this._$AR(),this._$AH=Ae):t!==this._$AH&&t!==ic&&this._(t):t._$litType$!==void 0?this.$(t):t.nodeType!==void 0?this.T(t):ZF(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==Ae&&bh(this._$AH)?this._$AA.nextSibling.data=t:this.T(Ao.createTextNode(t)),this._$AH=t}$(t){var e;const{values:i,_$litType$:s}=t,n=typeof s=="number"?this._$AC(t):(s.el===void 0&&(s.el=hI.createElement(R1(s.h,s.h[0]),this.options)),s);if(((e=this._$AH)==null?void 0:e._$AD)===n)this._$AH.p(i);else{const o=new KF(n,this),a=o.u(this.options);o.p(i),this.T(a),this._$AH=o}}_$AC(t){let e=k0.get(t.strings);return e===void 0&&k0.set(t.strings,e=new hI(t)),e}k(t){lE(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,s=0;for(const n of t)s===e.length?e.push(i=new S1(this.O(Ch()),this.O(Ch()),this,this.options)):i=e[s],i._$AI(n),s++;s<e.length&&(this._$AR(i&&i._$AB.nextSibling,s),e.length=s)}_$AR(t=this._$AA.nextSibling,e){var i;for((i=this._$AP)==null?void 0:i.call(this,!1,!0,e);t&&t!==this._$AB;){const s=t.nextSibling;t.remove(),t=s}}setConnected(t){var e;this._$AM===void 0&&(this._$Cv=t,(e=this._$AP)==null||e.call(this,t))}},Qf=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,e,i,s,n){this.type=1,this._$AH=Ae,this._$AN=void 0,this.element=t,this.name=e,this._$AM=s,this.options=n,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=Ae}_$AI(t,e=this,i,s){const n=this.strings;let o=!1;if(n===void 0)t=sc(this,t,e,0),o=!bh(t)||t!==this._$AH&&t!==ic,o&&(this._$AH=t);else{const a=t;let c,l;for(t=n[0],c=0;c<n.length-1;c++)l=sc(this,a[i+c],e,c),l===ic&&(l=this._$AH[c]),o||(o=!bh(l)||l!==this._$AH[c]),l===Ae?t=Ae:t!==Ae&&(t+=(l??"")+n[c+1]),this._$AH[c]=l}o&&!s&&this.j(t)}j(t){t===Ae?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}},JF=class extends Qf{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===Ae?void 0:t}},tO=class extends Qf{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==Ae)}},eO=class extends Qf{constructor(t,e,i,s,n){super(t,e,i,s,n),this.type=5}_$AI(t,e=this){if((t=sc(this,t,e,0)??Ae)===ic)return;const i=this._$AH,s=t===Ae&&i!==Ae||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,n=t!==Ae&&(i===Ae||s);s&&this.element.removeEventListener(this.name,this,i),n&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e;typeof this._$AH=="function"?this._$AH.call(((e=this.options)==null?void 0:e.host)??this.element,t):this._$AH.handleEvent(t)}},iO=class{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){sc(this,t)}};const V0=Ef.litHtmlPolyfillSupport;V0?.(hI,hE),(Ef.litHtmlVersions??(Ef.litHtmlVersions=[])).push("3.2.1");const nc=(r,t,e)=>{const i=e?.renderBefore??t;let s=i._$litPart$;if(s===void 0){const n=e?.renderBefore??null;i._$litPart$=s=new hE(t.insertBefore(Ch(),n),n,void 0,e??{})}return s._$AI(r),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let Zt=class extends Ma{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=nc(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),(t=this._$Do)==null||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),(t=this._$Do)==null||t.setConnected(!1)}render(){return ic}};var z0;Zt._$litElement$=!0,Zt.finalized=!0,(z0=globalThis.litElementHydrateSupport)==null||z0.call(globalThis,{LitElement:Zt});const Y0=globalThis.litElementPolyfillSupport;Y0?.({LitElement:Zt});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const sO={attribute:!0,type:String,converter:gf,reflect:!1,hasChanged:cE},nO=(r=sO,t,e)=>{const{kind:i,metadata:s}=e;let n=globalThis.litPropertyMetadata.get(s);if(n===void 0&&globalThis.litPropertyMetadata.set(s,n=new Map),n.set(e.name,r),i==="accessor"){const{name:o}=e;return{set(a){const c=t.get.call(this);t.set.call(this,a),this.requestUpdate(o,c,r)},init(a){return a!==void 0&&this.P(o,void 0,r),a}}}if(i==="setter"){const{name:o}=e;return function(a){const c=this[o];t.call(this,a),this.requestUpdate(o,c,r)}}throw Error("Unsupported decorator location: "+i)};function ut(r){return(t,e)=>typeof e=="object"?nO(r,t,e):((i,s,n)=>{const o=s.hasOwnProperty(n);return s.constructor.createProperty(n,o?{...i,wrapped:!0}:i),o?Object.getOwnPropertyDescriptor(s,n):void 0})(r,t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Lc(r){return ut({...r,state:!0,attribute:!1})}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const rO=r=>r.strings===void 0;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const oO={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},aO=r=>(...t)=>({_$litDirective$:r,values:t});let cO=class{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const nh=(r,t)=>{var e;const i=r._$AN;if(i===void 0)return!1;for(const s of i)(e=s._$AO)==null||e.call(s,t,!1),nh(s,t);return!0},bf=r=>{let t,e;do{if((t=r._$AM)===void 0)break;e=t._$AN,e.delete(r),r=t}while(e?.size===0)},w1=r=>{for(let t;t=r._$AM;r=t){let e=t._$AN;if(e===void 0)t._$AN=e=new Set;else if(e.has(r))break;e.add(r),uO(t)}};function lO(r){this._$AN!==void 0?(bf(this),this._$AM=r,w1(this)):this._$AM=r}function hO(r,t=!1,e=0){const i=this._$AH,s=this._$AN;if(s!==void 0&&s.size!==0)if(t)if(Array.isArray(i))for(let n=e;n<i.length;n++)nh(i[n],!1),bf(i[n]);else i!=null&&(nh(i,!1),bf(i));else nh(this,r)}const uO=r=>{r.type==oO.CHILD&&(r._$AP??(r._$AP=hO),r._$AQ??(r._$AQ=lO))};let dO=class extends cO{constructor(){super(...arguments),this._$AN=void 0}_$AT(t,e,i){super._$AT(t,e,i),w1(this),this.isConnected=t._$AU}_$AO(t,e=!0){var i,s;t!==this.isConnected&&(this.isConnected=t,t?(i=this.reconnected)==null||i.call(this):(s=this.disconnected)==null||s.call(this)),e&&(nh(this,t),bf(this))}setValue(t){if(rO(this._$Ct))this._$Ct._$AI(t,this);else{const e=[...this._$Ct._$AH];e[this._$Ci]=t,this._$Ct._$AI(e,this,0)}}disconnected(){}reconnected(){}};/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const rc=()=>new fO;let fO=class{};const Gp=new WeakMap,oc=aO(class extends dO{render(r){return Ae}update(r,[t]){var e;const i=t!==this.Y;return i&&this.Y!==void 0&&this.rt(void 0),(i||this.lt!==this.ct)&&(this.Y=t,this.ht=(e=r.options)==null?void 0:e.host,this.rt(this.ct=r.element)),Ae}rt(r){if(this.isConnected||(r=void 0),typeof this.Y=="function"){const t=this.ht??globalThis;let e=Gp.get(t);e===void 0&&(e=new WeakMap,Gp.set(t,e)),e.get(this.Y)!==void 0&&this.Y.call(this.ht,void 0),e.set(this.Y,r),r!==void 0&&this.Y.call(this.ht,r)}else this.Y.value=r}get lt(){var r,t;return typeof this.Y=="function"?(r=Gp.get(this.ht??globalThis))==null?void 0:r.get(this.Y):(t=this.Y)==null?void 0:t.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}});/**
* (c) Iconify
*
* For the full copyright and license information, please view the license.txt
* files at https://github.com/iconify/iconify
*
* Licensed under MIT.
*
* @license MIT
* @version 2.0.0
*/const _1=Object.freeze({left:0,top:0,width:16,height:16}),Tf=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),Wh=Object.freeze({..._1,...Tf}),uI=Object.freeze({...Wh,body:"",hidden:!1}),pO=Object.freeze({width:null,height:null}),F1=Object.freeze({...pO,...Tf});function mO(r,t=0){const e=r.replace(/^-?[0-9.]*/,"");function i(s){for(;s<0;)s+=4;return s%4}if(e===""){const s=parseInt(r);return isNaN(s)?0:i(s)}else if(e!==r){let s=0;switch(e){case"%":s=25;break;case"deg":s=90}if(s){let n=parseFloat(r.slice(0,r.length-e.length));return isNaN(n)?0:(n=n/s,n%1===0?i(n):0)}}return t}const IO=/[\s,]+/;function gO(r,t){t.split(IO).forEach(e=>{switch(e.trim()){case"horizontal":r.hFlip=!0;break;case"vertical":r.vFlip=!0;break}})}const O1={...F1,preserveAspectRatio:""};function G0(r){const t={...O1},e=(i,s)=>r.getAttribute(i)||s;return t.width=e("width",null),t.height=e("height",null),t.rotate=mO(e("rotate","")),gO(t,e("flip","")),t.preserveAspectRatio=e("preserveAspectRatio",e("preserveaspectratio","")),t}function EO(r,t){for(const e in O1)if(r[e]!==t[e])return!0;return!1}const rh=/^[a-z0-9]+(-[a-z0-9]+)*$/,jh=(r,t,e,i="")=>{const s=r.split(":");if(r.slice(0,1)==="@"){if(s.length<2||s.length>3)return null;i=s.shift().slice(1)}if(s.length>3||!s.length)return null;if(s.length>1){const a=s.pop(),c=s.pop(),l={provider:s.length>0?s[0]:i,prefix:c,name:a};return t&&!Xd(l)?null:l}const n=s[0],o=n.split("-");if(o.length>1){const a={provider:i,prefix:o.shift(),name:o.join("-")};return t&&!Xd(a)?null:a}if(e&&i===""){const a={provider:i,prefix:"",name:n};return t&&!Xd(a,e)?null:a}return null},Xd=(r,t)=>r?!!((r.provider===""||r.provider.match(rh))&&(t&&r.prefix===""||r.prefix.match(rh))&&r.name.match(rh)):!1;function CO(r,t){const e={};!r.hFlip!=!t.hFlip&&(e.hFlip=!0),!r.vFlip!=!t.vFlip&&(e.vFlip=!0);const i=((r.rotate||0)+(t.rotate||0))%4;return i&&(e.rotate=i),e}function H0(r,t){const e=CO(r,t);for(const i in uI)i in Tf?i in r&&!(i in e)&&(e[i]=Tf[i]):i in t?e[i]=t[i]:i in r&&(e[i]=r[i]);return e}function bO(r,t){const e=r.icons,i=r.aliases||Object.create(null),s=Object.create(null);function n(o){if(e[o])return s[o]=[];if(!(o in s)){s[o]=null;const a=i[o]&&i[o].parent,c=a&&n(a);c&&(s[o]=[a].concat(c))}return s[o]}return Object.keys(e).concat(Object.keys(i)).forEach(n),s}function TO(r,t,e){const i=r.icons,s=r.aliases||Object.create(null);let n={};function o(a){n=H0(i[a]||s[a],n)}return o(t),e.forEach(o),H0(r,n)}function x1(r,t){const e=[];if(typeof r!="object"||typeof r.icons!="object")return e;r.not_found instanceof Array&&r.not_found.forEach(s=>{t(s,null),e.push(s)});const i=bO(r);for(const s in i){const n=i[s];n&&(t(s,TO(r,s,n)),e.push(s))}return e}const yO={provider:"",aliases:{},not_found:{},..._1};function Hp(r,t){for(const e in t)if(e in r&&typeof r[e]!=typeof t[e])return!1;return!0}function N1(r){if(typeof r!="object"||r===null)return null;const t=r;if(typeof t.prefix!="string"||!r.icons||typeof r.icons!="object"||!Hp(r,yO))return null;const e=t.icons;for(const s in e){const n=e[s];if(!s.match(rh)||typeof n.body!="string"||!Hp(n,uI))return null}const i=t.aliases||Object.create(null);for(const s in i){const n=i[s],o=n.parent;if(!s.match(rh)||typeof o!="string"||!e[o]&&!i[o]||!Hp(n,uI))return null}return t}const yf=Object.create(null);function vO(r,t){return{provider:r,prefix:t,icons:Object.create(null),missing:new Set}}function yr(r,t){const e=yf[r]||(yf[r]=Object.create(null));return e[t]||(e[t]=vO(r,t))}function uE(r,t){return N1(t)?x1(t,(e,i)=>{i?r.icons[e]=i:r.missing.add(e)}):[]}function RO(r,t,e){try{if(typeof e.body=="string")return r.icons[t]={...e},!0}catch{}return!1}function AO(r,t){let e=[];return(typeof r=="string"?[r]:Object.keys(yf)).forEach(i=>{(typeof i=="string"&&typeof t=="string"?[t]:Object.keys(yf[i]||{})).forEach(s=>{const n=yr(i,s);e=e.concat(Object.keys(n.icons).map(o=>(i!==""?"@"+i+":":"")+s+":"+o))})}),e}let Th=!1;function P1(r){return typeof r=="boolean"&&(Th=r),Th}function yh(r){const t=typeof r=="string"?jh(r,!0,Th):r;if(t){const e=yr(t.provider,t.prefix),i=t.name;return e.icons[i]||(e.missing.has(i)?null:void 0)}}function L1(r,t){const e=jh(r,!0,Th);if(!e)return!1;const i=yr(e.provider,e.prefix);return RO(i,e.name,t)}function $0(r,t){if(typeof r!="object")return!1;if(typeof t!="string"&&(t=r.provider||""),Th&&!t&&!r.prefix){let s=!1;return N1(r)&&(r.prefix="",x1(r,(n,o)=>{o&&L1(n,o)&&(s=!0)})),s}const e=r.prefix;if(!Xd({provider:t,prefix:e,name:"a"}))return!1;const i=yr(t,e);return!!uE(i,r)}function W0(r){return!!yh(r)}function SO(r){const t=yh(r);return t?{...Wh,...t}:null}function wO(r){const t={loaded:[],missing:[],pending:[]},e=Object.create(null);r.sort((s,n)=>s.provider!==n.provider?s.provider.localeCompare(n.provider):s.prefix!==n.prefix?s.prefix.localeCompare(n.prefix):s.name.localeCompare(n.name));let i={provider:"",prefix:"",name:""};return r.forEach(s=>{if(i.name===s.name&&i.prefix===s.prefix&&i.provider===s.provider)return;i=s;const n=s.provider,o=s.prefix,a=s.name,c=e[n]||(e[n]=Object.create(null)),l=c[o]||(c[o]=yr(n,o));let h;a in l.icons?h=t.loaded:o===""||l.missing.has(a)?h=t.missing:h=t.pending;const u={provider:n,prefix:o,name:a};h.push(u)}),t}function M1(r,t){r.forEach(e=>{const i=e.loaderCallbacks;i&&(e.loaderCallbacks=i.filter(s=>s.id!==t))})}function _O(r){r.pendingCallbacksFlag||(r.pendingCallbacksFlag=!0,setTimeout(()=>{r.pendingCallbacksFlag=!1;const t=r.loaderCallbacks?r.loaderCallbacks.slice(0):[];if(!t.length)return;let e=!1;const i=r.provider,s=r.prefix;t.forEach(n=>{const o=n.icons,a=o.pending.length;o.pending=o.pending.filter(c=>{if(c.prefix!==s)return!0;const l=c.name;if(r.icons[l])o.loaded.push({provider:i,prefix:s,name:l});else if(r.missing.has(l))o.missing.push({provider:i,prefix:s,name:l});else return e=!0,!0;return!1}),o.pending.length!==a&&(e||M1([r],n.id),n.callback(o.loaded.slice(0),o.missing.slice(0),o.pending.slice(0),n.abort))})}))}let FO=0;function OO(r,t,e){const i=FO++,s=M1.bind(null,e,i);if(!t.pending.length)return s;const n={id:i,icons:t,callback:r,abort:s};return e.forEach(o=>{(o.loaderCallbacks||(o.loaderCallbacks=[])).push(n)}),s}const dI=Object.create(null);function j0(r,t){dI[r]=t}function fI(r){return dI[r]||dI[""]}function xO(r,t=!0,e=!1){const i=[];return r.forEach(s=>{const n=typeof s=="string"?jh(s,t,e):s;n&&i.push(n)}),i}var NO={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function PO(r,t,e,i){const s=r.resources.length,n=r.random?Math.floor(Math.random()*s):r.index;let o;if(r.random){let A=r.resources.slice(0);for(o=[];A.length>1;){const S=Math.floor(Math.random()*A.length);o.push(A[S]),A=A.slice(0,S).concat(A.slice(S+1))}o=o.concat(A)}else o=r.resources.slice(n).concat(r.resources.slice(0,n));const a=Date.now();let c="pending",l=0,h,u=null,d=[],f=[];typeof i=="function"&&f.push(i);function p(){u&&(clearTimeout(u),u=null)}function m(){c==="pending"&&(c="aborted"),p(),d.forEach(A=>{A.status==="pending"&&(A.status="aborted")}),d=[]}function g(A,S){S&&(f=[]),typeof A=="function"&&f.push(A)}function I(){return{startTime:a,payload:t,status:c,queriesSent:l,queriesPending:d.length,subscribe:g,abort:m}}function C(){c="failed",f.forEach(A=>{A(void 0,h)})}function b(){d.forEach(A=>{A.status==="pending"&&(A.status="aborted")}),d=[]}function E(A,S,_){const w=S!=="success";switch(d=d.filter(F=>F!==A),c){case"pending":break;case"failed":if(w||!r.dataAfterTimeout)return;break;default:return}if(S==="abort"){h=_,C();return}if(w){h=_,d.length||(o.length?T():C());return}if(p(),b(),!r.random){const F=r.resources.indexOf(A.resource);F!==-1&&F!==r.index&&(r.index=F)}c="completed",f.forEach(F=>{F(_)})}function T(){if(c!=="pending")return;p();const A=o.shift();if(A===void 0){if(d.length){u=setTimeout(()=>{p(),c==="pending"&&(b(),C())},r.timeout);return}C();return}const S={status:"pending",resource:A,callback:(_,w)=>{E(S,_,w)}};d.push(S),l++,u=setTimeout(T,r.rotate),e(A,t,S.callback)}return setTimeout(T),I}function D1(r){const t={...NO,...r};let e=[];function i(){e=e.filter(o=>o().status==="pending")}function s(o,a,c){const l=PO(t,o,a,(h,u)=>{i(),c&&c(h,u)});return e.push(l),l}function n(o){return e.find(a=>o(a))||null}return{query:s,find:n,setIndex:o=>{t.index=o},getIndex:()=>t.index,cleanup:i}}function dE(r){let t;if(typeof r.resources=="string")t=[r.resources];else if(t=r.resources,!(t instanceof Array)||!t.length)return null;return{resources:t,path:r.path||"/",maxURL:r.maxURL||500,rotate:r.rotate||750,timeout:r.timeout||5e3,random:r.random===!0,index:r.index||0,dataAfterTimeout:r.dataAfterTimeout!==!1}}const Kf=Object.create(null),Eu=["https://api.simplesvg.com","https://api.unisvg.com"],pI=[];for(;Eu.length>0;)Eu.length===1||Math.random()>.5?pI.push(Eu.shift()):pI.push(Eu.pop());Kf[""]=dE({resources:["https://api.iconify.design"].concat(pI)});function X0(r,t){const e=dE(t);return e===null?!1:(Kf[r]=e,!0)}function Jf(r){return Kf[r]}function LO(){return Object.keys(Kf)}function Z0(){}const $p=Object.create(null);function MO(r){if(!$p[r]){const t=Jf(r);if(!t)return;const e=D1(t),i={config:t,redundancy:e};$p[r]=i}return $p[r]}function U1(r,t,e){let i,s;if(typeof r=="string"){const n=fI(r);if(!n)return e(void 0,424),Z0;s=n.send;const o=MO(r);o&&(i=o.redundancy)}else{const n=dE(r);if(n){i=D1(n);const o=r.resources?r.resources[0]:"",a=fI(o);a&&(s=a.send)}}return!i||!s?(e(void 0,424),Z0):i.query(t,s,e)().abort}const q0="iconify2",vh="iconify",B1=vh+"-count",Q0=vh+"-version",k1=36e5,DO=168,UO=50;function mI(r,t){try{return r.getItem(t)}catch{}}function fE(r,t,e){try{return r.setItem(t,e),!0}catch{}}function K0(r,t){try{r.removeItem(t)}catch{}}function II(r,t){return fE(r,B1,t.toString())}function gI(r){return parseInt(mI(r,B1))||0}const Io={local:!0,session:!0},V1={local:new Set,session:new Set};let pE=!1;function BO(r){pE=r}let Cu=typeof window>"u"?{}:window;function z1(r){const t=r+"Storage";try{if(Cu&&Cu[t]&&typeof Cu[t].length=="number")return Cu[t]}catch{}Io[r]=!1}function Y1(r,t){const e=z1(r);if(!e)return;const i=mI(e,Q0);if(i!==q0){if(i){const a=gI(e);for(let c=0;c<a;c++)K0(e,vh+c.toString())}fE(e,Q0,q0),II(e,0);return}const s=Math.floor(Date.now()/k1)-DO,n=a=>{const c=vh+a.toString(),l=mI(e,c);if(typeof l=="string"){try{const h=JSON.parse(l);if(typeof h=="object"&&typeof h.cached=="number"&&h.cached>s&&typeof h.provider=="string"&&typeof h.data=="object"&&typeof h.data.prefix=="string"&&t(h,a))return!0}catch{}K0(e,c)}};let o=gI(e);for(let a=o-1;a>=0;a--)n(a)||(a===o-1?(o--,II(e,o)):V1[r].add(a))}function G1(){if(!pE){BO(!0);for(const r in Io)Y1(r,t=>{const e=t.data,i=t.provider,s=e.prefix,n=yr(i,s);if(!uE(n,e).length)return!1;const o=e.lastModified||-1;return n.lastModifiedCached=n.lastModifiedCached?Math.min(n.lastModifiedCached,o):o,!0})}}function kO(r,t){const e=r.lastModifiedCached;if(e&&e>=t)return e===t;if(r.lastModifiedCached=t,e)for(const i in Io)Y1(i,s=>{const n=s.data;return s.provider!==r.provider||n.prefix!==r.prefix||n.lastModified===t});return!0}function VO(r,t){pE||G1();function e(i){let s;if(!Io[i]||!(s=z1(i)))return;const n=V1[i];let o;if(n.size)n.delete(o=Array.from(n).shift());else if(o=gI(s),o>=UO||!II(s,o+1))return;const a={cached:Math.floor(Date.now()/k1),provider:r.provider,data:t};return fE(s,vh+o.toString(),JSON.stringify(a))}t.lastModified&&!kO(r,t.lastModified)||Object.keys(t.icons).length&&(t.not_found&&(t=Object.assign({},t),delete t.not_found),e("local")||e("session"))}function J0(){}function zO(r){r.iconsLoaderFlag||(r.iconsLoaderFlag=!0,setTimeout(()=>{r.iconsLoaderFlag=!1,_O(r)}))}function YO(r,t){r.iconsToLoad?r.iconsToLoad=r.iconsToLoad.concat(t).sort():r.iconsToLoad=t,r.iconsQueueFlag||(r.iconsQueueFlag=!0,setTimeout(()=>{r.iconsQueueFlag=!1;const{provider:e,prefix:i}=r,s=r.iconsToLoad;delete r.iconsToLoad;let n;!s||!(n=fI(e))||n.prepare(e,i,s).forEach(o=>{U1(e,o,a=>{if(typeof a!="object")o.icons.forEach(c=>{r.missing.add(c)});else try{const c=uE(r,a);if(!c.length)return;const l=r.pendingIcons;l&&c.forEach(h=>{l.delete(h)}),VO(r,a)}catch(c){console.error(c)}zO(r)})})}))}const mE=(r,t)=>{const e=xO(r,!0,P1()),i=wO(e);if(!i.pending.length){let c=!0;return t&&setTimeout(()=>{c&&t(i.loaded,i.missing,i.pending,J0)}),()=>{c=!1}}const s=Object.create(null),n=[];let o,a;return i.pending.forEach(c=>{const{provider:l,prefix:h}=c;if(h===a&&l===o)return;o=l,a=h,n.push(yr(l,h));const u=s[l]||(s[l]=Object.create(null));u[h]||(u[h]=[])}),i.pending.forEach(c=>{const{provider:l,prefix:h,name:u}=c,d=yr(l,h),f=d.pendingIcons||(d.pendingIcons=new Set);f.has(u)||(f.add(u),s[l][h].push(u))}),n.forEach(c=>{const{provider:l,prefix:h}=c;s[l][h].length&&YO(c,s[l][h])}),t?OO(t,i,n):J0},GO=r=>new Promise((t,e)=>{const i=typeof r=="string"?jh(r,!0):r;if(!i){e(r);return}mE([i||r],s=>{if(s.length&&i){const n=yh(i);if(n){t({...Wh,...n});return}}e(r)})});function HO(r){try{const t=typeof r=="string"?JSON.parse(r):r;if(typeof t.body=="string")return{...t}}catch{}}function $O(r,t){const e=typeof r=="string"?jh(r,!0,!0):null;if(!e){const n=HO(r);return{value:r,data:n}}const i=yh(e);if(i!==void 0||!e.prefix)return{value:r,name:e,data:i};const s=mE([e],()=>t(r,e,yh(e)));return{value:r,name:e,loading:s}}function Wp(r){return r.hasAttribute("inline")}let H1=!1;try{H1=navigator.vendor.indexOf("Apple")===0}catch{}function WO(r,t){switch(t){case"svg":case"bg":case"mask":return t}return t!=="style"&&(H1||r.indexOf("<a")===-1)?"svg":r.indexOf("currentColor")===-1?"bg":"mask"}const jO=/(-?[0-9.]*[0-9]+[0-9.]*)/g,XO=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function EI(r,t,e){if(t===1)return r;if(e=e||100,typeof r=="number")return Math.ceil(r*t*e)/e;if(typeof r!="string")return r;const i=r.split(jO);if(i===null||!i.length)return r;const s=[];let n=i.shift(),o=XO.test(n);for(;;){if(o){const a=parseFloat(n);isNaN(a)?s.push(n):s.push(Math.ceil(a*t*e)/e)}else s.push(n);if(n=i.shift(),n===void 0)return s.join("");o=!o}}function ZO(r,t="defs"){let e="";const i=r.indexOf("<"+t);for(;i>=0;){const s=r.indexOf(">",i),n=r.indexOf("</"+t);if(s===-1||n===-1)break;const o=r.indexOf(">",n);if(o===-1)break;e+=r.slice(s+1,n).trim(),r=r.slice(0,i).trim()+r.slice(o+1)}return{defs:e,content:r}}function qO(r,t){return r?"<defs>"+r+"</defs>"+t:t}function QO(r,t,e){const i=ZO(r);return qO(i.defs,t+i.content+e)}const KO=r=>r==="unset"||r==="undefined"||r==="none";function $1(r,t){const e={...Wh,...r},i={...F1,...t},s={left:e.left,top:e.top,width:e.width,height:e.height};let n=e.body;[e,i].forEach(m=>{const g=[],I=m.hFlip,C=m.vFlip;let b=m.rotate;I?C?b+=2:(g.push("translate("+(s.width+s.left).toString()+" "+(0-s.top).toString()+")"),g.push("scale(-1 1)"),s.top=s.left=0):C&&(g.push("translate("+(0-s.left).toString()+" "+(s.height+s.top).toString()+")"),g.push("scale(1 -1)"),s.top=s.left=0);let E;switch(b<0&&(b-=Math.floor(b/4)*4),b=b%4,b){case 1:E=s.height/2+s.top,g.unshift("rotate(90 "+E.toString()+" "+E.toString()+")");break;case 2:g.unshift("rotate(180 "+(s.width/2+s.left).toString()+" "+(s.height/2+s.top).toString()+")");break;case 3:E=s.width/2+s.left,g.unshift("rotate(-90 "+E.toString()+" "+E.toString()+")");break}b%2===1&&(s.left!==s.top&&(E=s.left,s.left=s.top,s.top=E),s.width!==s.height&&(E=s.width,s.width=s.height,s.height=E)),g.length&&(n=QO(n,'<g transform="'+g.join(" ")+'">',"</g>"))});const o=i.width,a=i.height,c=s.width,l=s.height;let h,u;o===null?(u=a===null?"1em":a==="auto"?l:a,h=EI(u,c/l)):(h=o==="auto"?c:o,u=a===null?EI(h,l/c):a==="auto"?l:a);const d={},f=(m,g)=>{KO(g)||(d[m]=g.toString())};f("width",h),f("height",u);const p=[s.left,s.top,c,l];return d.viewBox=p.join(" "),{attributes:d,viewBox:p,body:n}}function IE(r,t){let e=r.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const i in t)e+=" "+i+'="'+t[i]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+e+">"+r+"</svg>"}function JO(r){return r.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function tx(r){return"data:image/svg+xml,"+JO(r)}function W1(r){return'url("'+tx(r)+'")'}const ex=()=>{let r;try{if(r=fetch,typeof r=="function")return r}catch{}};let vf=ex();function ix(r){vf=r}function sx(){return vf}function nx(r,t){const e=Jf(r);if(!e)return 0;let i;if(!e.maxURL)i=0;else{let s=0;e.resources.forEach(o=>{s=Math.max(s,o.length)});const n=t+".json?icons=";i=e.maxURL-s-e.path.length-n.length}return i}function rx(r){return r===404}const ox=(r,t,e)=>{const i=[],s=nx(r,t),n="icons";let o={type:n,provider:r,prefix:t,icons:[]},a=0;return e.forEach((c,l)=>{a+=c.length+1,a>=s&&l>0&&(i.push(o),o={type:n,provider:r,prefix:t,icons:[]},a=c.length),o.icons.push(c)}),i.push(o),i};function ax(r){if(typeof r=="string"){const t=Jf(r);if(t)return t.path}return"/"}const cx=(r,t,e)=>{if(!vf){e("abort",424);return}let i=ax(t.provider);switch(t.type){case"icons":{const n=t.prefix,o=t.icons.join(","),a=new URLSearchParams({icons:o});i+=n+".json?"+a.toString();break}case"custom":{const n=t.uri;i+=n.slice(0,1)==="/"?n.slice(1):n;break}default:e("abort",400);return}let s=503;vf(r+i).then(n=>{const o=n.status;if(o!==200){setTimeout(()=>{e(rx(o)?"abort":"next",o)});return}return s=501,n.json()}).then(n=>{if(typeof n!="object"||n===null){setTimeout(()=>{n===404?e("abort",n):e("next",s)});return}setTimeout(()=>{e("success",n)})}).catch(()=>{e("next",s)})},lx={prepare:ox,send:cx};function tC(r,t){switch(r){case"local":case"session":Io[r]=t;break;case"all":for(const e in Io)Io[e]=t;break}}const jp="data-style";let j1="";function hx(r){j1=r}function eC(r,t){let e=Array.from(r.childNodes).find(i=>i.hasAttribute&&i.hasAttribute(jp));e||(e=document.createElement("style"),e.setAttribute(jp,jp),r.appendChild(e)),e.textContent=":host{display:inline-block;vertical-align:"+(t?"-0.125em":"0")+"}span,svg{display:block}"+j1}function X1(){j0("",lx),P1(!0);let r;try{r=window}catch{}if(r){if(G1(),r.IconifyPreload!==void 0){const t=r.IconifyPreload,e="Invalid IconifyPreload syntax.";typeof t=="object"&&t!==null&&(t instanceof Array?t:[t]).forEach(i=>{try{(typeof i!="object"||i===null||i instanceof Array||typeof i.icons!="object"||typeof i.prefix!="string"||!$0(i))&&console.error(e)}catch{console.error(e)}})}if(r.IconifyProviders!==void 0){const t=r.IconifyProviders;if(typeof t=="object"&&t!==null)for(const e in t){const i="IconifyProviders["+e+"] is invalid.";try{const s=t[e];if(typeof s!="object"||!s||s.resources===void 0)continue;X0(e,s)||console.error(i)}catch{console.error(i)}}}}return{enableCache:t=>tC(t,!0),disableCache:t=>tC(t,!1),iconLoaded:W0,iconExists:W0,getIcon:SO,listIcons:AO,addIcon:L1,addCollection:$0,calculateSize:EI,buildIcon:$1,iconToHTML:IE,svgToURL:W1,loadIcons:mE,loadIcon:GO,addAPIProvider:X0,appendCustomStyle:hx,_api:{getAPIConfig:Jf,setAPIModule:j0,sendAPIQuery:U1,setFetch:ix,getFetch:sx,listAPIProviders:LO}}}const CI={"background-color":"currentColor"},Z1={"background-color":"transparent"},iC={image:"var(--svg)",repeat:"no-repeat",size:"100% 100%"},sC={"-webkit-mask":CI,mask:CI,background:Z1};for(const r in sC){const t=sC[r];for(const e in iC)t[r+"-"+e]=iC[e]}function nC(r){return r?r+(r.match(/^[-0-9.]+$/)?"px":""):"inherit"}function ux(r,t,e){const i=document.createElement("span");let s=r.body;s.indexOf("<a")!==-1&&(s+="<!-- "+Date.now()+" -->");const n=r.attributes,o=IE(s,{...n,width:t.width+"",height:t.height+""}),a=W1(o),c=i.style,l={"--svg":a,width:nC(n.width),height:nC(n.height),...e?CI:Z1};for(const h in l)c.setProperty(h,l[h]);return i}let oh;function dx(){try{oh=window.trustedTypes.createPolicy("iconify",{createHTML:r=>r})}catch{oh=null}}function fx(r){return oh===void 0&&dx(),oh?oh.createHTML(r):r}function px(r){const t=document.createElement("span"),e=r.attributes;let i="";e.width||(i="width: inherit;"),e.height||(i+="height: inherit;"),i&&(e.style=i);const s=IE(r.body,e);return t.innerHTML=fx(s),t.firstChild}function bI(r){return Array.from(r.childNodes).find(t=>{const e=t.tagName&&t.tagName.toUpperCase();return e==="SPAN"||e==="SVG"})}function rC(r,t){const e=t.icon.data,i=t.customisations,s=$1(e,i);i.preserveAspectRatio&&(s.attributes.preserveAspectRatio=i.preserveAspectRatio);const n=t.renderedMode;let o;switch(n){case"svg":o=px(s);break;default:o=ux(s,{...Wh,...e},n==="mask")}const a=bI(r);a?o.tagName==="SPAN"&&a.tagName===o.tagName?a.setAttribute("style",o.getAttribute("style")):r.replaceChild(o,a):r.appendChild(o)}function oC(r,t,e){const i=e&&(e.rendered?e:e.lastRender);return{rendered:!1,inline:t,icon:r,lastRender:i}}function mx(r="iconify-icon"){let t,e;try{t=window.customElements,e=window.HTMLElement}catch{return}if(!t||!e)return;const i=t.get(r);if(i)return i;const s=["icon","mode","inline","observe","width","height","rotate","flip"],n=class extends e{constructor(){super(),$r(this,"_shadowRoot"),$r(this,"_initialised",!1),$r(this,"_state"),$r(this,"_checkQueued",!1),$r(this,"_connected",!1),$r(this,"_observer",null),$r(this,"_visible",!0);const a=this._shadowRoot=this.attachShadow({mode:"open"}),c=Wp(this);eC(a,c),this._state=oC({value:""},c),this._queueCheck()}connectedCallback(){this._connected=!0,this.startObserver()}disconnectedCallback(){this._connected=!1,this.stopObserver()}static get observedAttributes(){return s.slice(0)}attributeChangedCallback(a){switch(a){case"inline":{const c=Wp(this),l=this._state;c!==l.inline&&(l.inline=c,eC(this._shadowRoot,c));break}case"observer":{this.observer?this.startObserver():this.stopObserver();break}default:this._queueCheck()}}get icon(){const a=this.getAttribute("icon");if(a&&a.slice(0,1)==="{")try{return JSON.parse(a)}catch{}return a}set icon(a){typeof a=="object"&&(a=JSON.stringify(a)),this.setAttribute("icon",a)}get inline(){return Wp(this)}set inline(a){a?this.setAttribute("inline","true"):this.removeAttribute("inline")}get observer(){return this.hasAttribute("observer")}set observer(a){a?this.setAttribute("observer","true"):this.removeAttribute("observer")}restartAnimation(){const a=this._state;if(a.rendered){const c=this._shadowRoot;if(a.renderedMode==="svg")try{c.lastChild.setCurrentTime(0);return}catch{}rC(c,a)}}get status(){const a=this._state;return a.rendered?"rendered":a.icon.data===null?"failed":"loading"}_queueCheck(){this._checkQueued||(this._checkQueued=!0,setTimeout(()=>{this._check()}))}_check(){if(!this._checkQueued)return;this._checkQueued=!1;const a=this._state,c=this.getAttribute("icon");if(c!==a.icon.value){this._iconChanged(c);return}if(!a.rendered||!this._visible)return;const l=this.getAttribute("mode"),h=G0(this);(a.attrMode!==l||EO(a.customisations,h)||!bI(this._shadowRoot))&&this._renderIcon(a.icon,h,l)}_iconChanged(a){const c=$O(a,(l,h,u)=>{const d=this._state;if(d.rendered||this.getAttribute("icon")!==l)return;const f={value:l,name:h,data:u};f.data?this._gotIconData(f):d.icon=f});c.data?this._gotIconData(c):this._state=oC(c,this._state.inline,this._state)}_forceRender(){if(!this._visible){const a=bI(this._shadowRoot);a&&this._shadowRoot.removeChild(a);return}this._queueCheck()}_gotIconData(a){this._checkQueued=!1,this._renderIcon(a,G0(this),this.getAttribute("mode"))}_renderIcon(a,c,l){const h=WO(a.data.body,l),u=this._state.inline;rC(this._shadowRoot,this._state={rendered:!0,icon:a,inline:u,customisations:c,attrMode:l,renderedMode:h})}startObserver(){if(!this._observer)try{this._observer=new IntersectionObserver(a=>{const c=a.some(l=>l.isIntersecting);c!==this._visible&&(this._visible=c,this._forceRender())}),this._observer.observe(this)}catch{if(this._observer){try{this._observer.disconnect()}catch{}this._observer=null}}}stopObserver(){this._observer&&(this._observer.disconnect(),this._observer=null,this._visible=!0,this._connected&&this._forceRender())}};s.forEach(a=>{a in n.prototype||Object.defineProperty(n.prototype,a,{get:function(){return this.getAttribute(a)},set:function(c){c!==null?this.setAttribute(a,c):this.removeAttribute(a)}})});const o=X1();for(const a in o)n[a]=n.prototype[a]=o[a];return t.define(r,n),n}mx()||X1();const Ix=Jt`
  ::-webkit-scrollbar {
    width: 0.4rem;
    height: 0.4rem;
    overflow: hidden;
  }

  ::-webkit-scrollbar-thumb {
    border-radius: 0.25rem;
    background-color: var(
      --bim-scrollbar--c,
      color-mix(in lab, var(--bim-ui_main-base), white 15%)
    );
  }

  ::-webkit-scrollbar-track {
    background-color: var(--bim-scrollbar--bgc, var(--bim-ui_bg-base));
  }
`,gx=Jt`
  :root {
    /* Grayscale Colors */
    --bim-ui_gray-0: hsl(210 10% 5%);
    --bim-ui_gray-1: hsl(210 10% 10%);
    --bim-ui_gray-2: hsl(210 10% 20%);
    --bim-ui_gray-3: hsl(210 10% 30%);
    --bim-ui_gray-4: hsl(210 10% 40%);
    --bim-ui_gray-6: hsl(210 10% 60%);
    --bim-ui_gray-7: hsl(210 10% 70%);
    --bim-ui_gray-8: hsl(210 10% 80%);
    --bim-ui_gray-9: hsl(210 10% 90%);
    --bim-ui_gray-10: hsl(210 10% 95%);

    /* Brand Colors */
    --bim-ui_main-base: #6528d7;
    --bim-ui_accent-base: #bcf124;

    /* Brand Colors Contrasts */
    --bim-ui_main-contrast: var(--bim-ui_gray-10);
    --bim-ui_accent-contrast: var(--bim-ui_gray-0);

    /* Sizes */
    --bim-ui_size-4xs: 0.375rem;
    --bim-ui_size-3xs: 0.5rem;
    --bim-ui_size-2xs: 0.625rem;
    --bim-ui_size-xs: 0.75rem;
    --bim-ui_size-sm: 0.875rem;
    --bim-ui_size-base: 1rem;
    --bim-ui_size-lg: 1.125rem;
    --bim-ui_size-xl: 1.25rem;
    --bim-ui_size-2xl: 1.375rem;
    --bim-ui_size-3xl: 1.5rem;
    --bim-ui_size-4xl: 1.625rem;
    --bim-ui_size-5xl: 1.75rem;
    --bim-ui_size-6xl: 1.875rem;
    --bim-ui_size-7xl: 2rem;
    --bim-ui_size-8xl: 2.125rem;
    --bim-ui_size-9xl: 2.25rem;
  }

  /* Background Colors */
  @media (prefers-color-scheme: dark) {
    :root {
      --bim-ui_bg-base: var(--bim-ui_gray-0);
      --bim-ui_bg-contrast-10: var(--bim-ui_gray-1);
      --bim-ui_bg-contrast-20: var(--bim-ui_gray-2);
      --bim-ui_bg-contrast-30: var(--bim-ui_gray-3);
      --bim-ui_bg-contrast-40: var(--bim-ui_gray-4);
      --bim-ui_bg-contrast-60: var(--bim-ui_gray-6);
      --bim-ui_bg-contrast-80: var(--bim-ui_gray-8);
      --bim-ui_bg-contrast-100: var(--bim-ui_gray-10);
    }
  }

  @media (prefers-color-scheme: light) {
    :root {
      --bim-ui_bg-base: var(--bim-ui_gray-10);
      --bim-ui_bg-contrast-10: var(--bim-ui_gray-9);
      --bim-ui_bg-contrast-20: var(--bim-ui_gray-8);
      --bim-ui_bg-contrast-30: var(--bim-ui_gray-7);
      --bim-ui_bg-contrast-40: var(--bim-ui_gray-6);
      --bim-ui_bg-contrast-60: var(--bim-ui_gray-4);
      --bim-ui_bg-contrast-80: var(--bim-ui_gray-2);
      --bim-ui_bg-contrast-100: var(--bim-ui_gray-0);
      --bim-ui_accent-base: #6528d7;
    }
  }

  html.bim-ui-dark {
    --bim-ui_bg-base: var(--bim-ui_gray-0);
    --bim-ui_bg-contrast-10: var(--bim-ui_gray-1);
    --bim-ui_bg-contrast-20: var(--bim-ui_gray-2);
    --bim-ui_bg-contrast-30: var(--bim-ui_gray-3);
    --bim-ui_bg-contrast-40: var(--bim-ui_gray-4);
    --bim-ui_bg-contrast-60: var(--bim-ui_gray-6);
    --bim-ui_bg-contrast-80: var(--bim-ui_gray-8);
    --bim-ui_bg-contrast-100: var(--bim-ui_gray-10);
  }

  html.bim-ui-light {
    --bim-ui_bg-base: var(--bim-ui_gray-10);
    --bim-ui_bg-contrast-10: var(--bim-ui_gray-9);
    --bim-ui_bg-contrast-20: var(--bim-ui_gray-8);
    --bim-ui_bg-contrast-30: var(--bim-ui_gray-7);
    --bim-ui_bg-contrast-40: var(--bim-ui_gray-6);
    --bim-ui_bg-contrast-60: var(--bim-ui_gray-4);
    --bim-ui_bg-contrast-80: var(--bim-ui_gray-2);
    --bim-ui_bg-contrast-100: var(--bim-ui_gray-0);
    --bim-ui_accent-base: #6528d7;
  }

  [data-context-dialog]::backdrop {
    background-color: transparent;
  }
`,Lr={scrollbar:Ix,globalStyles:gx},q1=class Ht{static set config(t){this._config={...Ht._config,...t}}static get config(){return Ht._config}static addGlobalStyles(){let t=document.querySelector("style[id='bim-ui']");if(t)return;t=document.createElement("style"),t.id="bim-ui",t.textContent=Lr.globalStyles.cssText;const e=document.head.firstChild;e?document.head.insertBefore(t,e):document.head.append(t)}static defineCustomElement(t,e){customElements.get(t)||customElements.define(t,e)}static registerComponents(){Ht.init()}static init(){Ht.addGlobalStyles(),Ht.defineCustomElement("bim-button",vx),Ht.defineCustomElement("bim-checkbox",Mc),Ht.defineCustomElement("bim-color-input",Vo),Ht.defineCustomElement("bim-context-menu",yI),Ht.defineCustomElement("bim-dropdown",zn),Ht.defineCustomElement("bim-grid",CE),Ht.defineCustomElement("bim-icon",xx),Ht.defineCustomElement("bim-input",Zh),Ht.defineCustomElement("bim-label",Uc),Ht.defineCustomElement("bim-number-input",Ni),Ht.defineCustomElement("bim-option",Ge),Ht.defineCustomElement("bim-panel",zo),Ht.defineCustomElement("bim-panel-section",Bc),Ht.defineCustomElement("bim-selector",kc),Ht.defineCustomElement("bim-table",us),Ht.defineCustomElement("bim-tabs",Go),Ht.defineCustomElement("bim-tab",Ui),Ht.defineCustomElement("bim-table-cell",uv),Ht.defineCustomElement("bim-table-children",fv),Ht.defineCustomElement("bim-table-group",mv),Ht.defineCustomElement("bim-table-row",Yo),Ht.defineCustomElement("bim-text-input",an),Ht.defineCustomElement("bim-toolbar",rp),Ht.defineCustomElement("bim-toolbar-group",sp),Ht.defineCustomElement("bim-toolbar-section",Yc),Ht.defineCustomElement("bim-viewport",Sv)}static newRandomId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let i=0;i<10;i++){const s=Math.floor(Math.random()*t.length);e+=t.charAt(s)}return e}};q1._config={sectionLabelOnVerticalToolbar:!1};let gE=q1,Ln=class extends Zt{constructor(){super(...arguments),this._lazyLoadObserver=null,this._visibleElements=[],this.ELEMENTS_BEFORE_OBSERVER=20,this.useObserver=!1,this.elements=new Set,this.observe=t=>{if(!this.useObserver)return;for(const i of t)this.elements.add(i);const e=t.slice(this.ELEMENTS_BEFORE_OBSERVER);for(const i of e)i.remove();this.observeLastElement()}}set visibleElements(t){this._visibleElements=this.useObserver?t:[],this.requestUpdate()}get visibleElements(){return this._visibleElements}getLazyObserver(){if(!this.useObserver)return null;if(this._lazyLoadObserver)return this._lazyLoadObserver;const t=new IntersectionObserver(e=>{const i=e[0];if(!i.isIntersecting)return;const s=i.target;t.unobserve(s);const n=this.ELEMENTS_BEFORE_OBSERVER+this.visibleElements.length,o=[...this.elements][n];o&&(this.visibleElements=[...this.visibleElements,o],t.observe(o))},{threshold:.5});return t}observeLastElement(){const t=this.getLazyObserver();if(!t)return;const e=this.ELEMENTS_BEFORE_OBSERVER+this.visibleElements.length-1,i=[...this.elements][e];i&&t.observe(i)}resetVisibleElements(){const t=this.getLazyObserver();if(t){for(const e of this.elements)t.unobserve(e);this.visibleElements=[],this.observeLastElement()}}static create(t,e){const i=document.createDocumentFragment();if(t.length===0)return nc(t(),i),i.firstElementChild;if(!e)throw new Error("UIComponent: Initial state is required for statefull components.");let s=e;const n=t,o=c=>(s={...s,...c},nc(n(s,o),i),s);o(e);const a=()=>s;return[i.firstElementChild,o,a]}};const Rf=(r,t={},e=!0)=>{let i={};for(const s of r.children){const n=s,o=n.getAttribute("name")||n.getAttribute("label"),a=t[o];if(o){if("value"in n&&typeof n.value<"u"&&n.value!==null){const c=n.value;if(typeof c=="object"&&!Array.isArray(c)&&Object.keys(c).length===0)continue;i[o]=a?a(n.value):n.value}else if(e){const c=Rf(n,t);if(Object.keys(c).length===0)continue;i[o]=a?a(c):c}}else e&&(i={...i,...Rf(n,t)})}return i},tp=r=>r==="true"||r==="false"?r==="true":r&&!isNaN(Number(r))&&r.trim()!==""?Number(r):r,Ex=[">=","<=","=",">","<","?","/","#"];function aC(r){const t=Ex.find(o=>r.split(o).length===2),e=r.split(t).map(o=>o.trim()),[i,s]=e,n=s.startsWith("'")&&s.endsWith("'")?s.replace(/'/g,""):tp(s);return{key:i,condition:t,value:n}}const TI=r=>{try{const t=[],e=r.split(/&(?![^()]*\))/).map(i=>i.trim());for(const i of e){const s=!i.startsWith("(")&&!i.endsWith(")"),n=i.startsWith("(")&&i.endsWith(")");if(s){const o=aC(i);t.push(o)}if(n){const o={operator:"&",queries:i.replace(/^(\()|(\))$/g,"").split("&").map(a=>a.trim()).map((a,c)=>{const l=aC(a);return c>0&&(l.operator="&"),l})};t.push(o)}}return t}catch{return null}},cC=(r,t,e)=>{let i=!1;switch(t){case"=":i=r===e;break;case"?":i=String(r).includes(String(e));break;case"<":(typeof r=="number"||typeof e=="number")&&(i=r<e);break;case"<=":(typeof r=="number"||typeof e=="number")&&(i=r<=e);break;case">":(typeof r=="number"||typeof e=="number")&&(i=r>e);break;case">=":(typeof r=="number"||typeof e=="number")&&(i=r>=e);break;case"/":i=String(r).startsWith(String(e));break}return i};var Cx=Object.defineProperty,bx=Object.getOwnPropertyDescriptor,Q1=(r,t,e,i)=>{for(var s=bx(t,e),n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&Cx(t,e,s),s},ke;const EE=(ke=class extends Zt{constructor(){super(...arguments),this._previousContainer=null,this._visible=!1}get placement(){return this._placement}set placement(r){this._placement=r,this.updatePosition()}static removeMenus(){for(const r of ke.menus)r instanceof ke&&(r.visible=!1);ke.dialog.close(),ke.dialog.remove()}get visible(){return this._visible}set visible(r){var t;this._visible=r,r?(ke.dialog.parentElement||document.body.append(ke.dialog),this._previousContainer=this.parentElement,ke.dialog.style.top=`${window.scrollY||document.documentElement.scrollTop}px`,ke.dialog.append(this),ke.dialog.showModal(),this.updatePosition(),this.dispatchEvent(new Event("visible"))):((t=this._previousContainer)==null||t.append(this),this._previousContainer=null,this.dispatchEvent(new Event("hidden")))}async updatePosition(){if(!(this.visible&&this._previousContainer))return;const r=this.placement??"right",t=await C1(this._previousContainer,this,{placement:r,middleware:[r1(10),E1(),g1(),I1({padding:5})]}),{x:e,y:i}=t;this.style.left=`${e}px`,this.style.top=`${i}px`}connectedCallback(){super.connectedCallback(),ke.menus.push(this)}render(){return Tt` <slot></slot> `}},ke.styles=[Lr.scrollbar,Jt`
      :host {
        pointer-events: auto;
        position: absolute;
        top: 0;
        left: 0;
        z-index: 999;
        overflow: auto;
        max-height: 20rem;
        min-width: 3rem;
        flex-direction: column;
        box-shadow: 1px 2px 8px 2px rgba(0, 0, 0, 0.15);
        padding: 0.5rem;
        border-radius: var(--bim-ui_size-4xs);
        display: flex;
        background-color: var(
          --bim-context-menu--bgc,
          var(--bim-ui_bg-contrast-20)
        );
      }

      :host(:not([visible])) {
        display: none;
      }
    `],ke.dialog=Ln.create(()=>Tt` <dialog
      @click=${r=>{r.target===ke.dialog&&ke.removeMenus()}}
      @cancel=${()=>ke.removeMenus()}
      data-context-dialog
      style="
      width: 0;
      height: 0;
      position: relative;
      padding: 0;
      border: none;
      outline: none;
      margin: none;
      overflow: visible;
      background-color: transparent;
    "
    ></dialog>`),ke.menus=[],ke);Q1([ut({type:String,reflect:!0})],EE.prototype,"placement");Q1([ut({type:Boolean,reflect:!0})],EE.prototype,"visible");let yI=EE;var Tx=Object.defineProperty,yx=Object.getOwnPropertyDescriptor,Ls=(r,t,e,i)=>{for(var s=i>1?void 0:i?yx(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&Tx(t,e,s),s},ll;const ls=(ll=class extends Zt{constructor(){super(),this.labelHidden=!1,this.active=!1,this.disabled=!1,this.vertical=!1,this.tooltipVisible=!1,this._stateBeforeLoading={disabled:!1,icon:""},this._loading=!1,this._parent=rc(),this._tooltip=rc(),this._mouseLeave=!1,this.onClick=r=>{r.stopPropagation(),this.disabled||this.dispatchEvent(new Event("click"))},this.showContextMenu=()=>{const r=this._contextMenu;if(r){const t=this.getAttribute("data-context-group");t&&r.setAttribute("data-context-group",t),this.closeNestedContexts();const e=gE.newRandomId();for(const i of r.children)i instanceof ll&&i.setAttribute("data-context-group",e);r.visible=!0}},this.mouseLeave=!0}set loading(r){if(this._loading=r,r)this._stateBeforeLoading={disabled:this.disabled,icon:this.icon},this.disabled=r,this.icon="eos-icons:loading";else{const{disabled:t,icon:e}=this._stateBeforeLoading;this.disabled=t,this.icon=e}}get loading(){return this._loading}set mouseLeave(r){this._mouseLeave=r,r&&(this.tooltipVisible=!1,clearTimeout(this.timeoutID))}get mouseLeave(){return this._mouseLeave}computeTooltipPosition(){const{value:r}=this._parent,{value:t}=this._tooltip;r&&t&&C1(r,t,{placement:"bottom",middleware:[r1(10),E1(),g1(),I1({padding:5})]}).then(e=>{const{x:i,y:s}=e;Object.assign(t.style,{left:`${i}px`,top:`${s}px`})})}onMouseEnter(){if(!(this.tooltipTitle||this.tooltipText))return;this.mouseLeave=!1;const r=this.tooltipTime??700;this.timeoutID=setTimeout(()=>{this.mouseLeave||(this.computeTooltipPosition(),this.tooltipVisible=!0)},r)}closeNestedContexts(){const r=this.getAttribute("data-context-group");if(r)for(const t of yI.dialog.children){const e=t.getAttribute("data-context-group");if(t instanceof yI&&e===r){t.visible=!1,t.removeAttribute("data-context-group");for(const i of t.children)i instanceof ll&&(i.closeNestedContexts(),i.removeAttribute("data-context-group"))}}}click(){this.disabled||super.click()}get _contextMenu(){return this.querySelector("bim-context-menu")}connectedCallback(){super.connectedCallback(),this.addEventListener("click",this.showContextMenu)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("click",this.showContextMenu)}render(){const r=Tt`
      <div ${oc(this._tooltip)} class="tooltip">
        ${this.tooltipTitle?Tt`<p style="text-wrap: nowrap;">
              <strong>${this.tooltipTitle}</strong>
            </p>`:null}
        ${this.tooltipText?Tt`<p style="width: 9rem;">${this.tooltipText}</p>`:null}
      </div>
    `,t=Tt`<svg
      xmlns="http://www.w3.org/2000/svg"
      height="1.125rem"
      viewBox="0 0 24 24"
      width="1.125rem"
      style="fill: var(--bim-label--c)"
    >
      <path d="M0 0h24v24H0V0z" fill="none" />
      <path d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z" />
    </svg>`;return Tt`
      <div ${oc(this._parent)} class="parent" @click=${this.onClick}>
        ${this.label||this.icon?Tt`
              <div
                class="button"
                @mouseenter=${this.onMouseEnter}
                @mouseleave=${()=>this.mouseLeave=!0}
              >
                <bim-label
                  .icon=${this.icon}
                  .vertical=${this.vertical}
                  .labelHidden=${this.labelHidden}
                  >${this.label}${this.label&&this._contextMenu?t:null}</bim-label
                >
              </div>
            `:null}
        ${this.tooltipTitle||this.tooltipText?r:null}
      </div>
      <slot></slot>
    `}},ll.styles=Jt`
    :host {
      --bim-label--c: var(--bim-ui_bg-contrast-100, white);
      display: block;
      flex: 1;
      pointer-events: none;
      background-color: var(--bim-button--bgc, var(--bim-ui_bg-contrast-20));
      border-radius: var(--bim-ui_size-4xs);
      transition: all 0.15s;
    }

    :host(:not([disabled]):hover) {
      cursor: pointer;
    }

    bim-label {
      pointer-events: none;
    }

    .parent {
      --bim-icon--c: var(--bim-label--c);
      position: relative;
      display: flex;
      height: 100%;
      user-select: none;
      row-gap: 0.125rem;
      min-height: var(--bim-ui_size-5xl);
      min-width: var(--bim-ui_size-5xl);
    }

    .button,
    .children {
      box-sizing: border-box;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: auto;
    }

    .children {
      padding: 0 0.375rem;
      position: absolute;
      height: 100%;
      right: 0;
    }

    :host(:not([label-hidden])[icon][vertical]) .parent {
      min-height: 2.5rem;
    }

    .button {
      flex-grow: 1;
    }

    :host(:not([label-hidden])[label]) .button {
      justify-content: var(--bim-button--jc, center);
    }

    :host(:hover),
    :host([active]) {
      --bim-label--c: var(--bim-ui_main-contrast);
      background-color: var(--bim-ui_main-base);
    }

    :host(:not([label]):not([icon])) .children {
      flex: 1;
    }

    :host([vertical]) .parent {
      justify-content: center;
    }

    :host(:not([label-hidden])[label]) .button {
      padding: 0 0.5rem;
    }

    :host([disabled]) {
      --bim-label--c: var(--bim-ui_bg-contrast-80) !important;
      background-color: gray !important;
    }

    ::slotted(bim-button) {
      --bim-icon--fz: var(--bim-ui_size-base);
      --bim-button--bdrs: var(--bim-ui_size-4xs);
      --bim-button--olw: 0;
      --bim-button--olc: transparent;
    }

    .tooltip {
      position: absolute;
      padding: 0.75rem;
      z-index: 99;
      display: flex;
      flex-flow: column;
      row-gap: 0.375rem;
      box-shadow: 0 0 10px 3px rgba(0 0 0 / 20%);
      outline: 1px solid var(--bim-ui_bg-contrast-40);
      font-size: var(--bim-ui_size-xs);
      border-radius: var(--bim-ui_size-4xs);
      background-color: var(--bim-ui_bg-contrast-20);
      color: var(--bim-ui_bg-contrast-100);
    }

    .tooltip p {
      margin: 0;
      padding: 0;
    }

    :host(:not([tooltip-visible])) .tooltip {
      display: none;
    }
  `,ll);Ls([ut({type:String,reflect:!0})],ls.prototype,"label",2);Ls([ut({type:Boolean,attribute:"label-hidden",reflect:!0})],ls.prototype,"labelHidden",2);Ls([ut({type:Boolean,reflect:!0})],ls.prototype,"active",2);Ls([ut({type:Boolean,reflect:!0,attribute:"disabled"})],ls.prototype,"disabled",2);Ls([ut({type:String,reflect:!0})],ls.prototype,"icon",2);Ls([ut({type:Boolean,reflect:!0})],ls.prototype,"vertical",2);Ls([ut({type:Number,attribute:"tooltip-time",reflect:!0})],ls.prototype,"tooltipTime",2);Ls([ut({type:Boolean,attribute:"tooltip-visible",reflect:!0})],ls.prototype,"tooltipVisible",2);Ls([ut({type:String,attribute:"tooltip-title",reflect:!0})],ls.prototype,"tooltipTitle",2);Ls([ut({type:String,attribute:"tooltip-text",reflect:!0})],ls.prototype,"tooltipText",2);Ls([ut({type:Boolean,reflect:!0})],ls.prototype,"loading",1);let vx=ls;var Rx=Object.defineProperty,Xh=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&Rx(t,e,s),s};const K1=class extends Zt{constructor(){super(...arguments),this.checked=!1,this.inverted=!1,this.onValueChange=new Event("change")}get value(){return this.checked}onChange(t){t.stopPropagation(),this.checked=t.target.checked,this.dispatchEvent(this.onValueChange)}render(){return Tt`
      <div class="parent">
        ${this.label?Tt`<bim-label .icon="${this.icon}">${this.label}</bim-label> `:null}
        <input
          type="checkbox"
          aria-label=${this.label||this.name||"Checkbox Input"}
          @change="${this.onChange}"
          .checked="${this.checked}"
        />
      </div>
    `}};K1.styles=Jt`
    :host {
      display: block;
    }

    .parent {
      display: flex;
      justify-content: space-between;
      height: 1.75rem;
      column-gap: 0.25rem;
      width: 100%;
      align-items: center;
      transition: all 0.15s;
    }

    :host([inverted]) .parent {
      flex-direction: row-reverse;
      justify-content: start;
    }

    input {
      height: 1rem;
      width: 1rem;
      cursor: pointer;
      border: none;
      outline: none;
      accent-color: var(--bim-checkbox--c, var(--bim-ui_main-base));
      transition: all 0.15s;
    }

    input:focus {
      outline: var(--bim-checkbox--olw, 2px) solid
        var(--bim-checkbox--olc, var(--bim-ui_accent-base));
    }
  `;let Mc=K1;Xh([ut({type:String,reflect:!0})],Mc.prototype,"icon");Xh([ut({type:String,reflect:!0})],Mc.prototype,"name");Xh([ut({type:String,reflect:!0})],Mc.prototype,"label");Xh([ut({type:Boolean,reflect:!0})],Mc.prototype,"checked");Xh([ut({type:Boolean,reflect:!0})],Mc.prototype,"inverted");var Ax=Object.defineProperty,Dc=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&Ax(t,e,s),s};const J1=class extends Zt{constructor(){super(...arguments),this.vertical=!1,this.color="#bcf124",this._colorInput=rc(),this._textInput=rc(),this.onValueChange=new Event("input"),this.onOpacityInput=t=>{const e=t.target;this.opacity=e.value,this.dispatchEvent(this.onValueChange)}}set value(t){const{color:e,opacity:i}=t;this.color=e,i&&(this.opacity=i)}get value(){const t={color:this.color};return this.opacity&&(t.opacity=this.opacity),t}onColorInput(t){t.stopPropagation();const{value:e}=this._colorInput;e&&(this.color=e.value,this.dispatchEvent(this.onValueChange))}onTextInput(t){t.stopPropagation();const{value:e}=this._textInput;if(!e)return;const{value:i}=e;let s=i.replace(/[^a-fA-F0-9]/g,"");s.startsWith("#")||(s=`#${s}`),e.value=s.slice(0,7),e.value.length===7&&(this.color=e.value,this.dispatchEvent(this.onValueChange))}focus(){const{value:t}=this._colorInput;t&&t.click()}render(){return Tt`
      <div class="parent">
        <bim-input
          .label=${this.label}
          .icon=${this.icon}
          .vertical="${this.vertical}"
        >
          <div class="color-container">
            <div
              style="display: flex; align-items: center; gap: .375rem; height: 100%; flex: 1; padding: 0 0.5rem;"
            >
              <input
                ${oc(this._colorInput)}
                @input="${this.onColorInput}"
                type="color"
                aria-label=${this.label||this.name||"Color Input"}
                value="${this.color}"
              />
              <div
                @click=${this.focus}
                class="sample"
                style="background-color: ${this.color}"
              ></div>
              <input
                ${oc(this._textInput)}
                @input="${this.onTextInput}"
                value="${this.color}"
                type="text"
                aria-label=${this.label||this.name||"Text Color Input"}
              />
            </div>
            ${this.opacity!==void 0?Tt`<bim-number-input
                  @change=${this.onOpacityInput}
                  slider
                  suffix="%"
                  min="0"
                  value=${this.opacity}
                  max="100"
                ></bim-number-input>`:null}
          </div>
        </bim-input>
      </div>
    `}};J1.styles=Jt`
    :host {
      --bim-input--bgc: var(--bim-ui_bg-contrast-20);
      flex: 1;
      display: block;
    }

    :host(:focus) {
      --bim-input--olw: var(--bim-number-input--olw, 2px);
      --bim-input--olc: var(--bim-ui_accent-base);
    }

    .parent {
      display: flex;
      gap: 0.375rem;
    }

    .color-container {
      position: relative;
      outline: none;
      display: flex;
      height: 100%;
      gap: 0.5rem;
      justify-content: flex-start;
      align-items: center;
      flex: 1;
      border-radius: var(--bim-color-input--bdrs, var(--bim-ui_size-4xs));
    }

    .color-container input[type="color"] {
      position: absolute;
      bottom: -0.25rem;
      visibility: hidden;
      width: 0;
      height: 0;
    }

    .color-container .sample {
      width: 1rem;
      height: 1rem;
      border-radius: 0.125rem;
      background-color: #fff;
    }

    .color-container input[type="text"] {
      height: 100%;
      flex: 1;
      width: 3.25rem;
      text-transform: uppercase;
      font-size: 0.75rem;
      background-color: transparent;
      padding: 0%;
      outline: none;
      border: none;
      color: var(--bim-color-input--c, var(--bim-ui_bg-contrast-100));
    }

    bim-number-input {
      flex-grow: 0;
    }
  `;let Vo=J1;Dc([ut({type:String,reflect:!0})],Vo.prototype,"name");Dc([ut({type:String,reflect:!0})],Vo.prototype,"label");Dc([ut({type:String,reflect:!0})],Vo.prototype,"icon");Dc([ut({type:Boolean,reflect:!0})],Vo.prototype,"vertical");Dc([ut({type:Number,reflect:!0})],Vo.prototype,"opacity");Dc([ut({type:String,reflect:!0})],Vo.prototype,"color");var Sx=Object.defineProperty,wx=Object.getOwnPropertyDescriptor,Mr=(r,t,e,i)=>{for(var s=i>1?void 0:i?wx(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&Sx(t,e,s),s};const tv=class extends Zt{constructor(){super(...arguments),this.checked=!1,this.checkbox=!1,this.noMark=!1,this.vertical=!1}get value(){return this._value!==void 0?this._value:this.label?tp(this.label):this.label}set value(t){this._value=t}render(){return Tt`
      <div class="parent" .title=${this.label??""}>
        ${this.img||this.icon||this.label?Tt` <div style="display: flex; column-gap: 0.375rem">
              ${this.checkbox&&!this.noMark?Tt`<bim-checkbox
                    style="pointer-events: none"
                    .checked=${this.checked}
                  ></bim-checkbox>`:null}
              <bim-label
                .vertical=${this.vertical}
                .icon=${this.icon}
                .img=${this.img}
                >${this.label}</bim-label
              >
            </div>`:null}
        ${!this.checkbox&&!this.noMark&&this.checked?Tt`<svg
              xmlns="http://www.w3.org/2000/svg"
              height="1.125rem"
              viewBox="0 0 24 24"
              width="1.125rem"
              fill="#FFFFFF"
            >
              <path d="M0 0h24v24H0z" fill="none" />
              <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
            </svg>`:null}
        <slot></slot>
      </div>
    `}};tv.styles=Jt`
    :host {
      --bim-label--c: var(--bim-ui_bg-contrast-100);
      display: block;
      box-sizing: border-box;
      flex: 1;
      padding: 0rem 0.5rem;
      border-radius: var(--bim-ui_size-4xs);
      transition: all 0.15s;
    }

    :host(:hover) {
      cursor: pointer;
      background-color: color-mix(
        in lab,
        var(--bim-selector--bgc, var(--bim-ui_bg-contrast-20)),
        var(--bim-ui_main-base) 10%
      );
    }

    :host([checked]) {
      --bim-label--c: color-mix(in lab, var(--bim-ui_main-base), white 30%);
    }

    :host([checked]) svg {
      fill: color-mix(in lab, var(--bim-ui_main-base), white 30%);
    }

    .parent {
      box-sizing: border-box;
      display: flex;
      justify-content: var(--bim-option--jc, space-between);
      column-gap: 0.5rem;
      align-items: center;
      min-height: 1.75rem;
      height: 100%;
    }

    input {
      height: 1rem;
      width: 1rem;
      cursor: pointer;
      border: none;
      outline: none;
      accent-color: var(--bim-checkbox--c, var(--bim-ui_main-base));
    }

    input:focus {
      outline: var(--bim-checkbox--olw, 2px) solid
        var(--bim-checkbox--olc, var(--bim-ui_accent-base));
    }

    bim-label {
      pointer-events: none;
    }
  `;let Ge=tv;Mr([ut({type:String,reflect:!0})],Ge.prototype,"img",2);Mr([ut({type:String,reflect:!0})],Ge.prototype,"label",2);Mr([ut({type:String,reflect:!0})],Ge.prototype,"icon",2);Mr([ut({type:Boolean,reflect:!0})],Ge.prototype,"checked",2);Mr([ut({type:Boolean,reflect:!0})],Ge.prototype,"checkbox",2);Mr([ut({type:Boolean,attribute:"no-mark",reflect:!0})],Ge.prototype,"noMark",2);Mr([ut({converter:{fromAttribute(r){return r&&tp(r)}}})],Ge.prototype,"value",1);Mr([ut({type:Boolean,reflect:!0})],Ge.prototype,"vertical",2);var _x=Object.defineProperty,Fx=Object.getOwnPropertyDescriptor,Dr=(r,t,e,i)=>{for(var s=i>1?void 0:i?Fx(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&_x(t,e,s),s};const ev=class extends Ln{constructor(){super(),this.multiple=!1,this.required=!1,this.vertical=!1,this._visible=!1,this._value=new Set,this.onValueChange=new Event("change"),this._contextMenu=rc(),this.onOptionClick=t=>{const e=t.target,i=this._value.has(e);if(!this.multiple&&!this.required&&!i)this._value=new Set([e]);else if(!this.multiple&&!this.required&&i)this._value=new Set([]);else if(!this.multiple&&this.required&&!i)this._value=new Set([e]);else if(this.multiple&&!this.required&&!i)this._value=new Set([...this._value,e]);else if(this.multiple&&!this.required&&i){const s=[...this._value].filter(n=>n!==e);this._value=new Set(s)}else if(this.multiple&&this.required&&!i)this._value=new Set([...this._value,e]);else if(this.multiple&&this.required&&i){const s=[...this._value].filter(o=>o!==e),n=new Set(s);n.size!==0&&(this._value=n)}this.updateOptionsState(),this.dispatchEvent(this.onValueChange)},this.useObserver=!0}set visible(t){if(t){const{value:e}=this._contextMenu;if(!e)return;for(const i of this.elements)e.append(i);this._visible=!0}else{for(const e of this.elements)this.append(e);this._visible=!1,this.resetVisibleElements()}}get visible(){return this._visible}set value(t){if(this.required&&Object.keys(t).length===0)return;const e=new Set;for(const i of t){const s=this.findOption(i);if(s&&(e.add(s),!this.multiple&&Object.keys(t).length===1))break}this._value=e,this.updateOptionsState(),this.dispatchEvent(this.onValueChange)}get value(){return[...this._value].filter(t=>t instanceof Ge&&t.checked).map(t=>t.value)}get _options(){const t=new Set([...this.elements]);for(const e of this.children)e instanceof Ge&&t.add(e);return[...t]}onSlotChange(t){const e=t.target.assignedElements();this.observe(e);const i=new Set;for(const s of this.elements){if(!(s instanceof Ge)){s.remove();continue}s.checked&&i.add(s),s.removeEventListener("click",this.onOptionClick),s.addEventListener("click",this.onOptionClick)}this._value=i}updateOptionsState(){for(const t of this._options)t instanceof Ge&&(t.checked=this._value.has(t))}findOption(t){return this._options.find(e=>e instanceof Ge?e.label===t||e.value===t:!1)}render(){let t,e,i;if(this._value.size===0)t="Select an option...";else if(this._value.size===1){const s=[...this._value][0];t=s?.label||s?.value,e=s?.img,i=s?.icon}else t=`Multiple (${this._value.size})`;return Tt`
      <bim-input
        title=${this.label??""}
        .label=${this.label}
        .icon=${this.icon}
        .vertical=${this.vertical}
      >
        <div class="input" @click=${()=>this.visible=!this.visible}>
          <bim-label
            .img=${e}
            .icon=${i}
            style="overflow: hidden;"
            >${t}</bim-label
          >
          <svg
            style="flex-shrink: 0; fill: var(--bim-dropdown--c, var(--bim-ui_bg-contrast-100))"
            xmlns="http://www.w3.org/2000/svg"
            height="1.125rem"
            viewBox="0 0 24 24"
            width="1.125rem"
            fill="#9ca3af"
          >
            <path d="M0 0h24v24H0V0z" fill="none" />
            <path d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z" />
          </svg>
          <bim-context-menu
            ${oc(this._contextMenu)}
            .visible=${this.visible}
            @hidden=${()=>{this.visible&&(this.visible=!1)}}
          >
            <slot @slotchange=${this.onSlotChange}></slot>
          </bim-context-menu>
        </div>
      </bim-input>
    `}};ev.styles=[Lr.scrollbar,Jt`
      :host {
        --bim-input--bgc: var(
          --bim-dropdown--bgc,
          var(--bim-ui_bg-contrast-20)
        );
        --bim-input--olw: 2px;
        --bim-input--olc: transparent;
        --bim-input--bdrs: var(--bim-ui_size-4xs);
        flex: 1;
        display: block;
      }

      :host([visible]) {
        --bim-input--olc: var(--bim-ui_accent-base);
      }

      .input {
        --bim-label--fz: var(--bim-drodown--fz, var(--bim-ui_size-xs));
        --bim-label--c: var(--bim-dropdown--c, var(--bim-ui_bg-contrast-100));
        height: 100%;
        display: flex;
        flex: 1;
        overflow: hidden;
        column-gap: 0.25rem;
        outline: none;
        cursor: pointer;
        align-items: center;
        justify-content: space-between;
        padding: 0 0.5rem;
      }

      bim-label {
        pointer-events: none;
      }
    `];let zn=ev;Dr([ut({type:String,reflect:!0})],zn.prototype,"name",2);Dr([ut({type:String,reflect:!0})],zn.prototype,"icon",2);Dr([ut({type:String,reflect:!0})],zn.prototype,"label",2);Dr([ut({type:Boolean,reflect:!0})],zn.prototype,"multiple",2);Dr([ut({type:Boolean,reflect:!0})],zn.prototype,"required",2);Dr([ut({type:Boolean,reflect:!0})],zn.prototype,"vertical",2);Dr([ut({type:Boolean,reflect:!0})],zn.prototype,"visible",1);Dr([Lc()],zn.prototype,"_value",2);var Ox=Object.defineProperty,iv=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&Ox(t,e,s),s};const sv=class extends Zt{constructor(){super(...arguments),this.floating=!1,this._layouts={},this._updateFunctions={}}set layouts(t){this._layouts=t;const e={};for(const[i,s]of Object.entries(t))for(const n in s.elements)e[i]||(e[i]={}),e[i][n]=o=>{const a=this._updateFunctions[i];if(!a)return;const c=a[n];c&&c(o)};this.updateComponent=e}get layouts(){return this._layouts}getLayoutAreas(t){const{template:e}=t,i=e.split(`
`).map(s=>s.trim()).map(s=>s.split('"')[1]).filter(s=>s!==void 0).flatMap(s=>s.split(/\s+/));return[...new Set(i)].filter(s=>s!=="")}firstUpdated(){this._onLayoutChange=new Event("layoutchange")}render(){if(this.layout){if(this._updateFunctions={},this.layouts[this.layout]){this.innerHTML="",this._updateFunctions[this.layout]={};const t=this._updateFunctions[this.layout],e=this.layouts[this.layout],i=this.getLayoutAreas(e).map(s=>{const n=e.elements[s];if(!n)return null;if(n instanceof HTMLElement)return n.style.gridArea=s,n;if("template"in n){const{template:o,initialState:a}=n,[c,l]=Ln.create(o,a);return c.style.gridArea=s,t[s]=l,c}return Ln.create(n)}).filter(s=>!!s);this.style.gridTemplate=e.template,this.append(...i),this._onLayoutChange&&this.dispatchEvent(this._onLayoutChange)}}else this._updateFunctions={},this.innerHTML="",this.style.gridTemplate="",this._onLayoutChange&&this.dispatchEvent(this._onLayoutChange);return Tt`<slot></slot>`}};sv.styles=Jt`
    :host {
      display: grid;
      height: 100%;
      width: 100%;
      overflow: hidden;
      box-sizing: border-box;
    }

    /* :host(:not([layout])) {
      display: none;
    } */

    :host([floating]) {
      --bim-panel--bdrs: var(--bim-ui_size-4xs);
      background-color: transparent;
      padding: 1rem;
      gap: 1rem;
      position: absolute;
      pointer-events: none;
      top: 0px;
      left: 0px;
    }

    :host(:not([floating])) {
      --bim-panel--bdrs: 0;
      background-color: var(--bim-ui_bg-contrast-20);
      gap: 1px;
    }
  `;let CE=sv;iv([ut({type:Boolean,reflect:!0})],CE.prototype,"floating");iv([ut({type:String,reflect:!0})],CE.prototype,"layout");const vI=class extends Zt{render(){return Tt`
      <iconify-icon .icon=${this.icon} height="none"></iconify-icon>
    `}};vI.styles=Jt`
    :host {
      height: var(--bim-icon--fz, var(--bim-ui_size-sm));
      width: var(--bim-icon--fz, var(--bim-ui_size-sm));
    }

    iconify-icon {
      height: var(--bim-icon--fz, var(--bim-ui_size-sm));
      width: var(--bim-icon--fz, var(--bim-ui_size-sm));
      color: var(--bim-icon--c);
      transition: all 0.15s;
    }
  `,vI.properties={icon:{type:String}};let xx=vI;var Nx=Object.defineProperty,ep=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&Nx(t,e,s),s};const nv=class extends Zt{constructor(){super(...arguments),this.vertical=!1,this.onValueChange=new Event("change")}get value(){const t={};for(const e of this.children){const i=e;"value"in i?t[i.name||i.label]=i.value:"checked"in i&&(t[i.name||i.label]=i.checked)}return t}set value(t){const e=[...this.children];for(const i in t){const s=e.find(a=>{const c=a;return c.name===i||c.label===i});if(!s)continue;const n=s,o=t[i];typeof o=="boolean"?n.checked=o:n.value=o}}render(){return Tt`
      <div class="parent">
        ${this.label||this.icon?Tt`<bim-label .icon=${this.icon}>${this.label}</bim-label>`:null}
        <div class="input">
          <slot></slot>
        </div>
      </div>
    `}};nv.styles=Jt`
    :host {
      flex: 1;
      display: block;
    }

    .parent {
      display: flex;
      flex-wrap: wrap;
      column-gap: 1rem;
      row-gap: 0.375rem;
      user-select: none;
      flex: 1;
    }

    :host(:not([vertical])) .parent {
      justify-content: space-between;
    }

    :host([vertical]) .parent {
      flex-direction: column;
    }

    .input {
      overflow: hidden;
      box-sizing: border-box;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      min-height: 1.75rem;
      min-width: 3rem;
      gap: var(--bim-input--g, var(--bim-ui_size-4xs));
      padding: var(--bim-input--p, 0);
      background-color: var(--bim-input--bgc, transparent);
      outline: var(--bim-input--olw, 2px) solid
        var(--bim-input--olc, transparent);
      border-radius: var(--bim-input--bdrs, var(--bim-ui_size-4xs));
      transition: all 0.15s;
    }

    :host(:not([vertical])) .input {
      flex: 1;
      justify-content: flex-end;
    }

    :host(:not([vertical])[label]) .input {
      max-width: fit-content;
    }
  `;let Zh=nv;ep([ut({type:String,reflect:!0})],Zh.prototype,"name");ep([ut({type:String,reflect:!0})],Zh.prototype,"label");ep([ut({type:String,reflect:!0})],Zh.prototype,"icon");ep([ut({type:Boolean,reflect:!0})],Zh.prototype,"vertical");var Px=Object.defineProperty,qh=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&Px(t,e,s),s};const rv=class extends Zt{constructor(){super(...arguments),this.labelHidden=!1,this.iconHidden=!1,this.vertical=!1}get value(){return this.textContent?tp(this.textContent):this.textContent}render(){return Tt`
      <div class="parent" .title=${this.textContent??""}>
        ${this.img?Tt`<img .src=${this.img} .alt=${this.textContent||""} />`:null}
        ${!this.iconHidden&&this.icon?Tt`<bim-icon .icon=${this.icon}></bim-icon>`:null}
        <p><slot></slot></p>
      </div>
    `}};rv.styles=Jt`
    :host {
      --bim-icon--c: var(--bim-label--c);
      color: var(--bim-label--c, var(--bim-ui_bg-contrast-60));
      font-size: var(--bim-label--fz, var(--bim-ui_size-xs));
      overflow: hidden;
      display: block;
      white-space: nowrap;
      line-height: 1.1rem;
      transition: all 0.15s;
    }

    .parent {
      display: flex;
      align-items: center;
      column-gap: 0.25rem;
      row-gap: 0.125rem;
      user-select: none;
      height: 100%;
    }

    :host([vertical]) .parent {
      flex-direction: column;
    }

    .parent p {
      margin: 0;
      text-overflow: ellipsis;
      overflow: hidden;
      display: flex;
      align-items: center;
      gap: 0.125rem;
    }

    :host([label-hidden]) .parent p,
    :host(:empty) .parent p {
      display: none;
    }

    img {
      height: 100%;
      aspect-ratio: 1;
      border-radius: 100%;
      margin-right: 0.125rem;
    }

    :host(:not([vertical])) img {
      max-height: var(
        --bim-label_icon--sz,
        calc(var(--bim-label--fz, var(--bim-ui_size-xs)) * 1.8)
      );
    }

    :host([vertical]) img {
      max-height: var(
        --bim-label_icon--sz,
        calc(var(--bim-label--fz, var(--bim-ui_size-xs)) * 4)
      );
    }
  `;let Uc=rv;qh([ut({type:String,reflect:!0})],Uc.prototype,"img");qh([ut({type:Boolean,attribute:"label-hidden",reflect:!0})],Uc.prototype,"labelHidden");qh([ut({type:String,reflect:!0})],Uc.prototype,"icon");qh([ut({type:Boolean,attribute:"icon-hidden",reflect:!0})],Uc.prototype,"iconHidden");qh([ut({type:Boolean,reflect:!0})],Uc.prototype,"vertical");var Lx=Object.defineProperty,Mx=Object.getOwnPropertyDescriptor,hs=(r,t,e,i)=>{for(var s=i>1?void 0:i?Mx(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&Lx(t,e,s),s};const ov=class extends Zt{constructor(){super(...arguments),this._value=0,this.vertical=!1,this.slider=!1,this._input=rc(),this.onValueChange=new Event("change")}set value(t){this.setValue(t.toString())}get value(){return this._value}onChange(t){t.stopPropagation();const{value:e}=this._input;e&&this.setValue(e.value)}setValue(t){const{value:e}=this._input;let i=t;if(i=i.replace(/[^0-9.-]/g,""),i=i.replace(/(\..*)\./g,"$1"),i.endsWith(".")||(i.lastIndexOf("-")>0&&(i=i[0]+i.substring(1).replace(/-/g,"")),i==="-"||i==="-0"))return;let s=Number(i);Number.isNaN(s)||(s=this.min!==void 0?Math.max(s,this.min):s,s=this.max!==void 0?Math.min(s,this.max):s,this.value!==s&&(this._value=s,e&&(e.value=this.value.toString()),this.requestUpdate(),this.dispatchEvent(this.onValueChange)))}onBlur(){const{value:t}=this._input;t&&Number.isNaN(Number(t.value))&&(t.value=this.value.toString())}onSliderMouseDown(t){document.body.style.cursor="w-resize";const{clientX:e}=t,i=this.value;let s=!1;const n=c=>{var l;s=!0;const{clientX:h}=c,u=this.step??1,d=((l=u.toString().split(".")[1])==null?void 0:l.length)||0,f=1/(this.sensitivity??1),p=(h-e)/f;if(Math.floor(Math.abs(p))!==Math.abs(p))return;const m=i+p*u;this.setValue(m.toFixed(d))},o=()=>{this.slider=!0,this.removeEventListener("blur",o)},a=()=>{document.removeEventListener("mousemove",n),document.body.style.cursor="default",s?s=!1:(this.addEventListener("blur",o),this.slider=!1,requestAnimationFrame(()=>this.focus())),document.removeEventListener("mouseup",a)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",a)}onFocus(t){t.stopPropagation();const e=i=>{i.key==="Escape"&&(this.blur(),window.removeEventListener("keydown",e))};window.addEventListener("keydown",e)}connectedCallback(){super.connectedCallback(),this.min&&this.min>this.value&&(this._value=this.min),this.max&&this.max<this.value&&(this._value=this.max)}focus(){const{value:t}=this._input;t&&t.focus()}render(){const t=Tt`
      ${this.pref||this.icon?Tt`<bim-label
            style="pointer-events: auto"
            @mousedown=${this.onSliderMouseDown}
            .icon=${this.icon}
            >${this.pref}</bim-label
          >`:null}
      <input
        ${oc(this._input)}
        type="text"
        aria-label=${this.label||this.name||"Number Input"}
        size="1"
        @input=${a=>a.stopPropagation()}
        @change=${this.onChange}
        @blur=${this.onBlur}
        @focus=${this.onFocus}
        .value=${this.value.toString()}
      />
      ${this.suffix?Tt`<bim-label
            style="pointer-events: auto"
            @mousedown=${this.onSliderMouseDown}
            >${this.suffix}</bim-label
          >`:null}
    `,e=this.min??-1/0,i=this.max??1/0,s=100*(this.value-e)/(i-e),n=Tt`
      <style>
        .slider-indicator {
          width: ${`${s}%`};
        }
      </style>
      <div class="slider" @mousedown=${this.onSliderMouseDown}>
        <div class="slider-indicator"></div>
        ${this.pref||this.icon?Tt`<bim-label
              style="z-index: 1; margin-right: 0.125rem"
              .icon=${this.icon}
              >${`${this.pref}: `}</bim-label
            >`:null}
        <bim-label style="z-index: 1;">${this.value}</bim-label>
        ${this.suffix?Tt`<bim-label style="z-index: 1;">${this.suffix}</bim-label>`:null}
      </div>
    `,o=`${this.label||this.name||this.pref?`${this.label||this.name||this.pref}: `:""}${this.value}${this.suffix??""}`;return Tt`
      <bim-input
        title=${o}
        .label=${this.label}
        .icon=${this.icon}
        .vertical=${this.vertical}
      >
        ${this.slider?n:t}
      </bim-input>
    `}};ov.styles=Jt`
    :host {
      --bim-input--bgc: var(
        --bim-number-input--bgc,
        var(--bim-ui_bg-contrast-20)
      );
      --bim-input--olw: var(--bim-number-input--olw, 2px);
      --bim-input--olc: var(--bim-number-input--olc, transparent);
      --bim-input--bdrs: var(--bim-number-input--bdrs, var(--bim-ui_size-4xs));
      --bim-input--p: 0 0.375rem;
      flex: 1;
      display: block;
    }

    :host(:focus) {
      --bim-input--olw: var(--bim-number-input--olw, 2px);
      --bim-input--olc: var(
        --bim-number-inputfocus--c,
        var(--bim-ui_accent-base)
      );
    }

    :host(:not([slider])) bim-label {
      --bim-label--c: var(
        --bim-number-input_affixes--c,
        var(--bim-ui_bg-contrast-60)
      );
      --bim-label--fz: var(
        --bim-number-input_affixes--fz,
        var(--bim-ui_size-xs)
      );
    }

    p {
      margin: 0;
      padding: 0;
    }

    input {
      background-color: transparent;
      outline: none;
      border: none;
      padding: 0;
      flex-grow: 1;
      text-align: right;
      font-family: inherit;
      font-feature-settings: inherit;
      font-variation-settings: inherit;
      font-size: var(--bim-number-input--fz, var(--bim-ui_size-xs));
      color: var(--bim-number-input--c, var(--bim-ui_bg-contrast-100));
    }

    :host([suffix]:not([pref])) input {
      text-align: left;
    }

    :host([slider]) {
      --bim-input--p: 0;
    }

    :host([slider]) .slider {
      --bim-label--c: var(--bim-ui_bg-contrast-100);
    }

    .slider {
      position: relative;
      display: flex;
      justify-content: center;
      width: 100%;
      height: 100%;
      padding: 0 0.5rem;
    }

    .slider-indicator {
      height: 100%;
      background-color: var(--bim-ui_main-base);
      position: absolute;
      top: 0;
      left: 0;
      border-radius: var(--bim-input--bdrs, var(--bim-ui_size-4xs));
    }

    bim-input {
      display: flex;
    }

    bim-label {
      pointer-events: none;
    }
  `;let Ni=ov;hs([ut({type:String,reflect:!0})],Ni.prototype,"name",2);hs([ut({type:String,reflect:!0})],Ni.prototype,"icon",2);hs([ut({type:String,reflect:!0})],Ni.prototype,"label",2);hs([ut({type:String,reflect:!0})],Ni.prototype,"pref",2);hs([ut({type:Number,reflect:!0})],Ni.prototype,"min",2);hs([ut({type:Number,reflect:!0})],Ni.prototype,"value",1);hs([ut({type:Number,reflect:!0})],Ni.prototype,"step",2);hs([ut({type:Number,reflect:!0})],Ni.prototype,"sensitivity",2);hs([ut({type:Number,reflect:!0})],Ni.prototype,"max",2);hs([ut({type:String,reflect:!0})],Ni.prototype,"suffix",2);hs([ut({type:Boolean,reflect:!0})],Ni.prototype,"vertical",2);hs([ut({type:Boolean,reflect:!0})],Ni.prototype,"slider",2);var Dx=Object.defineProperty,Ux=Object.getOwnPropertyDescriptor,Qh=(r,t,e,i)=>{for(var s=i>1?void 0:i?Ux(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&Dx(t,e,s),s};const av=class extends Zt{constructor(){super(...arguments),this.onValueChange=new Event("change"),this._hidden=!1,this.headerHidden=!1,this.valueTransform={},this.activationButton=document.createElement("bim-button")}set hidden(t){this._hidden=t,this.activationButton.active=!t,this.dispatchEvent(new Event("hiddenchange"))}get hidden(){return this._hidden}get value(){return Rf(this,this.valueTransform)}set value(t){const e=[...this.children];for(const i in t){const s=e.find(o=>{const a=o;return a.name===i||a.label===i});if(!s)continue;const n=s;n.value=t[i]}}connectedCallback(){super.connectedCallback(),this.activationButton.active=!this.hidden,this.activationButton.onclick=()=>this.hidden=!this.hidden}disconnectedCallback(){super.disconnectedCallback(),this.activationButton.remove()}collapseSections(){const t=this.querySelectorAll("bim-panel-section");for(const e of t)e.collapsed=!0}expandSections(){const t=this.querySelectorAll("bim-panel-section");for(const e of t)e.collapsed=!1}render(){return this.activationButton.icon=this.icon,this.activationButton.label=this.label||this.name,this.activationButton.tooltipTitle=this.label||this.name,Tt`
      <div class="parent">
        ${this.label||this.name||this.icon?Tt`<bim-label .icon=${this.icon}>${this.label}</bim-label>`:null}
        <div class="sections">
          <slot></slot>
        </div>
      </div>
    `}};av.styles=[Lr.scrollbar,Jt`
      :host {
        display: flex;
        border-radius: var(--bim-ui_size-base);
        background-color: var(--bim-ui_bg-base);
        overflow: auto;
      }

      :host([hidden]) {
        display: none;
      }

      .parent {
        display: flex;
        flex: 1;
        flex-direction: column;
        pointer-events: auto;
        overflow: auto;
      }

      .parent bim-label {
        --bim-label--c: var(--bim-panel--c, var(--bim-ui_bg-contrast-80));
        --bim-label--fz: var(--bim-panel--fz, var(--bim-ui_size-sm));
        font-weight: 600;
        padding: 1rem;
        flex-shrink: 0;
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([header-hidden]) .parent bim-label {
        display: none;
      }

      .sections {
        display: flex;
        flex-direction: column;
        overflow: auto;
      }

      ::slotted(bim-panel-section:not(:last-child)) {
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      }
    `];let zo=av;Qh([ut({type:String,reflect:!0})],zo.prototype,"icon",2);Qh([ut({type:String,reflect:!0})],zo.prototype,"name",2);Qh([ut({type:String,reflect:!0})],zo.prototype,"label",2);Qh([ut({type:Boolean,reflect:!0})],zo.prototype,"hidden",1);Qh([ut({type:Boolean,attribute:"header-hidden",reflect:!0})],zo.prototype,"headerHidden",2);var Bx=Object.defineProperty,Kh=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&Bx(t,e,s),s};const cv=class extends Zt{constructor(){super(...arguments),this.onValueChange=new Event("change"),this.valueTransform={}}get value(){const t=this.parentElement;let e;return t instanceof zo&&(e=t.valueTransform),Object.values(this.valueTransform).length!==0&&(e=this.valueTransform),Rf(this,e)}set value(t){const e=[...this.children];for(const i in t){const s=e.find(o=>{const a=o;return a.name===i||a.label===i});if(!s)continue;const n=s;n.value=t[i]}}onHeaderClick(){this.fixed||(this.collapsed=!this.collapsed)}render(){const t=this.label||this.icon||this.name||this.fixed,e=Tt`<svg
      xmlns="http://www.w3.org/2000/svg"
      height="1.125rem"
      viewBox="0 0 24 24"
      width="1.125rem"
    >
      <path d="M0 0h24v24H0V0z" fill="none" />
      <path d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z" />
    </svg>`,i=Tt`<svg
      xmlns="http://www.w3.org/2000/svg"
      height="1.125rem"
      viewBox="0 0 24 24"
      width="1.125rem"
    >
      <path d="M0 0h24v24H0z" fill="none" />
      <path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z" />
    </svg>`,s=this.collapsed?e:i,n=Tt`
      <div
        class="header"
        title=${this.label??""}
        @click=${this.onHeaderClick}
      >
        ${this.label||this.icon||this.name?Tt`<bim-label .icon=${this.icon}>${this.label}</bim-label>`:null}
        ${this.fixed?null:s}
      </div>
    `;return Tt`
      <div class="parent">
        ${t?n:null}
        <div class="components">
          <slot></slot>
        </div>
      </div>
    `}};cv.styles=[Lr.scrollbar,Jt`
      :host {
        display: block;
        pointer-events: auto;
      }

      :host(:not([fixed])) .header:hover {
        --bim-label--c: var(--bim-ui_accent-base);
        color: var(--bim-ui_accent-base);
        cursor: pointer;
      }

      :host(:not([fixed])) .header:hover svg {
        fill: var(--bim-ui_accent-base);
      }

      .header {
        --bim-label--fz: var(--bim-ui_size-sm);
        --bim-label--c: var(--bim-ui_bg-contrast-80);
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-weight: 600;
        height: 1.5rem;
        padding: 0.75rem 1rem;
      }

      .header svg {
        fill: var(--bim-ui_bg-contrast-80);
      }

      .title {
        display: flex;
        align-items: center;
        column-gap: 0.5rem;
      }

      .title p {
        font-size: var(--bim-ui_size-sm);
      }

      .components {
        display: flex;
        flex-direction: column;
        row-gap: 0.75rem;
        padding: 0.125rem 1rem 1rem;
      }

      :host(:not([fixed])[collapsed]) .components {
        display: none;
        height: 0px;
      }

      bim-label {
        pointer-events: none;
      }
    `];let Bc=cv;Kh([ut({type:String,reflect:!0})],Bc.prototype,"icon");Kh([ut({type:String,reflect:!0})],Bc.prototype,"label");Kh([ut({type:String,reflect:!0})],Bc.prototype,"name");Kh([ut({type:Boolean,reflect:!0})],Bc.prototype,"fixed");Kh([ut({type:Boolean,reflect:!0})],Bc.prototype,"collapsed");var kx=Object.defineProperty,Jh=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&kx(t,e,s),s};const lv=class extends Zt{constructor(){super(...arguments),this.vertical=!1,this.onValueChange=new Event("change"),this._canEmitEvents=!1,this._value=document.createElement("bim-option"),this.onOptionClick=t=>{this._value=t.target,this.dispatchEvent(this.onValueChange);for(const e of this.children)e instanceof Ge&&(e.checked=e===t.target)}}get _options(){return[...this.querySelectorAll("bim-option")]}set value(t){const e=this.findOption(t);if(e){for(const i of this._options)i.checked=i===e;this._value=e,this._canEmitEvents&&this.dispatchEvent(this.onValueChange)}}get value(){return this._value.value}onSlotChange(t){const e=t.target.assignedElements();for(const i of e)i instanceof Ge&&(i.noMark=!0,i.removeEventListener("click",this.onOptionClick),i.addEventListener("click",this.onOptionClick))}findOption(t){return this._options.find(e=>e instanceof Ge?e.label===t||e.value===t:!1)}firstUpdated(){const t=[...this.children].find(e=>e instanceof Ge&&e.checked);t&&(this._value=t)}render(){return Tt`
      <bim-input
        .vertical=${this.vertical}
        .label=${this.label}
        .icon=${this.icon}
      >
        <slot @slotchange=${this.onSlotChange}></slot>
      </bim-input>
    `}};lv.styles=Jt`
    :host {
      --bim-input--bgc: var(--bim-ui_bg-contrast-20);
      --bim-input--g: 0;
      --bim-option--jc: center;
      flex: 1;
      display: block;
    }

    ::slotted(bim-option) {
      border-radius: 0;
    }

    ::slotted(bim-option[checked]) {
      --bim-label--c: var(--bim-ui_main-contrast);
      background-color: var(--bim-ui_main-base);
    }
  `;let kc=lv;Jh([ut({type:String,reflect:!0})],kc.prototype,"name");Jh([ut({type:String,reflect:!0})],kc.prototype,"icon");Jh([ut({type:String,reflect:!0})],kc.prototype,"label");Jh([ut({type:Boolean,reflect:!0})],kc.prototype,"vertical");Jh([Lc()],kc.prototype,"_value");const Vx=()=>Tt`
    <style>
      div {
        display: flex;
        gap: 0.375rem;
        border-radius: 0.25rem;
        min-height: 1.25rem;
      }

      [data-type="row"] {
        background-color: var(--bim-ui_bg-contrast-10);
        animation: row-loading 1s linear infinite alternate;
        padding: 0.5rem;
      }

      [data-type="cell"] {
        background-color: var(--bim-ui_bg-contrast-20);
        flex: 0.25;
      }

      @keyframes row-loading {
        0% {
          background-color: var(--bim-ui_bg-contrast-10);
        }
        100% {
          background-color: var(--bim-ui_bg-contrast-20);
        }
      }
    </style>
    <div style="display: flex; flex-direction: column;">
      <div data-type="row" style="gap: 2rem">
        <div data-type="cell" style="flex: 1"></div>
        <div data-type="cell" style="flex: 2"></div>
        <div data-type="cell" style="flex: 1"></div>
        <div data-type="cell" style="flex: 0.5"></div>
      </div>
      <div style="display: flex;">
        <div data-type="row" style="flex: 1">
          <div data-type="cell" style="flex: 0.5"></div>
        </div>
        <div data-type="row" style="flex: 2">
          <div data-type="cell" style="flex: 0.75"></div>
        </div>
        <div data-type="row" style="flex: 1">
          <div data-type="cell"></div>
        </div>
        <div data-type="row" style="flex: 0.5">
          <div data-type="cell" style="flex: 0.75"></div>
        </div>
      </div>
      <div style="display: flex;">
        <div data-type="row" style="flex: 1">
          <div data-type="cell" style="flex: 0.75"></div>
        </div>
        <div data-type="row" style="flex: 2">
          <div data-type="cell"></div>
        </div>
        <div data-type="row" style="flex: 1">
          <div data-type="cell" style="flex: 0.5"></div>
        </div>
        <div data-type="row" style="flex: 0.5">
          <div data-type="cell" style="flex: 0.5"></div>
        </div>
      </div>
      <div style="display: flex;">
        <div data-type="row" style="flex: 1">
          <div data-type="cell"></div>
        </div>
        <div data-type="row" style="flex: 2">
          <div data-type="cell" style="flex: 0.5"></div>
        </div>
        <div data-type="row" style="flex: 1">
          <div data-type="cell" style="flex: 0.75"></div>
        </div>
        <div data-type="row" style="flex: 0.5">
          <div data-type="cell" style="flex: 0.7s5"></div>
        </div>
      </div>
    </div>
  `,zx=()=>Tt`
    <style>
      .loader {
        grid-area: Processing;
        position: relative;
        padding: 0.125rem;
      }
      .loader:before {
        content: "";
        position: absolute;
      }
      .loader .loaderBar {
        position: absolute;
        top: 0;
        right: 100%;
        bottom: 0;
        left: 0;
        background: var(--bim-ui_main-base);
        /* width: 25%; */
        width: 0;
        animation: borealisBar 2s linear infinite;
      }

      @keyframes borealisBar {
        0% {
          left: 0%;
          right: 100%;
          width: 0%;
        }
        10% {
          left: 0%;
          right: 75%;
          width: 25%;
        }
        90% {
          right: 0%;
          left: 75%;
          width: 25%;
        }
        100% {
          left: 100%;
          right: 0%;
          width: 0%;
        }
      }
    </style>
    <div class="loader">
      <div class="loaderBar"></div>
    </div>
  `;var Yx=Object.defineProperty,Gx=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&Yx(t,e,s),s};const hv=class extends Zt{constructor(){super(...arguments),this.column="",this.columnIndex=0,this.rowData={}}get data(){return this.column?this.rowData[this.column]:null}render(){return Tt`
      <style>
        :host {
          grid-area: ${this.column??"unset"};
        }
      </style>
      <slot></slot>
    `}};hv.styles=Jt`
    :host {
      padding: 0.375rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    :host([data-column-index="0"]) {
      justify-content: normal;
    }

    :host([data-column-index="0"]:not([data-cell-header]))
      ::slotted(bim-label) {
      text-align: left;
    }

    ::slotted(*) {
      --bim-input--bgc: transparent;
      --bim-input--olc: var(--bim-ui_bg-contrast-20);
      --bim-input--olw: 1px;
    }

    ::slotted(bim-input) {
      --bim-input--olw: 0;
    }

    ::slotted(bim-label) {
      white-space: normal;
      text-align: center;
    }
  `;let uv=hv;Gx([ut({type:String,reflect:!0})],uv.prototype,"column");var Hx=Object.defineProperty,$x=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&Hx(t,e,s),s};const dv=class extends Zt{constructor(){super(...arguments),this._groups=[],this.data=[],this.table=this.closest("bim-table")}toggleGroups(t,e=!1){for(const i of this._groups)i.childrenHidden=typeof t>"u"?!i.childrenHidden:!t,e&&i.toggleChildren(t,e)}render(){return this._groups=[],Tt`
      <slot></slot>
      ${this.data.map(t=>{const e=document.createElement("bim-table-group");return this._groups.push(e),e.table=this.table,e.data=t,e})}
    `}};dv.styles=Jt`
    :host {
      --bim-button--bgc: transparent;
      position: relative;
      grid-area: Children;
    }

    :host([hidden]) {
      display: none;
    }

    ::slotted(.branch.branch-vertical) {
      top: 0;
      bottom: 1.125rem;
    }
  `;let fv=dv;$x([ut({type:Array,attribute:!1})],fv.prototype,"data");var Wx=Object.defineProperty,jx=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&Wx(t,e,s),s};const pv=class extends Zt{constructor(){super(...arguments),this.data={data:{}},this.childrenHidden=!0,this.table=this.closest("bim-table")}connectedCallback(){super.connectedCallback(),this.table&&this.table.expanded?this.childrenHidden=!1:this.childrenHidden=!0}toggleChildren(t,e=!1){this._children&&(this.childrenHidden=typeof t>"u"?!this.childrenHidden:!t,e&&this._children.toggleGroups(t,e))}render(){if(!this.table)throw new Error("TableGroup: parent table wasn't found!");const t=this.table.getGroupIndentation(this.data)??0,e=Tt`
      ${this.table.noIndentation?null:Tt`
            <style>
              .branch-vertical {
                left: ${t+(this.table.selectableRows?1.9375:.5625)}rem;
              }
            </style>
            <div class="branch branch-vertical"></div>
          `}
    `,i=document.createDocumentFragment();nc(e,i);let s=null;this.table.noIndentation||(s=document.createElement("div"),s.classList.add("branch","branch-horizontal"),s.style.left=`${t-1+(this.table.selectableRows?2.05:.5625)}rem`);let n=null;if(!this.table.noIndentation){const c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("height","9.5"),c.setAttribute("width","7.5"),c.setAttribute("viewBox","0 0 4.6666672 7.3333333");const l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d","m 1.7470835,6.9583848 2.5899999,-2.59 c 0.39,-0.39 0.39,-1.02 0,-1.41 L 1.7470835,0.36838483 c -0.63,-0.62000003 -1.71000005,-0.18 -1.71000005,0.70999997 v 5.17 c 0,0.9 1.08000005,1.34 1.71000005,0.71 z"),c.append(l);const h=document.createElementNS("http://www.w3.org/2000/svg","svg");h.setAttribute("height","6.5"),h.setAttribute("width","9.5"),h.setAttribute("viewBox","0 0 5.9111118 5.0175439");const u=document.createElementNS("http://www.w3.org/2000/svg","path");u.setAttribute("d","M -0.33616196,1.922522 2.253838,4.5125219 c 0.39,0.39 1.02,0.39 1.41,0 L 6.2538379,1.922522 c 0.6200001,-0.63 0.18,-1.71000007 -0.7099999,-1.71000007 H 0.37383804 c -0.89999997,0 -1.33999997,1.08000007 -0.71,1.71000007 z"),h.append(u),n=document.createElement("div"),n.addEventListener("click",d=>{d.stopPropagation(),this.toggleChildren()}),n.classList.add("caret"),n.style.left=`${(this.table.selectableRows?1.5:.125)+t}rem`,this.childrenHidden?n.append(c):n.append(h)}const o=document.createElement("bim-table-row");this.data.children&&!this.childrenHidden&&o.append(i),o.table=this.table,o.data=this.data.data,this.table.dispatchEvent(new CustomEvent("rowcreated",{detail:{row:o}})),n&&this.data.children&&o.append(n),t!==0&&(!this.data.children||this.childrenHidden)&&s&&o.append(s);let a;if(this.data.children){a=document.createElement("bim-table-children"),this._children=a,a.table=this.table,a.data=this.data.children;const c=document.createDocumentFragment();nc(e,c),a.append(c)}return Tt`
      <div class="parent">${o} ${this.childrenHidden?null:a}</div>
    `}};pv.styles=Jt`
    :host {
      position: relative;
    }

    .parent {
      display: grid;
      grid-template-areas: "Data" "Children";
    }

    .branch {
      position: absolute;
      z-index: 1;
    }

    .branch-vertical {
      border-left: 1px dotted var(--bim-ui_bg-contrast-40);
    }

    .branch-horizontal {
      top: 50%;
      width: 1rem;
      border-bottom: 1px dotted var(--bim-ui_bg-contrast-40);
    }

    .caret {
      position: absolute;
      z-index: 2;
      transform: translateY(-50%) rotate(0deg);
      top: 50%;
      display: flex;
      width: 0.95rem;
      height: 0.95rem;
      justify-content: center;
      align-items: center;
      cursor: pointer;
    }

    .caret svg {
      fill: var(--bim-ui_bg-contrast-60);
    }
  `;let mv=pv;jx([ut({type:Boolean,attribute:"children-hidden",reflect:!0})],mv.prototype,"childrenHidden");var Xx=Object.defineProperty,Vc=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&Xx(t,e,s),s};const Iv=class extends Zt{constructor(){super(...arguments),this.selected=!1,this.columns=[],this.hiddenColumns=[],this.data={},this.isHeader=!1,this.table=this.closest("bim-table"),this.onTableColumnsChange=()=>{this.table&&(this.columns=this.table.columns)},this.onTableColumnsHidden=()=>{this.table&&(this.hiddenColumns=this.table.hiddenColumns)},this._observer=new IntersectionObserver(t=>{this._intersecting=t[0].isIntersecting},{rootMargin:"36px"})}get _columnNames(){return this.columns.filter(t=>!this.hiddenColumns.includes(t.name)).map(t=>t.name)}get _columnWidths(){return this.columns.filter(t=>!this.hiddenColumns.includes(t.name)).map(t=>t.width)}get _isSelected(){var t;return(t=this.table)==null?void 0:t.selection.has(this.data)}onSelectionChange(t){if(!this.table)return;const e=t.target;this.selected=e.value,e.value?(this.table.selection.add(this.data),this.table.dispatchEvent(new CustomEvent("rowselected",{detail:{data:this.data}}))):(this.table.selection.delete(this.data),this.table.dispatchEvent(new CustomEvent("rowdeselected",{detail:{data:this.data}})))}connectedCallback(){super.connectedCallback(),this._observer.observe(this),this.table&&(this.columns=this.table.columns,this.hiddenColumns=this.table.hiddenColumns,this.table.addEventListener("columnschange",this.onTableColumnsChange),this.table.addEventListener("columnshidden",this.onTableColumnsHidden),this.toggleAttribute("selected",this._isSelected))}disconnectedCallback(){super.disconnectedCallback(),this._observer.unobserve(this),this.table&&(this.columns=[],this.hiddenColumns=[],this.table.removeEventListener("columnschange",this.onTableColumnsChange),this.table.removeEventListener("columnshidden",this.onTableColumnsHidden),this.toggleAttribute("selected",!1))}compute(){if(!this.table)throw new Error("TableRow: parent table wasn't found!");const t=this.table.getRowIndentation(this.data)??0,e=this.isHeader?this.data:this.table.applyDataTransform(this.data)??this.data,i=[];for(const s in e){if(this.hiddenColumns.includes(s))continue;const n=e[s];let o;if(typeof n=="string"||typeof n=="boolean"||typeof n=="number"?(o=document.createElement("bim-label"),o.textContent=String(n)):n instanceof HTMLElement?o=n:(o=document.createDocumentFragment(),nc(n,o)),!o)continue;const a=document.createElement("bim-table-cell");a.append(o),a.column=s,this._columnNames.indexOf(s)===0&&(a.style.marginLeft=`${this.table.noIndentation?0:t+.75}rem`);const c=this._columnNames.indexOf(s);a.setAttribute("data-column-index",String(c)),a.toggleAttribute("data-no-indentation",c===0&&this.table.noIndentation),a.toggleAttribute("data-cell-header",this.isHeader),a.rowData=this.data,this.table.dispatchEvent(new CustomEvent("cellcreated",{detail:{cell:a}})),i.push(a)}return this.style.gridTemplateAreas=`"${this.table.selectableRows?"Selection":""} ${this._columnNames.join(" ")}"`,this.style.gridTemplateColumns=`${this.table.selectableRows?"1.6rem":""} ${this._columnWidths.join(" ")}`,Tt`
      ${!this.isHeader&&this.table.selectableRows?Tt`<bim-checkbox
            @change=${this.onSelectionChange}
            .checked=${this._isSelected}
            style="align-self: center; justify-self: center"
          ></bim-checkbox>`:null}
      ${i}
      <slot></slot>
    `}render(){return Tt`${this._intersecting?this.compute():Tt``}`}};Iv.styles=Jt`
    :host {
      position: relative;
      grid-area: Data;
      display: grid;
      min-height: 2.25rem;
      transition: all 0.15s;
    }

    ::slotted(.branch.branch-vertical) {
      top: 50%;
      bottom: 0;
    }

    :host([selected]) {
      background-color: color-mix(
        in lab,
        var(--bim-ui_bg-contrast-20) 30%,
        var(--bim-ui_main-base) 10%
      );
    }
  `;let Yo=Iv;Vc([ut({type:Boolean,reflect:!0})],Yo.prototype,"selected");Vc([ut({attribute:!1})],Yo.prototype,"columns");Vc([ut({attribute:!1})],Yo.prototype,"hiddenColumns");Vc([ut({attribute:!1})],Yo.prototype,"data");Vc([ut({type:Boolean,attribute:"is-header",reflect:!0})],Yo.prototype,"isHeader");Vc([Lc()],Yo.prototype,"_intersecting");var Zx=Object.defineProperty,qx=Object.getOwnPropertyDescriptor,Ms=(r,t,e,i)=>{for(var s=i>1?void 0:i?qx(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&Zx(t,e,s),s};const gv=class extends Zt{constructor(){super(...arguments),this._filteredData=[],this.headersHidden=!1,this.minColWidth="4rem",this._columns=[],this._textDelimiters={comma:",",tab:"	"},this._queryString=null,this._data=[],this.expanded=!1,this.preserveStructureOnFilter=!1,this.indentationInText=!1,this.dataTransform={},this.selectableRows=!1,this.selection=new Set,this.noIndentation=!1,this.loading=!1,this._errorLoading=!1,this._onColumnsHidden=new Event("columnshidden"),this._hiddenColumns=[],this._stringFilterFunction=(t,e)=>Object.values(e.data).some(i=>String(i).toLowerCase().includes(t.toLowerCase())),this._queryFilterFunction=(t,e)=>{let i=!1;const s=TI(t)??[];for(const n of s){if("queries"in n){i=!1;break}const{condition:o,value:a}=n;let{key:c}=n;if(c.startsWith("[")&&c.endsWith("]")){const l=c.replace("[","").replace("]","");c=l,i=Object.keys(e.data).filter(h=>h.includes(l)).map(h=>cC(e.data[h],o,a)).some(h=>h)}else i=cC(e.data[c],o,a);if(!i)break}return i}}set columns(t){const e=[];for(const i of t){const s=typeof i=="string"?{name:i,width:`minmax(${this.minColWidth}, 1fr)`}:i;e.push(s)}this._columns=e,this.computeMissingColumns(this.data),this.dispatchEvent(new Event("columnschange"))}get columns(){return this._columns}get _headerRowData(){const t={};for(const e of this.columns){const{name:i}=e;t[i]=String(i)}return t}get value(){return this._filteredData}set queryString(t){this.toggleAttribute("data-processing",!0),this._queryString=t&&t.trim()!==""?t.trim():null,this.updateFilteredData(),this.toggleAttribute("data-processing",!1)}get queryString(){return this._queryString}set data(t){this._data=t,this.updateFilteredData(),this.computeMissingColumns(t)&&(this.columns=this._columns)}get data(){return this._data}get dataAsync(){return new Promise(t=>{setTimeout(()=>{t(this.data)})})}set hiddenColumns(t){this._hiddenColumns=t,setTimeout(()=>{this.dispatchEvent(this._onColumnsHidden)})}get hiddenColumns(){return this._hiddenColumns}updateFilteredData(){this.queryString?(TI(this.queryString)?(this.filterFunction=this._queryFilterFunction,this._filteredData=this.filter(this.queryString)):(this.filterFunction=this._stringFilterFunction,this._filteredData=this.filter(this.queryString)),this.preserveStructureOnFilter&&(this._expandedBeforeFilter===void 0&&(this._expandedBeforeFilter=this.expanded),this.expanded=!0)):(this.preserveStructureOnFilter&&this._expandedBeforeFilter!==void 0&&(this.expanded=this._expandedBeforeFilter,this._expandedBeforeFilter=void 0),this._filteredData=this.data)}computeMissingColumns(t){let e=!1;for(const i of t){const{children:s,data:n}=i;for(const o in n)this._columns.map(a=>typeof a=="string"?a:a.name).includes(o)||(this._columns.push({name:o,width:`minmax(${this.minColWidth}, 1fr)`}),e=!0);if(s){const o=this.computeMissingColumns(s);o&&!e&&(e=o)}}return e}generateText(t="comma",e=this.value,i="",s=!0){const n=this._textDelimiters[t];let o="";const a=this.columns.map(c=>c.name);if(s){this.indentationInText&&(o+=`Indentation${n}`);const c=`${a.join(n)}
`;o+=c}for(const[c,l]of e.entries()){const{data:h,children:u}=l,d=this.indentationInText?`${i}${c+1}${n}`:"",f=a.map(m=>h[m]??""),p=`${d}${f.join(n)}
`;o+=p,u&&(o+=this.generateText(t,l.children,`${i}${c+1}.`,!1))}return o}get csv(){return this.generateText("comma")}get tsv(){return this.generateText("tab")}applyDataTransform(t){const e={};for(const s of Object.keys(this.dataTransform)){const n=this.columns.find(o=>o.name===s);n&&n.forceDataTransform&&(s in t||(t[s]=""))}const i=t;for(const s in i){const n=this.dataTransform[s];n?e[s]=n(i[s],t):e[s]=t[s]}return e}downloadData(t="BIM Table Data",e="json"){let i=null;if(e==="json"&&(i=new File([JSON.stringify(this.value,void 0,2)],`${t}.json`)),e==="csv"&&(i=new File([this.csv],`${t}.csv`)),e==="tsv"&&(i=new File([this.tsv],`${t}.tsv`)),!i)return;const s=document.createElement("a");s.href=URL.createObjectURL(i),s.download=i.name,s.click(),URL.revokeObjectURL(s.href)}getRowIndentation(t,e=this.value,i=0){for(const s of e){if(s.data===t)return i;if(s.children){const n=this.getRowIndentation(t,s.children,i+1);if(n!==null)return n}}return null}getGroupIndentation(t,e=this.value,i=0){for(const s of e){if(s===t)return i;if(s.children){const n=this.getGroupIndentation(t,s.children,i+1);if(n!==null)return n}}return null}connectedCallback(){super.connectedCallback(),this.dispatchEvent(new Event("connected"))}disconnectedCallback(){super.disconnectedCallback(),this.dispatchEvent(new Event("disconnected"))}async loadData(t=!1){if(this._filteredData.length!==0&&!t||!this.loadFunction)return!1;this.loading=!0;try{const e=await this.loadFunction();return this.data=e,this.loading=!1,this._errorLoading=!1,!0}catch(e){if(this.loading=!1,this._filteredData.length!==0)return!1;const i=this.querySelector("[slot='error-loading']"),s=i?.querySelector("[data-table-element='error-message']");return e instanceof Error&&s&&e.message.trim()!==""&&(s.textContent=e.message),this._errorLoading=!0,!1}}filter(t,e=this.filterFunction??this._stringFilterFunction,i=this.data){const s=[];for(const n of i)if(e(t,n)){if(this.preserveStructureOnFilter){const o={data:n.data};if(n.children){const a=this.filter(t,e,n.children);a.length&&(o.children=a)}s.push(o)}else if(s.push({data:n.data}),n.children){const o=this.filter(t,e,n.children);s.push(...o)}}else if(n.children){const o=this.filter(t,e,n.children);this.preserveStructureOnFilter&&o.length?s.push({data:n.data,children:o}):s.push(...o)}return s}get _missingDataElement(){return this.querySelector("[slot='missing-data']")}render(){if(this.loading)return Vx();if(this._errorLoading)return Tt`<slot name="error-loading"></slot>`;if(this._filteredData.length===0&&this._missingDataElement)return Tt`<slot name="missing-data"></slot>`;const t=document.createElement("bim-table-row");t.table=this,t.isHeader=!0,t.data=this._headerRowData,t.style.gridArea="Header",t.style.position="sticky",t.style.top="0",t.style.zIndex="5";const e=document.createElement("bim-table-children");return e.table=this,e.data=this.value,e.style.gridArea="Body",e.style.backgroundColor="transparent",Tt`
      <div class="parent">
        ${this.headersHidden?null:t} ${zx()}
        <div style="overflow-x: hidden; grid-area: Body">${e}</div>
      </div>
    `}};gv.styles=[Lr.scrollbar,Jt`
      :host {
        position: relative;
        overflow: auto;
        display: block;
        pointer-events: auto;
      }

      :host(:not([data-processing])) .loader {
        display: none;
      }

      .parent {
        display: grid;
        grid-template:
          "Header" auto
          "Processing" auto
          "Body" 1fr
          "Footer" auto;
        overflow: auto;
        height: 100%;
      }

      .parent > bim-table-row[is-header] {
        color: var(--bim-table_header--c, var(--bim-ui_bg-contrast-100));
        background-color: var(
          --bim-table_header--bgc,
          var(--bim-ui_bg-contrast-20)
        );
      }

      .controls {
        display: flex;
        gap: 0.375rem;
        flex-wrap: wrap;
        margin-bottom: 0.5rem;
      }
    `];let us=gv;Ms([Lc()],us.prototype,"_filteredData",2);Ms([ut({type:Boolean,attribute:"headers-hidden",reflect:!0})],us.prototype,"headersHidden",2);Ms([ut({type:String,attribute:"min-col-width",reflect:!0})],us.prototype,"minColWidth",2);Ms([ut({type:Array,attribute:!1})],us.prototype,"columns",1);Ms([ut({type:Array,attribute:!1})],us.prototype,"data",1);Ms([ut({type:Boolean,reflect:!0})],us.prototype,"expanded",2);Ms([ut({type:Boolean,reflect:!0,attribute:"selectable-rows"})],us.prototype,"selectableRows",2);Ms([ut({attribute:!1})],us.prototype,"selection",2);Ms([ut({type:Boolean,attribute:"no-indentation",reflect:!0})],us.prototype,"noIndentation",2);Ms([ut({type:Boolean,reflect:!0})],us.prototype,"loading",2);Ms([Lc()],us.prototype,"_errorLoading",2);var Qx=Object.defineProperty,Kx=Object.getOwnPropertyDescriptor,ip=(r,t,e,i)=>{for(var s=i>1?void 0:i?Kx(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&Qx(t,e,s),s};const Ev=class extends Zt{constructor(){super(...arguments),this._defaultName="__unnamed__",this.name=this._defaultName,this._hidden=!1}set hidden(t){this._hidden=t,this.dispatchEvent(new Event("hiddenchange"))}get hidden(){return this._hidden}connectedCallback(){super.connectedCallback();const{parentElement:t}=this;if(t&&this.name===this._defaultName){const e=[...t.children].indexOf(this);this.name=`${this._defaultName}${e}`}}render(){return Tt` <slot></slot> `}};Ev.styles=Jt`
    :host {
      display: block;
      height: 100%;
    }

    :host([hidden]) {
      display: none;
    }
  `;let Ui=Ev;ip([ut({type:String,reflect:!0})],Ui.prototype,"name",2);ip([ut({type:String,reflect:!0})],Ui.prototype,"label",2);ip([ut({type:String,reflect:!0})],Ui.prototype,"icon",2);ip([ut({type:Boolean,reflect:!0})],Ui.prototype,"hidden",1);var Jx=Object.defineProperty,tN=Object.getOwnPropertyDescriptor,zc=(r,t,e,i)=>{for(var s=i>1?void 0:i?tN(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&Jx(t,e,s),s};const Cv=class extends Zt{constructor(){super(...arguments),this._switchers=[],this.bottom=!1,this.switchersHidden=!1,this.floating=!1,this.switchersFull=!1,this.onTabHiddenChange=t=>{const e=t.target;e instanceof Ui&&!e.hidden&&(e.removeEventListener("hiddenchange",this.onTabHiddenChange),this.tab=e.name,e.addEventListener("hiddenchange",this.onTabHiddenChange))}}set tab(t){this._tab=t;const e=[...this.children],i=e.find(s=>s instanceof Ui&&s.name===t);for(const s of e){if(!(s instanceof Ui))continue;s.hidden=i!==s;const n=this.getTabSwitcher(s.name);n&&n.toggleAttribute("data-active",!s.hidden)}}get tab(){return this._tab}getTabSwitcher(t){return this._switchers.find(e=>e.getAttribute("data-name")===t)}createSwitchers(){this._switchers=[];for(const t of this.children){if(!(t instanceof Ui))continue;const e=document.createElement("div");e.addEventListener("click",()=>{this.tab===t.name?this.toggleAttribute("tab",!1):this.tab=t.name}),e.setAttribute("data-name",t.name),e.className="switcher";const i=document.createElement("bim-label");i.textContent=t.label??"",i.icon=t.icon,e.append(i),this._switchers.push(e)}}onSlotChange(t){this.createSwitchers();const e=t.target.assignedElements(),i=e.find(s=>s instanceof Ui?this.tab?s.name===this.tab:!s.hidden:!1);i&&i instanceof Ui&&(this.tab=i.name);for(const s of e){if(!(s instanceof Ui)){s.remove();continue}s.removeEventListener("hiddenchange",this.onTabHiddenChange),i!==s&&(s.hidden=!0),s.addEventListener("hiddenchange",this.onTabHiddenChange)}}render(){return Tt`
      <div class="parent">
        <div class="switchers">${this._switchers}</div>
        <div class="content">
          <slot @slotchange=${this.onSlotChange}></slot>
        </div>
      </div>
    `}};Cv.styles=[Lr.scrollbar,Jt`
      * {
        box-sizing: border-box;
      }

      :host {
        background-color: var(--bim-ui_bg-base);
        display: block;
        overflow: auto;
      }

      .parent {
        display: grid;
        grid-template: "switchers" auto "content" 1fr;
        height: 100%;
      }

      :host([bottom]) .parent {
        grid-template: "content" 1fr "switchers" auto;
      }

      .switchers {
        display: flex;
        height: 2.25rem;
        font-weight: 600;
        grid-area: switchers;
      }

      .switcher {
        --bim-label--c: var(--bim-ui_bg-contrast-80);
        background-color: var(--bim-ui_bg-base);
        cursor: pointer;
        pointer-events: auto;
        padding: 0rem 0.75rem;
        display: flex;
        justify-content: center;
        transition: all 0.15s;
      }

      :host([switchers-full]) .switcher {
        flex: 1;
      }

      .switcher:hover,
      .switcher[data-active] {
        --bim-label--c: var(--bim-ui_main-contrast);
        background-color: var(--bim-ui_main-base);
      }

      .switchers bim-label {
        pointer-events: none;
      }

      :host([switchers-hidden]) .switchers {
        display: none;
      }

      .content {
        grid-area: content;
        overflow: auto;
      }

      :host(:not([bottom])) .content {
        border-top: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([bottom]) .content {
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host(:not([tab])) .content {
        display: none;
      }

      :host([floating]) {
        background-color: transparent;
      }

      :host([floating]) .switchers {
        justify-self: center;
        overflow: auto;
      }

      :host([floating]:not([bottom])) .switchers {
        border-radius: var(--bim-ui_size-2xs) var(--bim-ui_size-2xs) 0 0;
        border-top: 1px solid var(--bim-ui_bg-contrast-20);
        border-left: 1px solid var(--bim-ui_bg-contrast-20);
        border-right: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([floating][bottom]) .switchers {
        border-radius: 0 0 var(--bim-ui_size-2xs) var(--bim-ui_size-2xs);
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
        border-left: 1px solid var(--bim-ui_bg-contrast-20);
        border-right: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([floating]:not([tab])) .switchers {
        border-radius: var(--bim-ui_size-2xs);
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([floating][bottom]:not([tab])) .switchers {
        border-top: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([floating]) .content {
        border: 1px solid var(--bim-ui_bg-contrast-20);
        border-radius: var(--bim-ui_size-2xs);
        background-color: var(--bim-ui_bg-base);
      }
    `];let Go=Cv;zc([Lc()],Go.prototype,"_switchers",2);zc([ut({type:Boolean,reflect:!0})],Go.prototype,"bottom",2);zc([ut({type:Boolean,attribute:"switchers-hidden",reflect:!0})],Go.prototype,"switchersHidden",2);zc([ut({type:Boolean,reflect:!0})],Go.prototype,"floating",2);zc([ut({type:String,reflect:!0})],Go.prototype,"tab",1);zc([ut({type:Boolean,attribute:"switchers-full",reflect:!0})],Go.prototype,"switchersFull",2);/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const lC=r=>r??Ae;var eN=Object.defineProperty,iN=Object.getOwnPropertyDescriptor,Yn=(r,t,e,i)=>{for(var s=i>1?void 0:i?iN(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&eN(t,e,s),s};const bv=class extends Zt{constructor(){super(...arguments),this._inputTypes=["date","datetime-local","email","month","password","search","tel","text","time","url","week","area"],this.value="",this.vertical=!1,this._type="text",this.onValueChange=new Event("input")}set type(t){this._inputTypes.includes(t)&&(this._type=t)}get type(){return this._type}get query(){return TI(this.value)}onInputChange(t){t.stopPropagation();const e=t.target;clearTimeout(this._debounceTimeoutID),this._debounceTimeoutID=setTimeout(()=>{this.value=e.value,this.dispatchEvent(this.onValueChange)},this.debounce)}focus(){setTimeout(()=>{var t;const e=(t=this.shadowRoot)==null?void 0:t.querySelector("input");e?.focus()})}render(){return Tt`
      <bim-input
        .name=${this.name}
        .icon=${this.icon}
        .label=${this.label}
        .vertical=${this.vertical}
      >
        ${this.type==="area"?Tt` <textarea
              aria-label=${this.label||this.name||"Text Input"}
              .value=${this.value}
              .rows=${this.rows??5}
              placeholder=${lC(this.placeholder)}
              @input=${this.onInputChange}
            ></textarea>`:Tt` <input
              aria-label=${this.label||this.name||"Text Input"}
              .type=${this.type}
              .value=${this.value}
              placeholder=${lC(this.placeholder)}
              @input=${this.onInputChange}
            />`}
      </bim-input>
    `}};bv.styles=[Lr.scrollbar,Jt`
      :host {
        --bim-input--bgc: var(--bim-ui_bg-contrast-20);
        flex: 1;
        display: block;
      }

      input,
      textarea {
        font-family: inherit;
        background-color: transparent;
        border: none;
        width: 100%;
        padding: var(--bim-ui_size-3xs);
        color: var(--bim-text-input--c, var(--bim-ui_bg-contrast-100));
      }

      input {
        outline: none;
        height: 100%;
        padding: 0 var(--bim-ui_size-3xs); /* Override padding */
        border-radius: var(--bim-text-input--bdrs, var(--bim-ui_size-4xs));
      }

      textarea {
        line-height: 1.1rem;
        resize: vertical;
      }

      :host(:focus) {
        --bim-input--olc: var(--bim-ui_accent-base);
      }

      /* :host([disabled]) {
      --bim-input--bgc: var(--bim-ui_bg-contrast-20);
    } */
    `];let an=bv;Yn([ut({type:String,reflect:!0})],an.prototype,"icon",2);Yn([ut({type:String,reflect:!0})],an.prototype,"label",2);Yn([ut({type:String,reflect:!0})],an.prototype,"name",2);Yn([ut({type:String,reflect:!0})],an.prototype,"placeholder",2);Yn([ut({type:String,reflect:!0})],an.prototype,"value",2);Yn([ut({type:Boolean,reflect:!0})],an.prototype,"vertical",2);Yn([ut({type:Number,reflect:!0})],an.prototype,"debounce",2);Yn([ut({type:Number,reflect:!0})],an.prototype,"rows",2);Yn([ut({type:String,reflect:!0})],an.prototype,"type",1);var sN=Object.defineProperty,nN=Object.getOwnPropertyDescriptor,Tv=(r,t,e,i)=>{for(var s=i>1?void 0:i?nN(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&sN(t,e,s),s};const yv=class extends Zt{constructor(){super(...arguments),this.rows=2,this._vertical=!1}set vertical(t){this._vertical=t,this.updateChildren()}get vertical(){return this._vertical}updateChildren(){const t=this.children;for(const e of t)this.vertical?e.setAttribute("label-hidden",""):e.removeAttribute("label-hidden")}render(){return Tt`
      <style>
        .parent {
          grid-auto-flow: ${this.vertical?"row":"column"};
          grid-template-rows: repeat(${this.rows}, 1fr);
        }
      </style>
      <div class="parent">
        <slot @slotchange=${this.updateChildren}></slot>
      </div>
    `}};yv.styles=Jt`
    .parent {
      display: grid;
      gap: 0.25rem;
    }

    ::slotted(bim-button[label]:not([vertical])) {
      --bim-button--jc: flex-start;
    }

    ::slotted(bim-button) {
      --bim-label--c: var(--bim-ui_bg-contrast-80);
    }
  `;let sp=yv;Tv([ut({type:Number,reflect:!0})],sp.prototype,"rows",2);Tv([ut({type:Boolean,reflect:!0})],sp.prototype,"vertical",1);var rN=Object.defineProperty,oN=Object.getOwnPropertyDescriptor,np=(r,t,e,i)=>{for(var s=i>1?void 0:i?oN(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&rN(t,e,s),s};const vv=class extends Zt{constructor(){super(...arguments),this._vertical=!1,this._labelHidden=!1}set vertical(t){this._vertical=t,this.updateChildren()}get vertical(){return this._vertical}set labelHidden(t){this._labelHidden=t,this.updateChildren()}get labelHidden(){return this._labelHidden}updateChildren(){const t=this.children;for(const e of t)e instanceof sp&&(e.vertical=this.vertical),e.toggleAttribute("label-hidden",this.vertical)}render(){return Tt`
      <div class="parent">
        <div class="children">
          <slot @slotchange=${this.updateChildren}></slot>
        </div>
        ${!this.labelHidden&&(this.label||this.icon)?Tt`<bim-label .icon=${this.icon}>${this.label}</bim-label>`:null}
      </div>
    `}};vv.styles=Jt`
    :host {
      --bim-label--fz: var(--bim-ui_size-xs);
      --bim-label--c: var(--bim-ui_bg-contrast-60);
      display: block;
      flex: 1;
    }

    :host(:not([vertical])) ::slotted(bim-button[vertical]) {
      --bim-icon--fz: var(--bim-ui_size-5xl);
      min-height: 3.75rem;
    }

    ::slotted(bim-button) {
      --bim-label--c: var(--bim-ui_bg-contrast-80);
    }

    .parent {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      align-items: center;
      padding: 0.5rem;
      height: 100%;
      box-sizing: border-box;
      justify-content: space-between;
    }

    :host([vertical]) .parent {
      flex-direction: row-reverse;
    }

    :host([vertical]) .parent > bim-label {
      writing-mode: tb;
    }

    .children {
      display: flex;
      gap: 0.25rem;
    }

    :host([vertical]) .children {
      flex-direction: column;
    }
  `;let Yc=vv;np([ut({type:String,reflect:!0})],Yc.prototype,"label",2);np([ut({type:String,reflect:!0})],Yc.prototype,"icon",2);np([ut({type:Boolean,reflect:!0})],Yc.prototype,"vertical",1);np([ut({type:Boolean,attribute:"label-hidden",reflect:!0})],Yc.prototype,"labelHidden",1);var aN=Object.defineProperty,cN=Object.getOwnPropertyDescriptor,bE=(r,t,e,i)=>{for(var s=i>1?void 0:i?cN(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&aN(t,e,s),s};const Rv=class extends Zt{constructor(){super(...arguments),this.labelsHidden=!1,this._vertical=!1,this._hidden=!1}set vertical(t){this._vertical=t,this.updateSections()}get vertical(){return this._vertical}set hidden(t){this._hidden=t,this.dispatchEvent(new Event("hiddenchange"))}get hidden(){return this._hidden}updateSections(){const t=this.children;for(const e of t)e instanceof Yc&&(e.labelHidden=this.vertical&&!gE.config.sectionLabelOnVerticalToolbar,e.vertical=this.vertical)}render(){return Tt`
      <div class="parent">
        <slot @slotchange=${this.updateSections}></slot>
      </div>
    `}};Rv.styles=Jt`
    :host {
      --bim-button--bgc: transparent;
      background-color: var(--bim-ui_bg-base);
      border-radius: var(--bim-ui_size-2xs);
      display: block;
    }

    :host([hidden]) {
      display: none;
    }

    .parent {
      display: flex;
      width: min-content;
      pointer-events: auto;
    }

    :host([vertical]) .parent {
      flex-direction: column;
    }

    :host([vertical]) {
      width: min-content;
      border-radius: var(--bim-ui_size-2xs);
      border: 1px solid var(--bim-ui_bg-contrast-20);
    }

    ::slotted(bim-toolbar-section:not(:last-child)) {
      border-right: 1px solid var(--bim-ui_bg-contrast-20);
      border-bottom: none;
    }

    :host([vertical]) ::slotted(bim-toolbar-section:not(:last-child)) {
      border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      border-right: none;
    }
  `;let rp=Rv;bE([ut({type:String,reflect:!0})],rp.prototype,"icon",2);bE([ut({type:Boolean,attribute:"labels-hidden",reflect:!0})],rp.prototype,"labelsHidden",2);bE([ut({type:Boolean,reflect:!0})],rp.prototype,"vertical",1);var lN=Object.defineProperty,hN=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&lN(t,e,s),s};const Av=class extends Zt{constructor(){super(),this._onResize=new Event("resize"),new ResizeObserver(()=>{setTimeout(()=>{this.dispatchEvent(this._onResize)})}).observe(this)}render(){return Tt`
      <div class="parent">
        <slot></slot>
      </div>
    `}};Av.styles=Jt`
    :host {
      display: grid;
      min-width: 0;
      min-height: 0;
      height: 100%;
    }

    .parent {
      overflow: hidden;
      position: relative;
    }
  `;let Sv=Av;hN([ut({type:String,reflect:!0})],Sv.prototype,"name");var uN=Object.defineProperty,dN=(r,t,e)=>t in r?uN(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Et=(r,t,e)=>(dN(r,typeof t!="symbol"?t+"":t,e),e);class Rh extends Pe{constructor(t,e,i,s){if(super(t,e,i),Et(this,"fragment"),Et(this,"material"),Et(this,"geometry"),Array.isArray(e)||(e=[e]),this.material=e,!t.index)throw new Error("The geometry for fragments must be indexed!");this.geometry=t,this.fragment=s;const n=t.index.count;t.groups.length||t.groups.push({start:0,count:n,materialIndex:0})}exportData(){const t=this.geometry.attributes.position.array,e=this.geometry.attributes.normal.array,i=Array.from(this.geometry.index.array),s=[];for(const c of this.geometry.groups){const l=c.materialIndex||0,{start:h,count:u}=c;s.push(h,u,l)}const n=[];if(Array.isArray(this.material))for(const c of this.material){const l=c.opacity,h=c.transparent?1:0,u=new Rt(c.color).toArray();n.push(l,h,...u)}const o=Array.from(this.instanceMatrix.array);let a;return this.instanceColor!==null?a=Array.from(this.instanceColor.array):a=[],{position:t,normal:e,index:i,groups:s,materials:n,matrices:o,colors:a}}clone(t){throw new Error("Fragment meshes can't be cloned directly. Use mesh.fragment.clone instead!")}}const wv=0,fN=1,pN=2,hC=2,Xp=1.25,uC=1,Zd=6*4+4+4,op=65535,mN=Math.pow(2,-24),Zp=Symbol("SKIP_GENERATION");function IN(r){return r.index?r.index.count:r.attributes.position.count}function Gc(r){return IN(r)/3}function gN(r,t=ArrayBuffer){return r>65535?new Uint32Array(new t(4*r)):new Uint16Array(new t(2*r))}function EN(r,t){if(!r.index){const e=r.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,s=gN(e,i);r.setIndex(new Kt(s,1));for(let n=0;n<e;n++)s[n]=n}}function _v(r){const t=Gc(r),e=r.drawRange,i=e.start/3,s=(e.start+e.count)/3,n=Math.max(0,i),o=Math.min(t,s)-n;return[{offset:Math.floor(n),count:Math.floor(o)}]}function Fv(r){if(!r.groups||!r.groups.length)return _v(r);const t=[],e=new Set,i=r.drawRange,s=i.start/3,n=(i.start+i.count)/3;for(const a of r.groups){const c=a.start/3,l=(a.start+a.count)/3;e.add(Math.max(s,c)),e.add(Math.min(n,l))}const o=Array.from(e.values()).sort((a,c)=>a-c);for(let a=0;a<o.length-1;a++){const c=o[a],l=o[a+1];t.push({offset:Math.floor(c),count:Math.floor(l-c)})}return t}function CN(r){if(r.groups.length===0)return!1;const t=Gc(r),e=Fv(r).sort((n,o)=>n.offset-o.offset),i=e[e.length-1];i.count=Math.min(t-i.offset,i.count);let s=0;return e.forEach(({count:n})=>s+=n),t!==s}function Ie(r,t,e){return e.min.x=t[r],e.min.y=t[r+1],e.min.z=t[r+2],e.max.x=t[r+3],e.max.y=t[r+4],e.max.z=t[r+5],e}function bN(r){r[0]=r[1]=r[2]=1/0,r[3]=r[4]=r[5]=-1/0}function dC(r){let t=-1,e=-1/0;for(let i=0;i<3;i++){const s=r[i+3]-r[i];s>e&&(e=s,t=i)}return t}function fC(r,t){t.set(r)}function pC(r,t,e){let i,s;for(let n=0;n<3;n++){const o=n+3;i=r[n],s=t[n],e[n]=i<s?i:s,i=r[o],s=t[o],e[o]=i>s?i:s}}function bu(r,t,e){for(let i=0;i<3;i++){const s=t[r+2*i],n=t[r+2*i+1],o=s-n,a=s+n;o<e[i]&&(e[i]=o),a>e[i+3]&&(e[i+3]=a)}}function hl(r){const t=r[3]-r[0],e=r[4]-r[1],i=r[5]-r[2];return 2*(t*e+e*i+i*t)}function qp(r,t,e,i,s=null){let n=1/0,o=1/0,a=1/0,c=-1/0,l=-1/0,h=-1/0,u=1/0,d=1/0,f=1/0,p=-1/0,m=-1/0,g=-1/0;const I=s!==null;for(let C=t*6,b=(t+e)*6;C<b;C+=6){const E=r[C+0],T=r[C+1],A=E-T,S=E+T;A<n&&(n=A),S>c&&(c=S),I&&E<u&&(u=E),I&&E>p&&(p=E);const _=r[C+2],w=r[C+3],F=_-w,D=_+w;F<o&&(o=F),D>l&&(l=D),I&&_<d&&(d=_),I&&_>m&&(m=_);const R=r[C+4],O=r[C+5],y=R-O,U=R+O;y<a&&(a=y),U>h&&(h=U),I&&R<f&&(f=R),I&&R>g&&(g=R)}i[0]=n,i[1]=o,i[2]=a,i[3]=c,i[4]=l,i[5]=h,I&&(s[0]=u,s[1]=d,s[2]=f,s[3]=p,s[4]=m,s[5]=g)}function TN(r,t,e,i){let s=1/0,n=1/0,o=1/0,a=-1/0,c=-1/0,l=-1/0;for(let h=t*6,u=(t+e)*6;h<u;h+=6){const d=r[h+0];d<s&&(s=d),d>a&&(a=d);const f=r[h+2];f<n&&(n=f),f>c&&(c=f);const p=r[h+4];p<o&&(o=p),p>l&&(l=p)}i[0]=s,i[1]=n,i[2]=o,i[3]=a,i[4]=c,i[5]=l}function yN(r,t){bN(t);const e=r.attributes.position,i=r.index?r.index.array:null,s=Gc(r),n=new Float32Array(s*6),o=e.normalized,a=e.array,c=e.offset||0;let l=3;e.isInterleavedBufferAttribute&&(l=e.data.stride);const h=["getX","getY","getZ"];for(let u=0;u<s;u++){const d=u*3,f=u*6;let p=d+0,m=d+1,g=d+2;i&&(p=i[p],m=i[m],g=i[g]),o||(p=p*l+c,m=m*l+c,g=g*l+c);for(let I=0;I<3;I++){let C,b,E;o?(C=e[h[I]](p),b=e[h[I]](m),E=e[h[I]](g)):(C=a[p+I],b=a[m+I],E=a[g+I]);let T=C;b<T&&(T=b),E<T&&(T=E);let A=C;b>A&&(A=b),E>A&&(A=E);const S=(A-T)/2,_=I*2;n[f+_+0]=T+S,n[f+_+1]=S+(Math.abs(T)+S)*mN,T<t[I]&&(t[I]=T),A>t[I+3]&&(t[I+3]=A)}}return n}const dn=32,vN=(r,t)=>r.candidate-t.candidate,$n=new Array(dn).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),Tu=new Float32Array(6);function RN(r,t,e,i,s,n){let o=-1,a=0;if(n===wv)o=dC(t),o!==-1&&(a=(t[o]+t[o+3])/2);else if(n===fN)o=dC(r),o!==-1&&(a=AN(e,i,s,o));else if(n===pN){const c=hl(r);let l=Xp*s;const h=i*6,u=(i+s)*6;for(let d=0;d<3;d++){const f=t[d],g=(t[d+3]-f)/dn;if(s<dn/4){const I=[...$n];I.length=s;let C=0;for(let E=h;E<u;E+=6,C++){const T=I[C];T.candidate=e[E+2*d],T.count=0;const{bounds:A,leftCacheBounds:S,rightCacheBounds:_}=T;for(let w=0;w<3;w++)_[w]=1/0,_[w+3]=-1/0,S[w]=1/0,S[w+3]=-1/0,A[w]=1/0,A[w+3]=-1/0;bu(E,e,A)}I.sort(vN);let b=s;for(let E=0;E<b;E++){const T=I[E];for(;E+1<b&&I[E+1].candidate===T.candidate;)I.splice(E+1,1),b--}for(let E=h;E<u;E+=6){const T=e[E+2*d];for(let A=0;A<b;A++){const S=I[A];T>=S.candidate?bu(E,e,S.rightCacheBounds):(bu(E,e,S.leftCacheBounds),S.count++)}}for(let E=0;E<b;E++){const T=I[E],A=T.count,S=s-T.count,_=T.leftCacheBounds,w=T.rightCacheBounds;let F=0;A!==0&&(F=hl(_)/c);let D=0;S!==0&&(D=hl(w)/c);const R=uC+Xp*(F*A+D*S);R<l&&(o=d,l=R,a=T.candidate)}}else{for(let b=0;b<dn;b++){const E=$n[b];E.count=0,E.candidate=f+g+b*g;const T=E.bounds;for(let A=0;A<3;A++)T[A]=1/0,T[A+3]=-1/0}for(let b=h;b<u;b+=6){let A=~~((e[b+2*d]-f)/g);A>=dn&&(A=dn-1);const S=$n[A];S.count++,bu(b,e,S.bounds)}const I=$n[dn-1];fC(I.bounds,I.rightCacheBounds);for(let b=dn-2;b>=0;b--){const E=$n[b],T=$n[b+1];pC(E.bounds,T.rightCacheBounds,E.rightCacheBounds)}let C=0;for(let b=0;b<dn-1;b++){const E=$n[b],T=E.count,A=E.bounds,_=$n[b+1].rightCacheBounds;T!==0&&(C===0?fC(A,Tu):pC(A,Tu,Tu)),C+=T;let w=0,F=0;C!==0&&(w=hl(Tu)/c);const D=s-C;D!==0&&(F=hl(_)/c);const R=uC+Xp*(w*C+F*D);R<l&&(o=d,l=R,a=E.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${n} used.`);return{axis:o,pos:a}}function AN(r,t,e,i){let s=0;for(let n=t,o=t+e;n<o;n++)s+=r[n*6+i*2];return s/e}let yu=class{constructor(){}};function SN(r,t,e,i,s,n){let o=i,a=i+s-1;const c=n.pos,l=n.axis*2;for(;;){for(;o<=a&&e[o*6+l]<c;)o++;for(;o<=a&&e[a*6+l]>=c;)a--;if(o<a){for(let h=0;h<3;h++){let u=t[o*3+h];t[o*3+h]=t[a*3+h],t[a*3+h]=u}for(let h=0;h<6;h++){let u=e[o*6+h];e[o*6+h]=e[a*6+h],e[a*6+h]=u}o++,a--}else return o}}function wN(r,t,e,i,s,n){let o=i,a=i+s-1;const c=n.pos,l=n.axis*2;for(;;){for(;o<=a&&e[o*6+l]<c;)o++;for(;o<=a&&e[a*6+l]>=c;)a--;if(o<a){let h=r[o];r[o]=r[a],r[a]=h;for(let u=0;u<6;u++){let d=e[o*6+u];e[o*6+u]=e[a*6+u],e[a*6+u]=d}o++,a--}else return o}}function _N(r,t){const e=(r.index?r.index.count:r.attributes.position.count)/3,i=e>2**16,s=i?4:2,n=t?new SharedArrayBuffer(e*s):new ArrayBuffer(e*s),o=i?new Uint32Array(n):new Uint16Array(n);for(let a=0,c=o.length;a<c;a++)o[a]=a;return o}function FN(r,t){const e=r.geometry,i=e.index?e.index.array:null,s=t.maxDepth,n=t.verbose,o=t.maxLeafTris,a=t.strategy,c=t.onProgress,l=Gc(e),h=r._indirectBuffer;let u=!1;const d=new Float32Array(6),f=new Float32Array(6),p=yN(e,d),m=t.indirect?wN:SN,g=[],I=t.indirect?_v(e):Fv(e);if(I.length===1){const E=I[0],T=new yu;T.boundingData=d,TN(p,E.offset,E.count,f),b(T,E.offset,E.count,f),g.push(T)}else for(let E of I){const T=new yu;T.boundingData=new Float32Array(6),qp(p,E.offset,E.count,T.boundingData,f),b(T,E.offset,E.count,f),g.push(T)}return g;function C(E){c&&c(E/l)}function b(E,T,A,S=null,_=0){if(!u&&_>=s&&(u=!0,n&&(console.warn(`MeshBVH: Max depth of ${s} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),A<=o||_>=s)return C(T+A),E.offset=T,E.count=A,E;const w=RN(E.boundingData,S,p,T,A,a);if(w.axis===-1)return C(T+A),E.offset=T,E.count=A,E;const F=m(h,i,p,T,A,w);if(F===T||F===T+A)C(T+A),E.offset=T,E.count=A;else{E.splitAxis=w.axis;const D=new yu,R=T,O=F-T;E.left=D,D.boundingData=new Float32Array(6),qp(p,R,O,D.boundingData,f),b(D,R,O,f,_+1);const y=new yu,U=F,H=A-O;E.right=y,y.boundingData=new Float32Array(6),qp(p,U,H,y.boundingData,f),b(y,U,H,f,_+1)}return E}}function ON(r,t){const e=r.geometry;t.indirect&&(r._indirectBuffer=_N(e,t.useSharedArrayBuffer),CN(e)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),r._indirectBuffer||EN(e,t);const i=FN(r,t);let s,n,o;const a=[],c=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let u=0;u<i.length;u++){const d=i[u];let f=l(d);const p=new c(Zd*f);s=new Float32Array(p),n=new Uint32Array(p),o=new Uint16Array(p),h(0,d),a.push(p)}r._roots=a;return;function l(u){return u.count?1:1+l(u.left)+l(u.right)}function h(u,d){const f=u/4,p=u/2,m=!!d.count,g=d.boundingData;for(let I=0;I<6;I++)s[f+I]=g[I];if(m){const I=d.offset,C=d.count;return n[f+6]=I,o[p+14]=C,o[p+15]=op,u+Zd}else{const I=d.left,C=d.right,b=d.splitAxis;let E;if(E=h(u+Zd,I),E/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[f+6]=E/4,E=h(E,C),n[f+7]=b,E}}}let Mn=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,e){let i=1/0,s=-1/0;for(let n=0,o=t.length;n<o;n++){const c=t[n][e];i=c<i?c:i,s=c>s?c:s}this.min=i,this.max=s}setFromPoints(t,e){let i=1/0,s=-1/0;for(let n=0,o=e.length;n<o;n++){const a=e[n],c=t.dot(a);i=c<i?c:i,s=c>s?c:s}this.min=i,this.max=s}isSeparated(t){return this.min>t.max||t.min>this.max}};Mn.prototype.setFromBox=function(){const r=new M;return function(e,i){const s=i.min,n=i.max;let o=1/0,a=-1/0;for(let c=0;c<=1;c++)for(let l=0;l<=1;l++)for(let h=0;h<=1;h++){r.x=s.x*c+n.x*(1-c),r.y=s.y*l+n.y*(1-l),r.z=s.z*h+n.z*(1-h);const u=e.dot(r);o=Math.min(u,o),a=Math.max(u,a)}this.min=o,this.max=a}}();const xN=function(){const r=new M,t=new M,e=new M;return function(s,n,o){const a=s.start,c=r,l=n.start,h=t;e.subVectors(a,l),r.subVectors(s.end,s.start),t.subVectors(n.end,n.start);const u=e.dot(h),d=h.dot(c),f=h.dot(h),p=e.dot(c),g=c.dot(c)*f-d*d;let I,C;g!==0?I=(u*d-p*f)/g:I=0,C=(u+I*d)/f,o.x=I,o.y=C}}(),TE=function(){const r=new Ot,t=new M,e=new M;return function(s,n,o,a){xN(s,n,r);let c=r.x,l=r.y;if(c>=0&&c<=1&&l>=0&&l<=1){s.at(c,o),n.at(l,a);return}else if(c>=0&&c<=1){l<0?n.at(0,a):n.at(1,a),s.closestPointToPoint(a,!0,o);return}else if(l>=0&&l<=1){c<0?s.at(0,o):s.at(1,o),n.closestPointToPoint(o,!0,a);return}else{let h;c<0?h=s.start:h=s.end;let u;l<0?u=n.start:u=n.end;const d=t,f=e;if(s.closestPointToPoint(u,!0,t),n.closestPointToPoint(h,!0,e),d.distanceToSquared(u)<=f.distanceToSquared(h)){o.copy(d),a.copy(u);return}else{o.copy(h),a.copy(f);return}}}}(),NN=function(){const r=new M,t=new M,e=new Qe,i=new Vt;return function(n,o){const{radius:a,center:c}=n,{a:l,b:h,c:u}=o;if(i.start=l,i.end=h,i.closestPointToPoint(c,!0,r).distanceTo(c)<=a||(i.start=l,i.end=u,i.closestPointToPoint(c,!0,r).distanceTo(c)<=a)||(i.start=h,i.end=u,i.closestPointToPoint(c,!0,r).distanceTo(c)<=a))return!0;const m=o.getPlane(e);if(Math.abs(m.distanceToPoint(c))<=a){const I=m.projectPoint(c,t);if(o.containsPoint(I))return!0}return!1}}(),PN=1e-15;function Qp(r){return Math.abs(r)<PN}let _s=class extends $e{constructor(...t){super(...t),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new M),this.satBounds=new Array(4).fill().map(()=>new Mn),this.points=[this.a,this.b,this.c],this.sphere=new as,this.plane=new Qe,this.needsUpdate=!0}intersectsSphere(t){return NN(t,this)}update(){const t=this.a,e=this.b,i=this.c,s=this.points,n=this.satAxes,o=this.satBounds,a=n[0],c=o[0];this.getNormal(a),c.setFromPoints(a,s);const l=n[1],h=o[1];l.subVectors(t,e),h.setFromPoints(l,s);const u=n[2],d=o[2];u.subVectors(e,i),d.setFromPoints(u,s);const f=n[3],p=o[3];f.subVectors(i,t),p.setFromPoints(f,s),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,t),this.needsUpdate=!1}};_s.prototype.closestPointToSegment=function(){const r=new M,t=new M,e=new Vt;return function(s,n=null,o=null){const{start:a,end:c}=s,l=this.points;let h,u=1/0;for(let d=0;d<3;d++){const f=(d+1)%3;e.start.copy(l[d]),e.end.copy(l[f]),TE(e,s,r,t),h=r.distanceToSquared(t),h<u&&(u=h,n&&n.copy(r),o&&o.copy(t))}return this.closestPointToPoint(a,r),h=a.distanceToSquared(r),h<u&&(u=h,n&&n.copy(r),o&&o.copy(a)),this.closestPointToPoint(c,r),h=c.distanceToSquared(r),h<u&&(u=h,n&&n.copy(r),o&&o.copy(c)),Math.sqrt(u)}}();_s.prototype.intersectsTriangle=function(){const r=new _s,t=new Array(3),e=new Array(3),i=new Mn,s=new Mn,n=new M,o=new M,a=new M,c=new M,l=new M,h=new Vt,u=new Vt,d=new Vt,f=new M;function p(m,g,I){const C=m.points;let b=0,E=-1;for(let T=0;T<3;T++){const{start:A,end:S}=h;A.copy(C[T]),S.copy(C[(T+1)%3]),h.delta(o);const _=Qp(g.distanceToPoint(A));if(Qp(g.normal.dot(o))&&_){I.copy(h),b=2;break}const w=g.intersectLine(h,f);if(!w&&_&&f.copy(A),(w||_)&&!Qp(f.distanceTo(S))){if(b<=1)(b===1?I.start:I.end).copy(f),_&&(E=b);else if(b>=2){(E===1?I.start:I.end).copy(f),b=2;break}if(b++,b===2&&E===-1)break}}return b}return function(g,I=null,C=!1){this.needsUpdate&&this.update(),g.isExtendedTriangle?g.needsUpdate&&g.update():(r.copy(g),r.update(),g=r);const b=this.plane,E=g.plane;if(Math.abs(b.normal.dot(E.normal))>1-1e-10){const T=this.satBounds,A=this.satAxes;e[0]=g.a,e[1]=g.b,e[2]=g.c;for(let w=0;w<4;w++){const F=T[w],D=A[w];if(i.setFromPoints(D,e),F.isSeparated(i))return!1}const S=g.satBounds,_=g.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let w=0;w<4;w++){const F=S[w],D=_[w];if(i.setFromPoints(D,t),F.isSeparated(i))return!1}for(let w=0;w<4;w++){const F=A[w];for(let D=0;D<4;D++){const R=_[D];if(n.crossVectors(F,R),i.setFromPoints(n,t),s.setFromPoints(n,e),i.isSeparated(s))return!1}}return I&&(C||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),I.start.set(0,0,0),I.end.set(0,0,0)),!0}else{const T=p(this,E,u);if(T===1&&g.containsPoint(u.end))return I&&(I.start.copy(u.end),I.end.copy(u.end)),!0;if(T!==2)return!1;const A=p(g,b,d);if(A===1&&this.containsPoint(d.end))return I&&(I.start.copy(d.end),I.end.copy(d.end)),!0;if(A!==2)return!1;if(u.delta(a),d.delta(c),a.dot(c)<0){let O=d.start;d.start=d.end,d.end=O}const S=u.start.dot(a),_=u.end.dot(a),w=d.start.dot(a),F=d.end.dot(a),D=_<w,R=S<F;return S!==F&&w!==_&&D===R?!1:(I&&(l.subVectors(u.start,d.start),l.dot(a)>0?I.start.copy(u.start):I.start.copy(d.start),l.subVectors(u.end,d.end),l.dot(a)<0?I.end.copy(u.end):I.end.copy(d.end)),!0)}}}();_s.prototype.distanceToPoint=function(){const r=new M;return function(e){return this.closestPointToPoint(e,r),e.distanceTo(r)}}();_s.prototype.distanceToTriangle=function(){const r=new M,t=new M,e=["a","b","c"],i=new Vt,s=new Vt;return function(o,a=null,c=null){const l=a||c?i:null;if(this.intersectsTriangle(o,l))return(a||c)&&(a&&l.getCenter(a),c&&l.getCenter(c)),0;let h=1/0;for(let u=0;u<3;u++){let d;const f=e[u],p=o[f];this.closestPointToPoint(p,r),d=p.distanceToSquared(r),d<h&&(h=d,a&&a.copy(r),c&&c.copy(p));const m=this[f];o.closestPointToPoint(m,r),d=m.distanceToSquared(r),d<h&&(h=d,a&&a.copy(m),c&&c.copy(r))}for(let u=0;u<3;u++){const d=e[u],f=e[(u+1)%3];i.set(this[d],this[f]);for(let p=0;p<3;p++){const m=e[p],g=e[(p+1)%3];s.set(o[m],o[g]),TE(i,s,r,t);const I=r.distanceToSquared(t);I<h&&(h=I,a&&a.copy(r),c&&c.copy(t))}}return Math.sqrt(h)}}();let ci=class{constructor(t,e,i){this.isOrientedBox=!0,this.min=new M,this.max=new M,this.matrix=new ht,this.invMatrix=new ht,this.points=new Array(8).fill().map(()=>new M),this.satAxes=new Array(3).fill().map(()=>new M),this.satBounds=new Array(3).fill().map(()=>new Mn),this.alignedSatBounds=new Array(3).fill().map(()=>new Mn),this.needsUpdate=!1,t&&this.min.copy(t),e&&this.max.copy(e),i&&this.matrix.copy(i)}set(t,e,i){this.min.copy(t),this.max.copy(e),this.matrix.copy(i),this.needsUpdate=!0}copy(t){this.min.copy(t.min),this.max.copy(t.max),this.matrix.copy(t.matrix),this.needsUpdate=!0}};ci.prototype.update=function(){return function(){const t=this.matrix,e=this.min,i=this.max,s=this.points;for(let l=0;l<=1;l++)for(let h=0;h<=1;h++)for(let u=0;u<=1;u++){const d=1*l|2*h|4*u,f=s[d];f.x=l?i.x:e.x,f.y=h?i.y:e.y,f.z=u?i.z:e.z,f.applyMatrix4(t)}const n=this.satBounds,o=this.satAxes,a=s[0];for(let l=0;l<3;l++){const h=o[l],u=n[l],d=1<<l,f=s[d];h.subVectors(a,f),u.setFromPoints(h,s)}const c=this.alignedSatBounds;c[0].setFromPointsField(s,"x"),c[1].setFromPointsField(s,"y"),c[2].setFromPointsField(s,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();ci.prototype.intersectsBox=function(){const r=new Mn;return function(e){this.needsUpdate&&this.update();const i=e.min,s=e.max,n=this.satBounds,o=this.satAxes,a=this.alignedSatBounds;if(r.min=i.x,r.max=s.x,a[0].isSeparated(r)||(r.min=i.y,r.max=s.y,a[1].isSeparated(r))||(r.min=i.z,r.max=s.z,a[2].isSeparated(r)))return!1;for(let c=0;c<3;c++){const l=o[c],h=n[c];if(r.setFromBox(l,e),h.isSeparated(r))return!1}return!0}}();ci.prototype.intersectsTriangle=function(){const r=new _s,t=new Array(3),e=new Mn,i=new Mn,s=new M;return function(o){this.needsUpdate&&this.update(),o.isExtendedTriangle?o.needsUpdate&&o.update():(r.copy(o),r.update(),o=r);const a=this.satBounds,c=this.satAxes;t[0]=o.a,t[1]=o.b,t[2]=o.c;for(let d=0;d<3;d++){const f=a[d],p=c[d];if(e.setFromPoints(p,t),f.isSeparated(e))return!1}const l=o.satBounds,h=o.satAxes,u=this.points;for(let d=0;d<3;d++){const f=l[d],p=h[d];if(e.setFromPoints(p,u),f.isSeparated(e))return!1}for(let d=0;d<3;d++){const f=c[d];for(let p=0;p<4;p++){const m=h[p];if(s.crossVectors(f,m),e.setFromPoints(s,t),i.setFromPoints(s,u),e.isSeparated(i))return!1}}return!0}}();ci.prototype.closestPointToPoint=function(){return function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();ci.prototype.distanceToPoint=function(){const r=new M;return function(e){return this.closestPointToPoint(e,r),e.distanceTo(r)}}();ci.prototype.distanceToBox=function(){const r=["x","y","z"],t=new Array(12).fill().map(()=>new Vt),e=new Array(12).fill().map(()=>new Vt),i=new M,s=new M;return function(o,a=0,c=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(o))return(c||l)&&(o.getCenter(s),this.closestPointToPoint(s,i),o.closestPointToPoint(i,s),c&&c.copy(i),l&&l.copy(s)),0;const h=a*a,u=o.min,d=o.max,f=this.points;let p=1/0;for(let g=0;g<8;g++){const I=f[g];s.copy(I).clamp(u,d);const C=I.distanceToSquared(s);if(C<p&&(p=C,c&&c.copy(I),l&&l.copy(s),C<h))return Math.sqrt(C)}let m=0;for(let g=0;g<3;g++)for(let I=0;I<=1;I++)for(let C=0;C<=1;C++){const b=(g+1)%3,E=(g+2)%3,T=I<<b|C<<E,A=1<<g|I<<b|C<<E,S=f[T],_=f[A];t[m].set(S,_);const F=r[g],D=r[b],R=r[E],O=e[m],y=O.start,U=O.end;y[F]=u[F],y[D]=I?u[D]:d[D],y[R]=C?u[R]:d[D],U[F]=d[F],U[D]=I?u[D]:d[D],U[R]=C?u[R]:d[D],m++}for(let g=0;g<=1;g++)for(let I=0;I<=1;I++)for(let C=0;C<=1;C++){s.x=g?d.x:u.x,s.y=I?d.y:u.y,s.z=C?d.z:u.z,this.closestPointToPoint(s,i);const b=s.distanceToSquared(i);if(b<p&&(p=b,c&&c.copy(i),l&&l.copy(s),b<h))return Math.sqrt(b)}for(let g=0;g<12;g++){const I=t[g];for(let C=0;C<12;C++){const b=e[C];TE(I,b,i,s);const E=i.distanceToSquared(s);if(E<p&&(p=E,c&&c.copy(i),l&&l.copy(s),E<h))return Math.sqrt(E)}}return Math.sqrt(p)}}();let yE=class{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){const t=this._primitives;return t.length===0?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}},LN=class extends yE{constructor(){super(()=>new _s)}};const zi=new LN;function Ci(r,t){return t[r+15]===65535}function vi(r,t){return t[r+6]}function Yi(r,t){return t[r+14]}function Gi(r){return r+8}function Hi(r,t){return t[r+6]}function Ov(r,t){return t[r+7]}let MN=class{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const t=[];let e=null;this.setBuffer=i=>{e&&t.push(e),e=i,this.float32Array=new Float32Array(i),this.uint16Array=new Uint16Array(i),this.uint32Array=new Uint32Array(i)},this.clearBuffer=()=>{e=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,t.length!==0&&this.setBuffer(t.pop())}}};const le=new MN;let dr,Va;const qo=[],vu=new yE(()=>new vt);function DN(r,t,e,i,s,n){dr=vu.getPrimitive(),Va=vu.getPrimitive(),qo.push(dr,Va),le.setBuffer(r._roots[t]);const o=RI(0,r.geometry,e,i,s,n);le.clearBuffer(),vu.releasePrimitive(dr),vu.releasePrimitive(Va),qo.pop(),qo.pop();const a=qo.length;return a>0&&(Va=qo[a-1],dr=qo[a-2]),o}function RI(r,t,e,i,s=null,n=0,o=0){const{float32Array:a,uint16Array:c,uint32Array:l}=le;let h=r*2;if(Ci(h,c)){const d=vi(r,l),f=Yi(h,c);return Ie(r,a,dr),i(d,f,!1,o,n+r,dr)}else{let d=function(R){const{uint16Array:O,uint32Array:y}=le;let U=R*2;for(;!Ci(U,O);)R=Gi(R),U=R*2;return vi(R,y)},f=function(R){const{uint16Array:O,uint32Array:y}=le;let U=R*2;for(;!Ci(U,O);)R=Hi(R,y),U=R*2;return vi(R,y)+Yi(U,O)};const p=Gi(r),m=Hi(r,l);let g=p,I=m,C,b,E,T;if(s&&(E=dr,T=Va,Ie(g,a,E),Ie(I,a,T),C=s(E),b=s(T),b<C)){g=m,I=p;const R=C;C=b,b=R,E=T}E||(E=dr,Ie(g,a,E));const A=Ci(g*2,c),S=e(E,A,C,o+1,n+g);let _;if(S===hC){const R=d(g),y=f(g)-R;_=i(R,y,!0,o+1,n+g,E)}else _=S&&RI(g,t,e,i,s,n,o+1);if(_)return!0;T=Va,Ie(I,a,T);const w=Ci(I*2,c),F=e(T,w,b,o+1,n+I);let D;if(F===hC){const R=d(I),y=f(I)-R;D=i(R,y,!0,o+1,n+I,T)}else D=F&&RI(I,t,e,i,s,n,o+1);return!!D}}const ul=new M,Kp=new M;function UN(r,t,e={},i=0,s=1/0){const n=i*i,o=s*s;let a=1/0,c=null;if(r.shapecast({boundsTraverseOrder:h=>(ul.copy(t).clamp(h.min,h.max),ul.distanceToSquared(t)),intersectsBounds:(h,u,d)=>d<a&&d<o,intersectsTriangle:(h,u)=>{h.closestPointToPoint(t,ul);const d=t.distanceToSquared(ul);return d<a&&(Kp.copy(ul),a=d,c=u),d<n}}),a===1/0)return null;const l=Math.sqrt(a);return e.point?e.point.copy(Kp):e.point=Kp.clone(),e.distance=l,e.faceIndex=c,e}const Qo=new M,Ko=new M,Jo=new M,Ru=new Ot,Au=new Ot,Su=new Ot,mC=new M,IC=new M,gC=new M,wu=new M;function BN(r,t,e,i,s,n){let o;return n===Qg?o=r.intersectTriangle(i,e,t,!0,s):o=r.intersectTriangle(t,e,i,n!==Ps,s),o===null?null:{distance:r.origin.distanceTo(s),point:s.clone()}}function kN(r,t,e,i,s,n,o,a,c){Qo.fromBufferAttribute(t,n),Ko.fromBufferAttribute(t,o),Jo.fromBufferAttribute(t,a);const l=BN(r,Qo,Ko,Jo,wu,c);if(l){i&&(Ru.fromBufferAttribute(i,n),Au.fromBufferAttribute(i,o),Su.fromBufferAttribute(i,a),l.uv=$e.getInterpolation(wu,Qo,Ko,Jo,Ru,Au,Su,new Ot)),s&&(Ru.fromBufferAttribute(s,n),Au.fromBufferAttribute(s,o),Su.fromBufferAttribute(s,a),l.uv1=$e.getInterpolation(wu,Qo,Ko,Jo,Ru,Au,Su,new Ot)),e&&(mC.fromBufferAttribute(e,n),IC.fromBufferAttribute(e,o),gC.fromBufferAttribute(e,a),l.normal=$e.getInterpolation(wu,Qo,Ko,Jo,mC,IC,gC,new M),l.normal.dot(r.direction)>0&&l.normal.multiplyScalar(-1));const h={a:n,b:o,c:a,normal:new M,materialIndex:0};$e.getNormal(Qo,Ko,Jo,h.normal),l.face=h,l.faceIndex=n}return l}function ap(r,t,e,i,s){const n=i*3;let o=n+0,a=n+1,c=n+2;const l=r.index;r.index&&(o=l.getX(o),a=l.getX(a),c=l.getX(c));const{position:h,normal:u,uv:d,uv1:f}=r.attributes,p=kN(e,h,u,d,f,o,a,c,t);return p?(p.faceIndex=i,s&&s.push(p),p):null}function Oe(r,t,e,i){const s=r.a,n=r.b,o=r.c;let a=t,c=t+1,l=t+2;e&&(a=e.getX(a),c=e.getX(c),l=e.getX(l)),s.x=i.getX(a),s.y=i.getY(a),s.z=i.getZ(a),n.x=i.getX(c),n.y=i.getY(c),n.z=i.getZ(c),o.x=i.getX(l),o.y=i.getY(l),o.z=i.getZ(l)}function VN(r,t,e,i,s,n){const{geometry:o,_indirectBuffer:a}=r;for(let c=i,l=i+s;c<l;c++)ap(o,t,e,c,n)}function zN(r,t,e,i,s){const{geometry:n,_indirectBuffer:o}=r;let a=1/0,c=null;for(let l=i,h=i+s;l<h;l++){let u;u=ap(n,t,e,l),u&&u.distance<a&&(c=u,a=u.distance)}return c}function YN(r,t,e,i,s,n,o){const{geometry:a}=e,{index:c}=a,l=a.attributes.position;for(let h=r,u=t+r;h<u;h++){let d;if(d=h,Oe(o,d*3,c,l),o.needsUpdate=!0,i(o,d,s,n))return!0}return!1}function GN(r,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=r.geometry,i=e.index?e.index.array:null,s=e.attributes.position;let n,o,a,c,l=0;const h=r._roots;for(let d=0,f=h.length;d<f;d++)n=h[d],o=new Uint32Array(n),a=new Uint16Array(n),c=new Float32Array(n),u(0,l),l+=n.byteLength;function u(d,f,p=!1){const m=d*2;if(a[m+15]===op){const I=o[d+6],C=a[m+14];let b=1/0,E=1/0,T=1/0,A=-1/0,S=-1/0,_=-1/0;for(let w=3*I,F=3*(I+C);w<F;w++){let D=i[w];const R=s.getX(D),O=s.getY(D),y=s.getZ(D);R<b&&(b=R),R>A&&(A=R),O<E&&(E=O),O>S&&(S=O),y<T&&(T=y),y>_&&(_=y)}return c[d+0]!==b||c[d+1]!==E||c[d+2]!==T||c[d+3]!==A||c[d+4]!==S||c[d+5]!==_?(c[d+0]=b,c[d+1]=E,c[d+2]=T,c[d+3]=A,c[d+4]=S,c[d+5]=_,!0):!1}else{const I=d+8,C=o[d+6],b=I+f,E=C+f;let T=p,A=!1,S=!1;t?T||(A=t.has(b),S=t.has(E),T=!A&&!S):(A=!0,S=!0);const _=T||A,w=T||S;let F=!1;_&&(F=u(I,f,T));let D=!1;w&&(D=u(C,f,T));const R=F||D;if(R)for(let O=0;O<3;O++){const y=I+O,U=C+O,H=c[y],k=c[y+3],X=c[U],$=c[U+3];c[d+O]=H<X?H:X,c[d+O+3]=k>$?k:$}return R}}}const EC=new vt;function vr(r,t,e,i){return Ie(r,t,EC),e.intersectBox(EC,i)}function HN(r,t,e,i,s,n){const{geometry:o,_indirectBuffer:a}=r;for(let c=i,l=i+s;c<l;c++){let h=a?a[c]:c;ap(o,t,e,h,n)}}function $N(r,t,e,i,s){const{geometry:n,_indirectBuffer:o}=r;let a=1/0,c=null;for(let l=i,h=i+s;l<h;l++){let u;u=ap(n,t,e,o?o[l]:l),u&&u.distance<a&&(c=u,a=u.distance)}return c}function WN(r,t,e,i,s,n,o){const{geometry:a}=e,{index:c}=a,l=a.attributes.position;for(let h=r,u=t+r;h<u;h++){let d;if(d=e.resolveTriangleIndex(h),Oe(o,d*3,c,l),o.needsUpdate=!0,i(o,d,s,n))return!0}return!1}const CC=new M;function jN(r,t,e,i,s){le.setBuffer(r._roots[t]),AI(0,r,e,i,s),le.clearBuffer()}function AI(r,t,e,i,s){const{float32Array:n,uint16Array:o,uint32Array:a}=le,c=r*2;if(Ci(c,o)){const h=vi(r,a),u=Yi(c,o);VN(t,e,i,h,u,s)}else{const h=Gi(r);vr(h,n,i,CC)&&AI(h,t,e,i,s);const u=Hi(r,a);vr(u,n,i,CC)&&AI(u,t,e,i,s)}}const bC=new M,XN=["x","y","z"];function ZN(r,t,e,i){le.setBuffer(r._roots[t]);const s=SI(0,r,e,i);return le.clearBuffer(),s}function SI(r,t,e,i){const{float32Array:s,uint16Array:n,uint32Array:o}=le;let a=r*2;if(Ci(a,n)){const l=vi(r,o),h=Yi(a,n);return zN(t,e,i,l,h)}else{const l=Ov(r,o),h=XN[l],d=i.direction[h]>=0;let f,p;d?(f=Gi(r),p=Hi(r,o)):(f=Hi(r,o),p=Gi(r));const g=vr(f,s,i,bC)?SI(f,t,e,i):null;if(g){const b=g.point[h];if(d?b<=s[p+l]:b>=s[p+l+3])return g}const C=vr(p,s,i,bC)?SI(p,t,e,i):null;return g&&C?g.distance<=C.distance?g:C:g||C||null}}const _u=new vt,ta=new _s,ea=new _s,dl=new ht,TC=new ci,Fu=new ci;function qN(r,t,e,i){le.setBuffer(r._roots[t]);const s=wI(0,r,e,i);return le.clearBuffer(),s}function wI(r,t,e,i,s=null){const{float32Array:n,uint16Array:o,uint32Array:a}=le;let c=r*2;if(s===null&&(e.boundingBox||e.computeBoundingBox(),TC.set(e.boundingBox.min,e.boundingBox.max,i),s=TC),Ci(c,o)){const h=t.geometry,u=h.index,d=h.attributes.position,f=e.index,p=e.attributes.position,m=vi(r,a),g=Yi(c,o);if(dl.copy(i).invert(),e.boundsTree)return Ie(r,n,Fu),Fu.matrix.copy(dl),Fu.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:C=>Fu.intersectsBox(C),intersectsTriangle:C=>{C.a.applyMatrix4(i),C.b.applyMatrix4(i),C.c.applyMatrix4(i),C.needsUpdate=!0;for(let b=m*3,E=(g+m)*3;b<E;b+=3)if(Oe(ea,b,u,d),ea.needsUpdate=!0,C.intersectsTriangle(ea))return!0;return!1}});for(let I=m*3,C=(g+m)*3;I<C;I+=3){Oe(ta,I,u,d),ta.a.applyMatrix4(dl),ta.b.applyMatrix4(dl),ta.c.applyMatrix4(dl),ta.needsUpdate=!0;for(let b=0,E=f.count;b<E;b+=3)if(Oe(ea,b,f,p),ea.needsUpdate=!0,ta.intersectsTriangle(ea))return!0}}else{const h=r+8,u=a[r+6];return Ie(h,n,_u),!!(s.intersectsBox(_u)&&wI(h,t,e,i,s)||(Ie(u,n,_u),s.intersectsBox(_u)&&wI(u,t,e,i,s)))}}const Ou=new ht,Jp=new ci,fl=new ci,QN=new M,KN=new M,JN=new M,tP=new M;function eP(r,t,e,i={},s={},n=0,o=1/0){t.boundingBox||t.computeBoundingBox(),Jp.set(t.boundingBox.min,t.boundingBox.max,e),Jp.needsUpdate=!0;const a=r.geometry,c=a.attributes.position,l=a.index,h=t.attributes.position,u=t.index,d=zi.getPrimitive(),f=zi.getPrimitive();let p=QN,m=KN,g=null,I=null;s&&(g=JN,I=tP);let C=1/0,b=null,E=null;return Ou.copy(e).invert(),fl.matrix.copy(Ou),r.shapecast({boundsTraverseOrder:T=>Jp.distanceToBox(T),intersectsBounds:(T,A,S)=>S<C&&S<o?(A&&(fl.min.copy(T.min),fl.max.copy(T.max),fl.needsUpdate=!0),!0):!1,intersectsRange:(T,A)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:_=>fl.distanceToBox(_),intersectsBounds:(_,w,F)=>F<C&&F<o,intersectsRange:(_,w)=>{for(let F=_,D=_+w;F<D;F++){Oe(f,3*F,u,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let R=T,O=T+A;R<O;R++){Oe(d,3*R,l,c),d.needsUpdate=!0;const y=d.distanceToTriangle(f,p,g);if(y<C&&(m.copy(p),I&&I.copy(g),C=y,b=R,E=F),y<n)return!0}}}});{const S=Gc(t);for(let _=0,w=S;_<w;_++){Oe(f,3*_,u,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let F=T,D=T+A;F<D;F++){Oe(d,3*F,l,c),d.needsUpdate=!0;const R=d.distanceToTriangle(f,p,g);if(R<C&&(m.copy(p),I&&I.copy(g),C=R,b=F,E=_),R<n)return!0}}}}}),zi.releasePrimitive(d),zi.releasePrimitive(f),C===1/0?null:(i.point?i.point.copy(m):i.point=m.clone(),i.distance=C,i.faceIndex=b,s&&(s.point?s.point.copy(I):s.point=I.clone(),s.point.applyMatrix4(Ou),m.applyMatrix4(Ou),s.distance=m.sub(s.point).length(),s.faceIndex=E),i)}function iP(r,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=r.geometry,i=e.index?e.index.array:null,s=e.attributes.position;let n,o,a,c,l=0;const h=r._roots;for(let d=0,f=h.length;d<f;d++)n=h[d],o=new Uint32Array(n),a=new Uint16Array(n),c=new Float32Array(n),u(0,l),l+=n.byteLength;function u(d,f,p=!1){const m=d*2;if(a[m+15]===op){const I=o[d+6],C=a[m+14];let b=1/0,E=1/0,T=1/0,A=-1/0,S=-1/0,_=-1/0;for(let w=I,F=I+C;w<F;w++){const D=3*r.resolveTriangleIndex(w);for(let R=0;R<3;R++){let O=D+R;O=i?i[O]:O;const y=s.getX(O),U=s.getY(O),H=s.getZ(O);y<b&&(b=y),y>A&&(A=y),U<E&&(E=U),U>S&&(S=U),H<T&&(T=H),H>_&&(_=H)}}return c[d+0]!==b||c[d+1]!==E||c[d+2]!==T||c[d+3]!==A||c[d+4]!==S||c[d+5]!==_?(c[d+0]=b,c[d+1]=E,c[d+2]=T,c[d+3]=A,c[d+4]=S,c[d+5]=_,!0):!1}else{const I=d+8,C=o[d+6],b=I+f,E=C+f;let T=p,A=!1,S=!1;t?T||(A=t.has(b),S=t.has(E),T=!A&&!S):(A=!0,S=!0);const _=T||A,w=T||S;let F=!1;_&&(F=u(I,f,T));let D=!1;w&&(D=u(C,f,T));const R=F||D;if(R)for(let O=0;O<3;O++){const y=I+O,U=C+O,H=c[y],k=c[y+3],X=c[U],$=c[U+3];c[d+O]=H<X?H:X,c[d+O+3]=k>$?k:$}return R}}}const yC=new M;function sP(r,t,e,i,s){le.setBuffer(r._roots[t]),_I(0,r,e,i,s),le.clearBuffer()}function _I(r,t,e,i,s){const{float32Array:n,uint16Array:o,uint32Array:a}=le,c=r*2;if(Ci(c,o)){const h=vi(r,a),u=Yi(c,o);HN(t,e,i,h,u,s)}else{const h=Gi(r);vr(h,n,i,yC)&&_I(h,t,e,i,s);const u=Hi(r,a);vr(u,n,i,yC)&&_I(u,t,e,i,s)}}const vC=new M,nP=["x","y","z"];function rP(r,t,e,i){le.setBuffer(r._roots[t]);const s=FI(0,r,e,i);return le.clearBuffer(),s}function FI(r,t,e,i){const{float32Array:s,uint16Array:n,uint32Array:o}=le;let a=r*2;if(Ci(a,n)){const l=vi(r,o),h=Yi(a,n);return $N(t,e,i,l,h)}else{const l=Ov(r,o),h=nP[l],d=i.direction[h]>=0;let f,p;d?(f=Gi(r),p=Hi(r,o)):(f=Hi(r,o),p=Gi(r));const g=vr(f,s,i,vC)?FI(f,t,e,i):null;if(g){const b=g.point[h];if(d?b<=s[p+l]:b>=s[p+l+3])return g}const C=vr(p,s,i,vC)?FI(p,t,e,i):null;return g&&C?g.distance<=C.distance?g:C:g||C||null}}const xu=new vt,ia=new _s,sa=new _s,pl=new ht,RC=new ci,Nu=new ci;function oP(r,t,e,i){le.setBuffer(r._roots[t]);const s=OI(0,r,e,i);return le.clearBuffer(),s}function OI(r,t,e,i,s=null){const{float32Array:n,uint16Array:o,uint32Array:a}=le;let c=r*2;if(s===null&&(e.boundingBox||e.computeBoundingBox(),RC.set(e.boundingBox.min,e.boundingBox.max,i),s=RC),Ci(c,o)){const h=t.geometry,u=h.index,d=h.attributes.position,f=e.index,p=e.attributes.position,m=vi(r,a),g=Yi(c,o);if(pl.copy(i).invert(),e.boundsTree)return Ie(r,n,Nu),Nu.matrix.copy(pl),Nu.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:C=>Nu.intersectsBox(C),intersectsTriangle:C=>{C.a.applyMatrix4(i),C.b.applyMatrix4(i),C.c.applyMatrix4(i),C.needsUpdate=!0;for(let b=m,E=g+m;b<E;b++)if(Oe(sa,3*t.resolveTriangleIndex(b),u,d),sa.needsUpdate=!0,C.intersectsTriangle(sa))return!0;return!1}});for(let I=m,C=g+m;I<C;I++){const b=t.resolveTriangleIndex(I);Oe(ia,3*b,u,d),ia.a.applyMatrix4(pl),ia.b.applyMatrix4(pl),ia.c.applyMatrix4(pl),ia.needsUpdate=!0;for(let E=0,T=f.count;E<T;E+=3)if(Oe(sa,E,f,p),sa.needsUpdate=!0,ia.intersectsTriangle(sa))return!0}}else{const h=r+8,u=a[r+6];return Ie(h,n,xu),!!(s.intersectsBox(xu)&&OI(h,t,e,i,s)||(Ie(u,n,xu),s.intersectsBox(xu)&&OI(u,t,e,i,s)))}}const Pu=new ht,tm=new ci,ml=new ci,aP=new M,cP=new M,lP=new M,hP=new M;function uP(r,t,e,i={},s={},n=0,o=1/0){t.boundingBox||t.computeBoundingBox(),tm.set(t.boundingBox.min,t.boundingBox.max,e),tm.needsUpdate=!0;const a=r.geometry,c=a.attributes.position,l=a.index,h=t.attributes.position,u=t.index,d=zi.getPrimitive(),f=zi.getPrimitive();let p=aP,m=cP,g=null,I=null;s&&(g=lP,I=hP);let C=1/0,b=null,E=null;return Pu.copy(e).invert(),ml.matrix.copy(Pu),r.shapecast({boundsTraverseOrder:T=>tm.distanceToBox(T),intersectsBounds:(T,A,S)=>S<C&&S<o?(A&&(ml.min.copy(T.min),ml.max.copy(T.max),ml.needsUpdate=!0),!0):!1,intersectsRange:(T,A)=>{if(t.boundsTree){const S=t.boundsTree;return S.shapecast({boundsTraverseOrder:_=>ml.distanceToBox(_),intersectsBounds:(_,w,F)=>F<C&&F<o,intersectsRange:(_,w)=>{for(let F=_,D=_+w;F<D;F++){const R=S.resolveTriangleIndex(F);Oe(f,3*R,u,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let O=T,y=T+A;O<y;O++){const U=r.resolveTriangleIndex(O);Oe(d,3*U,l,c),d.needsUpdate=!0;const H=d.distanceToTriangle(f,p,g);if(H<C&&(m.copy(p),I&&I.copy(g),C=H,b=O,E=F),H<n)return!0}}}})}else{const S=Gc(t);for(let _=0,w=S;_<w;_++){Oe(f,3*_,u,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let F=T,D=T+A;F<D;F++){const R=r.resolveTriangleIndex(F);Oe(d,3*R,l,c),d.needsUpdate=!0;const O=d.distanceToTriangle(f,p,g);if(O<C&&(m.copy(p),I&&I.copy(g),C=O,b=F,E=_),O<n)return!0}}}}}),zi.releasePrimitive(d),zi.releasePrimitive(f),C===1/0?null:(i.point?i.point.copy(m):i.point=m.clone(),i.distance=C,i.faceIndex=b,s&&(s.point?s.point.copy(I):s.point=I.clone(),s.point.applyMatrix4(Pu),m.applyMatrix4(Pu),s.distance=m.sub(s.point).length(),s.faceIndex=E),i)}function dP(){return typeof SharedArrayBuffer<"u"}const ah=new le.constructor,Af=new le.constructor,ir=new yE(()=>new vt),na=new vt,ra=new vt,em=new vt,im=new vt;let sm=!1;function fP(r,t,e,i){if(sm)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");sm=!0;const s=r._roots,n=t._roots;let o,a=0,c=0;const l=new ht().copy(e).invert();for(let h=0,u=s.length;h<u;h++){ah.setBuffer(s[h]),c=0;const d=ir.getPrimitive();Ie(0,ah.float32Array,d),d.applyMatrix4(l);for(let f=0,p=n.length;f<p&&(Af.setBuffer(n[h]),o=Cs(0,0,e,l,i,a,c,0,0,d),Af.clearBuffer(),c+=n[f].length,!o);f++);if(ir.releasePrimitive(d),ah.clearBuffer(),a+=s[h].length,o)break}return sm=!1,o}function Cs(r,t,e,i,s,n=0,o=0,a=0,c=0,l=null,h=!1){let u,d;h?(u=Af,d=ah):(u=ah,d=Af);const f=u.float32Array,p=u.uint32Array,m=u.uint16Array,g=d.float32Array,I=d.uint32Array,C=d.uint16Array,b=r*2,E=t*2,T=Ci(b,m),A=Ci(E,C);let S=!1;if(A&&T)h?S=s(vi(t,I),Yi(t*2,C),vi(r,p),Yi(r*2,m),c,o+t,a,n+r):S=s(vi(r,p),Yi(r*2,m),vi(t,I),Yi(t*2,C),a,n+r,c,o+t);else if(A){const _=ir.getPrimitive();Ie(t,g,_),_.applyMatrix4(e);const w=Gi(r),F=Hi(r,p);Ie(w,f,na),Ie(F,f,ra);const D=_.intersectsBox(na),R=_.intersectsBox(ra);S=D&&Cs(t,w,i,e,s,o,n,c,a+1,_,!h)||R&&Cs(t,F,i,e,s,o,n,c,a+1,_,!h),ir.releasePrimitive(_)}else{const _=Gi(t),w=Hi(t,I);Ie(_,g,em),Ie(w,g,im);const F=l.intersectsBox(em),D=l.intersectsBox(im);if(F&&D)S=Cs(r,_,e,i,s,n,o,a,c+1,l,h)||Cs(r,w,e,i,s,n,o,a,c+1,l,h);else if(F)if(T)S=Cs(r,_,e,i,s,n,o,a,c+1,l,h);else{const R=ir.getPrimitive();R.copy(em).applyMatrix4(e);const O=Gi(r),y=Hi(r,p);Ie(O,f,na),Ie(y,f,ra);const U=R.intersectsBox(na),H=R.intersectsBox(ra);S=U&&Cs(_,O,i,e,s,o,n,c,a+1,R,!h)||H&&Cs(_,y,i,e,s,o,n,c,a+1,R,!h),ir.releasePrimitive(R)}else if(D)if(T)S=Cs(r,w,e,i,s,n,o,a,c+1,l,h);else{const R=ir.getPrimitive();R.copy(im).applyMatrix4(e);const O=Gi(r),y=Hi(r,p);Ie(O,f,na),Ie(y,f,ra);const U=R.intersectsBox(na),H=R.intersectsBox(ra);S=U&&Cs(w,O,i,e,s,o,n,c,a+1,R,!h)||H&&Cs(w,y,i,e,s,o,n,c,a+1,R,!h),ir.releasePrimitive(R)}}return S}const Lu=new ci,AC=new vt;let pP=class xv{static serialize(t,e={}){e={cloneBuffers:!0,...e};const i=t.geometry,s=t._roots,n=t._indirectBuffer,o=i.getIndex();let a;return e.cloneBuffers?a={roots:s.map(c=>c.slice()),index:o.array.slice(),indirectBuffer:n?n.slice():null}:a={roots:s,index:o.array,indirectBuffer:n},a}static deserialize(t,e,i={}){i={setIndex:!0,indirect:!!t.indirectBuffer,...i};const{index:s,roots:n,indirectBuffer:o}=t,a=new xv(e,{...i,[Zp]:!0});if(a._roots=n,a._indirectBuffer=o||null,i.setIndex){const c=e.getIndex();if(c===null){const l=new Kt(t.index,1,!1);e.setIndex(l)}else c.array!==s&&(c.array.set(s),c.needsUpdate=!0)}return a}get indirect(){return!!this._indirectBuffer}constructor(t,e={}){if(t.isBufferGeometry){if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e=Object.assign({strategy:wv,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,[Zp]:!1},e),e.useSharedArrayBuffer&&!dP())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=t,this._roots=null,this._indirectBuffer=null,e[Zp]||(ON(this,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new vt)));const{_indirectBuffer:i}=this;this.resolveTriangleIndex=e.indirect?s=>i[s]:s=>s}refit(t=null){return(this.indirect?iP:GN)(this,t)}traverse(t,e=0){const i=this._roots[e],s=new Uint32Array(i),n=new Uint16Array(i);o(0);function o(a,c=0){const l=a*2,h=n[l+15]===op;if(h){const u=s[a+6],d=n[l+14];t(c,h,new Float32Array(i,a*4,6),u,d)}else{const u=a+Zd/4,d=s[a+6],f=s[a+7];t(c,h,new Float32Array(i,a*4,6),f)||(o(u,c+1),o(d,c+1))}}}raycast(t,e=qa){const i=this._roots,s=this.geometry,n=[],o=e.isMaterial,a=Array.isArray(e),c=s.groups,l=o?e.side:e,h=this.indirect?sP:jN;for(let u=0,d=i.length;u<d;u++){const f=a?e[c[u].materialIndex].side:l,p=n.length;if(h(this,u,f,t,n),a){const m=c[u].materialIndex;for(let g=p,I=n.length;g<I;g++)n[g].face.materialIndex=m}}return n}raycastFirst(t,e=qa){const i=this._roots,s=this.geometry,n=e.isMaterial,o=Array.isArray(e);let a=null;const c=s.groups,l=n?e.side:e,h=this.indirect?rP:ZN;for(let u=0,d=i.length;u<d;u++){const f=o?e[c[u].materialIndex].side:l,p=h(this,u,f,t);p!=null&&(a==null||p.distance<a.distance)&&(a=p,o&&(p.face.materialIndex=c[u].materialIndex))}return a}intersectsGeometry(t,e){let i=!1;const s=this._roots,n=this.indirect?oP:qN;for(let o=0,a=s.length;o<a&&(i=n(this,o,t,e),!i);o++);return i}shapecast(t){const e=zi.getPrimitive(),i=this.indirect?WN:YN;let{boundsTraverseOrder:s,intersectsBounds:n,intersectsRange:o,intersectsTriangle:a}=t;if(o&&a){const u=o;o=(d,f,p,m,g)=>u(d,f,p,m,g)?!0:i(d,f,this,a,p,m,e)}else o||(a?o=(u,d,f,p)=>i(u,d,this,a,f,p,e):o=(u,d,f)=>f);let c=!1,l=0;const h=this._roots;for(let u=0,d=h.length;u<d;u++){const f=h[u];if(c=DN(this,u,n,o,s,l),c)break;l+=f.byteLength}return zi.releasePrimitive(e),c}bvhcast(t,e,i){let{intersectsRanges:s,intersectsTriangles:n}=i;const o=zi.getPrimitive(),a=this.geometry.index,c=this.geometry.attributes.position,l=this.indirect?p=>{const m=this.resolveTriangleIndex(p);Oe(o,m*3,a,c)}:p=>{Oe(o,p*3,a,c)},h=zi.getPrimitive(),u=t.geometry.index,d=t.geometry.attributes.position,f=t.indirect?p=>{const m=t.resolveTriangleIndex(p);Oe(h,m*3,u,d)}:p=>{Oe(h,p*3,u,d)};if(n){const p=(m,g,I,C,b,E,T,A)=>{for(let S=I,_=I+C;S<_;S++){f(S),h.a.applyMatrix4(e),h.b.applyMatrix4(e),h.c.applyMatrix4(e),h.needsUpdate=!0;for(let w=m,F=m+g;w<F;w++)if(l(w),o.needsUpdate=!0,n(o,h,w,S,b,E,T,A))return!0}return!1};if(s){const m=s;s=function(g,I,C,b,E,T,A,S){return m(g,I,C,b,E,T,A,S)?!0:p(g,I,C,b,E,T,A,S)}}else s=p}return fP(this,t,e,s)}intersectsBox(t,e){return Lu.set(t.min,t.max,e),Lu.needsUpdate=!0,this.shapecast({intersectsBounds:i=>Lu.intersectsBox(i),intersectsTriangle:i=>Lu.intersectsTriangle(i)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,i={},s={},n=0,o=1/0){return(this.indirect?uP:eP)(this,t,e,i,s,n,o)}closestPointToPoint(t,e={},i=0,s=1/0){return UN(this,t,e,i,s)}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach(i=>{Ie(0,new Float32Array(i),AC),t.union(AC)}),t}};function SC(r,t,e){return r===null||(r.point.applyMatrix4(t.matrixWorld),r.distance=r.point.distanceTo(e.ray.origin),r.object=t,r.distance<e.near||r.distance>e.far)?null:r}const nm=new qg,wC=new ht,mP=it.prototype.raycast;function IP(r,t){if(this.geometry.boundsTree){if(this.material===void 0)return;wC.copy(this.matrixWorld).invert(),nm.copy(r.ray).applyMatrix4(wC);const e=this.geometry.boundsTree;if(r.firstHitOnly===!0){const i=SC(e.raycastFirst(nm,this.material),this,r);i&&t.push(i)}else{const i=e.raycast(nm,this.material);for(let s=0,n=i.length;s<n;s++){const o=SC(i[s],this,r);o&&t.push(o)}}}else mP.call(this,r,t)}function gP(r){return this.boundsTree=new pP(this,r),this.boundsTree}function EP(){this.boundsTree=null}const Nv=class xI{static apply(t){xI.initialized||(Ut.prototype.computeBoundsTree=gP,Ut.prototype.disposeBoundsTree=EP,it.prototype.raycast=IP,xI.initialized=!0),t.boundsTree||t.computeBoundsTree()}static dispose(t){t&&t.disposeBoundsTree&&t.disposeBoundsTree()}};Et(Nv,"initialized",!1);let _C=Nv,So=class Pv{constructor(t,e,i){Et(this,"ids",new Set),Et(this,"itemToInstances",new Map),Et(this,"instanceToItem",new Map),Et(this,"hiddenItems",new Set),Et(this,"id"),Et(this,"mesh"),Et(this,"capacity",0),Et(this,"capacityOffset",10),Et(this,"group"),Et(this,"_originalColors",new Map),Et(this,"_settingVisibility",!1),this.mesh=new Rh(t,e,i,this),this.id=this.mesh.uuid,this.capacity=i,this.mesh.count=0,this.mesh.geometry.index.count&&_C.apply(this.mesh.geometry)}get uniqueVertices(){const t=[],e=this.mesh.geometry.getAttribute("position");if(!e)return t;const i=new Set;for(let s=0;s<e.count;s++){const n=e.getX(s),o=e.getY(s),a=e.getZ(s),c=`${n},${o},${a}`;i.has(c)||(i.add(c),t.push(new M(n,o,a)))}return t}dispose(t=!0){if(this.clear(),this.group=void 0,this._originalColors.clear(),this.mesh){if(t){for(const e of this.mesh.material)e.dispose();this.mesh.material=[],_C.dispose(this.mesh.geometry),this.mesh.geometry&&this.mesh.geometry.dispose(),this.mesh.geometry=null}this.mesh.removeFromParent(),this.mesh.userData={},this.mesh.dispose(),this.mesh.fragment=null,this.mesh=null}}get(t){const e=this.getInstancesIDs(t);if(!e)throw new Error("Item not found!");const i=[],s=[];for(const o of e){const a=new ht;if(this.mesh.getMatrixAt(o,a),i.push(a),this.mesh.instanceColor){const c=new Rt;this.mesh.getColorAt(o,c),s.push(c)}}const n=s.length?s:void 0;return{id:t,transforms:i,colors:n}}getItemID(t){return this.instanceToItem.get(t)||null}getInstancesIDs(t){return this.itemToInstances.get(t)||null}update(){this.mesh.instanceColor&&(this.mesh.instanceColor.needsUpdate=!0),this.mesh.instanceMatrix.needsUpdate=!0}add(t){var e;let i=0;for(const n of t)i+=n.transforms.length;const s=this.mesh.count+i;if(s>this.capacity){const n=s+this.capacityOffset,o=new Rh(this.mesh.geometry,this.mesh.material,n,this);o.count=this.mesh.count,this.capacity=n;const a=this.mesh;(e=a.parent)==null||e.add(o),a.removeFromParent(),this.mesh=o;const c=new ht;for(let l=0;l<a.instanceMatrix.count;l++)a.getMatrixAt(l,c),o.setMatrixAt(l,c);if(a.instanceColor){const l=new Rt;for(let h=0;h<a.instanceColor.count;h++)a.getColorAt(h,l),o.setColorAt(h,l)}a.dispose()}for(let n=0;n<t.length;n++){const{transforms:o,colors:a,id:c}=t[n];this.itemToInstances.has(c)||this.itemToInstances.set(c,new Set);const l=this.itemToInstances.get(c);this.ids.add(c);for(let h=0;h<o.length;h++){const u=o[h],d=this.mesh.count;if(this.mesh.setMatrixAt(d,u),a){const f=a[h];this.mesh.setColorAt(d,f)}l.add(d),this.instanceToItem.set(d,c),this.mesh.count++}}this.update()}remove(t){if(this.mesh.count!==0){for(const e of t){const i=this.itemToInstances.get(e);if(i===void 0)throw new Error("Instances not found!");for(const s of i){if(this.mesh.count===0)throw new Error("Error with mesh count!");this.putLast(s),this.instanceToItem.delete(s),this.mesh.count--}this.itemToInstances.delete(e),this.ids.delete(e)}this.update()}}clear(){this.hiddenItems.clear(),this.ids.clear(),this.instanceToItem.clear(),this.itemToInstances.clear(),this.mesh.count=0}setVisibility(t,e=this.ids){if(!this._settingVisibility){if(this._settingVisibility=!0,t)for(const i of e){if(!this.ids.has(i)||!this.hiddenItems.has(i))continue;const s=this.itemToInstances.get(i);if(!s)throw new Error("Instances not found!");for(const n of new Set(s))this.mesh.count++,this.putLast(n);this.hiddenItems.delete(i)}else for(const i of e){if(!this.ids.has(i)||this.hiddenItems.has(i))continue;const s=this.itemToInstances.get(i);if(!s)throw new Error("Instances not found!");for(const n of new Set(s))this.putLast(n),this.mesh.count--;this.hiddenItems.add(i)}this.update(),this._settingVisibility=!1}}setColor(t,e=this.ids,i=!1){if(!this.mesh.instanceColor)throw new Error("This fragment doesn't have color per instance!");for(const s of e){if(!this.ids.has(s))continue;const n=this.itemToInstances.get(s);if(!n)throw new Error("Instances not found!");const o=this._originalColors.has(s);o||this._originalColors.set(s,new Map);const a=this._originalColors.get(s);for(const c of new Set(n)){if(!o){const l=new Rt;this.mesh.getColorAt(c,l),a.set(c,l)}this.mesh.setColorAt(c,t),i&&a.set(c,t)}}this.mesh.instanceColor.needsUpdate=!0}resetColor(t=this.ids){if(!this.mesh.instanceColor)throw new Error("This fragment doesn't have color per instance!");for(const e of t){if(!this.ids.has(e))continue;const i=this.itemToInstances.get(e);if(!i)throw new Error("Instances not found!");const s=this._originalColors.get(e);if(s)for(const n of new Set(i)){const o=s.get(n);if(!o)throw new Error("Original color not found!");this.mesh.setColorAt(n,o)}}this.mesh.instanceColor.needsUpdate=!0}applyTransform(t,e){const i=new ht;for(const s of t){const n=this.getInstancesIDs(s);if(n!==null)for(const o of n)this.mesh.getMatrixAt(o,i),i.premultiply(e),this.mesh.setMatrixAt(o,i)}this.update()}exportData(){const t=this.mesh.exportData(),e=Array.from(this.ids),i=this.id;return{...t,ids:e,id:i}}clone(t=this.ids){const e=new Pv(this.mesh.geometry,this.mesh.material,this.capacity),i=[];for(const s of t){const n=this.getInstancesIDs(s);if(n===null)continue;const o=[],a=[];for(const c of n){const l=new ht,h=new Rt;this.mesh.getMatrixAt(c,l),this.mesh.getColorAt(c,h),o.push(l),a.push(h)}i.push({id:s,transforms:o,colors:a})}return e.add(i),e}putLast(t){if(this.mesh.count===0)return;const e=this.instanceToItem.get(t),i=this.mesh.count-1;if(i===t)return;const s=this.instanceToItem.get(i);if(e===void 0||s===void 0)throw new Error("Keys not found");if(e!==s){const a=this.itemToInstances.get(e),c=this.itemToInstances.get(s);if(!a||!c)throw new Error("Instances not found");if(!a.has(t)||!c.has(i))throw new Error("Malformed fragment structure");a.delete(t),c.delete(i),a.add(i),c.add(t),this.instanceToItem.set(t,s),this.instanceToItem.set(i,e)}const n=new ht,o=new ht;if(this.mesh.getMatrixAt(t,n),this.mesh.getMatrixAt(i,o),this.mesh.setMatrixAt(t,o),this.mesh.setMatrixAt(i,n),this.mesh.instanceColor!==null){const a=new Rt,c=new Rt;this.mesh.getColorAt(t,a),this.mesh.getColorAt(i,c),this.mesh.setColorAt(t,c),this.mesh.setColorAt(i,a);const l=this._originalColors.get(e);if(l){const u=l.get(t);u&&(l.delete(t),l.set(i,u))}const h=this._originalColors.get(s);if(h){const u=h.get(i);u&&(h.delete(i),h.set(t,u))}}}};const rm=2,qs=4,yn=4,Pi=4,sr=new Int32Array(2),FC=new Float32Array(sr.buffer),OC=new Float64Array(sr.buffer),Mu=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var NI;(function(r){r[r.UTF8_BYTES=1]="UTF8_BYTES",r[r.UTF16_STRING=2]="UTF16_STRING"})(NI||(NI={}));class wo{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new wo(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return sr[0]=this.readInt32(t),FC[0]}readFloat64(t){return sr[Mu?0:1]=this.readInt32(t),sr[Mu?1:0]=this.readInt32(t+4),OC[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,Number(BigInt.asIntN(32,e))),this.writeInt32(t+4,Number(BigInt.asIntN(32,e>>BigInt(32))))}writeUint64(t,e){this.writeUint32(t,Number(BigInt.asUintN(32,e))),this.writeUint32(t+4,Number(BigInt.asUintN(32,e>>BigInt(32))))}writeFloat32(t,e){FC[0]=e,this.writeInt32(t,sr[0])}writeFloat64(t,e){OC[0]=e,this.writeInt32(t,sr[Mu?0:1]),this.writeInt32(t+4,sr[Mu?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+qs+yn)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<yn;e++)t+=String.fromCharCode(this.readInt8(this.position_+qs+e));return t}__offset(t,e){const i=t-this.readInt32(t);return e<this.readInt16(i)?this.readInt16(i+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const i=this.readInt32(t);t+=qs;const s=this.bytes_.subarray(t,t+i);return e===NI.UTF8_BYTES?s:this.text_decoder_.decode(s)}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+qs}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=yn)throw new Error("FlatBuffers: file identifier must be length "+yn);for(let e=0;e<yn;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+qs+e))return!1;return!0}createScalarList(t,e){const i=[];for(let s=0;s<e;++s){const n=t(s);n!==null&&i.push(n)}return i}createObjList(t,e){const i=[];for(let s=0;s<e;++s){const n=t(s);n!==null&&i.push(n.unpack())}return i}}let vE=class Lv{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let e;t?e=t:e=1024,this.bb=wo.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const i=~(this.bb.capacity()-this.space+e)+1&t-1;for(;this.space<i+t+e;){const s=this.bb.capacity();this.bb=Lv.growByteBuffer(this.bb),this.space+=this.bb.capacity()-s}this.pad(i)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,i){(this.force_defaults||e!=i)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,i){(this.force_defaults||e!=i)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,i){(this.force_defaults||e!=i)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,i){(this.force_defaults||e!==i)&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,i){(this.force_defaults||e!=i)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,i){(this.force_defaults||e!=i)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,i){(this.force_defaults||e!=i)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,i){e!=i&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const i=e<<1,s=wo.allocate(i);return s.setPosition(i-e),s.bytes().set(t.bytes(),i-e),s}addOffset(t){this.prep(qs,0),this.writeInt32(this.offset()-t+qs)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&this.vtable[e]==0;e--);const i=e+1;for(;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);const s=2;this.addInt16(t-this.object_start);const n=(i+s)*rm;this.addInt16(n);let o=0;const a=this.space;t:for(e=0;e<this.vtables.length;e++){const c=this.bb.capacity()-this.vtables[e];if(n==this.bb.readInt16(c)){for(let l=rm;l<n;l+=rm)if(this.bb.readInt16(a+l)!=this.bb.readInt16(c+l))continue t;o=this.vtables[e];break}}return o?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,o-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,i){const s=i?Pi:0;if(e){const n=e;if(this.prep(this.minalign,qs+yn+s),n.length!=yn)throw new Error("FlatBuffers: file identifier must be length "+yn);for(let o=yn-1;o>=0;o--)this.writeInt8(n.charCodeAt(o))}this.prep(this.minalign,qs+s),this.addOffset(t),s&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const i=this.bb.capacity()-t,s=i-this.bb.readInt32(i);if(!(e<this.bb.readInt16(s)&&this.bb.readInt16(s+e)!=0))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,i){this.notNested(),this.vector_num_elems=e,this.prep(qs,t*e),this.prep(i,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(t==null)return 0;let e;t instanceof Uint8Array?e=t:e=this.text_encoder.encode(t),this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let i=0,s=this.space,n=this.bb.bytes();i<e.length;i++)n[s++]=e[i];return this.endVector()}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let i=0;i<t.length;++i){const s=t[i];if(s!==null)e.push(this.createObjectOffset(s));else throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t.slice().reverse()),this.endVector()}},qd=class so{constructor(){Et(this,"bb",null),Et(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCivilCurve(t,e){return(e||new so).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCivilCurve(t,e){return t.setPosition(t.position()+Pi),(e||new so).__init(t.readInt32(t.position())+t.position(),t)}points(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}pointsLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}pointsArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}data(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startCivilCurve(t){t.startObject(2)}static addPoints(t,e){t.addFieldOffset(0,e,0)}static createPointsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startPointsVector(t,e){t.startVector(4,e,4)}static addData(t,e){t.addFieldOffset(1,e,0)}static endCivilCurve(t){return t.endObject()}static createCivilCurve(t,e,i){return so.startCivilCurve(t),so.addPoints(t,e),so.addData(t,i),so.endCivilCurve(t)}},Mv=class fn{constructor(){Et(this,"bb",null),Et(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsAlignment(t,e){return(e||new fn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsAlignment(t,e){return t.setPosition(t.position()+Pi),(e||new fn).__init(t.readInt32(t.position())+t.position(),t)}vertical(t,e){const i=this.bb.__offset(this.bb_pos,4);return i?(e||new qd).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}verticalLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}horizontal(t,e){const i=this.bb.__offset(this.bb_pos,6);return i?(e||new qd).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}horizontalLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}absolute(t,e){const i=this.bb.__offset(this.bb_pos,8);return i?(e||new qd).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}absoluteLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}initialPk(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readFloat32(this.bb_pos+t):0}static startAlignment(t){t.startObject(4)}static addVertical(t,e){t.addFieldOffset(0,e,0)}static createVerticalVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startVerticalVector(t,e){t.startVector(4,e,4)}static addHorizontal(t,e){t.addFieldOffset(1,e,0)}static createHorizontalVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startHorizontalVector(t,e){t.startVector(4,e,4)}static addAbsolute(t,e){t.addFieldOffset(2,e,0)}static createAbsoluteVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startAbsoluteVector(t,e){t.startVector(4,e,4)}static addInitialPk(t,e){t.addFieldFloat32(3,e,0)}static endAlignment(t){return t.endObject()}static createAlignment(t,e,i,s,n){return fn.startAlignment(t),fn.addVertical(t,e),fn.addHorizontal(t,i),fn.addAbsolute(t,s),fn.addInitialPk(t,n),fn.endAlignment(t)}},Dv=class no{constructor(){Et(this,"bb",null),Et(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCivilData(t,e){return(e||new no).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCivilData(t,e){return t.setPosition(t.position()+Pi),(e||new no).__init(t.readInt32(t.position())+t.position(),t)}alignments(t,e){const i=this.bb.__offset(this.bb_pos,4);return i?(e||new Mv).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}alignmentsLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}coordinationMatrix(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}coordinationMatrixLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}coordinationMatrixArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startCivilData(t){t.startObject(2)}static addAlignments(t,e){t.addFieldOffset(0,e,0)}static createAlignmentsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startAlignmentsVector(t,e){t.startVector(4,e,4)}static addCoordinationMatrix(t,e){t.addFieldOffset(1,e,0)}static createCoordinationMatrixVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startCoordinationMatrixVector(t,e){t.startVector(4,e,4)}static endCivilData(t){return t.endObject()}static createCivilData(t,e,i){return no.startCivilData(t),no.addAlignments(t,e),no.addCoordinationMatrix(t,i),no.endCivilData(t)}},PI=class Xe{constructor(){Et(this,"bb",null),Et(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFragment(t,e){return(e||new Xe).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFragment(t,e){return t.setPosition(t.position()+Pi),(e||new Xe).__init(t.readInt32(t.position())+t.position(),t)}position(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}positionLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}positionArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}normal(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}normalLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}normalArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}index(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}indexLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}indexArray(){const t=this.bb.__offset(this.bb_pos,8);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}groups(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}groupsLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}groupsArray(){const t=this.bb.__offset(this.bb_pos,10);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}materials(t){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}materialsLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}materialsArray(){const t=this.bb.__offset(this.bb_pos,12);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}matrices(t){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}matricesLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}matricesArray(){const t=this.bb.__offset(this.bb_pos,14);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}colors(t){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}colorsLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}colorsArray(){const t=this.bb.__offset(this.bb_pos,16);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}itemsSize(t){const e=this.bb.__offset(this.bb_pos,18);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}itemsSizeLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}itemsSizeArray(){const t=this.bb.__offset(this.bb_pos,18);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}ids(t){const e=this.bb.__offset(this.bb_pos,20);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}idsLength(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.__vector_len(this.bb_pos+t):0}idsArray(){const t=this.bb.__offset(this.bb_pos,20);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}id(t){const e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__string(this.bb_pos+e,t):null}capacity(){const t=this.bb.__offset(this.bb_pos,24);return t?this.bb.readUint32(this.bb_pos+t):0}capacityOffset(){const t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readUint32(this.bb_pos+t):0}static startFragment(t){t.startObject(12)}static addPosition(t,e){t.addFieldOffset(0,e,0)}static createPositionVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startPositionVector(t,e){t.startVector(4,e,4)}static addNormal(t,e){t.addFieldOffset(1,e,0)}static createNormalVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startNormalVector(t,e){t.startVector(4,e,4)}static addIndex(t,e){t.addFieldOffset(2,e,0)}static createIndexVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startIndexVector(t,e){t.startVector(4,e,4)}static addGroups(t,e){t.addFieldOffset(3,e,0)}static createGroupsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startGroupsVector(t,e){t.startVector(4,e,4)}static addMaterials(t,e){t.addFieldOffset(4,e,0)}static createMaterialsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startMaterialsVector(t,e){t.startVector(4,e,4)}static addMatrices(t,e){t.addFieldOffset(5,e,0)}static createMatricesVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startMatricesVector(t,e){t.startVector(4,e,4)}static addColors(t,e){t.addFieldOffset(6,e,0)}static createColorsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startColorsVector(t,e){t.startVector(4,e,4)}static addItemsSize(t,e){t.addFieldOffset(7,e,0)}static createItemsSizeVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startItemsSizeVector(t,e){t.startVector(4,e,4)}static addIds(t,e){t.addFieldOffset(8,e,0)}static createIdsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startIdsVector(t,e){t.startVector(4,e,4)}static addId(t,e){t.addFieldOffset(9,e,0)}static addCapacity(t,e){t.addFieldInt32(10,e,0)}static addCapacityOffset(t,e){t.addFieldInt32(11,e,0)}static endFragment(t){return t.endObject()}static createFragment(t,e,i,s,n,o,a,c,l,h,u,d,f){return Xe.startFragment(t),Xe.addPosition(t,e),Xe.addNormal(t,i),Xe.addIndex(t,s),Xe.addGroups(t,n),Xe.addMaterials(t,o),Xe.addMatrices(t,a),Xe.addColors(t,c),Xe.addItemsSize(t,l),Xe.addIds(t,h),Xe.addId(t,u),Xe.addCapacity(t,d),Xe.addCapacityOffset(t,f),Xe.endFragment(t)}},om=class LI{constructor(){Et(this,"bb",null),Et(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFragmentsGroup(t,e){return(e||new LI).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFragmentsGroup(t,e){return t.setPosition(t.position()+Pi),(e||new LI).__init(t.readInt32(t.position())+t.position(),t)}items(t,e){const i=this.bb.__offset(this.bb_pos,4);return i?(e||new PI).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}itemsLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}civil(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new Dv).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}coordinationMatrix(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}coordinationMatrixLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}coordinationMatrixArray(){const t=this.bb.__offset(this.bb_pos,8);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}ids(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}idsLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}idsArray(){const t=this.bb.__offset(this.bb_pos,10);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}itemsKeys(t){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}itemsKeysLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}itemsKeysArray(){const t=this.bb.__offset(this.bb_pos,12);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}itemsKeysIndices(t){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}itemsKeysIndicesLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}itemsKeysIndicesArray(){const t=this.bb.__offset(this.bb_pos,14);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}itemsRels(t){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}itemsRelsLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}itemsRelsArray(){const t=this.bb.__offset(this.bb_pos,16);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}itemsRelsIndices(t){const e=this.bb.__offset(this.bb_pos,18);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}itemsRelsIndicesLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}itemsRelsIndicesArray(){const t=this.bb.__offset(this.bb_pos,18);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}fragmentKeys(t){const e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__string(this.bb_pos+e,t):null}id(t){const e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__string(this.bb_pos+e,t):null}name(t){const e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__string(this.bb_pos+e,t):null}ifcName(t){const e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__string(this.bb_pos+e,t):null}ifcDescription(t){const e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__string(this.bb_pos+e,t):null}ifcSchema(t){const e=this.bb.__offset(this.bb_pos,30);return e?this.bb.__string(this.bb_pos+e,t):null}maxExpressId(){const t=this.bb.__offset(this.bb_pos,32);return t?this.bb.readUint32(this.bb_pos+t):0}boundingBox(t){const e=this.bb.__offset(this.bb_pos,34);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}boundingBoxLength(){const t=this.bb.__offset(this.bb_pos,34);return t?this.bb.__vector_len(this.bb_pos+t):0}boundingBoxArray(){const t=this.bb.__offset(this.bb_pos,34);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}opaqueGeometriesIds(t){const e=this.bb.__offset(this.bb_pos,36);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+t*4):0}opaqueGeometriesIdsLength(){const t=this.bb.__offset(this.bb_pos,36);return t?this.bb.__vector_len(this.bb_pos+t):0}opaqueGeometriesIdsArray(){const t=this.bb.__offset(this.bb_pos,36);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}transparentGeometriesIds(t){const e=this.bb.__offset(this.bb_pos,38);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+t*4):0}transparentGeometriesIdsLength(){const t=this.bb.__offset(this.bb_pos,38);return t?this.bb.__vector_len(this.bb_pos+t):0}transparentGeometriesIdsArray(){const t=this.bb.__offset(this.bb_pos,38);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startFragmentsGroup(t){t.startObject(18)}static addItems(t,e){t.addFieldOffset(0,e,0)}static createItemsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startItemsVector(t,e){t.startVector(4,e,4)}static addCivil(t,e){t.addFieldOffset(1,e,0)}static addCoordinationMatrix(t,e){t.addFieldOffset(2,e,0)}static createCoordinationMatrixVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startCoordinationMatrixVector(t,e){t.startVector(4,e,4)}static addIds(t,e){t.addFieldOffset(3,e,0)}static createIdsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startIdsVector(t,e){t.startVector(4,e,4)}static addItemsKeys(t,e){t.addFieldOffset(4,e,0)}static createItemsKeysVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startItemsKeysVector(t,e){t.startVector(4,e,4)}static addItemsKeysIndices(t,e){t.addFieldOffset(5,e,0)}static createItemsKeysIndicesVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startItemsKeysIndicesVector(t,e){t.startVector(4,e,4)}static addItemsRels(t,e){t.addFieldOffset(6,e,0)}static createItemsRelsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startItemsRelsVector(t,e){t.startVector(4,e,4)}static addItemsRelsIndices(t,e){t.addFieldOffset(7,e,0)}static createItemsRelsIndicesVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startItemsRelsIndicesVector(t,e){t.startVector(4,e,4)}static addFragmentKeys(t,e){t.addFieldOffset(8,e,0)}static addId(t,e){t.addFieldOffset(9,e,0)}static addName(t,e){t.addFieldOffset(10,e,0)}static addIfcName(t,e){t.addFieldOffset(11,e,0)}static addIfcDescription(t,e){t.addFieldOffset(12,e,0)}static addIfcSchema(t,e){t.addFieldOffset(13,e,0)}static addMaxExpressId(t,e){t.addFieldInt32(14,e,0)}static addBoundingBox(t,e){t.addFieldOffset(15,e,0)}static createBoundingBoxVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startBoundingBoxVector(t,e){t.startVector(4,e,4)}static addOpaqueGeometriesIds(t,e){t.addFieldOffset(16,e,0)}static createOpaqueGeometriesIdsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startOpaqueGeometriesIdsVector(t,e){t.startVector(4,e,4)}static addTransparentGeometriesIds(t,e){t.addFieldOffset(17,e,0)}static createTransparentGeometriesIdsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startTransparentGeometriesIdsVector(t,e){t.startVector(4,e,4)}static endFragmentsGroup(t){return t.endObject()}static finishFragmentsGroupBuffer(t,e){t.finish(e)}static finishSizePrefixedFragmentsGroupBuffer(t,e){t.finish(e,void 0,!0)}};class CP{constructor(){Et(this,"version",1),Et(this,"fragmentIDSeparator","|")}import(t){const e=new wo(t),i=om.getRootAsFragmentsGroup(e),s=this.constructFragmentGroup(i),n=i.itemsLength();for(let o=0;o<n;o++){const a=i.items(o);if(!a)continue;const c=this.constructGeometry(a),l=this.constructMaterials(a),h=a.capacity(),u=new So(c,l,h);u.capacityOffset=a.capacityOffset(),this.setInstances(a,u),this.setID(a,u),s.items.push(u),s.add(u.mesh)}return s}export(t){const e=new vE(1024),i=[],s=om,n=PI;let o=null;if(t.civilData){const Y=[],z=Mv,st=Dv;for(const[gt,Ct]of t.civilData.alignments){const{absolute:lt,horizontal:pt,vertical:mt}=Ct,yt=this.saveCivilCurves(pt,e),zt=this.saveCivilCurves(mt,e),Lt=this.saveCivilCurves(lt,e),v=z.createHorizontalVector(e,yt),j=z.createVerticalVector(e,zt),W=z.createAbsoluteVector(e,Lt);z.startAlignment(e),z.addHorizontal(e,v),z.addVertical(e,j),z.addAbsolute(e,W),z.addInitialPk(e,Ct.initialKP);const N=z.endAlignment(e);Y.push(N)}const K=st.createAlignmentsVector(e,Y),Q=st.createCoordinationMatrixVector(e,t.coordinationMatrix.elements);st.startCivilData(e),st.addAlignments(e,K),st.addCoordinationMatrix(e,Q),o=st.endCivilData(e)}for(const Y of t.items){const z=Y.exportData(),st=[];for(const j of Y.ids){const W=Y.getInstancesIDs(j);if(!W)throw new Error("Instances not found!");st.push(W.size)}const K=n.createPositionVector(e,z.position),Q=n.createNormalVector(e,z.normal),gt=n.createIndexVector(e,z.index),Ct=n.createGroupsVector(e,z.groups),lt=n.createMaterialsVector(e,z.materials),pt=n.createMatricesVector(e,z.matrices),mt=n.createColorsVector(e,z.colors),yt=n.createIdsVector(e,z.ids),zt=n.createItemsSizeVector(e,st),Lt=e.createString(z.id);n.startFragment(e),n.addPosition(e,K),n.addNormal(e,Q),n.addIndex(e,gt),n.addGroups(e,Ct),n.addMaterials(e,lt),n.addMatrices(e,pt),n.addColors(e,mt),n.addIds(e,yt),n.addItemsSize(e,zt),n.addId(e,Lt),n.addCapacity(e,Y.capacity),n.addCapacityOffset(e,Y.capacityOffset);const v=PI.endFragment(e);i.push(v)}const a=s.createItemsVector(e,i),c=s.createCoordinationMatrixVector(e,t.coordinationMatrix.elements);let l="";for(const Y of t.keyFragments.values())l.length&&(l+=this.fragmentIDSeparator),l+=Y;const h=e.createString(l),u=[],d=[],f=[],p=[],m=[];let g=0,I=0;for(const[Y,[z,st]]of t.data){u.push(g),f.push(I),m.push(Y);for(const K of z)d.push(K);for(const K of st)p.push(K);g+=z.length,I+=st.length}const C=[],b=[];for(const[Y,z]of t.geometryIDs.opaque)C.push(Y,z);for(const[Y,z]of t.geometryIDs.transparent)b.push(Y,z);const E=e.createString(t.uuid),T=e.createString(t.name),A=e.createString(t.ifcMetadata.name),S=e.createString(t.ifcMetadata.description),_=e.createString(t.ifcMetadata.schema),w=s.createItemsKeysIndicesVector(e,u),F=s.createItemsKeysVector(e,d),D=s.createItemsRelsIndicesVector(e,f),R=s.createItemsRelsVector(e,p),O=s.createIdsVector(e,m),y=s.createOpaqueGeometriesIdsVector(e,C),U=s.createTransparentGeometriesIdsVector(e,b),{min:H,max:k}=t.boundingBox,X=[H.x,H.y,H.z,k.x,k.y,k.z],$=s.createBoundingBoxVector(e,X);s.startFragmentsGroup(e),s.addId(e,E),s.addName(e,T),s.addIfcName(e,A),s.addIfcDescription(e,S),s.addIfcSchema(e,_),s.addMaxExpressId(e,t.ifcMetadata.maxExpressID),s.addItems(e,a),s.addFragmentKeys(e,h),s.addIds(e,O),s.addItemsKeysIndices(e,w),s.addItemsKeys(e,F),s.addItemsRelsIndices(e,D),s.addItemsRels(e,R),s.addCoordinationMatrix(e,c),s.addBoundingBox(e,$),s.addOpaqueGeometriesIds(e,y),s.addTransparentGeometriesIds(e,U),o!==null&&s.addCivil(e,o);const et=om.endFragmentsGroup(e);return e.finish(et),e.asUint8Array()}setID(t,e){const i=t.id();i&&(e.id=i,e.mesh.uuid=i)}setInstances(t,e){const i=t.matricesArray(),s=t.colorsArray(),n=t.idsArray(),o=t.itemsSizeArray();if(!i||!n||!o)throw new Error("Error: Can't load empty fragment!");const a=[];let c=0;for(let l=0;l<o.length;l++){const h=n[l],u=o[l],d=[],f=[];for(let m=0;m<u;m++){const g=c*16,I=i.subarray(g,g+17),C=new ht().fromArray(I);if(d.push(C),s){const b=c*3,[E,T,A]=s.subarray(b,b+4),S=new Rt(E,T,A);f.push(S)}c++}const p=f.length?f:void 0;a.push({id:h,transforms:d,colors:p})}e.add(a)}constructMaterials(t){const e=t.materialsArray(),i=[];if(!e)return i;for(let s=0;s<e.length;s+=5){const n=e[s],o=!!e[s+1],a=e[s+2],c=e[s+3],l=e[s+4],h=new Rt(a,c,l),u=new Er({color:h,opacity:n,transparent:o});i.push(u)}return i}constructFragmentGroup(t){const e=new si,i=t.civil();if(i){const _=i.coordinationMatrixArray(),w=new ht;_&&w.fromArray(_),e.civilData={alignments:new Map,coordinationMatrix:w};const F=i.alignmentsLength();for(let D=0;D<F;D++){const R=new xi({color:16777215}),O=new lp,y=i.alignments(D);if(!y)throw new Error("Alignment not found!");const U=y.horizontalLength();O.horizontal=this.constructCivilCurves(y,O,"horizontal",U,R);const H=y.verticalLength();O.vertical=this.constructCivilCurves(y,O,"vertical",H,R);const k=y.horizontalLength();O.absolute=this.constructCivilCurves(y,O,"absolute",k,R),O.initialKP=y.initialPk(),e.civilData.alignments.set(D,O)}}e.uuid=t.id()||e.uuid,e.name=t.name()||"",e.ifcMetadata={name:t.ifcName()||"",description:t.ifcDescription()||"",schema:t.ifcSchema()||"IFC2X3",maxExpressID:t.maxExpressId()||0};const s=new ht().elements,n=t.coordinationMatrixArray()||s,o=t.idsArray()||new Uint32Array,a=t.itemsKeysIndicesArray()||new Uint32Array,c=t.itemsKeysArray()||new Uint32Array,l=t.itemsRelsArray()||new Uint32Array,h=t.itemsRelsIndicesArray()||new Uint32Array,d=(t.fragmentKeys()||"").split(this.fragmentIDSeparator);this.setGroupData(e,o,a,c,0),this.setGroupData(e,o,h,l,1);const f=t.opaqueGeometriesIdsArray()||new Uint32Array,p=t.transparentGeometriesIdsArray()||new Uint32Array,m=new Map;for(let _=0;_<f.length-1;_+=2){const w=f[_],F=f[_+1];m.set(w,F)}const g=new Map;for(let _=0;_<p.length-1;_+=2){const w=p[_],F=p[_+1];g.set(w,F)}e.geometryIDs={opaque:m,transparent:g};const I=t.boundingBoxArray()||[0,0,0,0,0,0],[C,b,E,T,A,S]=I;e.boundingBox.min.set(C,b,E),e.boundingBox.max.set(T,A,S);for(let _=0;_<d.length;_++)e.keyFragments.set(_,d[_]);return n.length===16&&e.coordinationMatrix.fromArray(n),e}setGroupData(t,e,i,s,n){for(let o=0;o<i.length;o++){const a=e[o],c=i[o],l=i[o+1]||s.length,h=[];for(let d=c;d<l;d++)h.push(s[d]);t.data.has(a)||t.data.set(a,[[],[]]);const u=t.data.get(a);u&&(u[n]=h)}}constructGeometry(t){const e=t.positionArray()||new Float32Array,i=t.normalArray()||new Float32Array,s=t.indexArray(),n=t.groupsArray();if(!s)throw new Error("Index not found!");const o=new Ut;if(o.setIndex(Array.from(s)),o.setAttribute("position",new Kt(e,3)),o.setAttribute("normal",new Kt(i,3)),n)for(let a=0;a<n.length;a+=3){const c=n[a],l=n[a+1],h=n[a+2];o.addGroup(c,l,h)}return o}constructCivilCurves(t,e,i,s,n){const o=[];for(let a=0;a<s;a++){const c=t[i](a);if(!c)throw new Error("Curve not found!");const l=c.pointsArray();if(l===null)throw new Error("Curve points not found!");let h={};const u=c.data();u&&(h=JSON.parse(u));const d=new $f,f=new Kt(l,3);d.setAttribute("position",f);const p=[];for(let g=0;g<l.length/3-1;g++)p.push(g,g+1);d.setIndex(p);const m=new hp(a,h,e,d,n);o.push(m.curve)}return o}saveCivilCurves(t,e){const i=qd,s=[];for(const n of t){const a=n.mesh.geometry.attributes.position.array,c=i.createPointsVector(e,a),l=e.createString(JSON.stringify(n.data));i.startCivilCurve(e),i.addPoints(e,c),i.addData(e,l);const h=i.endCivilCurve(e);s.push(h)}return s}}let Qd=class ro{constructor(){Et(this,"bb",null),Et(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCivilCurve(t,e){return(e||new ro).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCivilCurve(t,e){return t.setPosition(t.position()+Pi),(e||new ro).__init(t.readInt32(t.position())+t.position(),t)}points(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}pointsLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}pointsArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}data(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startCivilCurve(t){t.startObject(2)}static addPoints(t,e){t.addFieldOffset(0,e,0)}static createPointsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startPointsVector(t,e){t.startVector(4,e,4)}static addData(t,e){t.addFieldOffset(1,e,0)}static endCivilCurve(t){return t.endObject()}static createCivilCurve(t,e,i){return ro.startCivilCurve(t),ro.addPoints(t,e),ro.addData(t,i),ro.endCivilCurve(t)}},Uv=class pn{constructor(){Et(this,"bb",null),Et(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsAlignment(t,e){return(e||new pn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsAlignment(t,e){return t.setPosition(t.position()+Pi),(e||new pn).__init(t.readInt32(t.position())+t.position(),t)}vertical(t,e){const i=this.bb.__offset(this.bb_pos,4);return i?(e||new Qd).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}verticalLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}horizontal(t,e){const i=this.bb.__offset(this.bb_pos,6);return i?(e||new Qd).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}horizontalLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}absolute(t,e){const i=this.bb.__offset(this.bb_pos,8);return i?(e||new Qd).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}absoluteLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}initialPk(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readFloat32(this.bb_pos+t):0}static startAlignment(t){t.startObject(4)}static addVertical(t,e){t.addFieldOffset(0,e,0)}static createVerticalVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startVerticalVector(t,e){t.startVector(4,e,4)}static addHorizontal(t,e){t.addFieldOffset(1,e,0)}static createHorizontalVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startHorizontalVector(t,e){t.startVector(4,e,4)}static addAbsolute(t,e){t.addFieldOffset(2,e,0)}static createAbsoluteVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startAbsoluteVector(t,e){t.startVector(4,e,4)}static addInitialPk(t,e){t.addFieldFloat32(3,e,0)}static endAlignment(t){return t.endObject()}static createAlignment(t,e,i,s,n){return pn.startAlignment(t),pn.addVertical(t,e),pn.addHorizontal(t,i),pn.addAbsolute(t,s),pn.addInitialPk(t,n),pn.endAlignment(t)}};class Tn{constructor(){Et(this,"bb",null),Et(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCivilData(t,e){return(e||new Tn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCivilData(t,e){return t.setPosition(t.position()+Pi),(e||new Tn).__init(t.readInt32(t.position())+t.position(),t)}alignments(t,e){const i=this.bb.__offset(this.bb_pos,4);return i?(e||new Uv).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}alignmentsLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}coordinationMatrix(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}coordinationMatrixLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}coordinationMatrixArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startCivilData(t){t.startObject(2)}static addAlignments(t,e){t.addFieldOffset(0,e,0)}static createAlignmentsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startAlignmentsVector(t,e){t.startVector(4,e,4)}static addCoordinationMatrix(t,e){t.addFieldOffset(1,e,0)}static createCoordinationMatrixVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startCoordinationMatrixVector(t,e){t.startVector(4,e,4)}static endCivilData(t){return t.endObject()}static createCivilData(t,e,i){return Tn.startCivilData(t),Tn.addAlignments(t,e),Tn.addCoordinationMatrix(t,i),Tn.endCivilData(t)}}class we{constructor(){Et(this,"bb",null),Et(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFragment(t,e){return(e||new we).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFragment(t,e){return t.setPosition(t.position()+Pi),(e||new we).__init(t.readInt32(t.position())+t.position(),t)}position(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}positionLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}positionArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}normal(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}normalLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}normalArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}index(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}indexLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}indexArray(){const t=this.bb.__offset(this.bb_pos,8);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}groups(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}groupsLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}groupsArray(){const t=this.bb.__offset(this.bb_pos,10);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}materials(t){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}materialsLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}materialsArray(){const t=this.bb.__offset(this.bb_pos,12);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}matrices(t){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}matricesLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}matricesArray(){const t=this.bb.__offset(this.bb_pos,14);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}colors(t){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}colorsLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}colorsArray(){const t=this.bb.__offset(this.bb_pos,16);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}itemsSize(t){const e=this.bb.__offset(this.bb_pos,18);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}itemsSizeLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}itemsSizeArray(){const t=this.bb.__offset(this.bb_pos,18);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}ids(t){const e=this.bb.__offset(this.bb_pos,20);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}idsLength(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.__vector_len(this.bb_pos+t):0}idsArray(){const t=this.bb.__offset(this.bb_pos,20);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}id(t){const e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__string(this.bb_pos+e,t):null}capacity(){const t=this.bb.__offset(this.bb_pos,24);return t?this.bb.readUint32(this.bb_pos+t):0}capacityOffset(){const t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readUint32(this.bb_pos+t):0}static startFragment(t){t.startObject(12)}static addPosition(t,e){t.addFieldOffset(0,e,0)}static createPositionVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startPositionVector(t,e){t.startVector(4,e,4)}static addNormal(t,e){t.addFieldOffset(1,e,0)}static createNormalVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startNormalVector(t,e){t.startVector(4,e,4)}static addIndex(t,e){t.addFieldOffset(2,e,0)}static createIndexVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startIndexVector(t,e){t.startVector(4,e,4)}static addGroups(t,e){t.addFieldOffset(3,e,0)}static createGroupsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startGroupsVector(t,e){t.startVector(4,e,4)}static addMaterials(t,e){t.addFieldOffset(4,e,0)}static createMaterialsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startMaterialsVector(t,e){t.startVector(4,e,4)}static addMatrices(t,e){t.addFieldOffset(5,e,0)}static createMatricesVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startMatricesVector(t,e){t.startVector(4,e,4)}static addColors(t,e){t.addFieldOffset(6,e,0)}static createColorsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startColorsVector(t,e){t.startVector(4,e,4)}static addItemsSize(t,e){t.addFieldOffset(7,e,0)}static createItemsSizeVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startItemsSizeVector(t,e){t.startVector(4,e,4)}static addIds(t,e){t.addFieldOffset(8,e,0)}static createIdsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startIdsVector(t,e){t.startVector(4,e,4)}static addId(t,e){t.addFieldOffset(9,e,0)}static addCapacity(t,e){t.addFieldInt32(10,e,0)}static addCapacityOffset(t,e){t.addFieldInt32(11,e,0)}static endFragment(t){return t.endObject()}static createFragment(t,e,i,s,n,o,a,c,l,h,u,d,f){return we.startFragment(t),we.addPosition(t,e),we.addNormal(t,i),we.addIndex(t,s),we.addGroups(t,n),we.addMaterials(t,o),we.addMatrices(t,a),we.addColors(t,c),we.addItemsSize(t,l),we.addIds(t,h),we.addId(t,u),we.addCapacity(t,d),we.addCapacityOffset(t,f),we.endFragment(t)}}let am=class MI{constructor(){Et(this,"bb",null),Et(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFragmentsGroup(t,e){return(e||new MI).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFragmentsGroup(t,e){return t.setPosition(t.position()+Pi),(e||new MI).__init(t.readInt32(t.position())+t.position(),t)}items(t,e){const i=this.bb.__offset(this.bb_pos,4);return i?(e||new we).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}itemsLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}civil(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new Tn).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}coordinationMatrix(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}coordinationMatrixLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}coordinationMatrixArray(){const t=this.bb.__offset(this.bb_pos,8);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}ids(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}idsLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}idsArray(){const t=this.bb.__offset(this.bb_pos,10);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}itemsKeys(t){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}itemsKeysLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}itemsKeysArray(){const t=this.bb.__offset(this.bb_pos,12);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}itemsKeysIndices(t){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}itemsKeysIndicesLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}itemsKeysIndicesArray(){const t=this.bb.__offset(this.bb_pos,14);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}itemsRels(t){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}itemsRelsLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}itemsRelsArray(){const t=this.bb.__offset(this.bb_pos,16);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}itemsRelsIndices(t){const e=this.bb.__offset(this.bb_pos,18);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}itemsRelsIndicesLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}itemsRelsIndicesArray(){const t=this.bb.__offset(this.bb_pos,18);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}fragmentKeys(t){const e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__string(this.bb_pos+e,t):null}globalIds(t){const e=this.bb.__offset(this.bb_pos,22);return e?this.bb.__string(this.bb_pos+e,t):null}id(t){const e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__string(this.bb_pos+e,t):null}name(t){const e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__string(this.bb_pos+e,t):null}ifcName(t){const e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__string(this.bb_pos+e,t):null}ifcDescription(t){const e=this.bb.__offset(this.bb_pos,30);return e?this.bb.__string(this.bb_pos+e,t):null}ifcSchema(t){const e=this.bb.__offset(this.bb_pos,32);return e?this.bb.__string(this.bb_pos+e,t):null}maxExpressId(){const t=this.bb.__offset(this.bb_pos,34);return t?this.bb.readUint32(this.bb_pos+t):0}boundingBox(t){const e=this.bb.__offset(this.bb_pos,36);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}boundingBoxLength(){const t=this.bb.__offset(this.bb_pos,36);return t?this.bb.__vector_len(this.bb_pos+t):0}boundingBoxArray(){const t=this.bb.__offset(this.bb_pos,36);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}opaqueGeometriesIds(t){const e=this.bb.__offset(this.bb_pos,38);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+t*4):0}opaqueGeometriesIdsLength(){const t=this.bb.__offset(this.bb_pos,38);return t?this.bb.__vector_len(this.bb_pos+t):0}opaqueGeometriesIdsArray(){const t=this.bb.__offset(this.bb_pos,38);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}transparentGeometriesIds(t){const e=this.bb.__offset(this.bb_pos,40);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+t*4):0}transparentGeometriesIdsLength(){const t=this.bb.__offset(this.bb_pos,40);return t?this.bb.__vector_len(this.bb_pos+t):0}transparentGeometriesIdsArray(){const t=this.bb.__offset(this.bb_pos,40);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startFragmentsGroup(t){t.startObject(19)}static addItems(t,e){t.addFieldOffset(0,e,0)}static createItemsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startItemsVector(t,e){t.startVector(4,e,4)}static addCivil(t,e){t.addFieldOffset(1,e,0)}static addCoordinationMatrix(t,e){t.addFieldOffset(2,e,0)}static createCoordinationMatrixVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startCoordinationMatrixVector(t,e){t.startVector(4,e,4)}static addIds(t,e){t.addFieldOffset(3,e,0)}static createIdsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startIdsVector(t,e){t.startVector(4,e,4)}static addItemsKeys(t,e){t.addFieldOffset(4,e,0)}static createItemsKeysVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startItemsKeysVector(t,e){t.startVector(4,e,4)}static addItemsKeysIndices(t,e){t.addFieldOffset(5,e,0)}static createItemsKeysIndicesVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startItemsKeysIndicesVector(t,e){t.startVector(4,e,4)}static addItemsRels(t,e){t.addFieldOffset(6,e,0)}static createItemsRelsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startItemsRelsVector(t,e){t.startVector(4,e,4)}static addItemsRelsIndices(t,e){t.addFieldOffset(7,e,0)}static createItemsRelsIndicesVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startItemsRelsIndicesVector(t,e){t.startVector(4,e,4)}static addFragmentKeys(t,e){t.addFieldOffset(8,e,0)}static addGlobalIds(t,e){t.addFieldOffset(9,e,0)}static addId(t,e){t.addFieldOffset(10,e,0)}static addName(t,e){t.addFieldOffset(11,e,0)}static addIfcName(t,e){t.addFieldOffset(12,e,0)}static addIfcDescription(t,e){t.addFieldOffset(13,e,0)}static addIfcSchema(t,e){t.addFieldOffset(14,e,0)}static addMaxExpressId(t,e){t.addFieldInt32(15,e,0)}static addBoundingBox(t,e){t.addFieldOffset(16,e,0)}static createBoundingBoxVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startBoundingBoxVector(t,e){t.startVector(4,e,4)}static addOpaqueGeometriesIds(t,e){t.addFieldOffset(17,e,0)}static createOpaqueGeometriesIdsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startOpaqueGeometriesIdsVector(t,e){t.startVector(4,e,4)}static addTransparentGeometriesIds(t,e){t.addFieldOffset(18,e,0)}static createTransparentGeometriesIdsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startTransparentGeometriesIdsVector(t,e){t.startVector(4,e,4)}static endFragmentsGroup(t){return t.endObject()}static finishFragmentsGroupBuffer(t,e){t.finish(e)}static finishSizePrefixedFragmentsGroupBuffer(t,e){t.finish(e,void 0,!0)}};class bP{constructor(){Et(this,"version",2),Et(this,"separator","|")}import(t){const e=new wo(t),i=am.getRootAsFragmentsGroup(e),s=this.constructFragmentGroup(i),n=i.itemsLength();for(let o=0;o<n;o++){const a=i.items(o);if(!a)continue;const c=this.constructGeometry(a),l=this.constructMaterials(a),h=a.capacity(),u=new So(c,l,h);u.capacityOffset=a.capacityOffset(),this.setInstances(a,u),this.setID(a,u),s.items.push(u),s.add(u.mesh)}return s}export(t){const e=new vE(1024),i=[],s=am,n=we;let o=null;if(t.civilData){const st=[],K=Uv,Q=Tn;for(const[lt,pt]of t.civilData.alignments){const{absolute:mt,horizontal:yt,vertical:zt}=pt,Lt=this.saveCivilCurves(yt,e),v=this.saveCivilCurves(zt,e),j=this.saveCivilCurves(mt,e),W=K.createHorizontalVector(e,Lt),N=K.createVerticalVector(e,v),x=K.createAbsoluteVector(e,j);K.startAlignment(e),K.addHorizontal(e,W),K.addVertical(e,N),K.addAbsolute(e,x),K.addInitialPk(e,pt.initialKP);const V=K.endAlignment(e);st.push(V)}const gt=Q.createAlignmentsVector(e,st),Ct=Q.createCoordinationMatrixVector(e,t.coordinationMatrix.elements);Q.startCivilData(e),Q.addAlignments(e,gt),Q.addCoordinationMatrix(e,Ct),o=Q.endCivilData(e)}for(const st of t.items){const K=st.exportData(),Q=[];for(const N of st.ids){const x=st.getInstancesIDs(N);if(!x)throw new Error("Instances not found!");Q.push(x.size)}const gt=n.createPositionVector(e,K.position),Ct=n.createNormalVector(e,K.normal),lt=n.createIndexVector(e,K.index),pt=n.createGroupsVector(e,K.groups),mt=n.createMaterialsVector(e,K.materials),yt=n.createMatricesVector(e,K.matrices),zt=n.createColorsVector(e,K.colors),Lt=n.createIdsVector(e,K.ids),v=n.createItemsSizeVector(e,Q),j=e.createString(K.id);n.startFragment(e),n.addPosition(e,gt),n.addNormal(e,Ct),n.addIndex(e,lt),n.addGroups(e,pt),n.addMaterials(e,mt),n.addMatrices(e,yt),n.addColors(e,zt),n.addIds(e,Lt),n.addItemsSize(e,v),n.addId(e,j),n.addCapacity(e,st.capacity),n.addCapacityOffset(e,st.capacityOffset);const W=we.endFragment(e);i.push(W)}const a=s.createItemsVector(e,i),c=s.createCoordinationMatrixVector(e,t.coordinationMatrix.elements);let l="";for(const st of t.keyFragments.values())l.length&&(l+=this.separator),l+=st;let h="";for(const[st]of t.globalToExpressIDs)h.length&&(h+=this.separator),h+=st;const u=e.createString(l),d=e.createString(h),f=[],p=[],m=[],g=[],I=[];let C=0,b=0;for(const[st,[K,Q]]of t.data){f.push(C),m.push(b),I.push(st);for(const gt of K)p.push(gt);for(const gt of Q)g.push(gt);C+=K.length,b+=Q.length}const E=[],T=[];for(const[st,K]of t.geometryIDs.opaque)E.push(st,K);for(const[st,K]of t.geometryIDs.transparent)T.push(st,K);const A=e.createString(t.uuid),S=e.createString(t.name),_=e.createString(t.ifcMetadata.name),w=e.createString(t.ifcMetadata.description),F=e.createString(t.ifcMetadata.schema),D=s.createItemsKeysIndicesVector(e,f),R=s.createItemsKeysVector(e,p),O=s.createItemsRelsIndicesVector(e,m),y=s.createItemsRelsVector(e,g),U=s.createIdsVector(e,I),H=s.createOpaqueGeometriesIdsVector(e,E),k=s.createTransparentGeometriesIdsVector(e,T),{min:X,max:$}=t.boundingBox,et=[X.x,X.y,X.z,$.x,$.y,$.z],Y=s.createBoundingBoxVector(e,et);s.startFragmentsGroup(e),s.addId(e,A),s.addName(e,S),s.addIfcName(e,_),s.addIfcDescription(e,w),s.addIfcSchema(e,F),s.addMaxExpressId(e,t.ifcMetadata.maxExpressID),s.addItems(e,a),s.addFragmentKeys(e,u),s.addGlobalIds(e,d),s.addIds(e,U),s.addItemsKeysIndices(e,D),s.addItemsKeys(e,R),s.addItemsRelsIndices(e,O),s.addItemsRels(e,y),s.addCoordinationMatrix(e,c),s.addBoundingBox(e,Y),s.addOpaqueGeometriesIds(e,H),s.addTransparentGeometriesIds(e,k),o!==null&&s.addCivil(e,o);const z=am.endFragmentsGroup(e);return e.finish(z),e.asUint8Array()}setID(t,e){const i=t.id();i&&(e.id=i,e.mesh.uuid=i)}setInstances(t,e){const i=t.matricesArray(),s=t.colorsArray(),n=t.idsArray(),o=t.itemsSizeArray();if(!i||!n||!o)throw new Error("Error: Can't load empty fragment!");const a=[];let c=0;for(let l=0;l<o.length;l++){const h=n[l],u=o[l],d=[],f=[];for(let m=0;m<u;m++){const g=c*16,I=i.subarray(g,g+17),C=new ht().fromArray(I);if(d.push(C),s){const b=c*3,[E,T,A]=s.subarray(b,b+4),S=new Rt(E,T,A);f.push(S)}c++}const p=f.length?f:void 0;a.push({id:h,transforms:d,colors:p})}e.add(a)}constructMaterials(t){const e=t.materialsArray(),i=[];if(!e)return i;for(let s=0;s<e.length;s+=5){const n=e[s],o=!!e[s+1],a=e[s+2],c=e[s+3],l=e[s+4],h=new Rt(a,c,l),u=new Er({color:h,opacity:n,transparent:o});i.push(u)}return i}constructFragmentGroup(t){const e=new si,i=t.civil();if(i){const F=i.coordinationMatrixArray(),D=new ht;F&&D.fromArray(F),e.civilData={alignments:new Map,coordinationMatrix:D};const R=i.alignmentsLength();for(let O=0;O<R;O++){const y=new xi({color:16777215}),U=new lp,H=i.alignments(O);if(!H)throw new Error("Alignment not found!");const k=H.horizontalLength();U.horizontal=this.constructCivilCurves(H,U,"horizontal",k,y);const X=H.verticalLength();U.vertical=this.constructCivilCurves(H,U,"vertical",X,y);const $=H.horizontalLength();U.absolute=this.constructCivilCurves(H,U,"absolute",$,y),U.initialKP=H.initialPk(),e.civilData.alignments.set(O,U)}}e.uuid=t.id()||e.uuid,e.name=t.name()||"",e.ifcMetadata={name:t.ifcName()||"",description:t.ifcDescription()||"",schema:t.ifcSchema()||"IFC2X3",maxExpressID:t.maxExpressId()||0};const s=new ht().elements,n=t.coordinationMatrixArray()||s,o=t.idsArray()||new Uint32Array,a=t.itemsKeysIndicesArray()||new Uint32Array,c=t.itemsKeysArray()||new Uint32Array,l=t.itemsRelsArray()||new Uint32Array,h=t.itemsRelsIndicesArray()||new Uint32Array,d=(t.fragmentKeys()||"").split(this.separator),p=(t.globalIds()||"").split(this.separator);this.setGroupData(e,o,a,c,0),this.setGroupData(e,o,h,l,1);const m=t.opaqueGeometriesIdsArray()||new Uint32Array,g=t.transparentGeometriesIdsArray()||new Uint32Array,I=new Map;for(let F=0;F<m.length-1;F+=2){const D=m[F],R=m[F+1];I.set(D,R)}const C=new Map;for(let F=0;F<g.length-1;F+=2){const D=g[F],R=g[F+1];C.set(D,R)}e.geometryIDs={opaque:I,transparent:C};const b=t.boundingBoxArray()||[0,0,0,0,0,0],[E,T,A,S,_,w]=b;e.boundingBox.min.set(E,T,A),e.boundingBox.max.set(S,_,w);for(let F=0;F<d.length;F++)e.keyFragments.set(F,d[F]);n.length===16&&e.coordinationMatrix.fromArray(n);for(let F=0;F<o.length;F++)e.globalToExpressIDs.set(p[F],o[F]);return e}setGroupData(t,e,i,s,n){for(let o=0;o<i.length;o++){const a=e[o],c=i[o],l=i[o+1],h=l===void 0?s.length:l,u=[];for(let f=c;f<h;f++)u.push(s[f]);t.data.has(a)||t.data.set(a,[[],[]]);const d=t.data.get(a);d&&(d[n]=u)}}constructGeometry(t){const e=t.positionArray()||new Float32Array,i=t.normalArray()||new Float32Array,s=t.indexArray(),n=t.groupsArray();if(!s)throw new Error("Index not found!");const o=new Ut;if(o.setIndex(Array.from(s)),o.setAttribute("position",new Kt(e,3)),o.setAttribute("normal",new Kt(i,3)),n)for(let a=0;a<n.length;a+=3){const c=n[a],l=n[a+1],h=n[a+2];o.addGroup(c,l,h)}return o}constructCivilCurves(t,e,i,s,n){const o=[];for(let a=0;a<s;a++){const c=t[i](a);if(!c)throw new Error("Curve not found!");const l=c.pointsArray();if(l===null)throw new Error("Curve points not found!");let h={};const u=c.data();u&&(h=JSON.parse(u));const d=new $f,f=new Kt(l,3);d.setAttribute("position",f);const p=[];for(let g=0;g<l.length/3-1;g++)p.push(g,g+1);d.setIndex(p);const m=new hp(a,h,e,d,n);o.push(m.curve)}return o}saveCivilCurves(t,e){const i=Qd,s=[];for(const n of t){const a=n.mesh.geometry.attributes.position.array,c=i.createPointsVector(e,a),l=e.createString(JSON.stringify(n.data));i.startCivilCurve(e),i.addPoints(e,c),i.addData(e,l);const h=i.endCivilCurve(e);s.push(h)}return s}}class cp{constructor(){Et(this,"parsers",[new bP,new CP]),Et(this,"version","auto")}import(t){const e=this.parsers.length;if(this.version==="auto"){for(let o=0;o<this.parsers.length;o++){const c=this.parsers[o].import(t);if(Object.keys(c).length!==0){if(o!==0){const l=this.parsers.length-o;this.warnVersion(l,e)}return c}}throw new Error("No valid parser found for this file")}this.checkCurrentVersionValid(this.version);const i=this.parsers.length-this.version,n=this.parsers[i].import(t);if(Object.keys(n).length===0)throw new Error(`The given version ${this.version} doesn't match to the given file. Try using "auto" in the version property to handle versions automatically.`);return n}export(t){if(this.version==="auto")return this.parsers[0].export(t);this.checkCurrentVersionValid(this.version);const e=this.parsers.length-this.version;return this.parsers[e].export(t)}checkCurrentVersionValid(t){if(this.version==="auto")return;if(this.version!==t&&this.warnVersion(this.version,t),!Number.isInteger(this.version))throw new Error("Invalid version. Non-automatic versions must an integer.");if(this.version<1||this.version>t)throw new Error(`Invalid version. Versions range from 1 to ${t}.`)}warnVersion(t,e){console.warn(`This fragment file version is ${t}. The latest version is ${e}. To avoid issues, please consider updating your fragments. You can do so by regenerating your fragments from the original IFC file.`)}}class Bv{constructor(t){Et(this,"baseDirectory"),Et(this,"maxDeadTime",6e4),Et(this,"mode","buffer"),Et(this,"_memoryCleanTime",1e4),Et(this,"_intervalID",null),Et(this,"_isCleaningMemory",!1),Et(this,"cleanMemory",async()=>{if(this._isCleaningMemory)return;this._isCleaningMemory=!0;const e=await this.getDir(this.baseDirectory),i=new Set,s=new Date().getTime();for await(const n of e.values()){const o=localStorage.getItem(n.name)||"0",a=parseInt(o,10);s-a>this.maxDeadTime&&(i.add(n.name),localStorage.removeItem(n.name))}for(const n of i)e.removeEntry(n);this._isCleaningMemory=!1}),this.baseDirectory=t,this.setupMemoryCleanup()}get memoryCleanTime(){return this._memoryCleanTime}set memoryCleanTime(t){this._memoryCleanTime=t,this.dispose(),this.setupMemoryCleanup()}isCached(t){const e=this.encodeName(t);return localStorage.getItem(e)!==null}async get(t){const e=this.encodeName(t),i=await this.getDir(this.baseDirectory);try{const n=await(await i.getFileHandle(e)).getFile();return this.updateLastAccessTime(e),n}catch{return null}}async add(t,e){const i=this.encodeName(t),o=await(await(await this.getDir(this.baseDirectory)).getFileHandle(i,{create:!0})).createWritable();await o.write(e),await o.close(),this.updateLastAccessTime(i)}async clear(){const t=await this.getDir(this.baseDirectory);for await(const[e]of t.entries())await t.removeEntry(e)}dispose(){this._intervalID!==null&&window.clearInterval(this._intervalID)}setupMemoryCleanup(){this._intervalID=window.setInterval(this.cleanMemory,this.memoryCleanTime)}async getDir(t){return(await navigator.storage.getDirectory()).getDirectoryHandle(t,{create:!0})}encodeName(t){const e=/[\\/:*?"<>|]/g;return t.replace(e,"")}updateLastAccessTime(t){const e=new Date().getTime().toString();localStorage.setItem(t,e)}}const _o=class Ke extends vo{constructor(){super(...arguments),Et(this,"items",[]),Et(this,"boundingBox",new vt),Et(this,"coordinationMatrix",new ht),Et(this,"keyFragments",new Map),Et(this,"globalToExpressIDs",new Map),Et(this,"data",new Map),Et(this,"geometryIDs",{opaque:new Map,transparent:new Map}),Et(this,"ifcMetadata",{name:"",description:"",schema:"IFC2X3",maxExpressID:0}),Et(this,"civilData"),Et(this,"streamSettings",{baseFileName:"",ids:new Map,types:new Map}),Et(this,"isStreamed",!1),Et(this,"_properties")}get hasProperties(){const t=this._properties!==void 0,e=this.streamSettings.ids.size!==0;return t||e}getFragmentMap(t=this.data.keys()){const e={};for(const i of t){const s=this.data.get(i);if(s)for(const n of s[0]){const o=this.keyFragments.get(n);o!==void 0&&(e[o]||(e[o]=new Set),e[o].add(i))}}return e}getItemVertices(t){const e=[],i=this.getFragmentMap([t]);for(const s in i){const n=this.items.find(a=>a.id===s);if(!n)continue;const o=n.getInstancesIDs(t);if(o)for(const a of o){const c=new ht;n.mesh.getMatrixAt(a,c);for(const l of n.uniqueVertices){const h=l.clone().applyMatrix4(c);e.push(h)}}}return e}static setPropertiesDB(t){t?Ke.propertiesDB||(Ke.propertiesDB=new Bv("that-open-company-streaming-properties")):t||Ke.propertiesDB&&Ke.propertiesDB.dispose()}dispose(t=!0){for(const e of this.items)e.dispose(t);if(this.coordinationMatrix=new ht,this.keyFragments.clear(),this.data.clear(),this._properties={},this.removeFromParent(),this.items=[],this.civilData){const{alignments:e}=this.civilData;for(const[i,s]of e)this.disposeAlignment(s.vertical),this.disposeAlignment(s.horizontal),this.disposeAlignment(s.absolute)}this.civilData=void 0}setLocalProperties(t){this._properties=t}getLocalProperties(){return this._properties}getAllPropertiesIDs(){return this._properties?Object.keys(this._properties).map(t=>parseInt(t,10)):Array.from(this.streamSettings.ids.keys())}getAllPropertiesTypes(){if(this._properties){const t=new Set;for(const e in this._properties){const i=this._properties[e];i.type!==void 0&&t.add(i.type)}return Array.from(t)}return Array.from(this.streamSettings.types.keys())}async getProperties(t){if(this._properties)return this._properties[t]||null;const e=this.getPropsURL(t),i=await this.getPropertiesData(e);return i?i[t]:null}async setProperties(t,e){if(this._properties){e!==null?this._properties[t]=e:delete this._properties[t];return}throw new Error("Writing streamed properties not supported yet!")}async getAllPropertiesOfType(t){if(this._properties){const n={};let o=!1;for(const a in this._properties){const c=this._properties[a];c.type===t&&(n[c.expressID]=c,o=!0)}return o?n:null}const{types:e}=this.streamSettings,i=e.get(t);if(i===void 0)return null;const s={};for(const n of i){const o=this.constructFileName(n),a=await this.getPropertiesData(o);for(const c in a)s[parseInt(c,10)]=a[c]}return s}clone(t){throw new Error("Use FragmentsGroup.cloneGroup instead!")}cloneGroup(t){const e=new Ke;e.coordinationMatrix=this.coordinationMatrix,e.position.copy(this.position),e.rotation.copy(this.rotation),e.scale.copy(this.scale),e.updateMatrix(),e.ifcMetadata={...this.ifcMetadata},t||(t=this.getFragmentMap(this.data.keys()));const i=new Set,s=new Map;for(const n of this.items){if(!t[n.id])continue;const o=t[n.id],a=n.clone(o);s.set(n.id,a.id),e.items.push(a),e.add(a.mesh);for(const c of o)i.add(c)}for(const n of i){const o=this.data.get(n);o&&e.data.set(n,o)}for(const[n,o]of this.keyFragments)if(s.has(o)){const a=s.get(o);if(a===void 0)throw new Error("Malformed fragment ID map during clone!");e.keyFragments.set(n,a)}for(const[n,o]of this.globalToExpressIDs)i.has(o)&&e.globalToExpressIDs.set(n,o);return this.civilData&&(e.civilData={coordinationMatrix:this.coordinationMatrix,alignments:new Map}),e}getPropsURL(t){const{ids:e}=this.streamSettings,i=e.get(t);if(i===void 0)throw new Error("ID not found");return this.constructFileName(i)}async getPropertiesData(t){var e;(e=this.streamSettings.baseUrl)!=null&&e.length&&(console.warn("streamSettings.baseUrl is deprecated. Use FragmentsGroup.url instead."),Ke.url=this.streamSettings.baseUrl);let i;if(Ke.useCache){let s=null;if(Ke.propertiesDB&&(s=await Ke.propertiesDB.get(t)),s)i=await s.text();else if(i=await(await Ke.fetch(t)).text(),Ke.propertiesDB){const a=new TextEncoder().encode(i);await Ke.propertiesDB.add(t,a)}}else i=await(await Ke.fetch(t)).text();return JSON.parse(i)}constructFileName(t){if(Ke.constructFileName)return Ke.constructFileName(t);const{baseFileName:e}=this.streamSettings;return`${e}-${t}`}disposeAlignment(t){for(const e of t)if(e.mesh.geometry.dispose(),Array.isArray(e.mesh.material))for(const i of e.mesh.material)i.dispose();else e.mesh.material.dispose();t.length=0}};Et(_o,"fetch",async r=>fetch(`${_o.url}${r}`));Et(_o,"constructFileName",null);Et(_o,"url","");Et(_o,"useCache",!0);Et(_o,"propertiesDB",null);let si=_o;class lp{constructor(){Et(this,"vertical",[]),Et(this,"horizontal",[]),Et(this,"absolute",[]),Et(this,"initialKP",0)}getLength(t){let e=0;for(const i of this[t])e+=i.getLength();return e}getPointAt(t,e){const i=this.getCurveAt(t,e);return i.curve.getPointAt(i.percentage)}getPercentageAt(t,e,i=.01){const s=this[e];let n=0;for(const o of s){const a=o.getPercentageAt(t,i),c=o.getLength();if(a!==null){const l=n+a*c,h=this.getLength(e);return l/h}n+=c}return null}getCurveAt(t,e){t<0?t=0:t>1&&(t=1);const i=this[e],n=this.getLength(e)*t;let o=0;for(const a of i){const c=a.getLength();if(o+c>=n){const h=(n-o)/c;return{curve:a,percentage:h}}o+=c}throw new Error("Could not compute point!")}}class TP{constructor(t,e,i,s){Et(this,"index"),Et(this,"mesh"),Et(this,"data"),Et(this,"alignment"),this.index=t,this.mesh=e,this.data=i,this.alignment=s}get _index(){return this.mesh.geometry.index}get _pos(){return this.mesh.geometry.attributes.position.array}getLength(){let t=0;for(let e=0;e<this._index.array.length-1;e+=2){const{startPoint:i,endPoint:s}=this.getSegment(e);t+=i.distanceTo(s)}return t}getPointAt(t){const{startPoint:e,endPoint:i,distanceToStart:s}=this.getSegmentAt(t),n=i.clone();return n.sub(e),n.normalize(),n.multiplyScalar(s),n.add(e),n}getSegmentAt(t){t<0?t=0:t>1&&(t=1);const i=this.getLength()*t;let s=0;for(let n=0;n<this._index.array.length-1;n+=2){const{startPoint:o,endPoint:a}=this.getSegment(n),c=o.distanceTo(a);if(s+c>=i)return{distanceToStart:i-s,index:n,startPoint:o,endPoint:a};s+=c}throw new Error("Could not compute point")}getPercentageAt(t,e=.01){let i=0;for(let s=0;s<this._index.array.length-1;s+=2){const{startPoint:n,endPoint:o}=this.getSegment(s),a=n.distanceTo(o),c=t.distanceTo(n),l=t.distanceTo(o);if(c+l-a<=e){const d=i+c,f=this.getLength();return d/f}i+=a}return null}getSegment(t){const e=this._index.array[t]*3,i=this._index.array[t+1]*3,s=new M(this._pos[e],this._pos[e+1],this._pos[e+2]),n=new M(this._pos[i],this._pos[i+1],this._pos[i+2]);return{startPoint:s,endPoint:n}}}class hp extends Zg{constructor(t,e,i,s,n){super(s,n),Et(this,"curve"),this.curve=new TP(t,this,e,i)}}class As{constructor(){Et(this,"bb",null),Et(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStreamedGeometry(t,e){return(e||new As).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStreamedGeometry(t,e){return t.setPosition(t.position()+Pi),(e||new As).__init(t.readInt32(t.position())+t.position(),t)}geometryId(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint32(this.bb_pos+t):0}position(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}positionLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}positionArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}normal(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+t*4):0}normalLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}normalArray(){const t=this.bb.__offset(this.bb_pos,8);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}index(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+t*4):0}indexLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}indexArray(){const t=this.bb.__offset(this.bb_pos,10);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startStreamedGeometry(t){t.startObject(4)}static addGeometryId(t,e){t.addFieldInt32(0,e,0)}static addPosition(t,e){t.addFieldOffset(1,e,0)}static createPositionVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startPositionVector(t,e){t.startVector(4,e,4)}static addNormal(t,e){t.addFieldOffset(2,e,0)}static createNormalVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addFloat32(e[i]);return t.endVector()}static startNormalVector(t,e){t.startVector(4,e,4)}static addIndex(t,e){t.addFieldOffset(3,e,0)}static createIndexVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startIndexVector(t,e){t.startVector(4,e,4)}static endStreamedGeometry(t){return t.endObject()}static createStreamedGeometry(t,e,i,s,n){return As.startStreamedGeometry(t),As.addGeometryId(t,e),As.addPosition(t,i),As.addNormal(t,s),As.addIndex(t,n),As.endStreamedGeometry(t)}}class ar{constructor(){Et(this,"bb",null),Et(this,"bb_pos",0)}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStreamedGeometries(t,e){return(e||new ar).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStreamedGeometries(t,e){return t.setPosition(t.position()+Pi),(e||new ar).__init(t.readInt32(t.position())+t.position(),t)}geometries(t,e){const i=this.bb.__offset(this.bb_pos,4);return i?(e||new As).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}geometriesLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}static startStreamedGeometries(t){t.startObject(1)}static addGeometries(t,e){t.addFieldOffset(0,e,0)}static createGeometriesVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startGeometriesVector(t,e){t.startVector(4,e,4)}static endStreamedGeometries(t){return t.endObject()}static finishStreamedGeometriesBuffer(t,e){t.finish(e)}static finishSizePrefixedStreamedGeometriesBuffer(t,e){t.finish(e,void 0,!0)}static createStreamedGeometries(t,e){return ar.startStreamedGeometries(t),ar.addGeometries(t,e),ar.endStreamedGeometries(t)}}class RE{import(t){const e=new wo(t),i=ar.getRootAsStreamedGeometries(e),s=new Map,n=i.geometriesLength();for(let o=0;o<n;o++){const a=i.geometries(o);if(!a)continue;const c=a.geometryId();if(c===null)throw new Error("Error finding ID!");const l=a.positionArray(),h=a.normalArray(),u=a.indexArray();!l||!h||!u||s.set(c,{position:l,normal:h,index:u})}return s}export(t){const e=new vE(1024),i=[],s=ar,n=As;for(const[c,{index:l,position:h,normal:u}]of t){const d=n.createIndexVector(e,l),f=n.createPositionVector(e,h),p=n.createNormalVector(e,u);n.startStreamedGeometry(e),n.addGeometryId(e,c),n.addIndex(e,d),n.addPosition(e,f),n.addNormal(e,p);const m=n.endStreamedGeometry(e);i.push(m)}const o=s.createGeometriesVector(e,i);s.startStreamedGeometries(e),s.addGeometries(e,o);const a=s.endStreamedGeometries(e);return e.finish(a),e.asUint8Array()}}class ns{static combine(t){if(t.length===0)return{};if(t.length===1)return t[0];const e={};for(const i of t)for(const s in i){e[s]||(e[s]=new Set);for(const n of i[s])e[s].add(n)}return e}static intersect(t){if(t.length===0)return{};if(t.length===1)return t[0];const e=new Map;let i=0;for(const n of t){i++;for(const o in n){e.has(o)||e.set(o,{count:0,ids:new Map});const a=e.get(o);a.count++;for(const c of n[o]){const l=a.ids.get(c)||0;a.ids.set(c,l+1)}}}const s={};for(const[n,{count:o,ids:a}]of e)if(o===i)for(const[c,l]of a)l===i&&(s[n]||(s[n]=new Set),s[n].add(c));return s}static copy(t){const e={};for(const i in t)e[i]=new Set(t[i]);return e}static export(t){const e={};for(const i in t)e[i]=Array.from(t[i]);return e}static import(t){const e={};for(const i in t)e[i]=new Set(t[i]);return e}}var yP=Object.defineProperty,vP=(r,t,e)=>t in r?yP(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,L=(r,t,e)=>(vP(r,typeof t!="symbol"?t+"":t,e),e);const kv=0,RP=1,AP=2,xC=2,cm=1.25,NC=1,Kd=6*4+4+4,up=65535,SP=Math.pow(2,-24),lm=Symbol("SKIP_GENERATION");function wP(r){return r.index?r.index.count:r.attributes.position.count}function Hc(r){return wP(r)/3}function _P(r,t=ArrayBuffer){return r>65535?new Uint32Array(new t(4*r)):new Uint16Array(new t(2*r))}function FP(r,t){if(!r.index){const e=r.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,s=_P(e,i);r.setIndex(new Kt(s,1));for(let n=0;n<e;n++)s[n]=n}}function Vv(r){const t=Hc(r),e=r.drawRange,i=e.start/3,s=(e.start+e.count)/3,n=Math.max(0,i),o=Math.min(t,s)-n;return[{offset:Math.floor(n),count:Math.floor(o)}]}function zv(r){if(!r.groups||!r.groups.length)return Vv(r);const t=[],e=new Set,i=r.drawRange,s=i.start/3,n=(i.start+i.count)/3;for(const a of r.groups){const c=a.start/3,l=(a.start+a.count)/3;e.add(Math.max(s,c)),e.add(Math.min(n,l))}const o=Array.from(e.values()).sort((a,c)=>a-c);for(let a=0;a<o.length-1;a++){const c=o[a],l=o[a+1];t.push({offset:Math.floor(c),count:Math.floor(l-c)})}return t}function OP(r){if(r.groups.length===0)return!1;const t=Hc(r),e=zv(r).sort((n,o)=>n.offset-o.offset),i=e[e.length-1];i.count=Math.min(t-i.offset,i.count);let s=0;return e.forEach(({count:n})=>s+=n),t!==s}function ge(r,t,e){return e.min.x=t[r],e.min.y=t[r+1],e.min.z=t[r+2],e.max.x=t[r+3],e.max.y=t[r+4],e.max.z=t[r+5],e}function xP(r){r[0]=r[1]=r[2]=1/0,r[3]=r[4]=r[5]=-1/0}function PC(r){let t=-1,e=-1/0;for(let i=0;i<3;i++){const s=r[i+3]-r[i];s>e&&(e=s,t=i)}return t}function LC(r,t){t.set(r)}function MC(r,t,e){let i,s;for(let n=0;n<3;n++){const o=n+3;i=r[n],s=t[n],e[n]=i<s?i:s,i=r[o],s=t[o],e[o]=i>s?i:s}}function Du(r,t,e){for(let i=0;i<3;i++){const s=t[r+2*i],n=t[r+2*i+1],o=s-n,a=s+n;o<e[i]&&(e[i]=o),a>e[i+3]&&(e[i+3]=a)}}function Il(r){const t=r[3]-r[0],e=r[4]-r[1],i=r[5]-r[2];return 2*(t*e+e*i+i*t)}function hm(r,t,e,i,s=null){let n=1/0,o=1/0,a=1/0,c=-1/0,l=-1/0,h=-1/0,u=1/0,d=1/0,f=1/0,p=-1/0,m=-1/0,g=-1/0;const I=s!==null;for(let C=t*6,b=(t+e)*6;C<b;C+=6){const E=r[C+0],T=r[C+1],A=E-T,S=E+T;A<n&&(n=A),S>c&&(c=S),I&&E<u&&(u=E),I&&E>p&&(p=E);const _=r[C+2],w=r[C+3],F=_-w,D=_+w;F<o&&(o=F),D>l&&(l=D),I&&_<d&&(d=_),I&&_>m&&(m=_);const R=r[C+4],O=r[C+5],y=R-O,U=R+O;y<a&&(a=y),U>h&&(h=U),I&&R<f&&(f=R),I&&R>g&&(g=R)}i[0]=n,i[1]=o,i[2]=a,i[3]=c,i[4]=l,i[5]=h,I&&(s[0]=u,s[1]=d,s[2]=f,s[3]=p,s[4]=m,s[5]=g)}function NP(r,t,e,i){let s=1/0,n=1/0,o=1/0,a=-1/0,c=-1/0,l=-1/0;for(let h=t*6,u=(t+e)*6;h<u;h+=6){const d=r[h+0];d<s&&(s=d),d>a&&(a=d);const f=r[h+2];f<n&&(n=f),f>c&&(c=f);const p=r[h+4];p<o&&(o=p),p>l&&(l=p)}i[0]=s,i[1]=n,i[2]=o,i[3]=a,i[4]=c,i[5]=l}function PP(r,t){xP(t);const e=r.attributes.position,i=r.index?r.index.array:null,s=Hc(r),n=new Float32Array(s*6),o=e.normalized,a=e.array,c=e.offset||0;let l=3;e.isInterleavedBufferAttribute&&(l=e.data.stride);const h=["getX","getY","getZ"];for(let u=0;u<s;u++){const d=u*3,f=u*6;let p=d+0,m=d+1,g=d+2;i&&(p=i[p],m=i[m],g=i[g]),o||(p=p*l+c,m=m*l+c,g=g*l+c);for(let I=0;I<3;I++){let C,b,E;o?(C=e[h[I]](p),b=e[h[I]](m),E=e[h[I]](g)):(C=a[p+I],b=a[m+I],E=a[g+I]);let T=C;b<T&&(T=b),E<T&&(T=E);let A=C;b>A&&(A=b),E>A&&(A=E);const S=(A-T)/2,_=I*2;n[f+_+0]=T+S,n[f+_+1]=S+(Math.abs(T)+S)*SP,T<t[I]&&(t[I]=T),A>t[I+3]&&(t[I+3]=A)}}return n}const mn=32,LP=(r,t)=>r.candidate-t.candidate,Wn=new Array(mn).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),Uu=new Float32Array(6);function MP(r,t,e,i,s,n){let o=-1,a=0;if(n===kv)o=PC(t),o!==-1&&(a=(t[o]+t[o+3])/2);else if(n===RP)o=PC(r),o!==-1&&(a=DP(e,i,s,o));else if(n===AP){const c=Il(r);let l=cm*s;const h=i*6,u=(i+s)*6;for(let d=0;d<3;d++){const f=t[d],g=(t[d+3]-f)/mn;if(s<mn/4){const I=[...Wn];I.length=s;let C=0;for(let E=h;E<u;E+=6,C++){const T=I[C];T.candidate=e[E+2*d],T.count=0;const{bounds:A,leftCacheBounds:S,rightCacheBounds:_}=T;for(let w=0;w<3;w++)_[w]=1/0,_[w+3]=-1/0,S[w]=1/0,S[w+3]=-1/0,A[w]=1/0,A[w+3]=-1/0;Du(E,e,A)}I.sort(LP);let b=s;for(let E=0;E<b;E++){const T=I[E];for(;E+1<b&&I[E+1].candidate===T.candidate;)I.splice(E+1,1),b--}for(let E=h;E<u;E+=6){const T=e[E+2*d];for(let A=0;A<b;A++){const S=I[A];T>=S.candidate?Du(E,e,S.rightCacheBounds):(Du(E,e,S.leftCacheBounds),S.count++)}}for(let E=0;E<b;E++){const T=I[E],A=T.count,S=s-T.count,_=T.leftCacheBounds,w=T.rightCacheBounds;let F=0;A!==0&&(F=Il(_)/c);let D=0;S!==0&&(D=Il(w)/c);const R=NC+cm*(F*A+D*S);R<l&&(o=d,l=R,a=T.candidate)}}else{for(let b=0;b<mn;b++){const E=Wn[b];E.count=0,E.candidate=f+g+b*g;const T=E.bounds;for(let A=0;A<3;A++)T[A]=1/0,T[A+3]=-1/0}for(let b=h;b<u;b+=6){let A=~~((e[b+2*d]-f)/g);A>=mn&&(A=mn-1);const S=Wn[A];S.count++,Du(b,e,S.bounds)}const I=Wn[mn-1];LC(I.bounds,I.rightCacheBounds);for(let b=mn-2;b>=0;b--){const E=Wn[b],T=Wn[b+1];MC(E.bounds,T.rightCacheBounds,E.rightCacheBounds)}let C=0;for(let b=0;b<mn-1;b++){const E=Wn[b],T=E.count,A=E.bounds,_=Wn[b+1].rightCacheBounds;T!==0&&(C===0?LC(A,Uu):MC(A,Uu,Uu)),C+=T;let w=0,F=0;C!==0&&(w=Il(Uu)/c);const D=s-C;D!==0&&(F=Il(_)/c);const R=NC+cm*(w*C+F*D);R<l&&(o=d,l=R,a=E.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${n} used.`);return{axis:o,pos:a}}function DP(r,t,e,i){let s=0;for(let n=t,o=t+e;n<o;n++)s+=r[n*6+i*2];return s/e}class Bu{constructor(){}}function UP(r,t,e,i,s,n){let o=i,a=i+s-1;const c=n.pos,l=n.axis*2;for(;;){for(;o<=a&&e[o*6+l]<c;)o++;for(;o<=a&&e[a*6+l]>=c;)a--;if(o<a){for(let h=0;h<3;h++){let u=t[o*3+h];t[o*3+h]=t[a*3+h],t[a*3+h]=u}for(let h=0;h<6;h++){let u=e[o*6+h];e[o*6+h]=e[a*6+h],e[a*6+h]=u}o++,a--}else return o}}function BP(r,t,e,i,s,n){let o=i,a=i+s-1;const c=n.pos,l=n.axis*2;for(;;){for(;o<=a&&e[o*6+l]<c;)o++;for(;o<=a&&e[a*6+l]>=c;)a--;if(o<a){let h=r[o];r[o]=r[a],r[a]=h;for(let u=0;u<6;u++){let d=e[o*6+u];e[o*6+u]=e[a*6+u],e[a*6+u]=d}o++,a--}else return o}}function kP(r,t){const e=(r.index?r.index.count:r.attributes.position.count)/3,i=e>2**16,s=i?4:2,n=t?new SharedArrayBuffer(e*s):new ArrayBuffer(e*s),o=i?new Uint32Array(n):new Uint16Array(n);for(let a=0,c=o.length;a<c;a++)o[a]=a;return o}function VP(r,t){const e=r.geometry,i=e.index?e.index.array:null,s=t.maxDepth,n=t.verbose,o=t.maxLeafTris,a=t.strategy,c=t.onProgress,l=Hc(e),h=r._indirectBuffer;let u=!1;const d=new Float32Array(6),f=new Float32Array(6),p=PP(e,d),m=t.indirect?BP:UP,g=[],I=t.indirect?Vv(e):zv(e);if(I.length===1){const E=I[0],T=new Bu;T.boundingData=d,NP(p,E.offset,E.count,f),b(T,E.offset,E.count,f),g.push(T)}else for(let E of I){const T=new Bu;T.boundingData=new Float32Array(6),hm(p,E.offset,E.count,T.boundingData,f),b(T,E.offset,E.count,f),g.push(T)}return g;function C(E){c&&c(E/l)}function b(E,T,A,S=null,_=0){if(!u&&_>=s&&(u=!0,n&&(console.warn(`MeshBVH: Max depth of ${s} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),A<=o||_>=s)return C(T+A),E.offset=T,E.count=A,E;const w=MP(E.boundingData,S,p,T,A,a);if(w.axis===-1)return C(T+A),E.offset=T,E.count=A,E;const F=m(h,i,p,T,A,w);if(F===T||F===T+A)C(T+A),E.offset=T,E.count=A;else{E.splitAxis=w.axis;const D=new Bu,R=T,O=F-T;E.left=D,D.boundingData=new Float32Array(6),hm(p,R,O,D.boundingData,f),b(D,R,O,f,_+1);const y=new Bu,U=F,H=A-O;E.right=y,y.boundingData=new Float32Array(6),hm(p,U,H,y.boundingData,f),b(y,U,H,f,_+1)}return E}}function zP(r,t){const e=r.geometry;t.indirect&&(r._indirectBuffer=kP(e,t.useSharedArrayBuffer),OP(e)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),r._indirectBuffer||FP(e,t);const i=VP(r,t);let s,n,o;const a=[],c=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let u=0;u<i.length;u++){const d=i[u];let f=l(d);const p=new c(Kd*f);s=new Float32Array(p),n=new Uint32Array(p),o=new Uint16Array(p),h(0,d),a.push(p)}r._roots=a;return;function l(u){return u.count?1:1+l(u.left)+l(u.right)}function h(u,d){const f=u/4,p=u/2,m=!!d.count,g=d.boundingData;for(let I=0;I<6;I++)s[f+I]=g[I];if(m){const I=d.offset,C=d.count;return n[f+6]=I,o[p+14]=C,o[p+15]=up,u+Kd}else{const I=d.left,C=d.right,b=d.splitAxis;let E;if(E=h(u+Kd,I),E/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[f+6]=E/4,E=h(E,C),n[f+7]=b,E}}}class Dn{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,e){let i=1/0,s=-1/0;for(let n=0,o=t.length;n<o;n++){const c=t[n][e];i=c<i?c:i,s=c>s?c:s}this.min=i,this.max=s}setFromPoints(t,e){let i=1/0,s=-1/0;for(let n=0,o=e.length;n<o;n++){const a=e[n],c=t.dot(a);i=c<i?c:i,s=c>s?c:s}this.min=i,this.max=s}isSeparated(t){return this.min>t.max||t.min>this.max}}Dn.prototype.setFromBox=function(){const r=new M;return function(e,i){const s=i.min,n=i.max;let o=1/0,a=-1/0;for(let c=0;c<=1;c++)for(let l=0;l<=1;l++)for(let h=0;h<=1;h++){r.x=s.x*c+n.x*(1-c),r.y=s.y*l+n.y*(1-l),r.z=s.z*h+n.z*(1-h);const u=e.dot(r);o=Math.min(u,o),a=Math.max(u,a)}this.min=o,this.max=a}}();const YP=function(){const r=new M,t=new M,e=new M;return function(s,n,o){const a=s.start,c=r,l=n.start,h=t;e.subVectors(a,l),r.subVectors(s.end,s.start),t.subVectors(n.end,n.start);const u=e.dot(h),d=h.dot(c),f=h.dot(h),p=e.dot(c),g=c.dot(c)*f-d*d;let I,C;g!==0?I=(u*d-p*f)/g:I=0,C=(u+I*d)/f,o.x=I,o.y=C}}(),AE=function(){const r=new Ot,t=new M,e=new M;return function(s,n,o,a){YP(s,n,r);let c=r.x,l=r.y;if(c>=0&&c<=1&&l>=0&&l<=1){s.at(c,o),n.at(l,a);return}else if(c>=0&&c<=1){l<0?n.at(0,a):n.at(1,a),s.closestPointToPoint(a,!0,o);return}else if(l>=0&&l<=1){c<0?s.at(0,o):s.at(1,o),n.closestPointToPoint(o,!0,a);return}else{let h;c<0?h=s.start:h=s.end;let u;l<0?u=n.start:u=n.end;const d=t,f=e;if(s.closestPointToPoint(u,!0,t),n.closestPointToPoint(h,!0,e),d.distanceToSquared(u)<=f.distanceToSquared(h)){o.copy(d),a.copy(u);return}else{o.copy(h),a.copy(f);return}}}}(),GP=function(){const r=new M,t=new M,e=new Qe,i=new Vt;return function(n,o){const{radius:a,center:c}=n,{a:l,b:h,c:u}=o;if(i.start=l,i.end=h,i.closestPointToPoint(c,!0,r).distanceTo(c)<=a||(i.start=l,i.end=u,i.closestPointToPoint(c,!0,r).distanceTo(c)<=a)||(i.start=h,i.end=u,i.closestPointToPoint(c,!0,r).distanceTo(c)<=a))return!0;const m=o.getPlane(e);if(Math.abs(m.distanceToPoint(c))<=a){const I=m.projectPoint(c,t);if(o.containsPoint(I))return!0}return!1}}(),HP=1e-15;function um(r){return Math.abs(r)<HP}class Fs extends $e{constructor(...t){super(...t),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new M),this.satBounds=new Array(4).fill().map(()=>new Dn),this.points=[this.a,this.b,this.c],this.sphere=new as,this.plane=new Qe,this.needsUpdate=!0}intersectsSphere(t){return GP(t,this)}update(){const t=this.a,e=this.b,i=this.c,s=this.points,n=this.satAxes,o=this.satBounds,a=n[0],c=o[0];this.getNormal(a),c.setFromPoints(a,s);const l=n[1],h=o[1];l.subVectors(t,e),h.setFromPoints(l,s);const u=n[2],d=o[2];u.subVectors(e,i),d.setFromPoints(u,s);const f=n[3],p=o[3];f.subVectors(i,t),p.setFromPoints(f,s),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,t),this.needsUpdate=!1}}Fs.prototype.closestPointToSegment=function(){const r=new M,t=new M,e=new Vt;return function(s,n=null,o=null){const{start:a,end:c}=s,l=this.points;let h,u=1/0;for(let d=0;d<3;d++){const f=(d+1)%3;e.start.copy(l[d]),e.end.copy(l[f]),AE(e,s,r,t),h=r.distanceToSquared(t),h<u&&(u=h,n&&n.copy(r),o&&o.copy(t))}return this.closestPointToPoint(a,r),h=a.distanceToSquared(r),h<u&&(u=h,n&&n.copy(r),o&&o.copy(a)),this.closestPointToPoint(c,r),h=c.distanceToSquared(r),h<u&&(u=h,n&&n.copy(r),o&&o.copy(c)),Math.sqrt(u)}}();Fs.prototype.intersectsTriangle=function(){const r=new Fs,t=new Array(3),e=new Array(3),i=new Dn,s=new Dn,n=new M,o=new M,a=new M,c=new M,l=new M,h=new Vt,u=new Vt,d=new Vt,f=new M;function p(m,g,I){const C=m.points;let b=0,E=-1;for(let T=0;T<3;T++){const{start:A,end:S}=h;A.copy(C[T]),S.copy(C[(T+1)%3]),h.delta(o);const _=um(g.distanceToPoint(A));if(um(g.normal.dot(o))&&_){I.copy(h),b=2;break}const w=g.intersectLine(h,f);if(!w&&_&&f.copy(A),(w||_)&&!um(f.distanceTo(S))){if(b<=1)(b===1?I.start:I.end).copy(f),_&&(E=b);else if(b>=2){(E===1?I.start:I.end).copy(f),b=2;break}if(b++,b===2&&E===-1)break}}return b}return function(g,I=null,C=!1){this.needsUpdate&&this.update(),g.isExtendedTriangle?g.needsUpdate&&g.update():(r.copy(g),r.update(),g=r);const b=this.plane,E=g.plane;if(Math.abs(b.normal.dot(E.normal))>1-1e-10){const T=this.satBounds,A=this.satAxes;e[0]=g.a,e[1]=g.b,e[2]=g.c;for(let w=0;w<4;w++){const F=T[w],D=A[w];if(i.setFromPoints(D,e),F.isSeparated(i))return!1}const S=g.satBounds,_=g.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let w=0;w<4;w++){const F=S[w],D=_[w];if(i.setFromPoints(D,t),F.isSeparated(i))return!1}for(let w=0;w<4;w++){const F=A[w];for(let D=0;D<4;D++){const R=_[D];if(n.crossVectors(F,R),i.setFromPoints(n,t),s.setFromPoints(n,e),i.isSeparated(s))return!1}}return I&&(C||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),I.start.set(0,0,0),I.end.set(0,0,0)),!0}else{const T=p(this,E,u);if(T===1&&g.containsPoint(u.end))return I&&(I.start.copy(u.end),I.end.copy(u.end)),!0;if(T!==2)return!1;const A=p(g,b,d);if(A===1&&this.containsPoint(d.end))return I&&(I.start.copy(d.end),I.end.copy(d.end)),!0;if(A!==2)return!1;if(u.delta(a),d.delta(c),a.dot(c)<0){let O=d.start;d.start=d.end,d.end=O}const S=u.start.dot(a),_=u.end.dot(a),w=d.start.dot(a),F=d.end.dot(a),D=_<w,R=S<F;return S!==F&&w!==_&&D===R?!1:(I&&(l.subVectors(u.start,d.start),l.dot(a)>0?I.start.copy(u.start):I.start.copy(d.start),l.subVectors(u.end,d.end),l.dot(a)<0?I.end.copy(u.end):I.end.copy(d.end)),!0)}}}();Fs.prototype.distanceToPoint=function(){const r=new M;return function(e){return this.closestPointToPoint(e,r),e.distanceTo(r)}}();Fs.prototype.distanceToTriangle=function(){const r=new M,t=new M,e=["a","b","c"],i=new Vt,s=new Vt;return function(o,a=null,c=null){const l=a||c?i:null;if(this.intersectsTriangle(o,l))return(a||c)&&(a&&l.getCenter(a),c&&l.getCenter(c)),0;let h=1/0;for(let u=0;u<3;u++){let d;const f=e[u],p=o[f];this.closestPointToPoint(p,r),d=p.distanceToSquared(r),d<h&&(h=d,a&&a.copy(r),c&&c.copy(p));const m=this[f];o.closestPointToPoint(m,r),d=m.distanceToSquared(r),d<h&&(h=d,a&&a.copy(m),c&&c.copy(r))}for(let u=0;u<3;u++){const d=e[u],f=e[(u+1)%3];i.set(this[d],this[f]);for(let p=0;p<3;p++){const m=e[p],g=e[(p+1)%3];s.set(o[m],o[g]),AE(i,s,r,t);const I=r.distanceToSquared(t);I<h&&(h=I,a&&a.copy(r),c&&c.copy(t))}}return Math.sqrt(h)}}();class li{constructor(t,e,i){this.isOrientedBox=!0,this.min=new M,this.max=new M,this.matrix=new ht,this.invMatrix=new ht,this.points=new Array(8).fill().map(()=>new M),this.satAxes=new Array(3).fill().map(()=>new M),this.satBounds=new Array(3).fill().map(()=>new Dn),this.alignedSatBounds=new Array(3).fill().map(()=>new Dn),this.needsUpdate=!1,t&&this.min.copy(t),e&&this.max.copy(e),i&&this.matrix.copy(i)}set(t,e,i){this.min.copy(t),this.max.copy(e),this.matrix.copy(i),this.needsUpdate=!0}copy(t){this.min.copy(t.min),this.max.copy(t.max),this.matrix.copy(t.matrix),this.needsUpdate=!0}}li.prototype.update=function(){return function(){const t=this.matrix,e=this.min,i=this.max,s=this.points;for(let l=0;l<=1;l++)for(let h=0;h<=1;h++)for(let u=0;u<=1;u++){const d=1*l|2*h|4*u,f=s[d];f.x=l?i.x:e.x,f.y=h?i.y:e.y,f.z=u?i.z:e.z,f.applyMatrix4(t)}const n=this.satBounds,o=this.satAxes,a=s[0];for(let l=0;l<3;l++){const h=o[l],u=n[l],d=1<<l,f=s[d];h.subVectors(a,f),u.setFromPoints(h,s)}const c=this.alignedSatBounds;c[0].setFromPointsField(s,"x"),c[1].setFromPointsField(s,"y"),c[2].setFromPointsField(s,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();li.prototype.intersectsBox=function(){const r=new Dn;return function(e){this.needsUpdate&&this.update();const i=e.min,s=e.max,n=this.satBounds,o=this.satAxes,a=this.alignedSatBounds;if(r.min=i.x,r.max=s.x,a[0].isSeparated(r)||(r.min=i.y,r.max=s.y,a[1].isSeparated(r))||(r.min=i.z,r.max=s.z,a[2].isSeparated(r)))return!1;for(let c=0;c<3;c++){const l=o[c],h=n[c];if(r.setFromBox(l,e),h.isSeparated(r))return!1}return!0}}();li.prototype.intersectsTriangle=function(){const r=new Fs,t=new Array(3),e=new Dn,i=new Dn,s=new M;return function(o){this.needsUpdate&&this.update(),o.isExtendedTriangle?o.needsUpdate&&o.update():(r.copy(o),r.update(),o=r);const a=this.satBounds,c=this.satAxes;t[0]=o.a,t[1]=o.b,t[2]=o.c;for(let d=0;d<3;d++){const f=a[d],p=c[d];if(e.setFromPoints(p,t),f.isSeparated(e))return!1}const l=o.satBounds,h=o.satAxes,u=this.points;for(let d=0;d<3;d++){const f=l[d],p=h[d];if(e.setFromPoints(p,u),f.isSeparated(e))return!1}for(let d=0;d<3;d++){const f=c[d];for(let p=0;p<4;p++){const m=h[p];if(s.crossVectors(f,m),e.setFromPoints(s,t),i.setFromPoints(s,u),e.isSeparated(i))return!1}}return!0}}();li.prototype.closestPointToPoint=function(){return function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();li.prototype.distanceToPoint=function(){const r=new M;return function(e){return this.closestPointToPoint(e,r),e.distanceTo(r)}}();li.prototype.distanceToBox=function(){const r=["x","y","z"],t=new Array(12).fill().map(()=>new Vt),e=new Array(12).fill().map(()=>new Vt),i=new M,s=new M;return function(o,a=0,c=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(o))return(c||l)&&(o.getCenter(s),this.closestPointToPoint(s,i),o.closestPointToPoint(i,s),c&&c.copy(i),l&&l.copy(s)),0;const h=a*a,u=o.min,d=o.max,f=this.points;let p=1/0;for(let g=0;g<8;g++){const I=f[g];s.copy(I).clamp(u,d);const C=I.distanceToSquared(s);if(C<p&&(p=C,c&&c.copy(I),l&&l.copy(s),C<h))return Math.sqrt(C)}let m=0;for(let g=0;g<3;g++)for(let I=0;I<=1;I++)for(let C=0;C<=1;C++){const b=(g+1)%3,E=(g+2)%3,T=I<<b|C<<E,A=1<<g|I<<b|C<<E,S=f[T],_=f[A];t[m].set(S,_);const F=r[g],D=r[b],R=r[E],O=e[m],y=O.start,U=O.end;y[F]=u[F],y[D]=I?u[D]:d[D],y[R]=C?u[R]:d[D],U[F]=d[F],U[D]=I?u[D]:d[D],U[R]=C?u[R]:d[D],m++}for(let g=0;g<=1;g++)for(let I=0;I<=1;I++)for(let C=0;C<=1;C++){s.x=g?d.x:u.x,s.y=I?d.y:u.y,s.z=C?d.z:u.z,this.closestPointToPoint(s,i);const b=s.distanceToSquared(i);if(b<p&&(p=b,c&&c.copy(i),l&&l.copy(s),b<h))return Math.sqrt(b)}for(let g=0;g<12;g++){const I=t[g];for(let C=0;C<12;C++){const b=e[C];AE(I,b,i,s);const E=i.distanceToSquared(s);if(E<p&&(p=E,c&&c.copy(i),l&&l.copy(s),E<h))return Math.sqrt(E)}}return Math.sqrt(p)}}();class SE{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){const t=this._primitives;return t.length===0?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}}class $P extends SE{constructor(){super(()=>new Fs)}}const $i=new $P;function bi(r,t){return t[r+15]===65535}function Ri(r,t){return t[r+6]}function Wi(r,t){return t[r+14]}function ji(r){return r+8}function Xi(r,t){return t[r+6]}function Yv(r,t){return t[r+7]}class WP{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const t=[];let e=null;this.setBuffer=i=>{e&&t.push(e),e=i,this.float32Array=new Float32Array(i),this.uint16Array=new Uint16Array(i),this.uint32Array=new Uint32Array(i)},this.clearBuffer=()=>{e=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,t.length!==0&&this.setBuffer(t.pop())}}}const he=new WP;let fr,za;const oa=[],ku=new SE(()=>new vt);function jP(r,t,e,i,s,n){fr=ku.getPrimitive(),za=ku.getPrimitive(),oa.push(fr,za),he.setBuffer(r._roots[t]);const o=DI(0,r.geometry,e,i,s,n);he.clearBuffer(),ku.releasePrimitive(fr),ku.releasePrimitive(za),oa.pop(),oa.pop();const a=oa.length;return a>0&&(za=oa[a-1],fr=oa[a-2]),o}function DI(r,t,e,i,s=null,n=0,o=0){const{float32Array:a,uint16Array:c,uint32Array:l}=he;let h=r*2;if(bi(h,c)){const d=Ri(r,l),f=Wi(h,c);return ge(r,a,fr),i(d,f,!1,o,n+r,fr)}else{let d=function(R){const{uint16Array:O,uint32Array:y}=he;let U=R*2;for(;!bi(U,O);)R=ji(R),U=R*2;return Ri(R,y)},f=function(R){const{uint16Array:O,uint32Array:y}=he;let U=R*2;for(;!bi(U,O);)R=Xi(R,y),U=R*2;return Ri(R,y)+Wi(U,O)};const p=ji(r),m=Xi(r,l);let g=p,I=m,C,b,E,T;if(s&&(E=fr,T=za,ge(g,a,E),ge(I,a,T),C=s(E),b=s(T),b<C)){g=m,I=p;const R=C;C=b,b=R,E=T}E||(E=fr,ge(g,a,E));const A=bi(g*2,c),S=e(E,A,C,o+1,n+g);let _;if(S===xC){const R=d(g),y=f(g)-R;_=i(R,y,!0,o+1,n+g,E)}else _=S&&DI(g,t,e,i,s,n,o+1);if(_)return!0;T=za,ge(I,a,T);const w=bi(I*2,c),F=e(T,w,b,o+1,n+I);let D;if(F===xC){const R=d(I),y=f(I)-R;D=i(R,y,!0,o+1,n+I,T)}else D=F&&DI(I,t,e,i,s,n,o+1);return!!D}}const gl=new M,dm=new M;function XP(r,t,e={},i=0,s=1/0){const n=i*i,o=s*s;let a=1/0,c=null;if(r.shapecast({boundsTraverseOrder:h=>(gl.copy(t).clamp(h.min,h.max),gl.distanceToSquared(t)),intersectsBounds:(h,u,d)=>d<a&&d<o,intersectsTriangle:(h,u)=>{h.closestPointToPoint(t,gl);const d=t.distanceToSquared(gl);return d<a&&(dm.copy(gl),a=d,c=u),d<n}}),a===1/0)return null;const l=Math.sqrt(a);return e.point?e.point.copy(dm):e.point=dm.clone(),e.distance=l,e.faceIndex=c,e}const aa=new M,ca=new M,la=new M,Vu=new Ot,zu=new Ot,Yu=new Ot,DC=new M,UC=new M,BC=new M,Gu=new M;function ZP(r,t,e,i,s,n){let o;return n===Qg?o=r.intersectTriangle(i,e,t,!0,s):o=r.intersectTriangle(t,e,i,n!==Ps,s),o===null?null:{distance:r.origin.distanceTo(s),point:s.clone()}}function qP(r,t,e,i,s,n,o,a,c){aa.fromBufferAttribute(t,n),ca.fromBufferAttribute(t,o),la.fromBufferAttribute(t,a);const l=ZP(r,aa,ca,la,Gu,c);if(l){i&&(Vu.fromBufferAttribute(i,n),zu.fromBufferAttribute(i,o),Yu.fromBufferAttribute(i,a),l.uv=$e.getInterpolation(Gu,aa,ca,la,Vu,zu,Yu,new Ot)),s&&(Vu.fromBufferAttribute(s,n),zu.fromBufferAttribute(s,o),Yu.fromBufferAttribute(s,a),l.uv1=$e.getInterpolation(Gu,aa,ca,la,Vu,zu,Yu,new Ot)),e&&(DC.fromBufferAttribute(e,n),UC.fromBufferAttribute(e,o),BC.fromBufferAttribute(e,a),l.normal=$e.getInterpolation(Gu,aa,ca,la,DC,UC,BC,new M),l.normal.dot(r.direction)>0&&l.normal.multiplyScalar(-1));const h={a:n,b:o,c:a,normal:new M,materialIndex:0};$e.getNormal(aa,ca,la,h.normal),l.face=h,l.faceIndex=n}return l}function dp(r,t,e,i,s){const n=i*3;let o=n+0,a=n+1,c=n+2;const l=r.index;r.index&&(o=l.getX(o),a=l.getX(a),c=l.getX(c));const{position:h,normal:u,uv:d,uv1:f}=r.attributes,p=qP(e,h,u,d,f,o,a,c,t);return p?(p.faceIndex=i,s&&s.push(p),p):null}function xe(r,t,e,i){const s=r.a,n=r.b,o=r.c;let a=t,c=t+1,l=t+2;e&&(a=e.getX(a),c=e.getX(c),l=e.getX(l)),s.x=i.getX(a),s.y=i.getY(a),s.z=i.getZ(a),n.x=i.getX(c),n.y=i.getY(c),n.z=i.getZ(c),o.x=i.getX(l),o.y=i.getY(l),o.z=i.getZ(l)}function QP(r,t,e,i,s,n){const{geometry:o,_indirectBuffer:a}=r;for(let c=i,l=i+s;c<l;c++)dp(o,t,e,c,n)}function KP(r,t,e,i,s){const{geometry:n,_indirectBuffer:o}=r;let a=1/0,c=null;for(let l=i,h=i+s;l<h;l++){let u;u=dp(n,t,e,l),u&&u.distance<a&&(c=u,a=u.distance)}return c}function JP(r,t,e,i,s,n,o){const{geometry:a}=e,{index:c}=a,l=a.attributes.position;for(let h=r,u=t+r;h<u;h++){let d;if(d=h,xe(o,d*3,c,l),o.needsUpdate=!0,i(o,d,s,n))return!0}return!1}function t2(r,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=r.geometry,i=e.index?e.index.array:null,s=e.attributes.position;let n,o,a,c,l=0;const h=r._roots;for(let d=0,f=h.length;d<f;d++)n=h[d],o=new Uint32Array(n),a=new Uint16Array(n),c=new Float32Array(n),u(0,l),l+=n.byteLength;function u(d,f,p=!1){const m=d*2;if(a[m+15]===up){const I=o[d+6],C=a[m+14];let b=1/0,E=1/0,T=1/0,A=-1/0,S=-1/0,_=-1/0;for(let w=3*I,F=3*(I+C);w<F;w++){let D=i[w];const R=s.getX(D),O=s.getY(D),y=s.getZ(D);R<b&&(b=R),R>A&&(A=R),O<E&&(E=O),O>S&&(S=O),y<T&&(T=y),y>_&&(_=y)}return c[d+0]!==b||c[d+1]!==E||c[d+2]!==T||c[d+3]!==A||c[d+4]!==S||c[d+5]!==_?(c[d+0]=b,c[d+1]=E,c[d+2]=T,c[d+3]=A,c[d+4]=S,c[d+5]=_,!0):!1}else{const I=d+8,C=o[d+6],b=I+f,E=C+f;let T=p,A=!1,S=!1;t?T||(A=t.has(b),S=t.has(E),T=!A&&!S):(A=!0,S=!0);const _=T||A,w=T||S;let F=!1;_&&(F=u(I,f,T));let D=!1;w&&(D=u(C,f,T));const R=F||D;if(R)for(let O=0;O<3;O++){const y=I+O,U=C+O,H=c[y],k=c[y+3],X=c[U],$=c[U+3];c[d+O]=H<X?H:X,c[d+O+3]=k>$?k:$}return R}}}const kC=new vt;function Rr(r,t,e,i){return ge(r,t,kC),e.intersectBox(kC,i)}function e2(r,t,e,i,s,n){const{geometry:o,_indirectBuffer:a}=r;for(let c=i,l=i+s;c<l;c++){let h=a?a[c]:c;dp(o,t,e,h,n)}}function i2(r,t,e,i,s){const{geometry:n,_indirectBuffer:o}=r;let a=1/0,c=null;for(let l=i,h=i+s;l<h;l++){let u;u=dp(n,t,e,o?o[l]:l),u&&u.distance<a&&(c=u,a=u.distance)}return c}function s2(r,t,e,i,s,n,o){const{geometry:a}=e,{index:c}=a,l=a.attributes.position;for(let h=r,u=t+r;h<u;h++){let d;if(d=e.resolveTriangleIndex(h),xe(o,d*3,c,l),o.needsUpdate=!0,i(o,d,s,n))return!0}return!1}const VC=new M;function n2(r,t,e,i,s){he.setBuffer(r._roots[t]),UI(0,r,e,i,s),he.clearBuffer()}function UI(r,t,e,i,s){const{float32Array:n,uint16Array:o,uint32Array:a}=he,c=r*2;if(bi(c,o)){const h=Ri(r,a),u=Wi(c,o);QP(t,e,i,h,u,s)}else{const h=ji(r);Rr(h,n,i,VC)&&UI(h,t,e,i,s);const u=Xi(r,a);Rr(u,n,i,VC)&&UI(u,t,e,i,s)}}const zC=new M,r2=["x","y","z"];function o2(r,t,e,i){he.setBuffer(r._roots[t]);const s=BI(0,r,e,i);return he.clearBuffer(),s}function BI(r,t,e,i){const{float32Array:s,uint16Array:n,uint32Array:o}=he;let a=r*2;if(bi(a,n)){const l=Ri(r,o),h=Wi(a,n);return KP(t,e,i,l,h)}else{const l=Yv(r,o),h=r2[l],d=i.direction[h]>=0;let f,p;d?(f=ji(r),p=Xi(r,o)):(f=Xi(r,o),p=ji(r));const g=Rr(f,s,i,zC)?BI(f,t,e,i):null;if(g){const b=g.point[h];if(d?b<=s[p+l]:b>=s[p+l+3])return g}const C=Rr(p,s,i,zC)?BI(p,t,e,i):null;return g&&C?g.distance<=C.distance?g:C:g||C||null}}const Hu=new vt,ha=new Fs,ua=new Fs,El=new ht,YC=new li,$u=new li;function a2(r,t,e,i){he.setBuffer(r._roots[t]);const s=kI(0,r,e,i);return he.clearBuffer(),s}function kI(r,t,e,i,s=null){const{float32Array:n,uint16Array:o,uint32Array:a}=he;let c=r*2;if(s===null&&(e.boundingBox||e.computeBoundingBox(),YC.set(e.boundingBox.min,e.boundingBox.max,i),s=YC),bi(c,o)){const h=t.geometry,u=h.index,d=h.attributes.position,f=e.index,p=e.attributes.position,m=Ri(r,a),g=Wi(c,o);if(El.copy(i).invert(),e.boundsTree)return ge(r,n,$u),$u.matrix.copy(El),$u.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:C=>$u.intersectsBox(C),intersectsTriangle:C=>{C.a.applyMatrix4(i),C.b.applyMatrix4(i),C.c.applyMatrix4(i),C.needsUpdate=!0;for(let b=m*3,E=(g+m)*3;b<E;b+=3)if(xe(ua,b,u,d),ua.needsUpdate=!0,C.intersectsTriangle(ua))return!0;return!1}});for(let I=m*3,C=(g+m)*3;I<C;I+=3){xe(ha,I,u,d),ha.a.applyMatrix4(El),ha.b.applyMatrix4(El),ha.c.applyMatrix4(El),ha.needsUpdate=!0;for(let b=0,E=f.count;b<E;b+=3)if(xe(ua,b,f,p),ua.needsUpdate=!0,ha.intersectsTriangle(ua))return!0}}else{const h=r+8,u=a[r+6];return ge(h,n,Hu),!!(s.intersectsBox(Hu)&&kI(h,t,e,i,s)||(ge(u,n,Hu),s.intersectsBox(Hu)&&kI(u,t,e,i,s)))}}const Wu=new ht,fm=new li,Cl=new li,c2=new M,l2=new M,h2=new M,u2=new M;function d2(r,t,e,i={},s={},n=0,o=1/0){t.boundingBox||t.computeBoundingBox(),fm.set(t.boundingBox.min,t.boundingBox.max,e),fm.needsUpdate=!0;const a=r.geometry,c=a.attributes.position,l=a.index,h=t.attributes.position,u=t.index,d=$i.getPrimitive(),f=$i.getPrimitive();let p=c2,m=l2,g=null,I=null;s&&(g=h2,I=u2);let C=1/0,b=null,E=null;return Wu.copy(e).invert(),Cl.matrix.copy(Wu),r.shapecast({boundsTraverseOrder:T=>fm.distanceToBox(T),intersectsBounds:(T,A,S)=>S<C&&S<o?(A&&(Cl.min.copy(T.min),Cl.max.copy(T.max),Cl.needsUpdate=!0),!0):!1,intersectsRange:(T,A)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:_=>Cl.distanceToBox(_),intersectsBounds:(_,w,F)=>F<C&&F<o,intersectsRange:(_,w)=>{for(let F=_,D=_+w;F<D;F++){xe(f,3*F,u,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let R=T,O=T+A;R<O;R++){xe(d,3*R,l,c),d.needsUpdate=!0;const y=d.distanceToTriangle(f,p,g);if(y<C&&(m.copy(p),I&&I.copy(g),C=y,b=R,E=F),y<n)return!0}}}});{const S=Hc(t);for(let _=0,w=S;_<w;_++){xe(f,3*_,u,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let F=T,D=T+A;F<D;F++){xe(d,3*F,l,c),d.needsUpdate=!0;const R=d.distanceToTriangle(f,p,g);if(R<C&&(m.copy(p),I&&I.copy(g),C=R,b=F,E=_),R<n)return!0}}}}}),$i.releasePrimitive(d),$i.releasePrimitive(f),C===1/0?null:(i.point?i.point.copy(m):i.point=m.clone(),i.distance=C,i.faceIndex=b,s&&(s.point?s.point.copy(I):s.point=I.clone(),s.point.applyMatrix4(Wu),m.applyMatrix4(Wu),s.distance=m.sub(s.point).length(),s.faceIndex=E),i)}function f2(r,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=r.geometry,i=e.index?e.index.array:null,s=e.attributes.position;let n,o,a,c,l=0;const h=r._roots;for(let d=0,f=h.length;d<f;d++)n=h[d],o=new Uint32Array(n),a=new Uint16Array(n),c=new Float32Array(n),u(0,l),l+=n.byteLength;function u(d,f,p=!1){const m=d*2;if(a[m+15]===up){const I=o[d+6],C=a[m+14];let b=1/0,E=1/0,T=1/0,A=-1/0,S=-1/0,_=-1/0;for(let w=I,F=I+C;w<F;w++){const D=3*r.resolveTriangleIndex(w);for(let R=0;R<3;R++){let O=D+R;O=i?i[O]:O;const y=s.getX(O),U=s.getY(O),H=s.getZ(O);y<b&&(b=y),y>A&&(A=y),U<E&&(E=U),U>S&&(S=U),H<T&&(T=H),H>_&&(_=H)}}return c[d+0]!==b||c[d+1]!==E||c[d+2]!==T||c[d+3]!==A||c[d+4]!==S||c[d+5]!==_?(c[d+0]=b,c[d+1]=E,c[d+2]=T,c[d+3]=A,c[d+4]=S,c[d+5]=_,!0):!1}else{const I=d+8,C=o[d+6],b=I+f,E=C+f;let T=p,A=!1,S=!1;t?T||(A=t.has(b),S=t.has(E),T=!A&&!S):(A=!0,S=!0);const _=T||A,w=T||S;let F=!1;_&&(F=u(I,f,T));let D=!1;w&&(D=u(C,f,T));const R=F||D;if(R)for(let O=0;O<3;O++){const y=I+O,U=C+O,H=c[y],k=c[y+3],X=c[U],$=c[U+3];c[d+O]=H<X?H:X,c[d+O+3]=k>$?k:$}return R}}}const GC=new M;function p2(r,t,e,i,s){he.setBuffer(r._roots[t]),VI(0,r,e,i,s),he.clearBuffer()}function VI(r,t,e,i,s){const{float32Array:n,uint16Array:o,uint32Array:a}=he,c=r*2;if(bi(c,o)){const h=Ri(r,a),u=Wi(c,o);e2(t,e,i,h,u,s)}else{const h=ji(r);Rr(h,n,i,GC)&&VI(h,t,e,i,s);const u=Xi(r,a);Rr(u,n,i,GC)&&VI(u,t,e,i,s)}}const HC=new M,m2=["x","y","z"];function I2(r,t,e,i){he.setBuffer(r._roots[t]);const s=zI(0,r,e,i);return he.clearBuffer(),s}function zI(r,t,e,i){const{float32Array:s,uint16Array:n,uint32Array:o}=he;let a=r*2;if(bi(a,n)){const l=Ri(r,o),h=Wi(a,n);return i2(t,e,i,l,h)}else{const l=Yv(r,o),h=m2[l],d=i.direction[h]>=0;let f,p;d?(f=ji(r),p=Xi(r,o)):(f=Xi(r,o),p=ji(r));const g=Rr(f,s,i,HC)?zI(f,t,e,i):null;if(g){const b=g.point[h];if(d?b<=s[p+l]:b>=s[p+l+3])return g}const C=Rr(p,s,i,HC)?zI(p,t,e,i):null;return g&&C?g.distance<=C.distance?g:C:g||C||null}}const ju=new vt,da=new Fs,fa=new Fs,bl=new ht,$C=new li,Xu=new li;function g2(r,t,e,i){he.setBuffer(r._roots[t]);const s=YI(0,r,e,i);return he.clearBuffer(),s}function YI(r,t,e,i,s=null){const{float32Array:n,uint16Array:o,uint32Array:a}=he;let c=r*2;if(s===null&&(e.boundingBox||e.computeBoundingBox(),$C.set(e.boundingBox.min,e.boundingBox.max,i),s=$C),bi(c,o)){const h=t.geometry,u=h.index,d=h.attributes.position,f=e.index,p=e.attributes.position,m=Ri(r,a),g=Wi(c,o);if(bl.copy(i).invert(),e.boundsTree)return ge(r,n,Xu),Xu.matrix.copy(bl),Xu.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:C=>Xu.intersectsBox(C),intersectsTriangle:C=>{C.a.applyMatrix4(i),C.b.applyMatrix4(i),C.c.applyMatrix4(i),C.needsUpdate=!0;for(let b=m,E=g+m;b<E;b++)if(xe(fa,3*t.resolveTriangleIndex(b),u,d),fa.needsUpdate=!0,C.intersectsTriangle(fa))return!0;return!1}});for(let I=m,C=g+m;I<C;I++){const b=t.resolveTriangleIndex(I);xe(da,3*b,u,d),da.a.applyMatrix4(bl),da.b.applyMatrix4(bl),da.c.applyMatrix4(bl),da.needsUpdate=!0;for(let E=0,T=f.count;E<T;E+=3)if(xe(fa,E,f,p),fa.needsUpdate=!0,da.intersectsTriangle(fa))return!0}}else{const h=r+8,u=a[r+6];return ge(h,n,ju),!!(s.intersectsBox(ju)&&YI(h,t,e,i,s)||(ge(u,n,ju),s.intersectsBox(ju)&&YI(u,t,e,i,s)))}}const Zu=new ht,pm=new li,Tl=new li,E2=new M,C2=new M,b2=new M,T2=new M;function y2(r,t,e,i={},s={},n=0,o=1/0){t.boundingBox||t.computeBoundingBox(),pm.set(t.boundingBox.min,t.boundingBox.max,e),pm.needsUpdate=!0;const a=r.geometry,c=a.attributes.position,l=a.index,h=t.attributes.position,u=t.index,d=$i.getPrimitive(),f=$i.getPrimitive();let p=E2,m=C2,g=null,I=null;s&&(g=b2,I=T2);let C=1/0,b=null,E=null;return Zu.copy(e).invert(),Tl.matrix.copy(Zu),r.shapecast({boundsTraverseOrder:T=>pm.distanceToBox(T),intersectsBounds:(T,A,S)=>S<C&&S<o?(A&&(Tl.min.copy(T.min),Tl.max.copy(T.max),Tl.needsUpdate=!0),!0):!1,intersectsRange:(T,A)=>{if(t.boundsTree){const S=t.boundsTree;return S.shapecast({boundsTraverseOrder:_=>Tl.distanceToBox(_),intersectsBounds:(_,w,F)=>F<C&&F<o,intersectsRange:(_,w)=>{for(let F=_,D=_+w;F<D;F++){const R=S.resolveTriangleIndex(F);xe(f,3*R,u,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let O=T,y=T+A;O<y;O++){const U=r.resolveTriangleIndex(O);xe(d,3*U,l,c),d.needsUpdate=!0;const H=d.distanceToTriangle(f,p,g);if(H<C&&(m.copy(p),I&&I.copy(g),C=H,b=O,E=F),H<n)return!0}}}})}else{const S=Hc(t);for(let _=0,w=S;_<w;_++){xe(f,3*_,u,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let F=T,D=T+A;F<D;F++){const R=r.resolveTriangleIndex(F);xe(d,3*R,l,c),d.needsUpdate=!0;const O=d.distanceToTriangle(f,p,g);if(O<C&&(m.copy(p),I&&I.copy(g),C=O,b=F,E=_),O<n)return!0}}}}}),$i.releasePrimitive(d),$i.releasePrimitive(f),C===1/0?null:(i.point?i.point.copy(m):i.point=m.clone(),i.distance=C,i.faceIndex=b,s&&(s.point?s.point.copy(I):s.point=I.clone(),s.point.applyMatrix4(Zu),m.applyMatrix4(Zu),s.distance=m.sub(s.point).length(),s.faceIndex=E),i)}function v2(){return typeof SharedArrayBuffer<"u"}const ch=new he.constructor,Sf=new he.constructor,nr=new SE(()=>new vt),pa=new vt,ma=new vt,mm=new vt,Im=new vt;let gm=!1;function R2(r,t,e,i){if(gm)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");gm=!0;const s=r._roots,n=t._roots;let o,a=0,c=0;const l=new ht().copy(e).invert();for(let h=0,u=s.length;h<u;h++){ch.setBuffer(s[h]),c=0;const d=nr.getPrimitive();ge(0,ch.float32Array,d),d.applyMatrix4(l);for(let f=0,p=n.length;f<p&&(Sf.setBuffer(n[h]),o=bs(0,0,e,l,i,a,c,0,0,d),Sf.clearBuffer(),c+=n[f].length,!o);f++);if(nr.releasePrimitive(d),ch.clearBuffer(),a+=s[h].length,o)break}return gm=!1,o}function bs(r,t,e,i,s,n=0,o=0,a=0,c=0,l=null,h=!1){let u,d;h?(u=Sf,d=ch):(u=ch,d=Sf);const f=u.float32Array,p=u.uint32Array,m=u.uint16Array,g=d.float32Array,I=d.uint32Array,C=d.uint16Array,b=r*2,E=t*2,T=bi(b,m),A=bi(E,C);let S=!1;if(A&&T)h?S=s(Ri(t,I),Wi(t*2,C),Ri(r,p),Wi(r*2,m),c,o+t,a,n+r):S=s(Ri(r,p),Wi(r*2,m),Ri(t,I),Wi(t*2,C),a,n+r,c,o+t);else if(A){const _=nr.getPrimitive();ge(t,g,_),_.applyMatrix4(e);const w=ji(r),F=Xi(r,p);ge(w,f,pa),ge(F,f,ma);const D=_.intersectsBox(pa),R=_.intersectsBox(ma);S=D&&bs(t,w,i,e,s,o,n,c,a+1,_,!h)||R&&bs(t,F,i,e,s,o,n,c,a+1,_,!h),nr.releasePrimitive(_)}else{const _=ji(t),w=Xi(t,I);ge(_,g,mm),ge(w,g,Im);const F=l.intersectsBox(mm),D=l.intersectsBox(Im);if(F&&D)S=bs(r,_,e,i,s,n,o,a,c+1,l,h)||bs(r,w,e,i,s,n,o,a,c+1,l,h);else if(F)if(T)S=bs(r,_,e,i,s,n,o,a,c+1,l,h);else{const R=nr.getPrimitive();R.copy(mm).applyMatrix4(e);const O=ji(r),y=Xi(r,p);ge(O,f,pa),ge(y,f,ma);const U=R.intersectsBox(pa),H=R.intersectsBox(ma);S=U&&bs(_,O,i,e,s,o,n,c,a+1,R,!h)||H&&bs(_,y,i,e,s,o,n,c,a+1,R,!h),nr.releasePrimitive(R)}else if(D)if(T)S=bs(r,w,e,i,s,n,o,a,c+1,l,h);else{const R=nr.getPrimitive();R.copy(Im).applyMatrix4(e);const O=ji(r),y=Xi(r,p);ge(O,f,pa),ge(y,f,ma);const U=R.intersectsBox(pa),H=R.intersectsBox(ma);S=U&&bs(w,O,i,e,s,o,n,c,a+1,R,!h)||H&&bs(w,y,i,e,s,o,n,c,a+1,R,!h),nr.releasePrimitive(R)}}return S}const qu=new li,WC=new vt;class wE{static serialize(t,e={}){e={cloneBuffers:!0,...e};const i=t.geometry,s=t._roots,n=t._indirectBuffer,o=i.getIndex();let a;return e.cloneBuffers?a={roots:s.map(c=>c.slice()),index:o.array.slice(),indirectBuffer:n?n.slice():null}:a={roots:s,index:o.array,indirectBuffer:n},a}static deserialize(t,e,i={}){i={setIndex:!0,indirect:!!t.indirectBuffer,...i};const{index:s,roots:n,indirectBuffer:o}=t,a=new wE(e,{...i,[lm]:!0});if(a._roots=n,a._indirectBuffer=o||null,i.setIndex){const c=e.getIndex();if(c===null){const l=new Kt(t.index,1,!1);e.setIndex(l)}else c.array!==s&&(c.array.set(s),c.needsUpdate=!0)}return a}get indirect(){return!!this._indirectBuffer}constructor(t,e={}){if(t.isBufferGeometry){if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e=Object.assign({strategy:kv,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,[lm]:!1},e),e.useSharedArrayBuffer&&!v2())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=t,this._roots=null,this._indirectBuffer=null,e[lm]||(zP(this,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new vt)));const{_indirectBuffer:i}=this;this.resolveTriangleIndex=e.indirect?s=>i[s]:s=>s}refit(t=null){return(this.indirect?f2:t2)(this,t)}traverse(t,e=0){const i=this._roots[e],s=new Uint32Array(i),n=new Uint16Array(i);o(0);function o(a,c=0){const l=a*2,h=n[l+15]===up;if(h){const u=s[a+6],d=n[l+14];t(c,h,new Float32Array(i,a*4,6),u,d)}else{const u=a+Kd/4,d=s[a+6],f=s[a+7];t(c,h,new Float32Array(i,a*4,6),f)||(o(u,c+1),o(d,c+1))}}}raycast(t,e=qa){const i=this._roots,s=this.geometry,n=[],o=e.isMaterial,a=Array.isArray(e),c=s.groups,l=o?e.side:e,h=this.indirect?p2:n2;for(let u=0,d=i.length;u<d;u++){const f=a?e[c[u].materialIndex].side:l,p=n.length;if(h(this,u,f,t,n),a){const m=c[u].materialIndex;for(let g=p,I=n.length;g<I;g++)n[g].face.materialIndex=m}}return n}raycastFirst(t,e=qa){const i=this._roots,s=this.geometry,n=e.isMaterial,o=Array.isArray(e);let a=null;const c=s.groups,l=n?e.side:e,h=this.indirect?I2:o2;for(let u=0,d=i.length;u<d;u++){const f=o?e[c[u].materialIndex].side:l,p=h(this,u,f,t);p!=null&&(a==null||p.distance<a.distance)&&(a=p,o&&(p.face.materialIndex=c[u].materialIndex))}return a}intersectsGeometry(t,e){let i=!1;const s=this._roots,n=this.indirect?g2:a2;for(let o=0,a=s.length;o<a&&(i=n(this,o,t,e),!i);o++);return i}shapecast(t){const e=$i.getPrimitive(),i=this.indirect?s2:JP;let{boundsTraverseOrder:s,intersectsBounds:n,intersectsRange:o,intersectsTriangle:a}=t;if(o&&a){const u=o;o=(d,f,p,m,g)=>u(d,f,p,m,g)?!0:i(d,f,this,a,p,m,e)}else o||(a?o=(u,d,f,p)=>i(u,d,this,a,f,p,e):o=(u,d,f)=>f);let c=!1,l=0;const h=this._roots;for(let u=0,d=h.length;u<d;u++){const f=h[u];if(c=jP(this,u,n,o,s,l),c)break;l+=f.byteLength}return $i.releasePrimitive(e),c}bvhcast(t,e,i){let{intersectsRanges:s,intersectsTriangles:n}=i;const o=$i.getPrimitive(),a=this.geometry.index,c=this.geometry.attributes.position,l=this.indirect?p=>{const m=this.resolveTriangleIndex(p);xe(o,m*3,a,c)}:p=>{xe(o,p*3,a,c)},h=$i.getPrimitive(),u=t.geometry.index,d=t.geometry.attributes.position,f=t.indirect?p=>{const m=t.resolveTriangleIndex(p);xe(h,m*3,u,d)}:p=>{xe(h,p*3,u,d)};if(n){const p=(m,g,I,C,b,E,T,A)=>{for(let S=I,_=I+C;S<_;S++){f(S),h.a.applyMatrix4(e),h.b.applyMatrix4(e),h.c.applyMatrix4(e),h.needsUpdate=!0;for(let w=m,F=m+g;w<F;w++)if(l(w),o.needsUpdate=!0,n(o,h,w,S,b,E,T,A))return!0}return!1};if(s){const m=s;s=function(g,I,C,b,E,T,A,S){return m(g,I,C,b,E,T,A,S)?!0:p(g,I,C,b,E,T,A,S)}}else s=p}return R2(this,t,e,s)}intersectsBox(t,e){return qu.set(t.min,t.max,e),qu.needsUpdate=!0,this.shapecast({intersectsBounds:i=>qu.intersectsBox(i),intersectsTriangle:i=>qu.intersectsTriangle(i)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,i={},s={},n=0,o=1/0){return(this.indirect?y2:d2)(this,t,e,i,s,n,o)}closestPointToPoint(t,e={},i=0,s=1/0){return XP(this,t,e,i,s)}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach(i=>{ge(0,new Float32Array(i),WC),t.union(WC)}),t}}function jC(r,t,e){return r===null||(r.point.applyMatrix4(t.matrixWorld),r.distance=r.point.distanceTo(e.ray.origin),r.object=t,r.distance<e.near||r.distance>e.far)?null:r}const Em=new qg,XC=new ht,A2=it.prototype.raycast;function S2(r,t){if(this.geometry.boundsTree){if(this.material===void 0)return;XC.copy(this.matrixWorld).invert(),Em.copy(r.ray).applyMatrix4(XC);const e=this.geometry.boundsTree;if(r.firstHitOnly===!0){const i=jC(e.raycastFirst(Em,this.material),this,r);i&&t.push(i)}else{const i=e.raycast(Em,this.material);for(let s=0,n=i.length;s<n;s++){const o=jC(i[s],this,r);o&&t.push(o)}}}else A2.call(this,r,t)}function w2(r){return this.boundsTree=new wE(this,r),this.boundsTree}function _2(){this.boundsTree=null}let It=class{constructor(){L(this,"enabled",!0),L(this,"trigger",t=>{if(!this.enabled)return;const e=this.handlers.slice(0);for(const i of e)i(t)}),L(this,"handlers",[])}add(t){this.handlers.push(t)}remove(t){this.handlers=this.handlers.filter(e=>e!==t)}reset(){this.handlers.length=0}};class pr{constructor(){L(this,"enabled",!0),L(this,"trigger",async t=>{if(!this.enabled)return;const e=this.handlers.slice(0);for(const i of e)await i(t)}),L(this,"handlers",[])}add(t){this.handlers.push(t)}remove(t){this.handlers=this.handlers.filter(e=>e!==t)}reset(){this.handlers.length=0}}class _E{constructor(t){L(this,"isDisposeable",()=>"dispose"in this&&"onDisposed"in this),L(this,"isResizeable",()=>"resize"in this&&"getSize"in this),L(this,"isUpdateable",()=>"onAfterUpdate"in this&&"onBeforeUpdate"in this&&"update"in this),L(this,"isHideable",()=>"visible"in this),L(this,"isConfigurable",()=>"setup"in this&&"config"in this&&"onSetup"in this),this.components=t}}class oe extends _E{}class Gv extends _E{constructor(t){super(t),L(this,"worlds",new Map),L(this,"onWorldChanged",new It),L(this,"currentWorld",null),this.onWorldChanged.add(({world:e,action:i})=>{i==="removed"&&this.worlds.delete(e.uuid)})}}class F2 extends Gv{constructor(){super(...arguments),L(this,"hasCameraControls",()=>"controls"in this)}}const Hv=class GI extends oe{constructor(t){super(t),L(this,"_disposedComponents",new Set),L(this,"enabled",!0),t.add(GI.uuid,this)}get(){return this._disposedComponents}destroy(t,e=!0,i=!0){t.removeFromParent();const s=t;s.dispose&&s.dispose(),this.disposeGeometryAndMaterials(t,e),i&&s.children&&s.children.length&&this.disposeChildren(s),t.children.length=0}disposeGeometry(t){t.boundsTree&&t.disposeBoundsTree&&t.disposeBoundsTree(),t.dispose()}disposeGeometryAndMaterials(t,e){const i=t;i.geometry&&this.disposeGeometry(i.geometry),e&&i.material&&GI.disposeMaterial(i),i.material=[],i.geometry=null}disposeChildren(t){for(const e of t.children)this.destroy(e)}static disposeMaterial(t){if(t.material)if(Array.isArray(t.material))for(const e of t.material)e.dispose();else t.material.dispose()}};L(Hv,"uuid","76e9cd8e-ad8f-4753-9ef6-cbc60f7247fe");let ac=Hv;class O2 extends Gv{constructor(t){super(t),L(this,"onDisposed",new It),L(this,"directionalLights",new Map),L(this,"ambientLights",new Map)}dispose(){const t=this.components.get(ac);for(const e of this.three.children){const i=e;i.geometry&&t.destroy(i)}this.deleteAllLights(),this.three.children=[],this.onDisposed.trigger(),this.onDisposed.reset()}deleteAllLights(){for(const[,t]of this.directionalLights)t.removeFromParent(),t.target.removeFromParent(),t.dispose();this.directionalLights.clear();for(const[,t]of this.ambientLights)t.removeFromParent(),t.dispose();this.ambientLights.clear()}}class Ir extends Set{constructor(t){super(t),L(this,"onItemAdded",new It),L(this,"onItemDeleted",new It),L(this,"onCleared",new It),L(this,"guard",()=>!0)}clear(){super.clear(),this.onCleared.trigger()}add(...t){for(const e of t)this.has(e)||!this.guard(e)||(super.add(e),this.onItemAdded||(this.onItemAdded=new It),this.onItemAdded.trigger(e));return this}delete(t){const e=super.delete(t);return e&&this.onItemDeleted.trigger(),e}dispose(){this.clear(),this.onItemAdded.reset(),this.onItemDeleted.reset(),this.onCleared.reset()}}class Os extends Map{constructor(t){super(t),L(this,"onItemSet",new It),L(this,"onItemUpdated",new It),L(this,"onItemDeleted",new It),L(this,"onCleared",new It),L(this,"guard",()=>!0)}clear(){super.clear(),this.onCleared.trigger()}set(t,e){const i=this.has(t);if(!(this.guard??(()=>!0))(t,e))return this;const o=super.set(t,e);return i?(this.onItemUpdated||(this.onItemUpdated=new It),this.onItemUpdated.trigger({key:t,value:e})):(this.onItemSet||(this.onItemSet=new It),this.onItemSet.trigger({key:t,value:e})),o}delete(t){const e=super.delete(t);return e&&this.onItemDeleted.trigger(t),e}dispose(){this.clear(),this.onItemSet.reset(),this.onItemDeleted.reset(),this.onCleared.reset()}}class Cm{static isEntry(t){return new Set(["Boolean","Color","Text","Number","Select","Vector3","TextSet","None"]).has(t.type)}static copySchema(t,e={}){for(const i in t){const s=t[i];this.isEntry(s)?e[i]=this.copyEntry(s):(e[i]={},this.copySchema(s,e[i]))}return e}static copyEntry(t){if(t.type==="Boolean"){const e=t;return{type:e.type,value:e.value}}if(t.type==="Color"){const e=t;return{type:e.type,value:e.value.clone()}}if(t.type==="Text"){const e=t;return{type:e.type,value:e.value}}if(t.type==="Number"){const e=t;return{type:e.type,value:e.value,min:e.min,max:e.max,interpolable:e.interpolable}}if(t.type==="Select"){const e=t;return{type:e.type,value:e.value,multiple:e.multiple,options:new Set(e.options)}}if(t.type==="Vector3"){const e=t;return{type:e.type,value:e.value.clone()}}if(t.type==="TextSet"){const e=t;return{type:e.type,value:new Set(e.value)}}if(t.type==="None"){const e=t;return{type:e.type,value:e.value}}throw new Error("Invalid entry!")}}const Jd=0,x2=1,N2=new M,ZC=new Vt,bm=new Qe,qC=new M,Qu=new $e;class P2{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new QC,this.unassigned=new QC,this.vertices=[]}setFromPoints(t){if(t.length>=4){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.vertices.push(new L2(t[e]));this.compute()}return this}setFromObject(t){const e=[];return t.updateMatrixWorld(!0),t.traverse(function(i){const s=i.geometry;if(s!==void 0){const n=s.attributes.position;if(n!==void 0)for(let o=0,a=n.count;o<a;o++){const c=new M;c.fromBufferAttribute(n,o).applyMatrix4(i.matrixWorld),e.push(c)}}}),this.setFromPoints(e)}containsPoint(t){const e=this.faces;for(let i=0,s=e.length;i<s;i++)if(e[i].distanceToPoint(t)>this.tolerance)return!1;return!0}intersectRay(t,e){const i=this.faces;let s=-1/0,n=1/0;for(let o=0,a=i.length;o<a;o++){const c=i[o],l=c.distanceToPoint(t.origin),h=c.normal.dot(t.direction);if(l>0&&h>=0)return null;const u=h!==0?-l/h:0;if(!(u<=0)&&(h>0?n=Math.min(u,n):s=Math.max(u,s),s>n))return null}return s!==-1/0?t.at(s,e):t.at(n,e),e}intersectsRay(t){return this.intersectRay(t,N2)!==null}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(t,e){return t.face=e,e.outside===null?this.assigned.append(t):this.assigned.insertBefore(e.outside,t),e.outside=t,this}removeVertexFromFace(t,e){return t===e.outside&&(t.next!==null&&t.next.face===e?e.outside=t.next:e.outside=null),this.assigned.remove(t),this}removeAllVerticesFromFace(t){if(t.outside!==null){const e=t.outside;let i=t.outside;for(;i.next!==null&&i.next.face===t;)i=i.next;return this.assigned.removeSubList(e,i),e.prev=i.next=null,t.outside=null,e}}deleteFaceVertices(t,e){const i=this.removeAllVerticesFromFace(t);if(i!==void 0)if(e===void 0)this.unassigned.appendChain(i);else{let s=i;do{const n=s.next;e.distanceToPoint(s.point)>this.tolerance?this.addVertexToFace(s,e):this.unassigned.append(s),s=n}while(s!==null)}return this}resolveUnassignedPoints(t){if(this.unassigned.isEmpty()===!1){let e=this.unassigned.first();do{const i=e.next;let s=this.tolerance,n=null;for(let o=0;o<t.length;o++){const a=t[o];if(a.mark===Jd){const c=a.distanceToPoint(e.point);if(c>s&&(s=c,n=a),s>1e3*this.tolerance)break}}n!==null&&this.addVertexToFace(e,n),e=i}while(e!==null)}return this}computeExtremes(){const t=new M,e=new M,i=[],s=[];for(let n=0;n<3;n++)i[n]=s[n]=this.vertices[0];t.copy(this.vertices[0].point),e.copy(this.vertices[0].point);for(let n=0,o=this.vertices.length;n<o;n++){const a=this.vertices[n],c=a.point;for(let l=0;l<3;l++)c.getComponent(l)<t.getComponent(l)&&(t.setComponent(l,c.getComponent(l)),i[l]=a);for(let l=0;l<3;l++)c.getComponent(l)>e.getComponent(l)&&(e.setComponent(l,c.getComponent(l)),s[l]=a)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(t.x),Math.abs(e.x))+Math.max(Math.abs(t.y),Math.abs(e.y))+Math.max(Math.abs(t.z),Math.abs(e.z))),{min:i,max:s}}computeInitialHull(){const t=this.vertices,e=this.computeExtremes(),i=e.min,s=e.max;let n=0,o=0;for(let d=0;d<3;d++){const f=s[d].point.getComponent(d)-i[d].point.getComponent(d);f>n&&(n=f,o=d)}const a=i[o],c=s[o];let l,h;n=0,ZC.set(a.point,c.point);for(let d=0,f=this.vertices.length;d<f;d++){const p=t[d];if(p!==a&&p!==c){ZC.closestPointToPoint(p.point,!0,qC);const m=qC.distanceToSquared(p.point);m>n&&(n=m,l=p)}}n=-1,bm.setFromCoplanarPoints(a.point,c.point,l.point);for(let d=0,f=this.vertices.length;d<f;d++){const p=t[d];if(p!==a&&p!==c&&p!==l){const m=Math.abs(bm.distanceToPoint(p.point));m>n&&(n=m,h=p)}}const u=[];if(bm.distanceToPoint(h.point)<0){u.push(Rs.create(a,c,l),Rs.create(h,c,a),Rs.create(h,l,c),Rs.create(h,a,l));for(let d=0;d<3;d++){const f=(d+1)%3;u[d+1].getEdge(2).setTwin(u[0].getEdge(f)),u[d+1].getEdge(1).setTwin(u[f+1].getEdge(0))}}else{u.push(Rs.create(a,l,c),Rs.create(h,a,c),Rs.create(h,c,l),Rs.create(h,l,a));for(let d=0;d<3;d++){const f=(d+1)%3;u[d+1].getEdge(2).setTwin(u[0].getEdge((3-d)%3)),u[d+1].getEdge(0).setTwin(u[f+1].getEdge(1))}}for(let d=0;d<4;d++)this.faces.push(u[d]);for(let d=0,f=t.length;d<f;d++){const p=t[d];if(p!==a&&p!==c&&p!==l&&p!==h){n=this.tolerance;let m=null;for(let g=0;g<4;g++){const I=this.faces[g].distanceToPoint(p.point);I>n&&(n=I,m=this.faces[g])}m!==null&&this.addVertexToFace(p,m)}}return this}reindexFaces(){const t=[];for(let e=0;e<this.faces.length;e++){const i=this.faces[e];i.mark===Jd&&t.push(i)}return this.faces=t,this}nextVertexToAdd(){if(this.assigned.isEmpty()===!1){let t,e=0;const i=this.assigned.first().face;let s=i.outside;do{const n=i.distanceToPoint(s.point);n>e&&(e=n,t=s),s=s.next}while(s!==null&&s.face===i);return t}}computeHorizon(t,e,i,s){this.deleteFaceVertices(i),i.mark=x2;let n;e===null?n=e=i.getEdge(0):n=e.next;do{const o=n.twin,a=o.face;a.mark===Jd&&(a.distanceToPoint(t)>this.tolerance?this.computeHorizon(t,o,a,s):s.push(n)),n=n.next}while(n!==e);return this}addAdjoiningFace(t,e){const i=Rs.create(t,e.tail(),e.head());return this.faces.push(i),i.getEdge(-1).setTwin(e.twin),i.getEdge(0)}addNewFaces(t,e){this.newFaces=[];let i=null,s=null;for(let n=0;n<e.length;n++){const o=e[n],a=this.addAdjoiningFace(t,o);i===null?i=a:a.next.setTwin(s),this.newFaces.push(a.face),s=a}return i.next.setTwin(s),this}addVertexToHull(t){const e=[];return this.unassigned.clear(),this.removeVertexFromFace(t,t.face),this.computeHorizon(t.point,null,t.face,e),this.addNewFaces(t,e),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let t;for(this.computeInitialHull();(t=this.nextVertexToAdd())!==void 0;)this.addVertexToHull(t);return this.reindexFaces(),this.cleanup(),this}}class Rs{constructor(){this.normal=new M,this.midpoint=new M,this.area=0,this.constant=0,this.outside=null,this.mark=Jd,this.edge=null}static create(t,e,i){const s=new Rs,n=new Tm(t,s),o=new Tm(e,s),a=new Tm(i,s);return n.next=a.prev=o,o.next=n.prev=a,a.next=o.prev=n,s.edge=n,s.compute()}getEdge(t){let e=this.edge;for(;t>0;)e=e.next,t--;for(;t<0;)e=e.prev,t++;return e}compute(){const t=this.edge.tail(),e=this.edge.head(),i=this.edge.next.head();return Qu.set(t.point,e.point,i.point),Qu.getNormal(this.normal),Qu.getMidpoint(this.midpoint),this.area=Qu.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(t){return this.normal.dot(t)-this.constant}}class Tm{constructor(t,e){this.vertex=t,this.prev=null,this.next=null,this.twin=null,this.face=e}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const t=this.head(),e=this.tail();return e!==null?e.point.distanceTo(t.point):-1}lengthSquared(){const t=this.head(),e=this.tail();return e!==null?e.point.distanceToSquared(t.point):-1}setTwin(t){return this.twin=t,t.twin=this,this}}class L2{constructor(t){this.point=t,this.prev=null,this.next=null,this.face=null}}class QC{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(t,e){return e.prev=t.prev,e.next=t,e.prev===null?this.head=e:e.prev.next=e,t.prev=e,this}insertAfter(t,e){return e.prev=t,e.next=t.next,e.next===null?this.tail=e:e.next.prev=e,t.next=e,this}append(t){return this.head===null?this.head=t:this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t,this}appendChain(t){for(this.head===null?this.head=t:this.tail.next=t,t.prev=this.tail;t.next!==null;)t=t.next;return this.tail=t,this}remove(t){return t.prev===null?this.head=t.next:t.prev.next=t.next,t.next===null?this.tail=t.prev:t.next.prev=t.prev,this}removeSubList(t,e){return t.prev===null?this.head=e.next:t.prev.next=e.next,e.next===null?this.tail=t.prev:e.next.prev=t.prev,this}isEmpty(){return this.head===null}}const HI=[2,2,1],$I=[1,0,0];function Ws(r,t){return r*3+t}function M2(r){const t=r.elements;let e=0;for(let i=0;i<9;i++)e+=t[i]*t[i];return Math.sqrt(e)}function D2(r){const t=r.elements;let e=0;for(let i=0;i<3;i++){const s=t[Ws(HI[i],$I[i])];e+=2*s*s}return Math.sqrt(e)}function U2(r,t){let e=0,i=1;const s=r.elements;for(let l=0;l<3;l++){const h=Math.abs(s[Ws(HI[l],$I[l])]);h>e&&(e=h,i=l)}let n=1,o=0;const a=$I[i],c=HI[i];if(Math.abs(s[Ws(c,a)])>Number.EPSILON){const l=s[Ws(c,c)],h=s[Ws(a,a)],u=s[Ws(c,a)],d=(l-h)/2/u;let f;d<0?f=-1/(-d+Math.sqrt(1+d*d)):f=1/(d+Math.sqrt(1+d*d)),n=1/Math.sqrt(1+f*f),o=f*n}return t.identity(),t.elements[Ws(a,a)]=n,t.elements[Ws(c,c)]=n,t.elements[Ws(c,a)]=o,t.elements[Ws(a,c)]=-o,t}function B2(r,t){let e=0,i=0;const s=10;t.unitary.identity(),t.diagonal.copy(r);const n=t.unitary,o=t.diagonal,a=new fi,c=new fi,l=Number.EPSILON*M2(o);for(;i<s&&D2(o)>l;)U2(o,a),c.copy(a).transpose(),o.multiply(a),o.premultiply(c),n.multiply(a),++e>2&&(i++,e=0);return t}function k2(r){const t=[];for(let lt=0;lt<r.length-2;lt+=3){const pt=r[lt],mt=r[lt+1],yt=r[lt+2];t.push(new M(pt,mt,yt))}const e=new P2;e.setFromPoints(t);const i={unitary:new fi,diagonal:new fi},s=e.faces,n=[],o=[];for(let lt=0,pt=s.length;lt<pt;lt++){const mt=s[lt];let yt=mt.edge;n.length=0;do n.push(yt),yt=yt.next;while(yt!==mt.edge);const zt=n.length-2;for(let Lt=1,v=zt;Lt<=v;Lt++){const j=n[0].vertex,W=n[Lt+0].vertex,N=n[Lt+1].vertex;o.push(j.point.x,j.point.y,j.point.z),o.push(W.point.x,W.point.y,W.point.z),o.push(N.point.x,N.point.y,N.point.z)}}const a=new M,c=new M,l=new M,h=new M,u=new M,d=new M,f=new M,p=new M;let m=0,g=0,I=0,C=0,b=0,E=0,T=0;for(let lt=0,pt=o.length;lt<pt;lt+=9){a.fromArray(o,lt),c.fromArray(o,lt+3),l.fromArray(o,lt+6),f.set(0,0,0),f.add(a).add(c).add(l).divideScalar(3),h.subVectors(c,a),u.subVectors(l,a);const mt=d.crossVectors(h,u).length()/2;p.add(d.copy(f).multiplyScalar(mt)),m+=mt,g+=(9*f.x*f.x+a.x*a.x+c.x*c.x+l.x*l.x)*(mt/12),I+=(9*f.x*f.y+a.x*a.y+c.x*c.y+l.x*l.y)*(mt/12),C+=(9*f.x*f.z+a.x*a.z+c.x*c.z+l.x*l.z)*(mt/12),b+=(9*f.y*f.y+a.y*a.y+c.y*c.y+l.y*l.y)*(mt/12),E+=(9*f.y*f.z+a.y*a.z+c.y*c.z+l.y*l.z)*(mt/12),T+=(9*f.z*f.z+a.z*a.z+c.z*c.z+l.z*l.z)*(mt/12)}p.divideScalar(m),g/=m,I/=m,C/=m,b/=m,E/=m,T/=m,g-=p.x*p.x,I-=p.x*p.y,C-=p.x*p.z,b-=p.y*p.y,E-=p.y*p.z,T-=p.z*p.z;const A=new fi;A.elements[0]=g,A.elements[1]=I,A.elements[2]=C,A.elements[3]=I,A.elements[4]=b,A.elements[5]=E,A.elements[6]=C,A.elements[7]=E,A.elements[8]=T,B2(A,i);const S=i.unitary,_=new M,w=new M,F=new M;S.extractBasis(_,w,F);let D=-1/0,R=-1/0,O=-1/0,y=1/0,U=1/0,H=1/0;for(let lt=0,pt=t.length;lt<pt;lt++){const mt=t[lt];D=Math.max(_.dot(mt),D),R=Math.max(w.dot(mt),R),O=Math.max(F.dot(mt),O),y=Math.min(_.dot(mt),y),U=Math.min(w.dot(mt),U),H=Math.min(F.dot(mt),H)}_.multiplyScalar(.5*(y+D)),w.multiplyScalar(.5*(U+R)),F.multiplyScalar(.5*(H+O));const k=new M,X=new M,$=new fi;k.add(_).add(w).add(F),X.x=D-y,X.y=R-U,X.z=O-H,X.multiplyScalar(.5),$.copy(S);const{x:et,y:Y,z}=X,st=new ht;st.makeScale(et*2,Y*2,z*2);const K=new ht;K.makeTranslation(-et,-Y,-z);const Q=new ht;Q.makeTranslation(k.x,k.y,k.z);const gt=new ht;gt.setFromMatrix3($);const Ct=new ht;return Ct.multiply(Q),Ct.multiply(gt),Ct.multiply(K),Ct.multiply(st),{center:k,halfSizes:X,rotation:$,transformation:Ct}}class KC{static isTransparent(t){return t.transparent&&t.opacity<1}}const FE=class ze{static create(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,s=Math.random()*4294967295|0;return`${ze._lut[t&255]+ze._lut[t>>8&255]+ze._lut[t>>16&255]+ze._lut[t>>24&255]}-${ze._lut[e&255]}${ze._lut[e>>8&255]}-${ze._lut[e>>16&15|64]}${ze._lut[e>>24&255]}-${ze._lut[i&63|128]}${ze._lut[i>>8&255]}-${ze._lut[i>>16&255]}${ze._lut[i>>24&255]}${ze._lut[s&255]}${ze._lut[s>>8&255]}${ze._lut[s>>16&255]}${ze._lut[s>>24&255]}`.toLowerCase()}static validate(t){if(!ze._pattern.test(t))throw new Error(`${t} is not a valid UUID v4.

- If you're the tool creator, you can take one from https://www.uuidgenerator.net/.

- If you're using a platform tool, verify the uuid isn't misspelled or contact the tool creator.`)}};L(FE,"_pattern",/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/);L(FE,"_lut",["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"]);let Un=FE;var Ku=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $v(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var OE={exports:{}};OE.exports=fp;OE.exports.default=fp;function fp(r,t,e){e=e||2;var i=t&&t.length,s=i?t[0]*e:r.length,n=Wv(r,0,s,e,!0),o=[];if(!n||n.next===n.prev)return o;var a,c,l,h,u,d,f;if(i&&(n=H2(r,t,n,e)),r.length>80*e){a=l=r[0],c=h=r[1];for(var p=e;p<s;p+=e)u=r[p],d=r[p+1],u<a&&(a=u),d<c&&(c=d),u>l&&(l=u),d>h&&(h=d);f=Math.max(l-a,h-c),f=f!==0?32767/f:0}return Ah(n,o,e,a,c,f,0),o}function Wv(r,t,e,i,s){var n,o;if(s===XI(r,t,e,i)>0)for(n=t;n<e;n+=i)o=JC(n,r[n],r[n+1],o);else for(n=e-i;n>=t;n-=i)o=JC(n,r[n],r[n+1],o);return o&&pp(o,o.next)&&(wh(o),o=o.next),o}function Fo(r,t){if(!r)return r;t||(t=r);var e=r,i;do if(i=!1,!e.steiner&&(pp(e,e.next)||be(e.prev,e,e.next)===0)){if(wh(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function Ah(r,t,e,i,s,n,o){if(r){!o&&n&&Z2(r,i,s,n);for(var a=r,c,l;r.prev!==r.next;){if(c=r.prev,l=r.next,n?z2(r,i,s,n):V2(r)){t.push(c.i/e|0),t.push(r.i/e|0),t.push(l.i/e|0),wh(r),r=l.next,a=l.next;continue}if(r=l,r===a){o?o===1?(r=Y2(Fo(r),t,e),Ah(r,t,e,i,s,n,2)):o===2&&G2(r,t,e,i,s,n):Ah(Fo(r),t,e,i,s,n,1);break}}}}function V2(r){var t=r.prev,e=r,i=r.next;if(be(t,e,i)>=0)return!1;for(var s=t.x,n=e.x,o=i.x,a=t.y,c=e.y,l=i.y,h=s<n?s<o?s:o:n<o?n:o,u=a<c?a<l?a:l:c<l?c:l,d=s>n?s>o?s:o:n>o?n:o,f=a>c?a>l?a:l:c>l?c:l,p=i.next;p!==t;){if(p.x>=h&&p.x<=d&&p.y>=u&&p.y<=f&&Ya(s,a,n,c,o,l,p.x,p.y)&&be(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function z2(r,t,e,i){var s=r.prev,n=r,o=r.next;if(be(s,n,o)>=0)return!1;for(var a=s.x,c=n.x,l=o.x,h=s.y,u=n.y,d=o.y,f=a<c?a<l?a:l:c<l?c:l,p=h<u?h<d?h:d:u<d?u:d,m=a>c?a>l?a:l:c>l?c:l,g=h>u?h>d?h:d:u>d?u:d,I=WI(f,p,t,e,i),C=WI(m,g,t,e,i),b=r.prevZ,E=r.nextZ;b&&b.z>=I&&E&&E.z<=C;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==s&&b!==o&&Ya(a,h,c,u,l,d,b.x,b.y)&&be(b.prev,b,b.next)>=0||(b=b.prevZ,E.x>=f&&E.x<=m&&E.y>=p&&E.y<=g&&E!==s&&E!==o&&Ya(a,h,c,u,l,d,E.x,E.y)&&be(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;b&&b.z>=I;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==s&&b!==o&&Ya(a,h,c,u,l,d,b.x,b.y)&&be(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;E&&E.z<=C;){if(E.x>=f&&E.x<=m&&E.y>=p&&E.y<=g&&E!==s&&E!==o&&Ya(a,h,c,u,l,d,E.x,E.y)&&be(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function Y2(r,t,e){var i=r;do{var s=i.prev,n=i.next.next;!pp(s,n)&&jv(s,i,i.next,n)&&Sh(s,n)&&Sh(n,s)&&(t.push(s.i/e|0),t.push(i.i/e|0),t.push(n.i/e|0),wh(i),wh(i.next),i=r=n),i=i.next}while(i!==r);return Fo(i)}function G2(r,t,e,i,s,n){var o=r;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&K2(o,a)){var c=Xv(o,a);o=Fo(o,o.next),c=Fo(c,c.next),Ah(o,t,e,i,s,n,0),Ah(c,t,e,i,s,n,0);return}a=a.next}o=o.next}while(o!==r)}function H2(r,t,e,i){var s=[],n,o,a,c,l;for(n=0,o=t.length;n<o;n++)a=t[n]*i,c=n<o-1?t[n+1]*i:r.length,l=Wv(r,a,c,i,!1),l===l.next&&(l.steiner=!0),s.push(Q2(l));for(s.sort($2),n=0;n<s.length;n++)e=W2(s[n],e);return e}function $2(r,t){return r.x-t.x}function W2(r,t){var e=j2(r,t);if(!e)return t;var i=Xv(e,r);return Fo(i,i.next),Fo(e,e.next)}function j2(r,t){var e=t,i=r.x,s=r.y,n=-1/0,o;do{if(s<=e.y&&s>=e.next.y&&e.next.y!==e.y){var a=e.x+(s-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(a<=i&&a>n&&(n=a,o=e.x<e.next.x?e:e.next,a===i))return o}e=e.next}while(e!==t);if(!o)return null;var c=o,l=o.x,h=o.y,u=1/0,d;e=o;do i>=e.x&&e.x>=l&&i!==e.x&&Ya(s<h?i:n,s,l,h,s<h?n:i,s,e.x,e.y)&&(d=Math.abs(s-e.y)/(i-e.x),Sh(e,r)&&(d<u||d===u&&(e.x>o.x||e.x===o.x&&X2(o,e)))&&(o=e,u=d)),e=e.next;while(e!==c);return o}function X2(r,t){return be(r.prev,r,t.prev)<0&&be(t.next,r,r.next)<0}function Z2(r,t,e,i){var s=r;do s.z===0&&(s.z=WI(s.x,s.y,t,e,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==r);s.prevZ.nextZ=null,s.prevZ=null,q2(s)}function q2(r){var t,e,i,s,n,o,a,c,l=1;do{for(e=r,r=null,n=null,o=0;e;){for(o++,i=e,a=0,t=0;t<l&&(a++,i=i.nextZ,!!i);t++);for(c=l;a>0||c>0&&i;)a!==0&&(c===0||!i||e.z<=i.z)?(s=e,e=e.nextZ,a--):(s=i,i=i.nextZ,c--),n?n.nextZ=s:r=s,s.prevZ=n,n=s;e=i}n.nextZ=null,l*=2}while(o>1);return r}function WI(r,t,e,i,s){return r=(r-e)*s|0,t=(t-i)*s|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1}function Q2(r){var t=r,e=r;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==r);return e}function Ya(r,t,e,i,s,n,o,a){return(s-o)*(t-a)>=(r-o)*(n-a)&&(r-o)*(i-a)>=(e-o)*(t-a)&&(e-o)*(n-a)>=(s-o)*(i-a)}function K2(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!J2(r,t)&&(Sh(r,t)&&Sh(t,r)&&tL(r,t)&&(be(r.prev,r,t.prev)||be(r,t.prev,t))||pp(r,t)&&be(r.prev,r,r.next)>0&&be(t.prev,t,t.next)>0)}function be(r,t,e){return(t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y)}function pp(r,t){return r.x===t.x&&r.y===t.y}function jv(r,t,e,i){var s=td(be(r,t,e)),n=td(be(r,t,i)),o=td(be(e,i,r)),a=td(be(e,i,t));return!!(s!==n&&o!==a||s===0&&Ju(r,e,t)||n===0&&Ju(r,i,t)||o===0&&Ju(e,r,i)||a===0&&Ju(e,t,i))}function Ju(r,t,e){return t.x<=Math.max(r.x,e.x)&&t.x>=Math.min(r.x,e.x)&&t.y<=Math.max(r.y,e.y)&&t.y>=Math.min(r.y,e.y)}function td(r){return r>0?1:r<0?-1:0}function J2(r,t){var e=r;do{if(e.i!==r.i&&e.next.i!==r.i&&e.i!==t.i&&e.next.i!==t.i&&jv(e,e.next,r,t))return!0;e=e.next}while(e!==r);return!1}function Sh(r,t){return be(r.prev,r,r.next)<0?be(r,t,r.next)>=0&&be(r,r.prev,t)>=0:be(r,t,r.prev)<0||be(r,r.next,t)<0}function tL(r,t){var e=r,i=!1,s=(r.x+t.x)/2,n=(r.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&s<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==r);return i}function Xv(r,t){var e=new jI(r.i,r.x,r.y),i=new jI(t.i,t.x,t.y),s=r.next,n=t.prev;return r.next=t,t.prev=r,e.next=s,s.prev=e,i.next=e,e.prev=i,n.next=i,i.prev=n,i}function JC(r,t,e,i){var s=new jI(r,t,e);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function wh(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function jI(r,t,e){this.i=r,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}fp.deviation=function(r,t,e,i){var s=t&&t.length,n=s?t[0]*e:r.length,o=Math.abs(XI(r,0,n,e));if(s)for(var a=0,c=t.length;a<c;a++){var l=t[a]*e,h=a<c-1?t[a+1]*e:r.length;o-=Math.abs(XI(r,l,h,e))}var u=0;for(a=0;a<i.length;a+=3){var d=i[a]*e,f=i[a+1]*e,p=i[a+2]*e;u+=Math.abs((r[d]-r[p])*(r[f+1]-r[d+1])-(r[d]-r[f])*(r[p+1]-r[d+1]))}return o===0&&u===0?0:Math.abs((u-o)/o)};function XI(r,t,e,i){for(var s=0,n=t,o=e-i;n<e;n+=i)s+=(r[o]-r[n])*(r[n+1]+r[o+1]),o=n;return s}fp.flatten=function(r){for(var t=r[0][0].length,e={vertices:[],holes:[],dimensions:t},i=0,s=0;s<r.length;s++){for(var n=0;n<r[s].length;n++)for(var o=0;o<t;o++)e.vertices.push(r[s][n][o]);s>0&&(i+=r[s-1].length,e.holes.push(i))}return e};var eL=OE.exports;const iL=$v(eL);class sL extends oe{constructor(){super(...arguments),L(this,"enabled",!0),L(this,"_inverseMatrix",new ht),L(this,"_localPlane",new Qe),L(this,"_tempLine",new Vt),L(this,"_tempVector",new M),L(this,"_plane"),L(this,"_plane2DCoordinateSystem",new ht),L(this,"_precission",1e4),L(this,"_planeAxis")}get plane(){if(!this._plane)throw new Error("Plane not set");return this._plane}set plane(t){this._plane=t}createEdges(t){const{meshes:e,posAttr:i}=t;let s=0;i.array.fill(0);const n=[];let o=0;const a=new it;for(const c of e)if(c.geometry){if(c.geometry.boundsTree||c.geometry.computeBoundsTree(),!c.geometry.boundsTree)throw new Error("Bounds tree not found for edges generation.");if(c instanceof Pe){if(c.count===0)continue;const l=c;for(let h=0;h<l.count;h++){a.geometry=c.geometry,a.matrix.copy(c.matrix);const u=new ht;l.getMatrixAt(h,u),a.applyMatrix4(u),a.applyMatrix4(c.matrixWorld),a.updateMatrix(),a.updateMatrixWorld(),this._inverseMatrix.copy(a.matrixWorld).invert(),this._localPlane.copy(this.plane).applyMatrix4(this._inverseMatrix),s=this.shapecast(a,i,s),s!==o&&(n.push(s),o=s)}}else this._inverseMatrix.copy(c.matrixWorld).invert(),this._localPlane.copy(this.plane).applyMatrix4(this._inverseMatrix),s=this.shapecast(c,i,s),s!==o&&(n.push(s),o=s)}return{indexes:n,index:s}}createFills(t,e){this.updatePlane2DCoordinateSystem();const i=[];let s=0;for(let n=0;n<e.length;n++){const o=e[n],a=[];for(let l=s;l<o;l+=2)a.push(l*3);const c=this.computeFill(a,t);for(const l of c)i.push(l);s=o}return i}computeFill(t,e){const i=new Map,s={},n=new Map;let o=0;const a=new Map,c=new Map,l=new Set,h=this._precission;for(let d=0;d<t.length;d++){const f=t[d];let p=0,m=0,g=0,I=0;const C=e[f],b=e[f+1],E=e[f+2],T=e[f+3],A=e[f+4],S=e[f+5];if(this._tempVector.set(C,b,E),this._tempVector.applyMatrix4(this._plane2DCoordinateSystem),p=Math.trunc(this._tempVector.x*h)/h,m=Math.trunc(this._tempVector.y*h)/h,this._tempVector.set(T,A,S),this._tempVector.applyMatrix4(this._plane2DCoordinateSystem),g=Math.trunc(this._tempVector.x*h)/h,I=Math.trunc(this._tempVector.y*h)/h,p===g&&m===I)continue;const _=`${p}|${m}`,w=`${g}|${I}`;i.has(_)||i.set(_,f/3),i.has(w)||i.set(w,f/3+1);const F=i.get(_),D=i.get(w);s[F]=[p,m],s[D]=[g,I];const R=c.has(F),O=a.has(F),y=c.has(D),U=a.has(D);if(!R&&!O&&!y&&!U)c.set(F,o),a.set(D,o),l.add(o),n.set(o,[F,D]),o++;else if(R&&U){const k=c.get(F),X=a.get(D);if(k!==X){const et=n.get(X),Y=n.get(k);if(!et||!Y)continue;n.delete(k),l.delete(k),a.set(Y[Y.length-1],X),a.delete(et[et.length-1]);for(const z of Y)et.push(z)}else l.delete(X);c.delete(F),a.delete(D)}else if(O&&y){const k=c.get(D),X=a.get(F);if(k!==X){const et=n.get(X),Y=n.get(k);if(!et||!Y)continue;n.delete(k),l.delete(k),a.set(Y[Y.length-1],X),a.delete(et[et.length-1]);for(const z of Y)et.push(z)}else l.delete(X);c.delete(D),a.delete(F)}else if(R&&y){const k=c.get(D),X=c.get(F),$=n.get(X),et=n.get(k);if(!$||!et)continue;n.delete(k),l.delete(k),c.delete($[0]),c.delete(et[0]),a.delete(et[et.length-1]),c.set(et[et.length-1],X),et.reverse(),$.splice(0,0,...et)}else if(O&&U){const k=a.get(D),X=a.get(F),$=n.get(X),et=n.get(k);if(!$||!et)continue;n.delete(k),l.delete(k),a.delete($[$.length-1]),a.delete(et[et.length-1]),c.delete(et[0]),a.set(et[0],X),et.reverse(),$.push(...et)}else if(R){const k=c.get(F),X=n.get(k);if(!X)continue;X.unshift(D),c.delete(F),c.set(D,k)}else if(O){const k=a.get(F),X=n.get(k);if(!X)continue;X.push(D),a.delete(F),a.set(D,k)}else if(y){const k=c.get(D),X=n.get(k);if(!X)continue;X.unshift(F),c.delete(D),c.set(F,k)}else if(U){const k=a.get(D),X=n.get(k);if(!X)continue;X.push(F),a.delete(D),a.set(F,k)}}const u=[];for(const[d,f]of n){if(l.has(d))continue;const p=[],m=new Map;let g=0;for(const C of f){const b=s[C];p.push(b[0],b[1]),m.set(g++,C)}const I=iL(p);for(const C of I){const b=m.get(C);if(b===void 0)throw new Error("Map error!");u.push(b)}}return u}updatePlane2DCoordinateSystem(){this._plane2DCoordinateSystem=new ht;const t=new M(1,0,0),e=new M(0,1,0),i=this.plane.normal,s=new M;this.plane.coplanarPoint(s),this._planeAxis==="x"?t.crossVectors(e,i):this._planeAxis==="y"?e.crossVectors(i,t):this._planeAxis==="z"||(t.crossVectors(e,i).normalize(),e.crossVectors(i,t)),this._plane2DCoordinateSystem.fromArray([t.x,t.y,t.z,0,e.x,e.y,e.z,0,i.x,i.y,i.z,0,s.x,s.y,s.z,1]),this._plane2DCoordinateSystem.invert()}shapecast(t,e,i){return t.geometry.boundsTree.shapecast({intersectsBounds:s=>this._localPlane.intersectsBox(s),intersectsTriangle:s=>{let n=0;if(this._tempLine.start.copy(s.a),this._tempLine.end.copy(s.b),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const o=this._tempVector.applyMatrix4(t.matrixWorld);e.setXYZ(i,o.x,o.y,o.z),n++,i++}if(this._tempLine.start.copy(s.b),this._tempLine.end.copy(s.c),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const o=this._tempVector.applyMatrix4(t.matrixWorld);e.setXYZ(i,o.x,o.y,o.z),n++,i++}if(this._tempLine.start.copy(s.c),this._tempLine.end.copy(s.a),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const o=this._tempVector.applyMatrix4(t.matrixWorld);e.setXYZ(i,o.x,o.y,o.z),n++,i++}n!==2&&(i-=n)}}),i}}L(sL,"uuid","1a193b87-6376-46c8-9e65-62a1576fdb64");const Zv=class qv{constructor(){L(this,"onDisposed",new It),L(this,"list",new Map),L(this,"enabled",!1),L(this,"_clock"),L(this,"onInit",new It),L(this,"update",()=>{if(!this.enabled)return;const t=this._clock.getDelta();for(const[e,i]of this.list)i.enabled&&i.isUpdateable()&&i.update(t);requestAnimationFrame(this.update)}),this._clock=new Kg,qv.setupBVH()}add(t,e){if(this.list.has(t))throw new Error("You're trying to add a component that already exists in the components instance. Use Components.get() instead.");Un.validate(t),this.list.set(t,e)}get(t){const e=t.uuid;if(!this.list.has(e)){const i=new t(this);return this.list.has(e)||this.add(e,i),i}return this.list.get(e)}init(){this.enabled=!0,this._clock.start(),this.update(),this.onInit.trigger()}dispose(){this.enabled=!1;for(const[t,e]of this.list)e.enabled=!1,e.isDisposeable()&&e.dispose();this._clock.stop(),this.onDisposed.trigger(),this.onDisposed.reset()}static setupBVH(){Ut.prototype.computeBoundsTree=w2,Ut.prototype.disposeBoundsTree=_2,it.prototype.raycast=S2}};L(Zv,"release","2.4.3");let xE=Zv;class Qv extends _E{constructor(){super(...arguments),L(this,"meshes",new Set),L(this,"onAfterUpdate",new It),L(this,"onBeforeUpdate",new It),L(this,"onDisposed",new It),L(this,"isDisposing",!1),L(this,"enabled",!0),L(this,"uuid",Un.create()),L(this,"name"),L(this,"_scene"),L(this,"_camera"),L(this,"_renderer",null)}get scene(){if(!this._scene)throw new Error("No scene initialized!");return this._scene}set scene(t){this._scene=t,t.worlds.set(this.uuid,this),t.currentWorld=this,t.onWorldChanged.trigger({world:this,action:"added"})}get camera(){if(!this._camera)throw new Error("No camera initialized!");return this._camera}set camera(t){this._camera=t,t.worlds.set(this.uuid,this),t.currentWorld=this,t.onWorldChanged.trigger({world:this,action:"added"})}get renderer(){return this._renderer}set renderer(t){this._renderer=t,t&&(t.worlds.set(this.uuid,this),t.currentWorld=this,t.onWorldChanged.trigger({world:this,action:"added"}))}update(t){this.enabled&&(!this._scene||!this._camera||(this.scene.currentWorld=this,this.camera.currentWorld=this,this.renderer&&(this.renderer.currentWorld=this),this.onBeforeUpdate.trigger(),this.scene.isUpdateable()&&this.scene.update(t),this.camera.isUpdateable()&&this.camera.update(t),this.renderer&&this.renderer.update(t),this.onAfterUpdate.trigger()))}dispose(t=!0){if(this.enabled=!1,this.isDisposing=!0,this.scene.onWorldChanged.trigger({world:this,action:"removed"}),this.camera.onWorldChanged.trigger({world:this,action:"removed"}),this.renderer&&this.renderer.onWorldChanged.trigger({world:this,action:"removed"}),t){const i=this.components.get(ac);this.scene.dispose(),this.camera.isDisposeable()&&this.camera.dispose(),this.renderer&&this.renderer.dispose();for(const s of this.meshes)i.destroy(s);this.meshes.clear()}this._scene=null,this._camera=null,this._renderer=null,this.components.get($o).list.delete(this.uuid),this.onDisposed.trigger(),this.onDisposed.reset()}}class Ho{constructor(t,e,i,s){L(this,"_component"),L(this,"name"),L(this,"uuid"),this._component=t,this.name=i,this.uuid=s??Un.create(),e.get(tu).list.set(this.uuid,this)}get controls(){return Cm.copySchema(this._config)}set(t){for(const e in t)if(e in this){const i=e;this[i]=t[e].value}}export(t=this._config,e={}){for(const i in t){const s=t[i];if(Cm.isEntry(s))if(s.type==="Color"){const{r:o,g:a,b:c}=s.value;e[i]={...s,value:{r:o,g:a,b:c}}}else if(s.type==="Vector3"){const{x:o,y:a,z:c}=s.value;e[i]={...s,value:{x:o,y:a,z:c}}}else if(s.type==="TextSet"){const o=Array.from(s.value);e[i]={...s,value:o}}else if(s.type==="Select"){const o=Array.from(s.options);e[i]={...s,options:o}}else e[i]={...s};else e[i]={},this.export(s,e[i])}return e}import(t,e={},i=!0){for(const s in t){const n=t[s];if(Cm.isEntry(n))if(n.type==="Color"){const{r:a,g:c,b:l}=n.value;e[s]={...n,value:new Rt(a,c,l)}}else if(n.type==="Vector3"){const{x:a,y:c,z:l}=n.value;e[s]={...n,value:new M(a,c,l)}}else n.type==="TextSet"?e[s]={...n,value:new Set(n.value)}:n.type==="Select"?e[s]={...n,options:new Set(n.options)}:e[s]={...n};else e[s]={},this.import(n,e[s],!1)}i&&this.set(e)}}const Kv=class Jv extends oe{constructor(t){super(t),L(this,"list",new Os),L(this,"enabled",!0),t.add(Jv.uuid,this)}};L(Kv,"uuid","b8c764e0-6b24-4e77-9a32-35fa728ee5b4");let tu=Kv;class nL{constructor(t,e){L(this,"_list"),L(this,"_scene"),this._list=t,this._scene=e}get color(){return this._list.directionalLight.color.value}set color(t){this._list.directionalLight.color.value=t;for(const[,e]of this._scene.directionalLights)e.color.copy(t)}get intensity(){return this._list.directionalLight.intensity.value}set intensity(t){this._list.directionalLight.intensity.value=t;for(const[,e]of this._scene.directionalLights)e.intensity=t}get position(){return this._list.directionalLight.position.value.clone()}set position(t){this._list.directionalLight.position.value=t;for(const[,e]of this._scene.directionalLights)e.position.copy(t)}}class rL{constructor(t,e){L(this,"_list"),L(this,"_scene"),this._list=t,this._scene=e}get color(){return this._list.ambientLight.color.value}set color(t){this._list.ambientLight.color.value=t;for(const[,e]of this._scene.ambientLights)e.color.copy(t)}get intensity(){return this._list.ambientLight.intensity.value}set intensity(t){this._list.ambientLight.intensity.value=t;for(const[,e]of this._scene.ambientLights)e.intensity=t}}class oL extends Ho{constructor(){super(...arguments),L(this,"_config",{backgroundColor:{value:new Rt,type:"Color"},ambientLight:{color:{type:"Color",value:new Rt},intensity:{type:"Number",interpolable:!0,min:0,max:10,value:2}},directionalLight:{color:{type:"Color",value:new Rt},intensity:{type:"Number",interpolable:!0,min:0,max:10,value:2},position:{type:"Vector3",value:new M}}}),L(this,"ambientLight",new rL(this._config,this._component)),L(this,"directionalLight",new nL(this._config,this._component))}get backgroundColor(){return this._config.backgroundColor.value}set backgroundColor(t){this._config.backgroundColor.value=t,this._component.three.background=t}}class NE extends O2{constructor(t){super(t),L(this,"onSetup",new It),L(this,"isSetup",!1),L(this,"three"),L(this,"config",new oL(this,this.components,"Scene")),L(this,"_defaultConfig",{backgroundColor:new Rt(2107698),directionalLight:{color:new Rt("white"),intensity:1.5,position:new M(5,10,3)},ambientLight:{color:new Rt("white"),intensity:1}}),this.three=new rn,this.three.background=new Rt(2107698)}setup(t){const e={...this._defaultConfig,...t};this.config.backgroundColor=e.backgroundColor;const i=e.ambientLight;this.config.ambientLight.color=i.color,this.config.ambientLight.intensity=i.intensity;const s=e.directionalLight;this.config.directionalLight.color=s.color,this.config.directionalLight.intensity=s.intensity,this.config.directionalLight.position=s.position,this.deleteAllLights();const{color:n,intensity:o}=this.config.directionalLight,a=new Ny(n,o);a.position.copy(s.position);const{color:c,intensity:l}=this.config.directionalLight,h=new Py(c,l);this.three.add(a,h),this.directionalLights.set(a.uuid,a),this.ambientLights.set(h.uuid,h),this.isSetup=!0,this.onSetup.trigger()}dispose(){super.dispose(),this.components.get(tu).list.delete(this.config.uuid)}}/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const _t={LEFT:1,RIGHT:2,MIDDLE:4},at=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),Ia={NONE:0,IN:1,OUT:-1};function jr(r){return r.isPerspectiveCamera}function Kn(r){return r.isOrthographicCamera}const ga=Math.PI*2,tb=Math.PI/2,tR=1e-5,yl=Math.PI/180;function Ts(r,t,e){return Math.max(t,Math.min(e,r))}function se(r,t=tR){return Math.abs(r)<t}function Wt(r,t,e=tR){return se(r-t,e)}function eb(r,t){return Math.round(r/t)*t}function vl(r){return isFinite(r)?r:r<0?-Number.MAX_VALUE:Number.MAX_VALUE}function Rl(r){return Math.abs(r)<Number.MAX_VALUE?r:r*(1/0)}function ed(r,t,e,i,s=1/0,n){i=Math.max(1e-4,i);const o=2/i,a=o*n,c=1/(1+a+.48*a*a+.235*a*a*a);let l=r-t;const h=t,u=s*i;l=Ts(l,-u,u),t=r-l;const d=(e.value+o*l)*n;e.value=(e.value-o*d)*c;let f=t+(l+d)*c;return h-r>0==f>h&&(f=h,e.value=(f-h)/n),f}function ib(r,t,e,i,s=1/0,n,o){i=Math.max(1e-4,i);const a=2/i,c=a*n,l=1/(1+c+.48*c*c+.235*c*c*c);let h=t.x,u=t.y,d=t.z,f=r.x-h,p=r.y-u,m=r.z-d;const g=h,I=u,C=d,b=s*i,E=b*b,T=f*f+p*p+m*m;if(T>E){const U=Math.sqrt(T);f=f/U*b,p=p/U*b,m=m/U*b}h=r.x-f,u=r.y-p,d=r.z-m;const A=(e.x+a*f)*n,S=(e.y+a*p)*n,_=(e.z+a*m)*n;e.x=(e.x-a*A)*l,e.y=(e.y-a*S)*l,e.z=(e.z-a*_)*l,o.x=h+(f+A)*l,o.y=u+(p+S)*l,o.z=d+(m+_)*l;const w=g-r.x,F=I-r.y,D=C-r.z,R=o.x-g,O=o.y-I,y=o.z-C;return w*R+F*O+D*y>0&&(o.x=g,o.y=I,o.z=C,e.x=(o.x-g)/n,e.y=(o.y-I)/n,e.z=(o.z-C)/n),o}function ym(r,t){t.set(0,0),r.forEach(e=>{t.x+=e.clientX,t.y+=e.clientY}),t.x/=r.length,t.y/=r.length}function vm(r,t){return Kn(r)?(console.warn(`${t} is not supported in OrthographicCamera`),!0):!1}class aL{constructor(){this._listeners={}}addEventListener(t,e){const i=this._listeners;i[t]===void 0&&(i[t]=[]),i[t].indexOf(e)===-1&&i[t].push(e)}hasEventListener(t,e){const i=this._listeners;return i[t]!==void 0&&i[t].indexOf(e)!==-1}removeEventListener(t,e){const s=this._listeners[t];if(s!==void 0){const n=s.indexOf(e);n!==-1&&s.splice(n,1)}}removeAllEventListeners(t){if(!t){this._listeners={};return}Array.isArray(this._listeners[t])&&(this._listeners[t].length=0)}dispatchEvent(t){const i=this._listeners[t.type];if(i!==void 0){t.target=this;const s=i.slice(0);for(let n=0,o=s.length;n<o;n++)s[n].call(this,t)}}}const cL="2.7.3",id=1/8,eR=typeof window<"u",lL=eR&&/Mac/.test(navigator.platform),hL=!(eR&&"PointerEvent"in window);let St,sb,sd,Rm,ui,Mt,Yt,Ea,Al,Bs,ks,Xr,nb,rb,Mi,Sl,Ca,ob,Am,ab,Sm,wm,nd;class ii extends aL{static install(t){St=t.THREE,sb=Object.freeze(new St.Vector3(0,0,0)),sd=Object.freeze(new St.Vector3(0,1,0)),Rm=Object.freeze(new St.Vector3(0,0,1)),ui=new St.Vector2,Mt=new St.Vector3,Yt=new St.Vector3,Ea=new St.Vector3,Al=new St.Vector3,Bs=new St.Vector3,ks=new St.Vector3,Xr=new St.Vector3,nb=new St.Vector3,rb=new St.Vector3,Mi=new St.Spherical,Sl=new St.Spherical,Ca=new St.Box3,ob=new St.Box3,Am=new St.Sphere,ab=new St.Quaternion,Sm=new St.Quaternion,wm=new St.Matrix4,nd=new St.Raycaster}static get ACTION(){return at}constructor(t,e){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=at.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=Ia.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new St.Vector3,this._focalOffsetVelocity=new St.Vector3,this._zoomVelocity={value:0},this._truckInternal=(E,T,A)=>{let S,_;if(jr(this._camera)){const w=Mt.copy(this._camera.position).sub(this._target),F=this._camera.getEffectiveFOV()*yl,D=w.length()*Math.tan(F*.5);S=this.truckSpeed*E*D/this._elementRect.height,_=this.truckSpeed*T*D/this._elementRect.height}else if(Kn(this._camera)){const w=this._camera;S=E*(w.right-w.left)/w.zoom/this._elementRect.width,_=T*(w.top-w.bottom)/w.zoom/this._elementRect.height}else return;this.verticalDragToForward?(A?this.setFocalOffset(this._focalOffsetEnd.x+S,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(S,0,!0),this.forward(-_,!0)):A?this.setFocalOffset(this._focalOffsetEnd.x+S,this._focalOffsetEnd.y+_,this._focalOffsetEnd.z,!0):this.truck(S,_,!0)},this._rotateInternal=(E,T)=>{const A=ga*this.azimuthRotateSpeed*E/this._elementRect.height,S=ga*this.polarRotateSpeed*T/this._elementRect.height;this.rotate(A,S,!0)},this._dollyInternal=(E,T,A)=>{const S=Math.pow(.95,-E*this.dollySpeed),_=this._sphericalEnd.radius,w=this._sphericalEnd.radius*S,F=Ts(w,this.minDistance,this.maxDistance),D=F-w;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(w,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(D,!0),this._dollyToNoClamp(F,!0)):this._dollyToNoClamp(F,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?w:F)-_,this._dollyControlCoord.set(T,A)),this._lastDollyDirection=Math.sign(-E)},this._zoomInternal=(E,T,A)=>{const S=Math.pow(.95,E*this.dollySpeed),_=this._zoom,w=this._zoom*S;this.zoomTo(w,!0),this.dollyToCursor&&(this._changedZoom+=w-_,this._dollyControlCoord.set(T,A))},typeof St>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=t,this._yAxisUpSpace=new St.Quaternion().setFromUnitVectors(this._camera.up,sd),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=at.NONE,this._target=new St.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new St.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new St.Spherical().setFromVector3(Mt.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new St.Vector3,new St.Vector3,new St.Vector3,new St.Vector3],this._updateNearPlaneCorners(),this._boundary=new St.Box3(new St.Vector3(-1/0,-1/0,-1/0),new St.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new St.Vector2,this.mouseButtons={left:at.ROTATE,middle:at.DOLLY,right:at.TRUCK,wheel:jr(this._camera)?at.DOLLY:Kn(this._camera)?at.ZOOM:at.NONE},this.touches={one:at.TOUCH_ROTATE,two:jr(this._camera)?at.TOUCH_DOLLY_TRUCK:Kn(this._camera)?at.TOUCH_ZOOM_TRUCK:at.NONE,three:at.TOUCH_TRUCK};const i=new St.Vector2,s=new St.Vector2,n=new St.Vector2,o=E=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const S=this._domElement.getBoundingClientRect(),_=E.clientX/S.width,w=E.clientY/S.height;if(_<this._interactiveArea.left||_>this._interactiveArea.right||w<this._interactiveArea.top||w>this._interactiveArea.bottom)return}const T=E.pointerType!=="mouse"?null:(E.buttons&_t.LEFT)===_t.LEFT?_t.LEFT:(E.buttons&_t.MIDDLE)===_t.MIDDLE?_t.MIDDLE:(E.buttons&_t.RIGHT)===_t.RIGHT?_t.RIGHT:null;if(T!==null){const S=this._findPointerByMouseButton(T);S&&this._disposePointer(S)}if((E.buttons&_t.LEFT)===_t.LEFT&&this._lockedPointer)return;const A={pointerId:E.pointerId,clientX:E.clientX,clientY:E.clientY,deltaX:0,deltaY:0,mouseButton:T};this._activePointers.push(A),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",h),this._isDragging=!0,m(E)},a=E=>{if(!this._enabled||!this._domElement||this._lockedPointer)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const S=this._domElement.getBoundingClientRect(),_=E.clientX/S.width,w=E.clientY/S.height;if(_<this._interactiveArea.left||_>this._interactiveArea.right||w<this._interactiveArea.top||w>this._interactiveArea.bottom)return}const T=(E.buttons&_t.LEFT)===_t.LEFT?_t.LEFT:(E.buttons&_t.MIDDLE)===_t.MIDDLE?_t.MIDDLE:(E.buttons&_t.RIGHT)===_t.RIGHT?_t.RIGHT:null;if(T!==null){const S=this._findPointerByMouseButton(T);S&&this._disposePointer(S)}const A={pointerId:1,clientX:E.clientX,clientY:E.clientY,deltaX:0,deltaY:0,mouseButton:(E.buttons&_t.LEFT)===_t.LEFT?_t.LEFT:(E.buttons&_t.MIDDLE)===_t.LEFT?_t.MIDDLE:(E.buttons&_t.RIGHT)===_t.LEFT?_t.RIGHT:null};this._activePointers.push(A),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("mouseup",u),this._domElement.ownerDocument.addEventListener("mousemove",l),this._domElement.ownerDocument.addEventListener("mouseup",u),this._isDragging=!0,m(E)},c=E=>{E.cancelable&&E.preventDefault();const T=E.pointerId,A=this._lockedPointer||this._findPointerById(T);if(A){if(A.clientX=E.clientX,A.clientY=E.clientY,A.deltaX=E.movementX,A.deltaY=E.movementY,this._state=0,E.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(E.buttons&_t.LEFT)===_t.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(E.buttons&_t.MIDDLE)===_t.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(E.buttons&_t.RIGHT)===_t.RIGHT&&(this._state=this._state|this.mouseButtons.right);g()}},l=E=>{const T=this._lockedPointer||this._findPointerById(1);T&&(T.clientX=E.clientX,T.clientY=E.clientY,T.deltaX=E.movementX,T.deltaY=E.movementY,this._state=0,(this._lockedPointer||(E.buttons&_t.LEFT)===_t.LEFT)&&(this._state=this._state|this.mouseButtons.left),(E.buttons&_t.MIDDLE)===_t.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(E.buttons&_t.RIGHT)===_t.RIGHT&&(this._state=this._state|this.mouseButtons.right),g())},h=E=>{const T=this._findPointerById(E.pointerId);if(!(T&&T===this._lockedPointer)){if(T&&this._disposePointer(T),E.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=at.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=at.NONE;I()}},u=()=>{const E=this._findPointerById(1);E&&E===this._lockedPointer||(E&&this._disposePointer(E),this._state=at.NONE,I())};let d=-1;const f=E=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===at.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const w=this._domElement.getBoundingClientRect(),F=E.clientX/w.width,D=E.clientY/w.height;if(F<this._interactiveArea.left||F>this._interactiveArea.right||D<this._interactiveArea.top||D>this._interactiveArea.bottom)return}if(E.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===at.ROTATE||this.mouseButtons.wheel===at.TRUCK){const w=performance.now();d-w<1e3&&this._getClientRect(this._elementRect),d=w}const T=lL?-1:-3,A=E.deltaMode===1?E.deltaY/T:E.deltaY/(T*10),S=this.dollyToCursor?(E.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,_=this.dollyToCursor?(E.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case at.ROTATE:{this._rotateInternal(E.deltaX,E.deltaY),this._isUserControllingRotate=!0;break}case at.TRUCK:{this._truckInternal(E.deltaX,E.deltaY,!1),this._isUserControllingTruck=!0;break}case at.OFFSET:{this._truckInternal(E.deltaX,E.deltaY,!0),this._isUserControllingOffset=!0;break}case at.DOLLY:{this._dollyInternal(-A,S,_),this._isUserControllingDolly=!0;break}case at.ZOOM:{this._zoomInternal(-A,S,_),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},p=E=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===ii.ACTION.NONE){const T=E instanceof PointerEvent?E.pointerId:(E instanceof MouseEvent,0),A=this._findPointerById(T);A&&this._disposePointer(A),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("mouseup",u);return}E.preventDefault()}},m=E=>{if(!this._enabled)return;if(ym(this._activePointers,ui),this._getClientRect(this._elementRect),i.copy(ui),s.copy(ui),this._activePointers.length>=2){const A=ui.x-this._activePointers[1].clientX,S=ui.y-this._activePointers[1].clientY,_=Math.sqrt(A*A+S*S);n.set(0,_);const w=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,F=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;s.set(w,F)}if(this._state=0,!E)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in E&&E.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(E.buttons&_t.LEFT)===_t.LEFT&&(this._state=this._state|this.mouseButtons.left),(E.buttons&_t.MIDDLE)===_t.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(E.buttons&_t.RIGHT)===_t.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&at.ROTATE)===at.ROTATE||(this._state&at.TOUCH_ROTATE)===at.TOUCH_ROTATE||(this._state&at.TOUCH_DOLLY_ROTATE)===at.TOUCH_DOLLY_ROTATE||(this._state&at.TOUCH_ZOOM_ROTATE)===at.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&at.TRUCK)===at.TRUCK||(this._state&at.TOUCH_TRUCK)===at.TOUCH_TRUCK||(this._state&at.TOUCH_DOLLY_TRUCK)===at.TOUCH_DOLLY_TRUCK||(this._state&at.TOUCH_ZOOM_TRUCK)===at.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&at.DOLLY)===at.DOLLY||(this._state&at.TOUCH_DOLLY)===at.TOUCH_DOLLY||(this._state&at.TOUCH_DOLLY_TRUCK)===at.TOUCH_DOLLY_TRUCK||(this._state&at.TOUCH_DOLLY_OFFSET)===at.TOUCH_DOLLY_OFFSET||(this._state&at.TOUCH_DOLLY_ROTATE)===at.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&at.ZOOM)===at.ZOOM||(this._state&at.TOUCH_ZOOM)===at.TOUCH_ZOOM||(this._state&at.TOUCH_ZOOM_TRUCK)===at.TOUCH_ZOOM_TRUCK||(this._state&at.TOUCH_ZOOM_OFFSET)===at.TOUCH_ZOOM_OFFSET||(this._state&at.TOUCH_ZOOM_ROTATE)===at.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&at.OFFSET)===at.OFFSET||(this._state&at.TOUCH_OFFSET)===at.TOUCH_OFFSET||(this._state&at.TOUCH_DOLLY_OFFSET)===at.TOUCH_DOLLY_OFFSET||(this._state&at.TOUCH_ZOOM_OFFSET)===at.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},g=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,ym(this._activePointers,ui);const T=this._domElement&&document.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,A=T?-T.deltaX:s.x-ui.x,S=T?-T.deltaY:s.y-ui.y;if(s.copy(ui),((this._state&at.ROTATE)===at.ROTATE||(this._state&at.TOUCH_ROTATE)===at.TOUCH_ROTATE||(this._state&at.TOUCH_DOLLY_ROTATE)===at.TOUCH_DOLLY_ROTATE||(this._state&at.TOUCH_ZOOM_ROTATE)===at.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(A,S),this._isUserControllingRotate=!0),(this._state&at.DOLLY)===at.DOLLY||(this._state&at.ZOOM)===at.ZOOM){const _=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,w=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0,F=this.dollyDragInverted?-1:1;(this._state&at.DOLLY)===at.DOLLY?(this._dollyInternal(F*S*id,_,w),this._isUserControllingDolly=!0):(this._zoomInternal(F*S*id,_,w),this._isUserControllingZoom=!0)}if((this._state&at.TOUCH_DOLLY)===at.TOUCH_DOLLY||(this._state&at.TOUCH_ZOOM)===at.TOUCH_ZOOM||(this._state&at.TOUCH_DOLLY_TRUCK)===at.TOUCH_DOLLY_TRUCK||(this._state&at.TOUCH_ZOOM_TRUCK)===at.TOUCH_ZOOM_TRUCK||(this._state&at.TOUCH_DOLLY_OFFSET)===at.TOUCH_DOLLY_OFFSET||(this._state&at.TOUCH_ZOOM_OFFSET)===at.TOUCH_ZOOM_OFFSET||(this._state&at.TOUCH_DOLLY_ROTATE)===at.TOUCH_DOLLY_ROTATE||(this._state&at.TOUCH_ZOOM_ROTATE)===at.TOUCH_ZOOM_ROTATE){const _=ui.x-this._activePointers[1].clientX,w=ui.y-this._activePointers[1].clientY,F=Math.sqrt(_*_+w*w),D=n.y-F;n.set(0,F);const R=this.dollyToCursor?(s.x-this._elementRect.x)/this._elementRect.width*2-1:0,O=this.dollyToCursor?(s.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&at.TOUCH_DOLLY)===at.TOUCH_DOLLY||(this._state&at.TOUCH_DOLLY_ROTATE)===at.TOUCH_DOLLY_ROTATE||(this._state&at.TOUCH_DOLLY_TRUCK)===at.TOUCH_DOLLY_TRUCK||(this._state&at.TOUCH_DOLLY_OFFSET)===at.TOUCH_DOLLY_OFFSET?(this._dollyInternal(D*id,R,O),this._isUserControllingDolly=!0):(this._zoomInternal(D*id,R,O),this._isUserControllingZoom=!0)}((this._state&at.TRUCK)===at.TRUCK||(this._state&at.TOUCH_TRUCK)===at.TOUCH_TRUCK||(this._state&at.TOUCH_DOLLY_TRUCK)===at.TOUCH_DOLLY_TRUCK||(this._state&at.TOUCH_ZOOM_TRUCK)===at.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(A,S,!1),this._isUserControllingTruck=!0),((this._state&at.OFFSET)===at.OFFSET||(this._state&at.TOUCH_OFFSET)===at.TOUCH_OFFSET||(this._state&at.TOUCH_DOLLY_OFFSET)===at.TOUCH_DOLLY_OFFSET||(this._state&at.TOUCH_ZOOM_OFFSET)===at.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(A,S,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},I=()=>{ym(this._activePointers,ui),s.copy(ui),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("mouseup",u),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",C),this._domElement.ownerDocument.addEventListener("pointerlockerror",b),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",h),m())},this.unlockPointer=()=>{this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),document.exitPointerLock(),this.cancel(),this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointerlockchange",C),this._domElement.ownerDocument.removeEventListener("pointerlockerror",b))};const C=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},b=()=>{this.unlockPointer()};this._addAllEventListeners=E=>{this._domElement=E,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",o),hL&&this._domElement.addEventListener("mousedown",a),this._domElement.addEventListener("pointercancel",h),this._domElement.addEventListener("wheel",f,{passive:!1}),this._domElement.addEventListener("contextmenu",p)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",o),this._domElement.removeEventListener("mousedown",a),this._domElement.removeEventListener("pointercancel",h),this._domElement.removeEventListener("wheel",f,{passive:!1}),this._domElement.removeEventListener("contextmenu",p),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("mouseup",u),this._domElement.ownerDocument.removeEventListener("pointerlockchange",C),this._domElement.ownerDocument.removeEventListener("pointerlockerror",b))},this.cancel=()=>{this._state!==at.NONE&&(this._state=at.NONE,this._activePointers.length=0,I())},e&&this.connect(e),this.update(0)}get camera(){return this._camera}set camera(t){this._camera=t,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._domElement&&(t?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(t){this._spherical.radius===t&&this._sphericalEnd.radius===t||(this._spherical.radius=t,this._sphericalEnd.radius=t,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(t){this._spherical.theta===t&&this._sphericalEnd.theta===t||(this._spherical.theta=t,this._sphericalEnd.theta=t,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(t){this._spherical.phi===t&&this._sphericalEnd.phi===t||(this._spherical.phi=t,this._sphericalEnd.phi=t,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(t){this._boundaryEnclosesCamera=t,this._needsUpdate=!0}set interactiveArea(t){this._interactiveArea.width=Ts(t.width,0,1),this._interactiveArea.height=Ts(t.height,0,1),this._interactiveArea.x=Ts(t.x,0,1-this._interactiveArea.width),this._interactiveArea.y=Ts(t.y,0,1-this._interactiveArea.height)}addEventListener(t,e){super.addEventListener(t,e)}removeEventListener(t,e){super.removeEventListener(t,e)}rotate(t,e,i=!1){return this.rotateTo(this._sphericalEnd.theta+t,this._sphericalEnd.phi+e,i)}rotateAzimuthTo(t,e=!1){return this.rotateTo(t,this._sphericalEnd.phi,e)}rotatePolarTo(t,e=!1){return this.rotateTo(this._sphericalEnd.theta,t,e)}rotateTo(t,e,i=!1){this._isUserControllingRotate=!1;const s=Ts(t,this.minAzimuthAngle,this.maxAzimuthAngle),n=Ts(e,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=s,this._sphericalEnd.phi=n,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,i||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const o=!i||Wt(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Wt(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(t,e=!1){return this.dollyTo(this._sphericalEnd.radius-t,e)}dollyTo(t,e=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=Ia.NONE,this._changedDolly=0,this._dollyToNoClamp(Ts(t,this.minDistance,this.maxDistance),e)}_dollyToNoClamp(t,e=!1){const i=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const o=this._collisionTest(),a=Wt(o,this._spherical.radius);if(!(i>t)&&a)return Promise.resolve();this._sphericalEnd.radius=Math.min(t,o)}else this._sphericalEnd.radius=t;this._needsUpdate=!0,e||(this._spherical.radius=this._sphericalEnd.radius);const n=!e||Wt(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(n)}dollyInFixed(t,e=!1){this._targetEnd.add(this._getCameraDirection(Al).multiplyScalar(t)),e||this._target.copy(this._targetEnd);const i=!e||Wt(this._target.x,this._targetEnd.x,this.restThreshold)&&Wt(this._target.y,this._targetEnd.y,this.restThreshold)&&Wt(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}zoom(t,e=!1){return this.zoomTo(this._zoomEnd+t,e)}zoomTo(t,e=!1){this._isUserControllingZoom=!1,this._zoomEnd=Ts(t,this.minZoom,this.maxZoom),this._needsUpdate=!0,e||(this._zoom=this._zoomEnd);const i=!e||Wt(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(i)}pan(t,e,i=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(t,e,i)}truck(t,e,i=!1){this._camera.updateMatrix(),Bs.setFromMatrixColumn(this._camera.matrix,0),ks.setFromMatrixColumn(this._camera.matrix,1),Bs.multiplyScalar(t),ks.multiplyScalar(-e);const s=Mt.copy(Bs).add(ks),n=Yt.copy(this._targetEnd).add(s);return this.moveTo(n.x,n.y,n.z,i)}forward(t,e=!1){Mt.setFromMatrixColumn(this._camera.matrix,0),Mt.crossVectors(this._camera.up,Mt),Mt.multiplyScalar(t);const i=Yt.copy(this._targetEnd).add(Mt);return this.moveTo(i.x,i.y,i.z,e)}elevate(t,e=!1){return Mt.copy(this._camera.up).multiplyScalar(t),this.moveTo(this._targetEnd.x+Mt.x,this._targetEnd.y+Mt.y,this._targetEnd.z+Mt.z,e)}moveTo(t,e,i,s=!1){this._isUserControllingTruck=!1;const n=Mt.set(t,e,i).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,n,this.boundaryFriction),this._needsUpdate=!0,s||this._target.copy(this._targetEnd);const o=!s||Wt(this._target.x,this._targetEnd.x,this.restThreshold)&&Wt(this._target.y,this._targetEnd.y,this.restThreshold)&&Wt(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}lookInDirectionOf(t,e,i,s=!1){const a=Mt.set(t,e,i).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius);return this.setPosition(a.x,a.y,a.z,s)}fitToBox(t,e,{cover:i=!1,paddingLeft:s=0,paddingRight:n=0,paddingBottom:o=0,paddingTop:a=0}={}){const c=[],l=t.isBox3?Ca.copy(t):Ca.setFromObject(t);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const h=eb(this._sphericalEnd.theta,tb),u=eb(this._sphericalEnd.phi,tb);c.push(this.rotateTo(h,u,e));const d=Mt.setFromSpherical(this._sphericalEnd).normalize(),f=ab.setFromUnitVectors(d,Rm),p=Wt(Math.abs(d.y),1);p&&f.multiply(Sm.setFromAxisAngle(sd,h)),f.multiply(this._yAxisUpSpaceInverse);const m=ob.makeEmpty();Yt.copy(l.min).applyQuaternion(f),m.expandByPoint(Yt),Yt.copy(l.min).setX(l.max.x).applyQuaternion(f),m.expandByPoint(Yt),Yt.copy(l.min).setY(l.max.y).applyQuaternion(f),m.expandByPoint(Yt),Yt.copy(l.max).setZ(l.min.z).applyQuaternion(f),m.expandByPoint(Yt),Yt.copy(l.min).setZ(l.max.z).applyQuaternion(f),m.expandByPoint(Yt),Yt.copy(l.max).setY(l.min.y).applyQuaternion(f),m.expandByPoint(Yt),Yt.copy(l.max).setX(l.min.x).applyQuaternion(f),m.expandByPoint(Yt),Yt.copy(l.max).applyQuaternion(f),m.expandByPoint(Yt),m.min.x-=s,m.min.y-=o,m.max.x+=n,m.max.y+=a,f.setFromUnitVectors(Rm,d),p&&f.premultiply(Sm.invert()),f.premultiply(this._yAxisUpSpace);const g=m.getSize(Mt),I=m.getCenter(Yt).applyQuaternion(f);if(jr(this._camera)){const C=this.getDistanceToFitBox(g.x,g.y,g.z,i);c.push(this.moveTo(I.x,I.y,I.z,e)),c.push(this.dollyTo(C,e)),c.push(this.setFocalOffset(0,0,0,e))}else if(Kn(this._camera)){const C=this._camera,b=C.right-C.left,E=C.top-C.bottom,T=i?Math.max(b/g.x,E/g.y):Math.min(b/g.x,E/g.y);c.push(this.moveTo(I.x,I.y,I.z,e)),c.push(this.zoomTo(T,e)),c.push(this.setFocalOffset(0,0,0,e))}return Promise.all(c)}fitToSphere(t,e){const i=[],n=t instanceof St.Sphere?Am.copy(t):ii.createBoundingSphere(t,Am);if(i.push(this.moveTo(n.center.x,n.center.y,n.center.z,e)),jr(this._camera)){const o=this.getDistanceToFitSphere(n.radius);i.push(this.dollyTo(o,e))}else if(Kn(this._camera)){const o=this._camera.right-this._camera.left,a=this._camera.top-this._camera.bottom,c=2*n.radius,l=Math.min(o/c,a/c);i.push(this.zoomTo(l,e))}return i.push(this.setFocalOffset(0,0,0,e)),Promise.all(i)}setLookAt(t,e,i,s,n,o,a=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Ia.NONE,this._changedDolly=0;const c=Yt.set(s,n,o),l=Mt.set(t,e,i);this._targetEnd.copy(c),this._sphericalEnd.setFromVector3(l.sub(c).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,a||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const h=!a||Wt(this._target.x,this._targetEnd.x,this.restThreshold)&&Wt(this._target.y,this._targetEnd.y,this.restThreshold)&&Wt(this._target.z,this._targetEnd.z,this.restThreshold)&&Wt(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Wt(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Wt(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(h)}lerpLookAt(t,e,i,s,n,o,a,c,l,h,u,d,f,p=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Ia.NONE,this._changedDolly=0;const m=Mt.set(s,n,o),g=Yt.set(t,e,i);Mi.setFromVector3(g.sub(m).applyQuaternion(this._yAxisUpSpace));const I=Ea.set(h,u,d),C=Yt.set(a,c,l);Sl.setFromVector3(C.sub(I).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(m.lerp(I,f));const b=Sl.theta-Mi.theta,E=Sl.phi-Mi.phi,T=Sl.radius-Mi.radius;this._sphericalEnd.set(Mi.radius+T*f,Mi.phi+E*f,Mi.theta+b*f),this.normalizeRotations(),this._needsUpdate=!0,p||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const A=!p||Wt(this._target.x,this._targetEnd.x,this.restThreshold)&&Wt(this._target.y,this._targetEnd.y,this.restThreshold)&&Wt(this._target.z,this._targetEnd.z,this.restThreshold)&&Wt(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Wt(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Wt(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(A)}setPosition(t,e,i,s=!1){return this.setLookAt(t,e,i,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,s)}setTarget(t,e,i,s=!1){const n=this.getPosition(Mt),o=this.setLookAt(n.x,n.y,n.z,t,e,i,s);return this._sphericalEnd.phi=Ts(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(t,e,i,s=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(t,e,i),this._needsUpdate=!0,s||this._focalOffset.copy(this._focalOffsetEnd);const n=!s||Wt(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&Wt(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&Wt(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}setOrbitPoint(t,e,i){this._camera.updateMatrixWorld(),Bs.setFromMatrixColumn(this._camera.matrixWorldInverse,0),ks.setFromMatrixColumn(this._camera.matrixWorldInverse,1),Xr.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const s=Mt.set(t,e,i),n=s.distanceTo(this._camera.position),o=s.sub(this._camera.position);Bs.multiplyScalar(o.x),ks.multiplyScalar(o.y),Xr.multiplyScalar(o.z),Mt.copy(Bs).add(ks).add(Xr),Mt.z=Mt.z+n,this.dollyTo(n,!1),this.setFocalOffset(-Mt.x,Mt.y,-Mt.z,!1),this.moveTo(t,e,i,!1)}setBoundary(t){if(!t){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(t),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(t,e,i,s){if(t===null){this._viewport=null;return}this._viewport=this._viewport||new St.Vector4,typeof t=="number"?this._viewport.set(t,e,i,s):this._viewport.copy(t)}getDistanceToFitBox(t,e,i,s=!1){if(vm(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const n=t/e,o=this._camera.getEffectiveFOV()*yl,a=this._camera.aspect;return((s?n>a:n<a)?e:t/a)*.5/Math.tan(o*.5)+i*.5}getDistanceToFitSphere(t){if(vm(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const e=this._camera.getEffectiveFOV()*yl,i=Math.atan(Math.tan(e*.5)*this._camera.aspect)*2,s=1<this._camera.aspect?e:i;return t/Math.sin(s*.5)}getTarget(t,e=!0){return(t&&t.isVector3?t:new St.Vector3).copy(e?this._targetEnd:this._target)}getPosition(t,e=!0){return(t&&t.isVector3?t:new St.Vector3).setFromSpherical(e?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(e?this._targetEnd:this._target)}getSpherical(t,e=!0){return(t&&t instanceof St.Spherical?t:new St.Spherical).copy(e?this._sphericalEnd:this._spherical)}getFocalOffset(t,e=!0){return(t&&t.isVector3?t:new St.Vector3).copy(e?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%ga,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=ga),this._spherical.theta+=ga*Math.round((this._sphericalEnd.theta-this._spherical.theta)/ga)}reset(t=!1){if(!Wt(this._camera.up.x,this._cameraUp0.x)||!Wt(this._camera.up.y,this._cameraUp0.y)||!Wt(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const i=this.getPosition(Mt);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}const e=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,t),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,t),this.zoomTo(this._zoom0,t)];return Promise.all(e)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,sd),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const t=Mt.subVectors(this._target,this._camera.position).normalize(),e=Yt.crossVectors(t,this._camera.up);this._camera.up.crossVectors(e,t).normalize(),this._camera.updateMatrixWorld();const i=this.getPosition(Mt);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}update(t){const e=this._sphericalEnd.theta-this._spherical.theta,i=this._sphericalEnd.phi-this._spherical.phi,s=this._sphericalEnd.radius-this._spherical.radius,n=nb.subVectors(this._targetEnd,this._target),o=rb.subVectors(this._focalOffsetEnd,this._focalOffset),a=this._zoomEnd-this._zoom;if(se(e))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const u=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=ed(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,u,1/0,t),this._needsUpdate=!0}if(se(i))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const u=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=ed(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,u,1/0,t),this._needsUpdate=!0}if(se(s))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const u=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=ed(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,u,this.maxSpeed,t),this._needsUpdate=!0}if(se(n.x)&&se(n.y)&&se(n.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const u=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;ib(this._target,this._targetEnd,this._targetVelocity,u,this.maxSpeed,t,this._target),this._needsUpdate=!0}if(se(o.x)&&se(o.y)&&se(o.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const u=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;ib(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,u,this.maxSpeed,t,this._focalOffset),this._needsUpdate=!0}if(se(a))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const u=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=ed(this._zoom,this._zoomEnd,this._zoomVelocity,u,1/0,t)}if(this.dollyToCursor){if(jr(this._camera)&&this._changedDolly!==0){const u=this._spherical.radius-this._lastDistance,d=this._camera,f=this._getCameraDirection(Al),p=Mt.copy(f).cross(d.up).normalize();p.lengthSq()===0&&(p.x=1);const m=Yt.crossVectors(p,f),g=this._sphericalEnd.radius*Math.tan(d.getEffectiveFOV()*yl*.5),C=(this._sphericalEnd.radius-u-this._sphericalEnd.radius)/this._sphericalEnd.radius,b=Ea.copy(this._targetEnd).add(p.multiplyScalar(this._dollyControlCoord.x*g*d.aspect)).add(m.multiplyScalar(this._dollyControlCoord.y*g)),E=Mt.copy(this._targetEnd).lerp(b,C),T=this._lastDollyDirection===Ia.IN&&this._spherical.radius<=this.minDistance,A=this._lastDollyDirection===Ia.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(T||A)){this._sphericalEnd.radius-=u,this._spherical.radius-=u;const _=Yt.copy(f).multiplyScalar(-u);E.add(_)}this._boundary.clampPoint(E,E);const S=Yt.subVectors(E,this._targetEnd);this._targetEnd.copy(E),this._target.add(S),this._changedDolly-=u,se(this._changedDolly)&&(this._changedDolly=0)}else if(Kn(this._camera)&&this._changedZoom!==0){const u=this._zoom-this._lastZoom,d=this._camera,f=Mt.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(d.near+d.far)/(d.near-d.far)).unproject(d),p=Yt.set(0,0,-1).applyQuaternion(d.quaternion),m=Ea.copy(f).add(p.multiplyScalar(-f.dot(d.up))),I=-(this._zoom-u-this._zoom)/this._zoom,C=this._getCameraDirection(Al),b=this._targetEnd.dot(C),E=Mt.copy(this._targetEnd).lerp(m,I),T=E.dot(C),A=C.multiplyScalar(T-b);E.sub(A),this._boundary.clampPoint(E,E);const S=Yt.subVectors(E,this._targetEnd);this._targetEnd.copy(E),this._target.add(S),this._changedZoom-=u,se(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const c=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,c),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!se(this._focalOffset.x)||!se(this._focalOffset.y)||!se(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),Bs.setFromMatrixColumn(this._camera.matrix,0),ks.setFromMatrixColumn(this._camera.matrix,1),Xr.setFromMatrixColumn(this._camera.matrix,2),Bs.multiplyScalar(this._focalOffset.x),ks.multiplyScalar(-this._focalOffset.y),Xr.multiplyScalar(this._focalOffset.z),Mt.copy(Bs).add(ks).add(Xr),this._camera.position.add(Mt)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),Mt.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const h=this._needsUpdate;return h&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):h?(this.dispatchEvent({type:"update"}),se(e,this.restThreshold)&&se(i,this.restThreshold)&&se(s,this.restThreshold)&&se(n.x,this.restThreshold)&&se(n.y,this.restThreshold)&&se(n.z,this.restThreshold)&&se(o.x,this.restThreshold)&&se(o.y,this.restThreshold)&&se(o.z,this.restThreshold)&&se(a,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!h&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=h,this._needsUpdate=!1,h}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:vl(this.maxDistance),minZoom:this.minZoom,maxZoom:vl(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:vl(this.maxPolarAngle),minAzimuthAngle:vl(this.minAzimuthAngle),maxAzimuthAngle:vl(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:Mt.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(t,e=!1){const i=JSON.parse(t);this.enabled=i.enabled,this.minDistance=i.minDistance,this.maxDistance=Rl(i.maxDistance),this.minZoom=i.minZoom,this.maxZoom=Rl(i.maxZoom),this.minPolarAngle=i.minPolarAngle,this.maxPolarAngle=Rl(i.maxPolarAngle),this.minAzimuthAngle=Rl(i.minAzimuthAngle),this.maxAzimuthAngle=Rl(i.maxAzimuthAngle),this.smoothTime=i.smoothTime,this.draggingSmoothTime=i.draggingSmoothTime,this.dollySpeed=i.dollySpeed,this.truckSpeed=i.truckSpeed,this.dollyToCursor=i.dollyToCursor,this.verticalDragToForward=i.verticalDragToForward,this._target0.fromArray(i.target0),this._position0.fromArray(i.position0),this._zoom0=i.zoom0,this._focalOffset0.fromArray(i.focalOffset0),this.moveTo(i.target[0],i.target[1],i.target[2],e),Mi.setFromVector3(Mt.fromArray(i.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(Mi.theta,Mi.phi,e),this.dollyTo(Mi.radius,e),this.zoomTo(i.zoom,e),this.setFocalOffset(i.focalOffset[0],i.focalOffset[1],i.focalOffset[2],e),this._needsUpdate=!0}connect(t){if(this._domElement){console.warn("camera-controls is already connected.");return}t.setAttribute("data-camera-controls-version",cL),this._addAllEventListeners(t),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(t){return t.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(t){return this._getTargetDirection(t).negate()}_findPointerById(t){return this._activePointers.find(e=>e.pointerId===t)}_findPointerByMouseButton(t){return this._activePointers.find(e=>e.mouseButton===t)}_disposePointer(t){this._activePointers.splice(this._activePointers.indexOf(t),1)}_encloseToBoundary(t,e,i){const s=e.lengthSq();if(s===0)return t;const n=Yt.copy(e).add(t),a=this._boundary.clampPoint(n,Ea).sub(n),c=a.lengthSq();if(c===0)return t.add(e);if(c===s)return t;if(i===0)return t.add(e).add(a);{const l=1+i*c/e.dot(a);return t.add(Yt.copy(e).multiplyScalar(l)).add(a.multiplyScalar(1-i))}}_updateNearPlaneCorners(){if(jr(this._camera)){const t=this._camera,e=t.near,i=t.getEffectiveFOV()*yl,s=Math.tan(i*.5)*e,n=s*t.aspect;this._nearPlaneCorners[0].set(-n,-s,0),this._nearPlaneCorners[1].set(n,-s,0),this._nearPlaneCorners[2].set(n,s,0),this._nearPlaneCorners[3].set(-n,s,0)}else if(Kn(this._camera)){const t=this._camera,e=1/t.zoom,i=t.left*e,s=t.right*e,n=t.top*e,o=t.bottom*e;this._nearPlaneCorners[0].set(i,n,0),this._nearPlaneCorners[1].set(s,n,0),this._nearPlaneCorners[2].set(s,o,0),this._nearPlaneCorners[3].set(i,o,0)}}_collisionTest(){let t=1/0;if(!(this.colliderMeshes.length>=1)||vm(this._camera,"_collisionTest"))return t;const i=this._getTargetDirection(Al);wm.lookAt(sb,i,this._camera.up);for(let s=0;s<4;s++){const n=Yt.copy(this._nearPlaneCorners[s]);n.applyMatrix4(wm);const o=Ea.addVectors(this._target,n);nd.set(o,i),nd.far=this._spherical.radius+1;const a=nd.intersectObjects(this.colliderMeshes);a.length!==0&&a[0].distance<t&&(t=a[0].distance)}return t}_getClientRect(t){if(!this._domElement)return;const e=this._domElement.getBoundingClientRect();return t.x=e.left,t.y=e.top,this._viewport?(t.x+=this._viewport.x,t.y+=e.height-this._viewport.w-this._viewport.y,t.width=this._viewport.z,t.height=this._viewport.w):(t.width=e.width,t.height=e.height),t}_createOnRestPromise(t){return t?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(e=>{const i=()=>{this.removeEventListener("rest",i),e()};this.addEventListener("rest",i)}))}_addAllEventListeners(t){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(t){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(t){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(t,e=new St.Sphere){const i=e,s=i.center;Ca.makeEmpty(),t.traverseVisible(o=>{o.isMesh&&Ca.expandByObject(o)}),Ca.getCenter(s);let n=0;return t.traverseVisible(o=>{if(!o.isMesh)return;const a=o,c=a.geometry.clone();c.applyMatrix4(a.matrixWorld);const h=c.attributes.position;for(let u=0,d=h.count;u<d;u++)Mt.fromBufferAttribute(h,u),n=Math.max(n,s.distanceToSquared(Mt))}),i.radius=Math.sqrt(n),i}}class _h extends F2{constructor(t){super(t),L(this,"onBeforeUpdate",new It),L(this,"onAfterUpdate",new It),L(this,"onAspectUpdated",new It),L(this,"onDisposed",new It),L(this,"three"),L(this,"_allControls",new Map),L(this,"updateAspect",()=>{var e;if(!(!this.currentWorld||!this.currentWorld.renderer)){if(this.three instanceof cs){this.onAspectUpdated.trigger();return}if((e=this.currentWorld.renderer)!=null&&e.isResizeable()){const i=this.currentWorld.renderer.getSize();this.three.aspect=i.width/i.height,this.three.updateProjectionMatrix(),this.onAspectUpdated.trigger()}}}),this.three=this.setupCamera(),this.setupEvents(!0),this.onWorldChanged.add(({action:e,world:i})=>{if(e==="added"){const s=this.newCameraControls();this._allControls.set(i.uuid,s)}if(e==="removed"){const s=this._allControls.get(i.uuid);s&&(s.dispose(),this._allControls.delete(i.uuid))}})}get controls(){if(!this.currentWorld)throw new Error("This camera needs a world to work!");const t=this._allControls.get(this.currentWorld.uuid);if(!t)throw new Error("Controls not found!");return t}get enabled(){return this.currentWorld===null?!1:this.controls.enabled}set enabled(t){this.currentWorld!==null&&(this.controls.enabled=t)}dispose(){this.setupEvents(!1),this.onAspectUpdated.reset(),this.onBeforeUpdate.reset(),this.onAfterUpdate.reset(),this.three.removeFromParent(),this.onDisposed.trigger(),this.onDisposed.reset();for(const[t,e]of this._allControls)e.dispose()}update(t){this.enabled&&(this.onBeforeUpdate.trigger(this),this.controls.update(t),this.onAfterUpdate.trigger(this))}setupCamera(){const t=window.innerWidth/window.innerHeight,e=new hr(60,t,1,1e3);return e.position.set(50,50,50),e.lookAt(new M(0,0,0)),e}newCameraControls(){if(!this.currentWorld)throw new Error("This camera needs a world to work!");if(!this.currentWorld.renderer)throw new Error("This camera needs a renderer to work!");ii.install({THREE:_h.getSubsetOfThree()});const{domElement:t}=this.currentWorld.renderer.three,e=new ii(this.three,t);return e.smoothTime=.2,e.dollyToCursor=!0,e.infinityDolly=!0,e.minDistance=6,e}setupEvents(t){t?window.addEventListener("resize",this.updateAspect):window.removeEventListener("resize",this.updateAspect)}static getSubsetOfThree(){return{MOUSE:Ly,Vector2:Ot,Vector3:M,Vector4:Do,Quaternion:Ce,Matrix4:ht,Spherical:My,Box3:vt,Sphere:as,Raycaster:Mo,MathUtils:Ss}}}const iR=class sR extends oe{constructor(t){super(t),L(this,"onAfterUpdate",new It),L(this,"onBeforeUpdate",new It),L(this,"onDisposed",new It),L(this,"list",new Os),L(this,"enabled",!0),t.add(sR.uuid,this)}create(){const t=new Qv(this.components),e=t.uuid;if(this.list.has(e))throw new Error("There is already a world with this name!");return this.list.set(e,t),t}delete(t){if(!this.list.has(t.uuid))throw new Error("The provided world is not found in the list!");this.list.delete(t.uuid),t.dispose()}dispose(){this.enabled=!1;for(const[t,e]of this.list)e.dispose();this.list.clear(),this.onDisposed.trigger()}update(t){if(this.enabled)for(const[e,i]of this.list)i.update(t)}};L(iR,"uuid","fdb61dc4-2ec1-4966-b83d-54ea795fad4a");let $o=iR;function uL(r,t,e,i){return new Promise((s,n)=>{function o(){const a=r.clientWaitSync(t,e,0);if(a===r.WAIT_FAILED){n();return}if(a===r.TIMEOUT_EXPIRED){setTimeout(o,i);return}s()}o()})}async function dL(r,t,e,i,s,n,o){const a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);r.flush(),await uL(r,a,0,10),r.deleteSync(a),r.bindBuffer(t,e),r.getBufferSubData(t,i,s,n,o),r.bindBuffer(t,null)}async function fL(r,t,e,i,s,n,o,a){const c=r.createBuffer();return r.bindBuffer(r.PIXEL_PACK_BUFFER,c),r.bufferData(r.PIXEL_PACK_BUFFER,a.byteLength,r.STREAM_READ),r.readPixels(t,e,i,s,n,o,0),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),await dL(r,r.PIXEL_PACK_BUFFER,c,0,a),r.deleteBuffer(c),a}class pL extends Ho{constructor(){super(...arguments),L(this,"_config",{enabled:{value:!0,type:"Boolean"},width:{type:"Number",interpolable:!0,value:512,min:32,max:1024},height:{type:"Number",interpolable:!0,value:512,min:32,max:1024},autoUpdate:{value:!0,type:"Boolean"},renderDebugFrame:{value:!1,type:"Boolean"},updateInterval:{type:"Number",interpolable:!0,value:1,min:0,max:1},threshold:{type:"Number",interpolable:!0,value:100,min:1,max:512}}),L(this,"_interval",null)}get enabled(){return this._config.enabled.value}set enabled(t){this._config.enabled.value=t,this._component.enabled=t}get width(){return this._config.width.value}set width(t){this.setWidthHeight(t,this.height)}get height(){return this._config.height.value}set height(t){this.setWidthHeight(this.width,t)}get autoUpdate(){return this._config.autoUpdate.value}set autoUpdate(t){this.setAutoAndInterval(t,this.updateInterval)}get updateInterval(){return this._config.updateInterval.value}set updateInterval(t){this.setAutoAndInterval(this.autoUpdate,t)}get renderDebugFrame(){return this._config.renderDebugFrame.value}set renderDebugFrame(t){this._config.renderDebugFrame.value=t}get threshold(){return this._config.threshold.value}set threshold(t){this._config.threshold.value=t}setWidthHeight(t,e){if(t<=0||e<=0)throw new Error("The width and height of the culler renderer must be more than 0!");this._config.width.value=t,this._config.height.value=e,this.resetRenderTarget()}setAutoAndInterval(t,e){if(e<=0)throw new Error("The updateInterval of the culler renderer must be more than 0!");this._config.autoUpdate.value=t,this._config.updateInterval.value=e,this.resetInterval(t)}resetRenderTarget(){this._component.renderTarget.dispose(),this._component.renderTarget=new ts(this.width,this.height),this._component.bufferSize=this.width*this.height*4,this._component.buffer=new Uint8Array(this._component.bufferSize)}resetInterval(t){this._interval!==null&&window.clearInterval(this._interval),t&&(this._interval=window.setInterval(async()=>{this._component.preventUpdate||await this._component.updateVisibility()},this.updateInterval))}}class mL{constructor(t,e){if(L(this,"onSetup",new It),L(this,"onDisposed",new It),L(this,"onViewUpdated",new pr),L(this,"enabled",!0),L(this,"needsUpdate",!1),L(this,"components"),L(this,"renderTarget",new ts),L(this,"bufferSize",1),L(this,"buffer",new Uint8Array),L(this,"preventUpdate",!1),L(this,"config"),L(this,"isSetup",!1),L(this,"world"),L(this,"renderer"),L(this,"_defaultConfig",{enabled:!0,height:512,width:512,updateInterval:1e3,autoUpdate:!0,renderDebugFrame:!1,threshold:100}),L(this,"worker"),L(this,"scene",new rn),L(this,"_availableColor",1),L(this,"_isWorkerBusy",!1),L(this,"updateVisibility",async n=>{if(!this.enabled||!this.needsUpdate&&!n||this._isWorkerBusy)return;this._isWorkerBusy=!0;const o=this.world.camera.three;o.updateMatrix();const{width:a,height:c}=this.config;this.renderer.setSize(a,c),this.renderer.setRenderTarget(this.renderTarget),this.renderer.render(this.scene,o);const l=this.renderer.getContext();await fL(l,0,0,a,c,l.RGBA,l.UNSIGNED_BYTE,this.buffer),this.renderer.setRenderTarget(null),this.config.renderDebugFrame&&this.renderer.render(this.scene,o),this.worker.postMessage({buffer:this.buffer}),this.needsUpdate=!1}),!e.renderer)throw new Error("The given world must have a renderer!");this.components=t,this.config=new pL(this,this.components,"Culler renderer"),this.world=e,this.renderer=new Qa,this.renderer.clippingPlanes=e.renderer.clippingPlanes;const i=`
      addEventListener("message", (event) => {
        const { buffer } = event.data;
        const colors = new Map();
        for (let i = 0; i < buffer.length; i += 4) {
          const r = buffer[i];
          const g = buffer[i + 1];
          const b = buffer[i + 2];
          const code = "" + r + "-" + g + "-" + b;
          if(colors.has(code)) {
            colors.set(code, colors.get(code) + 1);
          } else {
            colors.set(code, 1);
          }
        }
        postMessage({ colors });
      });
    `,s=new Blob([i],{type:"application/javascript"});this.worker=new Worker(URL.createObjectURL(s)),this.setup()}dispose(){this.enabled=!1,this.config.autoUpdate=!1,this.components.get(tu).list.delete(this.config.uuid);for(const e of this.scene.children)e.removeFromParent();this.onViewUpdated.reset(),this.worker.terminate(),this.renderer.forceContextLoss(),this.renderer.dispose(),this.renderTarget.dispose(),this.buffer=null,this.onDisposed.reset()}setup(t){const e={...this._defaultConfig,...t},{width:i,height:s}=e;this.config.setWidthHeight(i,s);const{updateInterval:n,autoUpdate:o}=e;this.config.setAutoAndInterval(o,n),this.config.threshold=e.threshold,this.isSetup=!0,this.onSetup.trigger()}getAvailableColor(){let t=BigInt(this._availableColor.toString());const e=[];do e.unshift(Number(t%256n)),t/=256n;while(t);for(;e.length!==3;)e.unshift(0);const[i,s,n]=e,o=`${i}-${s}-${n}`;return{r:i,g:s,b:n,code:o}}increaseColor(){if(this._availableColor===256*256*256){console.warn("Color can't be increased over 256 x 256 x 256!");return}this._availableColor++}decreaseColor(){if(this._availableColor===1){console.warn("Color can't be decreased under 0!");return}this._availableColor--}}class IL extends mL{constructor(t,e){super(t,e),L(this,"onViewUpdated",new It),L(this,"colorMeshes",new Map),L(this,"_colorCodeMeshMap",new Map),L(this,"_meshIDColorCodeMap",new Map),L(this,"_currentVisibleMeshes",new Set),L(this,"_recentlyHiddenMeshes",new Set),L(this,"_transparentMat",new Ue({transparent:!0,opacity:0})),L(this,"handleWorkerMessage",async i=>{if(this.preventUpdate)return;const s=i.data.colors;this._recentlyHiddenMeshes=new Set(this._currentVisibleMeshes),this._currentVisibleMeshes.clear();for(const[n,o]of s){if(o<this.config.threshold)continue;const a=this._colorCodeMeshMap.get(n);a&&(this._currentVisibleMeshes.add(a),this._recentlyHiddenMeshes.delete(a))}this.onViewUpdated.trigger({seen:this._currentVisibleMeshes,unseen:this._recentlyHiddenMeshes}),this._isWorkerBusy=!1}),this.worker.addEventListener("message",this.handleWorkerMessage),this.onViewUpdated.add(({seen:i,unseen:s})=>{for(const n of i)n.visible=!0;for(const n of s)n.visible=!1})}get threshold(){return this.config.threshold}set threshold(t){this.config.threshold=t}dispose(){super.dispose(),this._currentVisibleMeshes.clear(),this._recentlyHiddenMeshes.clear(),this._meshIDColorCodeMap.clear(),this._transparentMat.dispose(),this._colorCodeMeshMap.clear();const t=this.components.get(ac);for(const e in this.colorMeshes){const i=this.colorMeshes.get(e);i&&t.destroy(i,!0)}this.colorMeshes.clear()}add(t){if(!this.enabled)return;if(this.preventUpdate){console.log("Culler processing not finished yet.");return}this.preventUpdate=!0;const e=t instanceof Pe,{geometry:i,material:s}=t,{colorMaterial:n,code:o}=this.getAvailableMaterial();let a;if(Array.isArray(s)){let h=!0;const u=[];for(const d of s)KC.isTransparent(d)?u.push(this._transparentMat):(h=!1,u.push(n));if(h){n.dispose(),this.preventUpdate=!1;return}a=u}else if(KC.isTransparent(s)){n.dispose(),this.preventUpdate=!1;return}else a=n;this._colorCodeMeshMap.set(o,t),this._meshIDColorCodeMap.set(t.uuid,o);const c=e?t.count:1,l=new Pe(i,a,c);e?l.instanceMatrix=t.instanceMatrix:l.setMatrixAt(0,new ht),t.visible=!1,t.updateWorldMatrix(!0,!1),l.applyMatrix4(t.matrixWorld),l.updateMatrix(),this.scene.add(l),this.colorMeshes.set(t.uuid,l),this.increaseColor(),this.preventUpdate=!1}remove(t){if(this.preventUpdate){console.log("Culler processing not finished yet.");return}this.preventUpdate=!0;const e=this.components.get(ac);this._currentVisibleMeshes.delete(t),this._recentlyHiddenMeshes.delete(t);const i=this.colorMeshes.get(t.uuid),s=this._meshIDColorCodeMap.get(t.uuid);if(!i||!s){this.preventUpdate=!1;return}this._colorCodeMeshMap.delete(s),this._meshIDColorCodeMap.delete(t.uuid),this.colorMeshes.delete(t.uuid),i.geometry=void 0,i.material=[],e.destroy(i,!0),this._recentlyHiddenMeshes.delete(t),this._currentVisibleMeshes.delete(t),this.preventUpdate=!1}updateInstanced(t){for(const e of t){const i=this.colorMeshes.get(e.uuid);i&&(i.count=e.count)}}getAvailableMaterial(){const{r:t,g:e,b:i,code:s}=this.getAvailableColor(),n=ki.enabled;ki.enabled=!1;const o=new Rt(`rgb(${t}, ${e}, ${i})`);if(!this.world.renderer)throw new Error("Renderer not found in the world!");const a=this.world.renderer.clippingPlanes,c=new Ue({color:o,clippingPlanes:a,side:Ps});return ki.enabled=n,{colorMaterial:c,code:s}}}const nR=class ZI extends oe{constructor(t){super(t),L(this,"onDisposed",new It),L(this,"_enabled",!0),L(this,"list",new Map),t.add(ZI.uuid,this)}get enabled(){return this._enabled}set enabled(t){this._enabled=t;for(const[e,i]of this.list)i.enabled=t}create(t){if(this.list.has(t.uuid))return this.list.get(t.uuid);const e=new IL(this.components,t);return this.list.set(t.uuid,e),e}delete(t){const e=this.list.get(t.uuid);e&&e.dispose(),this.list.delete(t.uuid)}dispose(){this.enabled=!1,this.onDisposed.trigger(ZI.uuid),this.onDisposed.reset();for(const[t,e]of this.list)e.dispose();this.list.clear()}updateInstanced(t){for(const[,e]of this.list)e.updateInstanced(t)}};L(nR,"uuid","69f2a50d-c266-44fc-b1bd-fa4d34be89e6");let gL=nR;class EL{constructor(t){L(this,"_event"),L(this,"_position",new Ot),L(this,"onDisposed",new It),L(this,"updateMouseInfo",e=>{this._event=e}),this.dom=t,this.setupEvents(!0)}get position(){if(this._event){const t=this.dom.getBoundingClientRect();this._position.x=this.getPositionX(t,this._event),this._position.y=this.getPositionY(t,this._event)}return this._position}dispose(){this.setupEvents(!1),this.onDisposed.trigger(),this.onDisposed.reset()}getPositionY(t,e){return-((this.getDataObject(e).clientY-t.top)/(t.bottom-t.top))*2+1}getPositionX(t,e){return(this.getDataObject(e).clientX-t.left)/(t.right-t.left)*2-1}getDataObject(t){return t instanceof MouseEvent?t:t.touches[0]}setupEvents(t){t?(this.dom.addEventListener("pointermove",this.updateMouseInfo),this.dom.addEventListener("touchstart",this.updateMouseInfo)):(this.dom.removeEventListener("pointermove",this.updateMouseInfo),this.dom.removeEventListener("touchstart",this.updateMouseInfo))}}class CL{constructor(t,e){L(this,"enabled",!0),L(this,"components"),L(this,"onDisposed",new It),L(this,"mouse"),L(this,"three",new Mo),L(this,"world");const i=e.renderer;if(!i)throw new Error("A renderer is needed for the raycaster to work!");this.world=e,this.mouse=new EL(i.three.domElement),this.components=t}dispose(){this.mouse.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}castRay(t=Array.from(this.world.meshes),e=this.mouse.position){if(!this.world)throw new Error("A world is needed to cast rays!");const i=this.world.camera.three;return this.three.setFromCamera(e,i),this.intersect(t)}castRayFromVector(t,e,i=Array.from(this.world.meshes)){return this.three.set(t,e),this.intersect(i)}intersect(t=Array.from(this.world.meshes)){const e=this.three.intersectObjects(t),i=this.filterClippingPlanes(e);return i.length>0?i[0]:null}filterClippingPlanes(t){if(!this.world.renderer)throw new Error("Renderer not found!");const e=this.world.renderer.three;if(!e.clippingPlanes)return t;const i=e.clippingPlanes;return t.length<=0||!i||i?.length<=0?t:t.filter(s=>i.every(n=>n.distanceToPoint(s.point)>0))}}const rR=class oR extends oe{constructor(t){super(t),L(this,"enabled",!0),L(this,"list",new Map),L(this,"onDisposed",new It),t.add(oR.uuid,this)}get(t){if(this.list.has(t.uuid))return this.list.get(t.uuid);const e=new CL(this.components,t);return this.list.set(t.uuid,e),t.onDisposed.add(()=>{this.delete(t)}),e}delete(t){const e=this.list.get(t.uuid);e&&e.dispose(),this.list.delete(t.uuid)}dispose(){for(const[t,e]of this.list)e.dispose();this.list.clear(),this.onDisposed.trigger()}};L(rR,"uuid","d5d8bdf0-db25-4952-b951-b643af207ace");let qI=rR;class bL extends Ho{constructor(){super(...arguments),L(this,"_config",{visible:{value:!0,type:"Boolean"},color:{value:new Rt,type:"Color"},primarySize:{type:"Number",interpolable:!0,value:1,min:0,max:1e3},secondarySize:{type:"Number",interpolable:!0,value:10,min:0,max:1e3},distance:{type:"Number",interpolable:!0,value:500,min:0,max:500}})}get visible(){return this._config.visible.value}set visible(t){this._config.visible.value=t,this._component.visible=t}get color(){return this._config.color.value}set color(t){this._config.color.value=t,this._component.material.uniforms.uColor.value=t,this._component.material.uniformsNeedUpdate=!0}get primarySize(){return this._config.primarySize.value}set primarySize(t){this._config.primarySize.value=t,this._component.material.uniforms.uSize1.value=t,this._component.material.uniformsNeedUpdate=!0}get secondarySize(){return this._config.secondarySize.value}set secondarySize(t){this._config.secondarySize.value=t,this._component.material.uniforms.uSize2.value=t,this._component.material.uniformsNeedUpdate=!0}get distance(){return this._config.distance.value}set distance(t){this._config.distance.value=t,this._component.material.uniforms.uDistance.value=t,this._component.material.uniformsNeedUpdate=!0}}class TL{constructor(t,e){L(this,"onDisposed",new It),L(this,"onSetup",new It),L(this,"isSetup",!1),L(this,"world"),L(this,"components"),L(this,"config"),L(this,"_defaultConfig",{visible:!0,color:new Rt(12303291),primarySize:1,secondarySize:10,distance:500}),L(this,"three"),L(this,"_fade",3),L(this,"updateZoom",()=>{this.world.camera instanceof _h&&(this.material.uniforms.uZoom.value=this.world.camera.three.zoom)}),this.world=e;const{color:i,primarySize:s,secondarySize:n,distance:o}=this._defaultConfig;this.components=t,this.config=new bL(this,this.components,"Grid");const a=new Uo(2,2,1,1),c=new qe({side:Ps,uniforms:{uSize1:{value:s},uSize2:{value:n},uColor:{value:i},uDistance:{value:o},uFade:{value:this._fade},uZoom:{value:1}},transparent:!0,vertexShader:`
            
            varying vec3 worldPosition;
            
            uniform float uDistance;
            
            void main() {
            
                    vec3 pos = position.xzy * uDistance;
                    pos.xz += cameraPosition.xz;
                    
                    worldPosition = pos;
                    
                    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
            
            }
            `,fragmentShader:`
            
            varying vec3 worldPosition;
            
            uniform float uZoom;
            uniform float uFade;
            uniform float uSize1;
            uniform float uSize2;
            uniform vec3 uColor;
            uniform float uDistance;
                
                
                
                float getGrid(float size) {
                
                    vec2 r = worldPosition.xz / size;
                    
                    
                    vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
                    float line = min(grid.x, grid.y);
                    
                
                    return 1.0 - min(line, 1.0);
                }
                
            void main() {
            
                    
                    float d = 1.0 - min(distance(cameraPosition.xz, worldPosition.xz) / uDistance, 1.0);
                    
                    float g1 = getGrid(uSize1);
                    float g2 = getGrid(uSize2);
                    
                    // Ortho camera fades the grid away when zooming out
                    float minZoom = step(0.2, uZoom);
                    float zoomFactor = pow(min(uZoom, 1.), 2.) * minZoom;
                    
                    gl_FragColor = vec4(uColor.rgb, mix(g2, g1, g1) * pow(d, uFade));
                    gl_FragColor.a = mix(0.5 * gl_FragColor.a, gl_FragColor.a, g2) * zoomFactor;
                    
                    if ( gl_FragColor.a <= 0.0 ) discard;
                    
            
            }
            
            `,extensions:{derivatives:!0}});this.three=new it(a,c),this.three.frustumCulled=!1,e.scene.three.add(this.three),this.setupEvents(!0)}get visible(){return this.three.visible}set visible(t){t?this.world.scene.three.add(this.three):this.three.removeFromParent()}get material(){return this.three.material}get fade(){return this._fade===3}set fade(t){this._fade=t?3:0,this.material.uniforms.uFade.value=this._fade}setup(t){const e={...this._defaultConfig,...t};this.config.visible=!0,this.config.color=e.color,this.config.primarySize=e.primarySize,this.config.secondarySize=e.secondarySize,this.config.distance=e.distance,this.isSetup=!0,this.onSetup.trigger()}dispose(){this.setupEvents(!1),this.components.get(tu).list.delete(this.config.uuid),this.components.get(ac).destroy(this.three),this.onDisposed.trigger(),this.onDisposed.reset(),this.world=null,this.components=null}setupEvents(t){if(this.world.isDisposing||!(this.world.camera instanceof _h))return;const e=this.world.camera.controls;t?e.addEventListener("update",this.updateZoom):e.removeEventListener("update",this.updateZoom)}}const aR=class cR extends oe{constructor(t){super(t),L(this,"list",new Map),L(this,"onDisposed",new It),L(this,"enabled",!0),t.add(cR.uuid,this)}create(t){if(this.list.has(t.uuid))throw new Error("This world already has a grid!");const e=new TL(this.components,t);return this.list.set(t.uuid,e),t.onDisposed.add(()=>{this.delete(t)}),e}delete(t){const e=this.list.get(t.uuid);e&&e.dispose(),this.list.delete(t.uuid)}dispose(){for(const[t,e]of this.list)e.dispose();this.list.clear(),this.onDisposed.trigger(),this.onDisposed.reset()}};L(aR,"uuid","d1e814d5-b81c-4452-87a2-f039375e0489");let PE=aR;const Zr=new Mo,Je=new M,jn=new M,de=new Ce,cb={X:new M(1,0,0),Y:new M(0,1,0),Z:new M(0,0,1)},_m={type:"change"},lb={type:"mouseDown"},hb={type:"mouseUp",mode:null},ub={type:"objectChange"};class yL extends ws{constructor(t,e){super(),e===void 0&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),e=document),this.isTransformControls=!0,this.visible=!1,this.domElement=e,this.domElement.style.touchAction="none";const i=new _L;this._gizmo=i,this.add(i);const s=new FL;this._plane=s,this.add(s);const n=this;function o(C,b){let E=b;Object.defineProperty(n,C,{get:function(){return E!==void 0?E:b},set:function(T){E!==T&&(E=T,s[C]=T,i[C]=T,n.dispatchEvent({type:C+"-changed",value:T}),n.dispatchEvent(_m))}}),n[C]=b,s[C]=b,i[C]=b}o("camera",t),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const a=new M,c=new M,l=new Ce,h=new Ce,u=new M,d=new Ce,f=new M,p=new M,m=new M,g=0,I=new M;o("worldPosition",a),o("worldPositionStart",c),o("worldQuaternion",l),o("worldQuaternionStart",h),o("cameraPosition",u),o("cameraQuaternion",d),o("pointStart",f),o("pointEnd",p),o("rotationAxis",m),o("rotationAngle",g),o("eye",I),this._offset=new M,this._startNorm=new M,this._endNorm=new M,this._cameraScale=new M,this._parentPosition=new M,this._parentQuaternion=new Ce,this._parentQuaternionInv=new Ce,this._parentScale=new M,this._worldScaleStart=new M,this._worldQuaternionInv=new Ce,this._worldScale=new M,this._positionStart=new M,this._quaternionStart=new Ce,this._scaleStart=new M,this._getPointer=vL.bind(this),this._onPointerDown=AL.bind(this),this._onPointerHover=RL.bind(this),this._onPointerMove=SL.bind(this),this._onPointerUp=wL.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(t){if(this.object===void 0||this.dragging===!0)return;Zr.setFromCamera(t,this.camera);const e=Fm(this._gizmo.picker[this.mode],Zr);e?this.axis=e.object.name:this.axis=null}pointerDown(t){if(!(this.object===void 0||this.dragging===!0||t.button!==0)&&this.axis!==null){Zr.setFromCamera(t,this.camera);const e=Fm(this._plane,Zr,!0);e&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(e.point).sub(this.worldPositionStart)),this.dragging=!0,lb.mode=this.mode,this.dispatchEvent(lb)}}pointerMove(t){const e=this.axis,i=this.mode,s=this.object;let n=this.space;if(i==="scale"?n="local":(e==="E"||e==="XYZE"||e==="XYZ")&&(n="world"),s===void 0||e===null||this.dragging===!1||t.button!==-1)return;Zr.setFromCamera(t,this.camera);const o=Fm(this._plane,Zr,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),i==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),n==="local"&&e!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),e.indexOf("X")===-1&&(this._offset.x=0),e.indexOf("Y")===-1&&(this._offset.y=0),e.indexOf("Z")===-1&&(this._offset.z=0),n==="local"&&e!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),s.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(n==="local"&&(s.position.applyQuaternion(de.copy(this._quaternionStart).invert()),e.search("X")!==-1&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.position.applyQuaternion(this._quaternionStart)),n==="world"&&(s.parent&&s.position.add(Je.setFromMatrixPosition(s.parent.matrixWorld)),e.search("X")!==-1&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.parent&&s.position.sub(Je.setFromMatrixPosition(s.parent.matrixWorld))));else if(i==="scale"){if(e.search("XYZ")!==-1){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),jn.set(a,a,a)}else Je.copy(this.pointStart),jn.copy(this.pointEnd),Je.applyQuaternion(this._worldQuaternionInv),jn.applyQuaternion(this._worldQuaternionInv),jn.divide(Je),e.search("X")===-1&&(jn.x=1),e.search("Y")===-1&&(jn.y=1),e.search("Z")===-1&&(jn.z=1);s.scale.copy(this._scaleStart).multiply(jn),this.scaleSnap&&(e.search("X")!==-1&&(s.scale.x=Math.round(s.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Y")!==-1&&(s.scale.y=Math.round(s.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Z")!==-1&&(s.scale.z=Math.round(s.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(i==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(Je.setFromMatrixPosition(this.camera.matrixWorld));let c=!1;e==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(Je.copy(this.rotationAxis).cross(this.eye))*a):(e==="X"||e==="Y"||e==="Z")&&(this.rotationAxis.copy(cb[e]),Je.copy(cb[e]),n==="local"&&Je.applyQuaternion(this.worldQuaternion),Je.cross(this.eye),Je.length()===0?c=!0:this.rotationAngle=this._offset.dot(Je.normalize())*a),(e==="E"||c)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),n==="local"&&e!=="E"&&e!=="XYZE"?(s.quaternion.copy(this._quaternionStart),s.quaternion.multiply(de.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),s.quaternion.copy(de.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),s.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(_m),this.dispatchEvent(ub)}}pointerUp(t){t.button===0&&(this.dragging&&this.axis!==null&&(hb.mode=this.mode,this.dispatchEvent(hb)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(t){t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()})}attach(t){return this.object=t,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(_m),this.dispatchEvent(ub),this.pointStart.copy(this.pointEnd))}getRaycaster(){return Zr}getMode(){return this.mode}setMode(t){this.mode=t}setTranslationSnap(t){this.translationSnap=t}setRotationSnap(t){this.rotationSnap=t}setScaleSnap(t){this.scaleSnap=t}setSize(t){this.size=t}setSpace(t){this.space=t}}function vL(r){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:r.button};{const t=this.domElement.getBoundingClientRect();return{x:(r.clientX-t.left)/t.width*2-1,y:-(r.clientY-t.top)/t.height*2+1,button:r.button}}}function RL(r){if(this.enabled)switch(r.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(r));break}}function AL(r){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(r.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(r)),this.pointerDown(this._getPointer(r)))}function SL(r){this.enabled&&this.pointerMove(this._getPointer(r))}function wL(r){this.enabled&&(this.domElement.releasePointerCapture(r.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(r)))}function Fm(r,t,e){const i=t.intersectObject(r,!0);for(let s=0;s<i.length;s++)if(i[s].object.visible||e)return i[s];return!1}const rd=new tE,ee=new M(0,1,0),db=new M(0,0,0),fb=new ht,od=new Ce,tf=new Ce,Vs=new M,pb=new ht,Ql=new M(1,0,0),oo=new M(0,1,0),Kl=new M(0,0,1),ad=new M,wl=new M,_l=new M;class _L extends ws{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const t=new Ue({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),e=new xi({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=t.clone();i.opacity=.15;const s=e.clone();s.opacity=.5;const n=t.clone();n.color.setHex(16711680);const o=t.clone();o.color.setHex(65280);const a=t.clone();a.color.setHex(255);const c=t.clone();c.color.setHex(16711680),c.opacity=.5;const l=t.clone();l.color.setHex(65280),l.opacity=.5;const h=t.clone();h.color.setHex(255),h.opacity=.5;const u=t.clone();u.opacity=.25;const d=t.clone();d.color.setHex(16776960),d.opacity=.25,t.clone().color.setHex(16776960);const p=t.clone();p.color.setHex(7895160);const m=new Xt(0,.04,.1,12);m.translate(0,.05,0);const g=new kt(.08,.08,.08);g.translate(0,.04,0);const I=new Ut;I.setAttribute("position",new Cr([0,0,0,1,0,0],3));const C=new Xt(.0075,.0075,.5,3);C.translate(0,.25,0);function b(U,H){const k=new Zs(U,.0075,3,64,H*Math.PI*2);return k.rotateY(Math.PI/2),k.rotateX(Math.PI/2),k}function E(){const U=new Ut;return U.setAttribute("position",new Cr([0,0,0,1,1,1],3)),U}const T={X:[[new it(m,n),[.5,0,0],[0,0,-Math.PI/2]],[new it(m,n),[-.5,0,0],[0,0,Math.PI/2]],[new it(C,n),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new it(m,o),[0,.5,0]],[new it(m,o),[0,-.5,0],[Math.PI,0,0]],[new it(C,o)]],Z:[[new it(m,a),[0,0,.5],[Math.PI/2,0,0]],[new it(m,a),[0,0,-.5],[-Math.PI/2,0,0]],[new it(C,a),null,[Math.PI/2,0,0]]],XYZ:[[new it(new ur(.1,0),u.clone()),[0,0,0]]],XY:[[new it(new kt(.15,.15,.01),h.clone()),[.15,.15,0]]],YZ:[[new it(new kt(.15,.15,.01),c.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new it(new kt(.15,.15,.01),l.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},A={X:[[new it(new Xt(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new it(new Xt(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new it(new Xt(.2,0,.6,4),i),[0,.3,0]],[new it(new Xt(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new it(new Xt(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new it(new Xt(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new it(new ur(.2,0),i)]],XY:[[new it(new kt(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new it(new kt(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new it(new kt(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},S={START:[[new it(new ur(.01,2),s),null,null,null,"helper"]],END:[[new it(new ur(.01,2),s),null,null,null,"helper"]],DELTA:[[new Qt(E(),s),null,null,null,"helper"]],X:[[new Qt(I,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Qt(I,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Qt(I,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},_={XYZE:[[new it(b(.5,1),p),null,[0,Math.PI/2,0]]],X:[[new it(b(.5,.5),n)]],Y:[[new it(b(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new it(b(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new it(b(.75,1),d),null,[0,Math.PI/2,0]]]},w={AXIS:[[new Qt(I,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},F={XYZE:[[new it(new Dy(.25,10,8),i)]],X:[[new it(new Zs(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new it(new Zs(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new it(new Zs(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new it(new Zs(.75,.1,2,24),i)]]},D={X:[[new it(g,n),[.5,0,0],[0,0,-Math.PI/2]],[new it(C,n),[0,0,0],[0,0,-Math.PI/2]],[new it(g,n),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new it(g,o),[0,.5,0]],[new it(C,o)],[new it(g,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new it(g,a),[0,0,.5],[Math.PI/2,0,0]],[new it(C,a),[0,0,0],[Math.PI/2,0,0]],[new it(g,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new it(new kt(.15,.15,.01),h),[.15,.15,0]]],YZ:[[new it(new kt(.15,.15,.01),c),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new it(new kt(.15,.15,.01),l),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new it(new kt(.1,.1,.1),u.clone())]]},R={X:[[new it(new Xt(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new it(new Xt(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new it(new Xt(.2,0,.6,4),i),[0,.3,0]],[new it(new Xt(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new it(new Xt(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new it(new Xt(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new it(new kt(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new it(new kt(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new it(new kt(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new it(new kt(.2,.2,.2),i),[0,0,0]]]},O={X:[[new Qt(I,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Qt(I,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Qt(I,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function y(U){const H=new ws;for(const k in U)for(let X=U[k].length;X--;){const $=U[k][X][0].clone(),et=U[k][X][1],Y=U[k][X][2],z=U[k][X][3],st=U[k][X][4];$.name=k,$.tag=st,et&&$.position.set(et[0],et[1],et[2]),Y&&$.rotation.set(Y[0],Y[1],Y[2]),z&&$.scale.set(z[0],z[1],z[2]),$.updateMatrix();const K=$.geometry.clone();K.applyMatrix4($.matrix),$.geometry=K,$.renderOrder=1/0,$.position.set(0,0,0),$.rotation.set(0,0,0),$.scale.set(1,1,1),H.add($)}return H}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=y(T)),this.add(this.gizmo.rotate=y(_)),this.add(this.gizmo.scale=y(D)),this.add(this.picker.translate=y(A)),this.add(this.picker.rotate=y(F)),this.add(this.picker.scale=y(R)),this.add(this.helper.translate=y(S)),this.add(this.helper.rotate=y(w)),this.add(this.helper.scale=y(O)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(t){const i=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:tf;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let s=[];s=s.concat(this.picker[this.mode].children),s=s.concat(this.gizmo[this.mode].children),s=s.concat(this.helper[this.mode].children);for(let n=0;n<s.length;n++){const o=s[n];o.visible=!0,o.rotation.set(0,0,0),o.position.copy(this.worldPosition);let a;if(this.camera.isOrthographicCamera?a=(this.camera.top-this.camera.bottom)/this.camera.zoom:a=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),o.scale.set(1,1,1).multiplyScalar(a*this.size/4),o.tag==="helper"){o.visible=!1,o.name==="AXIS"?(o.visible=!!this.axis,this.axis==="X"&&(de.setFromEuler(rd.set(0,0,0)),o.quaternion.copy(i).multiply(de),Math.abs(ee.copy(Ql).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),this.axis==="Y"&&(de.setFromEuler(rd.set(0,0,Math.PI/2)),o.quaternion.copy(i).multiply(de),Math.abs(ee.copy(oo).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),this.axis==="Z"&&(de.setFromEuler(rd.set(0,Math.PI/2,0)),o.quaternion.copy(i).multiply(de),Math.abs(ee.copy(Kl).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),this.axis==="XYZE"&&(de.setFromEuler(rd.set(0,Math.PI/2,0)),ee.copy(this.rotationAxis),o.quaternion.setFromRotationMatrix(fb.lookAt(db,ee,oo)),o.quaternion.multiply(de),o.visible=this.dragging),this.axis==="E"&&(o.visible=!1)):o.name==="START"?(o.position.copy(this.worldPositionStart),o.visible=this.dragging):o.name==="END"?(o.position.copy(this.worldPosition),o.visible=this.dragging):o.name==="DELTA"?(o.position.copy(this.worldPositionStart),o.quaternion.copy(this.worldQuaternionStart),Je.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),Je.applyQuaternion(this.worldQuaternionStart.clone().invert()),o.scale.copy(Je),o.visible=this.dragging):(o.quaternion.copy(i),this.dragging?o.position.copy(this.worldPositionStart):o.position.copy(this.worldPosition),this.axis&&(o.visible=this.axis.search(o.name)!==-1));continue}o.quaternion.copy(i),this.mode==="translate"||this.mode==="scale"?(o.name==="X"&&Math.abs(ee.copy(Ql).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="Y"&&Math.abs(ee.copy(oo).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="Z"&&Math.abs(ee.copy(Kl).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="XY"&&Math.abs(ee.copy(Kl).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="YZ"&&Math.abs(ee.copy(Ql).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),o.name==="XZ"&&Math.abs(ee.copy(oo).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1)):this.mode==="rotate"&&(od.copy(i),ee.copy(this.eye).applyQuaternion(de.copy(i).invert()),o.name.search("E")!==-1&&o.quaternion.setFromRotationMatrix(fb.lookAt(this.eye,db,oo)),o.name==="X"&&(de.setFromAxisAngle(Ql,Math.atan2(-ee.y,ee.z)),de.multiplyQuaternions(od,de),o.quaternion.copy(de)),o.name==="Y"&&(de.setFromAxisAngle(oo,Math.atan2(ee.x,ee.z)),de.multiplyQuaternions(od,de),o.quaternion.copy(de)),o.name==="Z"&&(de.setFromAxisAngle(Kl,Math.atan2(ee.y,ee.x)),de.multiplyQuaternions(od,de),o.quaternion.copy(de))),o.visible=o.visible&&(o.name.indexOf("X")===-1||this.showX),o.visible=o.visible&&(o.name.indexOf("Y")===-1||this.showY),o.visible=o.visible&&(o.name.indexOf("Z")===-1||this.showZ),o.visible=o.visible&&(o.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),o.material._color=o.material._color||o.material.color.clone(),o.material._opacity=o.material._opacity||o.material.opacity,o.material.color.copy(o.material._color),o.material.opacity=o.material._opacity,this.enabled&&this.axis&&(o.name===this.axis||this.axis.split("").some(function(c){return o.name===c}))&&(o.material.color.setHex(16776960),o.material.opacity=1)}super.updateMatrixWorld(t)}}class FL extends it{constructor(){super(new Uo(1e5,1e5,2,2),new Ue({visible:!1,wireframe:!0,side:Ps,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(t){let e=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(e="local"),ad.copy(Ql).applyQuaternion(e==="local"?this.worldQuaternion:tf),wl.copy(oo).applyQuaternion(e==="local"?this.worldQuaternion:tf),_l.copy(Kl).applyQuaternion(e==="local"?this.worldQuaternion:tf),ee.copy(wl),this.mode){case"translate":case"scale":switch(this.axis){case"X":ee.copy(this.eye).cross(ad),Vs.copy(ad).cross(ee);break;case"Y":ee.copy(this.eye).cross(wl),Vs.copy(wl).cross(ee);break;case"Z":ee.copy(this.eye).cross(_l),Vs.copy(_l).cross(ee);break;case"XY":Vs.copy(_l);break;case"YZ":Vs.copy(ad);break;case"XZ":ee.copy(_l),Vs.copy(wl);break;case"XYZ":case"E":Vs.set(0,0,0);break}break;case"rotate":default:Vs.set(0,0,0)}Vs.length()===0?this.quaternion.copy(this.cameraQuaternion):(pb.lookAt(Je.set(0,0,0),Vs,ee),this.quaternion.setFromRotationMatrix(pb)),super.updateMatrixWorld(t)}}class LE{constructor(t,e,i,s,n,o=5,a=!0){if(L(this,"onDraggingStarted",new It),L(this,"onDraggingEnded",new It),L(this,"onDisposed",new It),L(this,"normal"),L(this,"origin"),L(this,"three",new Qe),L(this,"components"),L(this,"world"),L(this,"type","default"),L(this,"_helper"),L(this,"_visible",!0),L(this,"_enabled",!0),L(this,"_controlsActive",!1),L(this,"_arrowBoundBox",new it),L(this,"_planeMesh"),L(this,"_controls"),L(this,"_hiddenMaterial",new Ue({visible:!1})),L(this,"update",()=>{this._enabled&&this.three.setFromNormalAndCoplanarPoint(this.normal,this._helper.position)}),L(this,"changeDrag",c=>{this._visible=!c.value,this.preventCameraMovement(),this.notifyDraggingChanged(c)}),this.components=t,this.world=e,!e.renderer)throw new Error("The given world must have a renderer!");this.normal=s,this.origin=i,e.renderer.setPlane(!0,this.three),this._planeMesh=LE.newPlaneMesh(o,n),this._helper=this.newHelper(),this._controls=this.newTransformControls(),this.three.setFromNormalAndCoplanarPoint(s,i),a&&this.toggleControls(!0)}get enabled(){return this._enabled}set enabled(t){if(!this.world.isDisposing){if(!this.world.renderer)throw new Error("No renderer found for clipping plane!");this._enabled=t,this.world.renderer.setPlane(t,this.three)}}get visible(){return this._visible}set visible(t){this._visible=t,this._controls.visible=t,this._helper.visible=t,this.toggleControls(t)}get meshes(){return[this._planeMesh,this._arrowBoundBox]}get planeMaterial(){return this._planeMesh.material}set planeMaterial(t){this._planeMesh.material=t}get size(){return this._planeMesh.scale.x}set size(t){this._planeMesh.scale.set(t,t,t)}get helper(){return this._helper}setFromNormalAndCoplanarPoint(t,e){this.reset(),this.normal.equals(t)||(this.normal.copy(t),this._helper.lookAt(t)),this.origin.copy(e),this._helper.position.copy(e),this._helper.updateMatrix(),this.update()}dispose(){this._enabled=!1,this.onDraggingStarted.reset(),this.onDraggingEnded.reset(),this._helper.removeFromParent(),this.world.renderer&&this.world.renderer.setPlane(!1,this.three),this._arrowBoundBox.removeFromParent(),this._arrowBoundBox.geometry.dispose(),this._planeMesh.geometry.dispose(),this._controls.removeFromParent(),this._controls.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}reset(){const t=new M(1,0,0),e=new M;this.normal.equals(t)||(this.normal.copy(t),this._helper.lookAt(t)),this.origin.copy(e),this._helper.position.copy(e),this._helper.updateMatrix()}toggleControls(t){if(t){if(this._controlsActive)return;this._controls.addEventListener("change",this.update),this._controls.addEventListener("dragging-changed",this.changeDrag)}else this._controls.removeEventListener("change",this.update),this._controls.removeEventListener("dragging-changed",this.changeDrag);this._controlsActive=t}newTransformControls(){if(!this.world.renderer)throw new Error("No renderer found for clipping plane!");const t=this.world.camera.three,e=this.world.renderer.three.domElement,i=new yL(t,e);return this.initializeControls(i),this.world.scene.three.add(i),i}initializeControls(t){t.attach(this._helper),t.showX=!1,t.showY=!1,t.setSpace("local"),this.createArrowBoundingBox(),t.children[0].children[0].add(this._arrowBoundBox)}createArrowBoundingBox(){this._arrowBoundBox.geometry=new Xt(.18,.18,1.2),this._arrowBoundBox.material=this._hiddenMaterial,this._arrowBoundBox.rotateX(Math.PI/2),this._arrowBoundBox.updateMatrix(),this._arrowBoundBox.geometry.applyMatrix4(this._arrowBoundBox.matrix)}notifyDraggingChanged(t){t.value?this.onDraggingStarted.trigger():this.onDraggingEnded.trigger()}preventCameraMovement(){this.world.camera.enabled=this._visible}newHelper(){const t=new ws;return t.lookAt(this.normal),t.position.copy(this.origin),this._planeMesh.position.z+=.01,t.add(this._planeMesh),this.world.scene.three.add(t),t}static newPlaneMesh(t,e){const i=new Uo(1),s=new it(i,e);return s.scale.set(t,t,t),s}}class OL extends Ho{constructor(){super(...arguments),L(this,"_config",{enabled:{value:!0,type:"Boolean"},visible:{value:!0,type:"Boolean"},color:{value:new Rt,type:"Color"},opacity:{type:"Number",interpolable:!0,value:1,min:0,max:1},size:{type:"Number",interpolable:!0,value:2,min:0,max:100}})}get enabled(){return this._config.enabled.value}set enabled(t){this._config.enabled.value=t,this._component.enabled=t}get visible(){return this._config.visible.value}set visible(t){this._config.visible.value=t,this._component.visible=t}get color(){return this._config.color.value}set color(t){this._config.color.value=t,this._component.material.color.copy(t)}get opacity(){return this._config.opacity.value}set opacity(t){this._config.opacity.value=t,this._component.material.opacity=t}get size(){return this._config.size.value}set size(t){this._config.size.value=t,this._component.size=t}}const lR=class ef extends oe{constructor(t){super(t),L(this,"onSetup",new It),L(this,"onBeforeDrag",new It),L(this,"onAfterDrag",new It),L(this,"onBeforeCreate",new It),L(this,"onBeforeCancel",new It),L(this,"onAfterCancel",new It),L(this,"onBeforeDelete",new It),L(this,"onAfterCreate",new It),L(this,"onAfterDelete",new It),L(this,"onDisposed",new It),L(this,"isSetup",!1),L(this,"orthogonalY",!1),L(this,"toleranceOrthogonalY",.7),L(this,"Type",LE),L(this,"list",[]),L(this,"config",new OL(this,this.components,"Clipper",ef.uuid)),L(this,"_defaultConfig",{color:new Rt(12255487),opacity:.2,size:2}),L(this,"_material",new Ue({color:12255487,side:Ps,transparent:!0,opacity:.2})),L(this,"_size",5),L(this,"_enabled",!1),L(this,"_visible",!0),L(this,"_onStartDragging",()=>{this.onBeforeDrag.trigger()}),L(this,"_onEndDragging",()=>{this.onAfterDrag.trigger()}),this.components.add(ef.uuid,this)}get enabled(){return this._enabled}set enabled(t){this._enabled=t;for(const e of this.list)e.enabled=t;this.updateMaterialsAndPlanes()}get visible(){return this._visible}set visible(t){this._visible=t;for(const e of this.list)e.visible=t}get material(){return this._material}set material(t){this._material=t;for(const e of this.list)e.planeMaterial=t}get size(){return this._size}set size(t){this._size=t;for(const e of this.list)e.size=t}dispose(){this._enabled=!1,this.components.get(tu).list.delete(this.config.uuid);for(const e of this.list)e.dispose();this.list.length=0,this._material.dispose(),this.onBeforeCreate.reset(),this.onBeforeCancel.reset(),this.onBeforeDelete.reset(),this.onBeforeDrag.reset(),this.onAfterCreate.reset(),this.onAfterCancel.reset(),this.onAfterDelete.reset(),this.onAfterDrag.reset(),this.onDisposed.trigger(ef.uuid),this.onDisposed.reset()}create(t){const s=this.components.get(qI).get(t).castRay();return s?this.createPlaneFromIntersection(t,s):null}createFromNormalAndCoplanarPoint(t,e,i){const s=this.newPlane(t,i,e);return this.updateMaterialsAndPlanes(),s}delete(t,e){e||(e=this.pickPlane(t)),e&&this.deletePlane(e)}deleteAll(t){const e=[...this.list];for(const i of e)if(!t||t.has(i.type)){this.delete(i.world,i);const s=this.list.indexOf(i);s!==-1&&this.list.splice(s,1)}}setup(t){const e={...this._defaultConfig,...t};this.config.color=e.color,this.config.opacity=e.opacity,this.config.size=e.size,this.isSetup=!0,this.onSetup.trigger()}deletePlane(t){const e=this.list.indexOf(t);if(e!==-1){if(this.list.splice(e,1),!t.world.renderer)throw new Error("Renderer not found for this plane's world!");t.world.renderer.setPlane(!1,t.three),t.dispose(),this.updateMaterialsAndPlanes(),this.onAfterDelete.trigger(t)}}pickPlane(t){const i=this.components.get(qI).get(t),s=this.getAllPlaneMeshes(),n=i.castRay(s);if(n){const o=n.object;return this.list.find(a=>a.meshes.includes(o))}}getAllPlaneMeshes(){const t=[];for(const e of this.list)t.push(...e.meshes);return t}createPlaneFromIntersection(t,e){var i;if(!t.renderer)throw new Error("The given world must have a renderer!");const s=e.point.distanceTo(new M(0,0,0)),n=(i=e.face)==null?void 0:i.normal;if(!s||!n)return null;const o=this.getWorldNormal(e,n),a=this.newPlane(t,e.point,o.negate());return a.visible=this._visible,a.size=this._size,t.renderer.setPlane(!0,a.three),this.updateMaterialsAndPlanes(),a}getWorldNormal(t,e){const i=t.object;let s=t.object.matrixWorld.clone();if(i instanceof Pe&&t.instanceId!==void 0){const c=new ht;i.getMatrixAt(t.instanceId,c),s=c.multiply(s)}const o=new fi().getNormalMatrix(s),a=e.clone().applyMatrix3(o).normalize();return this.normalizePlaneDirectionY(a),a}normalizePlaneDirectionY(t){this.orthogonalY&&(t.y>this.toleranceOrthogonalY&&(t.x=0,t.y=1,t.z=0),t.y<-this.toleranceOrthogonalY&&(t.x=0,t.y=-1,t.z=0))}newPlane(t,e,i){const s=new this.Type(this.components,t,e,i,this._material);return s.onDraggingStarted.add(this._onStartDragging),s.onDraggingEnded.add(this._onEndDragging),this.list.push(s),this.onAfterCreate.trigger(s),s}updateMaterialsAndPlanes(){const t=this.components.get($o);for(const[e,i]of t.list){if(!i.renderer)continue;i.renderer.updateClippingPlanes();const{clippingPlanes:s}=i.renderer;for(const n of i.meshes)if(n.material)if(Array.isArray(n.material))for(const o of n.material)o.clippingPlanes=s;else n.material.clippingPlanes=s}}};L(lR,"uuid","66290bc5-18c4-4cd1-9379-2e17a0617611");let xL=lR;class NL{constructor(t){L(this,"enabled",!1),L(this,"id","FirstPerson"),this.camera=t}set(t){if(this.enabled=t,t){if(this.camera.projection.current!=="Perspective"){this.camera.set("Orbit");return}this.setupFirstPersonCamera()}}setupFirstPersonCamera(){const t=this.camera.controls,e=new M;t.distance--,t.getPosition(e),t.minDistance=1,t.maxDistance=1,t.distance=1,t.moveTo(e.x,e.y,e.z),t.truckSpeed=50,t.mouseButtons.wheel=ii.ACTION.DOLLY,t.touches.two=ii.ACTION.TOUCH_ZOOM_TRUCK}}class PL{constructor(t){L(this,"enabled",!0),L(this,"id","Orbit"),this.camera=t,this.activateOrbitControls()}set(t){this.enabled=t,t&&this.activateOrbitControls()}activateOrbitControls(){const t=this.camera.controls;t.minDistance=1,t.maxDistance=300;const e=new M;t.getPosition(e);const i=e.length();t.distance=i,t.truckSpeed=2;const{rotation:s}=this.camera.three,n=new M(0,0,-1).applyEuler(s),o=e.addScaledVector(n,i);t.moveTo(o.x,o.y,o.z)}}class LL{constructor(t){L(this,"enabled",!1),L(this,"id","Plan"),L(this,"mouseAction1"),L(this,"mouseAction2"),L(this,"mouseInitialized",!1),L(this,"defaultAzimuthSpeed"),L(this,"defaultPolarSpeed"),this.camera=t,this.defaultAzimuthSpeed=t.controls.azimuthRotateSpeed,this.defaultPolarSpeed=t.controls.polarRotateSpeed}set(t){this.enabled=t;const e=this.camera.controls;e.azimuthRotateSpeed=t?0:this.defaultAzimuthSpeed,e.polarRotateSpeed=t?0:this.defaultPolarSpeed,this.mouseInitialized||(this.mouseAction1=e.touches.one,this.mouseAction2=e.touches.two,this.mouseInitialized=!0),t?(e.mouseButtons.left=ii.ACTION.TRUCK,e.touches.one=ii.ACTION.TOUCH_TRUCK,e.touches.two=ii.ACTION.TOUCH_ZOOM):(e.mouseButtons.left=ii.ACTION.ROTATE,e.touches.one=this.mouseAction1,e.touches.two=this.mouseAction2)}}class ML{constructor(t){L(this,"onChanged",new It),L(this,"current","Perspective"),L(this,"camera"),L(this,"matchOrthoDistanceEnabled",!1),L(this,"_component"),L(this,"_previousDistance",-1),this._component=t,this.camera=t.three}async set(t){this.current!==t&&(t==="Orthographic"?this.setOrthoCamera():await this.setPerspectiveCamera(),this.onChanged.trigger(this.camera))}async toggle(){const e=this.current==="Perspective"?"Orthographic":"Perspective";await this.set(e)}setOrthoCamera(){if(this._component.mode===null||this._component.mode.id==="FirstPerson")return;this._previousDistance=this._component.controls.distance,this._component.controls.distance=200;const t=this.getPerspectiveDims();if(!t)return;const{width:e,height:i}=t;this.setupOrthoCamera(i,e),this.camera=this._component.threeOrtho,this.current="Orthographic"}getPerspectiveDims(){const t=this._component.currentWorld;if(!t||!t.renderer)return null;const e=new M;this._component.threePersp.getWorldDirection(e);const i=new M;this._component.controls.getTarget(i);const n=i.clone().sub(this._component.threePersp.position).dot(e),o=t.renderer.getSize(),a=o.x/o.y,c=this._component.threePersp,l=n*2*Math.atan(c.fov*(Math.PI/180)/2);return{width:l*a,height:l}}setupOrthoCamera(t,e){this._component.controls.mouseButtons.wheel=ii.ACTION.ZOOM,this._component.controls.mouseButtons.middle=ii.ACTION.ZOOM;const i=this._component.threePersp,s=this._component.threeOrtho;s.zoom=1,s.left=e/-2,s.right=e/2,s.top=t/2,s.bottom=t/-2,s.updateProjectionMatrix(),s.position.copy(i.position),s.quaternion.copy(i.quaternion),this._component.controls.camera=s}getDistance(){const t=this._component.threePersp,e=this._component.threeOrtho;return(e.top-e.bottom)/e.zoom/(2*Math.atan(t.fov*(Math.PI/180)/2))}async setPerspectiveCamera(){this._component.controls.mouseButtons.wheel=ii.ACTION.DOLLY,this._component.controls.mouseButtons.middle=ii.ACTION.DOLLY;const t=this._component.threePersp,e=this._component.threeOrtho;t.position.copy(e.position),t.quaternion.copy(e.quaternion),this._component.controls.mouseButtons.wheel=ii.ACTION.DOLLY,this.matchOrthoDistanceEnabled?this._component.controls.distance=this.getDistance():this._component.controls.distance=this._previousDistance,await this._component.controls.zoomTo(1),t.updateProjectionMatrix(),this._component.controls.camera=t,this.camera=t,this.current="Perspective"}}class mp extends _h{constructor(t){super(t),L(this,"projection"),L(this,"threeOrtho"),L(this,"threePersp"),L(this,"_userInputButtons",{}),L(this,"_frustumSize",50),L(this,"_navigationModes",new Map),L(this,"_mode",null),L(this,"previousSize",null),this.threePersp=this.three,this.threeOrtho=this.newOrthoCamera(),this.projection=new ML(this),this.onAspectUpdated.add(()=>{this.setOrthoPerspCameraAspect()}),this.projection.onChanged.add(e=>{this.three=e,this.updateAspect()}),this.onWorldChanged.add(({action:e})=>{e==="added"&&(this._navigationModes.clear(),this._navigationModes.set("Orbit",new PL(this)),this._navigationModes.set("FirstPerson",new NL(this)),this._navigationModes.set("Plan",new LL(this)),this._mode=this._navigationModes.get("Orbit"),this.mode.set(!0,{preventTargetAdjustment:!0}),this.currentWorld&&this.currentWorld.renderer&&(this.previousSize=this.currentWorld.renderer.getSize().clone()))})}get mode(){if(!this._mode)throw new Error("Mode not found, camera not initialized");return this._mode}dispose(){super.dispose(),this.threeOrtho.removeFromParent()}set(t){if(this.mode!==null&&this.mode.id!==t){if(this.mode.set(!1),!this._navigationModes.has(t))throw new Error("The specified mode does not exist!");this._mode=this._navigationModes.get(t),this.mode.set(!0)}}async fit(t,e=1.5){if(!this.enabled)return;const i=Number.MAX_VALUE,s=Number.MIN_VALUE,n=new M(i,i,i),o=new M(s,s,s);for(const d of t){const f=new vt().setFromObject(d);f.min.x<n.x&&(n.x=f.min.x),f.min.y<n.y&&(n.y=f.min.y),f.min.z<n.z&&(n.z=f.min.z),f.max.x>o.x&&(o.x=f.max.x),f.max.y>o.y&&(o.y=f.max.y),f.max.z>o.z&&(o.z=f.max.z)}const a=new vt(n,o),c=new M;a.getSize(c);const l=new M;a.getCenter(l);const h=Math.max(c.x,c.y,c.z)*e,u=new as(l,h);await this.controls.fitToSphere(u,!0)}setUserInput(t){t?this.enableUserInput():this.disableUserInput()}disableUserInput(){this._userInputButtons.left=this.controls.mouseButtons.left,this._userInputButtons.right=this.controls.mouseButtons.right,this._userInputButtons.middle=this.controls.mouseButtons.middle,this._userInputButtons.wheel=this.controls.mouseButtons.wheel,this.controls.mouseButtons.left=0,this.controls.mouseButtons.right=0,this.controls.mouseButtons.middle=0,this.controls.mouseButtons.wheel=0}enableUserInput(){Object.keys(this._userInputButtons).length!==0&&(this.controls.mouseButtons.left=this._userInputButtons.left,this.controls.mouseButtons.right=this._userInputButtons.right,this.controls.mouseButtons.middle=this._userInputButtons.middle,this.controls.mouseButtons.wheel=this._userInputButtons.wheel)}newOrthoCamera(){const t=window.innerWidth/window.innerHeight;return new cs(this._frustumSize*t/-2,this._frustumSize*t/2,this._frustumSize/2,this._frustumSize/-2,.1,1e3)}setOrthoPerspCameraAspect(){if(!this.currentWorld||!this.currentWorld.renderer||!this.previousSize)return;const t=this.currentWorld.renderer.getSize(),e=this.threeOrtho.top,i=this.threeOrtho.right,s=t.y/this.previousSize.y,n=t.x/this.previousSize.x,o=e*s,a=i*n;this.threeOrtho.left=-a,this.threeOrtho.right=a,this.threeOrtho.top=o,this.threeOrtho.bottom=-o,this.threeOrtho.updateProjectionMatrix(),this.previousSize.copy(t)}}const mb=new Map([[xr,{forRelated:"Decomposes",forRelating:"IsDecomposedBy"}],[bc,{forRelated:"HasAssociations",forRelating:"AssociatedTo"}],[Tc,{forRelated:"HasAssociations",forRelating:"ClassificationForObjects"}],[yc,{forRelated:"HasAssignments",forRelating:"IsGroupedBy"}],[on,{forRelated:"IsDefinedBy",forRelating:"DefinesOcurrence"}],[vc,{forRelated:"IsTypedBy",forRelating:"Types"}],[Rc,{forRelated:"IsDefinedBy",forRelating:"Defines"}],[Nr,{forRelated:"ContainedInStructure",forRelating:"ContainsElements"}],[Ac,{forRelated:"AssignedToFlowElement",forRelating:"HasControlElements"}],[Sc,{forRelated:"ConnectedFrom",forRelating:"ConnectedTo"}],[wc,{forRelated:"HasAssignments",forRelating:"ReferencedBy"}],[_c,{forRelated:"HasContext",forRelating:"Declares"}],[Fc,{forRelated:"HasAssignments",forRelating:"Controls"}],[Oc,{forRelated:"Nests",forRelating:"IsNestedBy"}],[xc,{forRelated:"HasAssociations",forRelating:"DocumentRefForObjects"}]]),Ar={950732822:"IFCURIREFERENCE",4075327185:"IFCTIME",1209108979:"IFCTEMPERATURERATEOFCHANGEMEASURE",3457685358:"IFCSOUNDPRESSURELEVELMEASURE",4157543285:"IFCSOUNDPOWERLEVELMEASURE",2798247006:"IFCPROPERTYSETDEFINITIONSET",1790229001:"IFCPOSITIVEINTEGER",525895558:"IFCNONNEGATIVELENGTHMEASURE",1774176899:"IFCLINEINDEX",1275358634:"IFCLANGUAGEID",2541165894:"IFCDURATION",3701338814:"IFCDAYINWEEKNUMBER",2195413836:"IFCDATETIME",937566702:"IFCDATE",1683019596:"IFCCARDINALPOINTREFERENCE",2314439260:"IFCBINARY",1500781891:"IFCAREADENSITYMEASURE",3683503648:"IFCARCINDEX",4065007721:"IFCYEARNUMBER",1718600412:"IFCWARPINGMOMENTMEASURE",51269191:"IFCWARPINGCONSTANTMEASURE",2593997549:"IFCVOLUMETRICFLOWRATEMEASURE",3458127941:"IFCVOLUMEMEASURE",3345633955:"IFCVAPORPERMEABILITYMEASURE",1278329552:"IFCTORQUEMEASURE",2591213694:"IFCTIMESTAMP",2726807636:"IFCTIMEMEASURE",743184107:"IFCTHERMODYNAMICTEMPERATUREMEASURE",2016195849:"IFCTHERMALTRANSMITTANCEMEASURE",857959152:"IFCTHERMALRESISTANCEMEASURE",2281867870:"IFCTHERMALEXPANSIONCOEFFICIENTMEASURE",2645777649:"IFCTHERMALCONDUCTIVITYMEASURE",232962298:"IFCTHERMALADMITTANCEMEASURE",296282323:"IFCTEXTTRANSFORMATION",603696268:"IFCTEXTFONTNAME",3490877962:"IFCTEXTDECORATION",1460886941:"IFCTEXTALIGNMENT",2801250643:"IFCTEXT",58845555:"IFCTEMPERATUREGRADIENTMEASURE",361837227:"IFCSPECULARROUGHNESS",2757832317:"IFCSPECULAREXPONENT",3477203348:"IFCSPECIFICHEATCAPACITYMEASURE",993287707:"IFCSOUNDPRESSUREMEASURE",846465480:"IFCSOUNDPOWERMEASURE",3471399674:"IFCSOLIDANGLEMEASURE",408310005:"IFCSHEARMODULUSMEASURE",2190458107:"IFCSECTIONALAREAINTEGRALMEASURE",3467162246:"IFCSECTIONMODULUSMEASURE",2766185779:"IFCSECONDINMINUTE",3211557302:"IFCROTATIONALSTIFFNESSMEASURE",1755127002:"IFCROTATIONALMASSMEASURE",2133746277:"IFCROTATIONALFREQUENCYMEASURE",200335297:"IFCREAL",96294661:"IFCRATIOMEASURE",3972513137:"IFCRADIOACTIVITYMEASURE",3665567075:"IFCPRESSUREMEASURE",2169031380:"IFCPRESENTABLETEXT",1364037233:"IFCPOWERMEASURE",1245737093:"IFCPOSITIVERATIOMEASURE",3054510233:"IFCPOSITIVEPLANEANGLEMEASURE",2815919920:"IFCPOSITIVELENGTHMEASURE",4042175685:"IFCPLANEANGLEMEASURE",2642773653:"IFCPLANARFORCEMEASURE",2260317790:"IFCPARAMETERVALUE",929793134:"IFCPHMEASURE",2395907400:"IFCNUMERICMEASURE",2095195183:"IFCNORMALISEDRATIOMEASURE",765770214:"IFCMONTHINYEARNUMBER",2615040989:"IFCMONETARYMEASURE",3114022597:"IFCMOMENTOFINERTIAMEASURE",1648970520:"IFCMOLECULARWEIGHTMEASURE",3177669450:"IFCMOISTUREDIFFUSIVITYMEASURE",1753493141:"IFCMODULUSOFSUBGRADEREACTIONMEASURE",1052454078:"IFCMODULUSOFROTATIONALSUBGRADEREACTIONMEASURE",2173214787:"IFCMODULUSOFLINEARSUBGRADEREACTIONMEASURE",3341486342:"IFCMODULUSOFELASTICITYMEASURE",102610177:"IFCMINUTEINHOUR",3531705166:"IFCMASSPERLENGTHMEASURE",3124614049:"IFCMASSMEASURE",4017473158:"IFCMASSFLOWRATEMEASURE",1477762836:"IFCMASSDENSITYMEASURE",2486716878:"IFCMAGNETICFLUXMEASURE",286949696:"IFCMAGNETICFLUXDENSITYMEASURE",151039812:"IFCLUMINOUSINTENSITYMEASURE",2755797622:"IFCLUMINOUSINTENSITYDISTRIBUTIONMEASURE",2095003142:"IFCLUMINOUSFLUXMEASURE",503418787:"IFCLOGICAL",3086160713:"IFCLINEARVELOCITYMEASURE",1307019551:"IFCLINEARSTIFFNESSMEASURE",2128979029:"IFCLINEARMOMENTMEASURE",191860431:"IFCLINEARFORCEMEASURE",1243674935:"IFCLENGTHMEASURE",3258342251:"IFCLABEL",2054016361:"IFCKINEMATICVISCOSITYMEASURE",3192672207:"IFCISOTHERMALMOISTURECAPACITYMEASURE",3686016028:"IFCIONCONCENTRATIONMEASURE",3809634241:"IFCINTEGERCOUNTRATEMEASURE",1939436016:"IFCINTEGER",2679005408:"IFCINDUCTANCEMEASURE",3358199106:"IFCILLUMINANCEMEASURE",983778844:"IFCIDENTIFIER",2589826445:"IFCHOURINDAY",1158859006:"IFCHEATINGVALUEMEASURE",3113092358:"IFCHEATFLUXDENSITYMEASURE",3064340077:"IFCGLOBALLYUNIQUEID",3044325142:"IFCFREQUENCYMEASURE",1361398929:"IFCFORCEMEASURE",2590844177:"IFCFONTWEIGHT",2715512545:"IFCFONTVARIANT",1102727119:"IFCFONTSTYLE",2078135608:"IFCENERGYMEASURE",2506197118:"IFCELECTRICVOLTAGEMEASURE",2951915441:"IFCELECTRICRESISTANCEMEASURE",3790457270:"IFCELECTRICCURRENTMEASURE",2093906313:"IFCELECTRICCONDUCTANCEMEASURE",3818826038:"IFCELECTRICCHARGEMEASURE",1827137117:"IFCELECTRICCAPACITANCEMEASURE",69416015:"IFCDYNAMICVISCOSITYMEASURE",524656162:"IFCDOSEEQUIVALENTMEASURE",4134073009:"IFCDIMENSIONCOUNT",1514641115:"IFCDESCRIPTIVEMEASURE",300323983:"IFCDAYLIGHTSAVINGHOUR",86635668:"IFCDAYINMONTHNUMBER",94842927:"IFCCURVATUREMEASURE",1778710042:"IFCCOUNTMEASURE",3238673880:"IFCCONTEXTDEPENDENTMEASURE",3812528620:"IFCCOMPOUNDPLANEANGLEMEASURE",2991860651:"IFCCOMPLEXNUMBER",1867003952:"IFCBOXALIGNMENT",2735952531:"IFCBOOLEAN",2650437152:"IFCAREAMEASURE",632304761:"IFCANGULARVELOCITYMEASURE",360377573:"IFCAMOUNTOFSUBSTANCEMEASURE",4182062534:"IFCACCELERATIONMEASURE",3699917729:"IFCABSORBEDDOSEMEASURE",1971632696:"IFCGEOSLICE",2680139844:"IFCGEOMODEL",24726584:"IFCELECTRICFLOWTREATMENTDEVICE",3693000487:"IFCDISTRIBUTIONBOARD",3460952963:"IFCCONVEYORSEGMENT",3999819293:"IFCCAISSONFOUNDATION",3314249567:"IFCBOREHOLE",4196446775:"IFCBEARING",325726236:"IFCALIGNMENT",3425753595:"IFCTRACKELEMENT",991950508:"IFCSIGNAL",3798194928:"IFCREINFORCEDSOIL",3290496277:"IFCRAIL",1383356374:"IFCPAVEMENT",2182337498:"IFCNAVIGATIONELEMENT",234836483:"IFCMOORINGDEVICE",2078563270:"IFCMOBILETELECOMMUNICATIONSAPPLIANCE",1638804497:"IFCLIQUIDTERMINAL",1154579445:"IFCLINEARPOSITIONINGELEMENT",2696325953:"IFCKERB",2713699986:"IFCGEOTECHNICALASSEMBLY",2142170206:"IFCELECTRICFLOWTREATMENTDEVICETYPE",3376911765:"IFCEARTHWORKSFILL",1077100507:"IFCEARTHWORKSELEMENT",3071239417:"IFCEARTHWORKSCUT",479945903:"IFCDISTRIBUTIONBOARDTYPE",3426335179:"IFCDEEPFOUNDATION",1502416096:"IFCCOURSE",2940368186:"IFCCONVEYORSEGMENTTYPE",3203706013:"IFCCAISSONFOUNDATIONTYPE",3862327254:"IFCBUILTSYSTEM",1876633798:"IFCBUILTELEMENT",963979645:"IFCBRIDGEPART",644574406:"IFCBRIDGE",3649138523:"IFCBEARINGTYPE",1662888072:"IFCALIGNMENTVERTICAL",317615605:"IFCALIGNMENTSEGMENT",1545765605:"IFCALIGNMENTHORIZONTAL",4266260250:"IFCALIGNMENTCANT",3956297820:"IFCVIBRATIONDAMPERTYPE",1530820697:"IFCVIBRATIONDAMPER",840318589:"IFCVEHICLE",1953115116:"IFCTRANSPORTATIONDEVICE",618700268:"IFCTRACKELEMENTTYPE",2281632017:"IFCTENDONCONDUITTYPE",3663046924:"IFCTENDONCONDUIT",42703149:"IFCSINESPIRAL",1894708472:"IFCSIGNALTYPE",3599934289:"IFCSIGNTYPE",33720170:"IFCSIGN",1027922057:"IFCSEVENTHORDERPOLYNOMIALSPIRAL",544395925:"IFCSEGMENTEDREFERENCECURVE",3649235739:"IFCSECONDORDERPOLYNOMIALSPIRAL",550521510:"IFCROADPART",146592293:"IFCROAD",3818125796:"IFCRELADHERESTOELEMENT",4021432810:"IFCREFERENT",1891881377:"IFCRAILWAYPART",3992365140:"IFCRAILWAY",1763565496:"IFCRAILTYPE",1946335990:"IFCPOSITIONINGELEMENT",514975943:"IFCPAVEMENTTYPE",506776471:"IFCNAVIGATIONELEMENTTYPE",710110818:"IFCMOORINGDEVICETYPE",1950438474:"IFCMOBILETELECOMMUNICATIONSAPPLIANCETYPE",976884017:"IFCMARINEPART",525669439:"IFCMARINEFACILITY",1770583370:"IFCLIQUIDTERMINALTYPE",2176059722:"IFCLINEARELEMENT",679976338:"IFCKERBTYPE",3948183225:"IFCIMPACTPROTECTIONDEVICETYPE",2568555532:"IFCIMPACTPROTECTIONDEVICE",2898700619:"IFCGRADIENTCURVE",1594536857:"IFCGEOTECHNICALSTRATUM",4230923436:"IFCGEOTECHNICALELEMENT",4228831410:"IFCFACILITYPARTCOMMON",1310830890:"IFCFACILITYPART",24185140:"IFCFACILITY",4234616927:"IFCDIRECTRIXDERIVEDREFERENCESWEPTAREASOLID",1306400036:"IFCDEEPFOUNDATIONTYPE",4189326743:"IFCCOURSETYPE",2000195564:"IFCCOSINESPIRAL",3497074424:"IFCCLOTHOID",1626504194:"IFCBUILTELEMENTTYPE",3651464721:"IFCVEHICLETYPE",1229763772:"IFCTRIANGULATEDIRREGULARNETWORK",3665877780:"IFCTRANSPORTATIONDEVICETYPE",782932809:"IFCTHIRDORDERPOLYNOMIALSPIRAL",2735484536:"IFCSPIRAL",1356537516:"IFCSECTIONEDSURFACE",1290935644:"IFCSECTIONEDSOLIDHORIZONTAL",1862484736:"IFCSECTIONEDSOLID",1441486842:"IFCRELPOSITIONS",1033248425:"IFCRELASSOCIATESPROFILEDEF",3381221214:"IFCPOLYNOMIALCURVE",2485787929:"IFCOFFSETCURVEBYDISTANCES",590820931:"IFCOFFSETCURVE",3465909080:"IFCINDEXEDPOLYGONALTEXTUREMAP",593015953:"IFCDIRECTRIXCURVESWEPTAREASOLID",4212018352:"IFCCURVESEGMENT",3425423356:"IFCAXIS2PLACEMENTLINEAR",823603102:"IFCSEGMENT",2165702409:"IFCPOINTBYDISTANCEEXPRESSION",182550632:"IFCOPENCROSSPROFILEDEF",388784114:"IFCLINEARPLACEMENT",536804194:"IFCALIGNMENTHORIZONTALSEGMENT",3752311538:"IFCALIGNMENTCANTSEGMENT",1010789467:"IFCTEXTURECOORDINATEINDICESWITHVOIDS",222769930:"IFCTEXTURECOORDINATEINDICES",2691318326:"IFCQUANTITYNUMBER",3633395639:"IFCALIGNMENTVERTICALSEGMENT",2879124712:"IFCALIGNMENTPARAMETERSEGMENT",25142252:"IFCCONTROLLER",3087945054:"IFCALARM",4288193352:"IFCACTUATOR",630975310:"IFCUNITARYCONTROLELEMENT",4086658281:"IFCSENSOR",2295281155:"IFCPROTECTIVEDEVICETRIPPINGUNIT",182646315:"IFCFLOWINSTRUMENT",1426591983:"IFCFIRESUPPRESSIONTERMINAL",819412036:"IFCFILTER",3415622556:"IFCFAN",1003880860:"IFCELECTRICTIMECONTROL",402227799:"IFCELECTRICMOTOR",264262732:"IFCELECTRICGENERATOR",3310460725:"IFCELECTRICFLOWSTORAGEDEVICE",862014818:"IFCELECTRICDISTRIBUTIONBOARD",1904799276:"IFCELECTRICAPPLIANCE",1360408905:"IFCDUCTSILENCER",3518393246:"IFCDUCTSEGMENT",342316401:"IFCDUCTFITTING",562808652:"IFCDISTRIBUTIONCIRCUIT",4074379575:"IFCDAMPER",3640358203:"IFCCOOLINGTOWER",4136498852:"IFCCOOLEDBEAM",2272882330:"IFCCONDENSER",3571504051:"IFCCOMPRESSOR",3221913625:"IFCCOMMUNICATIONSAPPLIANCE",639361253:"IFCCOIL",3902619387:"IFCCHILLER",4217484030:"IFCCABLESEGMENT",1051757585:"IFCCABLEFITTING",3758799889:"IFCCABLECARRIERSEGMENT",635142910:"IFCCABLECARRIERFITTING",2938176219:"IFCBURNER",32344328:"IFCBOILER",2906023776:"IFCBEAMSTANDARDCASE",277319702:"IFCAUDIOVISUALAPPLIANCE",2056796094:"IFCAIRTOAIRHEATRECOVERY",177149247:"IFCAIRTERMINALBOX",1634111441:"IFCAIRTERMINAL",486154966:"IFCWINDOWSTANDARDCASE",4237592921:"IFCWASTETERMINAL",4156078855:"IFCWALLELEMENTEDCASE",4207607924:"IFCVALVE",4292641817:"IFCUNITARYEQUIPMENT",3179687236:"IFCUNITARYCONTROLELEMENTTYPE",3026737570:"IFCTUBEBUNDLE",3825984169:"IFCTRANSFORMER",812556717:"IFCTANK",1162798199:"IFCSWITCHINGDEVICE",385403989:"IFCSTRUCTURALLOADCASE",1404847402:"IFCSTACKTERMINAL",1999602285:"IFCSPACEHEATER",3420628829:"IFCSOLARDEVICE",3027962421:"IFCSLABSTANDARDCASE",3127900445:"IFCSLABELEMENTEDCASE",1329646415:"IFCSHADINGDEVICE",3053780830:"IFCSANITARYTERMINAL",2572171363:"IFCREINFORCINGBARTYPE",1232101972:"IFCRATIONALBSPLINECURVEWITHKNOTS",90941305:"IFCPUMP",655969474:"IFCPROTECTIVEDEVICETRIPPINGUNITTYPE",738039164:"IFCPROTECTIVEDEVICE",1156407060:"IFCPLATESTANDARDCASE",3612865200:"IFCPIPESEGMENT",310824031:"IFCPIPEFITTING",3694346114:"IFCOUTLET",144952367:"IFCOUTERBOUNDARYCURVE",2474470126:"IFCMOTORCONNECTION",1911478936:"IFCMEMBERSTANDARDCASE",1437502449:"IFCMEDICALDEVICE",629592764:"IFCLIGHTFIXTURE",76236018:"IFCLAMP",2176052936:"IFCJUNCTIONBOX",4175244083:"IFCINTERCEPTOR",2068733104:"IFCHUMIDIFIER",3319311131:"IFCHEATEXCHANGER",2188021234:"IFCFLOWMETER",1209101575:"IFCEXTERNALSPATIALELEMENT",484807127:"IFCEVAPORATOR",3747195512:"IFCEVAPORATIVECOOLER",2814081492:"IFCENGINE",2417008758:"IFCELECTRICDISTRIBUTIONBOARDTYPE",3242481149:"IFCDOORSTANDARDCASE",3205830791:"IFCDISTRIBUTIONSYSTEM",400855858:"IFCCOMMUNICATIONSAPPLIANCETYPE",905975707:"IFCCOLUMNSTANDARDCASE",1677625105:"IFCCIVILELEMENT",3296154744:"IFCCHIMNEY",2674252688:"IFCCABLEFITTINGTYPE",2188180465:"IFCBURNERTYPE",1177604601:"IFCBUILDINGSYSTEM",39481116:"IFCBUILDINGELEMENTPARTTYPE",1136057603:"IFCBOUNDARYCURVE",2461110595:"IFCBSPLINECURVEWITHKNOTS",1532957894:"IFCAUDIOVISUALAPPLIANCETYPE",4088093105:"IFCWORKCALENDAR",4009809668:"IFCWINDOWTYPE",926996030:"IFCVOIDINGFEATURE",2391383451:"IFCVIBRATIONISOLATOR",2415094496:"IFCTENDONTYPE",3081323446:"IFCTENDONANCHORTYPE",413509423:"IFCSYSTEMFURNITUREELEMENT",3101698114:"IFCSURFACEFEATURE",3657597509:"IFCSTRUCTURALSURFACEACTION",2757150158:"IFCSTRUCTURALCURVEREACTION",1004757350:"IFCSTRUCTURALCURVEACTION",338393293:"IFCSTAIRTYPE",1072016465:"IFCSOLARDEVICETYPE",4074543187:"IFCSHADINGDEVICETYPE",2157484638:"IFCSEAMCURVE",2781568857:"IFCROOFTYPE",2310774935:"IFCREINFORCINGMESHTYPE",964333572:"IFCREINFORCINGELEMENTTYPE",683857671:"IFCRATIONALBSPLINESURFACEWITHKNOTS",1469900589:"IFCRAMPTYPE",2839578677:"IFCPOLYGONALFACESET",1158309216:"IFCPILETYPE",3079942009:"IFCOPENINGSTANDARDCASE",1114901282:"IFCMEDICALDEVICETYPE",3113134337:"IFCINTERSECTIONCURVE",3946677679:"IFCINTERCEPTORTYPE",2571569899:"IFCINDEXEDPOLYCURVE",3493046030:"IFCGEOGRAPHICELEMENT",1509553395:"IFCFURNITURE",1893162501:"IFCFOOTINGTYPE",2853485674:"IFCEXTERNALSPATIALSTRUCTUREELEMENT",4148101412:"IFCEVENT",132023988:"IFCENGINETYPE",2397081782:"IFCELEMENTASSEMBLYTYPE",2323601079:"IFCDOORTYPE",1213902940:"IFCCYLINDRICALSURFACE",1525564444:"IFCCONSTRUCTIONPRODUCTRESOURCETYPE",4105962743:"IFCCONSTRUCTIONMATERIALRESOURCETYPE",2185764099:"IFCCONSTRUCTIONEQUIPMENTRESOURCETYPE",15328376:"IFCCOMPOSITECURVEONSURFACE",3875453745:"IFCCOMPLEXPROPERTYTEMPLATE",3893394355:"IFCCIVILELEMENTTYPE",2197970202:"IFCCHIMNEYTYPE",167062518:"IFCBSPLINESURFACEWITHKNOTS",2887950389:"IFCBSPLINESURFACE",2603310189:"IFCADVANCEDBREPWITHVOIDS",1635779807:"IFCADVANCEDBREP",2916149573:"IFCTRIANGULATEDFACESET",1935646853:"IFCTOROIDALSURFACE",2387106220:"IFCTESSELLATEDFACESET",3206491090:"IFCTASKTYPE",699246055:"IFCSURFACECURVE",4095615324:"IFCSUBCONTRACTRESOURCETYPE",603775116:"IFCSTRUCTURALSURFACEREACTION",4015995234:"IFCSPHERICALSURFACE",2481509218:"IFCSPATIALZONETYPE",463610769:"IFCSPATIALZONE",710998568:"IFCSPATIALELEMENTTYPE",1412071761:"IFCSPATIALELEMENT",3663146110:"IFCSIMPLEPROPERTYTEMPLATE",3243963512:"IFCREVOLVEDAREASOLIDTAPERED",816062949:"IFCREPARAMETRISEDCOMPOSITECURVESEGMENT",1521410863:"IFCRELSPACEBOUNDARY2NDLEVEL",3523091289:"IFCRELSPACEBOUNDARY1STLEVEL",427948657:"IFCRELINTERFERESELEMENTS",307848117:"IFCRELDEFINESBYTEMPLATE",1462361463:"IFCRELDEFINESBYOBJECT",2565941209:"IFCRELDECLARES",1027710054:"IFCRELASSIGNSTOGROUPBYFACTOR",3521284610:"IFCPROPERTYTEMPLATE",492091185:"IFCPROPERTYSETTEMPLATE",653396225:"IFCPROJECTLIBRARY",569719735:"IFCPROCEDURETYPE",3967405729:"IFCPREDEFINEDPROPERTYSET",1682466193:"IFCPCURVE",428585644:"IFCLABORRESOURCETYPE",2294589976:"IFCINDEXEDPOLYGONALFACEWITHVOIDS",178912537:"IFCINDEXEDPOLYGONALFACE",4095422895:"IFCGEOGRAPHICELEMENTTYPE",2652556860:"IFCFIXEDREFERENCESWEPTAREASOLID",2804161546:"IFCEXTRUDEDAREASOLIDTAPERED",4024345920:"IFCEVENTTYPE",2629017746:"IFCCURVEBOUNDEDSURFACE",1815067380:"IFCCREWRESOURCETYPE",3419103109:"IFCCONTEXT",2574617495:"IFCCONSTRUCTIONRESOURCETYPE",2059837836:"IFCCARTESIANPOINTLIST3D",1675464909:"IFCCARTESIANPOINTLIST2D",574549367:"IFCCARTESIANPOINTLIST",3406155212:"IFCADVANCEDFACE",3698973494:"IFCTYPERESOURCE",3736923433:"IFCTYPEPROCESS",901063453:"IFCTESSELLATEDITEM",1096409881:"IFCSWEPTDISKSOLIDPOLYGONAL",1042787934:"IFCRESOURCETIME",1608871552:"IFCRESOURCECONSTRAINTRELATIONSHIP",2943643501:"IFCRESOURCEAPPROVALRELATIONSHIP",2090586900:"IFCQUANTITYSET",1482703590:"IFCPROPERTYTEMPLATEDEFINITION",3778827333:"IFCPREDEFINEDPROPERTIES",2998442950:"IFCMIRROREDPROFILEDEF",853536259:"IFCMATERIALRELATIONSHIP",3404854881:"IFCMATERIALPROFILESETUSAGETAPERING",3079605661:"IFCMATERIALPROFILESETUSAGE",2852063980:"IFCMATERIALCONSTITUENTSET",3708119e3:"IFCMATERIALCONSTITUENT",1585845231:"IFCLAGTIME",2133299955:"IFCINDEXEDTRIANGLETEXTUREMAP",1437953363:"IFCINDEXEDTEXTUREMAP",3570813810:"IFCINDEXEDCOLOURMAP",1437805879:"IFCEXTERNALREFERENCERELATIONSHIP",297599258:"IFCEXTENDEDPROPERTIES",211053100:"IFCEVENTTIME",2713554722:"IFCCONVERSIONBASEDUNITWITHOFFSET",3285139300:"IFCCOLOURRGBLIST",1236880293:"IFCWORKTIME",1199560280:"IFCTIMEPERIOD",3611470254:"IFCTEXTUREVERTEXLIST",2771591690:"IFCTASKTIMERECURRING",1549132990:"IFCTASKTIME",2043862942:"IFCTABLECOLUMN",2934153892:"IFCSURFACEREINFORCEMENTAREA",609421318:"IFCSTRUCTURALLOADORRESULT",3478079324:"IFCSTRUCTURALLOADCONFIGURATION",1054537805:"IFCSCHEDULINGTIME",2439245199:"IFCRESOURCELEVELRELATIONSHIP",2433181523:"IFCREFERENCE",3915482550:"IFCRECURRENCEPATTERN",986844984:"IFCPROPERTYABSTRACTION",3843373140:"IFCPROJECTEDCRS",677532197:"IFCPRESENTATIONITEM",1507914824:"IFCMATERIALUSAGEDEFINITION",552965576:"IFCMATERIALPROFILEWITHOFFSETS",164193824:"IFCMATERIALPROFILESET",2235152071:"IFCMATERIALPROFILE",1847252529:"IFCMATERIALLAYERWITHOFFSETS",760658860:"IFCMATERIALDEFINITION",3057273783:"IFCMAPCONVERSION",4294318154:"IFCEXTERNALINFORMATION",1466758467:"IFCCOORDINATEREFERENCESYSTEM",1785450214:"IFCCOORDINATEOPERATION",775493141:"IFCCONNECTIONVOLUMEGEOMETRY",979691226:"IFCREINFORCINGBAR",3700593921:"IFCELECTRICDISTRIBUTIONPOINT",1062813311:"IFCDISTRIBUTIONCONTROLELEMENT",1052013943:"IFCDISTRIBUTIONCHAMBERELEMENT",578613899:"IFCCONTROLLERTYPE",2454782716:"IFCCHAMFEREDGEFEATURE",753842376:"IFCBEAM",3001207471:"IFCALARMTYPE",2874132201:"IFCACTUATORTYPE",3304561284:"IFCWINDOW",3512223829:"IFCWALLSTANDARDCASE",2391406946:"IFCWALL",3313531582:"IFCVIBRATIONISOLATORTYPE",2347447852:"IFCTENDONANCHOR",3824725483:"IFCTENDON",2515109513:"IFCSTRUCTURALANALYSISMODEL",4252922144:"IFCSTAIRFLIGHT",331165859:"IFCSTAIR",1529196076:"IFCSLAB",1783015770:"IFCSENSORTYPE",1376911519:"IFCROUNDEDEDGEFEATURE",2016517767:"IFCROOF",2320036040:"IFCREINFORCINGMESH",3027567501:"IFCREINFORCINGELEMENT",3055160366:"IFCRATIONALBEZIERCURVE",3283111854:"IFCRAMPFLIGHT",3024970846:"IFCRAMP",2262370178:"IFCRAILING",3171933400:"IFCPLATE",1687234759:"IFCPILE",1073191201:"IFCMEMBER",900683007:"IFCFOOTING",3508470533:"IFCFLOWTREATMENTDEVICE",2223149337:"IFCFLOWTERMINAL",707683696:"IFCFLOWSTORAGEDEVICE",987401354:"IFCFLOWSEGMENT",3132237377:"IFCFLOWMOVINGDEVICE",4037862832:"IFCFLOWINSTRUMENTTYPE",4278956645:"IFCFLOWFITTING",2058353004:"IFCFLOWCONTROLLER",4222183408:"IFCFIRESUPPRESSIONTERMINALTYPE",1810631287:"IFCFILTERTYPE",346874300:"IFCFANTYPE",1658829314:"IFCENERGYCONVERSIONDEVICE",857184966:"IFCELECTRICALELEMENT",1634875225:"IFCELECTRICALCIRCUIT",712377611:"IFCELECTRICTIMECONTROLTYPE",1217240411:"IFCELECTRICMOTORTYPE",1365060375:"IFCELECTRICHEATERTYPE",1534661035:"IFCELECTRICGENERATORTYPE",3277789161:"IFCELECTRICFLOWSTORAGEDEVICETYPE",663422040:"IFCELECTRICAPPLIANCETYPE",855621170:"IFCEDGEFEATURE",2030761528:"IFCDUCTSILENCERTYPE",3760055223:"IFCDUCTSEGMENTTYPE",869906466:"IFCDUCTFITTINGTYPE",395920057:"IFCDOOR",3041715199:"IFCDISTRIBUTIONPORT",3040386961:"IFCDISTRIBUTIONFLOWELEMENT",1945004755:"IFCDISTRIBUTIONELEMENT",2063403501:"IFCDISTRIBUTIONCONTROLELEMENTTYPE",1599208980:"IFCDISTRIBUTIONCHAMBERELEMENTTYPE",2635815018:"IFCDISCRETEACCESSORYTYPE",1335981549:"IFCDISCRETEACCESSORY",4147604152:"IFCDIAMETERDIMENSION",3961806047:"IFCDAMPERTYPE",3495092785:"IFCCURTAINWALL",1973544240:"IFCCOVERING",2954562838:"IFCCOOLINGTOWERTYPE",335055490:"IFCCOOLEDBEAMTYPE",488727124:"IFCCONSTRUCTIONPRODUCTRESOURCE",1060000209:"IFCCONSTRUCTIONMATERIALRESOURCE",3898045240:"IFCCONSTRUCTIONEQUIPMENTRESOURCE",1163958913:"IFCCONDITIONCRITERION",2188551683:"IFCCONDITION",2816379211:"IFCCONDENSERTYPE",3850581409:"IFCCOMPRESSORTYPE",843113511:"IFCCOLUMN",2301859152:"IFCCOILTYPE",2611217952:"IFCCIRCLE",2951183804:"IFCCHILLERTYPE",1285652485:"IFCCABLESEGMENTTYPE",3293546465:"IFCCABLECARRIERSEGMENTTYPE",395041908:"IFCCABLECARRIERFITTINGTYPE",1909888760:"IFCBUILDINGELEMENTPROXYTYPE",1095909175:"IFCBUILDINGELEMENTPROXY",2979338954:"IFCBUILDINGELEMENTPART",52481810:"IFCBUILDINGELEMENTCOMPONENT",3299480353:"IFCBUILDINGELEMENT",231477066:"IFCBOILERTYPE",1916977116:"IFCBEZIERCURVE",819618141:"IFCBEAMTYPE",1967976161:"IFCBSPLINECURVE",3460190687:"IFCASSET",2470393545:"IFCANGULARDIMENSION",1871374353:"IFCAIRTOAIRHEATRECOVERYTYPE",3352864051:"IFCAIRTERMINALTYPE",1411407467:"IFCAIRTERMINALBOXTYPE",3821786052:"IFCACTIONREQUEST",1213861670:"IFC2DCOMPOSITECURVE",1033361043:"IFCZONE",3342526732:"IFCWORKSCHEDULE",4218914973:"IFCWORKPLAN",1028945134:"IFCWORKCONTROL",1133259667:"IFCWASTETERMINALTYPE",1898987631:"IFCWALLTYPE",2769231204:"IFCVIRTUALELEMENT",728799441:"IFCVALVETYPE",1911125066:"IFCUNITARYEQUIPMENTTYPE",1600972822:"IFCTUBEBUNDLETYPE",3593883385:"IFCTRIMMEDCURVE",1620046519:"IFCTRANSPORTELEMENT",1692211062:"IFCTRANSFORMERTYPE",1637806684:"IFCTIMESERIESSCHEDULE",5716631:"IFCTANKTYPE",2254336722:"IFCSYSTEM",2315554128:"IFCSWITCHINGDEVICETYPE",148013059:"IFCSUBCONTRACTRESOURCE",1975003073:"IFCSTRUCTURALSURFACECONNECTION",2986769608:"IFCSTRUCTURALRESULTGROUP",1235345126:"IFCSTRUCTURALPOINTREACTION",734778138:"IFCSTRUCTURALPOINTCONNECTION",2082059205:"IFCSTRUCTURALPOINTACTION",3987759626:"IFCSTRUCTURALPLANARACTIONVARYING",1621171031:"IFCSTRUCTURALPLANARACTION",1252848954:"IFCSTRUCTURALLOADGROUP",1721250024:"IFCSTRUCTURALLINEARACTIONVARYING",1807405624:"IFCSTRUCTURALLINEARACTION",2445595289:"IFCSTRUCTURALCURVEMEMBERVARYING",214636428:"IFCSTRUCTURALCURVEMEMBER",4243806635:"IFCSTRUCTURALCURVECONNECTION",1179482911:"IFCSTRUCTURALCONNECTION",682877961:"IFCSTRUCTURALACTION",1039846685:"IFCSTAIRFLIGHTTYPE",3112655638:"IFCSTACKTERMINALTYPE",3812236995:"IFCSPACETYPE",652456506:"IFCSPACEPROGRAM",1305183839:"IFCSPACEHEATERTYPE",3856911033:"IFCSPACE",2533589738:"IFCSLABTYPE",4097777520:"IFCSITE",4105383287:"IFCSERVICELIFE",3517283431:"IFCSCHEDULETIMECONTROL",1768891740:"IFCSANITARYTERMINALTYPE",2863920197:"IFCRELASSIGNSTASKS",160246688:"IFCRELAGGREGATES",2324767716:"IFCRAMPFLIGHTTYPE",2893384427:"IFCRAILINGTYPE",3248260540:"IFCRADIUSDIMENSION",2250791053:"IFCPUMPTYPE",1842657554:"IFCPROTECTIVEDEVICETYPE",3651124850:"IFCPROJECTIONELEMENT",3642467123:"IFCPROJECTORDERRECORD",2904328755:"IFCPROJECTORDER",2744685151:"IFCPROCEDURE",3740093272:"IFCPORT",3724593414:"IFCPOLYLINE",4017108033:"IFCPLATETYPE",4231323485:"IFCPIPESEGMENTTYPE",804291784:"IFCPIPEFITTINGTYPE",3327091369:"IFCPERMIT",2382730787:"IFCPERFORMANCEHISTORY",2837617999:"IFCOUTLETTYPE",3425660407:"IFCORDERACTION",3588315303:"IFCOPENINGELEMENT",4143007308:"IFCOCCUPANT",1916936684:"IFCMOVE",977012517:"IFCMOTORCONNECTIONTYPE",3181161470:"IFCMEMBERTYPE",2108223431:"IFCMECHANICALFASTENERTYPE",377706215:"IFCMECHANICALFASTENER",2506943328:"IFCLINEARDIMENSION",1161773419:"IFCLIGHTFIXTURETYPE",1051575348:"IFCLAMPTYPE",3827777499:"IFCLABORRESOURCE",4288270099:"IFCJUNCTIONBOXTYPE",2391368822:"IFCINVENTORY",1806887404:"IFCHUMIDIFIERTYPE",1251058090:"IFCHEATEXCHANGERTYPE",2706460486:"IFCGROUP",3009204131:"IFCGRID",200128114:"IFCGASTERMINALTYPE",814719939:"IFCFURNITURESTANDARD",263784265:"IFCFURNISHINGELEMENT",3009222698:"IFCFLOWTREATMENTDEVICETYPE",2297155007:"IFCFLOWTERMINALTYPE",1339347760:"IFCFLOWSTORAGEDEVICETYPE",1834744321:"IFCFLOWSEGMENTTYPE",1482959167:"IFCFLOWMOVINGDEVICETYPE",3815607619:"IFCFLOWMETERTYPE",3198132628:"IFCFLOWFITTINGTYPE",3907093117:"IFCFLOWCONTROLLERTYPE",1287392070:"IFCFEATUREELEMENTSUBTRACTION",2143335405:"IFCFEATUREELEMENTADDITION",2827207264:"IFCFEATUREELEMENT",2489546625:"IFCFASTENERTYPE",647756555:"IFCFASTENER",3737207727:"IFCFACETEDBREPWITHVOIDS",807026263:"IFCFACETEDBREP",3390157468:"IFCEVAPORATORTYPE",3174744832:"IFCEVAPORATIVECOOLERTYPE",3272907226:"IFCEQUIPMENTSTANDARD",1962604670:"IFCEQUIPMENTELEMENT",2107101300:"IFCENERGYCONVERSIONDEVICETYPE",1704287377:"IFCELLIPSE",2590856083:"IFCELEMENTCOMPONENTTYPE",1623761950:"IFCELEMENTCOMPONENT",4123344466:"IFCELEMENTASSEMBLY",1758889154:"IFCELEMENT",360485395:"IFCELECTRICALBASEPROPERTIES",3849074793:"IFCDISTRIBUTIONFLOWELEMENTTYPE",3256556792:"IFCDISTRIBUTIONELEMENTTYPE",681481545:"IFCDIMENSIONCURVEDIRECTEDCALLOUT",1457835157:"IFCCURTAINWALLTYPE",3295246426:"IFCCREWRESOURCE",1916426348:"IFCCOVERINGTYPE",1419761937:"IFCCOSTSCHEDULE",3895139033:"IFCCOSTITEM",3293443760:"IFCCONTROL",2559216714:"IFCCONSTRUCTIONRESOURCE",2510884976:"IFCCONIC",3732776249:"IFCCOMPOSITECURVE",300633059:"IFCCOLUMNTYPE",2937912522:"IFCCIRCLEHOLLOWPROFILEDEF",3124254112:"IFCBUILDINGSTOREY",1950629157:"IFCBUILDINGELEMENTTYPE",4031249490:"IFCBUILDING",1260505505:"IFCBOUNDEDCURVE",3649129432:"IFCBOOLEANCLIPPINGRESULT",1334484129:"IFCBLOCK",3207858831:"IFCASYMMETRICISHAPEPROFILEDEF",1674181508:"IFCANNOTATION",2296667514:"IFCACTOR",2097647324:"IFCTRANSPORTELEMENTTYPE",3473067441:"IFCTASK",1580310250:"IFCSYSTEMFURNITUREELEMENTTYPE",4124788165:"IFCSURFACEOFREVOLUTION",2809605785:"IFCSURFACEOFLINEAREXTRUSION",2028607225:"IFCSURFACECURVESWEPTAREASOLID",4070609034:"IFCSTRUCTUREDDIMENSIONCALLOUT",2218152070:"IFCSTRUCTURALSURFACEMEMBERVARYING",3979015343:"IFCSTRUCTURALSURFACEMEMBER",3689010777:"IFCSTRUCTURALREACTION",530289379:"IFCSTRUCTURALMEMBER",3136571912:"IFCSTRUCTURALITEM",3544373492:"IFCSTRUCTURALACTIVITY",451544542:"IFCSPHERE",3893378262:"IFCSPATIALSTRUCTUREELEMENTTYPE",2706606064:"IFCSPATIALSTRUCTUREELEMENT",3626867408:"IFCRIGHTCIRCULARCYLINDER",4158566097:"IFCRIGHTCIRCULARCONE",1856042241:"IFCREVOLVEDAREASOLID",2914609552:"IFCRESOURCE",1401173127:"IFCRELVOIDSELEMENT",3451746338:"IFCRELSPACEBOUNDARY",366585022:"IFCRELSERVICESBUILDINGS",4122056220:"IFCRELSEQUENCE",1058617721:"IFCRELSCHEDULESCOSTITEMS",1245217292:"IFCRELREFERENCEDINSPATIALSTRUCTURE",750771296:"IFCRELPROJECTSELEMENT",202636808:"IFCRELOVERRIDESPROPERTIES",2051452291:"IFCRELOCCUPIESSPACES",3268803585:"IFCRELNESTS",4189434867:"IFCRELINTERACTIONREQUIREMENTS",279856033:"IFCRELFLOWCONTROLELEMENTS",3940055652:"IFCRELFILLSELEMENT",781010003:"IFCRELDEFINESBYTYPE",4186316022:"IFCRELDEFINESBYPROPERTIES",693640335:"IFCRELDEFINES",2551354335:"IFCRELDECOMPOSES",2802773753:"IFCRELCOVERSSPACES",886880790:"IFCRELCOVERSBLDGELEMENTS",3242617779:"IFCRELCONTAINEDINSPATIALSTRUCTURE",3678494232:"IFCRELCONNECTSWITHREALIZINGELEMENTS",504942748:"IFCRELCONNECTSWITHECCENTRICITY",1638771189:"IFCRELCONNECTSSTRUCTURALMEMBER",3912681535:"IFCRELCONNECTSSTRUCTURALELEMENT",2127690289:"IFCRELCONNECTSSTRUCTURALACTIVITY",3190031847:"IFCRELCONNECTSPORTS",4201705270:"IFCRELCONNECTSPORTTOELEMENT",3945020480:"IFCRELCONNECTSPATHELEMENTS",1204542856:"IFCRELCONNECTSELEMENTS",826625072:"IFCRELCONNECTS",2851387026:"IFCRELASSOCIATESPROFILEPROPERTIES",2655215786:"IFCRELASSOCIATESMATERIAL",3840914261:"IFCRELASSOCIATESLIBRARY",982818633:"IFCRELASSOCIATESDOCUMENT",2728634034:"IFCRELASSOCIATESCONSTRAINT",919958153:"IFCRELASSOCIATESCLASSIFICATION",4095574036:"IFCRELASSOCIATESAPPROVAL",1327628568:"IFCRELASSOCIATESAPPLIEDVALUE",1865459582:"IFCRELASSOCIATES",205026976:"IFCRELASSIGNSTORESOURCE",3372526763:"IFCRELASSIGNSTOPROJECTORDER",2857406711:"IFCRELASSIGNSTOPRODUCT",4278684876:"IFCRELASSIGNSTOPROCESS",1307041759:"IFCRELASSIGNSTOGROUP",2495723537:"IFCRELASSIGNSTOCONTROL",1683148259:"IFCRELASSIGNSTOACTOR",3939117080:"IFCRELASSIGNS",3454111270:"IFCRECTANGULARTRIMMEDSURFACE",2798486643:"IFCRECTANGULARPYRAMID",2770003689:"IFCRECTANGLEHOLLOWPROFILEDEF",3219374653:"IFCPROXY",1451395588:"IFCPROPERTYSET",4194566429:"IFCPROJECTIONCURVE",103090709:"IFCPROJECT",4208778838:"IFCPRODUCT",2945172077:"IFCPROCESS",220341763:"IFCPLANE",603570806:"IFCPLANARBOX",3566463478:"IFCPERMEABLECOVERINGPROPERTIES",3505215534:"IFCOFFSETCURVE3D",3388369263:"IFCOFFSETCURVE2D",3888040117:"IFCOBJECT",1425443689:"IFCMANIFOLDSOLIDBREP",1281925730:"IFCLINE",572779678:"IFCLSHAPEPROFILEDEF",1484403080:"IFCISHAPEPROFILEDEF",987898635:"IFCGEOMETRICCURVESET",1268542332:"IFCFURNITURETYPE",4238390223:"IFCFURNISHINGELEMENTTYPE",3455213021:"IFCFLUIDFLOWPROPERTIES",315944413:"IFCFILLAREASTYLETILES",4203026998:"IFCFILLAREASTYLETILESYMBOLWITHSTYLE",374418227:"IFCFILLAREASTYLEHATCHING",2047409740:"IFCFACEBASEDSURFACEMODEL",477187591:"IFCEXTRUDEDAREASOLID",80994333:"IFCENERGYPROPERTIES",2835456948:"IFCELLIPSEPROFILEDEF",2777663545:"IFCELEMENTARYSURFACE",339256511:"IFCELEMENTTYPE",1883228015:"IFCELEMENTQUANTITY",1472233963:"IFCEDGELOOP",4006246654:"IFCDRAUGHTINGPREDEFINEDCURVEFONT",445594917:"IFCDRAUGHTINGPREDEFINEDCOLOUR",3073041342:"IFCDRAUGHTINGCALLOUT",526551008:"IFCDOORSTYLE",1714330368:"IFCDOORPANELPROPERTIES",2963535650:"IFCDOORLININGPROPERTIES",32440307:"IFCDIRECTION",4054601972:"IFCDIMENSIONCURVETERMINATOR",606661476:"IFCDIMENSIONCURVE",693772133:"IFCDEFINEDSYMBOL",2827736869:"IFCCURVEBOUNDEDPLANE",2601014836:"IFCCURVE",2147822146:"IFCCSGSOLID",2506170314:"IFCCSGPRIMITIVE3D",194851669:"IFCCRANERAILFSHAPEPROFILEDEF",4133800736:"IFCCRANERAILASHAPEPROFILEDEF",2485617015:"IFCCOMPOSITECURVESEGMENT",2205249479:"IFCCLOSEDSHELL",1383045692:"IFCCIRCLEPROFILEDEF",1416205885:"IFCCARTESIANTRANSFORMATIONOPERATOR3DNONUNIFORM",3331915920:"IFCCARTESIANTRANSFORMATIONOPERATOR3D",3486308946:"IFCCARTESIANTRANSFORMATIONOPERATOR2DNONUNIFORM",3749851601:"IFCCARTESIANTRANSFORMATIONOPERATOR2D",59481748:"IFCCARTESIANTRANSFORMATIONOPERATOR",1123145078:"IFCCARTESIANPOINT",2898889636:"IFCCSHAPEPROFILEDEF",2713105998:"IFCBOXEDHALFSPACE",2581212453:"IFCBOUNDINGBOX",4182860854:"IFCBOUNDEDSURFACE",2736907675:"IFCBOOLEANRESULT",2740243338:"IFCAXIS2PLACEMENT3D",3125803723:"IFCAXIS2PLACEMENT2D",4261334040:"IFCAXIS1PLACEMENT",1302238472:"IFCANNOTATIONSURFACE",2265737646:"IFCANNOTATIONFILLAREAOCCURRENCE",669184980:"IFCANNOTATIONFILLAREA",3288037868:"IFCANNOTATIONCURVEOCCURRENCE",2543172580:"IFCZSHAPEPROFILEDEF",1299126871:"IFCWINDOWSTYLE",512836454:"IFCWINDOWPANELPROPERTIES",336235671:"IFCWINDOWLININGPROPERTIES",2759199220:"IFCVERTEXLOOP",1417489154:"IFCVECTOR",427810014:"IFCUSHAPEPROFILEDEF",2347495698:"IFCTYPEPRODUCT",1628702193:"IFCTYPEOBJECT",1345879162:"IFCTWODIRECTIONREPEATFACTOR",2715220739:"IFCTRAPEZIUMPROFILEDEF",3124975700:"IFCTEXTLITERALWITHEXTENT",4282788508:"IFCTEXTLITERAL",3028897424:"IFCTERMINATORSYMBOL",3071757647:"IFCTSHAPEPROFILEDEF",230924584:"IFCSWEPTSURFACE",1260650574:"IFCSWEPTDISKSOLID",2247615214:"IFCSWEPTAREASOLID",1878645084:"IFCSURFACESTYLERENDERING",2513912981:"IFCSURFACE",2233826070:"IFCSUBEDGE",3653947884:"IFCSTRUCTURALSTEELPROFILEPROPERTIES",3843319758:"IFCSTRUCTURALPROFILEPROPERTIES",1190533807:"IFCSTRUCTURALLOADSINGLEFORCEWARPING",1597423693:"IFCSTRUCTURALLOADSINGLEFORCE",1973038258:"IFCSTRUCTURALLOADSINGLEDISPLACEMENTDISTORTION",2473145415:"IFCSTRUCTURALLOADSINGLEDISPLACEMENT",2668620305:"IFCSTRUCTURALLOADPLANARFORCE",1595516126:"IFCSTRUCTURALLOADLINEARFORCE",390701378:"IFCSPACETHERMALLOADPROPERTIES",1202362311:"IFCSOUNDVALUE",2485662743:"IFCSOUNDPROPERTIES",723233188:"IFCSOLIDMODEL",2609359061:"IFCSLIPPAGECONNECTIONCONDITION",4124623270:"IFCSHELLBASEDSURFACEMODEL",2411513650:"IFCSERVICELIFEFACTOR",1509187699:"IFCSECTIONEDSPINE",2778083089:"IFCROUNDEDRECTANGLEPROFILEDEF",478536968:"IFCRELATIONSHIP",3765753017:"IFCREINFORCEMENTDEFINITIONPROPERTIES",3413951693:"IFCREGULARTIMESERIES",3615266464:"IFCRECTANGLEPROFILEDEF",110355661:"IFCPROPERTYTABLEVALUE",3650150729:"IFCPROPERTYSINGLEVALUE",3357820518:"IFCPROPERTYSETDEFINITION",941946838:"IFCPROPERTYREFERENCEVALUE",2752243245:"IFCPROPERTYLISTVALUE",4166981789:"IFCPROPERTYENUMERATEDVALUE",1680319473:"IFCPROPERTYDEFINITION",871118103:"IFCPROPERTYBOUNDEDVALUE",673634403:"IFCPRODUCTDEFINITIONSHAPE",179317114:"IFCPREDEFINEDPOINTMARKERSYMBOL",433424934:"IFCPREDEFINEDDIMENSIONSYMBOL",2559016684:"IFCPREDEFINEDCURVEFONT",759155922:"IFCPREDEFINEDCOLOUR",2775532180:"IFCPOLYGONALBOUNDEDHALFSPACE",2924175390:"IFCPOLYLOOP",1423911732:"IFCPOINTONSURFACE",4022376103:"IFCPOINTONCURVE",2067069095:"IFCPOINT",1663979128:"IFCPLANAREXTENT",2004835150:"IFCPLACEMENT",597895409:"IFCPIXELTEXTURE",3021840470:"IFCPHYSICALCOMPLEXQUANTITY",2519244187:"IFCPATH",2529465313:"IFCPARAMETERIZEDPROFILEDEF",1029017970:"IFCORIENTEDEDGE",2665983363:"IFCOPENSHELL",2833995503:"IFCONEDIRECTIONREPEATFACTOR",219451334:"IFCOBJECTDEFINITION",1430189142:"IFCMECHANICALCONCRETEMATERIALPROPERTIES",2022407955:"IFCMATERIALDEFINITIONREPRESENTATION",2347385850:"IFCMAPPEDITEM",1008929658:"IFCLOOP",2624227202:"IFCLOCALPLACEMENT",3422422726:"IFCLIGHTSOURCESPOT",1520743889:"IFCLIGHTSOURCEPOSITIONAL",4266656042:"IFCLIGHTSOURCEGONIOMETRIC",2604431987:"IFCLIGHTSOURCEDIRECTIONAL",125510826:"IFCLIGHTSOURCEAMBIENT",1402838566:"IFCLIGHTSOURCE",3741457305:"IFCIRREGULARTIMESERIES",3905492369:"IFCIMAGETEXTURE",2445078500:"IFCHYGROSCOPICMATERIALPROPERTIES",812098782:"IFCHALFSPACESOLID",178086475:"IFCGRIDPLACEMENT",3590301190:"IFCGEOMETRICSET",4142052618:"IFCGEOMETRICREPRESENTATIONSUBCONTEXT",2453401579:"IFCGEOMETRICREPRESENTATIONITEM",3448662350:"IFCGEOMETRICREPRESENTATIONCONTEXT",1446786286:"IFCGENERALPROFILEPROPERTIES",803998398:"IFCGENERALMATERIALPROPERTIES",3857492461:"IFCFUELPROPERTIES",738692330:"IFCFILLAREASTYLE",4219587988:"IFCFAILURECONNECTIONCONDITION",3008276851:"IFCFACESURFACE",803316827:"IFCFACEOUTERBOUND",1809719519:"IFCFACEBOUND",2556980723:"IFCFACE",1860660968:"IFCEXTENDEDMATERIALPROPERTIES",476780140:"IFCEDGECURVE",3900360178:"IFCEDGE",4170525392:"IFCDRAUGHTINGPREDEFINEDTEXTFONT",3732053477:"IFCDOCUMENTREFERENCE",1694125774:"IFCDIMENSIONPAIR",2273265877:"IFCDIMENSIONCALLOUTRELATIONSHIP",3632507154:"IFCDERIVEDPROFILEDEF",3800577675:"IFCCURVESTYLE",2889183280:"IFCCONVERSIONBASEDUNIT",3050246964:"IFCCONTEXTDEPENDENTUNIT",45288368:"IFCCONNECTIONPOINTECCENTRICITY",1981873012:"IFCCONNECTIONCURVEGEOMETRY",370225590:"IFCCONNECTEDFACESET",1485152156:"IFCCOMPOSITEPROFILEDEF",2542286263:"IFCCOMPLEXPROPERTY",776857604:"IFCCOLOURRGB",647927063:"IFCCLASSIFICATIONREFERENCE",3150382593:"IFCCENTERLINEPROFILEDEF",616511568:"IFCBLOBTEXTURE",2705031697:"IFCARBITRARYPROFILEDEFWITHVOIDS",1310608509:"IFCARBITRARYOPENPROFILEDEF",3798115385:"IFCARBITRARYCLOSEDPROFILEDEF",2297822566:"IFCANNOTATIONTEXTOCCURRENCE",3612888222:"IFCANNOTATIONSYMBOLOCCURRENCE",962685235:"IFCANNOTATIONSURFACEOCCURRENCE",2442683028:"IFCANNOTATIONOCCURRENCE",1065908215:"IFCWATERPROPERTIES",891718957:"IFCVIRTUALGRIDINTERSECTION",1907098498:"IFCVERTEXPOINT",3304826586:"IFCVERTEXBASEDTEXTUREMAP",2799835756:"IFCVERTEX",180925521:"IFCUNITASSIGNMENT",1735638870:"IFCTOPOLOGYREPRESENTATION",1377556343:"IFCTOPOLOGICALREPRESENTATIONITEM",581633288:"IFCTIMESERIESVALUE",1718945513:"IFCTIMESERIESREFERENCERELATIONSHIP",3101149627:"IFCTIMESERIES",3317419933:"IFCTHERMALMATERIALPROPERTIES",1210645708:"IFCTEXTUREVERTEX",2552916305:"IFCTEXTUREMAP",1742049831:"IFCTEXTURECOORDINATEGENERATOR",280115917:"IFCTEXTURECOORDINATE",1484833681:"IFCTEXTSTYLEWITHBOXCHARACTERISTICS",1640371178:"IFCTEXTSTYLETEXTMODEL",2636378356:"IFCTEXTSTYLEFORDEFINEDFONT",1983826977:"IFCTEXTSTYLEFONTMODEL",1447204868:"IFCTEXTSTYLE",912023232:"IFCTELECOMADDRESS",531007025:"IFCTABLEROW",985171141:"IFCTABLE",1290481447:"IFCSYMBOLSTYLE",626085974:"IFCSURFACETEXTURE",1351298697:"IFCSURFACESTYLEWITHTEXTURES",846575682:"IFCSURFACESTYLESHADING",1607154358:"IFCSURFACESTYLEREFRACTION",3303107099:"IFCSURFACESTYLELIGHTING",1300840506:"IFCSURFACESTYLE",3049322572:"IFCSTYLEDREPRESENTATION",3958052878:"IFCSTYLEDITEM",2830218821:"IFCSTYLEMODEL",3408363356:"IFCSTRUCTURALLOADTEMPERATURE",2525727697:"IFCSTRUCTURALLOADSTATIC",2162789131:"IFCSTRUCTURALLOAD",2273995522:"IFCSTRUCTURALCONNECTIONCONDITION",3692461612:"IFCSIMPLEPROPERTY",4240577450:"IFCSHAPEREPRESENTATION",3982875396:"IFCSHAPEMODEL",867548509:"IFCSHAPEASPECT",4165799628:"IFCSECTIONREINFORCEMENTPROPERTIES",2042790032:"IFCSECTIONPROPERTIES",448429030:"IFCSIUNIT",2341007311:"IFCROOT",3679540991:"IFCRIBPLATEPROFILEPROPERTIES",1660063152:"IFCREPRESENTATIONMAP",3008791417:"IFCREPRESENTATIONITEM",3377609919:"IFCREPRESENTATIONCONTEXT",1076942058:"IFCREPRESENTATION",1222501353:"IFCRELAXATION",1580146022:"IFCREINFORCEMENTBARPROPERTIES",2692823254:"IFCREFERENCESVALUEDOCUMENT",825690147:"IFCQUANTITYWEIGHT",2405470396:"IFCQUANTITYVOLUME",3252649465:"IFCQUANTITYTIME",931644368:"IFCQUANTITYLENGTH",2093928680:"IFCQUANTITYCOUNT",2044713172:"IFCQUANTITYAREA",3710013099:"IFCPROPERTYENUMERATION",148025276:"IFCPROPERTYDEPENDENCYRELATIONSHIP",3896028662:"IFCPROPERTYCONSTRAINTRELATIONSHIP",2598011224:"IFCPROPERTY",2802850158:"IFCPROFILEPROPERTIES",3958567839:"IFCPROFILEDEF",2267347899:"IFCPRODUCTSOFCOMBUSTIONPROPERTIES",2095639259:"IFCPRODUCTREPRESENTATION",2417041796:"IFCPRESENTATIONSTYLEASSIGNMENT",3119450353:"IFCPRESENTATIONSTYLE",1304840413:"IFCPRESENTATIONLAYERWITHSTYLE",2022622350:"IFCPRESENTATIONLAYERASSIGNMENT",1775413392:"IFCPREDEFINEDTEXTFONT",3213052703:"IFCPREDEFINEDTERMINATORSYMBOL",990879717:"IFCPREDEFINEDSYMBOL",3727388367:"IFCPREDEFINEDITEM",3355820592:"IFCPOSTALADDRESS",2226359599:"IFCPHYSICALSIMPLEQUANTITY",2483315170:"IFCPHYSICALQUANTITY",101040310:"IFCPERSONANDORGANIZATION",2077209135:"IFCPERSON",1207048766:"IFCOWNERHISTORY",1411181986:"IFCORGANIZATIONRELATIONSHIP",4251960020:"IFCORGANIZATION",1227763645:"IFCOPTICALMATERIALPROPERTIES",2251480897:"IFCOBJECTIVE",3701648758:"IFCOBJECTPLACEMENT",1918398963:"IFCNAMEDUNIT",2706619895:"IFCMONETARYUNIT",3368373690:"IFCMETRIC",677618848:"IFCMECHANICALSTEELMATERIALPROPERTIES",4256014907:"IFCMECHANICALMATERIALPROPERTIES",2597039031:"IFCMEASUREWITHUNIT",3265635763:"IFCMATERIALPROPERTIES",2199411900:"IFCMATERIALLIST",1303795690:"IFCMATERIALLAYERSETUSAGE",3303938423:"IFCMATERIALLAYERSET",248100487:"IFCMATERIALLAYER",1847130766:"IFCMATERIALCLASSIFICATIONRELATIONSHIP",1838606355:"IFCMATERIAL",30780891:"IFCLOCALTIME",1566485204:"IFCLIGHTINTENSITYDISTRIBUTION",4162380809:"IFCLIGHTDISTRIBUTIONDATA",3452421091:"IFCLIBRARYREFERENCE",2655187982:"IFCLIBRARYINFORMATION",3020489413:"IFCIRREGULARTIMESERIESVALUE",852622518:"IFCGRIDAXIS",3548104201:"IFCEXTERNALLYDEFINEDTEXTFONT",3207319532:"IFCEXTERNALLYDEFINEDSYMBOL",1040185647:"IFCEXTERNALLYDEFINEDSURFACESTYLE",2242383968:"IFCEXTERNALLYDEFINEDHATCHSTYLE",3200245327:"IFCEXTERNALREFERENCE",1648886627:"IFCENVIRONMENTALIMPACTVALUE",3796139169:"IFCDRAUGHTINGCALLOUTRELATIONSHIP",770865208:"IFCDOCUMENTINFORMATIONRELATIONSHIP",1154170062:"IFCDOCUMENTINFORMATION",1376555844:"IFCDOCUMENTELECTRONICFORMAT",2949456006:"IFCDIMENSIONALEXPONENTS",1045800335:"IFCDERIVEDUNITELEMENT",1765591967:"IFCDERIVEDUNIT",1072939445:"IFCDATEANDTIME",3510044353:"IFCCURVESTYLEFONTPATTERN",2367409068:"IFCCURVESTYLEFONTANDSCALING",1105321065:"IFCCURVESTYLEFONT",539742890:"IFCCURRENCYRELATIONSHIP",602808272:"IFCCOSTVALUE",1065062679:"IFCCOORDINATEDUNIVERSALTIMEOFFSET",347226245:"IFCCONSTRAINTRELATIONSHIP",613356794:"IFCCONSTRAINTCLASSIFICATIONRELATIONSHIP",1658513725:"IFCCONSTRAINTAGGREGATIONRELATIONSHIP",1959218052:"IFCCONSTRAINT",2732653382:"IFCCONNECTIONSURFACEGEOMETRY",4257277454:"IFCCONNECTIONPORTGEOMETRY",2614616156:"IFCCONNECTIONPOINTGEOMETRY",2859738748:"IFCCONNECTIONGEOMETRY",3264961684:"IFCCOLOURSPECIFICATION",3639012971:"IFCCLASSIFICATIONNOTATIONFACET",938368621:"IFCCLASSIFICATIONNOTATION",1098599126:"IFCCLASSIFICATIONITEMRELATIONSHIP",1767535486:"IFCCLASSIFICATIONITEM",747523909:"IFCCLASSIFICATION",622194075:"IFCCALENDARDATE",2069777674:"IFCBOUNDARYNODECONDITIONWARPING",1387855156:"IFCBOUNDARYNODECONDITION",3367102660:"IFCBOUNDARYFACECONDITION",1560379544:"IFCBOUNDARYEDGECONDITION",4037036970:"IFCBOUNDARYCONDITION",3869604511:"IFCAPPROVALRELATIONSHIP",390851274:"IFCAPPROVALPROPERTYRELATIONSHIP",2080292479:"IFCAPPROVALACTORRELATIONSHIP",130549933:"IFCAPPROVAL",1110488051:"IFCAPPLIEDVALUERELATIONSHIP",411424972:"IFCAPPLIEDVALUE",639542469:"IFCAPPLICATION",618182010:"IFCADDRESS",3630933823:"IFCACTORROLE",599546466:"FILE_DESCRIPTION",1390159747:"FILE_NAME",1109904537:"FILE_SCHEMA"};class Wa{static async getUnits(t){var e,i,s;const{IFCUNITASSIGNMENT:n}=_e,o=await t.getAllPropertiesOfType(n);if(!o)return 1;const a=Object.keys(o),c=o[parseInt(a[0],10)];for(const l of c.Units){if(l.value===void 0||l.value===null)continue;const h=await t.getProperties(l.value);if(!h||!h.UnitType||!h.UnitType.value||h.UnitType.value!=="LENGTHUNIT")continue;let d=1,f=1;return h.Name.value==="METRE"&&(f=1),h.Name.value==="FOOT"&&(f=.3048),((e=h.Prefix)==null?void 0:e.value)==="MILLI"?d=.001:((i=h.Prefix)==null?void 0:i.value)==="CENTI"?d=.01:((s=h.Prefix)==null?void 0:s.value)==="DECI"&&(d=.1),f*d}return 1}static async findItemByGuid(t,e){var i;const s=t.getAllPropertiesIDs();for(const n of s){const o=await t.getProperties(n);if(o&&((i=o.GlobalId)==null?void 0:i.value)===e)return o}return null}static async getRelationMap(t,e,i){var s;const o=i??(async()=>{}),a={},c=t.getAllPropertiesIDs();for(const l of c){const h=await t.getProperties(l);if(!h)continue;const u=h.type===e,d=Object.keys(h).find(I=>I.startsWith("Relating")),f=Object.keys(h).find(I=>I.startsWith("Related"));if(!(u&&d&&f))continue;const p=await t.getProperties((s=h[d])==null?void 0:s.value),m=h[f];if(!p||!m||!(m&&Array.isArray(m)))continue;const g=m.map(I=>I.value);await o(p.expressID,g),a[p.expressID]=g}return a}static async getQsetQuantities(t,e,i){const n=i??(()=>{}),o=await t.getProperties(e);return!o||o.type!==Ks?null:(o.Quantities??[{}]).map(l=>(l.value&&n(l.value),l.value)).filter(l=>l!==null)}static async getPsetProps(t,e,i){const n=i??(()=>{}),o=await t.getProperties(e);return!o||o.type!==pi?null:(o.HasProperties??[{}]).map(l=>(l.value&&n(l.value),l.value)).filter(l=>l!==null)}static async getPsetRel(t,e){var i;if(!await t.getProperties(e))return null;const n=await t.getAllPropertiesOfType(on);if(!n)return null;const o=Object.values(n);let a=null;for(const c of o)((i=c.RelatingPropertyDefinition)==null?void 0:i.value)===e&&(a=c.expressID);return a}static async getQsetRel(t,e){return Wa.getPsetRel(t,e)}static async getEntityName(t,e){var i;const s=await t.getProperties(e);if(!s)return{key:null,name:null};const n=Object.keys(s).find(a=>a.endsWith("Name"))??null,o=n?(i=s[n])==null?void 0:i.value:null;return{key:n,name:o}}static async getQuantityValue(t,e){const i=await t.getProperties(e);if(!i)return{key:null,value:null};const s=Object.keys(i).find(o=>o.endsWith("Value"))??null;let n;return s===null||i[s]===void 0||i[s]===null?n=null:n=i[s].value,{key:s,value:n}}static isRel(t){return Ar[t].startsWith("IFCREL")}static async attributeExists(t,e,i){const s=await t.getProperties(e);return s?Object.keys(s).includes(i):!1}static async groupEntitiesByType(t,e){var i;const s=new Map;for(const n of e){const o=await t.getProperties(n);if(!o)continue;const a=o.type;s.get(a)||s.set(a,new Set),(i=s.get(a))==null||i.add(n)}return s}}const DL={IFCURIREFERENCE:"IfcUriReference",IFCTIME:"IfcTime",IFCTEMPERATURERATEOFCHANGEMEASURE:"IfcTemperatureRateOfChangeMeasure",IFCSOUNDPRESSURELEVELMEASURE:"IfcSoundPressureLevelMeasure",IFCSOUNDPOWERLEVELMEASURE:"IfcSoundPowerLevelMeasure",IFCPROPERTYSETDEFINITIONSET:"IfcPropertySetDefinitionSet",IFCPOSITIVEINTEGER:"IfcPositiveInteger",IFCNONNEGATIVELENGTHMEASURE:"IfcNonNegativeLengthMeasure",IFCLINEINDEX:"IfcLineIndex",IFCLANGUAGEID:"IfcLanguageId",IFCDURATION:"IfcDuration",IFCDAYINWEEKNUMBER:"IfcDayInWeekNumber",IFCDATETIME:"IfcDateTime",IFCDATE:"IfcDate",IFCCARDINALPOINTREFERENCE:"IfcCardinalPointReference",IFCBINARY:"IfcBinary",IFCAREADENSITYMEASURE:"IfcAreaDensityMeasure",IFCARCINDEX:"IfcArcIndex",IFCYEARNUMBER:"IfcYearNumber",IFCWARPINGMOMENTMEASURE:"IfcWarpingMomentMeasure",IFCWARPINGCONSTANTMEASURE:"IfcWarpingConstantMeasure",IFCVOLUMETRICFLOWRATEMEASURE:"IfcVolumetricFlowRateMeasure",IFCVOLUMEMEASURE:"IfcVolumeMeasure",IFCVAPORPERMEABILITYMEASURE:"IfcVaporPermeabilityMeasure",IFCTORQUEMEASURE:"IfcTorqueMeasure",IFCTIMESTAMP:"IfcTimestamp",IFCTIMEMEASURE:"IfcTimeMeasure",IFCTHERMODYNAMICTEMPERATUREMEASURE:"IfcThermodynamicTemperatureMeasure",IFCTHERMALTRANSMITTANCEMEASURE:"IfcThermalTransmittanceMeasure",IFCTHERMALRESISTANCEMEASURE:"IfcThermalResistanceMeasure",IFCTHERMALEXPANSIONCOEFFICIENTMEASURE:"IfcThermalExpansionCoefficientMeasure",IFCTHERMALCONDUCTIVITYMEASURE:"IfcThermalConductivityMeasure",IFCTHERMALADMITTANCEMEASURE:"IfcThermalAdmittanceMeasure",IFCTEXTTRANSFORMATION:"IfcTextTransformation",IFCTEXTFONTNAME:"IfcTextFontName",IFCTEXTDECORATION:"IfcTextDecoration",IFCTEXTALIGNMENT:"IfcTextAlignment",IFCTEXT:"IfcText",IFCTEMPERATUREGRADIENTMEASURE:"IfcTemperatureGradientMeasure",IFCSPECULARROUGHNESS:"IfcSpecularRoughness",IFCSPECULAREXPONENT:"IfcSpecularExponent",IFCSPECIFICHEATCAPACITYMEASURE:"IfcSpecificHeatCapacityMeasure",IFCSOUNDPRESSUREMEASURE:"IfcSoundPressureMeasure",IFCSOUNDPOWERMEASURE:"IfcSoundPowerMeasure",IFCSOLIDANGLEMEASURE:"IfcSolidAngleMeasure",IFCSHEARMODULUSMEASURE:"IfcShearModulusMeasure",IFCSECTIONALAREAINTEGRALMEASURE:"IfcSectionalAreaIntegralMeasure",IFCSECTIONMODULUSMEASURE:"IfcSectionModulusMeasure",IFCSECONDINMINUTE:"IfcSecondInMinute",IFCROTATIONALSTIFFNESSMEASURE:"IfcRotationalStiffnessMeasure",IFCROTATIONALMASSMEASURE:"IfcRotationalMassMeasure",IFCROTATIONALFREQUENCYMEASURE:"IfcRotationalFrequencyMeasure",IFCREAL:"IfcReal",IFCRATIOMEASURE:"IfcRatioMeasure",IFCRADIOACTIVITYMEASURE:"IfcRadioactivityMeasure",IFCPRESSUREMEASURE:"IfcPressureMeasure",IFCPRESENTABLETEXT:"IfcPresentableText",IFCPOWERMEASURE:"IfcPowerMeasure",IFCPOSITIVERATIOMEASURE:"IfcPositiveRatioMeasure",IFCPOSITIVEPLANEANGLEMEASURE:"IfcPositivePlaneAngleMeasure",IFCPOSITIVELENGTHMEASURE:"IfcPositiveLengthMeasure",IFCPLANEANGLEMEASURE:"IfcPlaneAngleMeasure",IFCPLANARFORCEMEASURE:"IfcPlanarForceMeasure",IFCPARAMETERVALUE:"IfcParameterValue",IFCPHMEASURE:"IfcPhMeasure",IFCNUMERICMEASURE:"IfcNumericMeasure",IFCNORMALISEDRATIOMEASURE:"IfcNormalisedRatioMeasure",IFCMONTHINYEARNUMBER:"IfcMonthInYearNumber",IFCMONETARYMEASURE:"IfcMonetaryMeasure",IFCMOMENTOFINERTIAMEASURE:"IfcMomentOfInertiaMeasure",IFCMOLECULARWEIGHTMEASURE:"IfcMolecularWeightMeasure",IFCMOISTUREDIFFUSIVITYMEASURE:"IfcMoistureDiffusivityMeasure",IFCMODULUSOFSUBGRADEREACTIONMEASURE:"IfcModulusOfSubgradeReactionMeasure",IFCMODULUSOFROTATIONALSUBGRADEREACTIONMEASURE:"IfcModulusOfRotationalSubgradeReactionMeasure",IFCMODULUSOFLINEARSUBGRADEREACTIONMEASURE:"IfcModulusOfLinearSubgradeReactionMeasure",IFCMODULUSOFELASTICITYMEASURE:"IfcModulusOfElasticityMeasure",IFCMINUTEINHOUR:"IfcMinuteInHour",IFCMASSPERLENGTHMEASURE:"IfcMassPerLengthMeasure",IFCMASSMEASURE:"IfcMassMeasure",IFCMASSFLOWRATEMEASURE:"IfcMassFlowRateMeasure",IFCMASSDENSITYMEASURE:"IfcMassDensityMeasure",IFCMAGNETICFLUXMEASURE:"IfcMagneticFluxMeasure",IFCMAGNETICFLUXDENSITYMEASURE:"IfcMagneticFluxDensityMeasure",IFCLUMINOUSINTENSITYMEASURE:"IfcLuminousIntensityMeasure",IFCLUMINOUSINTENSITYDISTRIBUTIONMEASURE:"IfcLuminousIntensityDistributionMeasure",IFCLUMINOUSFLUXMEASURE:"IfcLuminousFluxMeasure",IFCLOGICAL:"IfcLogical",IFCLINEARVELOCITYMEASURE:"IfcLinearVelocityMeasure",IFCLINEARSTIFFNESSMEASURE:"IfcLinearStiffnessMeasure",IFCLINEARMOMENTMEASURE:"IfcLinearMomentMeasure",IFCLINEARFORCEMEASURE:"IfcLinearForceMeasure",IFCLENGTHMEASURE:"IfcLengthMeasure",IFCLABEL:"IfcLabel",IFCKINEMATICVISCOSITYMEASURE:"IfcKinematicViscosityMeasure",IFCISOTHERMALMOISTURECAPACITYMEASURE:"IfcIsothermalMoistureCapacityMeasure",IFCIONCONCENTRATIONMEASURE:"IfcIonConcentrationMeasure",IFCINTEGERCOUNTRATEMEASURE:"IfcIntegerCountRateMeasure",IFCINTEGER:"IfcInteger",IFCINDUCTANCEMEASURE:"IfcInductanceMeasure",IFCILLUMINANCEMEASURE:"IfcIlluminanceMeasure",IFCIDENTIFIER:"IfcIdentifier",IFCHOURINDAY:"IfcHourInDay",IFCHEATINGVALUEMEASURE:"IfcHeatingValueMeasure",IFCHEATFLUXDENSITYMEASURE:"IfcHeatFluxDensityMeasure",IFCGLOBALLYUNIQUEID:"IfcGloballyUniqueId",IFCFREQUENCYMEASURE:"IfcFrequencyMeasure",IFCFORCEMEASURE:"IfcForceMeasure",IFCFONTWEIGHT:"IfcFontWeight",IFCFONTVARIANT:"IfcFontVariant",IFCFONTSTYLE:"IfcFontStyle",IFCENERGYMEASURE:"IfcEnergyMeasure",IFCELECTRICVOLTAGEMEASURE:"IfcElectricVoltageMeasure",IFCELECTRICRESISTANCEMEASURE:"IfcElectricResistanceMeasure",IFCELECTRICCURRENTMEASURE:"IfcElectricCurrentMeasure",IFCELECTRICCONDUCTANCEMEASURE:"IfcElectricConductanceMeasure",IFCELECTRICCHARGEMEASURE:"IfcElectricChargeMeasure",IFCELECTRICCAPACITANCEMEASURE:"IfcElectricCapacitanceMeasure",IFCDYNAMICVISCOSITYMEASURE:"IfcDynamicViscosityMeasure",IFCDOSEEQUIVALENTMEASURE:"IfcDoseEquivalentMeasure",IFCDIMENSIONCOUNT:"IfcDimensionCount",IFCDESCRIPTIVEMEASURE:"IfcDescriptiveMeasure",IFCDAYLIGHTSAVINGHOUR:"IfcDaylightSavingHour",IFCDAYINMONTHNUMBER:"IfcDayInMonthNumber",IFCCURVATUREMEASURE:"IfcCurvatureMeasure",IFCCOUNTMEASURE:"IfcCountMeasure",IFCCONTEXTDEPENDENTMEASURE:"IfcContextDependentMeasure",IFCCOMPOUNDPLANEANGLEMEASURE:"IfcCompoundPlaneAngleMeasure",IFCCOMPLEXNUMBER:"IfcComplexNumber",IFCBOXALIGNMENT:"IfcBoxAlignment",IFCBOOLEAN:"IfcBoolean",IFCAREAMEASURE:"IfcAreaMeasure",IFCANGULARVELOCITYMEASURE:"IfcAngularVelocityMeasure",IFCAMOUNTOFSUBSTANCEMEASURE:"IfcAmountOfSubstanceMeasure",IFCACCELERATIONMEASURE:"IfcAccelerationMeasure",IFCABSORBEDDOSEMEASURE:"IfcAbsorbedDoseMeasure",IFCGEOSLICE:"IfcGeoSlice",IFCGEOMODEL:"IfcGeoModel",IFCELECTRICFLOWTREATMENTDEVICE:"IfcElectricFlowTreatmentDevice",IFCDISTRIBUTIONBOARD:"IfcDistributionBoard",IFCCONVEYORSEGMENT:"IfcConveyorSegment",IFCCAISSONFOUNDATION:"IfcCaissonFoundation",IFCBOREHOLE:"IfcBorehole",IFCBEARING:"IfcBearing",IFCALIGNMENT:"IfcAlignment",IFCTRACKELEMENT:"IfcTrackElement",IFCSIGNAL:"IfcSignal",IFCREINFORCEDSOIL:"IfcReinforcedSoil",IFCRAIL:"IfcRail",IFCPAVEMENT:"IfcPavement",IFCNAVIGATIONELEMENT:"IfcNavigationElement",IFCMOORINGDEVICE:"IfcMooringDevice",IFCMOBILETELECOMMUNICATIONSAPPLIANCE:"IfcMobileTelecommunicationsAppliance",IFCLIQUIDTERMINAL:"IfcLiquidTerminal",IFCLINEARPOSITIONINGELEMENT:"IfcLinearPositioningElement",IFCKERB:"IfcKerb",IFCGEOTECHNICALASSEMBLY:"IfcGeotechnicalAssembly",IFCELECTRICFLOWTREATMENTDEVICETYPE:"IfcElectricFlowTreatmentDeviceType",IFCEARTHWORKSFILL:"IfcEarthworksFill",IFCEARTHWORKSELEMENT:"IfcEarthworksElement",IFCEARTHWORKSCUT:"IfcEarthworksCut",IFCDISTRIBUTIONBOARDTYPE:"IfcDistributionBoardType",IFCDEEPFOUNDATION:"IfcDeepFoundation",IFCCOURSE:"IfcCourse",IFCCONVEYORSEGMENTTYPE:"IfcConveyorSegmentType",IFCCAISSONFOUNDATIONTYPE:"IfcCaissonFoundationType",IFCBUILTSYSTEM:"IfcBuiltSystem",IFCBUILTELEMENT:"IfcBuiltElement",IFCBRIDGEPART:"IfcBridgePart",IFCBRIDGE:"IfcBridge",IFCBEARINGTYPE:"IfcBearingType",IFCALIGNMENTVERTICAL:"IfcAlignmentVertical",IFCALIGNMENTSEGMENT:"IfcAlignmentSegment",IFCALIGNMENTHORIZONTAL:"IfcAlignmentHorizontal",IFCALIGNMENTCANT:"IfcAlignmentCant",IFCVIBRATIONDAMPERTYPE:"IfcVibrationDamperType",IFCVIBRATIONDAMPER:"IfcVibrationDamper",IFCVEHICLE:"IfcVehicle",IFCTRANSPORTATIONDEVICE:"IfcTransportationDevice",IFCTRACKELEMENTTYPE:"IfcTrackElementType",IFCTENDONCONDUITTYPE:"IfcTendonConduitType",IFCTENDONCONDUIT:"IfcTendonConduit",IFCSINESPIRAL:"IfcSineSpiral",IFCSIGNALTYPE:"IfcSignalType",IFCSIGNTYPE:"IfcSignType",IFCSIGN:"IfcSign",IFCSEVENTHORDERPOLYNOMIALSPIRAL:"IfcSeventhOrderPolynomialSpiral",IFCSEGMENTEDREFERENCECURVE:"IfcSegmentedReferenceCurve",IFCSECONDORDERPOLYNOMIALSPIRAL:"IfcSecondOrderPolynomialSpiral",IFCROADPART:"IfcRoadPart",IFCROAD:"IfcRoad",IFCRELADHERESTOELEMENT:"IfcRelAdheresToElement",IFCREFERENT:"IfcReferent",IFCRAILWAYPART:"IfcRailwayPart",IFCRAILWAY:"IfcRailway",IFCRAILTYPE:"IfcRailType",IFCPOSITIONINGELEMENT:"IfcPositioningElement",IFCPAVEMENTTYPE:"IfcPavementType",IFCNAVIGATIONELEMENTTYPE:"IfcNavigationElementType",IFCMOORINGDEVICETYPE:"IfcMooringDeviceType",IFCMOBILETELECOMMUNICATIONSAPPLIANCETYPE:"IfcMobileTelecommunicationsApplianceType",IFCMARINEPART:"IfcMarinePart",IFCMARINEFACILITY:"IfcMarineFacility",IFCLIQUIDTERMINALTYPE:"IfcLiquidTerminalType",IFCLINEARELEMENT:"IfcLinearElement",IFCKERBTYPE:"IfcKerbType",IFCIMPACTPROTECTIONDEVICETYPE:"IfcImpactProtectionDeviceType",IFCIMPACTPROTECTIONDEVICE:"IfcImpactProtectionDevice",IFCGRADIENTCURVE:"IfcGradientCurve",IFCGEOTECHNICALSTRATUM:"IfcGeotechnicalStratum",IFCGEOTECHNICALELEMENT:"IfcGeotechnicalElement",IFCFACILITYPARTCOMMON:"IfcFacilityPartCommon",IFCFACILITYPART:"IfcFacilityPart",IFCFACILITY:"IfcFacility",IFCDIRECTRIXDERIVEDREFERENCESWEPTAREASOLID:"IfcDirectrixDerivedReferenceSweptAreaSolid",IFCDEEPFOUNDATIONTYPE:"IfcDeepFoundationType",IFCCOURSETYPE:"IfcCourseType",IFCCOSINESPIRAL:"IfcCosineSpiral",IFCCLOTHOID:"IfcClothoid",IFCBUILTELEMENTTYPE:"IfcBuiltElementType",IFCVEHICLETYPE:"IfcVehicleType",IFCTRIANGULATEDIRREGULARNETWORK:"IfcTriangulatedIrregularNetwork",IFCTRANSPORTATIONDEVICETYPE:"IfcTransportationDeviceType",IFCTHIRDORDERPOLYNOMIALSPIRAL:"IfcThirdOrderPolynomialSpiral",IFCSPIRAL:"IfcSpiral",IFCSECTIONEDSURFACE:"IfcSectionedSurface",IFCSECTIONEDSOLIDHORIZONTAL:"IfcSectionedSolidHorizontal",IFCSECTIONEDSOLID:"IfcSectionedSolid",IFCRELPOSITIONS:"IfcRelPositions",IFCRELASSOCIATESPROFILEDEF:"IfcRelAssociatesProfileDef",IFCPOLYNOMIALCURVE:"IfcPolynomialCurve",IFCOFFSETCURVEBYDISTANCES:"IfcOffsetCurveByDistances",IFCOFFSETCURVE:"IfcOffsetCurve",IFCINDEXEDPOLYGONALTEXTUREMAP:"IfcIndexedPolygonalTextureMap",IFCDIRECTRIXCURVESWEPTAREASOLID:"IfcDirectrixCurveSweptAreaSolid",IFCCURVESEGMENT:"IfcCurveSegment",IFCAXIS2PLACEMENTLINEAR:"IfcAxis2PlacementLinear",IFCSEGMENT:"IfcSegment",IFCPOINTBYDISTANCEEXPRESSION:"IfcPointByDistanceExpression",IFCOPENCROSSPROFILEDEF:"IfcOpenCrossProfileDef",IFCLINEARPLACEMENT:"IfcLinearPlacement",IFCALIGNMENTHORIZONTALSEGMENT:"IfcAlignmentHorizontalSegment",IFCALIGNMENTCANTSEGMENT:"IfcAlignmentCantSegment",IFCTEXTURECOORDINATEINDICESWITHVOIDS:"IfcTextureCoordinateIndicesWithVoids",IFCTEXTURECOORDINATEINDICES:"IfcTextureCoordinateIndices",IFCQUANTITYNUMBER:"IfcQuantityNumber",IFCALIGNMENTVERTICALSEGMENT:"IfcAlignmentVerticalSegment",IFCALIGNMENTPARAMETERSEGMENT:"IfcAlignmentParameterSegment",IFCCONTROLLER:"IfcController",IFCALARM:"IfcAlarm",IFCACTUATOR:"IfcActuator",IFCUNITARYCONTROLELEMENT:"IfcUnitaryControlElement",IFCSENSOR:"IfcSensor",IFCPROTECTIVEDEVICETRIPPINGUNIT:"IfcProtectiveDeviceTrippingUnit",IFCFLOWINSTRUMENT:"IfcFlowInstrument",IFCFIRESUPPRESSIONTERMINAL:"IfcFireSuppressionTerminal",IFCFILTER:"IfcFilter",IFCFAN:"IfcFan",IFCELECTRICTIMECONTROL:"IfcElectricTimeControl",IFCELECTRICMOTOR:"IfcElectricMotor",IFCELECTRICGENERATOR:"IfcElectricGenerator",IFCELECTRICFLOWSTORAGEDEVICE:"IfcElectricFlowStorageDevice",IFCELECTRICDISTRIBUTIONBOARD:"IfcElectricDistributionBoard",IFCELECTRICAPPLIANCE:"IfcElectricAppliance",IFCDUCTSILENCER:"IfcDuctSilencer",IFCDUCTSEGMENT:"IfcDuctSegment",IFCDUCTFITTING:"IfcDuctFitting",IFCDISTRIBUTIONCIRCUIT:"IfcDistributionCircuit",IFCDAMPER:"IfcDamper",IFCCOOLINGTOWER:"IfcCoolingTower",IFCCOOLEDBEAM:"IfcCooledBeam",IFCCONDENSER:"IfcCondenser",IFCCOMPRESSOR:"IfcCompressor",IFCCOMMUNICATIONSAPPLIANCE:"IfcCommunicationsAppliance",IFCCOIL:"IfcCoil",IFCCHILLER:"IfcChiller",IFCCABLESEGMENT:"IfcCableSegment",IFCCABLEFITTING:"IfcCableFitting",IFCCABLECARRIERSEGMENT:"IfcCableCarrierSegment",IFCCABLECARRIERFITTING:"IfcCableCarrierFitting",IFCBURNER:"IfcBurner",IFCBOILER:"IfcBoiler",IFCBEAMSTANDARDCASE:"IfcBeamStandardCase",IFCAUDIOVISUALAPPLIANCE:"IfcAudioVisualAppliance",IFCAIRTOAIRHEATRECOVERY:"IfcAirToAirHeatRecovery",IFCAIRTERMINALBOX:"IfcAirTerminalBox",IFCAIRTERMINAL:"IfcAirTerminal",IFCWINDOWSTANDARDCASE:"IfcWindowStandardCase",IFCWASTETERMINAL:"IfcWasteTerminal",IFCWALLELEMENTEDCASE:"IfcWallElementedCase",IFCVALVE:"IfcValve",IFCUNITARYEQUIPMENT:"IfcUnitaryEquipment",IFCUNITARYCONTROLELEMENTTYPE:"IfcUnitaryControlElementType",IFCTUBEBUNDLE:"IfcTubeBundle",IFCTRANSFORMER:"IfcTransformer",IFCTANK:"IfcTank",IFCSWITCHINGDEVICE:"IfcSwitchingDevice",IFCSTRUCTURALLOADCASE:"IfcStructuralLoadCase",IFCSTACKTERMINAL:"IfcStackTerminal",IFCSPACEHEATER:"IfcSpaceHeater",IFCSOLARDEVICE:"IfcSolarDevice",IFCSLABSTANDARDCASE:"IfcSlabStandardCase",IFCSLABELEMENTEDCASE:"IfcSlabElementedCase",IFCSHADINGDEVICE:"IfcShadingDevice",IFCSANITARYTERMINAL:"IfcSanitaryTerminal",IFCREINFORCINGBARTYPE:"IfcReinforcingBarType",IFCRATIONALBSPLINECURVEWITHKNOTS:"IfcRationalBSplineCurveWithKnots",IFCPUMP:"IfcPump",IFCPROTECTIVEDEVICETRIPPINGUNITTYPE:"IfcProtectiveDeviceTrippingUnitType",IFCPROTECTIVEDEVICE:"IfcProtectiveDevice",IFCPLATESTANDARDCASE:"IfcPlateStandardCase",IFCPIPESEGMENT:"IfcPipeSegment",IFCPIPEFITTING:"IfcPipeFitting",IFCOUTLET:"IfcOutlet",IFCOUTERBOUNDARYCURVE:"IfcOuterBoundaryCurve",IFCMOTORCONNECTION:"IfcMotorConnection",IFCMEMBERSTANDARDCASE:"IfcMemberStandardCase",IFCMEDICALDEVICE:"IfcMedicalDevice",IFCLIGHTFIXTURE:"IfcLightFixture",IFCLAMP:"IfcLamp",IFCJUNCTIONBOX:"IfcJunctionBox",IFCINTERCEPTOR:"IfcInterceptor",IFCHUMIDIFIER:"IfcHumidifier",IFCHEATEXCHANGER:"IfcHeatExchanger",IFCFLOWMETER:"IfcFlowMeter",IFCEXTERNALSPATIALELEMENT:"IfcExternalSpatialElement",IFCEVAPORATOR:"IfcEvaporator",IFCEVAPORATIVECOOLER:"IfcEvaporativeCooler",IFCENGINE:"IfcEngine",IFCELECTRICDISTRIBUTIONBOARDTYPE:"IfcElectricDistributionBoardType",IFCDOORSTANDARDCASE:"IfcDoorStandardCase",IFCDISTRIBUTIONSYSTEM:"IfcDistributionSystem",IFCCOMMUNICATIONSAPPLIANCETYPE:"IfcCommunicationsApplianceType",IFCCOLUMNSTANDARDCASE:"IfcColumnStandardCase",IFCCIVILELEMENT:"IfcCivilElement",IFCCHIMNEY:"IfcChimney",IFCCABLEFITTINGTYPE:"IfcCableFittingType",IFCBURNERTYPE:"IfcBurnerType",IFCBUILDINGSYSTEM:"IfcBuildingSystem",IFCBUILDINGELEMENTPARTTYPE:"IfcBuildingElementPartType",IFCBOUNDARYCURVE:"IfcBoundaryCurve",IFCBSPLINECURVEWITHKNOTS:"IfcBSplineCurveWithKnots",IFCAUDIOVISUALAPPLIANCETYPE:"IfcAudioVisualApplianceType",IFCWORKCALENDAR:"IfcWorkCalendar",IFCWINDOWTYPE:"IfcWindowType",IFCVOIDINGFEATURE:"IfcVoidingFeature",IFCVIBRATIONISOLATOR:"IfcVibrationIsolator",IFCTENDONTYPE:"IfcTendonType",IFCTENDONANCHORTYPE:"IfcTendonAnchorType",IFCSYSTEMFURNITUREELEMENT:"IfcSystemFurnitureElement",IFCSURFACEFEATURE:"IfcSurfaceFeature",IFCSTRUCTURALSURFACEACTION:"IfcStructuralSurfaceAction",IFCSTRUCTURALCURVEREACTION:"IfcStructuralCurveReaction",IFCSTRUCTURALCURVEACTION:"IfcStructuralCurveAction",IFCSTAIRTYPE:"IfcStairType",IFCSOLARDEVICETYPE:"IfcSolarDeviceType",IFCSHADINGDEVICETYPE:"IfcShadingDeviceType",IFCSEAMCURVE:"IfcSeamCurve",IFCROOFTYPE:"IfcRoofType",IFCREINFORCINGMESHTYPE:"IfcReinforcingMeshType",IFCREINFORCINGELEMENTTYPE:"IfcReinforcingElementType",IFCRATIONALBSPLINESURFACEWITHKNOTS:"IfcRationalBSplineSurfaceWithKnots",IFCRAMPTYPE:"IfcRampType",IFCPOLYGONALFACESET:"IfcPolygonalFaceSet",IFCPILETYPE:"IfcPileType",IFCOPENINGSTANDARDCASE:"IfcOpeningStandardCase",IFCMEDICALDEVICETYPE:"IfcMedicalDeviceType",IFCINTERSECTIONCURVE:"IfcIntersectionCurve",IFCINTERCEPTORTYPE:"IfcInterceptorType",IFCINDEXEDPOLYCURVE:"IfcIndexedPolyCurve",IFCGEOGRAPHICELEMENT:"IfcGeographicElement",IFCFURNITURE:"IfcFurniture",IFCFOOTINGTYPE:"IfcFootingType",IFCEXTERNALSPATIALSTRUCTUREELEMENT:"IfcExternalSpatialStructureElement",IFCEVENT:"IfcEvent",IFCENGINETYPE:"IfcEngineType",IFCELEMENTASSEMBLYTYPE:"IfcElementAssemblyType",IFCDOORTYPE:"IfcDoorType",IFCCYLINDRICALSURFACE:"IfcCylindricalSurface",IFCCONSTRUCTIONPRODUCTRESOURCETYPE:"IfcConstructionProductResourceType",IFCCONSTRUCTIONMATERIALRESOURCETYPE:"IfcConstructionMaterialResourceType",IFCCONSTRUCTIONEQUIPMENTRESOURCETYPE:"IfcConstructionEquipmentResourceType",IFCCOMPOSITECURVEONSURFACE:"IfcCompositeCurveOnSurface",IFCCOMPLEXPROPERTYTEMPLATE:"IfcComplexPropertyTemplate",IFCCIVILELEMENTTYPE:"IfcCivilElementType",IFCCHIMNEYTYPE:"IfcChimneyType",IFCBSPLINESURFACEWITHKNOTS:"IfcBSplineSurfaceWithKnots",IFCBSPLINESURFACE:"IfcBSplineSurface",IFCADVANCEDBREPWITHVOIDS:"IfcAdvancedBrepWithVoids",IFCADVANCEDBREP:"IfcAdvancedBrep",IFCTRIANGULATEDFACESET:"IfcTriangulatedFaceSet",IFCTOROIDALSURFACE:"IfcToroidalSurface",IFCTESSELLATEDFACESET:"IfcTessellatedFaceSet",IFCTASKTYPE:"IfcTaskType",IFCSURFACECURVE:"IfcSurfaceCurve",IFCSUBCONTRACTRESOURCETYPE:"IfcSubContractResourceType",IFCSTRUCTURALSURFACEREACTION:"IfcStructuralSurfaceReaction",IFCSPHERICALSURFACE:"IfcSphericalSurface",IFCSPATIALZONETYPE:"IfcSpatialZoneType",IFCSPATIALZONE:"IfcSpatialZone",IFCSPATIALELEMENTTYPE:"IfcSpatialElementType",IFCSPATIALELEMENT:"IfcSpatialElement",IFCSIMPLEPROPERTYTEMPLATE:"IfcSimplePropertyTemplate",IFCREVOLVEDAREASOLIDTAPERED:"IfcRevolvedAreaSolidTapered",IFCREPARAMETRISEDCOMPOSITECURVESEGMENT:"IfcReparametrisedCompositeCurveSegment",IFCRELSPACEBOUNDARY2NDLEVEL:"IfcRelSpaceBoundary2ndLevel",IFCRELSPACEBOUNDARY1STLEVEL:"IfcRelSpaceBoundary1stLevel",IFCRELINTERFERESELEMENTS:"IfcRelInterferesElements",IFCRELDEFINESBYTEMPLATE:"IfcRelDefinesByTemplate",IFCRELDEFINESBYOBJECT:"IfcRelDefinesByObject",IFCRELDECLARES:"IfcRelDeclares",IFCRELASSIGNSTOGROUPBYFACTOR:"IfcRelAssignsToGroupByFactor",IFCPROPERTYTEMPLATE:"IfcPropertyTemplate",IFCPROPERTYSETTEMPLATE:"IfcPropertySetTemplate",IFCPROJECTLIBRARY:"IfcProjectLibrary",IFCPROCEDURETYPE:"IfcProcedureType",IFCPREDEFINEDPROPERTYSET:"IfcPredefinedPropertySet",IFCPCURVE:"IfcPCurve",IFCLABORRESOURCETYPE:"IfcLaborResourceType",IFCINDEXEDPOLYGONALFACEWITHVOIDS:"IfcIndexedPolygonalFaceWithVoids",IFCINDEXEDPOLYGONALFACE:"IfcIndexedPolygonalFace",IFCGEOGRAPHICELEMENTTYPE:"IfcGeographicElementType",IFCFIXEDREFERENCESWEPTAREASOLID:"IfcFixedReferenceSweptAreaSolid",IFCEXTRUDEDAREASOLIDTAPERED:"IfcExtrudedAreaSolidTapered",IFCEVENTTYPE:"IfcEventType",IFCCURVEBOUNDEDSURFACE:"IfcCurveBoundedSurface",IFCCREWRESOURCETYPE:"IfcCrewResourceType",IFCCONTEXT:"IfcContext",IFCCONSTRUCTIONRESOURCETYPE:"IfcConstructionResourceType",IFCCARTESIANPOINTLIST3D:"IfcCartesianPointList3D",IFCCARTESIANPOINTLIST2D:"IfcCartesianPointList2D",IFCCARTESIANPOINTLIST:"IfcCartesianPointList",IFCADVANCEDFACE:"IfcAdvancedFace",IFCTYPERESOURCE:"IfcTypeResource",IFCTYPEPROCESS:"IfcTypeProcess",IFCTESSELLATEDITEM:"IfcTessellatedItem",IFCSWEPTDISKSOLIDPOLYGONAL:"IfcSweptDiskSolidPolygonal",IFCRESOURCETIME:"IfcResourceTime",IFCRESOURCECONSTRAINTRELATIONSHIP:"IfcResourceConstraintRelationship",IFCRESOURCEAPPROVALRELATIONSHIP:"IfcResourceApprovalRelationship",IFCQUANTITYSET:"IfcQuantitySet",IFCPROPERTYTEMPLATEDEFINITION:"IfcPropertyTemplateDefinition",IFCPREDEFINEDPROPERTIES:"IfcPredefinedProperties",IFCMIRROREDPROFILEDEF:"IfcMirroredProfileDef",IFCMATERIALRELATIONSHIP:"IfcMaterialRelationship",IFCMATERIALPROFILESETUSAGETAPERING:"IfcMaterialProfileSetUsageTapering",IFCMATERIALPROFILESETUSAGE:"IfcMaterialProfileSetUsage",IFCMATERIALCONSTITUENTSET:"IfcMaterialConstituentSet",IFCMATERIALCONSTITUENT:"IfcMaterialConstituent",IFCLAGTIME:"IfcLagTime",IFCINDEXEDTRIANGLETEXTUREMAP:"IfcIndexedTriangleTextureMap",IFCINDEXEDTEXTUREMAP:"IfcIndexedTextureMap",IFCINDEXEDCOLOURMAP:"IfcIndexedColourMap",IFCEXTERNALREFERENCERELATIONSHIP:"IfcExternalReferenceRelationship",IFCEXTENDEDPROPERTIES:"IfcExtendedProperties",IFCEVENTTIME:"IfcEventTime",IFCCONVERSIONBASEDUNITWITHOFFSET:"IfcConversionBasedUnitWithOffset",IFCCOLOURRGBLIST:"IfcColourRgbList",IFCWORKTIME:"IfcWorkTime",IFCTIMEPERIOD:"IfcTimePeriod",IFCTEXTUREVERTEXLIST:"IfcTextureVertexList",IFCTASKTIMERECURRING:"IfcTaskTimeRecurring",IFCTASKTIME:"IfcTaskTime",IFCTABLECOLUMN:"IfcTableColumn",IFCSURFACEREINFORCEMENTAREA:"IfcSurfaceReinforcementArea",IFCSTRUCTURALLOADORRESULT:"IfcStructuralLoadOrResult",IFCSTRUCTURALLOADCONFIGURATION:"IfcStructuralLoadConfiguration",IFCSCHEDULINGTIME:"IfcSchedulingTime",IFCRESOURCELEVELRELATIONSHIP:"IfcResourceLevelRelationship",IFCREFERENCE:"IfcReference",IFCRECURRENCEPATTERN:"IfcRecurrencePattern",IFCPROPERTYABSTRACTION:"IfcPropertyAbstraction",IFCPROJECTEDCRS:"IfcProjectedCrs",IFCPRESENTATIONITEM:"IfcPresentationItem",IFCMATERIALUSAGEDEFINITION:"IfcMaterialUsageDefinition",IFCMATERIALPROFILEWITHOFFSETS:"IfcMaterialProfileWithOffsets",IFCMATERIALPROFILESET:"IfcMaterialProfileSet",IFCMATERIALPROFILE:"IfcMaterialProfile",IFCMATERIALLAYERWITHOFFSETS:"IfcMaterialLayerWithOffsets",IFCMATERIALDEFINITION:"IfcMaterialDefinition",IFCMAPCONVERSION:"IfcMapConversion",IFCEXTERNALINFORMATION:"IfcExternalInformation",IFCCOORDINATEREFERENCESYSTEM:"IfcCoordinateReferenceSystem",IFCCOORDINATEOPERATION:"IfcCoordinateOperation",IFCCONNECTIONVOLUMEGEOMETRY:"IfcConnectionVolumeGeometry",IFCREINFORCINGBAR:"IfcReinforcingBar",IFCELECTRICDISTRIBUTIONPOINT:"IfcElectricDistributionPoint",IFCDISTRIBUTIONCONTROLELEMENT:"IfcDistributionControlElement",IFCDISTRIBUTIONCHAMBERELEMENT:"IfcDistributionChamberElement",IFCCONTROLLERTYPE:"IfcControllerType",IFCCHAMFEREDGEFEATURE:"IfcChamferEdgeFeature",IFCBEAM:"IfcBeam",IFCALARMTYPE:"IfcAlarmType",IFCACTUATORTYPE:"IfcActuatorType",IFCWINDOW:"IfcWindow",IFCWALLSTANDARDCASE:"IfcWallStandardCase",IFCWALL:"IfcWall",IFCVIBRATIONISOLATORTYPE:"IfcVibrationIsolatorType",IFCTENDONANCHOR:"IfcTendonAnchor",IFCTENDON:"IfcTendon",IFCSTRUCTURALANALYSISMODEL:"IfcStructuralAnalysisModel",IFCSTAIRFLIGHT:"IfcStairFlight",IFCSTAIR:"IfcStair",IFCSLAB:"IfcSlab",IFCSENSORTYPE:"IfcSensorType",IFCROUNDEDEDGEFEATURE:"IfcRoundedEdgeFeature",IFCROOF:"IfcRoof",IFCREINFORCINGMESH:"IfcReinforcingMesh",IFCREINFORCINGELEMENT:"IfcReinforcingElement",IFCRATIONALBEZIERCURVE:"IfcRationalBezierCurve",IFCRAMPFLIGHT:"IfcRampFlight",IFCRAMP:"IfcRamp",IFCRAILING:"IfcRailing",IFCPLATE:"IfcPlate",IFCPILE:"IfcPile",IFCMEMBER:"IfcMember",IFCFOOTING:"IfcFooting",IFCFLOWTREATMENTDEVICE:"IfcFlowTreatmentDevice",IFCFLOWTERMINAL:"IfcFlowTerminal",IFCFLOWSTORAGEDEVICE:"IfcFlowStorageDevice",IFCFLOWSEGMENT:"IfcFlowSegment",IFCFLOWMOVINGDEVICE:"IfcFlowMovingDevice",IFCFLOWINSTRUMENTTYPE:"IfcFlowInstrumentType",IFCFLOWFITTING:"IfcFlowFitting",IFCFLOWCONTROLLER:"IfcFlowController",IFCFIRESUPPRESSIONTERMINALTYPE:"IfcFireSuppressionTerminalType",IFCFILTERTYPE:"IfcFilterType",IFCFANTYPE:"IfcFanType",IFCENERGYCONVERSIONDEVICE:"IfcEnergyConversionDevice",IFCELECTRICALELEMENT:"IfcElectricalElement",IFCELECTRICALCIRCUIT:"IfcElectricalCircuit",IFCELECTRICTIMECONTROLTYPE:"IfcElectricTimeControlType",IFCELECTRICMOTORTYPE:"IfcElectricMotorType",IFCELECTRICHEATERTYPE:"IfcElectricHeaterType",IFCELECTRICGENERATORTYPE:"IfcElectricGeneratorType",IFCELECTRICFLOWSTORAGEDEVICETYPE:"IfcElectricFlowStorageDeviceType",IFCELECTRICAPPLIANCETYPE:"IfcElectricApplianceType",IFCEDGEFEATURE:"IfcEdgeFeature",IFCDUCTSILENCERTYPE:"IfcDuctSilencerType",IFCDUCTSEGMENTTYPE:"IfcDuctSegmentType",IFCDUCTFITTINGTYPE:"IfcDuctFittingType",IFCDOOR:"IfcDoor",IFCDISTRIBUTIONPORT:"IfcDistributionPort",IFCDISTRIBUTIONFLOWELEMENT:"IfcDistributionFlowElement",IFCDISTRIBUTIONELEMENT:"IfcDistributionElement",IFCDISTRIBUTIONCONTROLELEMENTTYPE:"IfcDistributionControlElementType",IFCDISTRIBUTIONCHAMBERELEMENTTYPE:"IfcDistributionChamberElementType",IFCDISCRETEACCESSORYTYPE:"IfcDiscreteAccessoryType",IFCDISCRETEACCESSORY:"IfcDiscreteAccessory",IFCDIAMETERDIMENSION:"IfcDiameterDimension",IFCDAMPERTYPE:"IfcDamperType",IFCCURTAINWALL:"IfcCurtainWall",IFCCOVERING:"IfcCovering",IFCCOOLINGTOWERTYPE:"IfcCoolingTowerType",IFCCOOLEDBEAMTYPE:"IfcCooledBeamType",IFCCONSTRUCTIONPRODUCTRESOURCE:"IfcConstructionProductResource",IFCCONSTRUCTIONMATERIALRESOURCE:"IfcConstructionMaterialResource",IFCCONSTRUCTIONEQUIPMENTRESOURCE:"IfcConstructionEquipmentResource",IFCCONDITIONCRITERION:"IfcConditionCriterion",IFCCONDITION:"IfcCondition",IFCCONDENSERTYPE:"IfcCondenserType",IFCCOMPRESSORTYPE:"IfcCompressorType",IFCCOLUMN:"IfcColumn",IFCCOILTYPE:"IfcCoilType",IFCCIRCLE:"IfcCircle",IFCCHILLERTYPE:"IfcChillerType",IFCCABLESEGMENTTYPE:"IfcCableSegmentType",IFCCABLECARRIERSEGMENTTYPE:"IfcCableCarrierSegmentType",IFCCABLECARRIERFITTINGTYPE:"IfcCableCarrierFittingType",IFCBUILDINGELEMENTPROXYTYPE:"IfcBuildingElementProxyType",IFCBUILDINGELEMENTPROXY:"IfcBuildingElementProxy",IFCBUILDINGELEMENTPART:"IfcBuildingElementPart",IFCBUILDINGELEMENTCOMPONENT:"IfcBuildingElementComponent",IFCBUILDINGELEMENT:"IfcBuildingElement",IFCBOILERTYPE:"IfcBoilerType",IFCBEZIERCURVE:"IfcBezierCurve",IFCBEAMTYPE:"IfcBeamType",IFCBSPLINECURVE:"IfcBSplineCurve",IFCASSET:"IfcAsset",IFCANGULARDIMENSION:"IfcAngularDimension",IFCAIRTOAIRHEATRECOVERYTYPE:"IfcAirToAirHeatRecoveryType",IFCAIRTERMINALTYPE:"IfcAirTerminalType",IFCAIRTERMINALBOXTYPE:"IfcAirTerminalBoxType",IFCACTIONREQUEST:"IfcActionRequest",IFC2DCOMPOSITECURVE:"Ifc2DCompositeCurve",IFCZONE:"IfcZone",IFCWORKSCHEDULE:"IfcWorkSchedule",IFCWORKPLAN:"IfcWorkPlan",IFCWORKCONTROL:"IfcWorkControl",IFCWASTETERMINALTYPE:"IfcWasteTerminalType",IFCWALLTYPE:"IfcWallType",IFCVIRTUALELEMENT:"IfcVirtualElement",IFCVALVETYPE:"IfcValveType",IFCUNITARYEQUIPMENTTYPE:"IfcUnitaryEquipmentType",IFCTUBEBUNDLETYPE:"IfcTubeBundleType",IFCTRIMMEDCURVE:"IfcTrimmedCurve",IFCTRANSPORTELEMENT:"IfcTransportElement",IFCTRANSFORMERTYPE:"IfcTransformerType",IFCTIMESERIESSCHEDULE:"IfcTimeSeriesSchedule",IFCTANKTYPE:"IfcTankType",IFCSYSTEM:"IfcSystem",IFCSWITCHINGDEVICETYPE:"IfcSwitchingDeviceType",IFCSUBCONTRACTRESOURCE:"IfcSubContractResource",IFCSTRUCTURALSURFACECONNECTION:"IfcStructuralSurfaceConnection",IFCSTRUCTURALRESULTGROUP:"IfcStructuralResultGroup",IFCSTRUCTURALPOINTREACTION:"IfcStructuralPointReaction",IFCSTRUCTURALPOINTCONNECTION:"IfcStructuralPointConnection",IFCSTRUCTURALPOINTACTION:"IfcStructuralPointAction",IFCSTRUCTURALPLANARACTIONVARYING:"IfcStructuralPlanarActionVarying",IFCSTRUCTURALPLANARACTION:"IfcStructuralPlanarAction",IFCSTRUCTURALLOADGROUP:"IfcStructuralLoadGroup",IFCSTRUCTURALLINEARACTIONVARYING:"IfcStructuralLinearActionVarying",IFCSTRUCTURALLINEARACTION:"IfcStructuralLinearAction",IFCSTRUCTURALCURVEMEMBERVARYING:"IfcStructuralCurveMemberVarying",IFCSTRUCTURALCURVEMEMBER:"IfcStructuralCurveMember",IFCSTRUCTURALCURVECONNECTION:"IfcStructuralCurveConnection",IFCSTRUCTURALCONNECTION:"IfcStructuralConnection",IFCSTRUCTURALACTION:"IfcStructuralAction",IFCSTAIRFLIGHTTYPE:"IfcStairFlightType",IFCSTACKTERMINALTYPE:"IfcStackTerminalType",IFCSPACETYPE:"IfcSpaceType",IFCSPACEPROGRAM:"IfcSpaceProgram",IFCSPACEHEATERTYPE:"IfcSpaceHeaterType",IFCSPACE:"IfcSpace",IFCSLABTYPE:"IfcSlabType",IFCSITE:"IfcSite",IFCSERVICELIFE:"IfcServiceLife",IFCSCHEDULETIMECONTROL:"IfcScheduleTimeControl",IFCSANITARYTERMINALTYPE:"IfcSanitaryTerminalType",IFCRELASSIGNSTASKS:"IfcRelAssignsTasks",IFCRELAGGREGATES:"IfcRelAggregates",IFCRAMPFLIGHTTYPE:"IfcRampFlightType",IFCRAILINGTYPE:"IfcRailingType",IFCRADIUSDIMENSION:"IfcRadiusDimension",IFCPUMPTYPE:"IfcPumpType",IFCPROTECTIVEDEVICETYPE:"IfcProtectiveDeviceType",IFCPROJECTIONELEMENT:"IfcProjectionElement",IFCPROJECTORDERRECORD:"IfcProjectOrderRecord",IFCPROJECTORDER:"IfcProjectOrder",IFCPROCEDURE:"IfcProcedure",IFCPORT:"IfcPort",IFCPOLYLINE:"IfcPolyline",IFCPLATETYPE:"IfcPlateType",IFCPIPESEGMENTTYPE:"IfcPipeSegmentType",IFCPIPEFITTINGTYPE:"IfcPipeFittingType",IFCPERMIT:"IfcPermit",IFCPERFORMANCEHISTORY:"IfcPerformanceHistory",IFCOUTLETTYPE:"IfcOutletType",IFCORDERACTION:"IfcOrderAction",IFCOPENINGELEMENT:"IfcOpeningElement",IFCOCCUPANT:"IfcOccupant",IFCMOVE:"IfcMove",IFCMOTORCONNECTIONTYPE:"IfcMotorConnectionType",IFCMEMBERTYPE:"IfcMemberType",IFCMECHANICALFASTENERTYPE:"IfcMechanicalFastenerType",IFCMECHANICALFASTENER:"IfcMechanicalFastener",IFCLINEARDIMENSION:"IfcLinearDimension",IFCLIGHTFIXTURETYPE:"IfcLightFixtureType",IFCLAMPTYPE:"IfcLampType",IFCLABORRESOURCE:"IfcLaborResource",IFCJUNCTIONBOXTYPE:"IfcJunctionBoxType",IFCINVENTORY:"IfcInventory",IFCHUMIDIFIERTYPE:"IfcHumidifierType",IFCHEATEXCHANGERTYPE:"IfcHeatExchangerType",IFCGROUP:"IfcGroup",IFCGRID:"IfcGrid",IFCGASTERMINALTYPE:"IfcGasTerminalType",IFCFURNITURESTANDARD:"IfcFurnitureStandard",IFCFURNISHINGELEMENT:"IfcFurnishingElement",IFCFLOWTREATMENTDEVICETYPE:"IfcFlowTreatmentDeviceType",IFCFLOWTERMINALTYPE:"IfcFlowTerminalType",IFCFLOWSTORAGEDEVICETYPE:"IfcFlowStorageDeviceType",IFCFLOWSEGMENTTYPE:"IfcFlowSegmentType",IFCFLOWMOVINGDEVICETYPE:"IfcFlowMovingDeviceType",IFCFLOWMETERTYPE:"IfcFlowMeterType",IFCFLOWFITTINGTYPE:"IfcFlowFittingType",IFCFLOWCONTROLLERTYPE:"IfcFlowControllerType",IFCFEATUREELEMENTSUBTRACTION:"IfcFeatureElementSubtraction",IFCFEATUREELEMENTADDITION:"IfcFeatureElementAddition",IFCFEATUREELEMENT:"IfcFeatureElement",IFCFASTENERTYPE:"IfcFastenerType",IFCFASTENER:"IfcFastener",IFCFACETEDBREPWITHVOIDS:"IfcFacetedBrepWithVoids",IFCFACETEDBREP:"IfcFacetedBrep",IFCEVAPORATORTYPE:"IfcEvaporatorType",IFCEVAPORATIVECOOLERTYPE:"IfcEvaporativeCoolerType",IFCEQUIPMENTSTANDARD:"IfcEquipmentStandard",IFCEQUIPMENTELEMENT:"IfcEquipmentElement",IFCENERGYCONVERSIONDEVICETYPE:"IfcEnergyConversionDeviceType",IFCELLIPSE:"IfcEllipse",IFCELEMENTCOMPONENTTYPE:"IfcElementComponentType",IFCELEMENTCOMPONENT:"IfcElementComponent",IFCELEMENTASSEMBLY:"IfcElementAssembly",IFCELEMENT:"IfcElement",IFCELECTRICALBASEPROPERTIES:"IfcElectricalBaseProperties",IFCDISTRIBUTIONFLOWELEMENTTYPE:"IfcDistributionFlowElementType",IFCDISTRIBUTIONELEMENTTYPE:"IfcDistributionElementType",IFCDIMENSIONCURVEDIRECTEDCALLOUT:"IfcDimensionCurveDirectedCallout",IFCCURTAINWALLTYPE:"IfcCurtainWallType",IFCCREWRESOURCE:"IfcCrewResource",IFCCOVERINGTYPE:"IfcCoveringType",IFCCOSTSCHEDULE:"IfcCostSchedule",IFCCOSTITEM:"IfcCostItem",IFCCONTROL:"IfcControl",IFCCONSTRUCTIONRESOURCE:"IfcConstructionResource",IFCCONIC:"IfcConic",IFCCOMPOSITECURVE:"IfcCompositeCurve",IFCCOLUMNTYPE:"IfcColumnType",IFCCIRCLEHOLLOWPROFILEDEF:"IfcCircleHollowProfileDef",IFCBUILDINGSTOREY:"IfcBuildingStorey",IFCBUILDINGELEMENTTYPE:"IfcBuildingElementType",IFCBUILDING:"IfcBuilding",IFCBOUNDEDCURVE:"IfcBoundedCurve",IFCBOOLEANCLIPPINGRESULT:"IfcBooleanClippingResult",IFCBLOCK:"IfcBlock",IFCASYMMETRICISHAPEPROFILEDEF:"IfcAsymmetricIShapeProfileDef",IFCANNOTATION:"IfcAnnotation",IFCACTOR:"IfcActor",IFCTRANSPORTELEMENTTYPE:"IfcTransportElementType",IFCTASK:"IfcTask",IFCSYSTEMFURNITUREELEMENTTYPE:"IfcSystemFurnitureElementType",IFCSURFACEOFREVOLUTION:"IfcSurfaceOfRevolution",IFCSURFACEOFLINEAREXTRUSION:"IfcSurfaceOfLinearExtrusion",IFCSURFACECURVESWEPTAREASOLID:"IfcSurfaceCurveSweptAreaSolid",IFCSTRUCTUREDDIMENSIONCALLOUT:"IfcStructuredDimensionCallout",IFCSTRUCTURALSURFACEMEMBERVARYING:"IfcStructuralSurfaceMemberVarying",IFCSTRUCTURALSURFACEMEMBER:"IfcStructuralSurfaceMember",IFCSTRUCTURALREACTION:"IfcStructuralReaction",IFCSTRUCTURALMEMBER:"IfcStructuralMember",IFCSTRUCTURALITEM:"IfcStructuralItem",IFCSTRUCTURALACTIVITY:"IfcStructuralActivity",IFCSPHERE:"IfcSphere",IFCSPATIALSTRUCTUREELEMENTTYPE:"IfcSpatialStructureElementType",IFCSPATIALSTRUCTUREELEMENT:"IfcSpatialStructureElement",IFCRIGHTCIRCULARCYLINDER:"IfcRightCircularCylinder",IFCRIGHTCIRCULARCONE:"IfcRightCircularCone",IFCREVOLVEDAREASOLID:"IfcRevolvedAreaSolid",IFCRESOURCE:"IfcResource",IFCRELVOIDSELEMENT:"IfcRelVoidsElement",IFCRELSPACEBOUNDARY:"IfcRelSpaceBoundary",IFCRELSERVICESBUILDINGS:"IfcRelServicesBuildings",IFCRELSEQUENCE:"IfcRelSequence",IFCRELSCHEDULESCOSTITEMS:"IfcRelSchedulesCostItems",IFCRELREFERENCEDINSPATIALSTRUCTURE:"IfcRelReferencedInSpatialStructure",IFCRELPROJECTSELEMENT:"IfcRelProjectsElement",IFCRELOVERRIDESPROPERTIES:"IfcRelOverridesProperties",IFCRELOCCUPIESSPACES:"IfcRelOccupiesSpaces",IFCRELNESTS:"IfcRelNests",IFCRELINTERACTIONREQUIREMENTS:"IfcRelInteractionRequirements",IFCRELFLOWCONTROLELEMENTS:"IfcRelFlowControlElements",IFCRELFILLSELEMENT:"IfcRelFillsElement",IFCRELDEFINESBYTYPE:"IfcRelDefinesByType",IFCRELDEFINESBYPROPERTIES:"IfcRelDefinesByProperties",IFCRELDEFINES:"IfcRelDefines",IFCRELDECOMPOSES:"IfcRelDecomposes",IFCRELCOVERSSPACES:"IfcRelCoversSpaces",IFCRELCOVERSBLDGELEMENTS:"IfcRelCoversBldgElements",IFCRELCONTAINEDINSPATIALSTRUCTURE:"IfcRelContainedInSpatialStructure",IFCRELCONNECTSWITHREALIZINGELEMENTS:"IfcRelConnectsWithRealizingElements",IFCRELCONNECTSWITHECCENTRICITY:"IfcRelConnectsWithEccentricity",IFCRELCONNECTSSTRUCTURALMEMBER:"IfcRelConnectsStructuralMember",IFCRELCONNECTSSTRUCTURALELEMENT:"IfcRelConnectsStructuralElement",IFCRELCONNECTSSTRUCTURALACTIVITY:"IfcRelConnectsStructuralActivity",IFCRELCONNECTSPORTS:"IfcRelConnectsPorts",IFCRELCONNECTSPORTTOELEMENT:"IfcRelConnectsPortToElement",IFCRELCONNECTSPATHELEMENTS:"IfcRelConnectsPathElements",IFCRELCONNECTSELEMENTS:"IfcRelConnectsElements",IFCRELCONNECTS:"IfcRelConnects",IFCRELASSOCIATESPROFILEPROPERTIES:"IfcRelAssociatesProfileProperties",IFCRELASSOCIATESMATERIAL:"IfcRelAssociatesMaterial",IFCRELASSOCIATESLIBRARY:"IfcRelAssociatesLibrary",IFCRELASSOCIATESDOCUMENT:"IfcRelAssociatesDocument",IFCRELASSOCIATESCONSTRAINT:"IfcRelAssociatesConstraint",IFCRELASSOCIATESCLASSIFICATION:"IfcRelAssociatesClassification",IFCRELASSOCIATESAPPROVAL:"IfcRelAssociatesApproval",IFCRELASSOCIATESAPPLIEDVALUE:"IfcRelAssociatesAppliedValue",IFCRELASSOCIATES:"IfcRelAssociates",IFCRELASSIGNSTORESOURCE:"IfcRelAssignsToResource",IFCRELASSIGNSTOPROJECTORDER:"IfcRelAssignsToProjectOrder",IFCRELASSIGNSTOPRODUCT:"IfcRelAssignsToProduct",IFCRELASSIGNSTOPROCESS:"IfcRelAssignsToProcess",IFCRELASSIGNSTOGROUP:"IfcRelAssignsToGroup",IFCRELASSIGNSTOCONTROL:"IfcRelAssignsToControl",IFCRELASSIGNSTOACTOR:"IfcRelAssignsToActor",IFCRELASSIGNS:"IfcRelAssigns",IFCRECTANGULARTRIMMEDSURFACE:"IfcRectangularTrimmedSurface",IFCRECTANGULARPYRAMID:"IfcRectangularPyramid",IFCRECTANGLEHOLLOWPROFILEDEF:"IfcRectangleHollowProfileDef",IFCPROXY:"IfcProxy",IFCPROPERTYSET:"IfcPropertySet",IFCPROJECTIONCURVE:"IfcProjectionCurve",IFCPROJECT:"IfcProject",IFCPRODUCT:"IfcProduct",IFCPROCESS:"IfcProcess",IFCPLANE:"IfcPlane",IFCPLANARBOX:"IfcPlanarBox",IFCPERMEABLECOVERINGPROPERTIES:"IfcPermeableCoveringProperties",IFCOFFSETCURVE3D:"IfcOffsetCurve3D",IFCOFFSETCURVE2D:"IfcOffsetCurve2D",IFCOBJECT:"IfcObject",IFCMANIFOLDSOLIDBREP:"IfcManifoldSolidBrep",IFCLINE:"IfcLine",IFCLSHAPEPROFILEDEF:"IfcLShapeProfileDef",IFCISHAPEPROFILEDEF:"IfcIShapeProfileDef",IFCGEOMETRICCURVESET:"IfcGeometricCurveSet",IFCFURNITURETYPE:"IfcFurnitureType",IFCFURNISHINGELEMENTTYPE:"IfcFurnishingElementType",IFCFLUIDFLOWPROPERTIES:"IfcFluidFlowProperties",IFCFILLAREASTYLETILES:"IfcFillAreaStyleTiles",IFCFILLAREASTYLETILESYMBOLWITHSTYLE:"IfcFillAreaStyleTileSymbolWithStyle",IFCFILLAREASTYLEHATCHING:"IfcFillAreaStyleHatching",IFCFACEBASEDSURFACEMODEL:"IfcFaceBasedSurfaceModel",IFCEXTRUDEDAREASOLID:"IfcExtrudedAreaSolid",IFCENERGYPROPERTIES:"IfcEnergyProperties",IFCELLIPSEPROFILEDEF:"IfcEllipseProfileDef",IFCELEMENTARYSURFACE:"IfcElementarySurface",IFCELEMENTTYPE:"IfcElementType",IFCELEMENTQUANTITY:"IfcElementQuantity",IFCEDGELOOP:"IfcEdgeLoop",IFCDRAUGHTINGPREDEFINEDCURVEFONT:"IfcDraughtingPredefinedCurveFont",IFCDRAUGHTINGPREDEFINEDCOLOUR:"IfcDraughtingPredefinedColour",IFCDRAUGHTINGCALLOUT:"IfcDraughtingCallout",IFCDOORSTYLE:"IfcDoorStyle",IFCDOORPANELPROPERTIES:"IfcDoorPanelProperties",IFCDOORLININGPROPERTIES:"IfcDoorLiningProperties",IFCDIRECTION:"IfcDirection",IFCDIMENSIONCURVETERMINATOR:"IfcDimensionCurveTerminator",IFCDIMENSIONCURVE:"IfcDimensionCurve",IFCDEFINEDSYMBOL:"IfcDefinedSymbol",IFCCURVEBOUNDEDPLANE:"IfcCurveBoundedPlane",IFCCURVE:"IfcCurve",IFCCSGSOLID:"IfcCsgSolid",IFCCSGPRIMITIVE3D:"IfcCsgPrimitive3D",IFCCRANERAILFSHAPEPROFILEDEF:"IfcCraneRailFShapeProfileDef",IFCCRANERAILASHAPEPROFILEDEF:"IfcCraneRailAShapeProfileDef",IFCCOMPOSITECURVESEGMENT:"IfcCompositeCurveSegment",IFCCLOSEDSHELL:"IfcClosedShell",IFCCIRCLEPROFILEDEF:"IfcCircleProfileDef",IFCCARTESIANTRANSFORMATIONOPERATOR3DNONUNIFORM:"IfcCartesianTransformationOperator3DNonUniform",IFCCARTESIANTRANSFORMATIONOPERATOR3D:"IfcCartesianTransformationOperator3D",IFCCARTESIANTRANSFORMATIONOPERATOR2DNONUNIFORM:"IfcCartesianTransformationOperator2DNonUniform",IFCCARTESIANTRANSFORMATIONOPERATOR2D:"IfcCartesianTransformationOperator2D",IFCCARTESIANTRANSFORMATIONOPERATOR:"IfcCartesianTransformationOperator",IFCCARTESIANPOINT:"IfcCartesianPoint",IFCCSHAPEPROFILEDEF:"IfcCShapeProfileDef",IFCBOXEDHALFSPACE:"IfcBoxedHalfSpace",IFCBOUNDINGBOX:"IfcBoundingBox",IFCBOUNDEDSURFACE:"IfcBoundedSurface",IFCBOOLEANRESULT:"IfcBooleanResult",IFCAXIS2PLACEMENT3D:"IfcAxis2Placement3D",IFCAXIS2PLACEMENT2D:"IfcAxis2Placement2D",IFCAXIS1PLACEMENT:"IfcAxis1Placement",IFCANNOTATIONSURFACE:"IfcAnnotationSurface",IFCANNOTATIONFILLAREAOCCURRENCE:"IfcAnnotationFillAreaOccurrence",IFCANNOTATIONFILLAREA:"IfcAnnotationFillArea",IFCANNOTATIONCURVEOCCURRENCE:"IfcAnnotationCurveOccurrence",IFCZSHAPEPROFILEDEF:"IfcZShapeProfileDef",IFCWINDOWSTYLE:"IfcWindowStyle",IFCWINDOWPANELPROPERTIES:"IfcWindowPanelProperties",IFCWINDOWLININGPROPERTIES:"IfcWindowLiningProperties",IFCVERTEXLOOP:"IfcVertexLoop",IFCVECTOR:"IfcVector",IFCUSHAPEPROFILEDEF:"IfcUShapeProfileDef",IFCTYPEPRODUCT:"IfcTypeProduct",IFCTYPEOBJECT:"IfcTypeObject",IFCTWODIRECTIONREPEATFACTOR:"IfcTwoDirectionRepeatFactor",IFCTRAPEZIUMPROFILEDEF:"IfcTrapeziumProfileDef",IFCTEXTLITERALWITHEXTENT:"IfcTextLiteralWithExtent",IFCTEXTLITERAL:"IfcTextLiteral",IFCTERMINATORSYMBOL:"IfcTerminatorSymbol",IFCTSHAPEPROFILEDEF:"IfcTShapeProfileDef",IFCSWEPTSURFACE:"IfcSweptSurface",IFCSWEPTDISKSOLID:"IfcSweptDiskSolid",IFCSWEPTAREASOLID:"IfcSweptAreaSolid",IFCSURFACESTYLERENDERING:"IfcSurfaceStyleRendering",IFCSURFACE:"IfcSurface",IFCSUBEDGE:"IfcSubedge",IFCSTRUCTURALSTEELPROFILEPROPERTIES:"IfcStructuralSteelProfileProperties",IFCSTRUCTURALPROFILEPROPERTIES:"IfcStructuralProfileProperties",IFCSTRUCTURALLOADSINGLEFORCEWARPING:"IfcStructuralLoadSingleForceWarping",IFCSTRUCTURALLOADSINGLEFORCE:"IfcStructuralLoadSingleForce",IFCSTRUCTURALLOADSINGLEDISPLACEMENTDISTORTION:"IfcStructuralLoadSingleDisplacementDistortion",IFCSTRUCTURALLOADSINGLEDISPLACEMENT:"IfcStructuralLoadSingleDisplacement",IFCSTRUCTURALLOADPLANARFORCE:"IfcStructuralLoadPlanarForce",IFCSTRUCTURALLOADLINEARFORCE:"IfcStructuralLoadLinearForce",IFCSPACETHERMALLOADPROPERTIES:"IfcSpaceThermalLoadProperties",IFCSOUNDVALUE:"IfcSoundValue",IFCSOUNDPROPERTIES:"IfcSoundProperties",IFCSOLIDMODEL:"IfcSolidModel",IFCSLIPPAGECONNECTIONCONDITION:"IfcSlippageConnectionCondition",IFCSHELLBASEDSURFACEMODEL:"IfcShellBasedSurfaceModel",IFCSERVICELIFEFACTOR:"IfcServiceLifeFactor",IFCSECTIONEDSPINE:"IfcSectionedSpine",IFCROUNDEDRECTANGLEPROFILEDEF:"IfcRoundedRectangleProfileDef",IFCRELATIONSHIP:"IfcRelationship",IFCREINFORCEMENTDEFINITIONPROPERTIES:"IfcReinforcementDefinitionProperties",IFCREGULARTIMESERIES:"IfcRegularTimeSeries",IFCRECTANGLEPROFILEDEF:"IfcRectangleProfileDef",IFCPROPERTYTABLEVALUE:"IfcPropertyTableValue",IFCPROPERTYSINGLEVALUE:"IfcPropertySingleValue",IFCPROPERTYSETDEFINITION:"IfcPropertySetDefinition",IFCPROPERTYREFERENCEVALUE:"IfcPropertyReferenceValue",IFCPROPERTYLISTVALUE:"IfcPropertyListValue",IFCPROPERTYENUMERATEDVALUE:"IfcPropertyEnumeratedValue",IFCPROPERTYDEFINITION:"IfcPropertyDefinition",IFCPROPERTYBOUNDEDVALUE:"IfcPropertyBoundedValue",IFCPRODUCTDEFINITIONSHAPE:"IfcProductDefinitionShape",IFCPREDEFINEDPOINTMARKERSYMBOL:"IfcPredefinedPointMarkerSymbol",IFCPREDEFINEDDIMENSIONSYMBOL:"IfcPredefinedDimensionSymbol",IFCPREDEFINEDCURVEFONT:"IfcPredefinedCurveFont",IFCPREDEFINEDCOLOUR:"IfcPredefinedColour",IFCPOLYGONALBOUNDEDHALFSPACE:"IfcPolygonalBoundedHalfSpace",IFCPOLYLOOP:"IfcPolyLoop",IFCPOINTONSURFACE:"IfcPointOnSurface",IFCPOINTONCURVE:"IfcPointOnCurve",IFCPOINT:"IfcPoint",IFCPLANAREXTENT:"IfcPlanarExtent",IFCPLACEMENT:"IfcPlacement",IFCPIXELTEXTURE:"IfcPixelTexture",IFCPHYSICALCOMPLEXQUANTITY:"IfcPhysicalComplexQuantity",IFCPATH:"IfcPath",IFCPARAMETERIZEDPROFILEDEF:"IfcParameterizedProfileDef",IFCORIENTEDEDGE:"IfcOrientedEdge",IFCOPENSHELL:"IfcOpenShell",IFCONEDIRECTIONREPEATFACTOR:"IfcOneDirectionRepeatFactor",IFCOBJECTDEFINITION:"IfcObjectDefinition",IFCMECHANICALCONCRETEMATERIALPROPERTIES:"IfcMechanicalConcreteMaterialProperties",IFCMATERIALDEFINITIONREPRESENTATION:"IfcMaterialDefinitionRepresentation",IFCMAPPEDITEM:"IfcMappedItem",IFCLOOP:"IfcLoop",IFCLOCALPLACEMENT:"IfcLocalPlacement",IFCLIGHTSOURCESPOT:"IfcLightSourceSpot",IFCLIGHTSOURCEPOSITIONAL:"IfcLightSourcePositional",IFCLIGHTSOURCEGONIOMETRIC:"IfcLightSourceGoniometric",IFCLIGHTSOURCEDIRECTIONAL:"IfcLightSourceDirectional",IFCLIGHTSOURCEAMBIENT:"IfcLightSourceAmbient",IFCLIGHTSOURCE:"IfcLightSource",IFCIRREGULARTIMESERIES:"IfcIrregularTimeSeries",IFCIMAGETEXTURE:"IfcImageTexture",IFCHYGROSCOPICMATERIALPROPERTIES:"IfcHygroscopicMaterialProperties",IFCHALFSPACESOLID:"IfcHalfSpaceSolid",IFCGRIDPLACEMENT:"IfcGridPlacement",IFCGEOMETRICSET:"IfcGeometricSet",IFCGEOMETRICREPRESENTATIONSUBCONTEXT:"IfcGeometricRepresentationSubContext",IFCGEOMETRICREPRESENTATIONITEM:"IfcGeometricRepresentationItem",IFCGEOMETRICREPRESENTATIONCONTEXT:"IfcGeometricRepresentationContext",IFCGENERALPROFILEPROPERTIES:"IfcGeneralProfileProperties",IFCGENERALMATERIALPROPERTIES:"IfcGeneralMaterialProperties",IFCFUELPROPERTIES:"IfcFuelProperties",IFCFILLAREASTYLE:"IfcFillAreaStyle",IFCFAILURECONNECTIONCONDITION:"IfcFailureConnectionCondition",IFCFACESURFACE:"IfcFaceSurface",IFCFACEOUTERBOUND:"IfcFaceOuterBound",IFCFACEBOUND:"IfcFaceBound",IFCFACE:"IfcFace",IFCEXTENDEDMATERIALPROPERTIES:"IfcExtendedMaterialProperties",IFCEDGECURVE:"IfcEdgeCurve",IFCEDGE:"IfcEdge",IFCDRAUGHTINGPREDEFINEDTEXTFONT:"IfcDraughtingPredefinedTextFont",IFCDOCUMENTREFERENCE:"IfcDocumentReference",IFCDIMENSIONPAIR:"IfcDimensionPair",IFCDIMENSIONCALLOUTRELATIONSHIP:"IfcDimensionCalloutRelationship",IFCDERIVEDPROFILEDEF:"IfcDerivedProfileDef",IFCCURVESTYLE:"IfcCurveStyle",IFCCONVERSIONBASEDUNIT:"IfcConversionBasedUnit",IFCCONTEXTDEPENDENTUNIT:"IfcContextDependentUnit",IFCCONNECTIONPOINTECCENTRICITY:"IfcConnectionPointEccentricity",IFCCONNECTIONCURVEGEOMETRY:"IfcConnectionCurveGeometry",IFCCONNECTEDFACESET:"IfcConnectedFaceSet",IFCCOMPOSITEPROFILEDEF:"IfcCompositeProfileDef",IFCCOMPLEXPROPERTY:"IfcComplexProperty",IFCCOLOURRGB:"IfcColourRgb",IFCCLASSIFICATIONREFERENCE:"IfcClassificationReference",IFCCENTERLINEPROFILEDEF:"IfcCenterLineProfileDef",IFCBLOBTEXTURE:"IfcBlobTexture",IFCARBITRARYPROFILEDEFWITHVOIDS:"IfcArbitraryProfileDefWithVoids",IFCARBITRARYOPENPROFILEDEF:"IfcArbitraryOpenProfileDef",IFCARBITRARYCLOSEDPROFILEDEF:"IfcArbitraryClosedProfileDef",IFCANNOTATIONTEXTOCCURRENCE:"IfcAnnotationTextOccurrence",IFCANNOTATIONSYMBOLOCCURRENCE:"IfcAnnotationSymbolOccurrence",IFCANNOTATIONSURFACEOCCURRENCE:"IfcAnnotationSurfaceOccurrence",IFCANNOTATIONOCCURRENCE:"IfcAnnotationOccurrence",IFCWATERPROPERTIES:"IfcWaterProperties",IFCVIRTUALGRIDINTERSECTION:"IfcVirtualGridIntersection",IFCVERTEXPOINT:"IfcVertexPoint",IFCVERTEXBASEDTEXTUREMAP:"IfcVertexBasedTextureMap",IFCVERTEX:"IfcVertex",IFCUNITASSIGNMENT:"IfcUnitAssignment",IFCTOPOLOGYREPRESENTATION:"IfcTopologyRepresentation",IFCTOPOLOGICALREPRESENTATIONITEM:"IfcTopologicalRepresentationItem",IFCTIMESERIESVALUE:"IfcTimeSeriesValue",IFCTIMESERIESREFERENCERELATIONSHIP:"IfcTimeSeriesReferenceRelationship",IFCTIMESERIES:"IfcTimeSeries",IFCTHERMALMATERIALPROPERTIES:"IfcThermalMaterialProperties",IFCTEXTUREVERTEX:"IfcTextureVertex",IFCTEXTUREMAP:"IfcTextureMap",IFCTEXTURECOORDINATEGENERATOR:"IfcTextureCoordinateGenerator",IFCTEXTURECOORDINATE:"IfcTextureCoordinate",IFCTEXTSTYLEWITHBOXCHARACTERISTICS:"IfcTextStyleWithBoxCharacteristics",IFCTEXTSTYLETEXTMODEL:"IfcTextStyleTextModel",IFCTEXTSTYLEFORDEFINEDFONT:"IfcTextStyleForDefinedFont",IFCTEXTSTYLEFONTMODEL:"IfcTextStyleFontModel",IFCTEXTSTYLE:"IfcTextStyle",IFCTELECOMADDRESS:"IfcTelecomAddress",IFCTABLEROW:"IfcTableRow",IFCTABLE:"IfcTable",IFCSYMBOLSTYLE:"IfcSymbolStyle",IFCSURFACETEXTURE:"IfcSurfaceTexture",IFCSURFACESTYLEWITHTEXTURES:"IfcSurfaceStyleWithTextures",IFCSURFACESTYLESHADING:"IfcSurfaceStyleShading",IFCSURFACESTYLEREFRACTION:"IfcSurfaceStyleRefraction",IFCSURFACESTYLELIGHTING:"IfcSurfaceStyleLighting",IFCSURFACESTYLE:"IfcSurfaceStyle",IFCSTYLEDREPRESENTATION:"IfcStyledRepresentation",IFCSTYLEDITEM:"IfcStyledItem",IFCSTYLEMODEL:"IfcStyleModel",IFCSTRUCTURALLOADTEMPERATURE:"IfcStructuralLoadTemperature",IFCSTRUCTURALLOADSTATIC:"IfcStructuralLoadStatic",IFCSTRUCTURALLOAD:"IfcStructuralLoad",IFCSTRUCTURALCONNECTIONCONDITION:"IfcStructuralConnectionCondition",IFCSIMPLEPROPERTY:"IfcSimpleProperty",IFCSHAPEREPRESENTATION:"IfcShapeRepresentation",IFCSHAPEMODEL:"IfcShapeModel",IFCSHAPEASPECT:"IfcShapeAspect",IFCSECTIONREINFORCEMENTPROPERTIES:"IfcSectionReinforcementProperties",IFCSECTIONPROPERTIES:"IfcSectionProperties",IFCSIUNIT:"IfcSIUnit",IFCROOT:"IfcRoot",IFCRIBPLATEPROFILEPROPERTIES:"IfcRibPlateProfileProperties",IFCREPRESENTATIONMAP:"IfcRepresentationMap",IFCREPRESENTATIONITEM:"IfcRepresentationItem",IFCREPRESENTATIONCONTEXT:"IfcRepresentationContext",IFCREPRESENTATION:"IfcRepresentation",IFCRELAXATION:"IfcRelaxation",IFCREINFORCEMENTBARPROPERTIES:"IfcReinforcementBarProperties",IFCREFERENCESVALUEDOCUMENT:"IfcReferencesValueDocument",IFCQUANTITYWEIGHT:"IfcQuantityWeight",IFCQUANTITYVOLUME:"IfcQuantityVolume",IFCQUANTITYTIME:"IfcQuantityTime",IFCQUANTITYLENGTH:"IfcQuantityLength",IFCQUANTITYCOUNT:"IfcQuantityCount",IFCQUANTITYAREA:"IfcQuantityArea",IFCPROPERTYENUMERATION:"IfcPropertyEnumeration",IFCPROPERTYDEPENDENCYRELATIONSHIP:"IfcPropertyDependencyRelationship",IFCPROPERTYCONSTRAINTRELATIONSHIP:"IfcPropertyConstraintRelationship",IFCPROPERTY:"IfcProperty",IFCPROFILEPROPERTIES:"IfcProfileProperties",IFCPROFILEDEF:"IfcProfileDef",IFCPRODUCTSOFCOMBUSTIONPROPERTIES:"IfcProductsOfCombustionProperties",IFCPRODUCTREPRESENTATION:"IfcProductRepresentation",IFCPRESENTATIONSTYLEASSIGNMENT:"IfcPresentationStyleAssignment",IFCPRESENTATIONSTYLE:"IfcPresentationStyle",IFCPRESENTATIONLAYERWITHSTYLE:"IfcPresentationLayerWithStyle",IFCPRESENTATIONLAYERASSIGNMENT:"IfcPresentationLayerAssignment",IFCPREDEFINEDTEXTFONT:"IfcPredefinedTextFont",IFCPREDEFINEDTERMINATORSYMBOL:"IfcPredefinedTerminatorSymbol",IFCPREDEFINEDSYMBOL:"IfcPredefinedSymbol",IFCPREDEFINEDITEM:"IfcPredefinedItem",IFCPOSTALADDRESS:"IfcPostalAddress",IFCPHYSICALSIMPLEQUANTITY:"IfcPhysicalSimpleQuantity",IFCPHYSICALQUANTITY:"IfcPhysicalQuantity",IFCPERSONANDORGANIZATION:"IfcPersonAndOrganization",IFCPERSON:"IfcPerson",IFCOWNERHISTORY:"IfcOwnerHistory",IFCORGANIZATIONRELATIONSHIP:"IfcOrganizationRelationship",IFCORGANIZATION:"IfcOrganization",IFCOPTICALMATERIALPROPERTIES:"IfcOpticalMaterialProperties",IFCOBJECTIVE:"IfcObjective",IFCOBJECTPLACEMENT:"IfcObjectPlacement",IFCNAMEDUNIT:"IfcNamedUnit",IFCMONETARYUNIT:"IfcMonetaryUnit",IFCMETRIC:"IfcMetric",IFCMECHANICALSTEELMATERIALPROPERTIES:"IfcMechanicalSteelMaterialProperties",IFCMECHANICALMATERIALPROPERTIES:"IfcMechanicalMaterialProperties",IFCMEASUREWITHUNIT:"IfcMeasureWithUnit",IFCMATERIALPROPERTIES:"IfcMaterialProperties",IFCMATERIALLIST:"IfcMaterialList",IFCMATERIALLAYERSETUSAGE:"IfcMaterialLayerSetUsage",IFCMATERIALLAYERSET:"IfcMaterialLayerSet",IFCMATERIALLAYER:"IfcMaterialLayer",IFCMATERIALCLASSIFICATIONRELATIONSHIP:"IfcMaterialClassificationRelationship",IFCMATERIAL:"IfcMaterial",IFCLOCALTIME:"IfcLocalTime",IFCLIGHTINTENSITYDISTRIBUTION:"IfcLightIntensityDistribution",IFCLIGHTDISTRIBUTIONDATA:"IfcLightDistributionData",IFCLIBRARYREFERENCE:"IfcLibraryReference",IFCLIBRARYINFORMATION:"IfcLibraryInformation",IFCIRREGULARTIMESERIESVALUE:"IfcIrregularTimeSeriesValue",IFCGRIDAXIS:"IfcGridAxis",IFCEXTERNALLYDEFINEDTEXTFONT:"IfcExternallyDefinedTextFont",IFCEXTERNALLYDEFINEDSYMBOL:"IfcExternallyDefinedSymbol",IFCEXTERNALLYDEFINEDSURFACESTYLE:"IfcExternallyDefinedSurfaceStyle",IFCEXTERNALLYDEFINEDHATCHSTYLE:"IfcExternallyDefinedHatchStyle",IFCEXTERNALREFERENCE:"IfcExternalReference",IFCENVIRONMENTALIMPACTVALUE:"IfcEnvironmentalImpactValue",IFCDRAUGHTINGCALLOUTRELATIONSHIP:"IfcDraughtingCalloutRelationship",IFCDOCUMENTINFORMATIONRELATIONSHIP:"IfcDocumentInformationRelationship",IFCDOCUMENTINFORMATION:"IfcDocumentInformation",IFCDOCUMENTELECTRONICFORMAT:"IfcDocumentElectronicFormat",IFCDIMENSIONALEXPONENTS:"IfcDimensionalExponents",IFCDERIVEDUNITELEMENT:"IfcDerivedUnitElement",IFCDERIVEDUNIT:"IfcDerivedUnit",IFCDATEANDTIME:"IfcDateAndTime",IFCCURVESTYLEFONTPATTERN:"IfcCurveStyleFontPattern",IFCCURVESTYLEFONTANDSCALING:"IfcCurveStyleFontAndScaling",IFCCURVESTYLEFONT:"IfcCurveStyleFont",IFCCURRENCYRELATIONSHIP:"IfcCurrencyRelationship",IFCCOSTVALUE:"IfcCostValue",IFCCOORDINATEDUNIVERSALTIMEOFFSET:"IfcCoordinatedUniversalTimeOffset",IFCCONSTRAINTRELATIONSHIP:"IfcConstraintRelationship",IFCCONSTRAINTCLASSIFICATIONRELATIONSHIP:"IfcConstraintClassificationRelationship",IFCCONSTRAINTAGGREGATIONRELATIONSHIP:"IfcConstraintAggregationRelationship",IFCCONSTRAINT:"IfcConstraint",IFCCONNECTIONSURFACEGEOMETRY:"IfcConnectionSurfaceGeometry",IFCCONNECTIONPORTGEOMETRY:"IfcConnectionPortGeometry",IFCCONNECTIONPOINTGEOMETRY:"IfcConnectionPointGeometry",IFCCONNECTIONGEOMETRY:"IfcConnectionGeometry",IFCCOLOURSPECIFICATION:"IfcColourSpecification",IFCCLASSIFICATIONNOTATIONFACET:"IfcClassificationNotationFacet",IFCCLASSIFICATIONNOTATION:"IfcClassificationNotation",IFCCLASSIFICATIONITEMRELATIONSHIP:"IfcClassificationItemRelationship",IFCCLASSIFICATIONITEM:"IfcClassificationItem",IFCCLASSIFICATION:"IfcClassification",IFCCALENDARDATE:"IfcCalendarDate",IFCBOUNDARYNODECONDITIONWARPING:"IfcBoundaryNodeConditionWarping",IFCBOUNDARYNODECONDITION:"IfcBoundaryNodeCondition",IFCBOUNDARYFACECONDITION:"IfcBoundaryFaceCondition",IFCBOUNDARYEDGECONDITION:"IfcBoundaryEdgeCondition",IFCBOUNDARYCONDITION:"IfcBoundaryCondition",IFCAPPROVALRELATIONSHIP:"IfcApprovalRelationship",IFCAPPROVALPROPERTYRELATIONSHIP:"IfcApprovalPropertyRelationship",IFCAPPROVALACTORRELATIONSHIP:"IfcApprovalActorRelationship",IFCAPPROVAL:"IfcApproval",IFCAPPLIEDVALUERELATIONSHIP:"IfcAppliedValueRelationship",IFCAPPLIEDVALUE:"IfcAppliedValue",IFCAPPLICATION:"IfcApplication",IFCADDRESS:"IfcAddress",IFCACTORROLE:"IfcActorRole"};class UL{constructor(){L(this,"factor",1),L(this,"complement",1)}apply(t){const i=this.getScaleMatrix().multiply(t);t.copy(i)}setUp(t){var e,i,s;this.factor=1;const n=this.getLengthUnits(t);if(!n)return;const o=n==null,a=n.Name===void 0||n.Name===null;o||a||(n.Name.value==="FOOT"&&(this.factor=.3048),((e=n.Prefix)==null?void 0:e.value)==="MILLI"?this.complement=.001:((i=n.Prefix)==null?void 0:i.value)==="CENTI"?this.complement=.01:((s=n.Prefix)==null?void 0:s.value)==="DECI"&&(this.complement=.01))}getLengthUnits(t){try{const i=t.GetLineIDsWithType(0,sE).get(0),s=t.GetLine(0,i);for(const n of s.Units){if(!n||n.value===null||n.value===void 0)continue;const o=t.GetLine(0,n.value);if(o.UnitType&&o.UnitType.value==="LENGTHUNIT")return o}return null}catch{return console.log("Could not get units"),null}}getScaleMatrix(){const t=this.factor;return new ht().fromArray([t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1])}}class hR{constructor(){L(this,"itemsByFloor",{}),L(this,"_units",new UL)}setUp(t){this._units.setUp(t),this.cleanUp();try{const e=t.GetLineIDsWithType(0,Nr),i=new Set,s=t.GetLineIDsWithType(0,Ii);for(let l=0;l<s.size();l++)i.add(s.get(l));const n=t.GetLineIDsWithType(0,xr),o=n.size();for(let l=0;l<o;l++){const h=n.get(l),u=t.GetLine(0,h);if(!u||!u.RelatingObject||!u.RelatedObjects)continue;const d=u.RelatingObject.value,f=u.RelatedObjects;for(const p of f){const m=p.value;i.has(m)&&(this.itemsByFloor[m]=d)}}const a={},c=e.size();for(let l=0;l<c;l++){const h=e.get(l),u=t.GetLine(0,h);if(!u||!u.RelatingStructure||!u.RelatedElements)continue;const d=u.RelatingStructure.value,f=u.RelatedElements;if(i.has(d))for(const p of f){a[d]||(a[d]=[]);const m=p.value;a[d].push(m)}else for(const p of f){const m=p.value;this.itemsByFloor[m]=d}}for(const l in a){const h=this.itemsByFloor[l];if(h!==void 0){const u=a[l];for(const d of u)this.itemsByFloor[d]=h}}for(let l=0;l<o;l++){const h=n.get(l),u=t.GetLine(0,h);if(!u||!u.RelatingObject||!u.RelatedObjects)continue;const d=u.RelatingObject.value,f=u.RelatedObjects;for(const p of f){const m=p.value,g=this.itemsByFloor[d];g!==void 0&&(this.itemsByFloor[m]=g)}}}catch{console.log("Could not get floors.")}}cleanUp(){this.itemsByFloor={}}}class ME{constructor(){L(this,"includeProperties",!0),L(this,"optionalCategories",[Ii]),L(this,"wasm",{path:"",absolute:!1,logLevel:zy.LOG_LEVEL_OFF}),L(this,"excludedCategories",new Set),L(this,"includedCategories",new Set),L(this,"saveLocations",!1),L(this,"webIfc",{COORDINATE_TO_ORIGIN:!0}),L(this,"autoSetWasm",!0),L(this,"customLocateFileHandler",null)}}class uR{constructor(){L(this,"defLineMat",new xi({color:16777215}))}read(t){const e=t.GetAllAlignments(0),i=t.GetAllCrossSections2D(0),s=t.GetAllCrossSections3D(0),n={IfcAlignment:e,IfcCrossSection2D:i,IfcCrossSection3D:s};return this.get(n)}get(t){if(t.IfcAlignment){const e=new Map;for(const i of t.IfcAlignment){const s=new lp;s.absolute=this.getCurves(i.curve3D,s),s.horizontal=this.getCurves(i.horizontal,s),s.vertical=this.getCurves(i.vertical,s),e.set(e.size,s)}return{alignments:e,coordinationMatrix:new ht}}}getCurves(t,e){const i=[];let s=0;for(const n of t){const o={};if(n.data)for(const d of n.data){const[f,p]=d.split(": "),m=parseFloat(p);o[f]=m||p}const{points:a}=n,c=new Float32Array(a.length*3);for(let d=0;d<a.length;d++){const{x:f,y:p,z:m}=a[d];c[d*3]=f,c[d*3+1]=p,c[d*3+2]=m||0}const l=new Kt(c,3),h=new $f;h.setAttribute("position",l);const u=new hp(s,o,e,h,this.defLineMat);i.push(u.curve),s++}return i}}class dR{getNameInfo(t){var e;const i={},{arguments:s}=t.GetHeaderLine(0,Yy)||{};if(!s)return i;const[n,o,a,c,l,h,u]=s;if(n?.value&&(i.name=n.value),o?.value&&(i.creationDate=new Date(o.value)),a){i.author={};const[d,f]=a;d?.value&&(i.author.name=d.value),f?.value&&(i.author.email=f.value)}return c&&((e=c[0])!=null&&e.value)&&(i.organization=c[0].value),l?.value&&(i.preprocessorVersion=l?.value),h?.value&&(i.originatingSystem=h?.value),u?.value&&(i.authorization=u?.value),i}getDescriptionInfo(t){var e;const i={},{arguments:s}=t.GetHeaderLine(0,Gy)||{};if(!s)return i;const[n,o]=s;if(Array.isArray(n)&&((e=n[0])!=null&&e.value)){const a=n[0].value.match(/\[([^\]]+)\]/);a&&a[1]&&(i.viewDefinition=a[1])}return o?.value&&(i.implementationLevel=o.value),i}}class fR{static get(t,e){const i=[Bo,Nc,Pc,ko,Ii,Wy,jy,Xy,Zy],s=t.data;for(const n of i){const o=e.GetLineIDsWithType(0,n),a=o.size();for(let c=0;c<a;c++){const l=o.get(c);s.has(l)||s.set(l,[[],[0,n]])}}}}const pR=new Set([1123145078,574549367,1675464909,2059837836,3798115385,32440307,3125803723,3207858831,2740243338,2624227202,4240577450,3615266464,3724593414,220341763,477187591,1878645084,1300840506,3303107099,1607154358,1878645084,846575682,1351298697,2417041796,3049322572,3331915920,1416205885,776857604,3285139300,3958052878,2827736869,2732653382,673634403,3448662350,4142052618,2924175390,803316827,2556980723,1809719519,2205249479,807026263,3737207727,1660063152,2347385850,2705031697,3732776249,2485617015,2611217952,1704287377,2937912522,2770003689,1281925730,1484403080,3448662350,4142052618,3800577675,4006246654,3590301190,1383045692,2775532180,2047409740,370225590,3593883385,2665983363,4124623270,812098782,3649129432,987898635,1105321065,3510044353,1635779807,2603310189,3406155212,1310608509,4261334040,2736907675,3649129432,1136057603,1260505505,4182860854,2713105998,2898889636,59481748,3749851601,3486308946,3150382593,1062206242,3264961684,15328376,1485152156,370225590,1981873012,2859738748,45288368,2614616156,2732653382,775493141,2147822146,2601014836,2629017746,1186437898,2367409068,1213902940,3632507154,3900360178,476780140,1472233963,2804161546,3008276851,738692330,374418227,315944413,3905492369,3570813810,2571569899,178912537,2294589976,1437953363,2133299955,572779678,3092502836,388784114,2624227202,1425443689,3057273783,2347385850,1682466193,2519244187,2839578677,3958567839,2513912981,2830218821,427810014,2916149573]),mR=class IR extends oe{constructor(t){super(t),L(this,"enabled",!0),t.add(IR.uuid,this)}async export(t,e,i=!1,s=!0){const n={},o=new Set(t.GetIfcEntityList(e)),a=new Set([Bo,Nc,Pc,ko,Ii]);for(const c of a)o.add(c);for(const c of o){if(pR.has(c))continue;const l=a.has(c)&&s,h=t.GetLineIDsWithType(e,c);for(const u of h)try{const d=t.GetLine(0,u,l,i);n[d.expressID]=d}catch{console.log(`Could not get property ${u}, with recursive ${l} and indirect ${i}.`)}}return n}};L(mR,"uuid","b32c4332-cd67-436e-ba7f-196646c7a635");let BL=mR;const gR=class QI extends oe{constructor(t){super(t),L(this,"onDisposed",new It),L(this,"onIfcStartedLoading",new It),L(this,"onSetup",new It),L(this,"settings",new ME),L(this,"webIfc",new is),L(this,"enabled",!0),L(this,"_material",new Er),L(this,"_spatialTree",new hR),L(this,"_metaData",new dR),L(this,"_fragmentInstances",new Map),L(this,"_civil",new uR),L(this,"_visitedFragments",new Map),L(this,"_materialT",new Er({transparent:!0,opacity:.5})),this.components.add(QI.uuid,this),this.settings.excludedCategories.add(Wf)}dispose(){this.webIfc=null,this.onDisposed.trigger(QI.uuid),this.onDisposed.reset()}async setup(t){this.settings={...this.settings,...t},this.settings.autoSetWasm&&await this.autoSetWasm(),this.onSetup.trigger()}async load(t,e=!0,i=""){const s=performance.now();this.onIfcStartedLoading.trigger(),await this.readIfcFile(t);const n=await this.getAllGeometries();n.name=i;const a=await this.components.get(BL).export(this.webIfc,0);n.setLocalProperties(a);const c=this.components.get(Bt);c.groups.set(n.uuid,n);for(const l of n.items)c.list.set(l.id,l),l.mesh.uuid=l.id,l.group=n;c.onFragmentsLoaded.trigger(n),e&&c.coordinate([n]);for(const[l]of n.data){const h=a[l];if(!h||!h.GlobalId)continue;const u=h.GlobalId.value||h.GlobalId;n.globalToExpressIDs.set(u,l)}return fR.get(n,this.webIfc),this.cleanUp(),console.log(`Streaming the IFC took ${performance.now()-s} ms!`),n}async readIfcFile(t){const{path:e,absolute:i,logLevel:s}=this.settings.wasm;return this.webIfc.SetWasmPath(e,i),await this.webIfc.Init(this.settings.customLocateFileHandler||void 0),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModel(t,this.settings.webIfc)}cleanUp(){try{this.webIfc.Dispose()}catch{console.log("Web-ifc wasn't disposed.")}this.webIfc=null,this.webIfc=new is,this._visitedFragments.clear(),this._fragmentInstances.clear()}async getAllGeometries(){this._spatialTree.setUp(this.webIfc);const t=this.webIfc.GetIfcEntityList(0),e=new si;e.ifcMetadata={name:"",description:"",...this._metaData.getNameInfo(this.webIfc),...this._metaData.getDescriptionInfo(this.webIfc),schema:this.webIfc.GetModelSchema(0)||"IFC2X3",maxExpressID:this.webIfc.GetMaxExpressID(0)};const i=[];for(const n of t){if(!this.webIfc.IsIfcElement(n)&&n!==Ii)continue;const o=this.settings.includedCategories;if(o.size>0&&!o.has(n))continue;if(this.settings.excludedCategories.has(n))continue;const a=this.webIfc.GetLineIDsWithType(0,n),c=a.size();for(let l=0;l<c;l++){const h=a.get(l);i.push(h);const u=this._spatialTree.itemsByFloor[h]||0;e.data.set(h,[[],[u,n]])}}this._spatialTree.cleanUp(),this.webIfc.StreamMeshes(0,i,n=>{this.getMesh(n,e)});for(const n of this._visitedFragments){const{index:o,fragment:a}=n[1];e.keyFragments.set(o,a.id)}for(const n of e.items){const o=this._fragmentInstances.get(n.id);if(!o)throw new Error("Fragment not found!");const a=[];for(const[c,l]of o)a.push(l);n.add(a)}const s=this.webIfc.GetCoordinationMatrix(0);return e.coordinationMatrix.fromArray(s),e.civilData=this._civil.read(this.webIfc),e}getMesh(t,e){const i=t.geometries.size(),s=t.expressID;for(let n=0;n<i;n++){const o=t.geometries.get(n),{x:a,y:c,z:l,w:h}=o.color,u=h!==1,{geometryExpressID:d}=o,f=`${d}-${u}`;if(!this._visitedFragments.has(f)){const E=this.getGeometry(this.webIfc,d),T=u?this._materialT:this._material,A=new So(E,T,1);e.add(A.mesh),e.items.push(A);const S=this._visitedFragments.size;this._visitedFragments.set(f,{index:S,fragment:A})}const p=new Rt().setRGB(a,c,l,"srgb"),m=new ht;m.fromArray(o.flatTransformation);const g=this._visitedFragments.get(f);if(g===void 0)throw new Error("Error getting geometry data for streaming!");const I=e.data.get(s);if(!I)throw new Error("Data not found!");I[0].push(g.index);const{fragment:C}=g;this._fragmentInstances.has(C.id)||this._fragmentInstances.set(C.id,new Map);const b=this._fragmentInstances.get(C.id);if(!b)throw new Error("Instances not found!");if(b.has(s)){const E=b.get(s);if(!E)throw new Error("Instance not found!");E.transforms.push(m),E.colors&&E.colors.push(p)}else b.set(s,{id:s,transforms:[m],colors:[p]})}}getGeometry(t,e){const i=t.GetGeometry(0,e),s=t.GetIndexArray(i.GetIndexData(),i.GetIndexDataSize()),n=t.GetVertexArray(i.GetVertexData(),i.GetVertexDataSize()),o=new Float32Array(n.length/2),a=new Float32Array(n.length/2);for(let u=0;u<n.length;u+=6)o[u/2]=n[u],o[u/2+1]=n[u+1],o[u/2+2]=n[u+2],a[u/2]=n[u+3],a[u/2+1]=n[u+4],a[u/2+2]=n[u+5];const c=new Ut,l=new Kt(o,3),h=new Kt(a,3);return c.setAttribute("position",l),c.setAttribute("normal",h),c.setIndex(Array.from(s)),i.delete(),c}async autoSetWasm(){const t=await fetch(`https://unpkg.com/@thatopen/components@${xE.release}/package.json`);if(!t.ok){console.warn("Couldn't get openbim-components package.json. Set wasm settings manually.");return}const e=await t.json();if(!("web-ifc"in e.peerDependencies))console.warn("Couldn't get web-ifc from peer dependencies in openbim-components. Set wasm settings manually.");else{const i=e.peerDependencies["web-ifc"];this.settings.wasm.path=`https://unpkg.com/web-ifc@${i}/`,this.settings.wasm.absolute=!0}}};L(gR,"uuid","a659add7-1418-4771-a0d6-7d4d438e4624");let DE=gR;const kL={IfcRelAssignsToControl:{related:5,relating:7},IfcRelAssignsToGroup:{related:5,relating:7},IfcRelAssignsToProduct:{related:5,relating:7},IfcRelAssociatesClassification:{related:5,relating:6},IfcRelAssociatesMaterial:{related:5,relating:6},IfcRelAssociatesDocument:{related:5,relating:6},IfcRelContainedInSpatialStructure:{related:5,relating:6},IfcRelFlowControlElements:{related:5,relating:6},IfcRelConnectsElements:{related:7,relating:6},IfcRelDeclares:{related:6,relating:5},IfcRelAggregates:{related:6,relating:5},IfcRelNests:{related:6,relating:5},IfcRelDefinesByProperties:{related:5,relating:6},IfcRelDefinesByType:{related:5,relating:6},IfcRelDefinesByTemplate:{related:5,relating:6}},VL={[Fc]:"IfcRelAssignsToControl",[yc]:"IfcRelAssignsToGroup",[wc]:"IfcRelAssignsToProduct",[Tc]:"IfcRelAssociatesClassification",[bc]:"IfcRelAssociatesMaterial",[xc]:"IfcRelAssociatesDocument",[Nr]:"IfcRelContainedInSpatialStructure",[Sc]:"IfcRelConnectsElements",[Ac]:"IfcRelFlowControlElements",[_c]:"IfcRelDeclares",[xr]:"IfcRelAggregates",[Oc]:"IfcRelNests",[on]:"IfcRelDefinesByProperties",[vc]:"IfcRelDefinesByType",[Rc]:"IfcRelDefinesByTemplate"},ER=class ao extends oe{constructor(t){super(t),L(this,"onDisposed",new It),L(this,"onRequestFile",new It),L(this,"ifcToExport",null),L(this,"onElementToPset",new It),L(this,"onPropToPset",new It),L(this,"onPsetRemoved",new It),L(this,"onDataChanged",new It),L(this,"wasm",{path:"/",absolute:!1}),L(this,"enabled",!0),L(this,"attributeListeners",{}),L(this,"selectedModel"),L(this,"changeMap",{}),this.components.add(ao.uuid,this)}dispose(){this.selectedModel=void 0,this.attributeListeners={},this.changeMap={},this.onElementToPset.reset(),this.onPropToPset.reset(),this.onPsetRemoved.reset(),this.onDataChanged.reset(),this.onDisposed.trigger(ao.uuid),this.onDisposed.reset()}static getIFCSchema(t){const e=t.ifcMetadata.schema;if(!e)throw new Error("IFC Schema not found");return e.startsWith("IFC2X3")?"IFC2X3":e.startsWith("IFC4")&&e.replace("IFC4","")===""?"IFC4":e.startsWith("IFC4X3")?"IFC4X3":e}async setData(t,...e){for(const i of e){const{expressID:s}=i;(!s||s===-1)&&(i.expressID=this.getNewExpressID(t)),await t.setProperties(i.expressID,i),this.registerChange(t,i.expressID)}}async newPset(t,e,i){const s=ao.getIFCSchema(t),{handle:n}=await this.getOwnerHistory(t),o=this.newGUID(t),a=new _e[s].IfcLabel(e),c=i?new _e[s].IfcText(i):null,l=new _e[s].IfcPropertySet(o,n,a,c,[]);return l.expressID=this.getNewExpressID(t),await this.setData(t,l),{pset:l}}async removePset(t,...e){for(const i of e){const s=await t.getProperties(i);if(s?.type!==pi)continue;const n=await Wa.getPsetRel(t,i);if(n&&(await t.setProperties(n,null),this.registerChange(t,n)),s){for(const o of s.HasProperties)await t.setProperties(o.value,null);await t.setProperties(i,null),this.onPsetRemoved.trigger({model:t,psetID:i}),this.registerChange(t,i)}}}newSingleStringProperty(t,e,i,s){return this.newSingleProperty(t,e,i,s)}newSingleNumericProperty(t,e,i,s){return this.newSingleProperty(t,e,i,s)}newSingleBooleanProperty(t,e,i,s){return this.newSingleProperty(t,e,i,s)}async removePsetProp(t,e,i){const s=await t.getProperties(e),n=await t.getProperties(i);!s||!n||s.type===pi&&n&&(s.HasProperties=s.HasProperties.filter(o=>o.value!==i),await t.setProperties(i,null),this.registerChange(t,e,i))}addElementToPset(t,e,...i){this.components.get(pe).addEntitiesRelation(t,e,{type:on,inv:"DefinesOcurrence"},...i)}async addPropToPset(t,e,...i){const s=await t.getProperties(e);if(s){for(const n of i){if(s.HasProperties.includes(n))continue;const o=new ei(n);s.HasProperties.push(o),this.onPropToPset.trigger({model:t,psetID:e,propID:n})}this.registerChange(t,e)}}async createIfcRel(t,e,i,s){const n=VL[e];if(!n)throw new Error(`IfcPropertiesManager: ${n} is unsoported.`);const o=ao.getIFCSchema(t),a=kL[n],c=_e[o][n];if(!(a&&c))throw new Error(`IfcPropertiesManager: ${n} is unsoported.`);const l=[new _e[o].IfcGloballyUniqueId(Un.create())],{related:h,relating:u}=a,f=[...new Set(s)].map(g=>new ei(g)),p=(g,I)=>{for(let C=g;C<I-1;C++)l.push(null)};h<u?(p(1,h),l.push(f),p(h,u),l.push(new ei(i))):(p(1,u),p(u,h),l.push(new ei(i)),l.push(f));const m=new c(...l);return await this.setData(t,m),m}async saveToIfc(t,e){const i=this.components.get(DE),s=i.webIfc,n=await i.readIfcFile(e);await this.components.get(pe).applyRelationChanges();const a=this.changeMap[t.uuid]??[];for(const l of a){const h=await t.getProperties(l);h?s.WriteLine(n,h):s.GetLine(n,l)&&s.DeleteLine(n,l)}const c=s.SaveModel(n);return i.webIfc.CloseModel(n),i.cleanUp(),c}async getEntityRef(t,e){const i=await t.getAllPropertiesOfType(e);if(!i)return null;const s=[];for(const n in i){const o=new ei(Number(n));s.push(o)}return s}async setAttributeListener(t,e,i){this.attributeListeners[t.uuid]||(this.attributeListeners[t.uuid]={});const s=this.attributeListeners[t.uuid][e]?this.attributeListeners[t.uuid][e][i]:null;if(s)return s;const n=await t.getProperties(e);if(!n)throw new Error(`Entity with expressID ${e} doesn't exists.`);const o=n[i];if(Array.isArray(o)||!o)throw new Error(`Attribute ${i} is array or null, and it can't have a listener.`);const a=o.value;if(a===void 0||a==null)throw new Error(`Attribute ${i} has a badly defined handle.`);const c=new It;return Object.defineProperty(n[i],"value",{get(){return this._value},async set(l){this._value=l,c.trigger(l)}}),n[i].value=a,this.attributeListeners[t.uuid][e]||(this.attributeListeners[t.uuid][e]={}),this.attributeListeners[t.uuid][e][i]=c,c}getNewExpressID(t){return t.ifcMetadata.maxExpressID++,t.ifcMetadata.maxExpressID}newGUID(t){const e=ao.getIFCSchema(t);return new _e[e].IfcGloballyUniqueId(Un.create())}async getOwnerHistory(t){const e=await t.getAllPropertiesOfType(By);if(!e)throw new Error("No OwnerHistory was found.");const i=Object.keys(e).map(o=>parseInt(o,10)),s=e[i[0]],n=new ei(s.expressID);return{entity:s,handle:n}}registerChange(t,...e){this.changeMap[t.uuid]||(this.changeMap[t.uuid]=new Set);for(const i of e)this.changeMap[t.uuid].add(i),this.onDataChanged.trigger({model:t,expressID:i})}async newSingleProperty(t,e,i,s){const n=ao.getIFCSchema(t),o=new _e[n].IfcIdentifier(i),a=new _e[n][e](s),c=new _e[n].IfcPropertySingleValue(o,null,a,null);return c.expressID=this.getNewExpressID(t),await this.setData(t,c),c}};L(ER,"uuid","58c2d9f0-183c-48d6-a402-dfcf5b9a34df");let CR=ER;const bR=class KI extends oe{constructor(t){super(t),L(this,"onDisposed",new It),L(this,"onRelationsIndexed",new It),L(this,"relationMaps",{}),L(this,"enabled",!0),L(this,"_relToAttributesMap",mb),L(this,"_inverseAttributes",["IsDecomposedBy","Decomposes","AssociatedTo","HasAssociations","ClassificationForObjects","IsGroupedBy","HasAssignments","IsDefinedBy","DefinesOcurrence","IsTypedBy","Types","Defines","ContainedInStructure","ContainsElements","HasControlElements","AssignedToFlowElement","ConnectedTo","ConnectedFrom","ReferencedBy","Declares","HasContext","Controls","IsNestedBy","Nests","DocumentRefForObjects"]),L(this,"_ifcRels",[xr,bc,Tc,yc,on,vc,Rc,Nr,Ac,Sc,wc,_c,Fc,Oc,xc]),L(this,"onFragmentsDisposed",i=>{delete this.relationMaps[i.groupID]}),L(this,"_changeMap",{}),L(this,"onEntitiesRelated",new It),this.components.add(KI.uuid,this),t.get(Bt).onFragmentsDisposed.add(this.onFragmentsDisposed)}indexRelations(t,e,i,s){const n=Object.keys(e).find(h=>h.startsWith("Relating")),o=Object.keys(e).find(h=>h.startsWith("Related"));if(!(n&&o))return;const a=e[n].value,c=e[o].map(h=>h.value),l=this.getEntityRelations(t,a,s);for(const h of c)l.push(h);for(const h of c)this.getEntityRelations(t,h,i).push(a)}getAttributeIndex(t){const e=this._inverseAttributes.indexOf(t);if(e===-1)throw new Error(`IfcRelationsIndexer: ${t} is not a valid IFC Inverse Attribute name or its not supported yet by this component.`);return e}setRelationMap(t,e){this.relationMaps[t.uuid]=e,this.onRelationsIndexed.trigger({modelID:t.uuid,relationsMap:e})}async process(t,e){if(!t.hasProperties)throw new Error("FragmentsGroup properties not found");let i=this.relationMaps[t.uuid];i||(i=new Map,this.relationMaps[t.uuid]=i);const s=t.getLocalProperties();if(!s)return i;const n=e?.relationsToProcess??this._ifcRels;for(const[o,a]of Object.entries(s)){if(!n.includes(a.type))continue;const c=this._relToAttributesMap.get(a.type);if(!c)continue;const{forRelated:l,forRelating:h}=c;this.indexRelations(i,a,l,h)}return this.setRelationMap(t,i),i}async processFromWebIfc(t,e){const i=new Map;for(const s of this._ifcRels){const n=this._relToAttributesMap.get(s);if(!n)continue;const{forRelated:o,forRelating:a}=n,c=t.GetLineIDsWithType(e,s);for(let l=0;l<c.size();l++){const h=await t.properties.getItemProperties(e,c.get(l));this.indexRelations(i,h,o,a)}}return this.onRelationsIndexed.trigger({modelID:e.toString(),relationsMap:i}),i}getEntityRelations(t,e,i){const s=this.getAttributeIndex(i);let n;if(t instanceof si?n=this.relationMaps[t.uuid]:typeof t=="string"?n=this.relationMaps[t]:n=t,!n&&(t instanceof si||typeof t=="string")){n=new Map;const c=t instanceof si?t.uuid:t;this.relationMaps[c]=n}let o=n.get(e);o||(o=new Map,n.set(e,o));let a=o.get(s);return a||(a=[],o.set(s,a)),a}serializeRelations(t){const e={};for(const[i,s]of t.entries()){e[i]||(e[i]={});for(const[n,o]of s.entries())e[i][n]=o}return JSON.stringify(e)}serializeModelRelations(t){const e=this.relationMaps[t.uuid];return e?this.serializeRelations(e):null}serializeAllRelations(){const t={};for(const e in this.relationMaps){const i=this.relationMaps[e],s={};for(const[n,o]of i.entries()){s[n]||(s[n]={});for(const[a,c]of o.entries())s[n][a]=c}t[e]=s}return JSON.stringify(t)}getRelationsMapFromJSON(t){const e=JSON.parse(t),i=new Map;for(const s in e){const n=e[s],o=new Map;for(const a in n)o.set(Number(a),n[a]);i.set(Number(s),o)}return i}dispose(){this.relationMaps={},this.components.get(Bt).onFragmentsDisposed.remove(this.onFragmentsDisposed),this.onDisposed.trigger(KI.uuid),this.onDisposed.reset()}getEntitiesWithRelation(t,e,i){const s=this.relationMaps[t.uuid];if(!s)throw new Error("IfcRelationsIndexer: the model relations are not indexed!");const n=new Set;for(const[o,a]of s){const c=this.getAttributeIndex(e),l=a.get(c);l&&l.includes(i)&&n.add(o)}return n}addEntityRelations(t,e,i,...s){const n=this.getEntityRelations(t,e,i);if(n)n.push(...s);else{const o=this.getAttributeIndex(i),a=this.relationMaps[t.uuid].get(e);a?.set(o,s)}}async applyRelationChanges(){const t=this.components.get(Bt),e=this.components.get(CR);for(const i in this._changeMap){const s=t.groups.get(i);if(!s)continue;const n=this._changeMap[i];for(const[o,a]of n)for(const[c,l]of a){const{related:h,relID:u}=l;if(u){const d=await s.getProperties(u);if(!d)continue;const f=Object.keys(d),p=f.find(g=>g.startsWith("Related")),m=f.find(g=>g.startsWith("Relating"));if(!(p&&m))continue;d[p]=[...h].map(g=>new ei(g)),d[m]=new ei(c),await e.setData(s,d)}else{const d=await e.createIfcRel(s,o,c,[...h]);if(!d)continue;l.relID=d.expressID}}}}addEntitiesRelation(t,e,i,...s){const{type:n,inv:o}=i;let a=this.relationMaps[t.uuid];if(a||(a=new Map,this.relationMaps[t.uuid]=a),!this._ifcRels.includes(n))return;const c=mb.get(n);if(!c)return;const{forRelated:l,forRelating:h}=c;if(!(l===o||h===o))return;let u=this._changeMap[t.uuid];u||(u=new Os,this._changeMap[t.uuid]=u);const d=h===o?[e]:s,f=l===o?[e]:s;let p=u.get(n);p||(p=new Os,p.onItemSet.add(()=>this.onEntitiesRelated.trigger({invAttribute:o,relType:n,relatingIDs:d,relatedIDs:f})),p.onItemUpdated.add(()=>this.onEntitiesRelated.trigger({invAttribute:o,relType:n,relatingIDs:d,relatedIDs:f})),u.set(n,p));for(const m of d){let g=p.get(m);g||(g={related:new Ir},p.set(m,g)),g.related.add(...f)}for(const m of d)this.getEntityRelations(t,m,h).push(...f);for(const m of f)this.getEntityRelations(t,m,l).push(...d)}getEntityChildren(t,e,i=new Set){if(i.add(e),this.relationMaps[t.uuid]===void 0)throw new Error("The provided model has no indices. You have to generate them first.");const n=this.getEntityRelations(t,e,"IsDecomposedBy");if(n)for(const a of n)this.getEntityChildren(t,a,i);const o=this.getEntityRelations(t,e,"ContainsElements");if(o)for(const a of o)this.getEntityChildren(t,a,i);return i}};L(bR,"uuid","23a889ab-83b3-44a4-8bee-ead83438370b");let pe=bR;const TR=class yR extends oe{constructor(t){super(t),L(this,"onDisposed",new It),L(this,"onFragmentsLoaded",new It),L(this,"onFragmentsDisposed",new It),L(this,"list",new Os),L(this,"groups",new Os),L(this,"baseCoordinationModel",""),L(this,"baseCoordinationMatrix",new ht),L(this,"enabled",!0),L(this,"_loader",new cp),this.components.add(yR.uuid,this)}get meshes(){const t=[];for(const[e,i]of this.list)t.push(i.mesh);return t}dispose(){for(const[t,e]of this.groups)e.dispose(!0);this.baseCoordinationModel="",this.groups.clear(),this.list.clear(),this.onFragmentsLoaded.reset(),this.onFragmentsDisposed.reset(),this.onDisposed.trigger(),this.onDisposed.reset()}disposeGroup(t){const{uuid:e}=t,i=[];for(const s of t.items)i.push(s.id),this.list.delete(s.id);t.dispose(!0),this.groups.delete(t.uuid),this.groups.size===0&&(this.baseCoordinationModel="",this.baseCoordinationMatrix=new ht),this.onFragmentsDisposed.trigger({groupID:e,fragmentIDs:i})}load(t,e){const s={...{coordinate:!0},...e},{coordinate:n,name:o,properties:a,relationsMap:c}=s,l=this._loader.import(t);e&&(l.isStreamed=e.isStreamed||!1),o&&(l.name=o);for(const h of l.items)h.group=l,this.list.set(h.id,h);return n&&this.coordinate([l]),this.groups.set(l.uuid,l),a&&l.setLocalProperties(a),c&&this.components.get(pe).setRelationMap(l,c),this.onFragmentsLoaded.trigger(l),l}export(t){return this._loader.export(t)}getModelIdMap(t){const e={};for(const i in t){const s=this.list.get(i);if(!(s&&s.group))continue;const n=s.group;n.uuid in e||(e[n.uuid]=new Set);const o=t[i];for(const a of o)e[n.uuid].add(a)}return e}modelIdToFragmentIdMap(t){let e={};for(const i in t){const s=this.groups.get(i);if(!s)continue;const n=t[i],o=s.getFragmentMap(n);e={...e,...o}}return e}guidToFragmentIdMap(t){const e={};for(const[s,n]of this.groups){s in e||(e[s]=new Set);for(const o of t){const a=n.globalToExpressIDs.get(o);a&&e[s].add(a)}}return this.modelIdToFragmentIdMap(e)}fragmentIdMapToGuids(t){const e=[],i=this.getModelIdMap(t);for(const s in i){const n=this.groups.get(s);if(!n)continue;const o=i[s];for(const a of o)for(const[c,l]of n.globalToExpressIDs.entries())if(l===a){e.push(c);break}}return e}coordinate(t=Array.from(this.groups.values())){if(this.baseCoordinationModel.length===0){const i=t.pop();if(!i)return;this.baseCoordinationModel=i.uuid,this.baseCoordinationMatrix=i.coordinationMatrix.clone()}if(t.length)for(const i of t)i.coordinationMatrix.equals(this.baseCoordinationMatrix)||(i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1),i.updateMatrix(),this.applyBaseCoordinateSystem(i,i.coordinationMatrix))}applyBaseCoordinateSystem(t,e){e&&t.applyMatrix4(e.clone().invert()),t.applyMatrix4(this.baseCoordinationMatrix)}clone(t,e){const i=t.cloneGroup(e);this.groups.set(i.uuid,i);for(const s of i.items)this.list.set(s.id,s);return i}};L(TR,"uuid","fef46874-46a3-461b-8c44-2922ab77c806");let Bt=TR;function cd(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var vR={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(r,t){(function(e){r.exports=e()})(function(){return function e(i,s,n){function o(l,h){if(!s[l]){if(!i[l]){var u=typeof cd=="function"&&cd;if(!h&&u)return u(l,!0);if(a)return a(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var f=s[l]={exports:{}};i[l][0].call(f.exports,function(p){var m=i[l][1][p];return o(m||p)},f,f.exports,e,i,s,n)}return s[l].exports}for(var a=typeof cd=="function"&&cd,c=0;c<n.length;c++)o(n[c]);return o}({1:[function(e,i,s){var n=e("./utils"),o=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(c){for(var l,h,u,d,f,p,m,g=[],I=0,C=c.length,b=C,E=n.getTypeOf(c)!=="string";I<c.length;)b=C-I,u=E?(l=c[I++],h=I<C?c[I++]:0,I<C?c[I++]:0):(l=c.charCodeAt(I++),h=I<C?c.charCodeAt(I++):0,I<C?c.charCodeAt(I++):0),d=l>>2,f=(3&l)<<4|h>>4,p=1<b?(15&h)<<2|u>>6:64,m=2<b?63&u:64,g.push(a.charAt(d)+a.charAt(f)+a.charAt(p)+a.charAt(m));return g.join("")},s.decode=function(c){var l,h,u,d,f,p,m=0,g=0,I="data:";if(c.substr(0,I.length)===I)throw new Error("Invalid base64 input, it looks like a data url.");var C,b=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===a.charAt(64)&&b--,c.charAt(c.length-2)===a.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(C=o.uint8array?new Uint8Array(0|b):new Array(0|b);m<c.length;)l=a.indexOf(c.charAt(m++))<<2|(d=a.indexOf(c.charAt(m++)))>>4,h=(15&d)<<4|(f=a.indexOf(c.charAt(m++)))>>2,u=(3&f)<<6|(p=a.indexOf(c.charAt(m++))),C[g++]=l,f!==64&&(C[g++]=h),p!==64&&(C[g++]=u);return C}},{"./support":30,"./utils":32}],2:[function(e,i,s){var n=e("./external"),o=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),c=e("./stream/DataLengthProbe");function l(h,u,d,f,p){this.compressedSize=h,this.uncompressedSize=u,this.crc32=d,this.compression=f,this.compressedContent=p}l.prototype={getContentWorker:function(){var h=new o(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),u=this;return h.on("end",function(){if(this.streamInfo.data_length!==u.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new o(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},l.createWorkerFrom=function(h,u,d){return h.pipe(new a).pipe(new c("uncompressedSize")).pipe(u.compressWorker(d)).pipe(new c("compressedSize")).withStreamInfo("compression",u)},i.exports=l},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,i,s){var n=e("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},s.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,i,s){var n=e("./utils"),o=function(){for(var a,c=[],l=0;l<256;l++){a=l;for(var h=0;h<8;h++)a=1&a?3988292384^a>>>1:a>>>1;c[l]=a}return c}();i.exports=function(a,c){return a!==void 0&&a.length?n.getTypeOf(a)!=="string"?function(l,h,u,d){var f=o,p=d+u;l^=-1;for(var m=d;m<p;m++)l=l>>>8^f[255&(l^h[m])];return-1^l}(0|c,a,a.length,0):function(l,h,u,d){var f=o,p=d+u;l^=-1;for(var m=d;m<p;m++)l=l>>>8^f[255&(l^h.charCodeAt(m))];return-1^l}(0|c,a,a.length,0):0}},{"./utils":32}],5:[function(e,i,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(e,i,s){var n=null;n=typeof Promise<"u"?Promise:e("lie"),i.exports={Promise:n}},{lie:37}],7:[function(e,i,s){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=e("pako"),a=e("./utils"),c=e("./stream/GenericWorker"),l=n?"uint8array":"array";function h(u,d){c.call(this,"FlateWorker/"+u),this._pako=null,this._pakoAction=u,this._pakoOptions=d,this.meta={}}s.magic="\b\0",a.inherits(h,c),h.prototype.processChunk=function(u){this.meta=u.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(l,u.data),!1)},h.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var u=this;this._pako.onData=function(d){u.push({data:d,meta:u.meta})}},s.compressWorker=function(u){return new h("Deflate",u)},s.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,i,s){function n(f,p){var m,g="";for(m=0;m<p;m++)g+=String.fromCharCode(255&f),f>>>=8;return g}function o(f,p,m,g,I,C){var b,E,T=f.file,A=f.compression,S=C!==l.utf8encode,_=a.transformTo("string",C(T.name)),w=a.transformTo("string",l.utf8encode(T.name)),F=T.comment,D=a.transformTo("string",C(F)),R=a.transformTo("string",l.utf8encode(F)),O=w.length!==T.name.length,y=R.length!==F.length,U="",H="",k="",X=T.dir,$=T.date,et={crc32:0,compressedSize:0,uncompressedSize:0};p&&!m||(et.crc32=f.crc32,et.compressedSize=f.compressedSize,et.uncompressedSize=f.uncompressedSize);var Y=0;p&&(Y|=8),S||!O&&!y||(Y|=2048);var z=0,st=0;X&&(z|=16),I==="UNIX"?(st=798,z|=function(Q,gt){var Ct=Q;return Q||(Ct=gt?16893:33204),(65535&Ct)<<16}(T.unixPermissions,X)):(st=20,z|=function(Q){return 63&(Q||0)}(T.dosPermissions)),b=$.getUTCHours(),b<<=6,b|=$.getUTCMinutes(),b<<=5,b|=$.getUTCSeconds()/2,E=$.getUTCFullYear()-1980,E<<=4,E|=$.getUTCMonth()+1,E<<=5,E|=$.getUTCDate(),O&&(H=n(1,1)+n(h(_),4)+w,U+="up"+n(H.length,2)+H),y&&(k=n(1,1)+n(h(D),4)+R,U+="uc"+n(k.length,2)+k);var K="";return K+=`
\0`,K+=n(Y,2),K+=A.magic,K+=n(b,2),K+=n(E,2),K+=n(et.crc32,4),K+=n(et.compressedSize,4),K+=n(et.uncompressedSize,4),K+=n(_.length,2),K+=n(U.length,2),{fileRecord:u.LOCAL_FILE_HEADER+K+_+U,dirRecord:u.CENTRAL_FILE_HEADER+n(st,2)+K+n(D.length,2)+"\0\0\0\0"+n(z,4)+n(g,4)+_+U+D}}var a=e("../utils"),c=e("../stream/GenericWorker"),l=e("../utf8"),h=e("../crc32"),u=e("../signature");function d(f,p,m,g){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=m,this.encodeFileName=g,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(d,c),d.prototype.push=function(f){var p=f.meta.percent||0,m=this.entriesCount,g=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,c.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:m?(p+100*(m-g-1))/m:100}}))},d.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var p=this.streamFiles&&!f.file.dir;if(p){var m=o(f,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:m.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(f){this.accumulate=!1;var p=this.streamFiles&&!f.file.dir,m=o(f,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(m.dirRecord),p)this.push({data:function(g){return u.DATA_DESCRIPTOR+n(g.crc32,4)+n(g.compressedSize,4)+n(g.uncompressedSize,4)}(f),meta:{percent:100}});else for(this.push({data:m.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var f=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var m=this.bytesWritten-f,g=function(I,C,b,E,T){var A=a.transformTo("string",T(E));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(I,2)+n(I,2)+n(C,4)+n(b,4)+n(A.length,2)+A}(this.dirRecords.length,m,f,this.zipComment,this.encodeFileName);this.push({data:g,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(f){this._sources.push(f);var p=this;return f.on("data",function(m){p.processChunk(m)}),f.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),f.on("error",function(m){p.error(m)}),this},d.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(f){var p=this._sources;if(!c.prototype.error.call(this,f))return!1;for(var m=0;m<p.length;m++)try{p[m].error(f)}catch{}return!0},d.prototype.lock=function(){c.prototype.lock.call(this);for(var f=this._sources,p=0;p<f.length;p++)f[p].lock()},i.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,i,s){var n=e("../compressions"),o=e("./ZipFileWorker");s.generateWorker=function(a,c,l){var h=new o(c.streamFiles,l,c.platform,c.encodeFileName),u=0;try{a.forEach(function(d,f){u++;var p=function(C,b){var E=C||b,T=n[E];if(!T)throw new Error(E+" is not a valid compression method !");return T}(f.options.compression,c.compression),m=f.options.compressionOptions||c.compressionOptions||{},g=f.dir,I=f.date;f._compressWorker(p,m).withStreamInfo("file",{name:d,dir:g,date:I,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(h)}),h.entriesCount=u}catch(d){h.error(d)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,i,s){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new n;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(o,a){return new n().loadAsync(o,a)},n.external=e("./external"),i.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,i,s){var n=e("./utils"),o=e("./external"),a=e("./utf8"),c=e("./zipEntries"),l=e("./stream/Crc32Probe"),h=e("./nodejsUtils");function u(d){return new o.Promise(function(f,p){var m=d.decompressed.getContentWorker().pipe(new l);m.on("error",function(g){p(g)}).on("end",function(){m.streamInfo.crc32!==d.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}i.exports=function(d,f){var p=this;return f=n.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),h.isNode&&h.isStream(d)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",d,!0,f.optimizedBinaryString,f.base64).then(function(m){var g=new c(f);return g.load(m),g}).then(function(m){var g=[o.Promise.resolve(m)],I=m.files;if(f.checkCRC32)for(var C=0;C<I.length;C++)g.push(u(I[C]));return o.Promise.all(g)}).then(function(m){for(var g=m.shift(),I=g.files,C=0;C<I.length;C++){var b=I[C],E=b.fileNameStr,T=n.resolve(b.fileNameStr);p.file(T,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:f.createFolders}),b.dir||(p.file(T).unsafeOriginalName=E)}return g.zipComment.length&&(p.comment=g.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,i,s){var n=e("../utils"),o=e("../stream/GenericWorker");function a(c,l){o.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(l)}n.inherits(a,o),a.prototype._bindStream=function(c){var l=this;(this._stream=c).pause(),c.on("data",function(h){l.push({data:h,meta:{percent:0}})}).on("error",function(h){l.isPaused?this.generatedError=h:l.error(h)}).on("end",function(){l.isPaused?l._upstreamEnded=!0:l.end()})},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,i,s){var n=e("readable-stream").Readable;function o(a,c,l){n.call(this,c),this._helper=a;var h=this;a.on("data",function(u,d){h.push(u)||h._helper.pause(),l&&l(d)}).on("error",function(u){h.emit("error",u)}).on("end",function(){h.push(null)})}e("../utils").inherits(o,n),o.prototype._read=function(){this._helper.resume()},i.exports=o},{"../utils":32,"readable-stream":16}],14:[function(e,i,s){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,o);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,o)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var o=new Buffer(n);return o.fill(0),o},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(e,i,s){function n(T,A,S){var _,w=a.getTypeOf(A),F=a.extend(S||{},h);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(T=I(T)),F.createFolders&&(_=g(T))&&C.call(this,_,!0);var D=w==="string"&&F.binary===!1&&F.base64===!1;S&&S.binary!==void 0||(F.binary=!D),(A instanceof u&&A.uncompressedSize===0||F.dir||!A||A.length===0)&&(F.base64=!1,F.binary=!0,A="",F.compression="STORE",w="string");var R=null;R=A instanceof u||A instanceof c?A:p.isNode&&p.isStream(A)?new m(T,A):a.prepareContent(T,A,F.binary,F.optimizedBinaryString,F.base64);var O=new d(T,R,F);this.files[T]=O}var o=e("./utf8"),a=e("./utils"),c=e("./stream/GenericWorker"),l=e("./stream/StreamHelper"),h=e("./defaults"),u=e("./compressedObject"),d=e("./zipObject"),f=e("./generate"),p=e("./nodejsUtils"),m=e("./nodejs/NodejsStreamInputAdapter"),g=function(T){T.slice(-1)==="/"&&(T=T.substring(0,T.length-1));var A=T.lastIndexOf("/");return 0<A?T.substring(0,A):""},I=function(T){return T.slice(-1)!=="/"&&(T+="/"),T},C=function(T,A){return A=A!==void 0?A:h.createFolders,T=I(T),this.files[T]||n.call(this,T,null,{dir:!0,createFolders:A}),this.files[T]};function b(T){return Object.prototype.toString.call(T)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(T){var A,S,_;for(A in this.files)_=this.files[A],(S=A.slice(this.root.length,A.length))&&A.slice(0,this.root.length)===this.root&&T(S,_)},filter:function(T){var A=[];return this.forEach(function(S,_){T(S,_)&&A.push(_)}),A},file:function(T,A,S){if(arguments.length!==1)return T=this.root+T,n.call(this,T,A,S),this;if(b(T)){var _=T;return this.filter(function(F,D){return!D.dir&&_.test(F)})}var w=this.files[this.root+T];return w&&!w.dir?w:null},folder:function(T){if(!T)return this;if(b(T))return this.filter(function(w,F){return F.dir&&T.test(w)});var A=this.root+T,S=C.call(this,A),_=this.clone();return _.root=S.name,_},remove:function(T){T=this.root+T;var A=this.files[T];if(A||(T.slice(-1)!=="/"&&(T+="/"),A=this.files[T]),A&&!A.dir)delete this.files[T];else for(var S=this.filter(function(w,F){return F.name.slice(0,T.length)===T}),_=0;_<S.length;_++)delete this.files[S[_].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(T){var A,S={};try{if((S=a.extend(T||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=S.type.toLowerCase(),S.compression=S.compression.toUpperCase(),S.type==="binarystring"&&(S.type="string"),!S.type)throw new Error("No output type specified.");a.checkSupport(S.type),S.platform!=="darwin"&&S.platform!=="freebsd"&&S.platform!=="linux"&&S.platform!=="sunos"||(S.platform="UNIX"),S.platform==="win32"&&(S.platform="DOS");var _=S.comment||this.comment||"";A=f.generateWorker(this,S,_)}catch(w){(A=new c("error")).error(w)}return new l(A,S.type||"string",S.mimeType)},generateAsync:function(T,A){return this.generateInternalStream(T).accumulate(A)},generateNodeStream:function(T,A){return(T=T||{}).type||(T.type="nodebuffer"),this.generateInternalStream(T).toNodejsStream(A)}};i.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,i,s){i.exports=e("stream")},{stream:void 0}],17:[function(e,i,s){var n=e("./DataReader");function o(a){n.call(this,a);for(var c=0;c<this.data.length;c++)a[c]=255&a[c]}e("../utils").inherits(o,n),o.prototype.byteAt=function(a){return this.data[this.zero+a]},o.prototype.lastIndexOfSignature=function(a){for(var c=a.charCodeAt(0),l=a.charCodeAt(1),h=a.charCodeAt(2),u=a.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===c&&this.data[d+1]===l&&this.data[d+2]===h&&this.data[d+3]===u)return d-this.zero;return-1},o.prototype.readAndCheckSignature=function(a){var c=a.charCodeAt(0),l=a.charCodeAt(1),h=a.charCodeAt(2),u=a.charCodeAt(3),d=this.readData(4);return c===d[0]&&l===d[1]&&h===d[2]&&u===d[3]},o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},i.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,i,s){var n=e("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var c,l=0;for(this.checkOffset(a),c=this.index+a-1;c>=this.index;c--)l=(l<<8)+this.byteAt(c);return this.index+=a,l},readString:function(a){return n.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},i.exports=o},{"../utils":32}],19:[function(e,i,s){var n=e("./Uint8ArrayReader");function o(a){n.call(this,a)}e("../utils").inherits(o,n),o.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},i.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,i,s){var n=e("./DataReader");function o(a){n.call(this,a)}e("../utils").inherits(o,n),o.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},o.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},o.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},o.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},i.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,i,s){var n=e("./ArrayReader");function o(a){n.call(this,a)}e("../utils").inherits(o,n),o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},i.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,i,s){var n=e("../utils"),o=e("../support"),a=e("./ArrayReader"),c=e("./StringReader"),l=e("./NodeBufferReader"),h=e("./Uint8ArrayReader");i.exports=function(u){var d=n.getTypeOf(u);return n.checkSupport(d),d!=="string"||o.uint8array?d==="nodebuffer"?new l(u):o.uint8array?new h(n.transformTo("uint8array",u)):new a(n.transformTo("array",u)):new c(u)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,i,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,i,s){var n=e("./GenericWorker"),o=e("../utils");function a(c){n.call(this,"ConvertWorker to "+c),this.destType=c}o.inherits(a,n),a.prototype.processChunk=function(c){this.push({data:o.transformTo(this.destType,c.data),meta:c.meta})},i.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,i,s){var n=e("./GenericWorker"),o=e("../crc32");function a(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,n),a.prototype.processChunk=function(c){this.streamInfo.crc32=o(c.data,this.streamInfo.crc32||0),this.push(c)},i.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,i,s){var n=e("../utils"),o=e("./GenericWorker");function a(c){o.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}n.inherits(a,o),a.prototype.processChunk=function(c){if(c){var l=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=l+c.data.length}o.prototype.processChunk.call(this,c)},i.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,i,s){var n=e("../utils"),o=e("./GenericWorker");function a(c){o.call(this,"DataWorker");var l=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(h){l.dataIsReady=!0,l.data=h,l.max=h&&h.length||0,l.type=n.getTypeOf(h),l.isPaused||l._tickAndRepeat()},function(h){l.error(h)})}n.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,l=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,l);break;case"uint8array":c=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":c=this.data.slice(this.index,l)}return this.index=l,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,i,s){function n(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var c=0;c<this._listeners[o].length;c++)this._listeners[o][c].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(c){a.processChunk(c)}),o.on("end",function(){a.end()}),o.on("error",function(c){a.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},i.exports=n},{}],29:[function(e,i,s){var n=e("../utils"),o=e("./ConvertWorker"),a=e("./GenericWorker"),c=e("../base64"),l=e("../support"),h=e("../external"),u=null;if(l.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(p,m){return new h.Promise(function(g,I){var C=[],b=p._internalType,E=p._outputType,T=p._mimeType;p.on("data",function(A,S){C.push(A),m&&m(S)}).on("error",function(A){C=[],I(A)}).on("end",function(){try{var A=function(S,_,w){switch(S){case"blob":return n.newBlob(n.transformTo("arraybuffer",_),w);case"base64":return c.encode(_);default:return n.transformTo(S,_)}}(E,function(S,_){var w,F=0,D=null,R=0;for(w=0;w<_.length;w++)R+=_[w].length;switch(S){case"string":return _.join("");case"array":return Array.prototype.concat.apply([],_);case"uint8array":for(D=new Uint8Array(R),w=0;w<_.length;w++)D.set(_[w],F),F+=_[w].length;return D;case"nodebuffer":return Buffer.concat(_);default:throw new Error("concat : unsupported type '"+S+"'")}}(b,C),T);g(A)}catch(S){I(S)}C=[]}).resume()})}function f(p,m,g){var I=m;switch(m){case"blob":case"arraybuffer":I="uint8array";break;case"base64":I="string"}try{this._internalType=I,this._outputType=m,this._mimeType=g,n.checkSupport(I),this._worker=p.pipe(new o(I)),p.lock()}catch(C){this._worker=new a("error"),this._worker.error(C)}}f.prototype={accumulate:function(p){return d(this,p)},on:function(p,m){var g=this;return p==="data"?this._worker.on(p,function(I){m.call(g,I.data,I.meta)}):this._worker.on(p,function(){n.delay(m,arguments,g)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:this._outputType!=="nodebuffer"},p)}},i.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,i,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var n=new ArrayBuffer(0);try{s.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(n),s.blob=o.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!e("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(e,i,s){for(var n=e("./utils"),o=e("./support"),a=e("./nodejsUtils"),c=e("./stream/GenericWorker"),l=new Array(256),h=0;h<256;h++)l[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;l[254]=l[254]=1;function u(){c.call(this,"utf-8 decode"),this.leftOver=null}function d(){c.call(this,"utf-8 encode")}s.utf8encode=function(f){return o.nodebuffer?a.newBufferFrom(f,"utf-8"):function(p){var m,g,I,C,b,E=p.length,T=0;for(C=0;C<E;C++)(64512&(g=p.charCodeAt(C)))==55296&&C+1<E&&(64512&(I=p.charCodeAt(C+1)))==56320&&(g=65536+(g-55296<<10)+(I-56320),C++),T+=g<128?1:g<2048?2:g<65536?3:4;for(m=o.uint8array?new Uint8Array(T):new Array(T),C=b=0;b<T;C++)(64512&(g=p.charCodeAt(C)))==55296&&C+1<E&&(64512&(I=p.charCodeAt(C+1)))==56320&&(g=65536+(g-55296<<10)+(I-56320),C++),g<128?m[b++]=g:(g<2048?m[b++]=192|g>>>6:(g<65536?m[b++]=224|g>>>12:(m[b++]=240|g>>>18,m[b++]=128|g>>>12&63),m[b++]=128|g>>>6&63),m[b++]=128|63&g);return m}(f)},s.utf8decode=function(f){return o.nodebuffer?n.transformTo("nodebuffer",f).toString("utf-8"):function(p){var m,g,I,C,b=p.length,E=new Array(2*b);for(m=g=0;m<b;)if((I=p[m++])<128)E[g++]=I;else if(4<(C=l[I]))E[g++]=65533,m+=C-1;else{for(I&=C===2?31:C===3?15:7;1<C&&m<b;)I=I<<6|63&p[m++],C--;1<C?E[g++]=65533:I<65536?E[g++]=I:(I-=65536,E[g++]=55296|I>>10&1023,E[g++]=56320|1023&I)}return E.length!==g&&(E.subarray?E=E.subarray(0,g):E.length=g),n.applyFromCharCode(E)}(f=n.transformTo(o.uint8array?"uint8array":"array",f))},n.inherits(u,c),u.prototype.processChunk=function(f){var p=n.transformTo(o.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var m=p;(p=new Uint8Array(m.length+this.leftOver.length)).set(this.leftOver,0),p.set(m,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var g=function(C,b){var E;for((b=b||C.length)>C.length&&(b=C.length),E=b-1;0<=E&&(192&C[E])==128;)E--;return E<0||E===0?b:E+l[C[E]]>b?E:b}(p),I=p;g!==p.length&&(o.uint8array?(I=p.subarray(0,g),this.leftOver=p.subarray(g,p.length)):(I=p.slice(0,g),this.leftOver=p.slice(g,p.length))),this.push({data:s.utf8decode(I),meta:f.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=u,n.inherits(d,c),d.prototype.processChunk=function(f){this.push({data:s.utf8encode(f.data),meta:f.meta})},s.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,i,s){var n=e("./support"),o=e("./base64"),a=e("./nodejsUtils"),c=e("./external");function l(m){return m}function h(m,g){for(var I=0;I<m.length;++I)g[I]=255&m.charCodeAt(I);return g}e("setimmediate"),s.newBlob=function(m,g){s.checkSupport("blob");try{return new Blob([m],{type:g})}catch{try{var I=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return I.append(m),I.getBlob(g)}catch{throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(m,g,I){var C=[],b=0,E=m.length;if(E<=I)return String.fromCharCode.apply(null,m);for(;b<E;)g==="array"||g==="nodebuffer"?C.push(String.fromCharCode.apply(null,m.slice(b,Math.min(b+I,E)))):C.push(String.fromCharCode.apply(null,m.subarray(b,Math.min(b+I,E)))),b+=I;return C.join("")},stringifyByChar:function(m){for(var g="",I=0;I<m.length;I++)g+=String.fromCharCode(m[I]);return g},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function d(m){var g=65536,I=s.getTypeOf(m),C=!0;if(I==="uint8array"?C=u.applyCanBeUsed.uint8array:I==="nodebuffer"&&(C=u.applyCanBeUsed.nodebuffer),C)for(;1<g;)try{return u.stringifyByChunk(m,I,g)}catch{g=Math.floor(g/2)}return u.stringifyByChar(m)}function f(m,g){for(var I=0;I<m.length;I++)g[I]=m[I];return g}s.applyFromCharCode=d;var p={};p.string={string:l,array:function(m){return h(m,new Array(m.length))},arraybuffer:function(m){return p.string.uint8array(m).buffer},uint8array:function(m){return h(m,new Uint8Array(m.length))},nodebuffer:function(m){return h(m,a.allocBuffer(m.length))}},p.array={string:d,array:l,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return a.newBufferFrom(m)}},p.arraybuffer={string:function(m){return d(new Uint8Array(m))},array:function(m){return f(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:l,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return a.newBufferFrom(new Uint8Array(m))}},p.uint8array={string:d,array:function(m){return f(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:l,nodebuffer:function(m){return a.newBufferFrom(m)}},p.nodebuffer={string:d,array:function(m){return f(m,new Array(m.length))},arraybuffer:function(m){return p.nodebuffer.uint8array(m).buffer},uint8array:function(m){return f(m,new Uint8Array(m.length))},nodebuffer:l},s.transformTo=function(m,g){if(g=g||"",!m)return g;s.checkSupport(m);var I=s.getTypeOf(g);return p[I][m](g)},s.resolve=function(m){for(var g=m.split("/"),I=[],C=0;C<g.length;C++){var b=g[C];b==="."||b===""&&C!==0&&C!==g.length-1||(b===".."?I.pop():I.push(b))}return I.join("/")},s.getTypeOf=function(m){return typeof m=="string"?"string":Object.prototype.toString.call(m)==="[object Array]"?"array":n.nodebuffer&&a.isBuffer(m)?"nodebuffer":n.uint8array&&m instanceof Uint8Array?"uint8array":n.arraybuffer&&m instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(m){if(!n[m.toLowerCase()])throw new Error(m+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(m){var g,I,C="";for(I=0;I<(m||"").length;I++)C+="\\x"+((g=m.charCodeAt(I))<16?"0":"")+g.toString(16).toUpperCase();return C},s.delay=function(m,g,I){setImmediate(function(){m.apply(I||null,g||[])})},s.inherits=function(m,g){function I(){}I.prototype=g.prototype,m.prototype=new I},s.extend=function(){var m,g,I={};for(m=0;m<arguments.length;m++)for(g in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],g)&&I[g]===void 0&&(I[g]=arguments[m][g]);return I},s.prepareContent=function(m,g,I,C,b){return c.Promise.resolve(g).then(function(E){return n.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader<"u"?new c.Promise(function(T,A){var S=new FileReader;S.onload=function(_){T(_.target.result)},S.onerror=function(_){A(_.target.error)},S.readAsArrayBuffer(E)}):E}).then(function(E){var T=s.getTypeOf(E);return T?(T==="arraybuffer"?E=s.transformTo("uint8array",E):T==="string"&&(b?E=o.decode(E):I&&C!==!0&&(E=function(A){return h(A,n.uint8array?new Uint8Array(A.length):new Array(A.length))}(E))),E):c.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,i,s){var n=e("./reader/readerFor"),o=e("./utils"),a=e("./signature"),c=e("./zipEntry"),l=e("./support");function h(u){this.files=[],this.loadOptions=u}h.prototype={checkSignature:function(u){if(!this.reader.readAndCheckSignature(u)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(d)+", expected "+o.pretty(u)+")")}},isSignature:function(u,d){var f=this.reader.index;this.reader.setIndex(u);var p=this.reader.readString(4)===d;return this.reader.setIndex(f),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var u=this.reader.readData(this.zipCommentLength),d=l.uint8array?"uint8array":"array",f=o.transformTo(d,u);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var u,d,f,p=this.zip64EndOfCentralSize-44;0<p;)u=this.reader.readInt(2),d=this.reader.readInt(4),f=this.reader.readData(d),this.zip64ExtensibleData[u]={id:u,length:d,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var u,d;for(u=0;u<this.files.length;u++)d=this.files[u],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var u;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(u=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(u);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var u=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(u<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(u);var d=u;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(u=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(u),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var p=d-f;if(0<p)this.isSignature(d,a.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(u){this.reader=n(u)},load:function(u){this.prepareReader(u),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,i,s){var n=e("./reader/readerFor"),o=e("./utils"),a=e("./compressedObject"),c=e("./crc32"),l=e("./utf8"),h=e("./compressions"),u=e("./support");function d(f,p){this.options=f,this.loadOptions=p}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var p,m;if(f.skip(22),this.fileNameLength=f.readInt(2),m=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=function(g){for(var I in h)if(Object.prototype.hasOwnProperty.call(h,I)&&h[I].magic===g)return h[I];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,p,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var p=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(p),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=n(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var p,m,g,I=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<I;)p=f.readInt(2),m=f.readInt(2),g=f.readData(m),this.extraFields[p]={id:p,length:m,value:g};f.setIndex(I)},handleUTF8:function(){var f=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var m=o.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var g=this.findExtraFieldUnicodeComment();if(g!==null)this.fileCommentStr=g;else{var I=o.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(I)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var p=n(f.value);return p.readInt(1)!==1||c(this.fileName)!==p.readInt(4)?null:l.utf8decode(p.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var p=n(f.value);return p.readInt(1)!==1||c(this.fileComment)!==p.readInt(4)?null:l.utf8decode(p.readData(f.length-5))}return null}},i.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,i,s){function n(p,m,g){this.name=p,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=m,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}}var o=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),c=e("./utf8"),l=e("./compressedObject"),h=e("./stream/GenericWorker");n.prototype={internalStream:function(p){var m=null,g="string";try{if(!p)throw new Error("No output type specified.");var I=(g=p.toLowerCase())==="string"||g==="text";g!=="binarystring"&&g!=="text"||(g="string"),m=this._decompressWorker();var C=!this._dataBinary;C&&!I&&(m=m.pipe(new c.Utf8EncodeWorker)),!C&&I&&(m=m.pipe(new c.Utf8DecodeWorker))}catch(b){(m=new h("error")).error(b)}return new o(m,g,"")},async:function(p,m){return this.internalStream(p).accumulate(m)},nodeStream:function(p,m){return this.internalStream(p||"nodebuffer").toNodejsStream(m)},_compressWorker:function(p,m){if(this._data instanceof l&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new c.Utf8EncodeWorker)),l.createWorkerFrom(g,p,m)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof h?this._data:new a(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<u.length;f++)n.prototype[u[f]]=d;i.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,i,s){(function(n){var o,a,c=n.MutationObserver||n.WebKitMutationObserver;if(c){var l=0,h=new c(p),u=n.document.createTextNode("");h.observe(u,{characterData:!0}),o=function(){u.data=l=++l%2}}else if(n.setImmediate||n.MessageChannel===void 0)o="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var m=n.document.createElement("script");m.onreadystatechange=function(){p(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},n.document.documentElement.appendChild(m)}:function(){setTimeout(p,0)};else{var d=new n.MessageChannel;d.port1.onmessage=p,o=function(){d.port2.postMessage(0)}}var f=[];function p(){var m,g;a=!0;for(var I=f.length;I;){for(g=f,f=[],m=-1;++m<I;)g[m]();I=f.length}a=!1}i.exports=function(m){f.push(m)!==1||a||o()}}).call(this,typeof Ku<"u"?Ku:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,i,s){var n=e("immediate");function o(){}var a={},c=["REJECTED"],l=["FULFILLED"],h=["PENDING"];function u(I){if(typeof I!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,I!==o&&m(this,I)}function d(I,C,b){this.promise=I,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function f(I,C,b){n(function(){var E;try{E=C(b)}catch(T){return a.reject(I,T)}E===I?a.reject(I,new TypeError("Cannot resolve promise with itself")):a.resolve(I,E)})}function p(I){var C=I&&I.then;if(I&&(typeof I=="object"||typeof I=="function")&&typeof C=="function")return function(){C.apply(I,arguments)}}function m(I,C){var b=!1;function E(S){b||(b=!0,a.reject(I,S))}function T(S){b||(b=!0,a.resolve(I,S))}var A=g(function(){C(T,E)});A.status==="error"&&E(A.value)}function g(I,C){var b={};try{b.value=I(C),b.status="success"}catch(E){b.status="error",b.value=E}return b}(i.exports=u).prototype.finally=function(I){if(typeof I!="function")return this;var C=this.constructor;return this.then(function(b){return C.resolve(I()).then(function(){return b})},function(b){return C.resolve(I()).then(function(){throw b})})},u.prototype.catch=function(I){return this.then(null,I)},u.prototype.then=function(I,C){if(typeof I!="function"&&this.state===l||typeof C!="function"&&this.state===c)return this;var b=new this.constructor(o);return this.state!==h?f(b,this.state===l?I:C,this.outcome):this.queue.push(new d(b,I,C)),b},d.prototype.callFulfilled=function(I){a.resolve(this.promise,I)},d.prototype.otherCallFulfilled=function(I){f(this.promise,this.onFulfilled,I)},d.prototype.callRejected=function(I){a.reject(this.promise,I)},d.prototype.otherCallRejected=function(I){f(this.promise,this.onRejected,I)},a.resolve=function(I,C){var b=g(p,C);if(b.status==="error")return a.reject(I,b.value);var E=b.value;if(E)m(I,E);else{I.state=l,I.outcome=C;for(var T=-1,A=I.queue.length;++T<A;)I.queue[T].callFulfilled(C)}return I},a.reject=function(I,C){I.state=c,I.outcome=C;for(var b=-1,E=I.queue.length;++b<E;)I.queue[b].callRejected(C);return I},u.resolve=function(I){return I instanceof this?I:a.resolve(new this(o),I)},u.reject=function(I){var C=new this(o);return a.reject(C,I)},u.all=function(I){var C=this;if(Object.prototype.toString.call(I)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=I.length,E=!1;if(!b)return this.resolve([]);for(var T=new Array(b),A=0,S=-1,_=new this(o);++S<b;)w(I[S],S);return _;function w(F,D){C.resolve(F).then(function(R){T[D]=R,++A!==b||E||(E=!0,a.resolve(_,T))},function(R){E||(E=!0,a.reject(_,R))})}},u.race=function(I){var C=this;if(Object.prototype.toString.call(I)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=I.length,E=!1;if(!b)return this.resolve([]);for(var T=-1,A=new this(o);++T<b;)S=I[T],C.resolve(S).then(function(_){E||(E=!0,a.resolve(A,_))},function(_){E||(E=!0,a.reject(A,_))});var S;return A}},{immediate:36}],38:[function(e,i,s){var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),i.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,i,s){var n=e("./zlib/deflate"),o=e("./utils/common"),a=e("./utils/strings"),c=e("./zlib/messages"),l=e("./zlib/zstream"),h=Object.prototype.toString,u=0,d=-1,f=0,p=8;function m(I){if(!(this instanceof m))return new m(I);this.options=o.assign({level:d,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},I||{});var C=this.options;C.raw&&0<C.windowBits?C.windowBits=-C.windowBits:C.gzip&&0<C.windowBits&&C.windowBits<16&&(C.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var b=n.deflateInit2(this.strm,C.level,C.method,C.windowBits,C.memLevel,C.strategy);if(b!==u)throw new Error(c[b]);if(C.header&&n.deflateSetHeader(this.strm,C.header),C.dictionary){var E;if(E=typeof C.dictionary=="string"?a.string2buf(C.dictionary):h.call(C.dictionary)==="[object ArrayBuffer]"?new Uint8Array(C.dictionary):C.dictionary,(b=n.deflateSetDictionary(this.strm,E))!==u)throw new Error(c[b]);this._dict_set=!0}}function g(I,C){var b=new m(C);if(b.push(I,!0),b.err)throw b.msg||c[b.err];return b.result}m.prototype.push=function(I,C){var b,E,T=this.strm,A=this.options.chunkSize;if(this.ended)return!1;E=C===~~C?C:C===!0?4:0,typeof I=="string"?T.input=a.string2buf(I):h.call(I)==="[object ArrayBuffer]"?T.input=new Uint8Array(I):T.input=I,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new o.Buf8(A),T.next_out=0,T.avail_out=A),(b=n.deflate(T,E))!==1&&b!==u)return this.onEnd(b),!(this.ended=!0);T.avail_out!==0&&(T.avail_in!==0||E!==4&&E!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(T.output,T.next_out))):this.onData(o.shrinkBuf(T.output,T.next_out)))}while((0<T.avail_in||T.avail_out===0)&&b!==1);return E===4?(b=n.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===u):E!==2||(this.onEnd(u),!(T.avail_out=0))},m.prototype.onData=function(I){this.chunks.push(I)},m.prototype.onEnd=function(I){I===u&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=I,this.msg=this.strm.msg},s.Deflate=m,s.deflate=g,s.deflateRaw=function(I,C){return(C=C||{}).raw=!0,g(I,C)},s.gzip=function(I,C){return(C=C||{}).gzip=!0,g(I,C)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,i,s){var n=e("./zlib/inflate"),o=e("./utils/common"),a=e("./utils/strings"),c=e("./zlib/constants"),l=e("./zlib/messages"),h=e("./zlib/zstream"),u=e("./zlib/gzheader"),d=Object.prototype.toString;function f(m){if(!(this instanceof f))return new f(m);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},m||{});var g=this.options;g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),!(0<=g.windowBits&&g.windowBits<16)||m&&m.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&!(15&g.windowBits)&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var I=n.inflateInit2(this.strm,g.windowBits);if(I!==c.Z_OK)throw new Error(l[I]);this.header=new u,n.inflateGetHeader(this.strm,this.header)}function p(m,g){var I=new f(g);if(I.push(m,!0),I.err)throw I.msg||l[I.err];return I.result}f.prototype.push=function(m,g){var I,C,b,E,T,A,S=this.strm,_=this.options.chunkSize,w=this.options.dictionary,F=!1;if(this.ended)return!1;C=g===~~g?g:g===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof m=="string"?S.input=a.binstring2buf(m):d.call(m)==="[object ArrayBuffer]"?S.input=new Uint8Array(m):S.input=m,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new o.Buf8(_),S.next_out=0,S.avail_out=_),(I=n.inflate(S,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&w&&(A=typeof w=="string"?a.string2buf(w):d.call(w)==="[object ArrayBuffer]"?new Uint8Array(w):w,I=n.inflateSetDictionary(this.strm,A)),I===c.Z_BUF_ERROR&&F===!0&&(I=c.Z_OK,F=!1),I!==c.Z_STREAM_END&&I!==c.Z_OK)return this.onEnd(I),!(this.ended=!0);S.next_out&&(S.avail_out!==0&&I!==c.Z_STREAM_END&&(S.avail_in!==0||C!==c.Z_FINISH&&C!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=a.utf8border(S.output,S.next_out),E=S.next_out-b,T=a.buf2string(S.output,b),S.next_out=E,S.avail_out=_-E,E&&o.arraySet(S.output,S.output,b,E,0),this.onData(T)):this.onData(o.shrinkBuf(S.output,S.next_out)))),S.avail_in===0&&S.avail_out===0&&(F=!0)}while((0<S.avail_in||S.avail_out===0)&&I!==c.Z_STREAM_END);return I===c.Z_STREAM_END&&(C=c.Z_FINISH),C===c.Z_FINISH?(I=n.inflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===c.Z_OK):C!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(S.avail_out=0))},f.prototype.onData=function(m){this.chunks.push(m)},f.prototype.onEnd=function(m){m===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},s.Inflate=f,s.inflate=p,s.inflateRaw=function(m,g){return(g=g||{}).raw=!0,p(m,g)},s.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,i,s){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(c){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var h=l.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var u in h)h.hasOwnProperty(u)&&(c[u]=h[u])}}return c},s.shrinkBuf=function(c,l){return c.length===l?c:c.subarray?c.subarray(0,l):(c.length=l,c)};var o={arraySet:function(c,l,h,u,d){if(l.subarray&&c.subarray)c.set(l.subarray(h,h+u),d);else for(var f=0;f<u;f++)c[d+f]=l[h+f]},flattenChunks:function(c){var l,h,u,d,f,p;for(l=u=0,h=c.length;l<h;l++)u+=c[l].length;for(p=new Uint8Array(u),l=d=0,h=c.length;l<h;l++)f=c[l],p.set(f,d),d+=f.length;return p}},a={arraySet:function(c,l,h,u,d){for(var f=0;f<u;f++)c[d+f]=l[h+f]},flattenChunks:function(c){return[].concat.apply([],c)}};s.setTyped=function(c){c?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,o)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,a))},s.setTyped(n)},{}],42:[function(e,i,s){var n=e("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var c=new n.Buf8(256),l=0;l<256;l++)c[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function h(u,d){if(d<65537&&(u.subarray&&a||!u.subarray&&o))return String.fromCharCode.apply(null,n.shrinkBuf(u,d));for(var f="",p=0;p<d;p++)f+=String.fromCharCode(u[p]);return f}c[254]=c[254]=1,s.string2buf=function(u){var d,f,p,m,g,I=u.length,C=0;for(m=0;m<I;m++)(64512&(f=u.charCodeAt(m)))==55296&&m+1<I&&(64512&(p=u.charCodeAt(m+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),m++),C+=f<128?1:f<2048?2:f<65536?3:4;for(d=new n.Buf8(C),m=g=0;g<C;m++)(64512&(f=u.charCodeAt(m)))==55296&&m+1<I&&(64512&(p=u.charCodeAt(m+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),m++),f<128?d[g++]=f:(f<2048?d[g++]=192|f>>>6:(f<65536?d[g++]=224|f>>>12:(d[g++]=240|f>>>18,d[g++]=128|f>>>12&63),d[g++]=128|f>>>6&63),d[g++]=128|63&f);return d},s.buf2binstring=function(u){return h(u,u.length)},s.binstring2buf=function(u){for(var d=new n.Buf8(u.length),f=0,p=d.length;f<p;f++)d[f]=u.charCodeAt(f);return d},s.buf2string=function(u,d){var f,p,m,g,I=d||u.length,C=new Array(2*I);for(f=p=0;f<I;)if((m=u[f++])<128)C[p++]=m;else if(4<(g=c[m]))C[p++]=65533,f+=g-1;else{for(m&=g===2?31:g===3?15:7;1<g&&f<I;)m=m<<6|63&u[f++],g--;1<g?C[p++]=65533:m<65536?C[p++]=m:(m-=65536,C[p++]=55296|m>>10&1023,C[p++]=56320|1023&m)}return h(C,p)},s.utf8border=function(u,d){var f;for((d=d||u.length)>u.length&&(d=u.length),f=d-1;0<=f&&(192&u[f])==128;)f--;return f<0||f===0?d:f+c[u[f]]>d?f:d}},{"./common":41}],43:[function(e,i,s){i.exports=function(n,o,a,c){for(var l=65535&n|0,h=n>>>16&65535|0,u=0;a!==0;){for(a-=u=2e3<a?2e3:a;h=h+(l=l+o[c++]|0)|0,--u;);l%=65521,h%=65521}return l|h<<16|0}},{}],44:[function(e,i,s){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,i,s){var n=function(){for(var o,a=[],c=0;c<256;c++){o=c;for(var l=0;l<8;l++)o=1&o?3988292384^o>>>1:o>>>1;a[c]=o}return a}();i.exports=function(o,a,c,l){var h=n,u=l+c;o^=-1;for(var d=l;d<u;d++)o=o>>>8^h[255&(o^a[d])];return-1^o}},{}],46:[function(e,i,s){var n,o=e("../utils/common"),a=e("./trees"),c=e("./adler32"),l=e("./crc32"),h=e("./messages"),u=0,d=4,f=0,p=-2,m=-1,g=4,I=2,C=8,b=9,E=286,T=30,A=19,S=2*E+1,_=15,w=3,F=258,D=F+w+1,R=42,O=113,y=1,U=2,H=3,k=4;function X(v,j){return v.msg=h[j],j}function $(v){return(v<<1)-(4<v?9:0)}function et(v){for(var j=v.length;0<=--j;)v[j]=0}function Y(v){var j=v.state,W=j.pending;W>v.avail_out&&(W=v.avail_out),W!==0&&(o.arraySet(v.output,j.pending_buf,j.pending_out,W,v.next_out),v.next_out+=W,j.pending_out+=W,v.total_out+=W,v.avail_out-=W,j.pending-=W,j.pending===0&&(j.pending_out=0))}function z(v,j){a._tr_flush_block(v,0<=v.block_start?v.block_start:-1,v.strstart-v.block_start,j),v.block_start=v.strstart,Y(v.strm)}function st(v,j){v.pending_buf[v.pending++]=j}function K(v,j){v.pending_buf[v.pending++]=j>>>8&255,v.pending_buf[v.pending++]=255&j}function Q(v,j){var W,N,x=v.max_chain_length,V=v.strstart,Z=v.prev_length,q=v.nice_match,G=v.strstart>v.w_size-D?v.strstart-(v.w_size-D):0,J=v.window,ot=v.w_mask,tt=v.prev,ft=v.strstart+F,At=J[V+Z-1],bt=J[V+Z];v.prev_length>=v.good_match&&(x>>=2),q>v.lookahead&&(q=v.lookahead);do if(J[(W=j)+Z]===bt&&J[W+Z-1]===At&&J[W]===J[V]&&J[++W]===J[V+1]){V+=2,W++;do;while(J[++V]===J[++W]&&J[++V]===J[++W]&&J[++V]===J[++W]&&J[++V]===J[++W]&&J[++V]===J[++W]&&J[++V]===J[++W]&&J[++V]===J[++W]&&J[++V]===J[++W]&&V<ft);if(N=F-(ft-V),V=ft-F,Z<N){if(v.match_start=j,q<=(Z=N))break;At=J[V+Z-1],bt=J[V+Z]}}while((j=tt[j&ot])>G&&--x!=0);return Z<=v.lookahead?Z:v.lookahead}function gt(v){var j,W,N,x,V,Z,q,G,J,ot,tt=v.w_size;do{if(x=v.window_size-v.lookahead-v.strstart,v.strstart>=tt+(tt-D)){for(o.arraySet(v.window,v.window,tt,tt,0),v.match_start-=tt,v.strstart-=tt,v.block_start-=tt,j=W=v.hash_size;N=v.head[--j],v.head[j]=tt<=N?N-tt:0,--W;);for(j=W=tt;N=v.prev[--j],v.prev[j]=tt<=N?N-tt:0,--W;);x+=tt}if(v.strm.avail_in===0)break;if(Z=v.strm,q=v.window,G=v.strstart+v.lookahead,J=x,ot=void 0,ot=Z.avail_in,J<ot&&(ot=J),W=ot===0?0:(Z.avail_in-=ot,o.arraySet(q,Z.input,Z.next_in,ot,G),Z.state.wrap===1?Z.adler=c(Z.adler,q,ot,G):Z.state.wrap===2&&(Z.adler=l(Z.adler,q,ot,G)),Z.next_in+=ot,Z.total_in+=ot,ot),v.lookahead+=W,v.lookahead+v.insert>=w)for(V=v.strstart-v.insert,v.ins_h=v.window[V],v.ins_h=(v.ins_h<<v.hash_shift^v.window[V+1])&v.hash_mask;v.insert&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[V+w-1])&v.hash_mask,v.prev[V&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=V,V++,v.insert--,!(v.lookahead+v.insert<w)););}while(v.lookahead<D&&v.strm.avail_in!==0)}function Ct(v,j){for(var W,N;;){if(v.lookahead<D){if(gt(v),v.lookahead<D&&j===u)return y;if(v.lookahead===0)break}if(W=0,v.lookahead>=w&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+w-1])&v.hash_mask,W=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),W!==0&&v.strstart-W<=v.w_size-D&&(v.match_length=Q(v,W)),v.match_length>=w)if(N=a._tr_tally(v,v.strstart-v.match_start,v.match_length-w),v.lookahead-=v.match_length,v.match_length<=v.max_lazy_match&&v.lookahead>=w){for(v.match_length--;v.strstart++,v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+w-1])&v.hash_mask,W=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart,--v.match_length!=0;);v.strstart++}else v.strstart+=v.match_length,v.match_length=0,v.ins_h=v.window[v.strstart],v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+1])&v.hash_mask;else N=a._tr_tally(v,0,v.window[v.strstart]),v.lookahead--,v.strstart++;if(N&&(z(v,!1),v.strm.avail_out===0))return y}return v.insert=v.strstart<w-1?v.strstart:w-1,j===d?(z(v,!0),v.strm.avail_out===0?H:k):v.last_lit&&(z(v,!1),v.strm.avail_out===0)?y:U}function lt(v,j){for(var W,N,x;;){if(v.lookahead<D){if(gt(v),v.lookahead<D&&j===u)return y;if(v.lookahead===0)break}if(W=0,v.lookahead>=w&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+w-1])&v.hash_mask,W=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),v.prev_length=v.match_length,v.prev_match=v.match_start,v.match_length=w-1,W!==0&&v.prev_length<v.max_lazy_match&&v.strstart-W<=v.w_size-D&&(v.match_length=Q(v,W),v.match_length<=5&&(v.strategy===1||v.match_length===w&&4096<v.strstart-v.match_start)&&(v.match_length=w-1)),v.prev_length>=w&&v.match_length<=v.prev_length){for(x=v.strstart+v.lookahead-w,N=a._tr_tally(v,v.strstart-1-v.prev_match,v.prev_length-w),v.lookahead-=v.prev_length-1,v.prev_length-=2;++v.strstart<=x&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+w-1])&v.hash_mask,W=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),--v.prev_length!=0;);if(v.match_available=0,v.match_length=w-1,v.strstart++,N&&(z(v,!1),v.strm.avail_out===0))return y}else if(v.match_available){if((N=a._tr_tally(v,0,v.window[v.strstart-1]))&&z(v,!1),v.strstart++,v.lookahead--,v.strm.avail_out===0)return y}else v.match_available=1,v.strstart++,v.lookahead--}return v.match_available&&(N=a._tr_tally(v,0,v.window[v.strstart-1]),v.match_available=0),v.insert=v.strstart<w-1?v.strstart:w-1,j===d?(z(v,!0),v.strm.avail_out===0?H:k):v.last_lit&&(z(v,!1),v.strm.avail_out===0)?y:U}function pt(v,j,W,N,x){this.good_length=v,this.max_lazy=j,this.nice_length=W,this.max_chain=N,this.func=x}function mt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=C,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*S),this.dyn_dtree=new o.Buf16(2*(2*T+1)),this.bl_tree=new o.Buf16(2*(2*A+1)),et(this.dyn_ltree),et(this.dyn_dtree),et(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(_+1),this.heap=new o.Buf16(2*E+1),et(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*E+1),et(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function yt(v){var j;return v&&v.state?(v.total_in=v.total_out=0,v.data_type=I,(j=v.state).pending=0,j.pending_out=0,j.wrap<0&&(j.wrap=-j.wrap),j.status=j.wrap?R:O,v.adler=j.wrap===2?0:1,j.last_flush=u,a._tr_init(j),f):X(v,p)}function zt(v){var j=yt(v);return j===f&&function(W){W.window_size=2*W.w_size,et(W.head),W.max_lazy_match=n[W.level].max_lazy,W.good_match=n[W.level].good_length,W.nice_match=n[W.level].nice_length,W.max_chain_length=n[W.level].max_chain,W.strstart=0,W.block_start=0,W.lookahead=0,W.insert=0,W.match_length=W.prev_length=w-1,W.match_available=0,W.ins_h=0}(v.state),j}function Lt(v,j,W,N,x,V){if(!v)return p;var Z=1;if(j===m&&(j=6),N<0?(Z=0,N=-N):15<N&&(Z=2,N-=16),x<1||b<x||W!==C||N<8||15<N||j<0||9<j||V<0||g<V)return X(v,p);N===8&&(N=9);var q=new mt;return(v.state=q).strm=v,q.wrap=Z,q.gzhead=null,q.w_bits=N,q.w_size=1<<q.w_bits,q.w_mask=q.w_size-1,q.hash_bits=x+7,q.hash_size=1<<q.hash_bits,q.hash_mask=q.hash_size-1,q.hash_shift=~~((q.hash_bits+w-1)/w),q.window=new o.Buf8(2*q.w_size),q.head=new o.Buf16(q.hash_size),q.prev=new o.Buf16(q.w_size),q.lit_bufsize=1<<x+6,q.pending_buf_size=4*q.lit_bufsize,q.pending_buf=new o.Buf8(q.pending_buf_size),q.d_buf=1*q.lit_bufsize,q.l_buf=3*q.lit_bufsize,q.level=j,q.strategy=V,q.method=W,zt(v)}n=[new pt(0,0,0,0,function(v,j){var W=65535;for(W>v.pending_buf_size-5&&(W=v.pending_buf_size-5);;){if(v.lookahead<=1){if(gt(v),v.lookahead===0&&j===u)return y;if(v.lookahead===0)break}v.strstart+=v.lookahead,v.lookahead=0;var N=v.block_start+W;if((v.strstart===0||v.strstart>=N)&&(v.lookahead=v.strstart-N,v.strstart=N,z(v,!1),v.strm.avail_out===0)||v.strstart-v.block_start>=v.w_size-D&&(z(v,!1),v.strm.avail_out===0))return y}return v.insert=0,j===d?(z(v,!0),v.strm.avail_out===0?H:k):(v.strstart>v.block_start&&(z(v,!1),v.strm.avail_out),y)}),new pt(4,4,8,4,Ct),new pt(4,5,16,8,Ct),new pt(4,6,32,32,Ct),new pt(4,4,16,16,lt),new pt(8,16,32,32,lt),new pt(8,16,128,128,lt),new pt(8,32,128,256,lt),new pt(32,128,258,1024,lt),new pt(32,258,258,4096,lt)],s.deflateInit=function(v,j){return Lt(v,j,C,15,8,0)},s.deflateInit2=Lt,s.deflateReset=zt,s.deflateResetKeep=yt,s.deflateSetHeader=function(v,j){return v&&v.state?v.state.wrap!==2?p:(v.state.gzhead=j,f):p},s.deflate=function(v,j){var W,N,x,V;if(!v||!v.state||5<j||j<0)return v?X(v,p):p;if(N=v.state,!v.output||!v.input&&v.avail_in!==0||N.status===666&&j!==d)return X(v,v.avail_out===0?-5:p);if(N.strm=v,W=N.last_flush,N.last_flush=j,N.status===R)if(N.wrap===2)v.adler=0,st(N,31),st(N,139),st(N,8),N.gzhead?(st(N,(N.gzhead.text?1:0)+(N.gzhead.hcrc?2:0)+(N.gzhead.extra?4:0)+(N.gzhead.name?8:0)+(N.gzhead.comment?16:0)),st(N,255&N.gzhead.time),st(N,N.gzhead.time>>8&255),st(N,N.gzhead.time>>16&255),st(N,N.gzhead.time>>24&255),st(N,N.level===9?2:2<=N.strategy||N.level<2?4:0),st(N,255&N.gzhead.os),N.gzhead.extra&&N.gzhead.extra.length&&(st(N,255&N.gzhead.extra.length),st(N,N.gzhead.extra.length>>8&255)),N.gzhead.hcrc&&(v.adler=l(v.adler,N.pending_buf,N.pending,0)),N.gzindex=0,N.status=69):(st(N,0),st(N,0),st(N,0),st(N,0),st(N,0),st(N,N.level===9?2:2<=N.strategy||N.level<2?4:0),st(N,3),N.status=O);else{var Z=C+(N.w_bits-8<<4)<<8;Z|=(2<=N.strategy||N.level<2?0:N.level<6?1:N.level===6?2:3)<<6,N.strstart!==0&&(Z|=32),Z+=31-Z%31,N.status=O,K(N,Z),N.strstart!==0&&(K(N,v.adler>>>16),K(N,65535&v.adler)),v.adler=1}if(N.status===69)if(N.gzhead.extra){for(x=N.pending;N.gzindex<(65535&N.gzhead.extra.length)&&(N.pending!==N.pending_buf_size||(N.gzhead.hcrc&&N.pending>x&&(v.adler=l(v.adler,N.pending_buf,N.pending-x,x)),Y(v),x=N.pending,N.pending!==N.pending_buf_size));)st(N,255&N.gzhead.extra[N.gzindex]),N.gzindex++;N.gzhead.hcrc&&N.pending>x&&(v.adler=l(v.adler,N.pending_buf,N.pending-x,x)),N.gzindex===N.gzhead.extra.length&&(N.gzindex=0,N.status=73)}else N.status=73;if(N.status===73)if(N.gzhead.name){x=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>x&&(v.adler=l(v.adler,N.pending_buf,N.pending-x,x)),Y(v),x=N.pending,N.pending===N.pending_buf_size)){V=1;break}V=N.gzindex<N.gzhead.name.length?255&N.gzhead.name.charCodeAt(N.gzindex++):0,st(N,V)}while(V!==0);N.gzhead.hcrc&&N.pending>x&&(v.adler=l(v.adler,N.pending_buf,N.pending-x,x)),V===0&&(N.gzindex=0,N.status=91)}else N.status=91;if(N.status===91)if(N.gzhead.comment){x=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>x&&(v.adler=l(v.adler,N.pending_buf,N.pending-x,x)),Y(v),x=N.pending,N.pending===N.pending_buf_size)){V=1;break}V=N.gzindex<N.gzhead.comment.length?255&N.gzhead.comment.charCodeAt(N.gzindex++):0,st(N,V)}while(V!==0);N.gzhead.hcrc&&N.pending>x&&(v.adler=l(v.adler,N.pending_buf,N.pending-x,x)),V===0&&(N.status=103)}else N.status=103;if(N.status===103&&(N.gzhead.hcrc?(N.pending+2>N.pending_buf_size&&Y(v),N.pending+2<=N.pending_buf_size&&(st(N,255&v.adler),st(N,v.adler>>8&255),v.adler=0,N.status=O)):N.status=O),N.pending!==0){if(Y(v),v.avail_out===0)return N.last_flush=-1,f}else if(v.avail_in===0&&$(j)<=$(W)&&j!==d)return X(v,-5);if(N.status===666&&v.avail_in!==0)return X(v,-5);if(v.avail_in!==0||N.lookahead!==0||j!==u&&N.status!==666){var q=N.strategy===2?function(G,J){for(var ot;;){if(G.lookahead===0&&(gt(G),G.lookahead===0)){if(J===u)return y;break}if(G.match_length=0,ot=a._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++,ot&&(z(G,!1),G.strm.avail_out===0))return y}return G.insert=0,J===d?(z(G,!0),G.strm.avail_out===0?H:k):G.last_lit&&(z(G,!1),G.strm.avail_out===0)?y:U}(N,j):N.strategy===3?function(G,J){for(var ot,tt,ft,At,bt=G.window;;){if(G.lookahead<=F){if(gt(G),G.lookahead<=F&&J===u)return y;if(G.lookahead===0)break}if(G.match_length=0,G.lookahead>=w&&0<G.strstart&&(tt=bt[ft=G.strstart-1])===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]){At=G.strstart+F;do;while(tt===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]&&ft<At);G.match_length=F-(At-ft),G.match_length>G.lookahead&&(G.match_length=G.lookahead)}if(G.match_length>=w?(ot=a._tr_tally(G,1,G.match_length-w),G.lookahead-=G.match_length,G.strstart+=G.match_length,G.match_length=0):(ot=a._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++),ot&&(z(G,!1),G.strm.avail_out===0))return y}return G.insert=0,J===d?(z(G,!0),G.strm.avail_out===0?H:k):G.last_lit&&(z(G,!1),G.strm.avail_out===0)?y:U}(N,j):n[N.level].func(N,j);if(q!==H&&q!==k||(N.status=666),q===y||q===H)return v.avail_out===0&&(N.last_flush=-1),f;if(q===U&&(j===1?a._tr_align(N):j!==5&&(a._tr_stored_block(N,0,0,!1),j===3&&(et(N.head),N.lookahead===0&&(N.strstart=0,N.block_start=0,N.insert=0))),Y(v),v.avail_out===0))return N.last_flush=-1,f}return j!==d?f:N.wrap<=0?1:(N.wrap===2?(st(N,255&v.adler),st(N,v.adler>>8&255),st(N,v.adler>>16&255),st(N,v.adler>>24&255),st(N,255&v.total_in),st(N,v.total_in>>8&255),st(N,v.total_in>>16&255),st(N,v.total_in>>24&255)):(K(N,v.adler>>>16),K(N,65535&v.adler)),Y(v),0<N.wrap&&(N.wrap=-N.wrap),N.pending!==0?f:1)},s.deflateEnd=function(v){var j;return v&&v.state?(j=v.state.status)!==R&&j!==69&&j!==73&&j!==91&&j!==103&&j!==O&&j!==666?X(v,p):(v.state=null,j===O?X(v,-3):f):p},s.deflateSetDictionary=function(v,j){var W,N,x,V,Z,q,G,J,ot=j.length;if(!v||!v.state||(V=(W=v.state).wrap)===2||V===1&&W.status!==R||W.lookahead)return p;for(V===1&&(v.adler=c(v.adler,j,ot,0)),W.wrap=0,ot>=W.w_size&&(V===0&&(et(W.head),W.strstart=0,W.block_start=0,W.insert=0),J=new o.Buf8(W.w_size),o.arraySet(J,j,ot-W.w_size,W.w_size,0),j=J,ot=W.w_size),Z=v.avail_in,q=v.next_in,G=v.input,v.avail_in=ot,v.next_in=0,v.input=j,gt(W);W.lookahead>=w;){for(N=W.strstart,x=W.lookahead-(w-1);W.ins_h=(W.ins_h<<W.hash_shift^W.window[N+w-1])&W.hash_mask,W.prev[N&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=N,N++,--x;);W.strstart=N,W.lookahead=w-1,gt(W)}return W.strstart+=W.lookahead,W.block_start=W.strstart,W.insert=W.lookahead,W.lookahead=0,W.match_length=W.prev_length=w-1,W.match_available=0,v.next_in=q,v.input=G,v.avail_in=Z,W.wrap=V,f},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,i,s){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,i,s){i.exports=function(n,o){var a,c,l,h,u,d,f,p,m,g,I,C,b,E,T,A,S,_,w,F,D,R,O,y,U;a=n.state,c=n.next_in,y=n.input,l=c+(n.avail_in-5),h=n.next_out,U=n.output,u=h-(o-n.avail_out),d=h+(n.avail_out-257),f=a.dmax,p=a.wsize,m=a.whave,g=a.wnext,I=a.window,C=a.hold,b=a.bits,E=a.lencode,T=a.distcode,A=(1<<a.lenbits)-1,S=(1<<a.distbits)-1;t:do{b<15&&(C+=y[c++]<<b,b+=8,C+=y[c++]<<b,b+=8),_=E[C&A];e:for(;;){if(C>>>=w=_>>>24,b-=w,(w=_>>>16&255)===0)U[h++]=65535&_;else{if(!(16&w)){if(!(64&w)){_=E[(65535&_)+(C&(1<<w)-1)];continue e}if(32&w){a.mode=12;break t}n.msg="invalid literal/length code",a.mode=30;break t}F=65535&_,(w&=15)&&(b<w&&(C+=y[c++]<<b,b+=8),F+=C&(1<<w)-1,C>>>=w,b-=w),b<15&&(C+=y[c++]<<b,b+=8,C+=y[c++]<<b,b+=8),_=T[C&S];i:for(;;){if(C>>>=w=_>>>24,b-=w,!(16&(w=_>>>16&255))){if(!(64&w)){_=T[(65535&_)+(C&(1<<w)-1)];continue i}n.msg="invalid distance code",a.mode=30;break t}if(D=65535&_,b<(w&=15)&&(C+=y[c++]<<b,(b+=8)<w&&(C+=y[c++]<<b,b+=8)),f<(D+=C&(1<<w)-1)){n.msg="invalid distance too far back",a.mode=30;break t}if(C>>>=w,b-=w,(w=h-u)<D){if(m<(w=D-w)&&a.sane){n.msg="invalid distance too far back",a.mode=30;break t}if(O=I,(R=0)===g){if(R+=p-w,w<F){for(F-=w;U[h++]=I[R++],--w;);R=h-D,O=U}}else if(g<w){if(R+=p+g-w,(w-=g)<F){for(F-=w;U[h++]=I[R++],--w;);if(R=0,g<F){for(F-=w=g;U[h++]=I[R++],--w;);R=h-D,O=U}}}else if(R+=g-w,w<F){for(F-=w;U[h++]=I[R++],--w;);R=h-D,O=U}for(;2<F;)U[h++]=O[R++],U[h++]=O[R++],U[h++]=O[R++],F-=3;F&&(U[h++]=O[R++],1<F&&(U[h++]=O[R++]))}else{for(R=h-D;U[h++]=U[R++],U[h++]=U[R++],U[h++]=U[R++],2<(F-=3););F&&(U[h++]=U[R++],1<F&&(U[h++]=U[R++]))}break}}break}}while(c<l&&h<d);c-=F=b>>3,C&=(1<<(b-=F<<3))-1,n.next_in=c,n.next_out=h,n.avail_in=c<l?l-c+5:5-(c-l),n.avail_out=h<d?d-h+257:257-(h-d),a.hold=C,a.bits=b}},{}],49:[function(e,i,s){var n=e("../utils/common"),o=e("./adler32"),a=e("./crc32"),c=e("./inffast"),l=e("./inftrees"),h=1,u=2,d=0,f=-2,p=1,m=852,g=592;function I(R){return(R>>>24&255)+(R>>>8&65280)+((65280&R)<<8)+((255&R)<<24)}function C(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(R){var O;return R&&R.state?(O=R.state,R.total_in=R.total_out=O.total=0,R.msg="",O.wrap&&(R.adler=1&O.wrap),O.mode=p,O.last=0,O.havedict=0,O.dmax=32768,O.head=null,O.hold=0,O.bits=0,O.lencode=O.lendyn=new n.Buf32(m),O.distcode=O.distdyn=new n.Buf32(g),O.sane=1,O.back=-1,d):f}function E(R){var O;return R&&R.state?((O=R.state).wsize=0,O.whave=0,O.wnext=0,b(R)):f}function T(R,O){var y,U;return R&&R.state?(U=R.state,O<0?(y=0,O=-O):(y=1+(O>>4),O<48&&(O&=15)),O&&(O<8||15<O)?f:(U.window!==null&&U.wbits!==O&&(U.window=null),U.wrap=y,U.wbits=O,E(R))):f}function A(R,O){var y,U;return R?(U=new C,(R.state=U).window=null,(y=T(R,O))!==d&&(R.state=null),y):f}var S,_,w=!0;function F(R){if(w){var O;for(S=new n.Buf32(512),_=new n.Buf32(32),O=0;O<144;)R.lens[O++]=8;for(;O<256;)R.lens[O++]=9;for(;O<280;)R.lens[O++]=7;for(;O<288;)R.lens[O++]=8;for(l(h,R.lens,0,288,S,0,R.work,{bits:9}),O=0;O<32;)R.lens[O++]=5;l(u,R.lens,0,32,_,0,R.work,{bits:5}),w=!1}R.lencode=S,R.lenbits=9,R.distcode=_,R.distbits=5}function D(R,O,y,U){var H,k=R.state;return k.window===null&&(k.wsize=1<<k.wbits,k.wnext=0,k.whave=0,k.window=new n.Buf8(k.wsize)),U>=k.wsize?(n.arraySet(k.window,O,y-k.wsize,k.wsize,0),k.wnext=0,k.whave=k.wsize):(U<(H=k.wsize-k.wnext)&&(H=U),n.arraySet(k.window,O,y-U,H,k.wnext),(U-=H)?(n.arraySet(k.window,O,y-U,U,0),k.wnext=U,k.whave=k.wsize):(k.wnext+=H,k.wnext===k.wsize&&(k.wnext=0),k.whave<k.wsize&&(k.whave+=H))),0}s.inflateReset=E,s.inflateReset2=T,s.inflateResetKeep=b,s.inflateInit=function(R){return A(R,15)},s.inflateInit2=A,s.inflate=function(R,O){var y,U,H,k,X,$,et,Y,z,st,K,Q,gt,Ct,lt,pt,mt,yt,zt,Lt,v,j,W,N,x=0,V=new n.Buf8(4),Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!R||!R.state||!R.output||!R.input&&R.avail_in!==0)return f;(y=R.state).mode===12&&(y.mode=13),X=R.next_out,H=R.output,et=R.avail_out,k=R.next_in,U=R.input,$=R.avail_in,Y=y.hold,z=y.bits,st=$,K=et,j=d;t:for(;;)switch(y.mode){case p:if(y.wrap===0){y.mode=13;break}for(;z<16;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(2&y.wrap&&Y===35615){V[y.check=0]=255&Y,V[1]=Y>>>8&255,y.check=a(y.check,V,2,0),z=Y=0,y.mode=2;break}if(y.flags=0,y.head&&(y.head.done=!1),!(1&y.wrap)||(((255&Y)<<8)+(Y>>8))%31){R.msg="incorrect header check",y.mode=30;break}if((15&Y)!=8){R.msg="unknown compression method",y.mode=30;break}if(z-=4,v=8+(15&(Y>>>=4)),y.wbits===0)y.wbits=v;else if(v>y.wbits){R.msg="invalid window size",y.mode=30;break}y.dmax=1<<v,R.adler=y.check=1,y.mode=512&Y?10:12,z=Y=0;break;case 2:for(;z<16;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(y.flags=Y,(255&y.flags)!=8){R.msg="unknown compression method",y.mode=30;break}if(57344&y.flags){R.msg="unknown header flags set",y.mode=30;break}y.head&&(y.head.text=Y>>8&1),512&y.flags&&(V[0]=255&Y,V[1]=Y>>>8&255,y.check=a(y.check,V,2,0)),z=Y=0,y.mode=3;case 3:for(;z<32;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}y.head&&(y.head.time=Y),512&y.flags&&(V[0]=255&Y,V[1]=Y>>>8&255,V[2]=Y>>>16&255,V[3]=Y>>>24&255,y.check=a(y.check,V,4,0)),z=Y=0,y.mode=4;case 4:for(;z<16;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}y.head&&(y.head.xflags=255&Y,y.head.os=Y>>8),512&y.flags&&(V[0]=255&Y,V[1]=Y>>>8&255,y.check=a(y.check,V,2,0)),z=Y=0,y.mode=5;case 5:if(1024&y.flags){for(;z<16;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}y.length=Y,y.head&&(y.head.extra_len=Y),512&y.flags&&(V[0]=255&Y,V[1]=Y>>>8&255,y.check=a(y.check,V,2,0)),z=Y=0}else y.head&&(y.head.extra=null);y.mode=6;case 6:if(1024&y.flags&&($<(Q=y.length)&&(Q=$),Q&&(y.head&&(v=y.head.extra_len-y.length,y.head.extra||(y.head.extra=new Array(y.head.extra_len)),n.arraySet(y.head.extra,U,k,Q,v)),512&y.flags&&(y.check=a(y.check,U,Q,k)),$-=Q,k+=Q,y.length-=Q),y.length))break t;y.length=0,y.mode=7;case 7:if(2048&y.flags){if($===0)break t;for(Q=0;v=U[k+Q++],y.head&&v&&y.length<65536&&(y.head.name+=String.fromCharCode(v)),v&&Q<$;);if(512&y.flags&&(y.check=a(y.check,U,Q,k)),$-=Q,k+=Q,v)break t}else y.head&&(y.head.name=null);y.length=0,y.mode=8;case 8:if(4096&y.flags){if($===0)break t;for(Q=0;v=U[k+Q++],y.head&&v&&y.length<65536&&(y.head.comment+=String.fromCharCode(v)),v&&Q<$;);if(512&y.flags&&(y.check=a(y.check,U,Q,k)),$-=Q,k+=Q,v)break t}else y.head&&(y.head.comment=null);y.mode=9;case 9:if(512&y.flags){for(;z<16;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(Y!==(65535&y.check)){R.msg="header crc mismatch",y.mode=30;break}z=Y=0}y.head&&(y.head.hcrc=y.flags>>9&1,y.head.done=!0),R.adler=y.check=0,y.mode=12;break;case 10:for(;z<32;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}R.adler=y.check=I(Y),z=Y=0,y.mode=11;case 11:if(y.havedict===0)return R.next_out=X,R.avail_out=et,R.next_in=k,R.avail_in=$,y.hold=Y,y.bits=z,2;R.adler=y.check=1,y.mode=12;case 12:if(O===5||O===6)break t;case 13:if(y.last){Y>>>=7&z,z-=7&z,y.mode=27;break}for(;z<3;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}switch(y.last=1&Y,z-=1,3&(Y>>>=1)){case 0:y.mode=14;break;case 1:if(F(y),y.mode=20,O!==6)break;Y>>>=2,z-=2;break t;case 2:y.mode=17;break;case 3:R.msg="invalid block type",y.mode=30}Y>>>=2,z-=2;break;case 14:for(Y>>>=7&z,z-=7&z;z<32;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if((65535&Y)!=(Y>>>16^65535)){R.msg="invalid stored block lengths",y.mode=30;break}if(y.length=65535&Y,z=Y=0,y.mode=15,O===6)break t;case 15:y.mode=16;case 16:if(Q=y.length){if($<Q&&(Q=$),et<Q&&(Q=et),Q===0)break t;n.arraySet(H,U,k,Q,X),$-=Q,k+=Q,et-=Q,X+=Q,y.length-=Q;break}y.mode=12;break;case 17:for(;z<14;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(y.nlen=257+(31&Y),Y>>>=5,z-=5,y.ndist=1+(31&Y),Y>>>=5,z-=5,y.ncode=4+(15&Y),Y>>>=4,z-=4,286<y.nlen||30<y.ndist){R.msg="too many length or distance symbols",y.mode=30;break}y.have=0,y.mode=18;case 18:for(;y.have<y.ncode;){for(;z<3;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}y.lens[Z[y.have++]]=7&Y,Y>>>=3,z-=3}for(;y.have<19;)y.lens[Z[y.have++]]=0;if(y.lencode=y.lendyn,y.lenbits=7,W={bits:y.lenbits},j=l(0,y.lens,0,19,y.lencode,0,y.work,W),y.lenbits=W.bits,j){R.msg="invalid code lengths set",y.mode=30;break}y.have=0,y.mode=19;case 19:for(;y.have<y.nlen+y.ndist;){for(;pt=(x=y.lencode[Y&(1<<y.lenbits)-1])>>>16&255,mt=65535&x,!((lt=x>>>24)<=z);){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(mt<16)Y>>>=lt,z-=lt,y.lens[y.have++]=mt;else{if(mt===16){for(N=lt+2;z<N;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(Y>>>=lt,z-=lt,y.have===0){R.msg="invalid bit length repeat",y.mode=30;break}v=y.lens[y.have-1],Q=3+(3&Y),Y>>>=2,z-=2}else if(mt===17){for(N=lt+3;z<N;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}z-=lt,v=0,Q=3+(7&(Y>>>=lt)),Y>>>=3,z-=3}else{for(N=lt+7;z<N;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}z-=lt,v=0,Q=11+(127&(Y>>>=lt)),Y>>>=7,z-=7}if(y.have+Q>y.nlen+y.ndist){R.msg="invalid bit length repeat",y.mode=30;break}for(;Q--;)y.lens[y.have++]=v}}if(y.mode===30)break;if(y.lens[256]===0){R.msg="invalid code -- missing end-of-block",y.mode=30;break}if(y.lenbits=9,W={bits:y.lenbits},j=l(h,y.lens,0,y.nlen,y.lencode,0,y.work,W),y.lenbits=W.bits,j){R.msg="invalid literal/lengths set",y.mode=30;break}if(y.distbits=6,y.distcode=y.distdyn,W={bits:y.distbits},j=l(u,y.lens,y.nlen,y.ndist,y.distcode,0,y.work,W),y.distbits=W.bits,j){R.msg="invalid distances set",y.mode=30;break}if(y.mode=20,O===6)break t;case 20:y.mode=21;case 21:if(6<=$&&258<=et){R.next_out=X,R.avail_out=et,R.next_in=k,R.avail_in=$,y.hold=Y,y.bits=z,c(R,K),X=R.next_out,H=R.output,et=R.avail_out,k=R.next_in,U=R.input,$=R.avail_in,Y=y.hold,z=y.bits,y.mode===12&&(y.back=-1);break}for(y.back=0;pt=(x=y.lencode[Y&(1<<y.lenbits)-1])>>>16&255,mt=65535&x,!((lt=x>>>24)<=z);){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(pt&&!(240&pt)){for(yt=lt,zt=pt,Lt=mt;pt=(x=y.lencode[Lt+((Y&(1<<yt+zt)-1)>>yt)])>>>16&255,mt=65535&x,!(yt+(lt=x>>>24)<=z);){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}Y>>>=yt,z-=yt,y.back+=yt}if(Y>>>=lt,z-=lt,y.back+=lt,y.length=mt,pt===0){y.mode=26;break}if(32&pt){y.back=-1,y.mode=12;break}if(64&pt){R.msg="invalid literal/length code",y.mode=30;break}y.extra=15&pt,y.mode=22;case 22:if(y.extra){for(N=y.extra;z<N;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}y.length+=Y&(1<<y.extra)-1,Y>>>=y.extra,z-=y.extra,y.back+=y.extra}y.was=y.length,y.mode=23;case 23:for(;pt=(x=y.distcode[Y&(1<<y.distbits)-1])>>>16&255,mt=65535&x,!((lt=x>>>24)<=z);){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(!(240&pt)){for(yt=lt,zt=pt,Lt=mt;pt=(x=y.distcode[Lt+((Y&(1<<yt+zt)-1)>>yt)])>>>16&255,mt=65535&x,!(yt+(lt=x>>>24)<=z);){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}Y>>>=yt,z-=yt,y.back+=yt}if(Y>>>=lt,z-=lt,y.back+=lt,64&pt){R.msg="invalid distance code",y.mode=30;break}y.offset=mt,y.extra=15&pt,y.mode=24;case 24:if(y.extra){for(N=y.extra;z<N;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}y.offset+=Y&(1<<y.extra)-1,Y>>>=y.extra,z-=y.extra,y.back+=y.extra}if(y.offset>y.dmax){R.msg="invalid distance too far back",y.mode=30;break}y.mode=25;case 25:if(et===0)break t;if(Q=K-et,y.offset>Q){if((Q=y.offset-Q)>y.whave&&y.sane){R.msg="invalid distance too far back",y.mode=30;break}gt=Q>y.wnext?(Q-=y.wnext,y.wsize-Q):y.wnext-Q,Q>y.length&&(Q=y.length),Ct=y.window}else Ct=H,gt=X-y.offset,Q=y.length;for(et<Q&&(Q=et),et-=Q,y.length-=Q;H[X++]=Ct[gt++],--Q;);y.length===0&&(y.mode=21);break;case 26:if(et===0)break t;H[X++]=y.length,et--,y.mode=21;break;case 27:if(y.wrap){for(;z<32;){if($===0)break t;$--,Y|=U[k++]<<z,z+=8}if(K-=et,R.total_out+=K,y.total+=K,K&&(R.adler=y.check=y.flags?a(y.check,H,K,X-K):o(y.check,H,K,X-K)),K=et,(y.flags?Y:I(Y))!==y.check){R.msg="incorrect data check",y.mode=30;break}z=Y=0}y.mode=28;case 28:if(y.wrap&&y.flags){for(;z<32;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(Y!==(4294967295&y.total)){R.msg="incorrect length check",y.mode=30;break}z=Y=0}y.mode=29;case 29:j=1;break t;case 30:j=-3;break t;case 31:return-4;case 32:default:return f}return R.next_out=X,R.avail_out=et,R.next_in=k,R.avail_in=$,y.hold=Y,y.bits=z,(y.wsize||K!==R.avail_out&&y.mode<30&&(y.mode<27||O!==4))&&D(R,R.output,R.next_out,K-R.avail_out)?(y.mode=31,-4):(st-=R.avail_in,K-=R.avail_out,R.total_in+=st,R.total_out+=K,y.total+=K,y.wrap&&K&&(R.adler=y.check=y.flags?a(y.check,H,K,R.next_out-K):o(y.check,H,K,R.next_out-K)),R.data_type=y.bits+(y.last?64:0)+(y.mode===12?128:0)+(y.mode===20||y.mode===15?256:0),(st==0&&K===0||O===4)&&j===d&&(j=-5),j)},s.inflateEnd=function(R){if(!R||!R.state)return f;var O=R.state;return O.window&&(O.window=null),R.state=null,d},s.inflateGetHeader=function(R,O){var y;return R&&R.state&&2&(y=R.state).wrap?((y.head=O).done=!1,d):f},s.inflateSetDictionary=function(R,O){var y,U=O.length;return R&&R.state?(y=R.state).wrap!==0&&y.mode!==11?f:y.mode===11&&o(1,O,U,0)!==y.check?-3:D(R,O,U,U)?(y.mode=31,-4):(y.havedict=1,d):f},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,i,s){var n=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(h,u,d,f,p,m,g,I){var C,b,E,T,A,S,_,w,F,D=I.bits,R=0,O=0,y=0,U=0,H=0,k=0,X=0,$=0,et=0,Y=0,z=null,st=0,K=new n.Buf16(16),Q=new n.Buf16(16),gt=null,Ct=0;for(R=0;R<=15;R++)K[R]=0;for(O=0;O<f;O++)K[u[d+O]]++;for(H=D,U=15;1<=U&&K[U]===0;U--);if(U<H&&(H=U),U===0)return p[m++]=20971520,p[m++]=20971520,I.bits=1,0;for(y=1;y<U&&K[y]===0;y++);for(H<y&&(H=y),R=$=1;R<=15;R++)if($<<=1,($-=K[R])<0)return-1;if(0<$&&(h===0||U!==1))return-1;for(Q[1]=0,R=1;R<15;R++)Q[R+1]=Q[R]+K[R];for(O=0;O<f;O++)u[d+O]!==0&&(g[Q[u[d+O]]++]=O);if(S=h===0?(z=gt=g,19):h===1?(z=o,st-=257,gt=a,Ct-=257,256):(z=c,gt=l,-1),R=y,A=m,X=O=Y=0,E=-1,T=(et=1<<(k=H))-1,h===1&&852<et||h===2&&592<et)return 1;for(;;){for(_=R-X,F=g[O]<S?(w=0,g[O]):g[O]>S?(w=gt[Ct+g[O]],z[st+g[O]]):(w=96,0),C=1<<R-X,y=b=1<<k;p[A+(Y>>X)+(b-=C)]=_<<24|w<<16|F|0,b!==0;);for(C=1<<R-1;Y&C;)C>>=1;if(C!==0?(Y&=C-1,Y+=C):Y=0,O++,--K[R]==0){if(R===U)break;R=u[d+g[O]]}if(H<R&&(Y&T)!==E){for(X===0&&(X=H),A+=y,$=1<<(k=R-X);k+X<U&&!(($-=K[k+X])<=0);)k++,$<<=1;if(et+=1<<k,h===1&&852<et||h===2&&592<et)return 1;p[E=Y&T]=H<<24|k<<16|A-m|0}}return Y!==0&&(p[A+Y]=R-X<<24|64<<16|0),I.bits=H,0}},{"../utils/common":41}],51:[function(e,i,s){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,i,s){var n=e("../utils/common"),o=0,a=1;function c(x){for(var V=x.length;0<=--V;)x[V]=0}var l=0,h=29,u=256,d=u+1+h,f=30,p=19,m=2*d+1,g=15,I=16,C=7,b=256,E=16,T=17,A=18,S=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],_=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=new Array(2*(d+2));c(D);var R=new Array(2*f);c(R);var O=new Array(512);c(O);var y=new Array(256);c(y);var U=new Array(h);c(U);var H,k,X,$=new Array(f);function et(x,V,Z,q,G){this.static_tree=x,this.extra_bits=V,this.extra_base=Z,this.elems=q,this.max_length=G,this.has_stree=x&&x.length}function Y(x,V){this.dyn_tree=x,this.max_code=0,this.stat_desc=V}function z(x){return x<256?O[x]:O[256+(x>>>7)]}function st(x,V){x.pending_buf[x.pending++]=255&V,x.pending_buf[x.pending++]=V>>>8&255}function K(x,V,Z){x.bi_valid>I-Z?(x.bi_buf|=V<<x.bi_valid&65535,st(x,x.bi_buf),x.bi_buf=V>>I-x.bi_valid,x.bi_valid+=Z-I):(x.bi_buf|=V<<x.bi_valid&65535,x.bi_valid+=Z)}function Q(x,V,Z){K(x,Z[2*V],Z[2*V+1])}function gt(x,V){for(var Z=0;Z|=1&x,x>>>=1,Z<<=1,0<--V;);return Z>>>1}function Ct(x,V,Z){var q,G,J=new Array(g+1),ot=0;for(q=1;q<=g;q++)J[q]=ot=ot+Z[q-1]<<1;for(G=0;G<=V;G++){var tt=x[2*G+1];tt!==0&&(x[2*G]=gt(J[tt]++,tt))}}function lt(x){var V;for(V=0;V<d;V++)x.dyn_ltree[2*V]=0;for(V=0;V<f;V++)x.dyn_dtree[2*V]=0;for(V=0;V<p;V++)x.bl_tree[2*V]=0;x.dyn_ltree[2*b]=1,x.opt_len=x.static_len=0,x.last_lit=x.matches=0}function pt(x){8<x.bi_valid?st(x,x.bi_buf):0<x.bi_valid&&(x.pending_buf[x.pending++]=x.bi_buf),x.bi_buf=0,x.bi_valid=0}function mt(x,V,Z,q){var G=2*V,J=2*Z;return x[G]<x[J]||x[G]===x[J]&&q[V]<=q[Z]}function yt(x,V,Z){for(var q=x.heap[Z],G=Z<<1;G<=x.heap_len&&(G<x.heap_len&&mt(V,x.heap[G+1],x.heap[G],x.depth)&&G++,!mt(V,q,x.heap[G],x.depth));)x.heap[Z]=x.heap[G],Z=G,G<<=1;x.heap[Z]=q}function zt(x,V,Z){var q,G,J,ot,tt=0;if(x.last_lit!==0)for(;q=x.pending_buf[x.d_buf+2*tt]<<8|x.pending_buf[x.d_buf+2*tt+1],G=x.pending_buf[x.l_buf+tt],tt++,q===0?Q(x,G,V):(Q(x,(J=y[G])+u+1,V),(ot=S[J])!==0&&K(x,G-=U[J],ot),Q(x,J=z(--q),Z),(ot=_[J])!==0&&K(x,q-=$[J],ot)),tt<x.last_lit;);Q(x,b,V)}function Lt(x,V){var Z,q,G,J=V.dyn_tree,ot=V.stat_desc.static_tree,tt=V.stat_desc.has_stree,ft=V.stat_desc.elems,At=-1;for(x.heap_len=0,x.heap_max=m,Z=0;Z<ft;Z++)J[2*Z]!==0?(x.heap[++x.heap_len]=At=Z,x.depth[Z]=0):J[2*Z+1]=0;for(;x.heap_len<2;)J[2*(G=x.heap[++x.heap_len]=At<2?++At:0)]=1,x.depth[G]=0,x.opt_len--,tt&&(x.static_len-=ot[2*G+1]);for(V.max_code=At,Z=x.heap_len>>1;1<=Z;Z--)yt(x,J,Z);for(G=ft;Z=x.heap[1],x.heap[1]=x.heap[x.heap_len--],yt(x,J,1),q=x.heap[1],x.heap[--x.heap_max]=Z,x.heap[--x.heap_max]=q,J[2*G]=J[2*Z]+J[2*q],x.depth[G]=(x.depth[Z]>=x.depth[q]?x.depth[Z]:x.depth[q])+1,J[2*Z+1]=J[2*q+1]=G,x.heap[1]=G++,yt(x,J,1),2<=x.heap_len;);x.heap[--x.heap_max]=x.heap[1],function(bt,ae){var Is,ye,gs,Pt,cn,Hr,Le=ae.dyn_tree,nl=ae.max_code,kp=ae.stat_desc.static_tree,Vp=ae.stat_desc.has_stree,zp=ae.stat_desc.extra_bits,rl=ae.stat_desc.extra_base,Es=ae.stat_desc.max_length,ln=0;for(Pt=0;Pt<=g;Pt++)bt.bl_count[Pt]=0;for(Le[2*bt.heap[bt.heap_max]+1]=0,Is=bt.heap_max+1;Is<m;Is++)Es<(Pt=Le[2*Le[2*(ye=bt.heap[Is])+1]+1]+1)&&(Pt=Es,ln++),Le[2*ye+1]=Pt,nl<ye||(bt.bl_count[Pt]++,cn=0,rl<=ye&&(cn=zp[ye-rl]),Hr=Le[2*ye],bt.opt_len+=Hr*(Pt+cn),Vp&&(bt.static_len+=Hr*(kp[2*ye+1]+cn)));if(ln!==0){do{for(Pt=Es-1;bt.bl_count[Pt]===0;)Pt--;bt.bl_count[Pt]--,bt.bl_count[Pt+1]+=2,bt.bl_count[Es]--,ln-=2}while(0<ln);for(Pt=Es;Pt!==0;Pt--)for(ye=bt.bl_count[Pt];ye!==0;)nl<(gs=bt.heap[--Is])||(Le[2*gs+1]!==Pt&&(bt.opt_len+=(Pt-Le[2*gs+1])*Le[2*gs],Le[2*gs+1]=Pt),ye--)}}(x,V),Ct(J,At,x.bl_count)}function v(x,V,Z){var q,G,J=-1,ot=V[1],tt=0,ft=7,At=4;for(ot===0&&(ft=138,At=3),V[2*(Z+1)+1]=65535,q=0;q<=Z;q++)G=ot,ot=V[2*(q+1)+1],++tt<ft&&G===ot||(tt<At?x.bl_tree[2*G]+=tt:G!==0?(G!==J&&x.bl_tree[2*G]++,x.bl_tree[2*E]++):tt<=10?x.bl_tree[2*T]++:x.bl_tree[2*A]++,J=G,At=(tt=0)===ot?(ft=138,3):G===ot?(ft=6,3):(ft=7,4))}function j(x,V,Z){var q,G,J=-1,ot=V[1],tt=0,ft=7,At=4;for(ot===0&&(ft=138,At=3),q=0;q<=Z;q++)if(G=ot,ot=V[2*(q+1)+1],!(++tt<ft&&G===ot)){if(tt<At)for(;Q(x,G,x.bl_tree),--tt!=0;);else G!==0?(G!==J&&(Q(x,G,x.bl_tree),tt--),Q(x,E,x.bl_tree),K(x,tt-3,2)):tt<=10?(Q(x,T,x.bl_tree),K(x,tt-3,3)):(Q(x,A,x.bl_tree),K(x,tt-11,7));J=G,At=(tt=0)===ot?(ft=138,3):G===ot?(ft=6,3):(ft=7,4)}}c($);var W=!1;function N(x,V,Z,q){K(x,(l<<1)+(q?1:0),3),function(G,J,ot,tt){pt(G),st(G,ot),st(G,~ot),n.arraySet(G.pending_buf,G.window,J,ot,G.pending),G.pending+=ot}(x,V,Z)}s._tr_init=function(x){W||(function(){var V,Z,q,G,J,ot=new Array(g+1);for(G=q=0;G<h-1;G++)for(U[G]=q,V=0;V<1<<S[G];V++)y[q++]=G;for(y[q-1]=G,G=J=0;G<16;G++)for($[G]=J,V=0;V<1<<_[G];V++)O[J++]=G;for(J>>=7;G<f;G++)for($[G]=J<<7,V=0;V<1<<_[G]-7;V++)O[256+J++]=G;for(Z=0;Z<=g;Z++)ot[Z]=0;for(V=0;V<=143;)D[2*V+1]=8,V++,ot[8]++;for(;V<=255;)D[2*V+1]=9,V++,ot[9]++;for(;V<=279;)D[2*V+1]=7,V++,ot[7]++;for(;V<=287;)D[2*V+1]=8,V++,ot[8]++;for(Ct(D,d+1,ot),V=0;V<f;V++)R[2*V+1]=5,R[2*V]=gt(V,5);H=new et(D,S,u+1,d,g),k=new et(R,_,0,f,g),X=new et(new Array(0),w,0,p,C)}(),W=!0),x.l_desc=new Y(x.dyn_ltree,H),x.d_desc=new Y(x.dyn_dtree,k),x.bl_desc=new Y(x.bl_tree,X),x.bi_buf=0,x.bi_valid=0,lt(x)},s._tr_stored_block=N,s._tr_flush_block=function(x,V,Z,q){var G,J,ot=0;0<x.level?(x.strm.data_type===2&&(x.strm.data_type=function(tt){var ft,At=4093624447;for(ft=0;ft<=31;ft++,At>>>=1)if(1&At&&tt.dyn_ltree[2*ft]!==0)return o;if(tt.dyn_ltree[18]!==0||tt.dyn_ltree[20]!==0||tt.dyn_ltree[26]!==0)return a;for(ft=32;ft<u;ft++)if(tt.dyn_ltree[2*ft]!==0)return a;return o}(x)),Lt(x,x.l_desc),Lt(x,x.d_desc),ot=function(tt){var ft;for(v(tt,tt.dyn_ltree,tt.l_desc.max_code),v(tt,tt.dyn_dtree,tt.d_desc.max_code),Lt(tt,tt.bl_desc),ft=p-1;3<=ft&&tt.bl_tree[2*F[ft]+1]===0;ft--);return tt.opt_len+=3*(ft+1)+5+5+4,ft}(x),G=x.opt_len+3+7>>>3,(J=x.static_len+3+7>>>3)<=G&&(G=J)):G=J=Z+5,Z+4<=G&&V!==-1?N(x,V,Z,q):x.strategy===4||J===G?(K(x,2+(q?1:0),3),zt(x,D,R)):(K(x,4+(q?1:0),3),function(tt,ft,At,bt){var ae;for(K(tt,ft-257,5),K(tt,At-1,5),K(tt,bt-4,4),ae=0;ae<bt;ae++)K(tt,tt.bl_tree[2*F[ae]+1],3);j(tt,tt.dyn_ltree,ft-1),j(tt,tt.dyn_dtree,At-1)}(x,x.l_desc.max_code+1,x.d_desc.max_code+1,ot+1),zt(x,x.dyn_ltree,x.dyn_dtree)),lt(x),q&&pt(x)},s._tr_tally=function(x,V,Z){return x.pending_buf[x.d_buf+2*x.last_lit]=V>>>8&255,x.pending_buf[x.d_buf+2*x.last_lit+1]=255&V,x.pending_buf[x.l_buf+x.last_lit]=255&Z,x.last_lit++,V===0?x.dyn_ltree[2*Z]++:(x.matches++,V--,x.dyn_ltree[2*(y[Z]+u+1)]++,x.dyn_dtree[2*z(V)]++),x.last_lit===x.lit_bufsize-1},s._tr_align=function(x){K(x,2,3),Q(x,b,D),function(V){V.bi_valid===16?(st(V,V.bi_buf),V.bi_buf=0,V.bi_valid=0):8<=V.bi_valid&&(V.pending_buf[V.pending++]=255&V.bi_buf,V.bi_buf>>=8,V.bi_valid-=8)}(x)}},{"../utils/common":41}],53:[function(e,i,s){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,i,s){(function(n){(function(o,a){if(!o.setImmediate){var c,l,h,u,d=1,f={},p=!1,m=o.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(o);g=g&&g.setTimeout?g:o,c={}.toString.call(o.process)==="[object process]"?function(E){process.nextTick(function(){C(E)})}:function(){if(o.postMessage&&!o.importScripts){var E=!0,T=o.onmessage;return o.onmessage=function(){E=!1},o.postMessage("","*"),o.onmessage=T,E}}()?(u="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",b,!1):o.attachEvent("onmessage",b),function(E){o.postMessage(u+E,"*")}):o.MessageChannel?((h=new MessageChannel).port1.onmessage=function(E){C(E.data)},function(E){h.port2.postMessage(E)}):m&&"onreadystatechange"in m.createElement("script")?(l=m.documentElement,function(E){var T=m.createElement("script");T.onreadystatechange=function(){C(E),T.onreadystatechange=null,l.removeChild(T),T=null},l.appendChild(T)}):function(E){setTimeout(C,0,E)},g.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var T=new Array(arguments.length-1),A=0;A<T.length;A++)T[A]=arguments[A+1];var S={callback:E,args:T};return f[d]=S,c(d),d++},g.clearImmediate=I}function I(E){delete f[E]}function C(E){if(p)setTimeout(C,0,E);else{var T=f[E];if(T){p=!0;try{(function(A){var S=A.callback,_=A.args;switch(_.length){case 0:S();break;case 1:S(_[0]);break;case 2:S(_[0],_[1]);break;case 3:S(_[0],_[1],_[2]);break;default:S.apply(a,_)}})(T)}finally{I(E),p=!1}}}}function b(E){E.source===o&&typeof E.data=="string"&&E.data.indexOf(u)===0&&C(+E.data.slice(u.length))}})(typeof self>"u"?n===void 0?this:n:self)}).call(this,typeof Ku<"u"?Ku:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(vR);var zL=vR.exports;const Ib=$v(zL);var UE={},Ip={};(function(r){const t=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",e=t+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",i="["+t+"]["+e+"]*",s=new RegExp("^"+i+"$"),n=function(a,c){const l=[];let h=c.exec(a);for(;h;){const u=[];u.startIndex=c.lastIndex-h[0].length;const d=h.length;for(let f=0;f<d;f++)u.push(h[f]);l.push(u),h=c.exec(a)}return l},o=function(a){const c=s.exec(a);return!(c===null||typeof c>"u")};r.isExist=function(a){return typeof a<"u"},r.isEmptyObject=function(a){return Object.keys(a).length===0},r.merge=function(a,c,l){if(c){const h=Object.keys(c),u=h.length;for(let d=0;d<u;d++)l==="strict"?a[h[d]]=[c[h[d]]]:a[h[d]]=c[h[d]]}},r.getValue=function(a){return r.isExist(a)?a:""},r.isName=o,r.getAllMatches=n,r.nameRegexp=i})(Ip);const BE=Ip,YL={allowBooleanAttributes:!1,unpairedTags:[]};UE.validate=function(r,t){t=Object.assign({},YL,t);const e=[];let i=!1,s=!1;r[0]==="\uFEFF"&&(r=r.substr(1));for(let n=0;n<r.length;n++)if(r[n]==="<"&&r[n+1]==="?"){if(n+=2,n=Eb(r,n),n.err)return n}else if(r[n]==="<"){let o=n;if(n++,r[n]==="!"){n=Cb(r,n);continue}else{let a=!1;r[n]==="/"&&(a=!0,n++);let c="";for(;n<r.length&&r[n]!==">"&&r[n]!==" "&&r[n]!=="	"&&r[n]!==`
`&&r[n]!=="\r";n++)c+=r[n];if(c=c.trim(),c[c.length-1]==="/"&&(c=c.substring(0,c.length-1),n--),!qL(c)){let u;return c.trim().length===0?u="Invalid space after '<'.":u="Tag '"+c+"' is an invalid name.",ve("InvalidTag",u,ni(r,n))}const l=$L(r,n);if(l===!1)return ve("InvalidAttr","Attributes for '"+c+"' have open quote.",ni(r,n));let h=l.value;if(n=l.index,h[h.length-1]==="/"){const u=n-h.length;h=h.substring(0,h.length-1);const d=bb(h,t);if(d===!0)i=!0;else return ve(d.err.code,d.err.msg,ni(r,u+d.err.line))}else if(a)if(l.tagClosed){if(h.trim().length>0)return ve("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",ni(r,o));if(e.length===0)return ve("InvalidTag","Closing tag '"+c+"' has not been opened.",ni(r,o));{const u=e.pop();if(c!==u.tagName){let d=ni(r,u.tagStartPos);return ve("InvalidTag","Expected closing tag '"+u.tagName+"' (opened in line "+d.line+", col "+d.col+") instead of closing tag '"+c+"'.",ni(r,o))}e.length==0&&(s=!0)}}else return ve("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",ni(r,n));else{const u=bb(h,t);if(u!==!0)return ve(u.err.code,u.err.msg,ni(r,n-h.length+u.err.line));if(s===!0)return ve("InvalidXml","Multiple possible root nodes found.",ni(r,n));t.unpairedTags.indexOf(c)!==-1||e.push({tagName:c,tagStartPos:o}),i=!0}for(n++;n<r.length;n++)if(r[n]==="<")if(r[n+1]==="!"){n++,n=Cb(r,n);continue}else if(r[n+1]==="?"){if(n=Eb(r,++n),n.err)return n}else break;else if(r[n]==="&"){const u=XL(r,n);if(u==-1)return ve("InvalidChar","char '&' is not expected.",ni(r,n));n=u}else if(s===!0&&!gb(r[n]))return ve("InvalidXml","Extra text at the end",ni(r,n));r[n]==="<"&&n--}}else{if(gb(r[n]))continue;return ve("InvalidChar","char '"+r[n]+"' is not expected.",ni(r,n))}if(i){if(e.length==1)return ve("InvalidTag","Unclosed tag '"+e[0].tagName+"'.",ni(r,e[0].tagStartPos));if(e.length>0)return ve("InvalidXml","Invalid '"+JSON.stringify(e.map(n=>n.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return ve("InvalidXml","Start tag expected.",1);return!0};function gb(r){return r===" "||r==="	"||r===`
`||r==="\r"}function Eb(r,t){const e=t;for(;t<r.length;t++)if(r[t]=="?"||r[t]==" "){const i=r.substr(e,t-e);if(t>5&&i==="xml")return ve("InvalidXml","XML declaration allowed only at the start of the document.",ni(r,t));if(r[t]=="?"&&r[t+1]==">"){t++;break}else continue}return t}function Cb(r,t){if(r.length>t+5&&r[t+1]==="-"&&r[t+2]==="-"){for(t+=3;t<r.length;t++)if(r[t]==="-"&&r[t+1]==="-"&&r[t+2]===">"){t+=2;break}}else if(r.length>t+8&&r[t+1]==="D"&&r[t+2]==="O"&&r[t+3]==="C"&&r[t+4]==="T"&&r[t+5]==="Y"&&r[t+6]==="P"&&r[t+7]==="E"){let e=1;for(t+=8;t<r.length;t++)if(r[t]==="<")e++;else if(r[t]===">"&&(e--,e===0))break}else if(r.length>t+9&&r[t+1]==="["&&r[t+2]==="C"&&r[t+3]==="D"&&r[t+4]==="A"&&r[t+5]==="T"&&r[t+6]==="A"&&r[t+7]==="["){for(t+=8;t<r.length;t++)if(r[t]==="]"&&r[t+1]==="]"&&r[t+2]===">"){t+=2;break}}return t}const GL='"',HL="'";function $L(r,t){let e="",i="",s=!1;for(;t<r.length;t++){if(r[t]===GL||r[t]===HL)i===""?i=r[t]:i!==r[t]||(i="");else if(r[t]===">"&&i===""){s=!0;break}e+=r[t]}return i!==""?!1:{value:e,index:t,tagClosed:s}}const WL=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function bb(r,t){const e=BE.getAllMatches(r,WL),i={};for(let s=0;s<e.length;s++){if(e[s][1].length===0)return ve("InvalidAttr","Attribute '"+e[s][2]+"' has no space in starting.",Fl(e[s]));if(e[s][3]!==void 0&&e[s][4]===void 0)return ve("InvalidAttr","Attribute '"+e[s][2]+"' is without value.",Fl(e[s]));if(e[s][3]===void 0&&!t.allowBooleanAttributes)return ve("InvalidAttr","boolean attribute '"+e[s][2]+"' is not allowed.",Fl(e[s]));const n=e[s][2];if(!ZL(n))return ve("InvalidAttr","Attribute '"+n+"' is an invalid name.",Fl(e[s]));if(!i.hasOwnProperty(n))i[n]=1;else return ve("InvalidAttr","Attribute '"+n+"' is repeated.",Fl(e[s]))}return!0}function jL(r,t){let e=/\d/;for(r[t]==="x"&&(t++,e=/[\da-fA-F]/);t<r.length;t++){if(r[t]===";")return t;if(!r[t].match(e))break}return-1}function XL(r,t){if(t++,r[t]===";")return-1;if(r[t]==="#")return t++,jL(r,t);let e=0;for(;t<r.length;t++,e++)if(!(r[t].match(/\w/)&&e<20)){if(r[t]===";")break;return-1}return t}function ve(r,t,e){return{err:{code:r,msg:t,line:e.line||e,col:e.col}}}function ZL(r){return BE.isName(r)}function qL(r){return BE.isName(r)}function ni(r,t){const e=r.substring(0,t).split(/\r?\n/);return{line:e.length,col:e[e.length-1].length+1}}function Fl(r){return r.startIndex+r[1].length}var kE={};const RR={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(r,t){return t},attributeValueProcessor:function(r,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(r,t,e){return r}},QL=function(r){return Object.assign({},RR,r)};kE.buildOptions=QL;kE.defaultOptions=RR;class KL{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}var JL=KL;const tM=Ip;function eM(r,t){const e={};if(r[t+3]==="O"&&r[t+4]==="C"&&r[t+5]==="T"&&r[t+6]==="Y"&&r[t+7]==="P"&&r[t+8]==="E"){t=t+9;let i=1,s=!1,n=!1,o="";for(;t<r.length;t++)if(r[t]==="<"&&!n)s&&sM(r,t)?(t+=7,[entityName,val,t]=iM(r,t+1),val.indexOf("&")===-1&&(e[aM(entityName)]={regx:RegExp(`&${entityName};`,"g"),val})):s&&nM(r,t)||s&&rM(r,t)?t+=8:s&&oM(r,t)?t+=9:n=!0,i++,o="";else if(r[t]===">"){if(n?r[t-1]==="-"&&r[t-2]==="-"&&(n=!1,i--):i--,i===0)break}else r[t]==="["?s=!0:o+=r[t];if(i!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:e,i:t}}function iM(r,t){let e="";for(;t<r.length&&r[t]!=="'"&&r[t]!=='"';t++)e+=r[t];if(e=e.trim(),e.indexOf(" ")!==-1)throw new Error("External entites are not supported");const i=r[t++];let s="";for(;t<r.length&&r[t]!==i;t++)s+=r[t];return[e,s,t]}function sM(r,t){return r[t+1]==="!"&&r[t+2]==="E"&&r[t+3]==="N"&&r[t+4]==="T"&&r[t+5]==="I"&&r[t+6]==="T"&&r[t+7]==="Y"}function nM(r,t){return r[t+1]==="!"&&r[t+2]==="E"&&r[t+3]==="L"&&r[t+4]==="E"&&r[t+5]==="M"&&r[t+6]==="E"&&r[t+7]==="N"&&r[t+8]==="T"}function rM(r,t){return r[t+1]==="!"&&r[t+2]==="A"&&r[t+3]==="T"&&r[t+4]==="T"&&r[t+5]==="L"&&r[t+6]==="I"&&r[t+7]==="S"&&r[t+8]==="T"}function oM(r,t){return r[t+1]==="!"&&r[t+2]==="N"&&r[t+3]==="O"&&r[t+4]==="T"&&r[t+5]==="A"&&r[t+6]==="T"&&r[t+7]==="I"&&r[t+8]==="O"&&r[t+9]==="N"}function aM(r){if(tM.isName(r))return r;throw new Error(`Invalid entity name ${r}`)}var cM=eM;const lM=/^[-+]?0x[a-fA-F0-9]+$/,hM=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const uM={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function dM(r,t={}){if(t=Object.assign({},uM,t),!r||typeof r!="string")return r;let e=r.trim();if(t.skipLike!==void 0&&t.skipLike.test(e))return r;if(t.hex&&lM.test(e))return Number.parseInt(e,16);{const i=hM.exec(e);if(i){const s=i[1],n=i[2];let o=fM(i[3]);const a=i[4]||i[6];if(!t.leadingZeros&&n.length>0&&s&&e[2]!==".")return r;if(!t.leadingZeros&&n.length>0&&!s&&e[1]!==".")return r;{const c=Number(e),l=""+c;return l.search(/[eE]/)!==-1||a?t.eNotation?c:r:e.indexOf(".")!==-1?l==="0"&&o===""||l===o||s&&l==="-"+o?c:r:n?o===l||s+o===l?c:r:e===l||e===s+l?c:r}}else return r}}function fM(r){return r&&r.indexOf(".")!==-1&&(r=r.replace(/0+$/,""),r==="."?r="0":r[0]==="."?r="0"+r:r[r.length-1]==="."&&(r=r.substr(0,r.length-1))),r}var pM=dM;const AR=Ip,Ol=JL,mM=cM,IM=pM;let gM=class{constructor(t){this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,i)=>String.fromCharCode(Number.parseInt(i,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,i)=>String.fromCharCode(Number.parseInt(i,16))}},this.addExternalEntities=EM,this.parseXml=vM,this.parseTextData=CM,this.resolveNameSpace=bM,this.buildAttributesMap=yM,this.isItStopNode=wM,this.replaceEntitiesValue=AM,this.readStopNodeData=FM,this.saveTextToParentTag=SM,this.addChild=RM}};function EM(r){const t=Object.keys(r);for(let e=0;e<t.length;e++){const i=t[e];this.lastEntities[i]={regex:new RegExp("&"+i+";","g"),val:r[i]}}}function CM(r,t,e,i,s,n,o){if(r!==void 0&&(this.options.trimValues&&!i&&(r=r.trim()),r.length>0)){o||(r=this.replaceEntitiesValue(r));const a=this.options.tagValueProcessor(t,r,e,s,n);return a==null?r:typeof a!=typeof r||a!==r?a:this.options.trimValues?tg(r,this.options.parseTagValue,this.options.numberParseOptions):r.trim()===r?tg(r,this.options.parseTagValue,this.options.numberParseOptions):r}}function bM(r){if(this.options.removeNSPrefix){const t=r.split(":"),e=r.charAt(0)==="/"?"/":"";if(t[0]==="xmlns")return"";t.length===2&&(r=e+t[1])}return r}const TM=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function yM(r,t,e){if(!this.options.ignoreAttributes&&typeof r=="string"){const i=AR.getAllMatches(r,TM),s=i.length,n={};for(let o=0;o<s;o++){const a=this.resolveNameSpace(i[o][1]);let c=i[o][4],l=this.options.attributeNamePrefix+a;if(a.length)if(this.options.transformAttributeName&&(l=this.options.transformAttributeName(l)),l==="__proto__"&&(l="#__proto__"),c!==void 0){this.options.trimValues&&(c=c.trim()),c=this.replaceEntitiesValue(c);const h=this.options.attributeValueProcessor(a,c,t);h==null?n[l]=c:typeof h!=typeof c||h!==c?n[l]=h:n[l]=tg(c,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(n[l]=!0)}if(!Object.keys(n).length)return;if(this.options.attributesGroupName){const o={};return o[this.options.attributesGroupName]=n,o}return n}}const vM=function(r){r=r.replace(/\r\n?/g,`
`);const t=new Ol("!xml");let e=t,i="",s="";for(let n=0;n<r.length;n++)if(r[n]==="<")if(r[n+1]==="/"){const a=uo(r,">",n,"Closing Tag is not closed.");let c=r.substring(n+2,a).trim();if(this.options.removeNSPrefix){const u=c.indexOf(":");u!==-1&&(c=c.substr(u+1))}this.options.transformTagName&&(c=this.options.transformTagName(c)),e&&(i=this.saveTextToParentTag(i,e,s));const l=s.substring(s.lastIndexOf(".")+1);if(c&&this.options.unpairedTags.indexOf(c)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${c}>`);let h=0;l&&this.options.unpairedTags.indexOf(l)!==-1?(h=s.lastIndexOf(".",s.lastIndexOf(".")-1),this.tagsNodeStack.pop()):h=s.lastIndexOf("."),s=s.substring(0,h),e=this.tagsNodeStack.pop(),i="",n=a}else if(r[n+1]==="?"){let a=JI(r,n,!1,"?>");if(!a)throw new Error("Pi Tag is not closed.");if(i=this.saveTextToParentTag(i,e,s),!(this.options.ignoreDeclaration&&a.tagName==="?xml"||this.options.ignorePiTags)){const c=new Ol(a.tagName);c.add(this.options.textNodeName,""),a.tagName!==a.tagExp&&a.attrExpPresent&&(c[":@"]=this.buildAttributesMap(a.tagExp,s,a.tagName)),this.addChild(e,c,s)}n=a.closeIndex+1}else if(r.substr(n+1,3)==="!--"){const a=uo(r,"-->",n+4,"Comment is not closed.");if(this.options.commentPropName){const c=r.substring(n+4,a-2);i=this.saveTextToParentTag(i,e,s),e.add(this.options.commentPropName,[{[this.options.textNodeName]:c}])}n=a}else if(r.substr(n+1,2)==="!D"){const a=mM(r,n);this.docTypeEntities=a.entities,n=a.i}else if(r.substr(n+1,2)==="!["){const a=uo(r,"]]>",n,"CDATA is not closed.")-2,c=r.substring(n+9,a);i=this.saveTextToParentTag(i,e,s);let l=this.parseTextData(c,e.tagname,s,!0,!1,!0,!0);l==null&&(l=""),this.options.cdataPropName?e.add(this.options.cdataPropName,[{[this.options.textNodeName]:c}]):e.add(this.options.textNodeName,l),n=a+2}else{let a=JI(r,n,this.options.removeNSPrefix),c=a.tagName;const l=a.rawTagName;let h=a.tagExp,u=a.attrExpPresent,d=a.closeIndex;this.options.transformTagName&&(c=this.options.transformTagName(c)),e&&i&&e.tagname!=="!xml"&&(i=this.saveTextToParentTag(i,e,s,!1));const f=e;if(f&&this.options.unpairedTags.indexOf(f.tagname)!==-1&&(e=this.tagsNodeStack.pop(),s=s.substring(0,s.lastIndexOf("."))),c!==t.tagname&&(s+=s?"."+c:c),this.isItStopNode(this.options.stopNodes,s,c)){let p="";if(h.length>0&&h.lastIndexOf("/")===h.length-1)c[c.length-1]==="/"?(c=c.substr(0,c.length-1),s=s.substr(0,s.length-1),h=c):h=h.substr(0,h.length-1),n=a.closeIndex;else if(this.options.unpairedTags.indexOf(c)!==-1)n=a.closeIndex;else{const g=this.readStopNodeData(r,l,d+1);if(!g)throw new Error(`Unexpected end of ${l}`);n=g.i,p=g.tagContent}const m=new Ol(c);c!==h&&u&&(m[":@"]=this.buildAttributesMap(h,s,c)),p&&(p=this.parseTextData(p,c,s,!0,u,!0,!0)),s=s.substr(0,s.lastIndexOf(".")),m.add(this.options.textNodeName,p),this.addChild(e,m,s)}else{if(h.length>0&&h.lastIndexOf("/")===h.length-1){c[c.length-1]==="/"?(c=c.substr(0,c.length-1),s=s.substr(0,s.length-1),h=c):h=h.substr(0,h.length-1),this.options.transformTagName&&(c=this.options.transformTagName(c));const p=new Ol(c);c!==h&&u&&(p[":@"]=this.buildAttributesMap(h,s,c)),this.addChild(e,p,s),s=s.substr(0,s.lastIndexOf("."))}else{const p=new Ol(c);this.tagsNodeStack.push(e),c!==h&&u&&(p[":@"]=this.buildAttributesMap(h,s,c)),this.addChild(e,p,s),e=p}i="",n=d}}else i+=r[n];return t.child};function RM(r,t,e){const i=this.options.updateTag(t.tagname,e,t[":@"]);i===!1||(typeof i=="string"&&(t.tagname=i),r.addChild(t))}const AM=function(r){if(this.options.processEntities){for(let t in this.docTypeEntities){const e=this.docTypeEntities[t];r=r.replace(e.regx,e.val)}for(let t in this.lastEntities){const e=this.lastEntities[t];r=r.replace(e.regex,e.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const e=this.htmlEntities[t];r=r.replace(e.regex,e.val)}r=r.replace(this.ampEntity.regex,this.ampEntity.val)}return r};function SM(r,t,e,i){return r&&(i===void 0&&(i=Object.keys(t.child).length===0),r=this.parseTextData(r,t.tagname,e,!1,t[":@"]?Object.keys(t[":@"]).length!==0:!1,i),r!==void 0&&r!==""&&t.add(this.options.textNodeName,r),r=""),r}function wM(r,t,e){const i="*."+e;for(const s in r){const n=r[s];if(i===n||t===n)return!0}return!1}function _M(r,t,e=">"){let i,s="";for(let n=t;n<r.length;n++){let o=r[n];if(i)o===i&&(i="");else if(o==='"'||o==="'")i=o;else if(o===e[0])if(e[1]){if(r[n+1]===e[1])return{data:s,index:n}}else return{data:s,index:n};else o==="	"&&(o=" ");s+=o}}function uo(r,t,e,i){const s=r.indexOf(t,e);if(s===-1)throw new Error(i);return s+t.length-1}function JI(r,t,e,i=">"){const s=_M(r,t+1,i);if(!s)return;let n=s.data;const o=s.index,a=n.search(/\s/);let c=n,l=!0;a!==-1&&(c=n.substring(0,a),n=n.substring(a+1).trimStart());const h=c;if(e){const u=c.indexOf(":");u!==-1&&(c=c.substr(u+1),l=c!==s.data.substr(u+1))}return{tagName:c,tagExp:n,closeIndex:o,attrExpPresent:l,rawTagName:h}}function FM(r,t,e){const i=e;let s=1;for(;e<r.length;e++)if(r[e]==="<")if(r[e+1]==="/"){const n=uo(r,">",e,`${t} is not closed`);if(r.substring(e+2,n).trim()===t&&(s--,s===0))return{tagContent:r.substring(i,e),i:n};e=n}else if(r[e+1]==="?")e=uo(r,"?>",e+1,"StopNode is not closed.");else if(r.substr(e+1,3)==="!--")e=uo(r,"-->",e+3,"StopNode is not closed.");else if(r.substr(e+1,2)==="![")e=uo(r,"]]>",e,"StopNode is not closed.")-2;else{const n=JI(r,e,">");n&&((n&&n.tagName)===t&&n.tagExp[n.tagExp.length-1]!=="/"&&s++,e=n.closeIndex)}}function tg(r,t,e){if(t&&typeof r=="string"){const i=r.trim();return i==="true"?!0:i==="false"?!1:IM(r,e)}else return AR.isExist(r)?r:""}var OM=gM,SR={};function xM(r,t){return wR(r,t)}function wR(r,t,e){let i;const s={};for(let n=0;n<r.length;n++){const o=r[n],a=NM(o);let c="";if(e===void 0?c=a:c=e+"."+a,a===t.textNodeName)i===void 0?i=o[a]:i+=""+o[a];else{if(a===void 0)continue;if(o[a]){let l=wR(o[a],t,c);const h=LM(l,t);o[":@"]?PM(l,o[":@"],c,t):Object.keys(l).length===1&&l[t.textNodeName]!==void 0&&!t.alwaysCreateTextNode?l=l[t.textNodeName]:Object.keys(l).length===0&&(t.alwaysCreateTextNode?l[t.textNodeName]="":l=""),s[a]!==void 0&&s.hasOwnProperty(a)?(Array.isArray(s[a])||(s[a]=[s[a]]),s[a].push(l)):t.isArray(a,c,h)?s[a]=[l]:s[a]=l}}}return typeof i=="string"?i.length>0&&(s[t.textNodeName]=i):i!==void 0&&(s[t.textNodeName]=i),s}function NM(r){const t=Object.keys(r);for(let e=0;e<t.length;e++){const i=t[e];if(i!==":@")return i}}function PM(r,t,e,i){if(t){const s=Object.keys(t),n=s.length;for(let o=0;o<n;o++){const a=s[o];i.isArray(a,e+"."+a,!0,!0)?r[a]=[t[a]]:r[a]=t[a]}}}function LM(r,t){const{textNodeName:e}=t,i=Object.keys(r).length;return!!(i===0||i===1&&(r[e]||typeof r[e]=="boolean"||r[e]===0))}SR.prettify=xM;const{buildOptions:MM}=kE,DM=OM,{prettify:UM}=SR,BM=UE;let kM=class{constructor(t){this.externalEntities={},this.options=MM(t)}parse(t,e){if(typeof t!="string")if(t.toString)t=t.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(e){e===!0&&(e={});const n=BM.validate(t,e);if(n!==!0)throw Error(`${n.err.msg}:${n.err.line}:${n.err.col}`)}const i=new DM(this.options);i.addExternalEntities(this.externalEntities);const s=i.parseXml(t);return this.options.preserveOrder||s===void 0?s:UM(s,this.options)}addEntity(t,e){if(e.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(t.indexOf("&")!==-1||t.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(e==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=e}};var VM=kM;const zM=`
`;function YM(r,t){let e="";return t.format&&t.indentBy.length>0&&(e=zM),_R(r,t,"",e)}function _R(r,t,e,i){let s="",n=!1;for(let o=0;o<r.length;o++){const a=r[o],c=GM(a);if(c===void 0)continue;let l="";if(e.length===0?l=c:l=`${e}.${c}`,c===t.textNodeName){let p=a[c];HM(l,t)||(p=t.tagValueProcessor(c,p),p=FR(p,t)),n&&(s+=i),s+=p,n=!1;continue}else if(c===t.cdataPropName){n&&(s+=i),s+=`<![CDATA[${a[c][0][t.textNodeName]}]]>`,n=!1;continue}else if(c===t.commentPropName){s+=i+`<!--${a[c][0][t.textNodeName]}-->`,n=!0;continue}else if(c[0]==="?"){const p=Tb(a[":@"],t),m=c==="?xml"?"":i;let g=a[c][0][t.textNodeName];g=g.length!==0?" "+g:"",s+=m+`<${c}${g}${p}?>`,n=!0;continue}let h=i;h!==""&&(h+=t.indentBy);const u=Tb(a[":@"],t),d=i+`<${c}${u}`,f=_R(a[c],t,l,h);t.unpairedTags.indexOf(c)!==-1?t.suppressUnpairedNode?s+=d+">":s+=d+"/>":(!f||f.length===0)&&t.suppressEmptyNode?s+=d+"/>":f&&f.endsWith(">")?s+=d+`>${f}${i}</${c}>`:(s+=d+">",f&&i!==""&&(f.includes("/>")||f.includes("</"))?s+=i+t.indentBy+f+i:s+=f,s+=`</${c}>`),n=!0}return s}function GM(r){const t=Object.keys(r);for(let e=0;e<t.length;e++){const i=t[e];if(r.hasOwnProperty(i)&&i!==":@")return i}}function Tb(r,t){let e="";if(r&&!t.ignoreAttributes)for(let i in r){if(!r.hasOwnProperty(i))continue;let s=t.attributeValueProcessor(i,r[i]);s=FR(s,t),s===!0&&t.suppressBooleanAttributes?e+=` ${i.substr(t.attributeNamePrefix.length)}`:e+=` ${i.substr(t.attributeNamePrefix.length)}="${s}"`}return e}function HM(r,t){r=r.substr(0,r.length-t.textNodeName.length-1);let e=r.substr(r.lastIndexOf(".")+1);for(let i in t.stopNodes)if(t.stopNodes[i]===r||t.stopNodes[i]==="*."+e)return!0;return!1}function FR(r,t){if(r&&r.length>0&&t.processEntities)for(let e=0;e<t.entities.length;e++){const i=t.entities[e];r=r.replace(i.regex,i.val)}return r}var $M=YM;const WM=$M,jM={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(r,t){return t},attributeValueProcessor:function(r,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Ur(r){this.options=Object.assign({},jM,r),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=qM),this.processTextOrObjNode=XM,this.options.format?(this.indentate=ZM,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}Ur.prototype.build=function(r){return this.options.preserveOrder?WM(r,this.options):(Array.isArray(r)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(r={[this.options.arrayNodeName]:r}),this.j2x(r,0).val)};Ur.prototype.j2x=function(r,t){let e="",i="";for(let s in r)if(Object.prototype.hasOwnProperty.call(r,s))if(typeof r[s]>"u")this.isAttribute(s)&&(i+="");else if(r[s]===null)this.isAttribute(s)?i+="":s[0]==="?"?i+=this.indentate(t)+"<"+s+"?"+this.tagEndChar:i+=this.indentate(t)+"<"+s+"/"+this.tagEndChar;else if(r[s]instanceof Date)i+=this.buildTextValNode(r[s],s,"",t);else if(typeof r[s]!="object"){const n=this.isAttribute(s);if(n)e+=this.buildAttrPairStr(n,""+r[s]);else if(s===this.options.textNodeName){let o=this.options.tagValueProcessor(s,""+r[s]);i+=this.replaceEntitiesValue(o)}else i+=this.buildTextValNode(r[s],s,"",t)}else if(Array.isArray(r[s])){const n=r[s].length;let o="",a="";for(let c=0;c<n;c++){const l=r[s][c];if(!(typeof l>"u"))if(l===null)s[0]==="?"?i+=this.indentate(t)+"<"+s+"?"+this.tagEndChar:i+=this.indentate(t)+"<"+s+"/"+this.tagEndChar;else if(typeof l=="object")if(this.options.oneListGroup){const h=this.j2x(l,t+1);o+=h.val,this.options.attributesGroupName&&l.hasOwnProperty(this.options.attributesGroupName)&&(a+=h.attrStr)}else o+=this.processTextOrObjNode(l,s,t);else if(this.options.oneListGroup){let h=this.options.tagValueProcessor(s,l);h=this.replaceEntitiesValue(h),o+=h}else o+=this.buildTextValNode(l,s,"",t)}this.options.oneListGroup&&(o=this.buildObjectNode(o,s,a,t)),i+=o}else if(this.options.attributesGroupName&&s===this.options.attributesGroupName){const n=Object.keys(r[s]),o=n.length;for(let a=0;a<o;a++)e+=this.buildAttrPairStr(n[a],""+r[s][n[a]])}else i+=this.processTextOrObjNode(r[s],s,t);return{attrStr:e,val:i}};Ur.prototype.buildAttrPairStr=function(r,t){return t=this.options.attributeValueProcessor(r,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&t==="true"?" "+r:" "+r+'="'+t+'"'};function XM(r,t,e){const i=this.j2x(r,e+1);return r[this.options.textNodeName]!==void 0&&Object.keys(r).length===1?this.buildTextValNode(r[this.options.textNodeName],t,i.attrStr,e):this.buildObjectNode(i.val,t,i.attrStr,e)}Ur.prototype.buildObjectNode=function(r,t,e,i){if(r==="")return t[0]==="?"?this.indentate(i)+"<"+t+e+"?"+this.tagEndChar:this.indentate(i)+"<"+t+e+this.closeTag(t)+this.tagEndChar;{let s="</"+t+this.tagEndChar,n="";return t[0]==="?"&&(n="?",s=""),(e||e==="")&&r.indexOf("<")===-1?this.indentate(i)+"<"+t+e+n+">"+r+s:this.options.commentPropName!==!1&&t===this.options.commentPropName&&n.length===0?this.indentate(i)+`<!--${r}-->`+this.newLine:this.indentate(i)+"<"+t+e+n+this.tagEndChar+r+this.indentate(i)+s}};Ur.prototype.closeTag=function(r){let t="";return this.options.unpairedTags.indexOf(r)!==-1?this.options.suppressUnpairedNode||(t="/"):this.options.suppressEmptyNode?t="/":t=`></${r}`,t};Ur.prototype.buildTextValNode=function(r,t,e,i){if(this.options.cdataPropName!==!1&&t===this.options.cdataPropName)return this.indentate(i)+`<![CDATA[${r}]]>`+this.newLine;if(this.options.commentPropName!==!1&&t===this.options.commentPropName)return this.indentate(i)+`<!--${r}-->`+this.newLine;if(t[0]==="?")return this.indentate(i)+"<"+t+e+"?"+this.tagEndChar;{let s=this.options.tagValueProcessor(t,r);return s=this.replaceEntitiesValue(s),s===""?this.indentate(i)+"<"+t+e+this.closeTag(t)+this.tagEndChar:this.indentate(i)+"<"+t+e+">"+s+"</"+t+this.tagEndChar}};Ur.prototype.replaceEntitiesValue=function(r){if(r&&r.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){const e=this.options.entities[t];r=r.replace(e.regex,e.val)}return r};function ZM(r){return this.options.indentBy.repeat(r)}function qM(r){return r.startsWith(this.options.attributeNamePrefix)&&r!==this.options.textNodeName?r.substr(this.attrPrefixLen):!1}var QM=Ur;const KM=UE,JM=VM,tD=QM;var OR={XMLParser:JM,XMLValidator:KM,XMLBuilder:tD};class eg{constructor(t,e){L(this,"date",new Date),L(this,"author"),L(this,"guid",Un.create()),L(this,"viewpoint"),L(this,"modifiedAuthor"),L(this,"modifiedDate"),L(this,"topic"),L(this,"_components"),L(this,"_comment",""),this._components=t,this._comment=e;const i=this._components.get(De);this.author=i.config.author}set comment(t){var e;const i=this._components.get(De);this._comment=t,this.modifiedDate=new Date,this.modifiedAuthor=i.config.author,(e=this.topic)==null||e.comments.set(this.guid,this)}get comment(){return this._comment}serialize(){let t=null;this.viewpoint&&(t=`<Viewpoint Guid="${this.viewpoint.guid}"/>`);let e=null;this.modifiedDate&&(e=`<ModifiedDate>${this.modifiedDate.toISOString()}</ModifiedDate>`);let i=null;return this.modifiedAuthor&&(i=`<ModifiedAuthor>${this.modifiedAuthor}</ModifiedAuthor>`),`
      <Comment Guid="${this.guid}">
        <Date>${this.date.toISOString()}</Date>
        <Author>${this.author}</Author>
        <Comment>${this.comment}</Comment>
        ${t??""}
        ${i??""}
        ${e??""}
      </Comment>
    `}}const xR=class Jn{constructor(t){L(this,"guid",Un.create()),L(this,"title",Jn.default.title),L(this,"creationDate",new Date),L(this,"creationAuthor",""),L(this,"viewpoints",new Ir),L(this,"relatedTopics",new Ir),L(this,"comments",new Os),L(this,"customData",{}),L(this,"description"),L(this,"serverAssignedId"),L(this,"dueDate"),L(this,"modifiedAuthor"),L(this,"modifiedDate"),L(this,"index"),L(this,"_type",Jn.default.type),L(this,"_status",Jn.default.status),L(this,"_priority",Jn.default.priority),L(this,"_stage",Jn.default.stage),L(this,"_assignedTo",Jn.default.assignedTo),L(this,"_labels",Jn.default.labels??new Set),L(this,"_components"),this._components=t;const e=t.get(De);this.creationAuthor=e.config.author,this.relatedTopics.guard=i=>i!==this.guid}set type(t){const e=this._components.get(De),{strict:i,types:s}=e.config;(!i||s.has(t))&&(this._type=t)}get type(){return this._type}set status(t){const e=this._components.get(De),{strict:i,statuses:s}=e.config;(!i||s.has(t))&&(this._status=t)}get status(){return this._status}set priority(t){const e=this._components.get(De);if(t){const{strict:i,priorities:s}=e.config;if(!(i?s.has(t):!0))return;this._priority=t}else this._priority=t}get priority(){return this._priority}set stage(t){const e=this._components.get(De);if(t){const{strict:i,stages:s}=e.config;if(!(i?s.has(t):!0))return;this._stage=t}else this._stage=t}get stage(){return this._stage}set assignedTo(t){const e=this._components.get(De);if(t){const{strict:i,users:s}=e.config;if(!(i?s.has(t):!0))return;this._assignedTo=t}else this._assignedTo=t}get assignedTo(){return this._assignedTo}set labels(t){const e=this._components.get(De),{strict:i,labels:s}=e.config;if(i){const n=new Set;for(const o of t)(!i||s.has(o))&&n.add(o);this._labels=n}else this._labels=t}get labels(){return this._labels}get _managerVersion(){return this._components.get(De).config.version}set(t){const e=t,i=this;for(const n in t){if(n==="guid")continue;const o=e[n];n in this&&(i[n]=o)}return this._components.get(De).list.set(this.guid,this),this}createComment(t,e){const i=new eg(this._components,t);return i.viewpoint=e,i.topic=this,this.comments.set(i.guid,i),i}createLabelTags(t=this._managerVersion){let e="Labels";t==="2.1"&&(e="Labels"),t==="3"&&(e="Label");let i=[...this.labels].map(s=>`<${e}>${s}</${e}>`).join(`
`);for(const s in this.customData){const n=this.customData[s];typeof n=="string"&&(i+=`
<${e}>${n}</${e}>`)}return t==="2.1"?i:t==="3"?i.length!==0?`<Labels>
${i}
</Labels>`:"<Labels/>":i}createCommentTags(t=this._managerVersion){const e=[...this.comments.values()].map(i=>i.serialize()).join(`
`);return t==="2.1"?e:t==="3"?e.length!==0?`<Comments>
${e}
</Comments>`:"<Comments/>":e}createViewpointTags(t=this._managerVersion){let e="Viewpoints";t==="2.1"&&(e="Viewpoints"),t==="3"&&(e="ViewPoint");const i=this._components.get(Zi),n=[...this.viewpoints].map(o=>i.list.get(o)).filter(o=>o).map(o=>`<${e} Guid="${o.guid}">
          <Viewpoint>${o.guid}.bcfv</Viewpoint>
          <Snapshot>${o.guid}.jpeg</Snapshot>
        </${e}>
      `).join(`
`);return t==="2.1"?n:t==="3"?n.length!==0?`<Viewpoints>
${n}
</Viewpoints>`:"<Viewpoints />":n}createRelatedTopicTags(t=this._managerVersion){const e=[...this.relatedTopics].map(i=>`<RelatedTopic Guid="${i}"></RelatedTopic>
      `).join(`
`);return t==="2.1"?e:t==="3"?e.length!==0?`<RelatedTopics>
${e}
</RelatedTopics>`:"<RelatedTopics />":e}serialize(){const t=this._managerVersion;let e=null;this.serverAssignedId&&(e=`ServerAssignedId="${this.serverAssignedId}"`);let i=null;this.priority&&(i=`<Priority>${this.priority}</Priority>`);let s=null;this.index&&t==="2.1"&&(s=`<Index>${this.index}</Index>`);let n=null;this.modifiedDate&&(n=`<ModifiedDate>${this.modifiedDate.toISOString()}</ModifiedDate>`);let o=null;this.modifiedAuthor&&(o=`<ModifiedAuthor>${this.modifiedAuthor}</ModifiedAuthor>`);let a=null;this.dueDate&&(a=`<DueDate>${this.dueDate.toISOString()}</DueDate>`);let c=null;this.assignedTo&&(c=`<AssignedTo>${this.assignedTo}</AssignedTo>`);let l=null;this.description&&(l=`<Description>${this.description}</Description>`);let h=null;this.stage&&(h=`<Stage>${this.stage}</Stage>`);const u=this.createCommentTags(t),d=this.createViewpointTags(t),f=this.createLabelTags(t),p=this.createRelatedTopicTags(t);return`
      <?xml version="1.0" encoding="UTF-8"?>
      <Markup>
        <Topic Guid="${this.guid}" TopicType="${this.type}" TopicStatus="${this.status}" ${e??""}>
          <Title>${this.title}</Title>
          <CreationDate>${this.creationDate.toISOString()}</CreationDate>
          <CreationAuthor>${this.creationAuthor}</CreationAuthor>
          ${i??""}
          ${s??""}
          ${n??""}
          ${o??""}
          ${a??""}
          ${c??""}
          ${l??""}
          ${h??""}
          ${f}
          ${p}
          ${t==="3"?u:""}
          ${t==="3"?d:""}
        </Topic>
        ${t==="2.1"?u:""}
        ${t==="2.1"?d:""}
      </Markup>
    `}};L(xR,"default",{title:"BCF Topic",type:"Issue",status:"Active"});let Xs=xR;const eD=(r,t)=>{if(t.trim()==="")return;const e=De.xmlParser.parse(t).Extensions;if(!e)return;const{Priorities:i,TopicStatuses:s,TopicTypes:n,Users:o}=e;if(i&&i.Priority){const a=Array.isArray(i.Priority)?i.Priority:[i.Priority];for(const c of a)r.config.priorities.add(c)}if(s&&s.TopicStatus){const a=Array.isArray(s.TopicStatus)?s.TopicStatus:[s.TopicStatus];for(const c of a)r.config.statuses.add(c)}if(n&&n.TopicType){const a=Array.isArray(n.TopicType)?n.TopicType:[n.TopicType];for(const c of a)r.config.types.add(c)}if(o&&o.User){const a=Array.isArray(o.User)?o.User:[o.User];for(const c of a)r.config.users.add(c)}};class iD extends Ho{constructor(){super(...arguments),L(this,"_config",{version:{type:"Select",options:new Set(["2.1","3"]),multiple:!1,value:""},author:{type:"Text",value:""},types:{type:"TextSet",value:new Set},statuses:{type:"TextSet",value:new Set},priorities:{type:"TextSet",value:new Set},labels:{type:"TextSet",value:new Set},stages:{type:"TextSet",value:new Set},users:{type:"TextSet",value:new Set},includeSelectionTag:{type:"Boolean",value:!1},updateExtensionsOnImport:{type:"Boolean",value:!1},strict:{type:"Boolean",value:!1},includeAllExtensionsOnExport:{type:"Boolean",value:!1},fallbackVersionOnImport:{type:"Select",multiple:!1,options:new Set(["2.1","3"]),value:""},ignoreIncompleteTopicsOnImport:{type:"Boolean",value:!1}})}get version(){return this._config.version.value}set version(t){this._config.version.value=t}get author(){return this._config.author.value}set author(t){this._config.author.value=t}get types(){return this._config.types.value}set types(t){this._config.types.value=t}get statuses(){return this._config.statuses.value}set statuses(t){this._config.statuses.value=t}get priorities(){return this._config.priorities.value}set priorities(t){this._config.priorities.value=t}get labels(){return this._config.labels.value}set labels(t){this._config.labels.value=t}get stages(){return this._config.stages.value}set stages(t){this._config.stages.value=t}get users(){return this._config.users.value}set users(t){this._config.users.value=t}get includeSelectionTag(){return this._config.includeSelectionTag.value}set includeSelectionTag(t){this._config.includeSelectionTag.value=t}get updateExtensionsOnImport(){return this._config.updateExtensionsOnImport.value}set updateExtensionsOnImport(t){this._config.updateExtensionsOnImport.value=t}get strict(){return this._config.strict.value}set strict(t){this._config.strict.value=t}get includeAllExtensionsOnExport(){return this._config.includeAllExtensionsOnExport.value}set includeAllExtensionsOnExport(t){this._config.includeAllExtensionsOnExport.value=t}get fallbackVersionOnImport(){return this._config.fallbackVersionOnImport.value}set fallbackVersionOnImport(t){this._config.fallbackVersionOnImport.value=t}get ignoreIncompleteTopicsOnImport(){return this._config.ignoreIncompleteTopicsOnImport.value}set ignoreIncompleteTopicsOnImport(t){this._config.ignoreIncompleteTopicsOnImport.value=t}}const VE=class Jl extends oe{constructor(){super(...arguments),L(this,"enabled",!1),L(this,"_defaultConfig",{author:"jhon.doe@example.com",version:"2.1",types:new Set(["Clash","Failure","Fault","Inquiry","Issue","Remark","Request"]),statuses:new Set(["Active","In Progress","Done","In Review","Closed"]),priorities:new Set(["On hold","Minor","Normal","Major","Critical"]),labels:new Set,stages:new Set,users:new Set,includeSelectionTag:!1,updateExtensionsOnImport:!0,strict:!1,includeAllExtensionsOnExport:!0,fallbackVersionOnImport:"2.1",ignoreIncompleteTopicsOnImport:!1}),L(this,"config",new iD(this,this.components,"BCF Topics",Jl.uuid)),L(this,"list",new Os),L(this,"onSetup",new It),L(this,"isSetup",!1),L(this,"onBCFImported",new It),L(this,"onDisposed",new It)}setup(t){if(this.isSetup)return;const e={...this._defaultConfig,...t};this.config.version=e.version,this.config.author=e.author,this.config.types=e.types,this.config.statuses=e.statuses,this.config.priorities=e.priorities,this.config.labels=e.labels,this.config.stages=e.stages,this.config.users=e.users,this.config.includeSelectionTag=e.includeSelectionTag,this.config.updateExtensionsOnImport=e.updateExtensionsOnImport,this.config.strict=e.strict,this.config.includeAllExtensionsOnExport=e.includeAllExtensionsOnExport,this.config.fallbackVersionOnImport=e.fallbackVersionOnImport||"",this.config.ignoreIncompleteTopicsOnImport=e.ignoreIncompleteTopicsOnImport,this.isSetup=!0,this.enabled=!0,this.onSetup.trigger()}create(t){const e=new Xs(this.components);return t?(e.guid=t.guid??e.guid,e.set(t)):this.list.set(e.guid,e),e}dispose(){this.list.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}get usedTypes(){const t=[...this.list].map(([e,i])=>i.type);return new Set(t)}get usedStatuses(){const t=[...this.list].map(([e,i])=>i.status);return new Set(t)}get usedPriorities(){const t=[...this.list].map(([e,i])=>i.priority).filter(e=>e);return new Set(t)}get usedStages(){const t=[...this.list].map(([e,i])=>i.stage).filter(e=>e);return new Set(t)}get usedUsers(){const t=[];for(const[e,i]of this.list){t.push(i.creationAuthor),i.assignedTo&&t.push(i.assignedTo),i.modifiedAuthor&&t.push(i.modifiedAuthor);for(const[s,n]of i.comments)t.push(n.author),n.modifiedAuthor&&t.push(n.modifiedAuthor)}return new Set(t)}get usedLabels(){const t=[];for(const[e,i]of this.list)t.push(...i.labels);return new Set(t)}updateExtensions(){for(const[t,e]of this.list){for(const i of e.labels)this.config.labels.add(i);this.config.types.add(e.type),e.priority&&this.config.priorities.add(e.priority),e.stage&&this.config.stages.add(e.stage),this.config.statuses.add(e.status),this.config.users.add(e.creationAuthor),e.assignedTo&&this.config.users.add(e.assignedTo),e.modifiedAuthor&&this.config.users.add(e.modifiedAuthor);for(const[i,s]of e.comments)this.config.users.add(s.author),s.modifiedAuthor&&this.config.users.add(s.modifiedAuthor)}}updateViewpointReferences(){const t=this.components.get(Zi);for(const[e,i]of this.list)for(const s of i.viewpoints)t.list.has(s)||i.viewpoints.delete(s)}async export(t=this.list.values()){const e=new Ib;e.file("bcf.version",`<?xml version="1.0" encoding="UTF-8"?>
    <Version VersionId="${this.config.version}" xsi:noNamespaceSchemaLocation="https://raw.githubusercontent.com/buildingSMART/BCF-XML/release_3_0/Schemas/version.xsd"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    </Version>`),e.file("bcf.extensions",this.serializeExtensions());const s=await(await fetch("https://thatopen.github.io/engine_components/resources/favicon.ico")).arrayBuffer(),n=this.components.get(Zi);for(const a of t){const c=e.folder(a.guid);c.file("markup.bcf",a.serialize());for(const l of a.viewpoints){const h=n.list.get(l);h&&(c.file(`${l}.jpeg`,s,{binary:!0}),c.file(`${l}.bcfv`,await h.serialize()))}}return await e.generateAsync({type:"blob"})}serializeExtensions(){const t=[...this.config.types].map(a=>`<TopicType>${a}</TopicType>`).join(`
`),e=[...this.config.statuses].map(a=>`<TopicStatus>${a}</TopicStatus>`).join(`
`),i=[...this.config.priorities].map(a=>`<Priority>${a}</Priority>`).join(`
`),s=[...this.config.labels].map(a=>`<TopicLabel>${a}</TopicLabel>`).join(`
`),n=[...this.config.stages].map(a=>`<Stage>${a}</Stage>`).join(`
`),o=[...this.config.users].map(a=>`<User>${a}</User>`).join(`
`);return`
      <?xml version="1.0" encoding="UTF-8"?>
      <Extensions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="your-schema-location.xsd">
        ${t.length!==0?`<TopicTypes>
${t}
</TopicTypes>`:""}
        ${e.length!==0?`<TopicStatuses>
${e}
</TopicStatuses>`:""}
        ${i.length!==0?`<Priorities>
${i}
</Priorities>`:""}
        ${s.length!==0?`<TopicLabels>
${s}
</TopicLabels>`:""}
        ${n.length!==0?`<Stages>
${n}
</Stages>`:""}
        ${o.length!==0?`<Users>
${o}
</Users>`:""}
      </Extensions>
    `}processMarkupComment(t){const{Guid:e,Date:i,Author:s,Comment:n,Viewpoint:o}=t;if(!(e&&i&&s&&eg))return null;const a=this.components.get(Zi),c=new eg(this.components,n??"");return c.guid=e,c.date=new Date(i),c.author=s,c.viewpoint=o?.Guid?a.list.get(o.Guid):void 0,c.modifiedAuthor=t.ModifiedAuthor,c.modifiedDate=t.ModifiedDate?new Date(t.ModifiedDate):void 0,c}getMarkupComments(t,e){var i;let s;if(e==="2.1"&&(s=t.Comment),e==="3"&&(s=(i=t.Topic.Comments)==null?void 0:i.Comment),!s)return[];s=Array.isArray(s)?s:[s];const n=s.map(a=>this.processMarkupComment(a)).filter(a=>a);return Array.isArray(n)?n:[n]}getMarkupLabels(t,e){var i;let s;return e==="2.1"&&(s=t.Topic.Labels),e==="3"&&(s=(i=t.Topic.Labels)==null?void 0:i.Label),s?Array.isArray(s)?s:[s]:[]}getMarkupViewpoints(t,e){var i;let s;return e==="2.1"&&(s=t.Viewpoints),e==="3"&&(s=(i=t.Topic.Viewpoints)==null?void 0:i.ViewPoint),s?(s=Array.isArray(s)?s:[s],s):[]}getMarkupRelatedTopics(t,e){var i;let s;return e==="2.1"&&(s=t.Topic.RelatedTopic),e==="3"&&(s=(i=t.Topic.RelatedTopics)==null?void 0:i.RelatedTopic),s?(Array.isArray(s)?s:[s]).map(o=>o.Guid):[]}async load(t,e){var i;const{fallbackVersionOnImport:s,ignoreIncompleteTopicsOnImport:n,updateExtensionsOnImport:o}=this.config,a=new Ib;await a.loadAsync(t);const c=Object.values(a.files);let l=s;const h=c.find(C=>C.name.endsWith(".version"));if(h){const C=await h.async("string"),b=Jl.xmlParser.parse(C).Version.VersionId;l=String(b)}if(!(l&&(l==="2.1"||l==="3")))throw new Error(`BCFTopics: ${l} is not supported.`);const u=c.find(C=>C.name.endsWith(".extensions"));if(o&&u){const C=await u.async("string");eD(this,C)}const d=[],f=this.components.get(Zi),p=c.filter(C=>C.name.endsWith(".bcfv"));for(const C of p){const b=await C.async("string"),E=Jl.xmlParser.parse(b).VisualizationInfo;if(!E){console.warn("Missing VisualizationInfo in Viewpoint");continue}const T={},{Guid:A,ClippingPlanes:S,Components:_,OrthogonalCamera:w,PerspectiveCamera:F}=E;if(A&&(T.guid=A),_){const{Selection:R,Visibility:O}=_;if(R&&R.Component){const U=Array.isArray(R.Component)?R.Component:[R.Component];T.selectionComponents=U.map(H=>H.IfcGuid).filter(H=>H)}if(O&&"DefaultVisibility"in O&&(T.defaultVisibility=O.DefaultVisibility),O&&O.Exceptions&&"Component"in O.Exceptions){const{Component:U}=O.Exceptions,H=Array.isArray(U)?U:[U];T.exceptionComponents=H.map(k=>k.IfcGuid).filter(k=>k)}let y;l==="2.1"&&(y=_.ViewSetupHints),l==="3"&&(y=(i=_.Visibility)==null?void 0:i.ViewSetupHints),y&&("OpeningsVisible"in y&&(T.openingsVisible=y.OpeningsVisible),"SpacesVisible"in y&&(T.spacesVisible=y.SpacesVisible),"SpaceBoundariesVisible"in y&&(T.spaceBoundariesVisible=y.SpaceBoundariesVisible))}if(w||F){const R=E.PerspectiveCamera??E.OrthogonalCamera,{CameraViewPoint:O,CameraDirection:y}=R,U=new M(Number(O.X),Number(O.Z),Number(-O.Y)),H=new M(Number(y.X),Number(y.Z),Number(-y.Y)),k={position:{x:U.x,y:U.y,z:U.z},direction:{x:H.x,y:H.y,z:H.z},aspectRatio:"AspectRatio"in R?R.AspectRatio:1};"ViewToWorldScale"in R&&(T.camera={...k,viewToWorldScale:R.ViewToWorldScale}),"FieldOfView"in R&&(T.camera={...k,fov:R.FieldOfView})}const D=new jR(this.components,e,{data:T,setCamera:!1});if(_){const{Coloring:R}=_;if(R&&R.Color){const O=Array.isArray(R.Color)?R.Color:[R.Color];for(const y of O){const{Color:U,Component:H}=y,X=(Array.isArray(H)?H:[H]).map($=>$.IfcGuid);D.componentColors.set(U,X)}}}if(d.push(D),S){const R=this.components.get(xL),O=Array.isArray(S.ClippingPlane)?S.ClippingPlane:[S.ClippingPlane];for(const y of O){const{Location:U,Direction:H}=y;if(!(U&&H))continue;const k=new M(U.X,U.Z,-U.Y),X=new M(H.X,-H.Z,H.Y),$=R.createFromNormalAndCoplanarPoint(e,X,k);$.visible=!1,$.enabled=!1,D.clippingPlanes.add($)}}}const m={},g=[],I=c.filter(C=>C.name.endsWith(".bcf"));for(const C of I){const b=await C.async("string"),E=Jl.xmlParser.parse(b).Markup,T=E.Topic,{Guid:A,TopicType:S,TopicStatus:_,Title:w,CreationDate:F,CreationAuthor:D}=T;if(n&&!(A&&S&&_&&w&&F&&D))continue;const R=new Xs(this.components);R.guid=A??R.guid;const O=this.getMarkupRelatedTopics(E,l);m[R.guid]=new Set(O),R.type=S??R.type,R.status=_??R.status,R.title=w??R.title,R.creationDate=F?new Date(F):R.creationDate,R.creationAuthor=D??R.creationAuthor,R.serverAssignedId=T.ServerAssignedId,R.priority=T.Priority,R.index=T.Index,R.modifiedDate=T.ModifiedDate?new Date(T.ModifiedDate):void 0,R.modifiedAuthor=T.ModifiedAuthor,R.dueDate=T.DueDate?new Date(T.DueDate):void 0,R.assignedTo=T.AssignedTo,R.description=T.Description,R.stage=T.Stage;const y=this.getMarkupLabels(E,l);for(const k of y)R.labels.add(k);const U=this.getMarkupComments(E,l);for(const k of U)R.comments.set(k.guid,k);const H=this.getMarkupViewpoints(E,l);for(const k of H){if(!(k&&k.Guid))continue;const X=f.list.get(k.Guid);X&&R.viewpoints.add(X.guid)}this.list.set(R.guid,R),g.push(R)}for(const C in m){const b=this.list.get(C);if(!b)continue;const E=m[C];for(const T of E)b.relatedTopics.add(T)}return this.onBCFImported.trigger(g),{viewpoints:d,topics:g}}};L(VE,"uuid","de977976-e4f6-4e4f-a01a-204727839802");L(VE,"xmlParser",new OR.XMLParser({allowBooleanAttributes:!0,attributeNamePrefix:"",ignoreAttributes:!1,ignoreDeclaration:!0,ignorePiTags:!0,numberParseOptions:{leadingZeros:!0,hex:!0},parseAttributeValue:!0,preserveOrder:!1,processEntities:!1,removeNSPrefix:!0,trimValues:!0}));let De=VE;const NR=class In extends oe{constructor(t){super(t),L(this,"enabled",!0),L(this,"onDisposed",new It),L(this,"_absoluteMin"),L(this,"_absoluteMax"),L(this,"_meshes",[]),this.components.add(In.uuid,this),this._absoluteMin=In.newBound(!0),this._absoluteMax=In.newBound(!1)}static getDimensions(t){const{min:e,max:i}=t,s=Math.abs(i.x-e.x),n=Math.abs(i.y-e.y),o=Math.abs(i.z-e.z),a=new M;return a.subVectors(i,e).divideScalar(2).add(e),{width:s,height:n,depth:o,center:a}}static newBound(t){const e=t?1:-1;return new M(e*Number.MAX_VALUE,e*Number.MAX_VALUE,e*Number.MAX_VALUE)}static getBounds(t,e,i){const s=i||this.newBound(!1),n=e||this.newBound(!0);for(const o of t)o.x<n.x&&(n.x=o.x),o.y<n.y&&(n.y=o.y),o.z<n.z&&(n.z=o.z),o.x>s.x&&(s.x=o.x),o.y>s.y&&(s.y=o.y),o.z>s.z&&(s.z=o.z);return new vt(e,i)}dispose(){const t=this.components.get(ac);for(const e of this._meshes)t.destroy(e);this._meshes=[],this.onDisposed.trigger(In.uuid),this.onDisposed.reset()}get(){const t=this._absoluteMin.clone(),e=this._absoluteMax.clone();return new vt(t,e)}getSphere(){const t=this._absoluteMin.clone(),e=this._absoluteMax.clone(),i=Math.abs((e.x-t.x)/2),s=Math.abs((e.y-t.y)/2),n=Math.abs((e.z-t.z)/2),o=new M(t.x+i,t.y+s,t.z+n),a=o.distanceTo(t);return new as(o,a)}getMesh(){const t=new vt(this._absoluteMin,this._absoluteMax),e=In.getDimensions(t),{width:i,height:s,depth:n,center:o}=e,a=new kt(i,s,n),c=new it(a);return this._meshes.push(c),c.position.copy(o),c}reset(){this._absoluteMin=In.newBound(!0),this._absoluteMax=In.newBound(!1)}add(t){for(const e of t.items)this.addMesh(e.mesh)}addMesh(t,e){if(!t.geometry.index)return;const i=In.getFragmentBounds(t);t.updateMatrixWorld();const s=t.matrixWorld,n=new ht,o=t instanceof Pe,a=new Set;if(t instanceof Rh){e||(e=t.fragment.ids);for(const c of e){const l=t.fragment.getInstancesIDs(c);if(l)for(const h of l)a.add(h)}}else a.add(0);for(const c of a){const l=i.min.clone(),h=i.max.clone();o&&(t.getMatrixAt(c,n),l.applyMatrix4(n),h.applyMatrix4(n)),l.applyMatrix4(s),h.applyMatrix4(s),l.x<this._absoluteMin.x&&(this._absoluteMin.x=l.x),l.y<this._absoluteMin.y&&(this._absoluteMin.y=l.y),l.z<this._absoluteMin.z&&(this._absoluteMin.z=l.z),l.x>this._absoluteMax.x&&(this._absoluteMax.x=l.x),l.y>this._absoluteMax.y&&(this._absoluteMax.y=l.y),l.z>this._absoluteMax.z&&(this._absoluteMax.z=l.z),h.x>this._absoluteMax.x&&(this._absoluteMax.x=h.x),h.y>this._absoluteMax.y&&(this._absoluteMax.y=h.y),h.z>this._absoluteMax.z&&(this._absoluteMax.z=h.z),h.x<this._absoluteMin.x&&(this._absoluteMin.x=h.x),h.y<this._absoluteMin.y&&(this._absoluteMin.y=h.y),h.z<this._absoluteMin.z&&(this._absoluteMin.z=h.z)}}addFragmentIdMap(t){const e=this.components.get(Bt);for(const i in t){const s=e.list.get(i);if(!s)continue;const n=t[i];this.addMesh(s.mesh,n)}}static getFragmentBounds(t){const e=t.geometry.attributes.position,i=Number.MAX_VALUE,s=-i,n=new M(i,i,i),o=new M(s,s,s);if(!t.geometry.index)throw new Error("Geometry must be indexed!");const a=Array.from(t.geometry.index.array);for(let c=0;c<a.length;c++){if(c%3===0&&a[c]===0&&a[c+1]===0&&a[c+2]===0){c+=2;continue}const l=a[c],h=e.getX(l),u=e.getY(l),d=e.getZ(l);h<n.x&&(n.x=h),u<n.y&&(n.y=u),d<n.z&&(n.z=d),h>o.x&&(o.x=h),u>o.y&&(o.y=u),d>o.z&&(o.z=d)}return new vt(n,o)}};L(NR,"uuid","d1444724-dba6-4cdd-a0c7-68ee1450d166");let sD=NR;const nD=class PR extends oe{constructor(t){super(t),L(this,"enabled",!0),t.add(PR.uuid,this)}async getIsolatedElements(t,e,i){const s=new Set;function n(c){if(s.has(c))return;const l=t.GetLine(e,c);if(l){s.add(c);for(const h in l){const u=l[h];u&&u.constructor.name==="Handle"&&u.value>0?n(u.value):Array.isArray(u)&&u.forEach(d=>{d&&d.constructor.name==="Handle"&&d.value>0&&n(d.value)})}}}for(const c of i)n(c);const o=[];for(const c of s)o.push(c);o.sort((c,l)=>c-l);const a=[];return o.forEach(c=>{const l=t.GetLine(e,c);a.push(l)}),a}async export(t,e,i){return i.forEach(n=>{t.WriteLine(e,n)}),t.SaveModel(e)}async splitIfc(t,e,i){const s=new Uint8Array(e),n=t.OpenModel(s),o=await this.getIsolatedElements(t,n,i),a=t.CreateModel({schema:ky.IFC2X3});return await this.export(t,a,o)}};L(nD,"uuid","6eb0ba2f-71c0-464e-bcec-2d7c335186b2");const LR=class MR{constructor(t){L(this,"onProgress",new It),L(this,"inclusive",!1),L(this,"rules",[]),L(this,"ids",{}),L(this,"needsUpdate",new Map),L(this,"components"),this.components=t}static import(t,e){const i=MR.importers.get(e.type);return i?i(t,e):(console.warn("Invalid query data:.",e),null)}static importRules(t){const e=[];for(const i of t){const s={};for(const n in i){const o=i[n];o.regexp?s[n]=new RegExp(o.value):s[n]=o}e.push(s)}return e}static importIds(t){const e={};for(const i in t.ids)e[i]=new Set(t.ids[i]);return e}clear(t){if(t===void 0){this.ids={},this.needsUpdate.clear();return}delete this.ids[t],this.needsUpdate.delete(t)}addID(t,e){this.ids[t]||(this.ids[t]=new Set),this.ids[t].add(e)}getData(){const t={};for(const i in this.ids)t[i]=Array.from(this.ids[i]);const e=this.exportRules();return{name:this.name,inclusive:this.inclusive,type:"IfcFinderQuery",ids:t,rules:e}}exportRules(){const t=[];for(const e of this.rules){const i={};for(const s in e){const n=e[s];n instanceof RegExp?i[s]={regexp:!0,value:n.source}:i[s]=n}t.push(i)}return t}findInFile(t,e){return new Promise(i=>{const s=new FileReader,n=new TextDecoder("utf-8"),o=1e4*1024,a=1e3;let c=0;const l=/;/,h=()=>{if(c>=e.size){i();return}const u=Math.min(c+o+a,e.size),d=e.slice(c,u);s.readAsArrayBuffer(d)};s.onload=()=>{if(!(s.result instanceof ArrayBuffer))return;const u=new Uint8Array(s.result),f=n.decode(u).split(l);f.shift(),this.findInLines(t,f),this.onProgress.trigger(c/e.size),c+=o,h()},h()})}getIdFromLine(t){const e=t.slice(t.indexOf("#")+1,t.indexOf("="));return parseInt(e,10)}testRules(t){let e=null,i=null,s=null,n=!1;for(const o of this.rules){if(o.type==="category"){if(e===null&&(e=this.getCategoryFromLine(t),e===null)){if(this.inclusive)continue;break}if(!o.value.test(e)){if(this.inclusive)continue;n=!1;break}n=!0;continue}if(i===null&&(i=this.getAttributesFromLine(t),i===null)){if(this.inclusive)continue;n=!1;break}if(e===null&&(e=this.getCategoryFromLine(t),e===null)){if(this.inclusive)continue;n=!1;break}if(s===null&&(s=Object.keys(new Vy[e]),s=s.slice(2),s===null)){if(this.inclusive)continue;n=!1;break}if(o.type==="property"){const{name:a,value:c}=o;if(!c.test(t)){if(this.inclusive)continue;n=!1;break}let l=!1;for(let h=0;h<i.length;h++){const u=i[h],d=s[h];if(c.test(u)&&a.test(d)){l=!0;break}}if(l)n=!0;else if(!this.inclusive){n=!1;break}}if(o.type==="operator"){const{name:a,value:c,operator:l}=o;let h=!1;for(let u=0;u<i.length;u++){const d=s[u],f=i[u].replace(/IFCLENGTHMEASURE\(|IFCVOLUMEMEASURE\(|\)/g,"");if(a.test(d)){if(l==="="&&parseFloat(f)===c){h=!0;break}else if(l==="<"&&parseFloat(f)<c){h=!0;break}else if(l===">"&&parseFloat(f)>c){h=!0;break}else if(l===">="&&parseFloat(f)>=c){h=!0;break}else if(l==="<="&&parseFloat(f)<=c){h=!0;break}}}if(h)n=!0;else if(!this.inclusive){n=!1;break}}}return n}getCategoryFromLine(t){const e=t.indexOf("=")+1,i=t.indexOf("("),s=t.slice(e,i).trim(),n=DL[s];return n||null}getAttributesFromLine(t){const e=/\((.*)\)/,i=t.match(e);if(!(i&&i[1]))return null;const s=/,(?![^()]*\))/g;return i[1].split(s).map(o=>o.trim())}};L(LR,"importers",new Map);let Sn=LR;class yb{constructor(t){L(this,"list",new Map),L(this,"id",Ss.generateUUID()),L(this,"mode","intersect"),L(this,"_components"),this._components=t}get queries(){return new Set(this.list.values())}get items(){const t=[];for(const e of this.queries)t.push(e.items);return this.mode==="combine"?ns.combine(t):ns.intersect(t)}add(t){if(this.list.has(t.name))throw new Error(`This group already has a query with the name ${t.name}.`);this.list.set(t.name,t)}clear(t){for(const e of this.queries)e.clear(t)}import(t){this.mode=t.mode,this.id=t.id;for(const e in t.queries){const i=Sn.import(this._components,t.queries[e]);i&&this.list.set(e,i)}}export(){const t={};for(const[e,i]of this.list)t[e]=i.export();return{mode:this.mode,id:this.id,queries:t}}async update(t,e){for(const i of this.queries){const s=i.needsUpdate.get(t);(s===void 0||s)&&await i.update(t,e)}}}const DR=class UR extends Sn{constructor(t,e){super(t),L(this,"name"),this.name=e.name,this.rules=e.rules,this.inclusive=e.inclusive}get items(){const t=this.components.get(Bt),e=[];for(const i in this.ids){const s=this.ids[i],n=t.groups.get(i);if(!n){console.warn(`Model ${i} not found!`);continue}const o=n.getFragmentMap(s);e.push(o)}return ns.combine(e)}export(){const t=this.getData();return t.type=UR.type,t}async update(t,e){this.ids[t]=new Set,await this.findInFile(t,e),this.needsUpdate.set(t,!1)}findInLines(t,e){for(const i of e)if(this.testRules(i)){const n=this.getIdFromLine(i);this.addID(t,n)}}};L(DR,"type","IfcBasicQuery");let vb=DR;Sn.importers.set(vb.type,(r,t)=>{const e=new vb(r,{name:t.name,rules:Sn.importRules(t.rules),inclusive:t.inclusive});return e.ids=Sn.importIds(t),e});const BR=class kR extends Sn{constructor(t,e){super(t),L(this,"name"),L(this,"psets",[]),this.name=e.name,this.rules=e.rules,this.inclusive=e.inclusive}get items(){const t=this.components.get(pe),e=this.components.get(Bt),i=[];for(const s in this.ids){const n=e.groups.get(s);if(!n){console.log(`Model not found: ${s}.`);continue}const o=this.ids[s];for(const a of o){const c=t.getEntityRelations(s,a,"DefinesOcurrence");if(c){const l=n.getFragmentMap(c);i.push(l)}}}return ns.combine(i)}export(){const t=this.getData();return t.type=kR.type,t}async update(t,e){await this.findInFile(t,e);const i=new Set;for(const s of this.psets){const n=this.getAttributesFromLine(s);if(n===null)continue;const o=n[4].replace("(","[").replace(")","]").replace(/#/g,""),a=JSON.parse(o);for(const c of a){const l=this.ids[t];if(l&&l.has(c)){const h=this.getIdFromLine(s);i.add(h);break}}}this.ids[t]=i,this.psets=[],this.needsUpdate.set(t,!1)}findInLines(t,e){for(const i of e){const s=this.getCategoryFromLine(i);if(s==="IfcPropertySet"){this.psets.push(i);continue}if(s!=="IfcPropertySingleValue")continue;if(this.testRules(i)){const o=this.getIdFromLine(i);this.addID(t,o)}}}};L(BR,"type","IfcPropertyQuery");let Rb=BR;Sn.importers.set(Rb.type,(r,t)=>{const e=new Rb(r,{name:t.name,inclusive:t.inclusive,rules:Sn.importRules(t.rules)});return e.ids=Sn.importIds(t),e});const rD=class VR extends oe{constructor(t){super(t),L(this,"enabled",!0),L(this,"list",new Map),t.add(VR.uuid,this)}get queries(){const t=new Set;for(const[,e]of this.list)for(const i of e.queries)t.add(i);return t}import(t){for(const e in t){const i=new yb(this.components);i.import(t[e]),this.list.set(e,i)}}export(){const t={};for(const[e,i]of this.list)t[e]=i.export();return t}create(){const t=new yb(this.components);return this.list.set(t.id,t),t}delete(t){this.list.delete(t)}clear(){this.list.clear()}};L(rD,"uuid","0da7ad77-f734-42ca-942f-a074adfd1e3a");const zR=class YR extends oe{constructor(t){super(t),L(this,"enabled",!0),L(this,"list",{}),L(this,"onDisposed",new It),L(this,"onFragmentsDisposed",i=>{const{groupID:s,fragmentIDs:n}=i;for(const o in this.list){const a=this.list[o],c=Object.keys(a);if(c.includes(s))delete a[s],Object.values(a).length===0&&delete this.list[o];else for(const l of c){const h=a[l];for(const u of n)delete h.map[u];Object.values(h).length===0&&delete a[l]}}}),t.add(YR.uuid,this),t.get(Bt).onFragmentsDisposed.add(this.onFragmentsDisposed)}dispose(){this.list={},this.components.get(Bt).onFragmentsDisposed.remove(this.onFragmentsDisposed),this.onDisposed.trigger(),this.onDisposed.reset()}remove(t){for(const e in this.list){const i=this.list[e];for(const s in i){const n=i[s];delete n.map[t]}}}find(t){const e=this.components.get(Bt);if(!t){const o={};for(const[a,c]of e.list)o[a]=new Set(c.ids);return o}const i=Object.keys(t).length,s={};for(const o in t){const a=t[o];if(!this.list[o]){console.warn(`Classification ${o} does not exist.`);continue}for(const c of a){const l=this.list[o][c];if(l)for(const h in l.map){s[h]||(s[h]=new Map);for(const u of l.map[h]){const d=s[h].get(u);d===void 0?s[h].set(u,1):s[h].set(u,d+1)}}}}const n={};for(const o in s){const a=s[o];for(const[c,l]of a){if(l===void 0)throw new Error("Malformed fragments map!");l===i&&(n[o]||(n[o]=new Set),n[o].add(c))}}return n}byModel(t,e){this.list.models||(this.list.models={});const i=this.list.models;i[t]||(i[t]={map:{},id:null,name:t});const s=i[t];for(const[n,o]of e.data){const a=o[0];for(const c of a){const l=e.keyFragments.get(c);l&&(s.map[l]||(s.map[l]=new Set),s.map[l].add(n))}}}async byPredefinedType(t){var e;this.list.predefinedTypes||(this.list.predefinedTypes={});const i=this.list.predefinedTypes,s=t.getAllPropertiesIDs();for(const n of s){const o=await t.getProperties(n);if(!o)continue;const a=String((e=o.PredefinedType)==null?void 0:e.value).toUpperCase();i[a]||(i[a]={map:{},id:null,name:a});const c=i[a];for(const[l,h]of t.data){const u=h[0];for(const d of u){const f=t.keyFragments.get(d);if(!f)throw new Error("Fragment ID not found!");c.map[f]||(c.map[f]=new Set),c.map[f].add(o.expressID)}}}}byEntity(t){this.list.entities||(this.list.entities={});for(const[e,i]of t.data){const n=i[1][1],o=Ar[n];this.saveItem(t,"entities",o,e)}}async byIfcRel(t,e,i){Wa.isRel(e)&&await Wa.getRelationMap(t,e,async(s,n)=>{const{name:o}=await Wa.getEntityName(t,s);for(const a of n)this.saveItem(t,i,o??"NO REL NAME",a)})}async bySpatialStructure(t,e={}){var i,s;const n=this.components.get(pe),o=n.relationMaps[t.uuid];if(!o)throw new Error(`Classifier: model relations of ${t.name||t.uuid} have to exists to group by spatial structure.`);const a=e.systemName??"spatialStructures",l=e.useProperties===void 0||e.useProperties;for(const[h]of o){if(e.isolate){const p=t.data.get(h);if(!p)continue;const m=p[1][1];if(m===void 0||!e.isolate.has(m))continue}const u=n.getEntityRelations(t,h,"Decomposes");if(u)for(const p of u){let m=p.toString();if(l){const g=await t.getProperties(p);if(!g)continue;m=(i=g.Name)==null?void 0:i.value}this.saveItem(t,a,m,h,p)}const d=n.getEntityRelations(t,h,"ContainsElements");if(!d)continue;let f=h.toString();if(l){const p=await t.getProperties(h);if(!p)continue;f=(s=p.Name)==null?void 0:s.value}for(const p of d){this.saveItem(t,a,f,p,h);const m=n.getEntityRelations(t,Number(p),"IsDecomposedBy");if(m)for(const g of m)this.saveItem(t,a,f,g,h)}}}setColor(t,e,i=!1){const s=this.components.get(Bt);for(const n in t){const o=s.list.get(n);if(!o)continue;const a=t[n];o.setColor(e,a,i)}}resetColor(t){const e=this.components.get(Bt);for(const i in t){const s=e.list.get(i);if(!s)continue;const n=t[i];s.resetColor(n)}}export(){const t={};for(const e in this.list){t[e]={};const i=this.list[e];for(const s in i){const n=i[s];t[e][s]={map:ns.export(n.map),name:n.name,id:n.id}}}return t}import(t){for(const e in t){this.list[e]||(this.list[e]={});const i=t[e];for(const s in i){const n=i[s];this.list[e][s]={map:ns.import(n.map),name:n.name,id:n.id}}}}saveItem(t,e,i,s,n=null){this.list[e]||(this.list[e]={});const o=t.data.get(s);if(o)for(const a of o[0]){const c=t.keyFragments.get(a);if(c){const l=this.list[e];l[i]||(l[i]={map:{},id:n,name:i}),l[i].map[c]||(l[i].map[c]=new Set),l[i].map[c].add(s)}}}};L(zR,"uuid","e25a7f3c-46c4-4a14-9d3d-5115f24ebeb7");let Fh=zR;const oD=class GR extends oe{constructor(t){super(t),L(this,"onDisposed",new It),L(this,"enabled",!0),L(this,"height",10),L(this,"groupName","spatialStructures"),L(this,"list",new Set),t.add(GR.uuid,this)}dispose(){this.list.clear(),this.onDisposed.trigger(),this.onDisposed.reset()}set(t){if(!this.enabled)return;const e=this.components.get(Fh),i=this.components.get(Bt),s=t?1:-1;let n=0;const o=e.list[this.groupName],a=new ht;for(const c in o){a.elements[13]=n*s*this.height;for(const l in o[c].map){const h=i.list.get(l),u=c+l,d=this.list.has(u);if(!h||t&&d||!t&&!d)continue;t?this.list.add(u):this.list.delete(u);const f=o[c].map[l];h.applyTransform(f,a),h.mesh.computeBoundingSphere(),h.mesh.computeBoundingBox()}n++}}};L(oD,"uuid","d260618b-ce88-4c7d-826c-6debb91de3e2");const HR=class $R extends oe{constructor(t){super(t),L(this,"enabled",!0),this.components.add($R.uuid,this)}set(t,e){const i=this.components.get(Bt);if(!e){for(const[s,n]of i.list)n&&(n.setVisibility(t),this.updateCulledVisibility(n));return}for(const s in e){const n=e[s],o=i.list.get(s);o&&(o.setVisibility(t,n),this.updateCulledVisibility(o))}}isolate(t){this.set(!1),this.set(!0,t)}updateCulledVisibility(t){const e=this.components.get(gL);for(const[i,s]of e.list){const n=s.colorMeshes.get(t.id);n&&(n.count=t.mesh.count)}}};L(HR,"uuid","dd9ccf2d-8a21-4821-b7f6-2949add16a29");let eu=HR;class aD extends ME{constructor(){super(...arguments),L(this,"minGeometrySize",10),L(this,"minAssetsSize",1e3),L(this,"maxTriangles",null)}}const cD=class WR extends oe{constructor(t){super(t),L(this,"onGeometryStreamed",new pr),L(this,"onAssetStreamed",new pr),L(this,"onProgress",new pr),L(this,"onIfcLoaded",new pr),L(this,"onDisposed",new It),L(this,"settings",new aD),L(this,"enabled",!0),L(this,"webIfc",new is),L(this,"_nextAvailableID",0),L(this,"_splittedGeometries",new Map),L(this,"_spatialTree",new hR),L(this,"_metaData",new dR),L(this,"_visitedGeometries",new Map),L(this,"_streamSerializer",new RE),L(this,"_geometries",new Map),L(this,"_geometryCount",0),L(this,"_civil",new uR),L(this,"_groupSerializer",new cp),L(this,"_assets",[]),L(this,"_meshesWithHoles",new Set),this.components.add(WR.uuid,this),this.settings.excludedCategories.add(Wf)}dispose(){this.onIfcLoaded.reset(),this.onGeometryStreamed.reset(),this.onAssetStreamed.reset(),this.webIfc=null,this.onDisposed.trigger(),this.onDisposed.reset()}async streamFromBuffer(t){await this.readIfcFile(t),await this.streamAllGeometries(),this.cleanUp()}async streamFromCallBack(t){await this.streamIfcFile(t),await this.streamAllGeometries(),this.cleanUp()}async readIfcFile(t){const{path:e,absolute:i,logLevel:s}=this.settings.wasm;this.webIfc.SetWasmPath(e,i),await this.webIfc.Init(),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModel(t,this.settings.webIfc),this._nextAvailableID=this.webIfc.GetMaxExpressID(0)}async streamIfcFile(t){const{path:e,absolute:i,logLevel:s}=this.settings.wasm;this.webIfc.SetWasmPath(e,i),await this.webIfc.Init(),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModelFromCallback(t,this.settings.webIfc),this._nextAvailableID=this.webIfc.GetMaxExpressID(0)}async streamAllGeometries(){console.log("Converting geometries to tiles...");const{minGeometrySize:t,minAssetsSize:e}=this.settings;this._spatialTree.setUp(this.webIfc);const i=this.webIfc.GetIfcEntityList(0),s=[[]],n=new si;n.ifcMetadata={name:"",description:"",...this._metaData.getNameInfo(this.webIfc),...this._metaData.getDescriptionInfo(this.webIfc),schema:this.webIfc.GetModelSchema(0)||"IFC2X3",maxExpressID:this.webIfc.GetMaxExpressID(0)};let o=0,a=0;for(const p of i){if(!this.webIfc.IsIfcElement(p)&&p!==Ii||this.settings.excludedCategories.has(p))continue;const m=this.webIfc.GetLineIDsWithType(0,p),g=m.size();for(let I=0;I<g;I++){o>t&&(o=0,a++,s.push([]));const C=m.get(I);s[a].push(C);const b=this.webIfc.GetLine(0,C);if(b.GlobalId){const T=b?.GlobalId.value||b?.GlobalId;n.globalToExpressIDs.set(T,C)}const E=this._spatialTree.itemsByFloor[C]||0;n.data.set(C,[[],[E,p]]),o++}}this._spatialTree.cleanUp();let c=.01,l=0;for(const p of s){l++,this.webIfc.StreamMeshes(0,p,g=>{this.getMesh(this.webIfc,g,n)}),this._geometryCount>this.settings.minGeometrySize&&await this.streamGeometries(),this._assets.length>e&&await this.streamAssets();const m=l/s.length;m>c&&(c+=.01,c=Math.max(c,m),await this.onProgress.trigger(Math.round(c*100)/100))}this._geometryCount&&await this.streamGeometries(),this._assets.length&&await this.streamAssets();const{opaque:h,transparent:u}=n.geometryIDs;for(const[p,{index:m,uuid:g}]of this._visitedGeometries)n.keyFragments.set(m,g),(p>1?h:u).set(p,m);fR.get(n,this.webIfc);const d=this.webIfc.GetCoordinationMatrix(0);n.coordinationMatrix.fromArray(d),n.civilData=this._civil.read(this.webIfc);const f=this._groupSerializer.export(n);await this.onIfcLoaded.trigger(f),n.dispose(!0)}cleanUp(){try{this.webIfc.Dispose()}catch{}this.webIfc=null,this.webIfc=new is,this._visitedGeometries.clear(),this._geometries.clear(),this._assets=[],this._meshesWithHoles.clear()}getMesh(t,e,i){const s=e.geometries.size(),n=e.expressID,o={id:n,geometries:[]};for(let a=0;a<s;a++){const c=e.geometries.get(a),l=c.geometryExpressID,h=c.color.w===1,d=l*(h?1:-1);this._visitedGeometries.has(d)||this.getGeometry(t,l,h),this.registerGeometryData(i,n,c,o,l,d);const f=this._splittedGeometries.get(l);if(f)for(const p of f)this.registerGeometryData(i,n,c,o,p,p)}this._assets.push(o)}getGeometry(t,e,i){const s=t.GetGeometry(0,e),n=t.GetIndexArray(s.GetIndexData(),s.GetIndexDataSize()),o=t.GetVertexArray(s.GetVertexData(),s.GetVertexDataSize()),a=new Float32Array(o.length/2),c=new Float32Array(o.length/2);for(let f=0;f<o.length;f+=6)a[f/2]=o[f],a[f/2+1]=o[f+1],a[f/2+2]=o[f+2],c[f/2]=o[f+3],c[f/2+1]=o[f+4],c[f/2+2]=o[f+5];const l=i?1:-1;if(n.length===0){const f=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1]);this._geometries.set(e,{position:a,normal:c,index:n,boundingBox:f,hasHoles:!1});const p=this._visitedGeometries.size,m=Ss.generateUUID(),g=e*l;this._visitedGeometries.set(g,{uuid:m,index:p}),this._geometryCount++,s.delete();return}const u=(this.settings.maxTriangles||n.length/3)*3;let d=!0;for(let f=0;f<n.length;f+=u){const p=n.length-f,m=Math.min(p,u),g=f+m,I=[],C=[],b=[];let E=0;for(let U=f;U<g;U++){I.push(E++);const H=n[U];C.push(a[H*3]),C.push(a[H*3+1]),C.push(a[H*3+2]),b.push(c[H*3]),b.push(c[H*3+1]),b.push(c[H*3+2])}const T=new Uint32Array(I),A=new Float32Array(C),S=new Float32Array(b),_=k2(A),w=new Float32Array(_.transformation.elements),F=!1,D=d?e:this._nextAvailableID++;this._geometries.set(D,{position:A,normal:S,index:T,boundingBox:w,hasHoles:F}),d||(this._splittedGeometries.has(e)||this._splittedGeometries.set(e,new Set),this._splittedGeometries.get(e).add(D));const R=this._visitedGeometries.size,O=Ss.generateUUID(),y=D*l;this._visitedGeometries.set(y,{uuid:O,index:R}),this._geometryCount++,d=!1}s.delete()}async streamAssets(){await this.onAssetStreamed.trigger(this._assets),this._assets=null,this._assets=[]}async streamGeometries(){const t=new Map;for(const[e,i]of this._geometries)t.set(e,i),t.size>this.settings.minGeometrySize&&await this.outputGeometries(t);await this.outputGeometries(t),this._geometries.clear(),this._geometryCount=0}async outputGeometries(t){let e=this._streamSerializer.export(t),i={};for(const[s,{boundingBox:n,hasHoles:o}]of t)i[s]={boundingBox:n,hasHoles:o};await this.onGeometryStreamed.trigger({data:i,buffer:e}),i=null,e=null,t.clear()}registerGeometryData(t,e,i,s,n,o){const a=this._visitedGeometries.get(o);if(a===void 0)throw new Error("Error getting geometry data for streaming!");const c=t.data.get(e);if(!c)throw new Error("Data not found!");c[0].push(a.index);const{x:l,y:h,z:u,w:d}=i.color,f=[l,h,u,d],p=i.flatTransformation;s.geometries.push({color:f,geometryID:n,transformation:p})}};L(cD,"uuid","d9999a00-e1f5-4d3f-8cfe-c56e08609764");class lD extends ME{constructor(){super(...arguments),L(this,"propertiesSize",100)}}class hD extends oe{constructor(){super(...arguments),L(this,"onPropertiesStreamed",new pr),L(this,"onProgress",new pr),L(this,"onIndicesStreamed",new pr),L(this,"onDisposed",new It),L(this,"enabled",!0),L(this,"settings",new lD),L(this,"webIfc",new is)}async dispose(){this.onIndicesStreamed.reset(),this.onPropertiesStreamed.reset(),this.webIfc=null,this.onDisposed.reset()}async streamFromBuffer(t){await this.readIfcFile(t),await this.streamAllProperties(),this.cleanUp()}async streamFromCallBack(t){await this.streamIfcFile(t),await this.streamAllProperties(),this.cleanUp()}async readIfcFile(t){const{path:e,absolute:i,logLevel:s}=this.settings.wasm;this.webIfc.SetWasmPath(e,i),await this.webIfc.Init(),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModel(t,this.settings.webIfc)}async streamIfcFile(t){const{path:e,absolute:i,logLevel:s}=this.settings.wasm;this.webIfc.SetWasmPath(e,i),await this.webIfc.Init(),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModelFromCallback(t,this.settings.webIfc)}async streamAllProperties(){const{propertiesSize:t}=this.settings,e=new Set(this.webIfc.GetIfcEntityList(0)),i=new Set([Bo,Nc,Pc,ko,Ii]);for(const c of i)e.add(c);let s=.01,n=0;for(const c of e){if(n++,pR.has(c))continue;const l=i.has(c),h=this.webIfc.GetLineIDsWithType(0,c),u=h.size();let d=0;for(let p=0;p<u-t;p+=t){const m={};for(let g=0;g<t;g++){d++;const I=h.get(p+g);try{const C=this.webIfc.GetLine(0,I,l);m[C.expressID]=C}catch{console.log(`Could not get property: ${I}`)}}await this.onPropertiesStreamed.trigger({type:c,data:m})}if(d!==u){const p={};for(let m=d;m<u;m++){const g=h.get(m);try{const I=this.webIfc.GetLine(0,g,l);p[I.expressID]=I}catch{console.log(`Could not get property: ${g}`)}}await this.onPropertiesStreamed.trigger({type:c,data:p})}n/e.size>s&&(s=Math.round(s*100)/100,await this.onProgress.trigger(s),s+=.01)}await this.onProgress.trigger(1);const a=await this.components.get(pe).processFromWebIfc(this.webIfc,0);await this.onIndicesStreamed.trigger(a)}cleanUp(){this.webIfc.Dispose(),this.webIfc=null,this.webIfc=new is}}L(hD,"uuid","88d2c89c-ce32-47d7-8cb6-d51e4b311a0b");class jR{constructor(t,e,i){L(this,"title"),L(this,"guid",Un.create()),L(this,"clippingPlanes",new Ir),L(this,"camera",{aspectRatio:1,fov:60,direction:{x:0,y:0,z:0},position:{x:0,y:0,z:0}}),L(this,"exceptionComponents",new Ir),L(this,"selectionComponents",new Ir),L(this,"componentColors",new Os),L(this,"spacesVisible",!1),L(this,"spaceBoundariesVisible",!1),L(this,"openingsVisible",!1),L(this,"defaultVisibility",!0),L(this,"_components"),L(this,"world");const s={setCamera:!0,...i},{data:n,setCamera:o}=s;this._components=t,this.world=e,n&&(this.guid=n.guid??this.guid,this.set(n)),o&&this.updateCamera()}get _selectionModelIdMap(){const t=this._components.get(Bt),e={};for(const[i,s]of t.groups){i in e||(e[i]=new Set);for(const n of this.selectionComponents){const o=s.globalToExpressIDs.get(n);o&&e[i].add(o)}}return e}get _exceptionModelIdMap(){const t=this._components.get(Bt),e={};for(const[i,s]of t.groups){i in e||(e[i]=new Set);for(const n of this.exceptionComponents){const o=s.globalToExpressIDs.get(n);o&&e[i].add(o)}}return e}get selection(){return this._components.get(Bt).modelIdToFragmentIdMap(this._selectionModelIdMap)}get exception(){return this._components.get(Bt).modelIdToFragmentIdMap(this._exceptionModelIdMap)}get projection(){return"fov"in this.camera?"Perspective":"Orthographic"}get position(){const t=this._components.get(Bt),{position:e}=this.camera,{x:i,y:s,z:n}=e,o=new M(i,s,n);return t.applyBaseCoordinateSystem(o,new ht),o}get direction(){const{direction:t}=this.camera,{x:e,y:i,z:s}=t;return new M(e,i,s)}get _managerVersion(){return this._components.get(De).config.version}get topics(){return[...this._components.get(De).list.values()].filter(s=>s.viewpoints.has(this.guid))}addComponentsFromMap(t){const i=this._components.get(Bt).fragmentIdMapToGuids(t);this.selectionComponents.add(...i),this._components.get(Zi).list.set(this.guid,this)}set(t){const e=t,i=this;for(const n in t){if(n==="guid")continue;const o=e[n];if(n==="selectionComponents"){this.selectionComponents.clear(),this.selectionComponents.add(...o);continue}if(n==="exceptionComponents"){this.exceptionComponents.clear(),this.exceptionComponents.add(...o);continue}n in this&&(i[n]=o)}return this._components.get(Zi).list.set(this.guid,this),this}async go(t,e=!0){const{camera:i}=t??this.world;if(!i.hasCameraControls())throw new Error("Viewpoint: the world's camera need controls to set the viewpoint.");i instanceof mp&&i.projection.set(this.projection);const s=new M(this.camera.position.x,this.camera.position.y,this.camera.position.z),n=new M(this.camera.direction.x,this.camera.direction.y,this.camera.direction.z);if(s.equals(new M)&&n.equals(new M))return;const o=this.position,a=this.direction;let c={x:o.x+a.x*80,y:o.y+a.y*80,z:o.z+a.z*80};const l=this.selection;if(Object.keys(l).length===0){const d=this._components.get(qI).get(this.world).castRayFromVector(o,this.direction);d&&(c=d.point)}else{const h=this._components.get(sD);h.reset(),h.addFragmentIdMap(l),c=h.getSphere().center,h.reset()}await i.controls.setLookAt(o.x,o.y,o.z,c.x,c.y,c.z,e)}updateCamera(t){const{camera:e,renderer:i}=t??this.world;if(!i)throw new Error("Viewpoint: the world needs to have a renderer!");if(!e.hasCameraControls())throw new Error("Viewpoint: world's camera need camera controls!");const s=new M;e.controls.getPosition(s);const n=e.three,o=new M(0,0,-1).applyEuler(n.rotation),{width:a,height:c}=i.getSize();let l=a/c;Number.isNaN(l)&&(l=1);const h=this._components.get(Bt);s.applyMatrix4(h.baseCoordinationMatrix.clone().invert());const u={aspectRatio:l,position:{x:s.x,y:s.y,z:s.z},direction:{x:o.x,y:o.y,z:o.z}};n instanceof hr?this.camera={...u,fov:n.fov}:n instanceof cs&&(this.camera={...u,viewToWorldScale:n.top-n.bottom}),this._components.get(Zi).list.set(this.guid,this)}applyVisibility(){const t=this._components.get(eu);t.set(this.defaultVisibility),t.set(!this.defaultVisibility,this.exception),t.set(!0,this.selection)}applyColors(){const t=this._components.get(Zi),e=this._components.get(Bt),i=this._components.get(Fh);for(const[s,n]of this.componentColors){const o=e.guidToFragmentIdMap(n);i.setColor(o,s,t.config.overwriteColors)}}resetColors(){const t=this._components.get(Bt),e=this._components.get(Fh);for(const[i,s]of this.componentColors){const n=t.guidToFragmentIdMap(s);e.resetColor(n)}}async createComponentTags(t){var e,i;const s=this._components.get(Bt),n=this._components.get(De);let o="";if(n.config.includeSelectionTag){const a=t==="selection"?this._selectionModelIdMap:this._exceptionModelIdMap;for(const c in a){const l=s.groups.get(c);if(!l)continue;const h=a[c];for(const u of h){const d=await l.getProperties(u);if(!d)continue;const f=(e=d.GlobalId)==null?void 0:e.value;if(!f)continue;const p=(i=d.Tag)==null?void 0:i.value;let m=null;p&&(m=`AuthoringToolId="${p}"`),o+=`
<Component IfcGuid="${f}" ${m??""} />`}}}else o=[...this.selectionComponents].map(a=>`<Component IfcGuid="${a}" />`).join(`
`);return o}createColorTags(){let t="";for(const[e,i]of this.componentColors.entries()){const s=`#${e.getHexString()}`,n=i.map(o=>`
<Component IfcGuid="${o}" />`).join(`
`);t+=`<Color Color="${s}">
${n}
</Color>`}return t.length!==0?`<Coloring>
${t}
</Coloring>`:"<Coloring />"}async serialize(t=this._managerVersion){const e=this._components.get(Bt),i=this.position;i.applyMatrix4(e.baseCoordinationMatrix.clone().invert());const s=this.direction;s.normalize();const n=new ht().makeRotationX(Math.PI/2),o=s.clone().applyMatrix4(n);o.normalize();const a=`<CameraViewPoint>
      <X>${i.x}</X>
      <Y>${-i.z}</Y>
      <Z>${i.y}</Z>
    </CameraViewPoint>`,c=`<CameraDirection>
      <X>${s.x}</X>
      <Y>${-s.z}</Y>
      <Z>${s.y}</Z>
    </CameraDirection>`,l=`<CameraUpVector>
      <X>${o.x}</X>
      <Y>${-o.z}</Y>
      <Z>${o.y}</Z>
    </CameraUpVector>`,h=`<AspectRatio>${this.camera.aspectRatio}</AspectRatio>`;let u="";"viewToWorld"in this.camera?u=`<OrthogonalCamera>
        ${a}
        ${c}
        ${l}
        ${h}
        <ViewToWorldScale>${this.camera.viewToWorld}</ViewToWorldScale>
      </OrthogonalCamera>`:"fov"in this.camera&&(u=`<PerspectiveCamera>
        ${a}
        ${c}
        ${l}
        ${h}
        <FieldOfView>${this.camera.fov}</FieldOfView>
      </PerspectiveCamera>`);const d=`<ViewSetupHints SpacesVisible="${this.spacesVisible??!1}" SpaceBoundariesVisible="${this.spaceBoundariesVisible??!1}" OpeningsVisible="${this.openingsVisible??!1}" />`,f=(await this.createComponentTags("selection")).trim(),p=(await this.createComponentTags("exception")).trim(),m=this.createColorTags();return`<?xml version="1.0" encoding="UTF-8"?>
    <VisualizationInfo Guid="${this.guid}">
      <Components>
        ${t==="2.1"?d:""}
        ${f.length!==0?`<Selection>${f}</Selection>`:""}
        <Visibility DefaultVisibility="${this.defaultVisibility}">
          ${t==="3"?d:""}
          ${p.length!==0?`<Exceptions>${p}</Exceptions>`:""}
        </Visibility>
        ${m}
      </Components>
      ${u}
    </VisualizationInfo>`}}class uD extends Ho{constructor(){super(...arguments),L(this,"_config",{overwriteColors:{value:!1,type:"Boolean"}})}get overwriteColors(){return this._config.overwriteColors.value}set overwriteColors(t){this._config.overwriteColors.value=t}}const XR=class ig extends oe{constructor(t){super(t),L(this,"enabled",!0),L(this,"list",new Os),L(this,"isSetup",!1),L(this,"onSetup",new It),L(this,"config",new uD(this,this.components,"Viewpoints",ig.uuid)),L(this,"onDisposed",new It),t.add(ig.uuid,this)}create(t,e){const i=new jR(this.components,t,{data:e});return e||this.list.set(i.guid,i),i}setup(){}dispose(){this.list.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}};L(XR,"uuid","ee867824-a796-408d-8aa0-4e5962a83c66");let Zi=XR;class dD extends Ho{constructor(){super(...arguments),L(this,"_config",{visible:{value:!0,type:"Boolean"},lockRotation:{value:!0,type:"Boolean"},zoom:{type:"Number",interpolable:!0,value:.05,min:.001,max:5},frontOffset:{type:"Number",interpolable:!0,value:0,min:0,max:100},sizeX:{type:"Number",interpolable:!0,value:320,min:20,max:5e3},sizeY:{type:"Number",interpolable:!0,value:160,min:20,max:5e3},backgroundColor:{value:new Rt,type:"Color"}})}get visible(){return this._config.visible.value}set visible(t){this._config.visible.value=t;const e=this._component.renderer.domElement.style;e.display=t?"block":"none"}get lockRotation(){return this._config.lockRotation.value}set lockRotation(t){this._config.lockRotation.value=t,this._component.lockRotation=t}get zoom(){return this._config.zoom.value}set zoom(t){this._config.zoom.value=t,this._component.zoom=t}get frontOffset(){return this._config.frontOffset.value}set frontOffset(t){this._config.frontOffset.value=t,this._component.frontOffset=t}get sizeX(){return this._config.sizeX.value}set sizeX(t){this._config.sizeX.value=t;const{sizeX:e,sizeY:i}=this._config,s=new Ot(e.value,i.value);this._component.resize(s)}get sizeY(){return this._config.sizeY.value}set sizeY(t){this._config.sizeY.value=t;const{sizeX:e,sizeY:i}=this._config,s=new Ot(e.value,i.value);this._component.resize(s)}get backgroundColor(){return this._config.backgroundColor.value}set backgroundColor(t){this._config.backgroundColor.value=t,this._component.backgroundColor=t}}class fD{constructor(t,e){if(L(this,"onDisposed",new It),L(this,"onAfterUpdate",new It),L(this,"onBeforeUpdate",new It),L(this,"onResize",new It),L(this,"onSetup",new It),L(this,"frontOffset",0),L(this,"overrideMaterial",new Jg),L(this,"backgroundColor",new Rt(395274)),L(this,"renderer"),L(this,"enabled",!0),L(this,"world"),L(this,"config"),L(this,"isSetup",!1),L(this,"_defaultConfig",{visible:!0,lockRotation:!1,zoom:.05,frontOffset:0,sizeX:320,sizeY:160,backgroundColor:new Rt(395274)}),L(this,"_lockRotation",!0),L(this,"_size",new Ot(320,160)),L(this,"_camera"),L(this,"_plane"),L(this,"_tempVector1",new M),L(this,"_tempVector2",new M),L(this,"_tempTarget",new M),L(this,"down",new M(0,-1,0)),L(this,"updatePlanes",()=>{if(!this.world.renderer)throw new Error("The given world must have a renderer!");const n=[],o=this.world.renderer.three;for(const a of o.clippingPlanes)n.push(a);n.push(this._plane),this.renderer.clippingPlanes=n}),this.world=t,!this.world.renderer)throw new Error("The given world must have a renderer!");this.renderer=new Qa,this.renderer.setSize(this._size.x,this._size.y);const i=1,s=this._size.x/this._size.y;this._camera=new cs(i*s/-2,i*s/2,i/2,i/-2),this.world.renderer.onClippingPlanesUpdated.add(this.updatePlanes),this._camera.position.set(0,200,0),this._camera.zoom=.1,this._camera.rotation.x=-Math.PI/2,this._plane=new Qe(this.down,200),this.updatePlanes(),this.config=new dD(this,e,"MiniMap")}get lockRotation(){return this._lockRotation}set lockRotation(t){this._lockRotation=t,t&&(this._camera.rotation.z=0)}get zoom(){return this._camera.zoom}set zoom(t){this._camera.zoom=t,this._camera.updateProjectionMatrix()}dispose(){this.enabled=!1,this.onBeforeUpdate.reset(),this.onAfterUpdate.reset(),this.onResize.reset(),this.overrideMaterial.dispose(),this.renderer.forceContextLoss(),this.renderer.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}get(){return this._camera}update(){if(!this.enabled)return;this.onBeforeUpdate.trigger();const t=this.world.scene.three,e=this.world.camera;if(!e.hasCameraControls())throw new Error("The given world must use camera controls!");if(!(t instanceof rn))throw new Error("The given world must have a THREE.Scene as a root!");const i=e.controls;if(i.getPosition(this._tempVector1),this._camera.position.x=this._tempVector1.x,this._camera.position.z=this._tempVector1.z,this.frontOffset!==0&&(i.getTarget(this._tempVector2),this._tempVector2.sub(this._tempVector1),this._tempVector2.normalize().multiplyScalar(this.frontOffset),this._camera.position.x+=this._tempVector2.x,this._camera.position.z+=this._tempVector2.z),!this._lockRotation){i.getTarget(this._tempTarget);const n=Math.atan2(this._tempTarget.x-this._tempVector1.x,this._tempTarget.z-this._tempVector1.z);this._camera.rotation.z=n+Math.PI}this._plane.set(this.down,this._tempVector1.y);const s=t.background;t.background=this.backgroundColor,this.renderer.render(t,this._camera),t.background=s,this.onAfterUpdate.trigger()}getSize(){return this._size}resize(t=this._size){this._size.copy(t),this.renderer.setSize(t.x,t.y);const e=t.x/t.y,i=1;this._camera.left=i*e/-2,this._camera.right=i*e/2,this._camera.top=i/2,this._camera.bottom=-i/2,this._camera.updateProjectionMatrix(),this.onResize.trigger(t)}setup(t){const e={...this._defaultConfig,...t};this.config.visible=!0,this.config.lockRotation=e.lockRotation,this.config.zoom=e.zoom,this.config.frontOffset=e.frontOffset,this.config.sizeX=e.sizeX,this.config.sizeY=e.sizeY,this.config.backgroundColor=e.backgroundColor,this.isSetup=!0,this.onSetup.trigger()}}const pD=class ZR extends oe{constructor(t){super(t),L(this,"onAfterUpdate",new It),L(this,"onBeforeUpdate",new It),L(this,"onDisposed",new It),L(this,"onSetup",new It),L(this,"enabled",!0),L(this,"list",new Map),this.components.add(ZR.uuid,this)}create(t){if(this.list.has(t.uuid))throw new Error("This world already has a minimap!");const e=new fD(t,this.components);return this.list.set(t.uuid,e),e}delete(t){const e=this.list.get(t);e&&e.dispose(),this.list.delete(t)}dispose(){for(const[t,e]of this.list)e.dispose();this.list.clear(),this.onDisposed.trigger()}update(){for(const[t,e]of this.list)e.update()}};L(pD,"uuid","39ad6aad-84c8-4adf-a1e0-7f25313a9e7f");const mD=class qR extends oe{constructor(t){super(t),L(this,"enabled",!0),t.add(qR.uuid,this)}static distanceFromPointToLine(t,e,i,s=!1){const n=new Vt,o=new M;return n.set(e,i),n.closestPointToPoint(t,s,o),o.distanceTo(t)}getFace(t,e,i){if(!t.geometry.index)throw new Error("Geometry must be indexed!");const s=new Map,n=t.geometry.index.array,{plane:o}=this.getFaceData(e,i,t),a=[];for(let u=0;u<n.length/3;u++){const{plane:d,edges:f}=this.getFaceData(u,i,t);if(d.equals(o)){a.push({index:u,edges:f});for(const{id:p,points:m,distance:g}of f)s.set(p,{points:m,distance:g})}}let c=0;const l=new Map,h=new Map;for(const{index:u,edges:d}of a){const f=new Map;for(const{id:E}of d)if(l.has(E)){const T=l.get(E);f.set(E,T)}const p=d.map(E=>E.id);if(!f.size){const E=c++;for(const{id:T}of d)l.set(T,E);h.set(E,{edges:new Set(p),indices:new Set([u])});continue}let m=null;const g=new Set,I=new Set(p);for(const[E,T]of f){m===null?m=T:T!==m&&g.add(T),l.delete(E);const{edges:A}=h.get(T);A.delete(E),I.delete(E)}if(m===null)throw new Error("Error computing face!");const C=h.get(m),{indices:b}=C;b.add(u);for(const E of I){l.set(E,m);const{edges:T}=C;T.add(E)}for(const E of g){const T=h.get(E),{edges:A,indices:S}=T,_=h.get(m),{edges:w,indices:F}=_;for(const D of A)w.add(D),l.set(D,m);for(const D of S)F.add(D);h.delete(E)}}for(const[u,{indices:d,edges:f}]of h)if(d.has(e)){const p=[];for(const m of f){const g=s.get(m);p.push(g)}return{edges:p,indices:d}}return null}getVerticesAndNormal(t,e,i){if(!t.geometry.index)throw new Error("Geometry must be indexed!");const s=t.geometry.index.array,n=t.geometry.attributes.position.array,o=t.geometry.attributes.normal.array,a=s[e*3]*3,c=s[e*3+1]*3,l=s[e*3+2]*3,h=new M(n[a],n[a+1],n[a+2]),u=new M(n[c],n[c+1],n[c+2]),d=new M(n[l],n[l+1],n[l+2]),f=new M(o[a],o[a+1],o[a+2]),p=new M(o[c],o[c+1],o[c+2]),m=new M(o[l],o[l+1],o[l+2]),g=(f.x+p.x+m.x)/3,I=(f.y+p.y+m.y)/3,C=(f.z+p.z+m.z)/3,b=new M(g,I,C);if(i!==void 0&&t instanceof Pe){const E=new ht;t.getMatrixAt(i,E);const T=new ht;T.extractRotation(E),b.applyMatrix4(T),h.applyMatrix4(E),u.applyMatrix4(E),d.applyMatrix4(E)}return{p1:h,p2:u,p3:d,faceNormal:b}}round(t){t.x=Math.trunc(t.x*1e3)/1e3,t.y=Math.trunc(t.y*1e3)/1e3,t.z=Math.trunc(t.z*1e3)/1e3}getVolumeFromFragments(t){const e=this.components.get(Bt),i=new ht,s=[];for(const o in t){const a=e.list.get(o);if(!a)continue;const c=t[o];let l=0;for(const d of c){const f=a.getInstancesIDs(d);f&&(l+=f.size)}const h=new Pe(a.mesh.geometry,void 0,l);let u=0;for(const d of c){const f=a.getInstancesIDs(d);if(f)for(const p of f)a.mesh.getMatrixAt(p,i),h.setMatrixAt(u++,i)}s.push(h)}const n=this.getVolumeFromMeshes(s);for(const o of s)o.geometry=null,o.material=[],o.dispose();return n}getVolumeFromMeshes(t){let e=0;for(const i of t)e+=this.getVolumeOfMesh(i);return e}getFaceData(t,e,i){const s=this.getVerticesAndNormal(i,t,e),{p1:n,p2:o,p3:a,faceNormal:c}=s;this.round(n),this.round(o),this.round(a),this.round(c);const l=[{id:`${n.x}|${n.y}|${n.z}`,value:n},{id:`${o.x}|${o.y}|${o.z}`,value:o},{id:`${a.x}|${a.y}|${a.z}`,value:a}];l.sort((C,b)=>C.id<b.id?-1:C.id>b.id?1:0);const[{id:h,value:u},{id:d,value:f},{id:p,value:m}]=l,g=[{id:`${h}|${d}`,distance:u.distanceTo(f),points:[u,f]},{id:`${d}|${p}`,distance:f.distanceTo(m),points:[f,m]},{id:`${h}|${p}`,distance:u.distanceTo(m),points:[u,m]}],I=new Qe;return I.setFromNormalAndCoplanarPoint(c,n),I.constant=Math.round(I.constant*10)/10,{plane:I,edges:g}}getVolumeOfMesh(t){let e=0;const i=new M,s=new M,n=new M,{index:o}=t.geometry,a=t.geometry.attributes.position.array;if(!o)return console.warn("Geometry must be indexed to compute its volume!"),0;const c=[];if(t instanceof Pe)for(let h=0;h<t.count;h++){const u=new ht;t.getMatrixAt(h,u),c.push(u)}else c.push(new ht().identity());const{matrixWorld:l}=t;for(let h=0;h<o.array.length-2;h+=3)for(const u of c){const d=u.multiply(l),f=o.array[h]*3,p=o.array[h+1]*3,m=o.array[h+2]*3;i.set(a[f],a[f+1],a[f+2]).applyMatrix4(d),s.set(a[p],a[p+1],a[p+2]).applyMatrix4(d),n.set(a[m],a[m+1],a[m+2]).applyMatrix4(d),e+=this.getSignedVolumeOfTriangle(i,s,n)}return Math.abs(e)}getSignedVolumeOfTriangle(t,e,i){const s=i.x*e.y*t.z,n=e.x*i.y*t.z,o=i.x*t.y*e.z,a=t.x*i.y*e.z,c=e.x*t.y*i.z,l=t.x*e.y*i.z;return 1/6*(-s+n+o-a-c+l)}};L(mD,"uuid","267ca032-672f-4cb0-afa9-d24e904f39d6");class gp{constructor(t){L(this,"cardinality","required"),L(this,"instructions"),L(this,"evalRequirement",(e,i,s,n)=>{const o={parameter:s,currentValue:e,requiredValue:i.parameter,pass:!1};n&&this.addCheckResult(o,n);let a=!1;if(i.type==="simple"&&(a=e===i.parameter),i.type==="enumeration"&&(a=i.parameter.includes(e)),i.type==="pattern"&&(a=new RegExp(i.parameter).test(String(e))),i.type==="length"){const{min:c,length:l,max:h}=i.parameter;l!==void 0&&(a=String(e).length===l),c!==void 0&&(a=String(e).length>=c),h!==void 0&&(a=String(e).length<=h)}if(i.type==="bounds"&&typeof e=="number"){const{min:c,minInclusive:l,max:h,maxInclusive:u}=i.parameter;let d=!0,f=!0;c!==void 0&&(d=l?e<=c:e<c),h!==void 0&&(f=u?e>=h:e>h),a=d&&f}return this.cardinality==="prohibited"&&(a=!a),this.cardinality==="optional"&&(a=!0),o.pass=a,o.pass}),L(this,"testResult",[]),this.components=t}addCheckResult(t,e){const i=e.findIndex(({parameter:s})=>s===t.parameter);i!==-1?e[i]=t:e.push(t)}saveResult(t,e){const{GlobalId:i}=t;if(!i)return;const{value:s}=i,n={expressID:s,pass:e,checks:[],cardinality:this.cardinality};this.testResult.push(n)}}const wn=(r,t)=>{let e="";return t?(t.type==="simple"&&(e=`<ids:simpleValue>${t.parameter}</ids:simpleValue>`),t.type==="enumeration"&&(e=`<xs:restriction base="xs:string">
    ${t.parameter.map(n=>`<xs:enumeration value="${n}" />`).join(`\r
`)}
    </xs:restriction>`),t.type==="pattern"&&(e=`<xs:restriction base="xs:string">
      <xs:pattern value="${t.parameter}" />
    </xs:restriction>`),`<ids:${r[0].toLowerCase()+r.slice(1)}>
    ${e}
  </ids:${r[0].toLowerCase()+r.slice(1)}>`):e};class ID extends gp{constructor(t,e){super(t),L(this,"facetType","Attribute"),L(this,"name"),L(this,"value"),this.name=e}serialize(t){const e=wn("Name",this.name),i=wn("Value",this.value);let s="";return t==="requirement"&&(s+=`cardinality="${this.cardinality}"`,s+=this.instructions?`instructions="${this.instructions}"`:""),`<ids:attribute ${s}>
  ${e}
  ${i}
</ids:attribute>`}async getEntities(){return[]}async test(t){var e;this.testResult=[];for(const s in t){const n=Number(s),o=t[n],a=[],c={guid:(e=o.GlobalId)==null?void 0:e.value,expressID:n,pass:!1,checks:a,cardinality:this.cardinality};this.testResult.push(c);const h=Object.keys(o).filter(d=>{const f=this.evalRequirement(d,this.name,"Name"),p=o[d];return f&&p===null?this.cardinality==="optional"||this.cardinality==="prohibited":f&&p?.type===3&&p.value===2||f&&Array.isArray(p)&&p.length===0||f&&p?.type===1&&p.value.trim()===""?!1:f}),u=h.length>0;if(a.push({parameter:"Name",currentValue:u?h[0]:null,requiredValue:this.name.parameter,pass:this.cardinality==="prohibited"?!u:u}),this.value)if(h[0]){const d=o[h[0]];d?.type===5?a.push({parameter:"Value",currentValue:null,requiredValue:this.value.parameter,pass:this.cardinality==="prohibited"}):this.evalRequirement(d?d.value:null,this.value,"Value",a)}else a.push({parameter:"Value",currentValue:null,requiredValue:this.value.parameter,pass:this.cardinality==="prohibited"});c.pass=a.every(({pass:d})=>d)}const i=[...this.testResult];return this.testResult=[],i}}class gD extends gp{constructor(t,e){super(t),L(this,"facetType","Classification"),L(this,"system"),L(this,"value"),L(this,"uri"),this.system=e}serialize(t){const e=wn("System",this.system),i=wn("Value",this.value);let s="";return t==="requirement"&&(s+=`cardinality="${this.cardinality}"`,s+=this.uri?`uri=${this.uri}`:"",s+=this.instructions?`instructions="${this.instructions}"`:""),`<ids:classification ${s}>
  ${e}
  ${i}
</ids:classification>`}async getEntities(t,e={}){var i;const s=[],n=await t.getAllPropertiesOfType(Me),o=await t.getAllPropertiesOfType(Vi),a={...n,...o},c=[];for(const h in a){const u=Number(h),d=await t.getProperties(u);if(!d)continue;const f=(i=d.ReferencedSource)==null?void 0:i.value;if(!f)continue;const p=await t.getProperties(f);!p||!this.evalSystem(p)||!this.evalValue(d)||!this.evalURI(d)||c.push(u)}const l=this.components.get(pe);for(const h of c){const u=l.getEntitiesWithRelation(t,"HasAssociations",h);for(const d of u){if(d in e)continue;const f=await t.getProperties(d);f&&(e[d]=f,s.push(d))}}return s}async test(t,e){var i;this.testResult=[];for(const n in t){const o=Number(n),a=t[o],c=[],l={guid:(i=a.GlobalId)==null?void 0:i.value,expressID:o,pass:!1,checks:c,cardinality:this.cardinality};this.testResult.push(l);let h=!0;const u=await this.getSystems(e,o),d=u.map(f=>this.getSystemName(f)).filter(f=>f);for(const f of u){if(!this.evalSystem(f,c))continue;if(h=!1,!(this.value&&this.system))break;if(f.type!==Me)continue;const m=!this.value||this.evalValue(f,c),g=!this.uri||this.evalURI(f,c);if(m&&g)break}h&&this.addCheckResult({parameter:"System",currentValue:d,requiredValue:this.system,pass:this.cardinality==="optional"},c),l.pass=c.every(({pass:f})=>f)}const s=[...this.testResult];return this.testResult=[],s}async processReferencedSource(t,e){var i;const s=(i=e.ReferencedSource)==null?void 0:i.value;if(!s)return null;const n=await t.getProperties(s);return n?(n.type===Me&&(n.ReferencedSource=await this.processReferencedSource(t,n)),n):null}async getSystems(t,e){var i;const s=[],n=this.components.get(pe),o=n.getEntityRelations(t,e,"HasAssociations");if(o)for(const u of o){const d=await t.getProperties(u);d&&(d.type===Vi&&s.push(d),d.type===Me&&(d.ReferencedSource=await this.processReferencedSource(t,d),d.ReferencedSource&&s.push(d)))}const a=s.map(u=>{var d,f,p;return u.type===Vi?(d=u.Name)==null?void 0:d.value:u.type===Me?(p=(f=u.ReferencedSource)==null?void 0:f.Name)==null?void 0:p.value:null}).filter(u=>u),c=n.getEntityRelations(t,e,"IsTypedBy");if(!(c&&c[0]))return s;const l=c[0],h=n.getEntityRelations(t,l,"HasAssociations");if(h)for(const u of h){const d=await t.getProperties(u);if(d){if(d.type===Vi){if(a.includes((i=d.Name)==null?void 0:i.value))continue;s.push(d)}d.type===Me&&(d.ReferencedSource=await this.processReferencedSource(t,d),d.ReferencedSource&&s.push(d))}}return s}getSystemName(t){var e,i,s,n;if(t.type===Vi)return(e=t.Name)==null?void 0:e.value;if(t.type===Me){if(((i=t.ReferencedSource)==null?void 0:i.type)===Me)return this.getSystemName(t.ReferencedSource);if(((s=t.ReferencedSource)==null?void 0:s.type)===Vi)return(n=t.ReferencedSource.Name)==null?void 0:n.value}return null}getAllReferenceIdentifications(t){if(t.type!==Me)return null;const e=[];if(t.Identification&&e.push(t.Identification.value),t.ReferencedSource){const i=this.getAllReferenceIdentifications(t.ReferencedSource);i&&e.push(...i)}return e}evalSystem(t,e){const i=this.getSystemName(t);return this.evalRequirement(i,this.system,"System",e)}evalValue(t,e){if(!this.value)return!0;const i=this.getAllReferenceIdentifications(t);if(!i)return!1;const s=i.find(n=>this.value?this.evalRequirement(n,this.value,"Value"):!1);return e&&this.addCheckResult({parameter:"Value",currentValue:s??null,requiredValue:this.value,pass:!!s},e),!!s}evalURI(t,e){var i;return this.uri?this.evalRequirement((i=t.Location)==null?void 0:i.value,{type:"simple",parameter:this.uri},"URI",e):!0}}class ED extends gp{constructor(t,e){super(t),L(this,"facetType","Entity"),L(this,"name"),L(this,"predefinedType"),this.name=e}serialize(t){const e=wn("Name",this.name),i=wn("Name",this.predefinedType);let s="";return t==="requirement"&&(s+=`cardinality="${this.cardinality}"`,s+=this.instructions?`instructions="${this.instructions}"`:""),`<ids:entity ${s}>
  ${e}
  ${i}
</ids:entity>`}async getEntities(t,e={}){const i=Object.entries(Ar),s=[];for(const[a]of i)await this.evalName({type:a})&&s.push(Number(a));let n={};for(const a of s){const c=await t.getAllPropertiesOfType(a);c&&(n={...n,...c})}if(!this.predefinedType){for(const a in n)a in e||(e[a]=n[a]);return Object.keys(n).map(Number)}const o=[];for(const a in n){const c=Number(a);if(c in e)continue;const l=n[c];await this.evalPredefinedType(t,l)&&(e[c]=l,o.push(c))}return o}async test(t,e){var i;this.testResult=[];for(const s in t){const n=Number(s),o=t[n],a=[],c={guid:(i=o.GlobalId)==null?void 0:i.value,expressID:n,pass:!1,checks:a,cardinality:this.cardinality};this.testResult.push(c),await this.evalName(o,a),await this.evalPredefinedType(e,o,a),c.pass=a.every(({pass:l})=>l)}return this.testResult}async evalName(t,e){const i=Ar[t.type];return this.evalRequirement(i,this.name,"Name",e)}async evalPredefinedType(t,e,i){var s,n,o,a;if(!this.predefinedType)return null;const c=this.components.get(pe),l=typeof this.predefinedType.parameter=="string"&&this.predefinedType.parameter==="USERDEFINED";let h=(s=e.PredefinedType)==null?void 0:s.value;if(h==="USERDEFINED"&&!l){const f=Object.keys(e).find(p=>/^((?!Predefined).)*Type$/.test(p));h=f?(n=e[f])==null?void 0:n.value:"USERDEFINED"}if(!h){const d=c.getEntityRelations(t,e.expressID,"IsTypedBy");if(d&&d[0]){const f=await t.getProperties(d[0]);if(f&&(h=(o=f.PredefinedType)==null?void 0:o.value,h==="USERDEFINED"&&!l)){const m=Object.keys(f).find(g=>/^((?!Predefined).)*Type$/.test(g));h=m?(a=f[m])==null?void 0:a.value:"USERDEFINED"}}}return this.evalRequirement(h,this.predefinedType,"PredefinedType",i)}}class CD extends gp{constructor(t,e,i){super(t),L(this,"facetType","Property"),L(this,"propertySet"),L(this,"baseName"),L(this,"value"),L(this,"dataType"),L(this,"uri"),L(this,"_unsupportedTypes",[Hy,$y]),this.propertySet=e,this.baseName=i}serialize(t){const e=wn("PropertySet",this.propertySet),i=wn("BaseName",this.baseName),s=wn("Value",this.value),n=this.dataType?`dataType=${this.dataType}`:"";let o="";return t==="requirement"&&(o+=`cardinality="${this.cardinality}"`,o+=this.uri?`uri=${this.uri}`:"",o+=this.instructions?`instructions="${this.instructions}"`:""),`<ids:property ${n} ${o}>
  ${e}
  ${i}
  ${s}
</ids:property>`}async getEntities(t,e={}){var i,s;let n={};const o=await t.getAllPropertiesOfType(pi);n={...n,...o};const a=await t.getAllPropertiesOfType(Ks);if(n={...n,...a},Object.keys(n).length===0)return[];const c=[];for(const h in n){const u=Number(h),d=await t.getProperties(u);if(!d||!(((i=d.Name)==null?void 0:i.value)===this.propertySet.parameter))continue;let p;if(d.type===pi&&(p="HasProperties"),d.type===Ks&&(p="Quantities"),!!p)for(const m of d[p]){const g=await t.getProperties(m.value);if(!(!g||!(((s=g.Name)==null?void 0:s.value)===this.baseName.parameter))){if(this.value){const C=Object.keys(g).find(E=>E.endsWith("Value"));if(!C||!(g[C].value===this.value.parameter))continue}c.push(u)}}}const l=this.components.get(pe);for(const h of c){const u=l.getEntitiesWithRelation(t,"IsDefinedBy",h);for(const d of u){if(d in e)continue;const f=await t.getProperties(d);f&&(e[d]=f)}}return[]}async test(t,e){var i;this.testResult=[];for(const n in t){const o=Number(n),a=t[o],c=[],l={guid:(i=a.GlobalId)==null?void 0:i.value,expressID:o,pass:!1,checks:c,cardinality:this.cardinality};this.testResult.push(l);const u=(await this.getPsets(e,o)).filter(d=>{var f;return this.evalRequirement(((f=d.Name)==null?void 0:f.value)??null,this.propertySet,"PropertySet")?(c.push({currentValue:d.Name.value,parameter:"PropertySet",pass:!0,requiredValue:this.propertySet.parameter}),!0):!1});if(u.length===0){c.push({currentValue:null,parameter:"PropertySet",pass:!1,requiredValue:this.propertySet.parameter});continue}for(const d of u){const f=this.getItemsAttrName(d.type);if(!f){c.push({currentValue:null,parameter:"BaseName",pass:!1,requiredValue:this.baseName.parameter});continue}const m=d[f].filter(g=>{var I;return this._unsupportedTypes.includes(g.type)||!this.evalRequirement(((I=g.Name)==null?void 0:I.value)??null,this.baseName,"BaseName")?!1:(c.push({currentValue:g.Name.value,parameter:"BaseName",pass:!0,requiredValue:this.baseName.parameter}),!0)});if(m.length===0){c.push({currentValue:null,parameter:"BaseName",pass:!1,requiredValue:this.baseName.parameter});continue}for(const g of m)this.evalValue(g,c),this.evalDataType(g,c),this.evalURI()}l.pass=c.every(({pass:d})=>d)}const s=[...this.testResult];return this.testResult=[],s}getItemsAttrName(t){let e;return t===pi&&(e="HasProperties"),t===Ks&&(e="Quantities"),e}getValueKey(t){return Object.keys(t).find(e=>e.endsWith("Value")||e.endsWith("Values"))}async getPsetProps(t,e,i){const s=structuredClone(e),n=[],o=s[i];if(!o)return n;for(const{value:a}of o){const c=await t.getProperties(a);c&&n.push(c)}return s[i]=n,s}async getTypePsets(t,e){const i=[],n=this.components.get(pe).getEntityRelations(t,e,"IsTypedBy");if(!(n&&n[0]))return i;const o=await t.getProperties(n[0]);if(!(o&&"HasPropertySets"in o&&Array.isArray(o.HasPropertySets)))return i;for(const{value:a}of o.HasPropertySets){const c=await t.getProperties(a);if(!(c&&"HasProperties"in c&&Array.isArray(c.HasProperties)))continue;const l=await this.getPsetProps(t,c,"HasProperties");i.push(l)}return i}async getPsets(t,e){const i=await this.getTypePsets(t,e),n=this.components.get(pe).getEntityRelations(t,e,"IsDefinedBy");if(!n)return i;for(const o of n){const a=await t.getProperties(o);if(!a)continue;const c=this.getItemsAttrName(a.type);if(!c)continue;const l=await this.getPsetProps(t,a,c);i.push(l)}return i}evalValue(t,e){const i=this.getValueKey(t),s=t[i];if(this.value){if(!s)return e?.push({parameter:"Value",currentValue:null,pass:!1,requiredValue:this.value.parameter}),!1;const n=structuredClone(this.value);if(s.name==="IFCLABEL"&&n.type==="simple"&&(n.parameter=String(n.parameter)),(t.type===ff||t.type===pf)&&Array.isArray(s)){const a=s.map(l=>l.value),c=s.find(l=>n?this.evalRequirement(l.value,n,"Value"):!1);return e?.push({currentValue:a,pass:!!c,parameter:"Value",requiredValue:n.parameter}),!!c}return this.evalRequirement(s.value,n,"Value",e)}return i?s.type===3&&s.value===2?(e?.push({parameter:"Value",currentValue:null,pass:!1,requiredValue:null}),!1):s.type===1&&s.value.trim()===""?(e?.push({parameter:"Value",currentValue:"",pass:!1,requiredValue:null}),!1):!0:!0}evalDataType(t,e){if(!this.dataType)return!0;const i=this.getValueKey(t),s=t[i];if(!s)return e?.push({parameter:"DataType",currentValue:null,pass:!1,requiredValue:this.dataType}),!1;if((t.type===ff||t.type===pf)&&Array.isArray(s)&&s[0]){const o=s[0].name;return this.evalRequirement(o,{type:"simple",parameter:this.dataType},"DataType",e)}return this.evalRequirement(s.name,{type:"simple",parameter:this.dataType},"DataType",e)}evalURI(){return!0}}class bD{constructor(t,e,i){L(this,"name"),L(this,"ifcVersion",new Set),L(this,"identifier",Un.create()),L(this,"description"),L(this,"instructions"),L(this,"requirementsDescription"),L(this,"applicability",new Ir),L(this,"requirements",new Ir),L(this,"components"),this.components=t,this.name=e;for(const s of i)this.ifcVersion.add(s)}set(t){const e=t,i=this;for(const n in t){if(n==="identifier")continue;const o=e[n];n in this&&(i[n]=o)}return this.components.get(RD).list.set(this.identifier,this),this}async test(t){let e=[];if(this.requirements.size===0)return e;const i={};for(const n of this.applicability)await n.getEntities(t,i);return e=await[...this.requirements][0].test(i,t),e}serialize(){const t=`name="${this.name}"`,e=this.identifier?`identifier="${this.identifier}"`:"",i=this.description?`description="${this.description}"`:"",s=this.instructions?`instructions="${this.instructions}"`:"";return`<ids:specification ifcVersion="${[...this.ifcVersion].join(" ")}" ${t} ${e} ${i} ${s}>
      <ids:applicability minOccurs="1" maxOccurs="unbounded">
        ${[...this.applicability].map(o=>o.serialize("applicability"))}
      </ids:applicability>
      <ids:requirements>
        ${[...this.requirements].map(o=>o.serialize("requirement"))}
      </ids:requirements>
    </ids:specification>`}}const _n=r=>{if(!r)return;const t={};if("simpleValue"in r&&(t.type="simple",t.parameter=r.simpleValue),"restriction"in r){const e=r.restriction;if("pattern"in e&&(t.type="pattern",t.parameter=e.pattern.value),"enumeration"in e){t.type="enumeration";const i=e.enumeration.map(({value:s})=>s);t.parameter=i}}if(t.parameter!==void 0)return t},Ab=(r,t)=>{const e=[];for(const i of t){const s=i.name,n=_n(s);if(!n)continue;const o=new ED(r,n);i.cardinality&&(o.cardinality=i.cardinality),o.predefinedType=_n(i.predefinedType),o.instructions=i.instructions,e.push(o)}return e},TD=(r,t)=>{const e=[];for(const i of t){const s=i.name,n=_n(s);if(!n)continue;const o=new ID(r,n);i.cardinality&&(o.cardinality=i.cardinality),o.value=_n(i.value),o.instructions=i.instructions,e.push(o)}return e},yD=(r,t)=>{const e=[];for(const i of t){const s=i.system,n=_n(s);if(!n)continue;const o=new gD(r,n);i.cardinality&&(o.cardinality=i.cardinality);const a=_n(i.value);a?.type==="simple"&&(a.parameter=String(a.parameter)),a?.type==="enumeration"&&Array.isArray(a.parameter)&&(a.parameter=a.parameter.map(String)),o.value=a,o.uri=i.uri,o.instructions=i.instructions,e.push(o)}return e},vD=(r,t)=>{const e=[];for(const i of t){const s=i.propertySet,n=i.baseName,o=_n(s),a=_n(n);if(!(a&&o))continue;const c=new CD(r,o,a);i.cardinality&&(c.cardinality=i.cardinality);const l=_n(i.value);l?.type==="enumeration"&&Array.isArray(l.parameter)&&(l.parameter=l.parameter.map(String)),c.value=l,c.dataType=i.dataType,c.uri=i.uri,c.instructions=i.instructions,e.push(c)}return e},zE=class sg extends oe{constructor(t){super(t),L(this,"enabled",!0),L(this,"list",new Os),t.add(sg.uuid,this)}getFragmentIdMap(t,e){const s=e.filter(l=>l.pass).map(l=>l.expressID),n=t.getFragmentMap(s),a=e.filter(l=>!l.pass).map(l=>l.expressID),c=t.getFragmentMap(a);return{pass:n,fail:c}}create(t,e,i){const s=new bD(this.components,t,e);return i&&(s.identifier=i),this.list.set(s.identifier,s),s}load(t){const e=[],i=sg.xmlParser.parse(t).ids,{specifications:s}=i;if(s&&s.specification){const n=Array.isArray(s.specification)?s.specification:[s.specification];for(const o of n){const{name:a,ifcVersion:c,description:l,instructions:h,identifier:u}=o;if(!(a&&c))continue;const d=[],f=[],{applicability:p,requirements:m}=o;if(p){const{maxOccurs:I,...C}=p,b=Array.isArray(C)?C:[C];for(const E of b)for(const T in E){const A=Array.isArray(E[T])?E[T]:[E[T]];if(T==="entity"){const S=Ab(this.components,A);d.push(...S)}}}let g;if(m){const{maxOccurs:I,...C}=m;g=m.description;const b=Array.isArray(C)?C:[C];for(const E of b)for(const T in E){const A=Array.isArray(E[T])?E[T]:[E[T]];if(T==="entity"){const S=Ab(this.components,A);f.push(...S)}if(T==="attribute"){const S=TD(this.components,A);f.push(...S)}if(T==="classification"){const S=yD(this.components,A);f.push(...S)}if(T==="property"){const S=vD(this.components,A);f.push(...S)}}}if(d.length>0&&f.length>0){const I=this.create(a,c.split(/\s+/),u);I.description=l,I.instructions=h,I.requirementsDescription=g,I.applicability.add(...d),I.requirements.add(...f),e.push(I)}}}return e}export(t,e=this.list.values()){const i=e??this.list;return`<ids:ids xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://standards.buildingsmart.org/IDS http://standards.buildingsmart.org/IDS/1.0/ids.xsd" xmlns:ids="http://standards.buildingsmart.org/IDS">
  <!-- Made with That Open Engine ${xE.release} (https://github.com/thatopen/engine_components) -->
  <ids:info>
    <ids:title>${t.title}</ids:title>
    ${t.copyright?`<ids:copyright>${t.copyright}</ids:copyright>`:""}
    ${t.version?`<ids:version>${t.version}</ids:version>`:""}
    ${t.description?`<ids:description>${t.description}</ids:description>`:""}
    ${t.author?`<ids:author>${t.author}</ids:author>`:""}
    ${t.date?`<ids:date>${t.date.toISOString().split("T")[0]}</ids:date>`:""}
    ${t.purpose?`<ids:purpose>${t.purpose}</ids:purpose>`:""}
    ${t.milestone?`<ids:milestone>${t.milestone}</ids:milestone>`:""}
  </ids:info>
  <ids:specifications>
    ${[...i].map(n=>n.serialize()).join(`
`)}
  </ids:specifications>
</ids:ids>`}};L(zE,"uuid","9f0b9f78-9b2e-481a-b766-2fbfd01f342c");L(zE,"xmlParser",new OR.XMLParser({allowBooleanAttributes:!0,attributeNamePrefix:"",ignoreAttributes:!1,ignoreDeclaration:!0,ignorePiTags:!0,numberParseOptions:{leadingZeros:!0,hex:!0},parseAttributeValue:!0,preserveOrder:!1,processEntities:!1,removeNSPrefix:!0,trimValues:!0}));let RD=zE;var AD=Object.defineProperty,SD=(r,t,e)=>t in r?AD(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,B=(r,t,e)=>(SD(r,typeof t!="symbol"?t+"":t,e),e),wD=Object.defineProperty,_D=(r,t,e)=>t in r?wD(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,P=(r,t,e)=>(_D(r,typeof t!="symbol"?t+"":t,e),e);const QR=0,FD=1,OD=2,Sb=2,Om=1.25,wb=1,sf=6*4+4+4,Ep=65535,xD=Math.pow(2,-24),xm=Symbol("SKIP_GENERATION");function ND(r){return r.index?r.index.count:r.attributes.position.count}function $c(r){return ND(r)/3}function PD(r,t=ArrayBuffer){return r>65535?new Uint32Array(new t(4*r)):new Uint16Array(new t(2*r))}function LD(r,t){if(!r.index){const e=r.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,s=PD(e,i);r.setIndex(new Kt(s,1));for(let n=0;n<e;n++)s[n]=n}}function KR(r){const t=$c(r),e=r.drawRange,i=e.start/3,s=(e.start+e.count)/3,n=Math.max(0,i),o=Math.min(t,s)-n;return[{offset:Math.floor(n),count:Math.floor(o)}]}function JR(r){if(!r.groups||!r.groups.length)return KR(r);const t=[],e=new Set,i=r.drawRange,s=i.start/3,n=(i.start+i.count)/3;for(const a of r.groups){const c=a.start/3,l=(a.start+a.count)/3;e.add(Math.max(s,c)),e.add(Math.min(n,l))}const o=Array.from(e.values()).sort((a,c)=>a-c);for(let a=0;a<o.length-1;a++){const c=o[a],l=o[a+1];t.push({offset:Math.floor(c),count:Math.floor(l-c)})}return t}function MD(r){if(r.groups.length===0)return!1;const t=$c(r),e=JR(r).sort((n,o)=>n.offset-o.offset),i=e[e.length-1];i.count=Math.min(t-i.offset,i.count);let s=0;return e.forEach(({count:n})=>s+=n),t!==s}function Ee(r,t,e){return e.min.x=t[r],e.min.y=t[r+1],e.min.z=t[r+2],e.max.x=t[r+3],e.max.y=t[r+4],e.max.z=t[r+5],e}function DD(r){r[0]=r[1]=r[2]=1/0,r[3]=r[4]=r[5]=-1/0}function _b(r){let t=-1,e=-1/0;for(let i=0;i<3;i++){const s=r[i+3]-r[i];s>e&&(e=s,t=i)}return t}function Fb(r,t){t.set(r)}function Ob(r,t,e){let i,s;for(let n=0;n<3;n++){const o=n+3;i=r[n],s=t[n],e[n]=i<s?i:s,i=r[o],s=t[o],e[o]=i>s?i:s}}function ld(r,t,e){for(let i=0;i<3;i++){const s=t[r+2*i],n=t[r+2*i+1],o=s-n,a=s+n;o<e[i]&&(e[i]=o),a>e[i+3]&&(e[i+3]=a)}}function xl(r){const t=r[3]-r[0],e=r[4]-r[1],i=r[5]-r[2];return 2*(t*e+e*i+i*t)}function Nm(r,t,e,i,s=null){let n=1/0,o=1/0,a=1/0,c=-1/0,l=-1/0,h=-1/0,u=1/0,d=1/0,f=1/0,p=-1/0,m=-1/0,g=-1/0;const I=s!==null;for(let C=t*6,b=(t+e)*6;C<b;C+=6){const E=r[C+0],T=r[C+1],A=E-T,S=E+T;A<n&&(n=A),S>c&&(c=S),I&&E<u&&(u=E),I&&E>p&&(p=E);const _=r[C+2],w=r[C+3],F=_-w,D=_+w;F<o&&(o=F),D>l&&(l=D),I&&_<d&&(d=_),I&&_>m&&(m=_);const R=r[C+4],O=r[C+5],y=R-O,U=R+O;y<a&&(a=y),U>h&&(h=U),I&&R<f&&(f=R),I&&R>g&&(g=R)}i[0]=n,i[1]=o,i[2]=a,i[3]=c,i[4]=l,i[5]=h,I&&(s[0]=u,s[1]=d,s[2]=f,s[3]=p,s[4]=m,s[5]=g)}function UD(r,t,e,i){let s=1/0,n=1/0,o=1/0,a=-1/0,c=-1/0,l=-1/0;for(let h=t*6,u=(t+e)*6;h<u;h+=6){const d=r[h+0];d<s&&(s=d),d>a&&(a=d);const f=r[h+2];f<n&&(n=f),f>c&&(c=f);const p=r[h+4];p<o&&(o=p),p>l&&(l=p)}i[0]=s,i[1]=n,i[2]=o,i[3]=a,i[4]=c,i[5]=l}function BD(r,t){DD(t);const e=r.attributes.position,i=r.index?r.index.array:null,s=$c(r),n=new Float32Array(s*6),o=e.normalized,a=e.array,c=e.offset||0;let l=3;e.isInterleavedBufferAttribute&&(l=e.data.stride);const h=["getX","getY","getZ"];for(let u=0;u<s;u++){const d=u*3,f=u*6;let p=d+0,m=d+1,g=d+2;i&&(p=i[p],m=i[m],g=i[g]),o||(p=p*l+c,m=m*l+c,g=g*l+c);for(let I=0;I<3;I++){let C,b,E;o?(C=e[h[I]](p),b=e[h[I]](m),E=e[h[I]](g)):(C=a[p+I],b=a[m+I],E=a[g+I]);let T=C;b<T&&(T=b),E<T&&(T=E);let A=C;b>A&&(A=b),E>A&&(A=E);const S=(A-T)/2,_=I*2;n[f+_+0]=T+S,n[f+_+1]=S+(Math.abs(T)+S)*xD,T<t[I]&&(t[I]=T),A>t[I+3]&&(t[I+3]=A)}}return n}const gn=32,kD=(r,t)=>r.candidate-t.candidate,Xn=new Array(gn).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),hd=new Float32Array(6);function VD(r,t,e,i,s,n){let o=-1,a=0;if(n===QR)o=_b(t),o!==-1&&(a=(t[o]+t[o+3])/2);else if(n===FD)o=_b(r),o!==-1&&(a=zD(e,i,s,o));else if(n===OD){const c=xl(r);let l=Om*s;const h=i*6,u=(i+s)*6;for(let d=0;d<3;d++){const f=t[d],p=(t[d+3]-f)/gn;if(s<gn/4){const m=[...Xn];m.length=s;let g=0;for(let C=h;C<u;C+=6,g++){const b=m[g];b.candidate=e[C+2*d],b.count=0;const{bounds:E,leftCacheBounds:T,rightCacheBounds:A}=b;for(let S=0;S<3;S++)A[S]=1/0,A[S+3]=-1/0,T[S]=1/0,T[S+3]=-1/0,E[S]=1/0,E[S+3]=-1/0;ld(C,e,E)}m.sort(kD);let I=s;for(let C=0;C<I;C++){const b=m[C];for(;C+1<I&&m[C+1].candidate===b.candidate;)m.splice(C+1,1),I--}for(let C=h;C<u;C+=6){const b=e[C+2*d];for(let E=0;E<I;E++){const T=m[E];b>=T.candidate?ld(C,e,T.rightCacheBounds):(ld(C,e,T.leftCacheBounds),T.count++)}}for(let C=0;C<I;C++){const b=m[C],E=b.count,T=s-b.count,A=b.leftCacheBounds,S=b.rightCacheBounds;let _=0;E!==0&&(_=xl(A)/c);let w=0;T!==0&&(w=xl(S)/c);const F=wb+Om*(_*E+w*T);F<l&&(o=d,l=F,a=b.candidate)}}else{for(let I=0;I<gn;I++){const C=Xn[I];C.count=0,C.candidate=f+p+I*p;const b=C.bounds;for(let E=0;E<3;E++)b[E]=1/0,b[E+3]=-1/0}for(let I=h;I<u;I+=6){let C=~~((e[I+2*d]-f)/p);C>=gn&&(C=gn-1);const b=Xn[C];b.count++,ld(I,e,b.bounds)}const m=Xn[gn-1];Fb(m.bounds,m.rightCacheBounds);for(let I=gn-2;I>=0;I--){const C=Xn[I],b=Xn[I+1];Ob(C.bounds,b.rightCacheBounds,C.rightCacheBounds)}let g=0;for(let I=0;I<gn-1;I++){const C=Xn[I],b=C.count,E=C.bounds,T=Xn[I+1].rightCacheBounds;b!==0&&(g===0?Fb(E,hd):Ob(E,hd,hd)),g+=b;let A=0,S=0;g!==0&&(A=xl(hd)/c);const _=s-g;_!==0&&(S=xl(T)/c);const w=wb+Om*(A*g+S*_);w<l&&(o=d,l=w,a=C.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${n} used.`);return{axis:o,pos:a}}function zD(r,t,e,i){let s=0;for(let n=t,o=t+e;n<o;n++)s+=r[n*6+i*2];return s/e}let ud=class{constructor(){}};function YD(r,t,e,i,s,n){let o=i,a=i+s-1;const c=n.pos,l=n.axis*2;for(;;){for(;o<=a&&e[o*6+l]<c;)o++;for(;o<=a&&e[a*6+l]>=c;)a--;if(o<a){for(let h=0;h<3;h++){let u=t[o*3+h];t[o*3+h]=t[a*3+h],t[a*3+h]=u}for(let h=0;h<6;h++){let u=e[o*6+h];e[o*6+h]=e[a*6+h],e[a*6+h]=u}o++,a--}else return o}}function GD(r,t,e,i,s,n){let o=i,a=i+s-1;const c=n.pos,l=n.axis*2;for(;;){for(;o<=a&&e[o*6+l]<c;)o++;for(;o<=a&&e[a*6+l]>=c;)a--;if(o<a){let h=r[o];r[o]=r[a],r[a]=h;for(let u=0;u<6;u++){let d=e[o*6+u];e[o*6+u]=e[a*6+u],e[a*6+u]=d}o++,a--}else return o}}function HD(r,t){const e=(r.index?r.index.count:r.attributes.position.count)/3,i=e>2**16,s=i?4:2,n=t?new SharedArrayBuffer(e*s):new ArrayBuffer(e*s),o=i?new Uint32Array(n):new Uint16Array(n);for(let a=0,c=o.length;a<c;a++)o[a]=a;return o}function $D(r,t){const e=r.geometry,i=e.index?e.index.array:null,s=t.maxDepth,n=t.verbose,o=t.maxLeafTris,a=t.strategy,c=t.onProgress,l=$c(e),h=r._indirectBuffer;let u=!1;const d=new Float32Array(6),f=new Float32Array(6),p=BD(e,d),m=t.indirect?GD:YD,g=[],I=t.indirect?KR(e):JR(e);if(I.length===1){const E=I[0],T=new ud;T.boundingData=d,UD(p,E.offset,E.count,f),b(T,E.offset,E.count,f),g.push(T)}else for(let E of I){const T=new ud;T.boundingData=new Float32Array(6),Nm(p,E.offset,E.count,T.boundingData,f),b(T,E.offset,E.count,f),g.push(T)}return g;function C(E){c&&c(E/l)}function b(E,T,A,S=null,_=0){if(!u&&_>=s&&(u=!0,n&&(console.warn(`MeshBVH: Max depth of ${s} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),A<=o||_>=s)return C(T+A),E.offset=T,E.count=A,E;const w=VD(E.boundingData,S,p,T,A,a);if(w.axis===-1)return C(T+A),E.offset=T,E.count=A,E;const F=m(h,i,p,T,A,w);if(F===T||F===T+A)C(T+A),E.offset=T,E.count=A;else{E.splitAxis=w.axis;const D=new ud,R=T,O=F-T;E.left=D,D.boundingData=new Float32Array(6),Nm(p,R,O,D.boundingData,f),b(D,R,O,f,_+1);const y=new ud,U=F,H=A-O;E.right=y,y.boundingData=new Float32Array(6),Nm(p,U,H,y.boundingData,f),b(y,U,H,f,_+1)}return E}}function WD(r,t){const e=r.geometry;t.indirect&&(r._indirectBuffer=HD(e,t.useSharedArrayBuffer),MD(e)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),r._indirectBuffer||LD(e,t);const i=$D(r,t);let s,n,o;const a=[],c=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let u=0;u<i.length;u++){const d=i[u];let f=l(d);const p=new c(sf*f);s=new Float32Array(p),n=new Uint32Array(p),o=new Uint16Array(p),h(0,d),a.push(p)}r._roots=a;return;function l(u){return u.count?1:1+l(u.left)+l(u.right)}function h(u,d){const f=u/4,p=u/2,m=!!d.count,g=d.boundingData;for(let I=0;I<6;I++)s[f+I]=g[I];if(m){const I=d.offset,C=d.count;return n[f+6]=I,o[p+14]=C,o[p+15]=Ep,u+sf}else{const I=d.left,C=d.right,b=d.splitAxis;let E;if(E=h(u+sf,I),E/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[f+6]=E/4,E=h(E,C),n[f+7]=b,E}}}let Bn=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,e){let i=1/0,s=-1/0;for(let n=0,o=t.length;n<o;n++){const a=t[n][e];i=a<i?a:i,s=a>s?a:s}this.min=i,this.max=s}setFromPoints(t,e){let i=1/0,s=-1/0;for(let n=0,o=e.length;n<o;n++){const a=e[n],c=t.dot(a);i=c<i?c:i,s=c>s?c:s}this.min=i,this.max=s}isSeparated(t){return this.min>t.max||t.min>this.max}};Bn.prototype.setFromBox=function(){const r=new M;return function(t,e){const i=e.min,s=e.max;let n=1/0,o=-1/0;for(let a=0;a<=1;a++)for(let c=0;c<=1;c++)for(let l=0;l<=1;l++){r.x=i.x*a+s.x*(1-a),r.y=i.y*c+s.y*(1-c),r.z=i.z*l+s.z*(1-l);const h=t.dot(r);n=Math.min(h,n),o=Math.max(h,o)}this.min=n,this.max=o}}();const jD=function(){const r=new M,t=new M,e=new M;return function(i,s,n){const o=i.start,a=r,c=s.start,l=t;e.subVectors(o,c),r.subVectors(i.end,i.start),t.subVectors(s.end,s.start);const h=e.dot(l),u=l.dot(a),d=l.dot(l),f=e.dot(a),p=a.dot(a)*d-u*u;let m,g;p!==0?m=(h*u-f*d)/p:m=0,g=(h+m*u)/d,n.x=m,n.y=g}}(),YE=function(){const r=new Ot,t=new M,e=new M;return function(i,s,n,o){jD(i,s,r);let a=r.x,c=r.y;if(a>=0&&a<=1&&c>=0&&c<=1){i.at(a,n),s.at(c,o);return}else if(a>=0&&a<=1){c<0?s.at(0,o):s.at(1,o),i.closestPointToPoint(o,!0,n);return}else if(c>=0&&c<=1){a<0?i.at(0,n):i.at(1,n),s.closestPointToPoint(n,!0,o);return}else{let l;a<0?l=i.start:l=i.end;let h;c<0?h=s.start:h=s.end;const u=t,d=e;if(i.closestPointToPoint(h,!0,t),s.closestPointToPoint(l,!0,e),u.distanceToSquared(h)<=d.distanceToSquared(l)){n.copy(u),o.copy(h);return}else{n.copy(l),o.copy(d);return}}}}(),XD=function(){const r=new M,t=new M,e=new Qe,i=new Vt;return function(s,n){const{radius:o,center:a}=s,{a:c,b:l,c:h}=n;if(i.start=c,i.end=l,i.closestPointToPoint(a,!0,r).distanceTo(a)<=o||(i.start=c,i.end=h,i.closestPointToPoint(a,!0,r).distanceTo(a)<=o)||(i.start=l,i.end=h,i.closestPointToPoint(a,!0,r).distanceTo(a)<=o))return!0;const u=n.getPlane(e);if(Math.abs(u.distanceToPoint(a))<=o){const d=u.projectPoint(a,t);if(n.containsPoint(d))return!0}return!1}}(),ZD=1e-15;function Pm(r){return Math.abs(r)<ZD}let xs=class extends $e{constructor(...t){super(...t),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new M),this.satBounds=new Array(4).fill().map(()=>new Bn),this.points=[this.a,this.b,this.c],this.sphere=new as,this.plane=new Qe,this.needsUpdate=!0}intersectsSphere(t){return XD(t,this)}update(){const t=this.a,e=this.b,i=this.c,s=this.points,n=this.satAxes,o=this.satBounds,a=n[0],c=o[0];this.getNormal(a),c.setFromPoints(a,s);const l=n[1],h=o[1];l.subVectors(t,e),h.setFromPoints(l,s);const u=n[2],d=o[2];u.subVectors(e,i),d.setFromPoints(u,s);const f=n[3],p=o[3];f.subVectors(i,t),p.setFromPoints(f,s),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,t),this.needsUpdate=!1}};xs.prototype.closestPointToSegment=function(){const r=new M,t=new M,e=new Vt;return function(i,s=null,n=null){const{start:o,end:a}=i,c=this.points;let l,h=1/0;for(let u=0;u<3;u++){const d=(u+1)%3;e.start.copy(c[u]),e.end.copy(c[d]),YE(e,i,r,t),l=r.distanceToSquared(t),l<h&&(h=l,s&&s.copy(r),n&&n.copy(t))}return this.closestPointToPoint(o,r),l=o.distanceToSquared(r),l<h&&(h=l,s&&s.copy(r),n&&n.copy(o)),this.closestPointToPoint(a,r),l=a.distanceToSquared(r),l<h&&(h=l,s&&s.copy(r),n&&n.copy(a)),Math.sqrt(h)}}();xs.prototype.intersectsTriangle=function(){const r=new xs,t=new Array(3),e=new Array(3),i=new Bn,s=new Bn,n=new M,o=new M,a=new M,c=new M,l=new M,h=new Vt,u=new Vt,d=new Vt,f=new M;function p(m,g,I){const C=m.points;let b=0,E=-1;for(let T=0;T<3;T++){const{start:A,end:S}=h;A.copy(C[T]),S.copy(C[(T+1)%3]),h.delta(o);const _=Pm(g.distanceToPoint(A));if(Pm(g.normal.dot(o))&&_){I.copy(h),b=2;break}const w=g.intersectLine(h,f);if(!w&&_&&f.copy(A),(w||_)&&!Pm(f.distanceTo(S))){if(b<=1)(b===1?I.start:I.end).copy(f),_&&(E=b);else if(b>=2){(E===1?I.start:I.end).copy(f),b=2;break}if(b++,b===2&&E===-1)break}}return b}return function(m,g=null,I=!1){this.needsUpdate&&this.update(),m.isExtendedTriangle?m.needsUpdate&&m.update():(r.copy(m),r.update(),m=r);const C=this.plane,b=m.plane;if(Math.abs(C.normal.dot(b.normal))>1-1e-10){const E=this.satBounds,T=this.satAxes;e[0]=m.a,e[1]=m.b,e[2]=m.c;for(let _=0;_<4;_++){const w=E[_],F=T[_];if(i.setFromPoints(F,e),w.isSeparated(i))return!1}const A=m.satBounds,S=m.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let _=0;_<4;_++){const w=A[_],F=S[_];if(i.setFromPoints(F,t),w.isSeparated(i))return!1}for(let _=0;_<4;_++){const w=T[_];for(let F=0;F<4;F++){const D=S[F];if(n.crossVectors(w,D),i.setFromPoints(n,t),s.setFromPoints(n,e),i.isSeparated(s))return!1}}return g&&(I||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),g.start.set(0,0,0),g.end.set(0,0,0)),!0}else{const E=p(this,b,u);if(E===1&&m.containsPoint(u.end))return g&&(g.start.copy(u.end),g.end.copy(u.end)),!0;if(E!==2)return!1;const T=p(m,C,d);if(T===1&&this.containsPoint(d.end))return g&&(g.start.copy(d.end),g.end.copy(d.end)),!0;if(T!==2)return!1;if(u.delta(a),d.delta(c),a.dot(c)<0){let R=d.start;d.start=d.end,d.end=R}const A=u.start.dot(a),S=u.end.dot(a),_=d.start.dot(a),w=d.end.dot(a),F=S<_,D=A<w;return A!==w&&_!==S&&F===D?!1:(g&&(l.subVectors(u.start,d.start),l.dot(a)>0?g.start.copy(u.start):g.start.copy(d.start),l.subVectors(u.end,d.end),l.dot(a)<0?g.end.copy(u.end):g.end.copy(d.end)),!0)}}}();xs.prototype.distanceToPoint=function(){const r=new M;return function(t){return this.closestPointToPoint(t,r),t.distanceTo(r)}}();xs.prototype.distanceToTriangle=function(){const r=new M,t=new M,e=["a","b","c"],i=new Vt,s=new Vt;return function(n,o=null,a=null){const c=o||a?i:null;if(this.intersectsTriangle(n,c))return(o||a)&&(o&&c.getCenter(o),a&&c.getCenter(a)),0;let l=1/0;for(let h=0;h<3;h++){let u;const d=e[h],f=n[d];this.closestPointToPoint(f,r),u=f.distanceToSquared(r),u<l&&(l=u,o&&o.copy(r),a&&a.copy(f));const p=this[d];n.closestPointToPoint(p,r),u=p.distanceToSquared(r),u<l&&(l=u,o&&o.copy(p),a&&a.copy(r))}for(let h=0;h<3;h++){const u=e[h],d=e[(h+1)%3];i.set(this[u],this[d]);for(let f=0;f<3;f++){const p=e[f],m=e[(f+1)%3];s.set(n[p],n[m]),YE(i,s,r,t);const g=r.distanceToSquared(t);g<l&&(l=g,o&&o.copy(r),a&&a.copy(t))}}return Math.sqrt(l)}}();let hi=class{constructor(t,e,i){this.isOrientedBox=!0,this.min=new M,this.max=new M,this.matrix=new ht,this.invMatrix=new ht,this.points=new Array(8).fill().map(()=>new M),this.satAxes=new Array(3).fill().map(()=>new M),this.satBounds=new Array(3).fill().map(()=>new Bn),this.alignedSatBounds=new Array(3).fill().map(()=>new Bn),this.needsUpdate=!1,t&&this.min.copy(t),e&&this.max.copy(e),i&&this.matrix.copy(i)}set(t,e,i){this.min.copy(t),this.max.copy(e),this.matrix.copy(i),this.needsUpdate=!0}copy(t){this.min.copy(t.min),this.max.copy(t.max),this.matrix.copy(t.matrix),this.needsUpdate=!0}};hi.prototype.update=function(){return function(){const r=this.matrix,t=this.min,e=this.max,i=this.points;for(let c=0;c<=1;c++)for(let l=0;l<=1;l++)for(let h=0;h<=1;h++){const u=1*c|2*l|4*h,d=i[u];d.x=c?e.x:t.x,d.y=l?e.y:t.y,d.z=h?e.z:t.z,d.applyMatrix4(r)}const s=this.satBounds,n=this.satAxes,o=i[0];for(let c=0;c<3;c++){const l=n[c],h=s[c],u=1<<c,d=i[u];l.subVectors(o,d),h.setFromPoints(l,i)}const a=this.alignedSatBounds;a[0].setFromPointsField(i,"x"),a[1].setFromPointsField(i,"y"),a[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();hi.prototype.intersectsBox=function(){const r=new Bn;return function(t){this.needsUpdate&&this.update();const e=t.min,i=t.max,s=this.satBounds,n=this.satAxes,o=this.alignedSatBounds;if(r.min=e.x,r.max=i.x,o[0].isSeparated(r)||(r.min=e.y,r.max=i.y,o[1].isSeparated(r))||(r.min=e.z,r.max=i.z,o[2].isSeparated(r)))return!1;for(let a=0;a<3;a++){const c=n[a],l=s[a];if(r.setFromBox(c,t),l.isSeparated(r))return!1}return!0}}();hi.prototype.intersectsTriangle=function(){const r=new xs,t=new Array(3),e=new Bn,i=new Bn,s=new M;return function(n){this.needsUpdate&&this.update(),n.isExtendedTriangle?n.needsUpdate&&n.update():(r.copy(n),r.update(),n=r);const o=this.satBounds,a=this.satAxes;t[0]=n.a,t[1]=n.b,t[2]=n.c;for(let u=0;u<3;u++){const d=o[u],f=a[u];if(e.setFromPoints(f,t),d.isSeparated(e))return!1}const c=n.satBounds,l=n.satAxes,h=this.points;for(let u=0;u<3;u++){const d=c[u],f=l[u];if(e.setFromPoints(f,h),d.isSeparated(e))return!1}for(let u=0;u<3;u++){const d=a[u];for(let f=0;f<4;f++){const p=l[f];if(s.crossVectors(d,p),e.setFromPoints(s,t),i.setFromPoints(s,h),e.isSeparated(i))return!1}}return!0}}();hi.prototype.closestPointToPoint=function(){return function(r,t){return this.needsUpdate&&this.update(),t.copy(r).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();hi.prototype.distanceToPoint=function(){const r=new M;return function(t){return this.closestPointToPoint(t,r),t.distanceTo(r)}}();hi.prototype.distanceToBox=function(){const r=["x","y","z"],t=new Array(12).fill().map(()=>new Vt),e=new Array(12).fill().map(()=>new Vt),i=new M,s=new M;return function(n,o=0,a=null,c=null){if(this.needsUpdate&&this.update(),this.intersectsBox(n))return(a||c)&&(n.getCenter(s),this.closestPointToPoint(s,i),n.closestPointToPoint(i,s),a&&a.copy(i),c&&c.copy(s)),0;const l=o*o,h=n.min,u=n.max,d=this.points;let f=1/0;for(let m=0;m<8;m++){const g=d[m];s.copy(g).clamp(h,u);const I=g.distanceToSquared(s);if(I<f&&(f=I,a&&a.copy(g),c&&c.copy(s),I<l))return Math.sqrt(I)}let p=0;for(let m=0;m<3;m++)for(let g=0;g<=1;g++)for(let I=0;I<=1;I++){const C=(m+1)%3,b=(m+2)%3,E=g<<C|I<<b,T=1<<m|g<<C|I<<b,A=d[E],S=d[T];t[p].set(A,S);const _=r[m],w=r[C],F=r[b],D=e[p],R=D.start,O=D.end;R[_]=h[_],R[w]=g?h[w]:u[w],R[F]=I?h[F]:u[w],O[_]=u[_],O[w]=g?h[w]:u[w],O[F]=I?h[F]:u[w],p++}for(let m=0;m<=1;m++)for(let g=0;g<=1;g++)for(let I=0;I<=1;I++){s.x=m?u.x:h.x,s.y=g?u.y:h.y,s.z=I?u.z:h.z,this.closestPointToPoint(s,i);const C=s.distanceToSquared(i);if(C<f&&(f=C,a&&a.copy(i),c&&c.copy(s),C<l))return Math.sqrt(C)}for(let m=0;m<12;m++){const g=t[m];for(let I=0;I<12;I++){const C=e[I];YE(g,C,i,s);const b=i.distanceToSquared(s);if(b<f&&(f=b,a&&a.copy(i),c&&c.copy(s),b<l))return Math.sqrt(b)}}return Math.sqrt(f)}}();class GE{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){const t=this._primitives;return t.length===0?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}}let qD=class extends GE{constructor(){super(()=>new xs)}};const qi=new qD;function Ti(r,t){return t[r+15]===65535}function Ai(r,t){return t[r+6]}function Qi(r,t){return t[r+14]}function Ki(r){return r+8}function Ji(r,t){return t[r+6]}function tA(r,t){return t[r+7]}let QD=class{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const t=[];let e=null;this.setBuffer=i=>{e&&t.push(e),e=i,this.float32Array=new Float32Array(i),this.uint16Array=new Uint16Array(i),this.uint32Array=new Uint32Array(i)},this.clearBuffer=()=>{e=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,t.length!==0&&this.setBuffer(t.pop())}}};const ue=new QD;let mr,Ga;const ba=[],dd=new GE(()=>new vt);function KD(r,t,e,i,s,n){mr=dd.getPrimitive(),Ga=dd.getPrimitive(),ba.push(mr,Ga),ue.setBuffer(r._roots[t]);const o=ng(0,r.geometry,e,i,s,n);ue.clearBuffer(),dd.releasePrimitive(mr),dd.releasePrimitive(Ga),ba.pop(),ba.pop();const a=ba.length;return a>0&&(Ga=ba[a-1],mr=ba[a-2]),o}function ng(r,t,e,i,s=null,n=0,o=0){const{float32Array:a,uint16Array:c,uint32Array:l}=ue;let h=r*2;if(Ti(h,c)){const u=Ai(r,l),d=Qi(h,c);return Ee(r,a,mr),i(u,d,!1,o,n+r,mr)}else{let u=function(D){const{uint16Array:R,uint32Array:O}=ue;let y=D*2;for(;!Ti(y,R);)D=Ki(D),y=D*2;return Ai(D,O)},d=function(D){const{uint16Array:R,uint32Array:O}=ue;let y=D*2;for(;!Ti(y,R);)D=Ji(D,O),y=D*2;return Ai(D,O)+Qi(y,R)};const f=Ki(r),p=Ji(r,l);let m=f,g=p,I,C,b,E;if(s&&(b=mr,E=Ga,Ee(m,a,b),Ee(g,a,E),I=s(b),C=s(E),C<I)){m=p,g=f;const D=I;I=C,C=D,b=E}b||(b=mr,Ee(m,a,b));const T=Ti(m*2,c),A=e(b,T,I,o+1,n+m);let S;if(A===Sb){const D=u(m),R=d(m)-D;S=i(D,R,!0,o+1,n+m,b)}else S=A&&ng(m,t,e,i,s,n,o+1);if(S)return!0;E=Ga,Ee(g,a,E);const _=Ti(g*2,c),w=e(E,_,C,o+1,n+g);let F;if(w===Sb){const D=u(g),R=d(g)-D;F=i(D,R,!0,o+1,n+g,E)}else F=w&&ng(g,t,e,i,s,n,o+1);return!!F}}const Nl=new M,Lm=new M;function JD(r,t,e={},i=0,s=1/0){const n=i*i,o=s*s;let a=1/0,c=null;if(r.shapecast({boundsTraverseOrder:h=>(Nl.copy(t).clamp(h.min,h.max),Nl.distanceToSquared(t)),intersectsBounds:(h,u,d)=>d<a&&d<o,intersectsTriangle:(h,u)=>{h.closestPointToPoint(t,Nl);const d=t.distanceToSquared(Nl);return d<a&&(Lm.copy(Nl),a=d,c=u),d<n}}),a===1/0)return null;const l=Math.sqrt(a);return e.point?e.point.copy(Lm):e.point=Lm.clone(),e.distance=l,e.faceIndex=c,e}const Ta=new M,ya=new M,va=new M,fd=new Ot,pd=new Ot,md=new Ot,xb=new M,Nb=new M,Pb=new M,Id=new M;function t3(r,t,e,i,s,n){let o;return n===Qg?o=r.intersectTriangle(i,e,t,!0,s):o=r.intersectTriangle(t,e,i,n!==Ps,s),o===null?null:{distance:r.origin.distanceTo(s),point:s.clone()}}function e3(r,t,e,i,s,n,o,a,c){Ta.fromBufferAttribute(t,n),ya.fromBufferAttribute(t,o),va.fromBufferAttribute(t,a);const l=t3(r,Ta,ya,va,Id,c);if(l){i&&(fd.fromBufferAttribute(i,n),pd.fromBufferAttribute(i,o),md.fromBufferAttribute(i,a),l.uv=$e.getInterpolation(Id,Ta,ya,va,fd,pd,md,new Ot)),s&&(fd.fromBufferAttribute(s,n),pd.fromBufferAttribute(s,o),md.fromBufferAttribute(s,a),l.uv1=$e.getInterpolation(Id,Ta,ya,va,fd,pd,md,new Ot)),e&&(xb.fromBufferAttribute(e,n),Nb.fromBufferAttribute(e,o),Pb.fromBufferAttribute(e,a),l.normal=$e.getInterpolation(Id,Ta,ya,va,xb,Nb,Pb,new M),l.normal.dot(r.direction)>0&&l.normal.multiplyScalar(-1));const h={a:n,b:o,c:a,normal:new M,materialIndex:0};$e.getNormal(Ta,ya,va,h.normal),l.face=h,l.faceIndex=n}return l}function Cp(r,t,e,i,s){const n=i*3;let o=n+0,a=n+1,c=n+2;const l=r.index;r.index&&(o=l.getX(o),a=l.getX(a),c=l.getX(c));const{position:h,normal:u,uv:d,uv1:f}=r.attributes,p=e3(e,h,u,d,f,o,a,c,t);return p?(p.faceIndex=i,s&&s.push(p),p):null}function Ne(r,t,e,i){const s=r.a,n=r.b,o=r.c;let a=t,c=t+1,l=t+2;e&&(a=e.getX(a),c=e.getX(c),l=e.getX(l)),s.x=i.getX(a),s.y=i.getY(a),s.z=i.getZ(a),n.x=i.getX(c),n.y=i.getY(c),n.z=i.getZ(c),o.x=i.getX(l),o.y=i.getY(l),o.z=i.getZ(l)}function i3(r,t,e,i,s,n){const{geometry:o,_indirectBuffer:a}=r;for(let c=i,l=i+s;c<l;c++)Cp(o,t,e,c,n)}function s3(r,t,e,i,s){const{geometry:n,_indirectBuffer:o}=r;let a=1/0,c=null;for(let l=i,h=i+s;l<h;l++){let u;u=Cp(n,t,e,l),u&&u.distance<a&&(c=u,a=u.distance)}return c}function n3(r,t,e,i,s,n,o){const{geometry:a}=e,{index:c}=a,l=a.attributes.position;for(let h=r,u=t+r;h<u;h++){let d;if(d=h,Ne(o,d*3,c,l),o.needsUpdate=!0,i(o,d,s,n))return!0}return!1}function r3(r,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=r.geometry,i=e.index?e.index.array:null,s=e.attributes.position;let n,o,a,c,l=0;const h=r._roots;for(let d=0,f=h.length;d<f;d++)n=h[d],o=new Uint32Array(n),a=new Uint16Array(n),c=new Float32Array(n),u(0,l),l+=n.byteLength;function u(d,f,p=!1){const m=d*2;if(a[m+15]===Ep){const g=o[d+6],I=a[m+14];let C=1/0,b=1/0,E=1/0,T=-1/0,A=-1/0,S=-1/0;for(let _=3*g,w=3*(g+I);_<w;_++){let F=i[_];const D=s.getX(F),R=s.getY(F),O=s.getZ(F);D<C&&(C=D),D>T&&(T=D),R<b&&(b=R),R>A&&(A=R),O<E&&(E=O),O>S&&(S=O)}return c[d+0]!==C||c[d+1]!==b||c[d+2]!==E||c[d+3]!==T||c[d+4]!==A||c[d+5]!==S?(c[d+0]=C,c[d+1]=b,c[d+2]=E,c[d+3]=T,c[d+4]=A,c[d+5]=S,!0):!1}else{const g=d+8,I=o[d+6],C=g+f,b=I+f;let E=p,T=!1,A=!1;t?E||(T=t.has(C),A=t.has(b),E=!T&&!A):(T=!0,A=!0);const S=E||T,_=E||A;let w=!1;S&&(w=u(g,f,E));let F=!1;_&&(F=u(I,f,E));const D=w||F;if(D)for(let R=0;R<3;R++){const O=g+R,y=I+R,U=c[O],H=c[O+3],k=c[y],X=c[y+3];c[d+R]=U<k?U:k,c[d+R+3]=H>X?H:X}return D}}}const Lb=new vt;function Sr(r,t,e,i){return Ee(r,t,Lb),e.intersectBox(Lb,i)}function o3(r,t,e,i,s,n){const{geometry:o,_indirectBuffer:a}=r;for(let c=i,l=i+s;c<l;c++){let h=a?a[c]:c;Cp(o,t,e,h,n)}}function a3(r,t,e,i,s){const{geometry:n,_indirectBuffer:o}=r;let a=1/0,c=null;for(let l=i,h=i+s;l<h;l++){let u;u=Cp(n,t,e,o?o[l]:l),u&&u.distance<a&&(c=u,a=u.distance)}return c}function c3(r,t,e,i,s,n,o){const{geometry:a}=e,{index:c}=a,l=a.attributes.position;for(let h=r,u=t+r;h<u;h++){let d;if(d=e.resolveTriangleIndex(h),Ne(o,d*3,c,l),o.needsUpdate=!0,i(o,d,s,n))return!0}return!1}const Mb=new M;function l3(r,t,e,i,s){ue.setBuffer(r._roots[t]),rg(0,r,e,i,s),ue.clearBuffer()}function rg(r,t,e,i,s){const{float32Array:n,uint16Array:o,uint32Array:a}=ue,c=r*2;if(Ti(c,o)){const l=Ai(r,a),h=Qi(c,o);i3(t,e,i,l,h,s)}else{const l=Ki(r);Sr(l,n,i,Mb)&&rg(l,t,e,i,s);const h=Ji(r,a);Sr(h,n,i,Mb)&&rg(h,t,e,i,s)}}const Db=new M,h3=["x","y","z"];function u3(r,t,e,i){ue.setBuffer(r._roots[t]);const s=og(0,r,e,i);return ue.clearBuffer(),s}function og(r,t,e,i){const{float32Array:s,uint16Array:n,uint32Array:o}=ue;let a=r*2;if(Ti(a,n)){const c=Ai(r,o),l=Qi(a,n);return s3(t,e,i,c,l)}else{const c=tA(r,o),l=h3[c],h=i.direction[l]>=0;let u,d;h?(u=Ki(r),d=Ji(r,o)):(u=Ji(r,o),d=Ki(r));const f=Sr(u,s,i,Db)?og(u,t,e,i):null;if(f){const m=f.point[l];if(h?m<=s[d+c]:m>=s[d+c+3])return f}const p=Sr(d,s,i,Db)?og(d,t,e,i):null;return f&&p?f.distance<=p.distance?f:p:f||p||null}}const gd=new vt,Ra=new xs,Aa=new xs,Pl=new ht,Ub=new hi,Ed=new hi;function d3(r,t,e,i){ue.setBuffer(r._roots[t]);const s=ag(0,r,e,i);return ue.clearBuffer(),s}function ag(r,t,e,i,s=null){const{float32Array:n,uint16Array:o,uint32Array:a}=ue;let c=r*2;if(s===null&&(e.boundingBox||e.computeBoundingBox(),Ub.set(e.boundingBox.min,e.boundingBox.max,i),s=Ub),Ti(c,o)){const l=t.geometry,h=l.index,u=l.attributes.position,d=e.index,f=e.attributes.position,p=Ai(r,a),m=Qi(c,o);if(Pl.copy(i).invert(),e.boundsTree)return Ee(r,n,Ed),Ed.matrix.copy(Pl),Ed.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:g=>Ed.intersectsBox(g),intersectsTriangle:g=>{g.a.applyMatrix4(i),g.b.applyMatrix4(i),g.c.applyMatrix4(i),g.needsUpdate=!0;for(let I=p*3,C=(m+p)*3;I<C;I+=3)if(Ne(Aa,I,h,u),Aa.needsUpdate=!0,g.intersectsTriangle(Aa))return!0;return!1}});for(let g=p*3,I=(m+p)*3;g<I;g+=3){Ne(Ra,g,h,u),Ra.a.applyMatrix4(Pl),Ra.b.applyMatrix4(Pl),Ra.c.applyMatrix4(Pl),Ra.needsUpdate=!0;for(let C=0,b=d.count;C<b;C+=3)if(Ne(Aa,C,d,f),Aa.needsUpdate=!0,Ra.intersectsTriangle(Aa))return!0}}else{const l=r+8,h=a[r+6];return Ee(l,n,gd),!!(s.intersectsBox(gd)&&ag(l,t,e,i,s)||(Ee(h,n,gd),s.intersectsBox(gd)&&ag(h,t,e,i,s)))}}const Cd=new ht,Mm=new hi,Ll=new hi,f3=new M,p3=new M,m3=new M,I3=new M;function g3(r,t,e,i={},s={},n=0,o=1/0){t.boundingBox||t.computeBoundingBox(),Mm.set(t.boundingBox.min,t.boundingBox.max,e),Mm.needsUpdate=!0;const a=r.geometry,c=a.attributes.position,l=a.index,h=t.attributes.position,u=t.index,d=qi.getPrimitive(),f=qi.getPrimitive();let p=f3,m=p3,g=null,I=null;s&&(g=m3,I=I3);let C=1/0,b=null,E=null;return Cd.copy(e).invert(),Ll.matrix.copy(Cd),r.shapecast({boundsTraverseOrder:T=>Mm.distanceToBox(T),intersectsBounds:(T,A,S)=>S<C&&S<o?(A&&(Ll.min.copy(T.min),Ll.max.copy(T.max),Ll.needsUpdate=!0),!0):!1,intersectsRange:(T,A)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:S=>Ll.distanceToBox(S),intersectsBounds:(S,_,w)=>w<C&&w<o,intersectsRange:(S,_)=>{for(let w=S,F=S+_;w<F;w++){Ne(f,3*w,u,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let D=T,R=T+A;D<R;D++){Ne(d,3*D,l,c),d.needsUpdate=!0;const O=d.distanceToTriangle(f,p,g);if(O<C&&(m.copy(p),I&&I.copy(g),C=O,b=D,E=w),O<n)return!0}}}});{const S=$c(t);for(let _=0,w=S;_<w;_++){Ne(f,3*_,u,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let F=T,D=T+A;F<D;F++){Ne(d,3*F,l,c),d.needsUpdate=!0;const R=d.distanceToTriangle(f,p,g);if(R<C&&(m.copy(p),I&&I.copy(g),C=R,b=F,E=_),R<n)return!0}}}}}),qi.releasePrimitive(d),qi.releasePrimitive(f),C===1/0?null:(i.point?i.point.copy(m):i.point=m.clone(),i.distance=C,i.faceIndex=b,s&&(s.point?s.point.copy(I):s.point=I.clone(),s.point.applyMatrix4(Cd),m.applyMatrix4(Cd),s.distance=m.sub(s.point).length(),s.faceIndex=E),i)}function E3(r,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=r.geometry,i=e.index?e.index.array:null,s=e.attributes.position;let n,o,a,c,l=0;const h=r._roots;for(let d=0,f=h.length;d<f;d++)n=h[d],o=new Uint32Array(n),a=new Uint16Array(n),c=new Float32Array(n),u(0,l),l+=n.byteLength;function u(d,f,p=!1){const m=d*2;if(a[m+15]===Ep){const g=o[d+6],I=a[m+14];let C=1/0,b=1/0,E=1/0,T=-1/0,A=-1/0,S=-1/0;for(let _=g,w=g+I;_<w;_++){const F=3*r.resolveTriangleIndex(_);for(let D=0;D<3;D++){let R=F+D;R=i?i[R]:R;const O=s.getX(R),y=s.getY(R),U=s.getZ(R);O<C&&(C=O),O>T&&(T=O),y<b&&(b=y),y>A&&(A=y),U<E&&(E=U),U>S&&(S=U)}}return c[d+0]!==C||c[d+1]!==b||c[d+2]!==E||c[d+3]!==T||c[d+4]!==A||c[d+5]!==S?(c[d+0]=C,c[d+1]=b,c[d+2]=E,c[d+3]=T,c[d+4]=A,c[d+5]=S,!0):!1}else{const g=d+8,I=o[d+6],C=g+f,b=I+f;let E=p,T=!1,A=!1;t?E||(T=t.has(C),A=t.has(b),E=!T&&!A):(T=!0,A=!0);const S=E||T,_=E||A;let w=!1;S&&(w=u(g,f,E));let F=!1;_&&(F=u(I,f,E));const D=w||F;if(D)for(let R=0;R<3;R++){const O=g+R,y=I+R,U=c[O],H=c[O+3],k=c[y],X=c[y+3];c[d+R]=U<k?U:k,c[d+R+3]=H>X?H:X}return D}}}const Bb=new M;function C3(r,t,e,i,s){ue.setBuffer(r._roots[t]),cg(0,r,e,i,s),ue.clearBuffer()}function cg(r,t,e,i,s){const{float32Array:n,uint16Array:o,uint32Array:a}=ue,c=r*2;if(Ti(c,o)){const l=Ai(r,a),h=Qi(c,o);o3(t,e,i,l,h,s)}else{const l=Ki(r);Sr(l,n,i,Bb)&&cg(l,t,e,i,s);const h=Ji(r,a);Sr(h,n,i,Bb)&&cg(h,t,e,i,s)}}const kb=new M,b3=["x","y","z"];function T3(r,t,e,i){ue.setBuffer(r._roots[t]);const s=lg(0,r,e,i);return ue.clearBuffer(),s}function lg(r,t,e,i){const{float32Array:s,uint16Array:n,uint32Array:o}=ue;let a=r*2;if(Ti(a,n)){const c=Ai(r,o),l=Qi(a,n);return a3(t,e,i,c,l)}else{const c=tA(r,o),l=b3[c],h=i.direction[l]>=0;let u,d;h?(u=Ki(r),d=Ji(r,o)):(u=Ji(r,o),d=Ki(r));const f=Sr(u,s,i,kb)?lg(u,t,e,i):null;if(f){const m=f.point[l];if(h?m<=s[d+c]:m>=s[d+c+3])return f}const p=Sr(d,s,i,kb)?lg(d,t,e,i):null;return f&&p?f.distance<=p.distance?f:p:f||p||null}}const bd=new vt,Sa=new xs,wa=new xs,Ml=new ht,Vb=new hi,Td=new hi;function y3(r,t,e,i){ue.setBuffer(r._roots[t]);const s=hg(0,r,e,i);return ue.clearBuffer(),s}function hg(r,t,e,i,s=null){const{float32Array:n,uint16Array:o,uint32Array:a}=ue;let c=r*2;if(s===null&&(e.boundingBox||e.computeBoundingBox(),Vb.set(e.boundingBox.min,e.boundingBox.max,i),s=Vb),Ti(c,o)){const l=t.geometry,h=l.index,u=l.attributes.position,d=e.index,f=e.attributes.position,p=Ai(r,a),m=Qi(c,o);if(Ml.copy(i).invert(),e.boundsTree)return Ee(r,n,Td),Td.matrix.copy(Ml),Td.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:g=>Td.intersectsBox(g),intersectsTriangle:g=>{g.a.applyMatrix4(i),g.b.applyMatrix4(i),g.c.applyMatrix4(i),g.needsUpdate=!0;for(let I=p,C=m+p;I<C;I++)if(Ne(wa,3*t.resolveTriangleIndex(I),h,u),wa.needsUpdate=!0,g.intersectsTriangle(wa))return!0;return!1}});for(let g=p,I=m+p;g<I;g++){const C=t.resolveTriangleIndex(g);Ne(Sa,3*C,h,u),Sa.a.applyMatrix4(Ml),Sa.b.applyMatrix4(Ml),Sa.c.applyMatrix4(Ml),Sa.needsUpdate=!0;for(let b=0,E=d.count;b<E;b+=3)if(Ne(wa,b,d,f),wa.needsUpdate=!0,Sa.intersectsTriangle(wa))return!0}}else{const l=r+8,h=a[r+6];return Ee(l,n,bd),!!(s.intersectsBox(bd)&&hg(l,t,e,i,s)||(Ee(h,n,bd),s.intersectsBox(bd)&&hg(h,t,e,i,s)))}}const yd=new ht,Dm=new hi,Dl=new hi,v3=new M,R3=new M,A3=new M,S3=new M;function w3(r,t,e,i={},s={},n=0,o=1/0){t.boundingBox||t.computeBoundingBox(),Dm.set(t.boundingBox.min,t.boundingBox.max,e),Dm.needsUpdate=!0;const a=r.geometry,c=a.attributes.position,l=a.index,h=t.attributes.position,u=t.index,d=qi.getPrimitive(),f=qi.getPrimitive();let p=v3,m=R3,g=null,I=null;s&&(g=A3,I=S3);let C=1/0,b=null,E=null;return yd.copy(e).invert(),Dl.matrix.copy(yd),r.shapecast({boundsTraverseOrder:T=>Dm.distanceToBox(T),intersectsBounds:(T,A,S)=>S<C&&S<o?(A&&(Dl.min.copy(T.min),Dl.max.copy(T.max),Dl.needsUpdate=!0),!0):!1,intersectsRange:(T,A)=>{if(t.boundsTree){const S=t.boundsTree;return S.shapecast({boundsTraverseOrder:_=>Dl.distanceToBox(_),intersectsBounds:(_,w,F)=>F<C&&F<o,intersectsRange:(_,w)=>{for(let F=_,D=_+w;F<D;F++){const R=S.resolveTriangleIndex(F);Ne(f,3*R,u,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let O=T,y=T+A;O<y;O++){const U=r.resolveTriangleIndex(O);Ne(d,3*U,l,c),d.needsUpdate=!0;const H=d.distanceToTriangle(f,p,g);if(H<C&&(m.copy(p),I&&I.copy(g),C=H,b=O,E=F),H<n)return!0}}}})}else{const S=$c(t);for(let _=0,w=S;_<w;_++){Ne(f,3*_,u,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let F=T,D=T+A;F<D;F++){const R=r.resolveTriangleIndex(F);Ne(d,3*R,l,c),d.needsUpdate=!0;const O=d.distanceToTriangle(f,p,g);if(O<C&&(m.copy(p),I&&I.copy(g),C=O,b=F,E=_),O<n)return!0}}}}}),qi.releasePrimitive(d),qi.releasePrimitive(f),C===1/0?null:(i.point?i.point.copy(m):i.point=m.clone(),i.distance=C,i.faceIndex=b,s&&(s.point?s.point.copy(I):s.point=I.clone(),s.point.applyMatrix4(yd),m.applyMatrix4(yd),s.distance=m.sub(s.point).length(),s.faceIndex=E),i)}function _3(){return typeof SharedArrayBuffer<"u"}const lh=new ue.constructor,wf=new ue.constructor,rr=new GE(()=>new vt),_a=new vt,Fa=new vt,Um=new vt,Bm=new vt;let km=!1;function F3(r,t,e,i){if(km)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");km=!0;const s=r._roots,n=t._roots;let o,a=0,c=0;const l=new ht().copy(e).invert();for(let h=0,u=s.length;h<u;h++){lh.setBuffer(s[h]),c=0;const d=rr.getPrimitive();Ee(0,lh.float32Array,d),d.applyMatrix4(l);for(let f=0,p=n.length;f<p&&(wf.setBuffer(n[h]),o=ys(0,0,e,l,i,a,c,0,0,d),wf.clearBuffer(),c+=n[f].length,!o);f++);if(rr.releasePrimitive(d),lh.clearBuffer(),a+=s[h].length,o)break}return km=!1,o}function ys(r,t,e,i,s,n=0,o=0,a=0,c=0,l=null,h=!1){let u,d;h?(u=wf,d=lh):(u=lh,d=wf);const f=u.float32Array,p=u.uint32Array,m=u.uint16Array,g=d.float32Array,I=d.uint32Array,C=d.uint16Array,b=r*2,E=t*2,T=Ti(b,m),A=Ti(E,C);let S=!1;if(A&&T)h?S=s(Ai(t,I),Qi(t*2,C),Ai(r,p),Qi(r*2,m),c,o+t,a,n+r):S=s(Ai(r,p),Qi(r*2,m),Ai(t,I),Qi(t*2,C),a,n+r,c,o+t);else if(A){const _=rr.getPrimitive();Ee(t,g,_),_.applyMatrix4(e);const w=Ki(r),F=Ji(r,p);Ee(w,f,_a),Ee(F,f,Fa);const D=_.intersectsBox(_a),R=_.intersectsBox(Fa);S=D&&ys(t,w,i,e,s,o,n,c,a+1,_,!h)||R&&ys(t,F,i,e,s,o,n,c,a+1,_,!h),rr.releasePrimitive(_)}else{const _=Ki(t),w=Ji(t,I);Ee(_,g,Um),Ee(w,g,Bm);const F=l.intersectsBox(Um),D=l.intersectsBox(Bm);if(F&&D)S=ys(r,_,e,i,s,n,o,a,c+1,l,h)||ys(r,w,e,i,s,n,o,a,c+1,l,h);else if(F)if(T)S=ys(r,_,e,i,s,n,o,a,c+1,l,h);else{const R=rr.getPrimitive();R.copy(Um).applyMatrix4(e);const O=Ki(r),y=Ji(r,p);Ee(O,f,_a),Ee(y,f,Fa);const U=R.intersectsBox(_a),H=R.intersectsBox(Fa);S=U&&ys(_,O,i,e,s,o,n,c,a+1,R,!h)||H&&ys(_,y,i,e,s,o,n,c,a+1,R,!h),rr.releasePrimitive(R)}else if(D)if(T)S=ys(r,w,e,i,s,n,o,a,c+1,l,h);else{const R=rr.getPrimitive();R.copy(Bm).applyMatrix4(e);const O=Ki(r),y=Ji(r,p);Ee(O,f,_a),Ee(y,f,Fa);const U=R.intersectsBox(_a),H=R.intersectsBox(Fa);S=U&&ys(w,O,i,e,s,o,n,c,a+1,R,!h)||H&&ys(w,y,i,e,s,o,n,c,a+1,R,!h),rr.releasePrimitive(R)}}return S}const vd=new hi,zb=new vt;let O3=class eA{static serialize(t,e={}){e={cloneBuffers:!0,...e};const i=t.geometry,s=t._roots,n=t._indirectBuffer,o=i.getIndex();let a;return e.cloneBuffers?a={roots:s.map(c=>c.slice()),index:o.array.slice(),indirectBuffer:n?n.slice():null}:a={roots:s,index:o.array,indirectBuffer:n},a}static deserialize(t,e,i={}){i={setIndex:!0,indirect:!!t.indirectBuffer,...i};const{index:s,roots:n,indirectBuffer:o}=t,a=new eA(e,{...i,[xm]:!0});if(a._roots=n,a._indirectBuffer=o||null,i.setIndex){const c=e.getIndex();if(c===null){const l=new Kt(t.index,1,!1);e.setIndex(l)}else c.array!==s&&(c.array.set(s),c.needsUpdate=!0)}return a}get indirect(){return!!this._indirectBuffer}constructor(t,e={}){if(t.isBufferGeometry){if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e=Object.assign({strategy:QR,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,[xm]:!1},e),e.useSharedArrayBuffer&&!_3())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=t,this._roots=null,this._indirectBuffer=null,e[xm]||(WD(this,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new vt)));const{_indirectBuffer:i}=this;this.resolveTriangleIndex=e.indirect?s=>i[s]:s=>s}refit(t=null){return(this.indirect?E3:r3)(this,t)}traverse(t,e=0){const i=this._roots[e],s=new Uint32Array(i),n=new Uint16Array(i);o(0);function o(a,c=0){const l=a*2,h=n[l+15]===Ep;if(h){const u=s[a+6],d=n[l+14];t(c,h,new Float32Array(i,a*4,6),u,d)}else{const u=a+sf/4,d=s[a+6],f=s[a+7];t(c,h,new Float32Array(i,a*4,6),f)||(o(u,c+1),o(d,c+1))}}}raycast(t,e=qa){const i=this._roots,s=this.geometry,n=[],o=e.isMaterial,a=Array.isArray(e),c=s.groups,l=o?e.side:e,h=this.indirect?C3:l3;for(let u=0,d=i.length;u<d;u++){const f=a?e[c[u].materialIndex].side:l,p=n.length;if(h(this,u,f,t,n),a){const m=c[u].materialIndex;for(let g=p,I=n.length;g<I;g++)n[g].face.materialIndex=m}}return n}raycastFirst(t,e=qa){const i=this._roots,s=this.geometry,n=e.isMaterial,o=Array.isArray(e);let a=null;const c=s.groups,l=n?e.side:e,h=this.indirect?T3:u3;for(let u=0,d=i.length;u<d;u++){const f=o?e[c[u].materialIndex].side:l,p=h(this,u,f,t);p!=null&&(a==null||p.distance<a.distance)&&(a=p,o&&(p.face.materialIndex=c[u].materialIndex))}return a}intersectsGeometry(t,e){let i=!1;const s=this._roots,n=this.indirect?y3:d3;for(let o=0,a=s.length;o<a&&(i=n(this,o,t,e),!i);o++);return i}shapecast(t){const e=qi.getPrimitive(),i=this.indirect?c3:n3;let{boundsTraverseOrder:s,intersectsBounds:n,intersectsRange:o,intersectsTriangle:a}=t;if(o&&a){const u=o;o=(d,f,p,m,g)=>u(d,f,p,m,g)?!0:i(d,f,this,a,p,m,e)}else o||(a?o=(u,d,f,p)=>i(u,d,this,a,f,p,e):o=(u,d,f)=>f);let c=!1,l=0;const h=this._roots;for(let u=0,d=h.length;u<d;u++){const f=h[u];if(c=KD(this,u,n,o,s,l),c)break;l+=f.byteLength}return qi.releasePrimitive(e),c}bvhcast(t,e,i){let{intersectsRanges:s,intersectsTriangles:n}=i;const o=qi.getPrimitive(),a=this.geometry.index,c=this.geometry.attributes.position,l=this.indirect?p=>{const m=this.resolveTriangleIndex(p);Ne(o,m*3,a,c)}:p=>{Ne(o,p*3,a,c)},h=qi.getPrimitive(),u=t.geometry.index,d=t.geometry.attributes.position,f=t.indirect?p=>{const m=t.resolveTriangleIndex(p);Ne(h,m*3,u,d)}:p=>{Ne(h,p*3,u,d)};if(n){const p=(m,g,I,C,b,E,T,A)=>{for(let S=I,_=I+C;S<_;S++){f(S),h.a.applyMatrix4(e),h.b.applyMatrix4(e),h.c.applyMatrix4(e),h.needsUpdate=!0;for(let w=m,F=m+g;w<F;w++)if(l(w),o.needsUpdate=!0,n(o,h,w,S,b,E,T,A))return!0}return!1};if(s){const m=s;s=function(g,I,C,b,E,T,A,S){return m(g,I,C,b,E,T,A,S)?!0:p(g,I,C,b,E,T,A,S)}}else s=p}return F3(this,t,e,s)}intersectsBox(t,e){return vd.set(t.min,t.max,e),vd.needsUpdate=!0,this.shapecast({intersectsBounds:i=>vd.intersectsBox(i),intersectsTriangle:i=>vd.intersectsTriangle(i)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,i={},s={},n=0,o=1/0){return(this.indirect?w3:g3)(this,t,e,i,s,n,o)}closestPointToPoint(t,e={},i=0,s=1/0){return JD(this,t,e,i,s)}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach(e=>{Ee(0,new Float32Array(e),zb),t.union(zb)}),t}};function Yb(r,t,e){return r===null||(r.point.applyMatrix4(t.matrixWorld),r.distance=r.point.distanceTo(e.ray.origin),r.object=t,r.distance<e.near||r.distance>e.far)?null:r}const Vm=new qg,Gb=new ht,x3=it.prototype.raycast;function N3(r,t){if(this.geometry.boundsTree){if(this.material===void 0)return;Gb.copy(this.matrixWorld).invert(),Vm.copy(r.ray).applyMatrix4(Gb);const e=this.geometry.boundsTree;if(r.firstHitOnly===!0){const i=Yb(e.raycastFirst(Vm,this.material),this,r);i&&t.push(i)}else{const i=e.raycast(Vm,this.material);for(let s=0,n=i.length;s<n;s++){const o=Yb(i[s],this,r);o&&t.push(o)}}}else x3.call(this,r,t)}function P3(r){return this.boundsTree=new O3(this,r),this.boundsTree}function L3(){this.boundsTree=null}let nt=class{constructor(){P(this,"enabled",!0),P(this,"trigger",r=>{if(!this.enabled)return;const t=this.handlers.slice(0);for(const e of t)e(r)}),P(this,"handlers",[])}add(r){this.handlers.push(r)}remove(r){this.handlers=this.handlers.filter(t=>t!==r)}reset(){this.handlers.length=0}},vn=class{constructor(){P(this,"enabled",!0),P(this,"trigger",async t=>{if(!this.enabled)return;const e=this.handlers.slice(0);for(const i of e)await i(t)}),P(this,"handlers",[])}add(t){this.handlers.push(t)}remove(t){this.handlers=this.handlers.filter(e=>e!==t)}reset(){this.handlers.length=0}},HE=class{constructor(t){P(this,"isDisposeable",()=>"dispose"in this&&"onDisposed"in this),P(this,"isResizeable",()=>"resize"in this&&"getSize"in this),P(this,"isUpdateable",()=>"onAfterUpdate"in this&&"onBeforeUpdate"in this&&"update"in this),P(this,"isHideable",()=>"visible"in this),P(this,"isConfigurable",()=>"setup"in this&&"config"in this&&"onSetup"in this),this.components=t}},xt=class extends HE{},iA=class extends HE{constructor(t){super(t),P(this,"worlds",new Map),P(this,"onWorldChanged",new nt),P(this,"currentWorld",null),this.onWorldChanged.add(({world:e,action:i})=>{i==="removed"&&this.worlds.delete(e.uuid)})}};class M3 extends iA{constructor(){super(...arguments),P(this,"hasCameraControls",()=>"controls"in this)}}class D3 extends iA{constructor(){super(...arguments),P(this,"onAfterUpdate",new nt),P(this,"onBeforeUpdate",new nt),P(this,"onDisposed",new nt),P(this,"onResize",new nt),P(this,"onClippingPlanesUpdated",new nt),P(this,"clippingPlanes",[])}updateClippingPlanes(){this.onClippingPlanesUpdated.trigger()}setPlane(t,e,i){e.isLocal=i;const s=this.clippingPlanes.indexOf(e);t&&s===-1?this.clippingPlanes.push(e):!t&&s>-1&&this.clippingPlanes.splice(s,1),this.three.clippingPlanes=this.clippingPlanes.filter(n=>!n.isLocal)}}const sA=class ug extends xt{constructor(t){super(t),P(this,"_disposedComponents",new Set),P(this,"enabled",!0),t.add(ug.uuid,this)}get(){return this._disposedComponents}destroy(t,e=!0,i=!0){t.removeFromParent();const s=t;s.dispose&&s.dispose(),this.disposeGeometryAndMaterials(t,e),i&&s.children&&s.children.length&&this.disposeChildren(s),t.children.length=0}disposeGeometry(t){t.boundsTree&&t.disposeBoundsTree&&t.disposeBoundsTree(),t.dispose()}disposeGeometryAndMaterials(t,e){const i=t;i.geometry&&this.disposeGeometry(i.geometry),e&&i.material&&ug.disposeMaterial(i),i.material=[],i.geometry=null}disposeChildren(t){for(const e of t.children)this.destroy(e)}static disposeMaterial(t){if(t.material)if(Array.isArray(t.material))for(const e of t.material)e.dispose();else t.material.dispose()}};P(sA,"uuid","76e9cd8e-ad8f-4753-9ef6-cbc60f7247fe");let en=sA,gr=class extends Set{constructor(t){super(t),P(this,"onItemAdded",new nt),P(this,"onItemDeleted",new nt),P(this,"onCleared",new nt),P(this,"guard",()=>!0)}clear(){super.clear(),this.onCleared.trigger()}add(...t){for(const e of t)this.has(e)||!this.guard(e)||(super.add(e),this.onItemAdded||(this.onItemAdded=new nt),this.onItemAdded.trigger(e));return this}delete(t){const e=super.delete(t);return e&&this.onItemDeleted.trigger(),e}dispose(){this.clear(),this.onItemAdded.reset(),this.onItemDeleted.reset(),this.onCleared.reset()}},Ns=class extends Map{constructor(t){super(t),P(this,"onItemSet",new nt),P(this,"onItemUpdated",new nt),P(this,"onItemDeleted",new nt),P(this,"onCleared",new nt),P(this,"guard",()=>!0)}clear(){super.clear(),this.onCleared.trigger()}set(t,e){const i=this.has(t);if(!(this.guard??(()=>!0))(t,e))return this;const s=super.set(t,e);return i?(this.onItemUpdated||(this.onItemUpdated=new nt),this.onItemUpdated.trigger({key:t,value:e})):(this.onItemSet||(this.onItemSet=new nt),this.onItemSet.trigger({key:t,value:e})),s}delete(t){const e=super.delete(t);return e&&this.onItemDeleted.trigger(t),e}dispose(){this.clear(),this.onItemSet.reset(),this.onItemDeleted.reset(),this.onCleared.reset()}},zm=class{static isEntry(t){return new Set(["Boolean","Color","Text","Number","Select","Vector3","TextSet","None"]).has(t.type)}static copySchema(t,e={}){for(const i in t){const s=t[i];this.isEntry(s)?e[i]=this.copyEntry(s):(e[i]={},this.copySchema(s,e[i]))}return e}static copyEntry(t){if(t.type==="Boolean"){const e=t;return{type:e.type,value:e.value}}if(t.type==="Color"){const e=t;return{type:e.type,value:e.value.clone()}}if(t.type==="Text"){const e=t;return{type:e.type,value:e.value}}if(t.type==="Number"){const e=t;return{type:e.type,value:e.value,min:e.min,max:e.max,interpolable:e.interpolable}}if(t.type==="Select"){const e=t;return{type:e.type,value:e.value,multiple:e.multiple,options:new Set(e.options)}}if(t.type==="Vector3"){const e=t;return{type:e.type,value:e.value.clone()}}if(t.type==="TextSet"){const e=t;return{type:e.type,value:new Set(e.value)}}if(t.type==="None"){const e=t;return{type:e.type,value:e.value}}throw new Error("Invalid entry!")}};class U3{constructor(){P(this,"list",new Set)}add(t){for(const e of t)this.list.add(e)}remove(t){for(const e of t)this.list.delete(e)}set(t){for(const e of this.list)e.enabled=t}reset(){for(const t of this.list)t.reset()}}const nf=0,B3=1,k3=new M,Hb=new Vt,Ym=new Qe,$b=new M,Rd=new $e;class V3{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new Wb,this.unassigned=new Wb,this.vertices=[]}setFromPoints(t){if(t.length>=4){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.vertices.push(new z3(t[e]));this.compute()}return this}setFromObject(t){const e=[];return t.updateMatrixWorld(!0),t.traverse(function(i){const s=i.geometry;if(s!==void 0){const n=s.attributes.position;if(n!==void 0)for(let o=0,a=n.count;o<a;o++){const c=new M;c.fromBufferAttribute(n,o).applyMatrix4(i.matrixWorld),e.push(c)}}}),this.setFromPoints(e)}containsPoint(t){const e=this.faces;for(let i=0,s=e.length;i<s;i++)if(e[i].distanceToPoint(t)>this.tolerance)return!1;return!0}intersectRay(t,e){const i=this.faces;let s=-1/0,n=1/0;for(let o=0,a=i.length;o<a;o++){const c=i[o],l=c.distanceToPoint(t.origin),h=c.normal.dot(t.direction);if(l>0&&h>=0)return null;const u=h!==0?-l/h:0;if(!(u<=0)&&(h>0?n=Math.min(u,n):s=Math.max(u,s),s>n))return null}return s!==-1/0?t.at(s,e):t.at(n,e),e}intersectsRay(t){return this.intersectRay(t,k3)!==null}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(t,e){return t.face=e,e.outside===null?this.assigned.append(t):this.assigned.insertBefore(e.outside,t),e.outside=t,this}removeVertexFromFace(t,e){return t===e.outside&&(t.next!==null&&t.next.face===e?e.outside=t.next:e.outside=null),this.assigned.remove(t),this}removeAllVerticesFromFace(t){if(t.outside!==null){const e=t.outside;let i=t.outside;for(;i.next!==null&&i.next.face===t;)i=i.next;return this.assigned.removeSubList(e,i),e.prev=i.next=null,t.outside=null,e}}deleteFaceVertices(t,e){const i=this.removeAllVerticesFromFace(t);if(i!==void 0)if(e===void 0)this.unassigned.appendChain(i);else{let s=i;do{const n=s.next;e.distanceToPoint(s.point)>this.tolerance?this.addVertexToFace(s,e):this.unassigned.append(s),s=n}while(s!==null)}return this}resolveUnassignedPoints(t){if(this.unassigned.isEmpty()===!1){let e=this.unassigned.first();do{const i=e.next;let s=this.tolerance,n=null;for(let o=0;o<t.length;o++){const a=t[o];if(a.mark===nf){const c=a.distanceToPoint(e.point);if(c>s&&(s=c,n=a),s>1e3*this.tolerance)break}}n!==null&&this.addVertexToFace(e,n),e=i}while(e!==null)}return this}computeExtremes(){const t=new M,e=new M,i=[],s=[];for(let n=0;n<3;n++)i[n]=s[n]=this.vertices[0];t.copy(this.vertices[0].point),e.copy(this.vertices[0].point);for(let n=0,o=this.vertices.length;n<o;n++){const a=this.vertices[n],c=a.point;for(let l=0;l<3;l++)c.getComponent(l)<t.getComponent(l)&&(t.setComponent(l,c.getComponent(l)),i[l]=a);for(let l=0;l<3;l++)c.getComponent(l)>e.getComponent(l)&&(e.setComponent(l,c.getComponent(l)),s[l]=a)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(t.x),Math.abs(e.x))+Math.max(Math.abs(t.y),Math.abs(e.y))+Math.max(Math.abs(t.z),Math.abs(e.z))),{min:i,max:s}}computeInitialHull(){const t=this.vertices,e=this.computeExtremes(),i=e.min,s=e.max;let n=0,o=0;for(let d=0;d<3;d++){const f=s[d].point.getComponent(d)-i[d].point.getComponent(d);f>n&&(n=f,o=d)}const a=i[o],c=s[o];let l,h;n=0,Hb.set(a.point,c.point);for(let d=0,f=this.vertices.length;d<f;d++){const p=t[d];if(p!==a&&p!==c){Hb.closestPointToPoint(p.point,!0,$b);const m=$b.distanceToSquared(p.point);m>n&&(n=m,l=p)}}n=-1,Ym.setFromCoplanarPoints(a.point,c.point,l.point);for(let d=0,f=this.vertices.length;d<f;d++){const p=t[d];if(p!==a&&p!==c&&p!==l){const m=Math.abs(Ym.distanceToPoint(p.point));m>n&&(n=m,h=p)}}const u=[];if(Ym.distanceToPoint(h.point)<0){u.push(hn.create(a,c,l),hn.create(h,c,a),hn.create(h,l,c),hn.create(h,a,l));for(let d=0;d<3;d++){const f=(d+1)%3;u[d+1].getEdge(2).setTwin(u[0].getEdge(f)),u[d+1].getEdge(1).setTwin(u[f+1].getEdge(0))}}else{u.push(hn.create(a,l,c),hn.create(h,a,c),hn.create(h,c,l),hn.create(h,l,a));for(let d=0;d<3;d++){const f=(d+1)%3;u[d+1].getEdge(2).setTwin(u[0].getEdge((3-d)%3)),u[d+1].getEdge(0).setTwin(u[f+1].getEdge(1))}}for(let d=0;d<4;d++)this.faces.push(u[d]);for(let d=0,f=t.length;d<f;d++){const p=t[d];if(p!==a&&p!==c&&p!==l&&p!==h){n=this.tolerance;let m=null;for(let g=0;g<4;g++){const I=this.faces[g].distanceToPoint(p.point);I>n&&(n=I,m=this.faces[g])}m!==null&&this.addVertexToFace(p,m)}}return this}reindexFaces(){const t=[];for(let e=0;e<this.faces.length;e++){const i=this.faces[e];i.mark===nf&&t.push(i)}return this.faces=t,this}nextVertexToAdd(){if(this.assigned.isEmpty()===!1){let t,e=0;const i=this.assigned.first().face;let s=i.outside;do{const n=i.distanceToPoint(s.point);n>e&&(e=n,t=s),s=s.next}while(s!==null&&s.face===i);return t}}computeHorizon(t,e,i,s){this.deleteFaceVertices(i),i.mark=B3;let n;e===null?n=e=i.getEdge(0):n=e.next;do{const o=n.twin,a=o.face;a.mark===nf&&(a.distanceToPoint(t)>this.tolerance?this.computeHorizon(t,o,a,s):s.push(n)),n=n.next}while(n!==e);return this}addAdjoiningFace(t,e){const i=hn.create(t,e.tail(),e.head());return this.faces.push(i),i.getEdge(-1).setTwin(e.twin),i.getEdge(0)}addNewFaces(t,e){this.newFaces=[];let i=null,s=null;for(let n=0;n<e.length;n++){const o=e[n],a=this.addAdjoiningFace(t,o);i===null?i=a:a.next.setTwin(s),this.newFaces.push(a.face),s=a}return i.next.setTwin(s),this}addVertexToHull(t){const e=[];return this.unassigned.clear(),this.removeVertexFromFace(t,t.face),this.computeHorizon(t.point,null,t.face,e),this.addNewFaces(t,e),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let t;for(this.computeInitialHull();(t=this.nextVertexToAdd())!==void 0;)this.addVertexToHull(t);return this.reindexFaces(),this.cleanup(),this}}let hn=class nA{constructor(){this.normal=new M,this.midpoint=new M,this.area=0,this.constant=0,this.outside=null,this.mark=nf,this.edge=null}static create(t,e,i){const s=new nA,n=new Gm(t,s),o=new Gm(e,s),a=new Gm(i,s);return n.next=a.prev=o,o.next=n.prev=a,a.next=o.prev=n,s.edge=n,s.compute()}getEdge(t){let e=this.edge;for(;t>0;)e=e.next,t--;for(;t<0;)e=e.prev,t++;return e}compute(){const t=this.edge.tail(),e=this.edge.head(),i=this.edge.next.head();return Rd.set(t.point,e.point,i.point),Rd.getNormal(this.normal),Rd.getMidpoint(this.midpoint),this.area=Rd.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(t){return this.normal.dot(t)-this.constant}},Gm=class{constructor(t,e){this.vertex=t,this.prev=null,this.next=null,this.twin=null,this.face=e}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const t=this.head(),e=this.tail();return e!==null?e.point.distanceTo(t.point):-1}lengthSquared(){const t=this.head(),e=this.tail();return e!==null?e.point.distanceToSquared(t.point):-1}setTwin(t){return this.twin=t,t.twin=this,this}};class z3{constructor(t){this.point=t,this.prev=null,this.next=null,this.face=null}}let Wb=class{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(t,e){return e.prev=t.prev,e.next=t,e.prev===null?this.head=e:e.prev.next=e,t.prev=e,this}insertAfter(t,e){return e.prev=t,e.next=t.next,e.next===null?this.tail=e:e.next.prev=e,t.next=e,this}append(t){return this.head===null?this.head=t:this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t,this}appendChain(t){for(this.head===null?this.head=t:this.tail.next=t,t.prev=this.tail;t.next!==null;)t=t.next;return this.tail=t,this}remove(t){return t.prev===null?this.head=t.next:t.prev.next=t.next,t.next===null?this.tail=t.prev:t.next.prev=t.prev,this}removeSubList(t,e){return t.prev===null?this.head=e.next:t.prev.next=e.next,e.next===null?this.tail=t.prev:e.next.prev=t.prev,this}isEmpty(){return this.head===null}};const dg=[2,2,1],fg=[1,0,0];function js(r,t){return r*3+t}function Y3(r){const t=r.elements;let e=0;for(let i=0;i<9;i++)e+=t[i]*t[i];return Math.sqrt(e)}function G3(r){const t=r.elements;let e=0;for(let i=0;i<3;i++){const s=t[js(dg[i],fg[i])];e+=2*s*s}return Math.sqrt(e)}function H3(r,t){let e=0,i=1;const s=r.elements;for(let l=0;l<3;l++){const h=Math.abs(s[js(dg[l],fg[l])]);h>e&&(e=h,i=l)}let n=1,o=0;const a=fg[i],c=dg[i];if(Math.abs(s[js(c,a)])>Number.EPSILON){const l=s[js(c,c)],h=s[js(a,a)],u=s[js(c,a)],d=(l-h)/2/u;let f;d<0?f=-1/(-d+Math.sqrt(1+d*d)):f=1/(d+Math.sqrt(1+d*d)),n=1/Math.sqrt(1+f*f),o=f*n}return t.identity(),t.elements[js(a,a)]=n,t.elements[js(c,c)]=n,t.elements[js(c,a)]=o,t.elements[js(a,c)]=-o,t}function $3(r,t){let e=0,i=0;const s=10;t.unitary.identity(),t.diagonal.copy(r);const n=t.unitary,o=t.diagonal,a=new fi,c=new fi,l=Number.EPSILON*Y3(o);for(;i<s&&G3(o)>l;)H3(o,a),c.copy(a).transpose(),o.multiply(a),o.premultiply(c),n.multiply(a),++e>2&&(i++,e=0);return t}function W3(r){const t=[];for(let lt=0;lt<r.length-2;lt+=3){const pt=r[lt],mt=r[lt+1],yt=r[lt+2];t.push(new M(pt,mt,yt))}const e=new V3;e.setFromPoints(t);const i={unitary:new fi,diagonal:new fi},s=e.faces,n=[],o=[];for(let lt=0,pt=s.length;lt<pt;lt++){const mt=s[lt];let yt=mt.edge;n.length=0;do n.push(yt),yt=yt.next;while(yt!==mt.edge);const zt=n.length-2;for(let Lt=1,v=zt;Lt<=v;Lt++){const j=n[0].vertex,W=n[Lt+0].vertex,N=n[Lt+1].vertex;o.push(j.point.x,j.point.y,j.point.z),o.push(W.point.x,W.point.y,W.point.z),o.push(N.point.x,N.point.y,N.point.z)}}const a=new M,c=new M,l=new M,h=new M,u=new M,d=new M,f=new M,p=new M;let m=0,g=0,I=0,C=0,b=0,E=0,T=0;for(let lt=0,pt=o.length;lt<pt;lt+=9){a.fromArray(o,lt),c.fromArray(o,lt+3),l.fromArray(o,lt+6),f.set(0,0,0),f.add(a).add(c).add(l).divideScalar(3),h.subVectors(c,a),u.subVectors(l,a);const mt=d.crossVectors(h,u).length()/2;p.add(d.copy(f).multiplyScalar(mt)),m+=mt,g+=(9*f.x*f.x+a.x*a.x+c.x*c.x+l.x*l.x)*(mt/12),I+=(9*f.x*f.y+a.x*a.y+c.x*c.y+l.x*l.y)*(mt/12),C+=(9*f.x*f.z+a.x*a.z+c.x*c.z+l.x*l.z)*(mt/12),b+=(9*f.y*f.y+a.y*a.y+c.y*c.y+l.y*l.y)*(mt/12),E+=(9*f.y*f.z+a.y*a.z+c.y*c.z+l.y*l.z)*(mt/12),T+=(9*f.z*f.z+a.z*a.z+c.z*c.z+l.z*l.z)*(mt/12)}p.divideScalar(m),g/=m,I/=m,C/=m,b/=m,E/=m,T/=m,g-=p.x*p.x,I-=p.x*p.y,C-=p.x*p.z,b-=p.y*p.y,E-=p.y*p.z,T-=p.z*p.z;const A=new fi;A.elements[0]=g,A.elements[1]=I,A.elements[2]=C,A.elements[3]=I,A.elements[4]=b,A.elements[5]=E,A.elements[6]=C,A.elements[7]=E,A.elements[8]=T,$3(A,i);const S=i.unitary,_=new M,w=new M,F=new M;S.extractBasis(_,w,F);let D=-1/0,R=-1/0,O=-1/0,y=1/0,U=1/0,H=1/0;for(let lt=0,pt=t.length;lt<pt;lt++){const mt=t[lt];D=Math.max(_.dot(mt),D),R=Math.max(w.dot(mt),R),O=Math.max(F.dot(mt),O),y=Math.min(_.dot(mt),y),U=Math.min(w.dot(mt),U),H=Math.min(F.dot(mt),H)}_.multiplyScalar(.5*(y+D)),w.multiplyScalar(.5*(U+R)),F.multiplyScalar(.5*(H+O));const k=new M,X=new M,$=new fi;k.add(_).add(w).add(F),X.x=D-y,X.y=R-U,X.z=O-H,X.multiplyScalar(.5),$.copy(S);const{x:et,y:Y,z}=X,st=new ht;st.makeScale(et*2,Y*2,z*2);const K=new ht;K.makeTranslation(-et,-Y,-z);const Q=new ht;Q.makeTranslation(k.x,k.y,k.z);const gt=new ht;gt.setFromMatrix3($);const Ct=new ht;return Ct.multiply(Q),Ct.multiply(gt),Ct.multiply(K),Ct.multiply(st),{center:k,halfSizes:X,rotation:$,transformation:Ct}}let jb=class{static isTransparent(t){return t.transparent&&t.opacity<1}};const $E=class Ye{static create(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,s=Math.random()*4294967295|0;return`${Ye._lut[t&255]+Ye._lut[t>>8&255]+Ye._lut[t>>16&255]+Ye._lut[t>>24&255]}-${Ye._lut[e&255]}${Ye._lut[e>>8&255]}-${Ye._lut[e>>16&15|64]}${Ye._lut[e>>24&255]}-${Ye._lut[i&63|128]}${Ye._lut[i>>8&255]}-${Ye._lut[i>>16&255]}${Ye._lut[i>>24&255]}${Ye._lut[s&255]}${Ye._lut[s>>8&255]}${Ye._lut[s>>16&255]}${Ye._lut[s>>24&255]}`.toLowerCase()}static validate(t){if(!Ye._pattern.test(t))throw new Error(`${t} is not a valid UUID v4.

- If you're the tool creator, you can take one from https://www.uuidgenerator.net/.

- If you're using a platform tool, verify the uuid isn't misspelled or contact the tool creator.`)}};P($E,"_pattern",/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/);P($E,"_lut",["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"]);let kn=$E;class j3 extends xt{constructor(t,e){super(t),P(this,"onDisposed",new nt),P(this,"onVertexFound",new nt),P(this,"onVertexLost",new nt),P(this,"onEnabled",new nt),P(this,"components"),P(this,"workingPlane",null),P(this,"_pickedPoint",null),P(this,"_config"),P(this,"_enabled",!1),this.components=t,this.config={snapDistance:.25,showOnlyVertex:!1,...e},this.enabled=!1}set enabled(t){this._enabled=t,t||(this._pickedPoint=null),this.onEnabled.trigger(t)}get enabled(){return this._enabled}set config(t){this._config={...this._config,...t}}get config(){return this._config}dispose(){this.onVertexFound.reset(),this.onVertexLost.reset(),this.components=null,this.onDisposed.trigger(),this.onDisposed.reset()}get(t){if(!this.enabled)return this._pickedPoint;const e=this.components.get(es).get(t).castRay();if(!e)return this._pickedPoint!==null&&(this.onVertexLost.trigger(),this._pickedPoint=null),this._pickedPoint;const i=this.getClosestVertex(e);return i?!this.workingPlane||Math.abs(this.workingPlane.distanceToPoint(i))<.001?((this._pickedPoint===null||!this._pickedPoint.equals(i))&&(this._pickedPoint=i.clone(),this.onVertexFound.trigger(this._pickedPoint)),this._pickedPoint):(this._pickedPoint=null,this._pickedPoint):(this._pickedPoint!==null&&(this.onVertexLost.trigger(),this._pickedPoint=null),this._pickedPoint)}getClosestVertex(t){let e=new M,i=!1,s=Number.MAX_SAFE_INTEGER;const n=this.getVertices(t);if(n===null)return null;for(const o of n){if(!o)continue;const a=t.point.distanceTo(o);a>s||a>this._config.snapDistance||(i=!0,e=o,s=t.point.distanceTo(o))}return i?e:this.config.showOnlyVertex?null:t.point}getVertices(t){const e=t.object;if(!t.face||!e)return null;const i=e.geometry,s=new ht,{instanceId:n}=t,o=n!==void 0,a=e instanceof Pe;return a&&o&&e.getMatrixAt(n,s),[this.getVertex(t.face.a,i),this.getVertex(t.face.b,i),this.getVertex(t.face.c,i)].map(c=>(c&&(a&&o&&c.applyMatrix4(s),c.applyMatrix4(e.matrixWorld)),c))}getVertex(t,e){if(t===void 0)return null;const i=e.attributes.position;return new M(i.getX(t),i.getY(t),i.getZ(t))}}const rA=class oA{constructor(){P(this,"onDisposed",new nt),P(this,"list",new Map),P(this,"enabled",!1),P(this,"_clock"),P(this,"onInit",new nt),P(this,"update",()=>{if(!this.enabled)return;const t=this._clock.getDelta();for(const[e,i]of this.list)i.enabled&&i.isUpdateable()&&i.update(t);requestAnimationFrame(this.update)}),this._clock=new Kg,oA.setupBVH()}add(t,e){if(this.list.has(t))throw new Error("You're trying to add a component that already exists in the components instance. Use Components.get() instead.");kn.validate(t),this.list.set(t,e)}get(t){const e=t.uuid;if(!this.list.has(e)){const i=new t(this);return this.list.has(e)||this.add(e,i),i}return this.list.get(e)}init(){this.enabled=!0,this._clock.start(),this.update(),this.onInit.trigger()}dispose(){this.enabled=!1;for(const[t,e]of this.list)e.enabled=!1,e.isDisposeable()&&e.dispose();this._clock.stop(),this.onDisposed.trigger(),this.onDisposed.reset()}static setupBVH(){Ut.prototype.computeBoundsTree=P3,Ut.prototype.disposeBoundsTree=L3,it.prototype.raycast=N3}};P(rA,"release","2.4.2");let aA=rA;class X3 extends HE{constructor(){super(...arguments),P(this,"meshes",new Set),P(this,"onAfterUpdate",new nt),P(this,"onBeforeUpdate",new nt),P(this,"onDisposed",new nt),P(this,"isDisposing",!1),P(this,"enabled",!0),P(this,"uuid",kn.create()),P(this,"name"),P(this,"_scene"),P(this,"_camera"),P(this,"_renderer",null)}get scene(){if(!this._scene)throw new Error("No scene initialized!");return this._scene}set scene(t){this._scene=t,t.worlds.set(this.uuid,this),t.currentWorld=this,t.onWorldChanged.trigger({world:this,action:"added"})}get camera(){if(!this._camera)throw new Error("No camera initialized!");return this._camera}set camera(t){this._camera=t,t.worlds.set(this.uuid,this),t.currentWorld=this,t.onWorldChanged.trigger({world:this,action:"added"})}get renderer(){return this._renderer}set renderer(t){this._renderer=t,t&&(t.worlds.set(this.uuid,this),t.currentWorld=this,t.onWorldChanged.trigger({world:this,action:"added"}))}update(t){this.enabled&&(!this._scene||!this._camera||(this.scene.currentWorld=this,this.camera.currentWorld=this,this.renderer&&(this.renderer.currentWorld=this),this.onBeforeUpdate.trigger(),this.scene.isUpdateable()&&this.scene.update(t),this.camera.isUpdateable()&&this.camera.update(t),this.renderer&&this.renderer.update(t),this.onAfterUpdate.trigger()))}dispose(t=!0){if(this.enabled=!1,this.isDisposing=!0,this.scene.onWorldChanged.trigger({world:this,action:"removed"}),this.camera.onWorldChanged.trigger({world:this,action:"removed"}),this.renderer&&this.renderer.onWorldChanged.trigger({world:this,action:"removed"}),t){const e=this.components.get(en);this.scene.dispose(),this.camera.isDisposeable()&&this.camera.dispose(),this.renderer&&this.renderer.dispose();for(const i of this.meshes)e.destroy(i);this.meshes.clear()}this._scene=null,this._camera=null,this._renderer=null,this.components.get(mA).list.delete(this.uuid),this.onDisposed.trigger(),this.onDisposed.reset()}}let Wc=class{constructor(t,e,i,s){P(this,"_component"),P(this,"name"),P(this,"uuid"),this._component=t,this.name=i,this.uuid=s??kn.create(),e.get(bp).list.set(this.uuid,this)}get controls(){return zm.copySchema(this._config)}set(t){for(const e in t)if(e in this){const i=e;this[i]=t[e].value}}export(t=this._config,e={}){for(const i in t){const s=t[i];if(zm.isEntry(s))if(s.type==="Color"){const{r:n,g:o,b:a}=s.value;e[i]={...s,value:{r:n,g:o,b:a}}}else if(s.type==="Vector3"){const{x:n,y:o,z:a}=s.value;e[i]={...s,value:{x:n,y:o,z:a}}}else if(s.type==="TextSet"){const n=Array.from(s.value);e[i]={...s,value:n}}else if(s.type==="Select"){const n=Array.from(s.options);e[i]={...s,options:n}}else e[i]={...s};else e[i]={},this.export(s,e[i])}return e}import(t,e={},i=!0){for(const s in t){const n=t[s];if(zm.isEntry(n))if(n.type==="Color"){const{r:o,g:a,b:c}=n.value;e[s]={...n,value:new Rt(o,a,c)}}else if(n.type==="Vector3"){const{x:o,y:a,z:c}=n.value;e[s]={...n,value:new M(o,a,c)}}else n.type==="TextSet"?e[s]={...n,value:new Set(n.value)}:n.type==="Select"?e[s]={...n,options:new Set(n.options)}:e[s]={...n};else e[s]={},this.import(n,e[s],!1)}i&&this.set(e)}};const cA=class lA extends xt{constructor(t){super(t),P(this,"list",new Ns),P(this,"enabled",!0),t.add(lA.uuid,this)}};P(cA,"uuid","b8c764e0-6b24-4e77-9a32-35fa728ee5b4");let bp=cA,Z3=class extends D3{constructor(t,e,i){super(t),P(this,"enabled",!0),P(this,"container"),P(this,"three"),P(this,"_canvas"),P(this,"_parameters"),P(this,"_resizeObserver",null),P(this,"onContainerUpdated",new nt),P(this,"_resizing",!1),P(this,"resize",o=>{if(this._resizing)return;this._resizing=!0,this.onContainerUpdated.trigger();const a=o?o.x:this.container.clientWidth,c=o?o.y:this.container.clientHeight;this.three.setSize(a,c),this.onResize.trigger(new Ot(a,c)),this._resizing=!1}),P(this,"resizeEvent",()=>{this.resize()}),P(this,"onContextLost",o=>{o.preventDefault(),this.enabled=!1}),P(this,"onContextBack",()=>{this.three.setRenderTarget(null),this.three.dispose(),this.three=new Qa({canvas:this._canvas,antialias:!0,alpha:!0,...this._parameters}),this.enabled=!0}),this.container=e,this._parameters=i,this.three=new Qa({antialias:!0,alpha:!0,...i}),this.three.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.setupRenderer(),this.setupEvents(!0),this.resize(),this._canvas=this.three.domElement;const s=this.three.getContext(),{canvas:n}=s;n.addEventListener("webglcontextlost",this.onContextLost,!1),n.addEventListener("webglcontextrestored",this.onContextBack,!1)}update(){if(!this.enabled||!this.currentWorld)return;this.onBeforeUpdate.trigger(this);const t=this.currentWorld.scene.three,e=this.currentWorld.camera.three;this.three.render(t,e),this.onAfterUpdate.trigger(this)}dispose(){this.enabled=!1,this.setupEvents(!1),this.three.domElement.remove(),this.three.forceContextLoss(),this.three.dispose(),this.onResize.reset(),this.onAfterUpdate.reset(),this.onBeforeUpdate.reset(),this.onDisposed.trigger(),this.onDisposed.reset()}getSize(){return new Ot(this.three.domElement.clientWidth,this.three.domElement.clientHeight)}setupEvents(t){const e=this.three.domElement.parentElement;if(!e)throw new Error("This renderer needs to have an HTML container!");this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),window.removeEventListener("resize",this.resizeEvent),t&&(this._resizeObserver=new ResizeObserver(this.resizeEvent),this._resizeObserver.observe(e),window.addEventListener("resize",this.resizeEvent))}setupRenderer(){this.three.localClippingEnabled=!0,this.container&&this.container.appendChild(this.three.domElement),this.onContainerUpdated.trigger()}};/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const Ft={LEFT:1,RIGHT:2,MIDDLE:4},ct=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),Oa={NONE:0,IN:1,OUT:-1};function qr(r){return r.isPerspectiveCamera}function tr(r){return r.isOrthographicCamera}const xa=Math.PI*2,Xb=Math.PI/2,hA=1e-5,Ul=Math.PI/180;function vs(r,t,e){return Math.max(t,Math.min(e,r))}function ne(r,t=hA){return Math.abs(r)<t}function jt(r,t,e=hA){return ne(r-t,e)}function Zb(r,t){return Math.round(r/t)*t}function Bl(r){return isFinite(r)?r:r<0?-Number.MAX_VALUE:Number.MAX_VALUE}function kl(r){return Math.abs(r)<Number.MAX_VALUE?r:r*(1/0)}function Ad(r,t,e,i,s=1/0,n){i=Math.max(1e-4,i);const o=2/i,a=o*n,c=1/(1+a+.48*a*a+.235*a*a*a);let l=r-t;const h=t,u=s*i;l=vs(l,-u,u),t=r-l;const d=(e.value+o*l)*n;e.value=(e.value-o*d)*c;let f=t+(l+d)*c;return h-r>0==f>h&&(f=h,e.value=(f-h)/n),f}function qb(r,t,e,i,s=1/0,n,o){i=Math.max(1e-4,i);const a=2/i,c=a*n,l=1/(1+c+.48*c*c+.235*c*c*c);let h=t.x,u=t.y,d=t.z,f=r.x-h,p=r.y-u,m=r.z-d;const g=h,I=u,C=d,b=s*i,E=b*b,T=f*f+p*p+m*m;if(T>E){const U=Math.sqrt(T);f=f/U*b,p=p/U*b,m=m/U*b}h=r.x-f,u=r.y-p,d=r.z-m;const A=(e.x+a*f)*n,S=(e.y+a*p)*n,_=(e.z+a*m)*n;e.x=(e.x-a*A)*l,e.y=(e.y-a*S)*l,e.z=(e.z-a*_)*l,o.x=h+(f+A)*l,o.y=u+(p+S)*l,o.z=d+(m+_)*l;const w=g-r.x,F=I-r.y,D=C-r.z,R=o.x-g,O=o.y-I,y=o.z-C;return w*R+F*O+D*y>0&&(o.x=g,o.y=I,o.z=C,e.x=(o.x-g)/n,e.y=(o.y-I)/n,e.z=(o.z-C)/n),o}function Hm(r,t){t.set(0,0),r.forEach(e=>{t.x+=e.clientX,t.y+=e.clientY}),t.x/=r.length,t.y/=r.length}function $m(r,t){return tr(r)?(console.warn(`${t} is not supported in OrthographicCamera`),!0):!1}class q3{constructor(){this._listeners={}}addEventListener(t,e){const i=this._listeners;i[t]===void 0&&(i[t]=[]),i[t].indexOf(e)===-1&&i[t].push(e)}hasEventListener(t,e){const i=this._listeners;return i[t]!==void 0&&i[t].indexOf(e)!==-1}removeEventListener(t,e){const i=this._listeners[t];if(i!==void 0){const s=i.indexOf(e);s!==-1&&i.splice(s,1)}}removeAllEventListeners(t){if(!t){this._listeners={};return}Array.isArray(this._listeners[t])&&(this._listeners[t].length=0)}dispatchEvent(t){const e=this._listeners[t.type];if(e!==void 0){t.target=this;const i=e.slice(0);for(let s=0,n=i.length;s<n;s++)i[s].call(this,t)}}}const Q3="2.7.3",Sd=1/8,uA=typeof window<"u",K3=uA&&/Mac/.test(navigator.platform),J3=!(uA&&"PointerEvent"in window);let wt,Qb,wd,Wm,di,Dt,Gt,Na,Vl,zs,Ys,Qr,Kb,Jb,Di,zl,Pa,tT,jm,eT,Xm,Zm,_d,yi=class pg extends q3{static install(t){wt=t.THREE,Qb=Object.freeze(new wt.Vector3(0,0,0)),wd=Object.freeze(new wt.Vector3(0,1,0)),Wm=Object.freeze(new wt.Vector3(0,0,1)),di=new wt.Vector2,Dt=new wt.Vector3,Gt=new wt.Vector3,Na=new wt.Vector3,Vl=new wt.Vector3,zs=new wt.Vector3,Ys=new wt.Vector3,Qr=new wt.Vector3,Kb=new wt.Vector3,Jb=new wt.Vector3,Di=new wt.Spherical,zl=new wt.Spherical,Pa=new wt.Box3,tT=new wt.Box3,jm=new wt.Sphere,eT=new wt.Quaternion,Xm=new wt.Quaternion,Zm=new wt.Matrix4,_d=new wt.Raycaster}static get ACTION(){return ct}constructor(t,e){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=ct.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=Oa.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new wt.Vector3,this._focalOffsetVelocity=new wt.Vector3,this._zoomVelocity={value:0},this._truckInternal=(E,T,A)=>{let S,_;if(qr(this._camera)){const w=Dt.copy(this._camera.position).sub(this._target),F=this._camera.getEffectiveFOV()*Ul,D=w.length()*Math.tan(F*.5);S=this.truckSpeed*E*D/this._elementRect.height,_=this.truckSpeed*T*D/this._elementRect.height}else if(tr(this._camera)){const w=this._camera;S=E*(w.right-w.left)/w.zoom/this._elementRect.width,_=T*(w.top-w.bottom)/w.zoom/this._elementRect.height}else return;this.verticalDragToForward?(A?this.setFocalOffset(this._focalOffsetEnd.x+S,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(S,0,!0),this.forward(-_,!0)):A?this.setFocalOffset(this._focalOffsetEnd.x+S,this._focalOffsetEnd.y+_,this._focalOffsetEnd.z,!0):this.truck(S,_,!0)},this._rotateInternal=(E,T)=>{const A=xa*this.azimuthRotateSpeed*E/this._elementRect.height,S=xa*this.polarRotateSpeed*T/this._elementRect.height;this.rotate(A,S,!0)},this._dollyInternal=(E,T,A)=>{const S=Math.pow(.95,-E*this.dollySpeed),_=this._sphericalEnd.radius,w=this._sphericalEnd.radius*S,F=vs(w,this.minDistance,this.maxDistance),D=F-w;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(w,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(D,!0),this._dollyToNoClamp(F,!0)):this._dollyToNoClamp(F,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?w:F)-_,this._dollyControlCoord.set(T,A)),this._lastDollyDirection=Math.sign(-E)},this._zoomInternal=(E,T,A)=>{const S=Math.pow(.95,E*this.dollySpeed),_=this._zoom,w=this._zoom*S;this.zoomTo(w,!0),this.dollyToCursor&&(this._changedZoom+=w-_,this._dollyControlCoord.set(T,A))},typeof wt>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=t,this._yAxisUpSpace=new wt.Quaternion().setFromUnitVectors(this._camera.up,wd),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=ct.NONE,this._target=new wt.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new wt.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new wt.Spherical().setFromVector3(Dt.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new wt.Vector3,new wt.Vector3,new wt.Vector3,new wt.Vector3],this._updateNearPlaneCorners(),this._boundary=new wt.Box3(new wt.Vector3(-1/0,-1/0,-1/0),new wt.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new wt.Vector2,this.mouseButtons={left:ct.ROTATE,middle:ct.DOLLY,right:ct.TRUCK,wheel:qr(this._camera)?ct.DOLLY:tr(this._camera)?ct.ZOOM:ct.NONE},this.touches={one:ct.TOUCH_ROTATE,two:qr(this._camera)?ct.TOUCH_DOLLY_TRUCK:tr(this._camera)?ct.TOUCH_ZOOM_TRUCK:ct.NONE,three:ct.TOUCH_TRUCK};const i=new wt.Vector2,s=new wt.Vector2,n=new wt.Vector2,o=E=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const S=this._domElement.getBoundingClientRect(),_=E.clientX/S.width,w=E.clientY/S.height;if(_<this._interactiveArea.left||_>this._interactiveArea.right||w<this._interactiveArea.top||w>this._interactiveArea.bottom)return}const T=E.pointerType!=="mouse"?null:(E.buttons&Ft.LEFT)===Ft.LEFT?Ft.LEFT:(E.buttons&Ft.MIDDLE)===Ft.MIDDLE?Ft.MIDDLE:(E.buttons&Ft.RIGHT)===Ft.RIGHT?Ft.RIGHT:null;if(T!==null){const S=this._findPointerByMouseButton(T);S&&this._disposePointer(S)}if((E.buttons&Ft.LEFT)===Ft.LEFT&&this._lockedPointer)return;const A={pointerId:E.pointerId,clientX:E.clientX,clientY:E.clientY,deltaX:0,deltaY:0,mouseButton:T};this._activePointers.push(A),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",h),this._isDragging=!0,m(E)},a=E=>{if(!this._enabled||!this._domElement||this._lockedPointer)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const S=this._domElement.getBoundingClientRect(),_=E.clientX/S.width,w=E.clientY/S.height;if(_<this._interactiveArea.left||_>this._interactiveArea.right||w<this._interactiveArea.top||w>this._interactiveArea.bottom)return}const T=(E.buttons&Ft.LEFT)===Ft.LEFT?Ft.LEFT:(E.buttons&Ft.MIDDLE)===Ft.MIDDLE?Ft.MIDDLE:(E.buttons&Ft.RIGHT)===Ft.RIGHT?Ft.RIGHT:null;if(T!==null){const S=this._findPointerByMouseButton(T);S&&this._disposePointer(S)}const A={pointerId:1,clientX:E.clientX,clientY:E.clientY,deltaX:0,deltaY:0,mouseButton:(E.buttons&Ft.LEFT)===Ft.LEFT?Ft.LEFT:(E.buttons&Ft.MIDDLE)===Ft.LEFT?Ft.MIDDLE:(E.buttons&Ft.RIGHT)===Ft.LEFT?Ft.RIGHT:null};this._activePointers.push(A),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("mouseup",u),this._domElement.ownerDocument.addEventListener("mousemove",l),this._domElement.ownerDocument.addEventListener("mouseup",u),this._isDragging=!0,m(E)},c=E=>{E.cancelable&&E.preventDefault();const T=E.pointerId,A=this._lockedPointer||this._findPointerById(T);if(A){if(A.clientX=E.clientX,A.clientY=E.clientY,A.deltaX=E.movementX,A.deltaY=E.movementY,this._state=0,E.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(E.buttons&Ft.LEFT)===Ft.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(E.buttons&Ft.MIDDLE)===Ft.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(E.buttons&Ft.RIGHT)===Ft.RIGHT&&(this._state=this._state|this.mouseButtons.right);g()}},l=E=>{const T=this._lockedPointer||this._findPointerById(1);T&&(T.clientX=E.clientX,T.clientY=E.clientY,T.deltaX=E.movementX,T.deltaY=E.movementY,this._state=0,(this._lockedPointer||(E.buttons&Ft.LEFT)===Ft.LEFT)&&(this._state=this._state|this.mouseButtons.left),(E.buttons&Ft.MIDDLE)===Ft.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(E.buttons&Ft.RIGHT)===Ft.RIGHT&&(this._state=this._state|this.mouseButtons.right),g())},h=E=>{const T=this._findPointerById(E.pointerId);if(!(T&&T===this._lockedPointer)){if(T&&this._disposePointer(T),E.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=ct.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=ct.NONE;I()}},u=()=>{const E=this._findPointerById(1);E&&E===this._lockedPointer||(E&&this._disposePointer(E),this._state=ct.NONE,I())};let d=-1;const f=E=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===ct.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const w=this._domElement.getBoundingClientRect(),F=E.clientX/w.width,D=E.clientY/w.height;if(F<this._interactiveArea.left||F>this._interactiveArea.right||D<this._interactiveArea.top||D>this._interactiveArea.bottom)return}if(E.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===ct.ROTATE||this.mouseButtons.wheel===ct.TRUCK){const w=performance.now();d-w<1e3&&this._getClientRect(this._elementRect),d=w}const T=K3?-1:-3,A=E.deltaMode===1?E.deltaY/T:E.deltaY/(T*10),S=this.dollyToCursor?(E.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,_=this.dollyToCursor?(E.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case ct.ROTATE:{this._rotateInternal(E.deltaX,E.deltaY),this._isUserControllingRotate=!0;break}case ct.TRUCK:{this._truckInternal(E.deltaX,E.deltaY,!1),this._isUserControllingTruck=!0;break}case ct.OFFSET:{this._truckInternal(E.deltaX,E.deltaY,!0),this._isUserControllingOffset=!0;break}case ct.DOLLY:{this._dollyInternal(-A,S,_),this._isUserControllingDolly=!0;break}case ct.ZOOM:{this._zoomInternal(-A,S,_),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},p=E=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===pg.ACTION.NONE){const T=E instanceof PointerEvent?E.pointerId:0,A=this._findPointerById(T);A&&this._disposePointer(A),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("mouseup",u);return}E.preventDefault()}},m=E=>{if(this._enabled){if(Hm(this._activePointers,di),this._getClientRect(this._elementRect),i.copy(di),s.copy(di),this._activePointers.length>=2){const T=di.x-this._activePointers[1].clientX,A=di.y-this._activePointers[1].clientY,S=Math.sqrt(T*T+A*A);n.set(0,S);const _=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,w=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;s.set(_,w)}if(this._state=0,!E)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in E&&E.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(E.buttons&Ft.LEFT)===Ft.LEFT&&(this._state=this._state|this.mouseButtons.left),(E.buttons&Ft.MIDDLE)===Ft.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(E.buttons&Ft.RIGHT)===Ft.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&ct.ROTATE)===ct.ROTATE||(this._state&ct.TOUCH_ROTATE)===ct.TOUCH_ROTATE||(this._state&ct.TOUCH_DOLLY_ROTATE)===ct.TOUCH_DOLLY_ROTATE||(this._state&ct.TOUCH_ZOOM_ROTATE)===ct.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&ct.TRUCK)===ct.TRUCK||(this._state&ct.TOUCH_TRUCK)===ct.TOUCH_TRUCK||(this._state&ct.TOUCH_DOLLY_TRUCK)===ct.TOUCH_DOLLY_TRUCK||(this._state&ct.TOUCH_ZOOM_TRUCK)===ct.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&ct.DOLLY)===ct.DOLLY||(this._state&ct.TOUCH_DOLLY)===ct.TOUCH_DOLLY||(this._state&ct.TOUCH_DOLLY_TRUCK)===ct.TOUCH_DOLLY_TRUCK||(this._state&ct.TOUCH_DOLLY_OFFSET)===ct.TOUCH_DOLLY_OFFSET||(this._state&ct.TOUCH_DOLLY_ROTATE)===ct.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&ct.ZOOM)===ct.ZOOM||(this._state&ct.TOUCH_ZOOM)===ct.TOUCH_ZOOM||(this._state&ct.TOUCH_ZOOM_TRUCK)===ct.TOUCH_ZOOM_TRUCK||(this._state&ct.TOUCH_ZOOM_OFFSET)===ct.TOUCH_ZOOM_OFFSET||(this._state&ct.TOUCH_ZOOM_ROTATE)===ct.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&ct.OFFSET)===ct.OFFSET||(this._state&ct.TOUCH_OFFSET)===ct.TOUCH_OFFSET||(this._state&ct.TOUCH_DOLLY_OFFSET)===ct.TOUCH_DOLLY_OFFSET||(this._state&ct.TOUCH_ZOOM_OFFSET)===ct.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},g=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,Hm(this._activePointers,di);const E=this._domElement&&document.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,T=E?-E.deltaX:s.x-di.x,A=E?-E.deltaY:s.y-di.y;if(s.copy(di),((this._state&ct.ROTATE)===ct.ROTATE||(this._state&ct.TOUCH_ROTATE)===ct.TOUCH_ROTATE||(this._state&ct.TOUCH_DOLLY_ROTATE)===ct.TOUCH_DOLLY_ROTATE||(this._state&ct.TOUCH_ZOOM_ROTATE)===ct.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(T,A),this._isUserControllingRotate=!0),(this._state&ct.DOLLY)===ct.DOLLY||(this._state&ct.ZOOM)===ct.ZOOM){const S=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,_=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0,w=this.dollyDragInverted?-1:1;(this._state&ct.DOLLY)===ct.DOLLY?(this._dollyInternal(w*A*Sd,S,_),this._isUserControllingDolly=!0):(this._zoomInternal(w*A*Sd,S,_),this._isUserControllingZoom=!0)}if((this._state&ct.TOUCH_DOLLY)===ct.TOUCH_DOLLY||(this._state&ct.TOUCH_ZOOM)===ct.TOUCH_ZOOM||(this._state&ct.TOUCH_DOLLY_TRUCK)===ct.TOUCH_DOLLY_TRUCK||(this._state&ct.TOUCH_ZOOM_TRUCK)===ct.TOUCH_ZOOM_TRUCK||(this._state&ct.TOUCH_DOLLY_OFFSET)===ct.TOUCH_DOLLY_OFFSET||(this._state&ct.TOUCH_ZOOM_OFFSET)===ct.TOUCH_ZOOM_OFFSET||(this._state&ct.TOUCH_DOLLY_ROTATE)===ct.TOUCH_DOLLY_ROTATE||(this._state&ct.TOUCH_ZOOM_ROTATE)===ct.TOUCH_ZOOM_ROTATE){const S=di.x-this._activePointers[1].clientX,_=di.y-this._activePointers[1].clientY,w=Math.sqrt(S*S+_*_),F=n.y-w;n.set(0,w);const D=this.dollyToCursor?(s.x-this._elementRect.x)/this._elementRect.width*2-1:0,R=this.dollyToCursor?(s.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&ct.TOUCH_DOLLY)===ct.TOUCH_DOLLY||(this._state&ct.TOUCH_DOLLY_ROTATE)===ct.TOUCH_DOLLY_ROTATE||(this._state&ct.TOUCH_DOLLY_TRUCK)===ct.TOUCH_DOLLY_TRUCK||(this._state&ct.TOUCH_DOLLY_OFFSET)===ct.TOUCH_DOLLY_OFFSET?(this._dollyInternal(F*Sd,D,R),this._isUserControllingDolly=!0):(this._zoomInternal(F*Sd,D,R),this._isUserControllingZoom=!0)}((this._state&ct.TRUCK)===ct.TRUCK||(this._state&ct.TOUCH_TRUCK)===ct.TOUCH_TRUCK||(this._state&ct.TOUCH_DOLLY_TRUCK)===ct.TOUCH_DOLLY_TRUCK||(this._state&ct.TOUCH_ZOOM_TRUCK)===ct.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(T,A,!1),this._isUserControllingTruck=!0),((this._state&ct.OFFSET)===ct.OFFSET||(this._state&ct.TOUCH_OFFSET)===ct.TOUCH_OFFSET||(this._state&ct.TOUCH_DOLLY_OFFSET)===ct.TOUCH_DOLLY_OFFSET||(this._state&ct.TOUCH_ZOOM_OFFSET)===ct.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(T,A,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},I=()=>{Hm(this._activePointers,di),s.copy(di),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("mouseup",u),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",C),this._domElement.ownerDocument.addEventListener("pointerlockerror",b),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",h),m())},this.unlockPointer=()=>{this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),document.exitPointerLock(),this.cancel(),this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointerlockchange",C),this._domElement.ownerDocument.removeEventListener("pointerlockerror",b))};const C=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},b=()=>{this.unlockPointer()};this._addAllEventListeners=E=>{this._domElement=E,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",o),J3&&this._domElement.addEventListener("mousedown",a),this._domElement.addEventListener("pointercancel",h),this._domElement.addEventListener("wheel",f,{passive:!1}),this._domElement.addEventListener("contextmenu",p)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",o),this._domElement.removeEventListener("mousedown",a),this._domElement.removeEventListener("pointercancel",h),this._domElement.removeEventListener("wheel",f,{passive:!1}),this._domElement.removeEventListener("contextmenu",p),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("mouseup",u),this._domElement.ownerDocument.removeEventListener("pointerlockchange",C),this._domElement.ownerDocument.removeEventListener("pointerlockerror",b))},this.cancel=()=>{this._state!==ct.NONE&&(this._state=ct.NONE,this._activePointers.length=0,I())},e&&this.connect(e),this.update(0)}get camera(){return this._camera}set camera(t){this._camera=t,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._domElement&&(t?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(t){this._spherical.radius===t&&this._sphericalEnd.radius===t||(this._spherical.radius=t,this._sphericalEnd.radius=t,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(t){this._spherical.theta===t&&this._sphericalEnd.theta===t||(this._spherical.theta=t,this._sphericalEnd.theta=t,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(t){this._spherical.phi===t&&this._sphericalEnd.phi===t||(this._spherical.phi=t,this._sphericalEnd.phi=t,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(t){this._boundaryEnclosesCamera=t,this._needsUpdate=!0}set interactiveArea(t){this._interactiveArea.width=vs(t.width,0,1),this._interactiveArea.height=vs(t.height,0,1),this._interactiveArea.x=vs(t.x,0,1-this._interactiveArea.width),this._interactiveArea.y=vs(t.y,0,1-this._interactiveArea.height)}addEventListener(t,e){super.addEventListener(t,e)}removeEventListener(t,e){super.removeEventListener(t,e)}rotate(t,e,i=!1){return this.rotateTo(this._sphericalEnd.theta+t,this._sphericalEnd.phi+e,i)}rotateAzimuthTo(t,e=!1){return this.rotateTo(t,this._sphericalEnd.phi,e)}rotatePolarTo(t,e=!1){return this.rotateTo(this._sphericalEnd.theta,t,e)}rotateTo(t,e,i=!1){this._isUserControllingRotate=!1;const s=vs(t,this.minAzimuthAngle,this.maxAzimuthAngle),n=vs(e,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=s,this._sphericalEnd.phi=n,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,i||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const o=!i||jt(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&jt(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(t,e=!1){return this.dollyTo(this._sphericalEnd.radius-t,e)}dollyTo(t,e=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=Oa.NONE,this._changedDolly=0,this._dollyToNoClamp(vs(t,this.minDistance,this.maxDistance),e)}_dollyToNoClamp(t,e=!1){const i=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const n=this._collisionTest(),o=jt(n,this._spherical.radius);if(!(i>t)&&o)return Promise.resolve();this._sphericalEnd.radius=Math.min(t,n)}else this._sphericalEnd.radius=t;this._needsUpdate=!0,e||(this._spherical.radius=this._sphericalEnd.radius);const s=!e||jt(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(s)}dollyInFixed(t,e=!1){this._targetEnd.add(this._getCameraDirection(Vl).multiplyScalar(t)),e||this._target.copy(this._targetEnd);const i=!e||jt(this._target.x,this._targetEnd.x,this.restThreshold)&&jt(this._target.y,this._targetEnd.y,this.restThreshold)&&jt(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}zoom(t,e=!1){return this.zoomTo(this._zoomEnd+t,e)}zoomTo(t,e=!1){this._isUserControllingZoom=!1,this._zoomEnd=vs(t,this.minZoom,this.maxZoom),this._needsUpdate=!0,e||(this._zoom=this._zoomEnd);const i=!e||jt(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(i)}pan(t,e,i=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(t,e,i)}truck(t,e,i=!1){this._camera.updateMatrix(),zs.setFromMatrixColumn(this._camera.matrix,0),Ys.setFromMatrixColumn(this._camera.matrix,1),zs.multiplyScalar(t),Ys.multiplyScalar(-e);const s=Dt.copy(zs).add(Ys),n=Gt.copy(this._targetEnd).add(s);return this.moveTo(n.x,n.y,n.z,i)}forward(t,e=!1){Dt.setFromMatrixColumn(this._camera.matrix,0),Dt.crossVectors(this._camera.up,Dt),Dt.multiplyScalar(t);const i=Gt.copy(this._targetEnd).add(Dt);return this.moveTo(i.x,i.y,i.z,e)}elevate(t,e=!1){return Dt.copy(this._camera.up).multiplyScalar(t),this.moveTo(this._targetEnd.x+Dt.x,this._targetEnd.y+Dt.y,this._targetEnd.z+Dt.z,e)}moveTo(t,e,i,s=!1){this._isUserControllingTruck=!1;const n=Dt.set(t,e,i).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,n,this.boundaryFriction),this._needsUpdate=!0,s||this._target.copy(this._targetEnd);const o=!s||jt(this._target.x,this._targetEnd.x,this.restThreshold)&&jt(this._target.y,this._targetEnd.y,this.restThreshold)&&jt(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}lookInDirectionOf(t,e,i,s=!1){const n=Dt.set(t,e,i).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius);return this.setPosition(n.x,n.y,n.z,s)}fitToBox(t,e,{cover:i=!1,paddingLeft:s=0,paddingRight:n=0,paddingBottom:o=0,paddingTop:a=0}={}){const c=[],l=t.isBox3?Pa.copy(t):Pa.setFromObject(t);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const h=Zb(this._sphericalEnd.theta,Xb),u=Zb(this._sphericalEnd.phi,Xb);c.push(this.rotateTo(h,u,e));const d=Dt.setFromSpherical(this._sphericalEnd).normalize(),f=eT.setFromUnitVectors(d,Wm),p=jt(Math.abs(d.y),1);p&&f.multiply(Xm.setFromAxisAngle(wd,h)),f.multiply(this._yAxisUpSpaceInverse);const m=tT.makeEmpty();Gt.copy(l.min).applyQuaternion(f),m.expandByPoint(Gt),Gt.copy(l.min).setX(l.max.x).applyQuaternion(f),m.expandByPoint(Gt),Gt.copy(l.min).setY(l.max.y).applyQuaternion(f),m.expandByPoint(Gt),Gt.copy(l.max).setZ(l.min.z).applyQuaternion(f),m.expandByPoint(Gt),Gt.copy(l.min).setZ(l.max.z).applyQuaternion(f),m.expandByPoint(Gt),Gt.copy(l.max).setY(l.min.y).applyQuaternion(f),m.expandByPoint(Gt),Gt.copy(l.max).setX(l.min.x).applyQuaternion(f),m.expandByPoint(Gt),Gt.copy(l.max).applyQuaternion(f),m.expandByPoint(Gt),m.min.x-=s,m.min.y-=o,m.max.x+=n,m.max.y+=a,f.setFromUnitVectors(Wm,d),p&&f.premultiply(Xm.invert()),f.premultiply(this._yAxisUpSpace);const g=m.getSize(Dt),I=m.getCenter(Gt).applyQuaternion(f);if(qr(this._camera)){const C=this.getDistanceToFitBox(g.x,g.y,g.z,i);c.push(this.moveTo(I.x,I.y,I.z,e)),c.push(this.dollyTo(C,e)),c.push(this.setFocalOffset(0,0,0,e))}else if(tr(this._camera)){const C=this._camera,b=C.right-C.left,E=C.top-C.bottom,T=i?Math.max(b/g.x,E/g.y):Math.min(b/g.x,E/g.y);c.push(this.moveTo(I.x,I.y,I.z,e)),c.push(this.zoomTo(T,e)),c.push(this.setFocalOffset(0,0,0,e))}return Promise.all(c)}fitToSphere(t,e){const i=[],s=t instanceof wt.Sphere?jm.copy(t):pg.createBoundingSphere(t,jm);if(i.push(this.moveTo(s.center.x,s.center.y,s.center.z,e)),qr(this._camera)){const n=this.getDistanceToFitSphere(s.radius);i.push(this.dollyTo(n,e))}else if(tr(this._camera)){const n=this._camera.right-this._camera.left,o=this._camera.top-this._camera.bottom,a=2*s.radius,c=Math.min(n/a,o/a);i.push(this.zoomTo(c,e))}return i.push(this.setFocalOffset(0,0,0,e)),Promise.all(i)}setLookAt(t,e,i,s,n,o,a=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Oa.NONE,this._changedDolly=0;const c=Gt.set(s,n,o),l=Dt.set(t,e,i);this._targetEnd.copy(c),this._sphericalEnd.setFromVector3(l.sub(c).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,a||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const h=!a||jt(this._target.x,this._targetEnd.x,this.restThreshold)&&jt(this._target.y,this._targetEnd.y,this.restThreshold)&&jt(this._target.z,this._targetEnd.z,this.restThreshold)&&jt(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&jt(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&jt(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(h)}lerpLookAt(t,e,i,s,n,o,a,c,l,h,u,d,f,p=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Oa.NONE,this._changedDolly=0;const m=Dt.set(s,n,o),g=Gt.set(t,e,i);Di.setFromVector3(g.sub(m).applyQuaternion(this._yAxisUpSpace));const I=Na.set(h,u,d),C=Gt.set(a,c,l);zl.setFromVector3(C.sub(I).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(m.lerp(I,f));const b=zl.theta-Di.theta,E=zl.phi-Di.phi,T=zl.radius-Di.radius;this._sphericalEnd.set(Di.radius+T*f,Di.phi+E*f,Di.theta+b*f),this.normalizeRotations(),this._needsUpdate=!0,p||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const A=!p||jt(this._target.x,this._targetEnd.x,this.restThreshold)&&jt(this._target.y,this._targetEnd.y,this.restThreshold)&&jt(this._target.z,this._targetEnd.z,this.restThreshold)&&jt(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&jt(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&jt(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(A)}setPosition(t,e,i,s=!1){return this.setLookAt(t,e,i,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,s)}setTarget(t,e,i,s=!1){const n=this.getPosition(Dt),o=this.setLookAt(n.x,n.y,n.z,t,e,i,s);return this._sphericalEnd.phi=vs(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(t,e,i,s=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(t,e,i),this._needsUpdate=!0,s||this._focalOffset.copy(this._focalOffsetEnd);const n=!s||jt(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&jt(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&jt(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}setOrbitPoint(t,e,i){this._camera.updateMatrixWorld(),zs.setFromMatrixColumn(this._camera.matrixWorldInverse,0),Ys.setFromMatrixColumn(this._camera.matrixWorldInverse,1),Qr.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const s=Dt.set(t,e,i),n=s.distanceTo(this._camera.position),o=s.sub(this._camera.position);zs.multiplyScalar(o.x),Ys.multiplyScalar(o.y),Qr.multiplyScalar(o.z),Dt.copy(zs).add(Ys).add(Qr),Dt.z=Dt.z+n,this.dollyTo(n,!1),this.setFocalOffset(-Dt.x,Dt.y,-Dt.z,!1),this.moveTo(t,e,i,!1)}setBoundary(t){if(!t){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(t),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(t,e,i,s){if(t===null){this._viewport=null;return}this._viewport=this._viewport||new wt.Vector4,typeof t=="number"?this._viewport.set(t,e,i,s):this._viewport.copy(t)}getDistanceToFitBox(t,e,i,s=!1){if($m(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const n=t/e,o=this._camera.getEffectiveFOV()*Ul,a=this._camera.aspect;return((s?n>a:n<a)?e:t/a)*.5/Math.tan(o*.5)+i*.5}getDistanceToFitSphere(t){if($m(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const e=this._camera.getEffectiveFOV()*Ul,i=Math.atan(Math.tan(e*.5)*this._camera.aspect)*2,s=1<this._camera.aspect?e:i;return t/Math.sin(s*.5)}getTarget(t,e=!0){return(t&&t.isVector3?t:new wt.Vector3).copy(e?this._targetEnd:this._target)}getPosition(t,e=!0){return(t&&t.isVector3?t:new wt.Vector3).setFromSpherical(e?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(e?this._targetEnd:this._target)}getSpherical(t,e=!0){return(t&&t instanceof wt.Spherical?t:new wt.Spherical).copy(e?this._sphericalEnd:this._spherical)}getFocalOffset(t,e=!0){return(t&&t.isVector3?t:new wt.Vector3).copy(e?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%xa,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=xa),this._spherical.theta+=xa*Math.round((this._sphericalEnd.theta-this._spherical.theta)/xa)}reset(t=!1){if(!jt(this._camera.up.x,this._cameraUp0.x)||!jt(this._camera.up.y,this._cameraUp0.y)||!jt(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const i=this.getPosition(Dt);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}const e=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,t),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,t),this.zoomTo(this._zoom0,t)];return Promise.all(e)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,wd),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const t=Dt.subVectors(this._target,this._camera.position).normalize(),e=Gt.crossVectors(t,this._camera.up);this._camera.up.crossVectors(e,t).normalize(),this._camera.updateMatrixWorld();const i=this.getPosition(Dt);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}update(t){const e=this._sphericalEnd.theta-this._spherical.theta,i=this._sphericalEnd.phi-this._spherical.phi,s=this._sphericalEnd.radius-this._spherical.radius,n=Kb.subVectors(this._targetEnd,this._target),o=Jb.subVectors(this._focalOffsetEnd,this._focalOffset),a=this._zoomEnd-this._zoom;if(ne(e))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const h=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=Ad(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,h,1/0,t),this._needsUpdate=!0}if(ne(i))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const h=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=Ad(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,h,1/0,t),this._needsUpdate=!0}if(ne(s))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const h=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=Ad(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,h,this.maxSpeed,t),this._needsUpdate=!0}if(ne(n.x)&&ne(n.y)&&ne(n.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const h=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;qb(this._target,this._targetEnd,this._targetVelocity,h,this.maxSpeed,t,this._target),this._needsUpdate=!0}if(ne(o.x)&&ne(o.y)&&ne(o.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const h=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;qb(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,h,this.maxSpeed,t,this._focalOffset),this._needsUpdate=!0}if(ne(a))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const h=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=Ad(this._zoom,this._zoomEnd,this._zoomVelocity,h,1/0,t)}if(this.dollyToCursor){if(qr(this._camera)&&this._changedDolly!==0){const h=this._spherical.radius-this._lastDistance,u=this._camera,d=this._getCameraDirection(Vl),f=Dt.copy(d).cross(u.up).normalize();f.lengthSq()===0&&(f.x=1);const p=Gt.crossVectors(f,d),m=this._sphericalEnd.radius*Math.tan(u.getEffectiveFOV()*Ul*.5),g=(this._sphericalEnd.radius-h-this._sphericalEnd.radius)/this._sphericalEnd.radius,I=Na.copy(this._targetEnd).add(f.multiplyScalar(this._dollyControlCoord.x*m*u.aspect)).add(p.multiplyScalar(this._dollyControlCoord.y*m)),C=Dt.copy(this._targetEnd).lerp(I,g),b=this._lastDollyDirection===Oa.IN&&this._spherical.radius<=this.minDistance,E=this._lastDollyDirection===Oa.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(b||E)){this._sphericalEnd.radius-=h,this._spherical.radius-=h;const A=Gt.copy(d).multiplyScalar(-h);C.add(A)}this._boundary.clampPoint(C,C);const T=Gt.subVectors(C,this._targetEnd);this._targetEnd.copy(C),this._target.add(T),this._changedDolly-=h,ne(this._changedDolly)&&(this._changedDolly=0)}else if(tr(this._camera)&&this._changedZoom!==0){const h=this._zoom-this._lastZoom,u=this._camera,d=Dt.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(u.near+u.far)/(u.near-u.far)).unproject(u),f=Gt.set(0,0,-1).applyQuaternion(u.quaternion),p=Na.copy(d).add(f.multiplyScalar(-d.dot(u.up))),m=-(this._zoom-h-this._zoom)/this._zoom,g=this._getCameraDirection(Vl),I=this._targetEnd.dot(g),C=Dt.copy(this._targetEnd).lerp(p,m),b=C.dot(g),E=g.multiplyScalar(b-I);C.sub(E),this._boundary.clampPoint(C,C);const T=Gt.subVectors(C,this._targetEnd);this._targetEnd.copy(C),this._target.add(T),this._changedZoom-=h,ne(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const c=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,c),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!ne(this._focalOffset.x)||!ne(this._focalOffset.y)||!ne(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),zs.setFromMatrixColumn(this._camera.matrix,0),Ys.setFromMatrixColumn(this._camera.matrix,1),Qr.setFromMatrixColumn(this._camera.matrix,2),zs.multiplyScalar(this._focalOffset.x),Ys.multiplyScalar(-this._focalOffset.y),Qr.multiplyScalar(this._focalOffset.z),Dt.copy(zs).add(Ys).add(Qr),this._camera.position.add(Dt)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),Dt.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const l=this._needsUpdate;return l&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):l?(this.dispatchEvent({type:"update"}),ne(e,this.restThreshold)&&ne(i,this.restThreshold)&&ne(s,this.restThreshold)&&ne(n.x,this.restThreshold)&&ne(n.y,this.restThreshold)&&ne(n.z,this.restThreshold)&&ne(o.x,this.restThreshold)&&ne(o.y,this.restThreshold)&&ne(o.z,this.restThreshold)&&ne(a,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!l&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=l,this._needsUpdate=!1,l}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:Bl(this.maxDistance),minZoom:this.minZoom,maxZoom:Bl(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:Bl(this.maxPolarAngle),minAzimuthAngle:Bl(this.minAzimuthAngle),maxAzimuthAngle:Bl(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:Dt.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(t,e=!1){const i=JSON.parse(t);this.enabled=i.enabled,this.minDistance=i.minDistance,this.maxDistance=kl(i.maxDistance),this.minZoom=i.minZoom,this.maxZoom=kl(i.maxZoom),this.minPolarAngle=i.minPolarAngle,this.maxPolarAngle=kl(i.maxPolarAngle),this.minAzimuthAngle=kl(i.minAzimuthAngle),this.maxAzimuthAngle=kl(i.maxAzimuthAngle),this.smoothTime=i.smoothTime,this.draggingSmoothTime=i.draggingSmoothTime,this.dollySpeed=i.dollySpeed,this.truckSpeed=i.truckSpeed,this.dollyToCursor=i.dollyToCursor,this.verticalDragToForward=i.verticalDragToForward,this._target0.fromArray(i.target0),this._position0.fromArray(i.position0),this._zoom0=i.zoom0,this._focalOffset0.fromArray(i.focalOffset0),this.moveTo(i.target[0],i.target[1],i.target[2],e),Di.setFromVector3(Dt.fromArray(i.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(Di.theta,Di.phi,e),this.dollyTo(Di.radius,e),this.zoomTo(i.zoom,e),this.setFocalOffset(i.focalOffset[0],i.focalOffset[1],i.focalOffset[2],e),this._needsUpdate=!0}connect(t){if(this._domElement){console.warn("camera-controls is already connected.");return}t.setAttribute("data-camera-controls-version",Q3),this._addAllEventListeners(t),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(t){return t.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(t){return this._getTargetDirection(t).negate()}_findPointerById(t){return this._activePointers.find(e=>e.pointerId===t)}_findPointerByMouseButton(t){return this._activePointers.find(e=>e.mouseButton===t)}_disposePointer(t){this._activePointers.splice(this._activePointers.indexOf(t),1)}_encloseToBoundary(t,e,i){const s=e.lengthSq();if(s===0)return t;const n=Gt.copy(e).add(t),o=this._boundary.clampPoint(n,Na).sub(n),a=o.lengthSq();if(a===0)return t.add(e);if(a===s)return t;if(i===0)return t.add(e).add(o);{const c=1+i*a/e.dot(o);return t.add(Gt.copy(e).multiplyScalar(c)).add(o.multiplyScalar(1-i))}}_updateNearPlaneCorners(){if(qr(this._camera)){const t=this._camera,e=t.near,i=t.getEffectiveFOV()*Ul,s=Math.tan(i*.5)*e,n=s*t.aspect;this._nearPlaneCorners[0].set(-n,-s,0),this._nearPlaneCorners[1].set(n,-s,0),this._nearPlaneCorners[2].set(n,s,0),this._nearPlaneCorners[3].set(-n,s,0)}else if(tr(this._camera)){const t=this._camera,e=1/t.zoom,i=t.left*e,s=t.right*e,n=t.top*e,o=t.bottom*e;this._nearPlaneCorners[0].set(i,n,0),this._nearPlaneCorners[1].set(s,n,0),this._nearPlaneCorners[2].set(s,o,0),this._nearPlaneCorners[3].set(i,o,0)}}_collisionTest(){let t=1/0;if(!(this.colliderMeshes.length>=1)||$m(this._camera,"_collisionTest"))return t;const e=this._getTargetDirection(Vl);Zm.lookAt(Qb,e,this._camera.up);for(let i=0;i<4;i++){const s=Gt.copy(this._nearPlaneCorners[i]);s.applyMatrix4(Zm);const n=Na.addVectors(this._target,s);_d.set(n,e),_d.far=this._spherical.radius+1;const o=_d.intersectObjects(this.colliderMeshes);o.length!==0&&o[0].distance<t&&(t=o[0].distance)}return t}_getClientRect(t){if(!this._domElement)return;const e=this._domElement.getBoundingClientRect();return t.x=e.left,t.y=e.top,this._viewport?(t.x+=this._viewport.x,t.y+=e.height-this._viewport.w-this._viewport.y,t.width=this._viewport.z,t.height=this._viewport.w):(t.width=e.width,t.height=e.height),t}_createOnRestPromise(t){return t?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(e=>{const i=()=>{this.removeEventListener("rest",i),e()};this.addEventListener("rest",i)}))}_addAllEventListeners(t){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(t){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(t){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(t,e=new wt.Sphere){const i=e,s=i.center;Pa.makeEmpty(),t.traverseVisible(o=>{o.isMesh&&Pa.expandByObject(o)}),Pa.getCenter(s);let n=0;return t.traverseVisible(o=>{if(!o.isMesh)return;const a=o,c=a.geometry.clone();c.applyMatrix4(a.matrixWorld);const l=c.attributes.position;for(let h=0,u=l.count;h<u;h++)Dt.fromBufferAttribute(l,h),n=Math.max(n,s.distanceToSquared(Dt))}),i.radius=Math.sqrt(n),i}},mg=class dA extends M3{constructor(t){super(t),P(this,"onBeforeUpdate",new nt),P(this,"onAfterUpdate",new nt),P(this,"onAspectUpdated",new nt),P(this,"onDisposed",new nt),P(this,"three"),P(this,"_allControls",new Map),P(this,"updateAspect",()=>{var e;if(!(!this.currentWorld||!this.currentWorld.renderer)){if(this.three instanceof cs){this.onAspectUpdated.trigger();return}if((e=this.currentWorld.renderer)!=null&&e.isResizeable()){const i=this.currentWorld.renderer.getSize();this.three.aspect=i.width/i.height,this.three.updateProjectionMatrix(),this.onAspectUpdated.trigger()}}}),this.three=this.setupCamera(),this.setupEvents(!0),this.onWorldChanged.add(({action:e,world:i})=>{if(e==="added"){const s=this.newCameraControls();this._allControls.set(i.uuid,s)}if(e==="removed"){const s=this._allControls.get(i.uuid);s&&(s.dispose(),this._allControls.delete(i.uuid))}})}get controls(){if(!this.currentWorld)throw new Error("This camera needs a world to work!");const t=this._allControls.get(this.currentWorld.uuid);if(!t)throw new Error("Controls not found!");return t}get enabled(){return this.currentWorld===null?!1:this.controls.enabled}set enabled(t){this.currentWorld!==null&&(this.controls.enabled=t)}dispose(){this.setupEvents(!1),this.onAspectUpdated.reset(),this.onBeforeUpdate.reset(),this.onAfterUpdate.reset(),this.three.removeFromParent(),this.onDisposed.trigger(),this.onDisposed.reset();for(const[t,e]of this._allControls)e.dispose()}update(t){this.enabled&&(this.onBeforeUpdate.trigger(this),this.controls.update(t),this.onAfterUpdate.trigger(this))}setupCamera(){const t=window.innerWidth/window.innerHeight,e=new hr(60,t,1,1e3);return e.position.set(50,50,50),e.lookAt(new M(0,0,0)),e}newCameraControls(){if(!this.currentWorld)throw new Error("This camera needs a world to work!");if(!this.currentWorld.renderer)throw new Error("This camera needs a renderer to work!");yi.install({THREE:dA.getSubsetOfThree()});const{domElement:t}=this.currentWorld.renderer.three,e=new yi(this.three,t);return e.smoothTime=.2,e.dollyToCursor=!0,e.infinityDolly=!0,e.minDistance=6,e}setupEvents(t){t?window.addEventListener("resize",this.updateAspect):window.removeEventListener("resize",this.updateAspect)}static getSubsetOfThree(){return{MOUSE:Ly,Vector2:Ot,Vector3:M,Vector4:Do,Quaternion:Ce,Matrix4:ht,Spherical:My,Box3:vt,Sphere:as,Raycaster:Mo,MathUtils:Ss}}};const fA=class pA extends xt{constructor(t){super(t),P(this,"onAfterUpdate",new nt),P(this,"onBeforeUpdate",new nt),P(this,"onDisposed",new nt),P(this,"list",new Ns),P(this,"enabled",!0),t.add(pA.uuid,this)}create(){const t=new X3(this.components),e=t.uuid;if(this.list.has(e))throw new Error("There is already a world with this name!");return this.list.set(e,t),t}delete(t){if(!this.list.has(t.uuid))throw new Error("The provided world is not found in the list!");this.list.delete(t.uuid),t.dispose()}dispose(){this.enabled=!1;for(const[t,e]of this.list)e.dispose();this.list.clear(),this.onDisposed.trigger()}update(t){if(this.enabled)for(const[e,i]of this.list)i.update(t)}};P(fA,"uuid","fdb61dc4-2ec1-4966-b83d-54ea795fad4a");let mA=fA;function tU(r,t,e,i){return new Promise((s,n)=>{function o(){const a=r.clientWaitSync(t,e,0);if(a===r.WAIT_FAILED){n();return}if(a===r.TIMEOUT_EXPIRED){setTimeout(o,i);return}s()}o()})}async function eU(r,t,e,i,s,n,o){const a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);r.flush(),await tU(r,a,0,10),r.deleteSync(a),r.bindBuffer(t,e),r.getBufferSubData(t,i,s,n,o),r.bindBuffer(t,null)}async function iU(r,t,e,i,s,n,o,a){const c=r.createBuffer();return r.bindBuffer(r.PIXEL_PACK_BUFFER,c),r.bufferData(r.PIXEL_PACK_BUFFER,a.byteLength,r.STREAM_READ),r.readPixels(t,e,i,s,n,o,0),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),await eU(r,r.PIXEL_PACK_BUFFER,c,0,a),r.deleteBuffer(c),a}class sU extends Wc{constructor(){super(...arguments),P(this,"_config",{enabled:{value:!0,type:"Boolean"},width:{type:"Number",interpolable:!0,value:512,min:32,max:1024},height:{type:"Number",interpolable:!0,value:512,min:32,max:1024},autoUpdate:{value:!0,type:"Boolean"},renderDebugFrame:{value:!1,type:"Boolean"},updateInterval:{type:"Number",interpolable:!0,value:1,min:0,max:1},threshold:{type:"Number",interpolable:!0,value:100,min:1,max:512}}),P(this,"_interval",null)}get enabled(){return this._config.enabled.value}set enabled(t){this._config.enabled.value=t,this._component.enabled=t}get width(){return this._config.width.value}set width(t){this.setWidthHeight(t,this.height)}get height(){return this._config.height.value}set height(t){this.setWidthHeight(this.width,t)}get autoUpdate(){return this._config.autoUpdate.value}set autoUpdate(t){this.setAutoAndInterval(t,this.updateInterval)}get updateInterval(){return this._config.updateInterval.value}set updateInterval(t){this.setAutoAndInterval(this.autoUpdate,t)}get renderDebugFrame(){return this._config.renderDebugFrame.value}set renderDebugFrame(t){this._config.renderDebugFrame.value=t}get threshold(){return this._config.threshold.value}set threshold(t){this._config.threshold.value=t}setWidthHeight(t,e){if(t<=0||e<=0)throw new Error("The width and height of the culler renderer must be more than 0!");this._config.width.value=t,this._config.height.value=e,this.resetRenderTarget()}setAutoAndInterval(t,e){if(e<=0)throw new Error("The updateInterval of the culler renderer must be more than 0!");this._config.autoUpdate.value=t,this._config.updateInterval.value=e,this.resetInterval(t)}resetRenderTarget(){this._component.renderTarget.dispose(),this._component.renderTarget=new ts(this.width,this.height),this._component.bufferSize=this.width*this.height*4,this._component.buffer=new Uint8Array(this._component.bufferSize)}resetInterval(t){this._interval!==null&&window.clearInterval(this._interval),t&&(this._interval=window.setInterval(async()=>{this._component.preventUpdate||await this._component.updateVisibility()},this.updateInterval))}}let IA=class{constructor(t,e){if(P(this,"onSetup",new nt),P(this,"onDisposed",new nt),P(this,"onViewUpdated",new vn),P(this,"enabled",!0),P(this,"needsUpdate",!1),P(this,"components"),P(this,"renderTarget",new ts),P(this,"bufferSize",1),P(this,"buffer",new Uint8Array),P(this,"preventUpdate",!1),P(this,"config"),P(this,"isSetup",!1),P(this,"world"),P(this,"renderer"),P(this,"_defaultConfig",{enabled:!0,height:512,width:512,updateInterval:1e3,autoUpdate:!0,renderDebugFrame:!1,threshold:100}),P(this,"worker"),P(this,"scene",new rn),P(this,"_availableColor",1),P(this,"_isWorkerBusy",!1),P(this,"updateVisibility",async n=>{if(!this.enabled||!this.needsUpdate&&!n||this._isWorkerBusy)return;this._isWorkerBusy=!0;const o=this.world.camera.three;o.updateMatrix();const{width:a,height:c}=this.config;this.renderer.setSize(a,c),this.renderer.setRenderTarget(this.renderTarget),this.renderer.render(this.scene,o);const l=this.renderer.getContext();await iU(l,0,0,a,c,l.RGBA,l.UNSIGNED_BYTE,this.buffer),this.renderer.setRenderTarget(null),this.config.renderDebugFrame&&this.renderer.render(this.scene,o),this.worker.postMessage({buffer:this.buffer}),this.needsUpdate=!1}),!e.renderer)throw new Error("The given world must have a renderer!");this.components=t,this.config=new sU(this,this.components,"Culler renderer"),this.world=e,this.renderer=new Qa,this.renderer.clippingPlanes=e.renderer.clippingPlanes;const i=`
      addEventListener("message", (event) => {
        const { buffer } = event.data;
        const colors = new Map();
        for (let i = 0; i < buffer.length; i += 4) {
          const r = buffer[i];
          const g = buffer[i + 1];
          const b = buffer[i + 2];
          const code = "" + r + "-" + g + "-" + b;
          if(colors.has(code)) {
            colors.set(code, colors.get(code) + 1);
          } else {
            colors.set(code, 1);
          }
        }
        postMessage({ colors });
      });
    `,s=new Blob([i],{type:"application/javascript"});this.worker=new Worker(URL.createObjectURL(s)),this.setup()}dispose(){this.enabled=!1,this.config.autoUpdate=!1,this.components.get(bp).list.delete(this.config.uuid);for(const t of this.scene.children)t.removeFromParent();this.onViewUpdated.reset(),this.worker.terminate(),this.renderer.forceContextLoss(),this.renderer.dispose(),this.renderTarget.dispose(),this.buffer=null,this.onDisposed.reset()}setup(t){const e={...this._defaultConfig,...t},{width:i,height:s}=e;this.config.setWidthHeight(i,s);const{updateInterval:n,autoUpdate:o}=e;this.config.setAutoAndInterval(o,n),this.config.threshold=e.threshold,this.isSetup=!0,this.onSetup.trigger()}getAvailableColor(){let t=BigInt(this._availableColor.toString());const e=[];do e.unshift(Number(t%256n)),t/=256n;while(t);for(;e.length!==3;)e.unshift(0);const[i,s,n]=e,o=`${i}-${s}-${n}`;return{r:i,g:s,b:n,code:o}}increaseColor(){if(this._availableColor===256*256*256){console.warn("Color can't be increased over 256 x 256 x 256!");return}this._availableColor++}decreaseColor(){if(this._availableColor===1){console.warn("Color can't be decreased under 0!");return}this._availableColor--}};class nU extends IA{constructor(t,e){super(t,e),P(this,"onViewUpdated",new nt),P(this,"colorMeshes",new Map),P(this,"_colorCodeMeshMap",new Map),P(this,"_meshIDColorCodeMap",new Map),P(this,"_currentVisibleMeshes",new Set),P(this,"_recentlyHiddenMeshes",new Set),P(this,"_transparentMat",new Ue({transparent:!0,opacity:0})),P(this,"handleWorkerMessage",async i=>{if(this.preventUpdate)return;const s=i.data.colors;this._recentlyHiddenMeshes=new Set(this._currentVisibleMeshes),this._currentVisibleMeshes.clear();for(const[n,o]of s){if(o<this.config.threshold)continue;const a=this._colorCodeMeshMap.get(n);a&&(this._currentVisibleMeshes.add(a),this._recentlyHiddenMeshes.delete(a))}this.onViewUpdated.trigger({seen:this._currentVisibleMeshes,unseen:this._recentlyHiddenMeshes}),this._isWorkerBusy=!1}),this.worker.addEventListener("message",this.handleWorkerMessage),this.onViewUpdated.add(({seen:i,unseen:s})=>{for(const n of i)n.visible=!0;for(const n of s)n.visible=!1})}get threshold(){return this.config.threshold}set threshold(t){this.config.threshold=t}dispose(){super.dispose(),this._currentVisibleMeshes.clear(),this._recentlyHiddenMeshes.clear(),this._meshIDColorCodeMap.clear(),this._transparentMat.dispose(),this._colorCodeMeshMap.clear();const t=this.components.get(en);for(const e in this.colorMeshes){const i=this.colorMeshes.get(e);i&&t.destroy(i,!0)}this.colorMeshes.clear()}add(t){if(!this.enabled)return;if(this.preventUpdate){console.log("Culler processing not finished yet.");return}this.preventUpdate=!0;const e=t instanceof Pe,{geometry:i,material:s}=t,{colorMaterial:n,code:o}=this.getAvailableMaterial();let a;if(Array.isArray(s)){let h=!0;const u=[];for(const d of s)jb.isTransparent(d)?u.push(this._transparentMat):(h=!1,u.push(n));if(h){n.dispose(),this.preventUpdate=!1;return}a=u}else if(jb.isTransparent(s)){n.dispose(),this.preventUpdate=!1;return}else a=n;this._colorCodeMeshMap.set(o,t),this._meshIDColorCodeMap.set(t.uuid,o);const c=e?t.count:1,l=new Pe(i,a,c);e?l.instanceMatrix=t.instanceMatrix:l.setMatrixAt(0,new ht),t.visible=!1,t.updateWorldMatrix(!0,!1),l.applyMatrix4(t.matrixWorld),l.updateMatrix(),this.scene.add(l),this.colorMeshes.set(t.uuid,l),this.increaseColor(),this.preventUpdate=!1}remove(t){if(this.preventUpdate){console.log("Culler processing not finished yet.");return}this.preventUpdate=!0;const e=this.components.get(en);this._currentVisibleMeshes.delete(t),this._recentlyHiddenMeshes.delete(t);const i=this.colorMeshes.get(t.uuid),s=this._meshIDColorCodeMap.get(t.uuid);if(!i||!s){this.preventUpdate=!1;return}this._colorCodeMeshMap.delete(s),this._meshIDColorCodeMap.delete(t.uuid),this.colorMeshes.delete(t.uuid),i.geometry=void 0,i.material=[],e.destroy(i,!0),this._recentlyHiddenMeshes.delete(t),this._currentVisibleMeshes.delete(t),this.preventUpdate=!1}updateInstanced(t){for(const e of t){const i=this.colorMeshes.get(e.uuid);i&&(i.count=e.count)}}getAvailableMaterial(){const{r:t,g:e,b:i,code:s}=this.getAvailableColor(),n=ki.enabled;ki.enabled=!1;const o=new Rt(`rgb(${t}, ${e}, ${i})`);if(!this.world.renderer)throw new Error("Renderer not found in the world!");const a=this.world.renderer.clippingPlanes,c=new Ue({color:o,clippingPlanes:a,side:Ps});return ki.enabled=n,{colorMaterial:c,code:s}}}const gA=class Ig extends xt{constructor(t){super(t),P(this,"onDisposed",new nt),P(this,"_enabled",!0),P(this,"list",new Map),t.add(Ig.uuid,this)}get enabled(){return this._enabled}set enabled(t){this._enabled=t;for(const[e,i]of this.list)i.enabled=t}create(t){if(this.list.has(t.uuid))return this.list.get(t.uuid);const e=new nU(this.components,t);return this.list.set(t.uuid,e),e}delete(t){const e=this.list.get(t.uuid);e&&e.dispose(),this.list.delete(t.uuid)}dispose(){this.enabled=!1,this.onDisposed.trigger(Ig.uuid),this.onDisposed.reset();for(const[t,e]of this.list)e.dispose();this.list.clear()}updateInstanced(t){for(const[,e]of this.list)e.updateInstanced(t)}};P(gA,"uuid","69f2a50d-c266-44fc-b1bd-fa4d34be89e6");let rU=gA;class oU{constructor(t){P(this,"_event"),P(this,"_position",new Ot),P(this,"onDisposed",new nt),P(this,"updateMouseInfo",e=>{this._event=e}),this.dom=t,this.setupEvents(!0)}get position(){if(this._event){const t=this.dom.getBoundingClientRect();this._position.x=this.getPositionX(t,this._event),this._position.y=this.getPositionY(t,this._event)}return this._position}dispose(){this.setupEvents(!1),this.onDisposed.trigger(),this.onDisposed.reset()}getPositionY(t,e){return-((this.getDataObject(e).clientY-t.top)/(t.bottom-t.top))*2+1}getPositionX(t,e){return(this.getDataObject(e).clientX-t.left)/(t.right-t.left)*2-1}getDataObject(t){return t instanceof MouseEvent?t:t.touches[0]}setupEvents(t){t?(this.dom.addEventListener("pointermove",this.updateMouseInfo),this.dom.addEventListener("touchstart",this.updateMouseInfo)):(this.dom.removeEventListener("pointermove",this.updateMouseInfo),this.dom.removeEventListener("touchstart",this.updateMouseInfo))}}class aU{constructor(t,e){P(this,"enabled",!0),P(this,"components"),P(this,"onDisposed",new nt),P(this,"mouse"),P(this,"three",new Mo),P(this,"world");const i=e.renderer;if(!i)throw new Error("A renderer is needed for the raycaster to work!");this.world=e,this.mouse=new oU(i.three.domElement),this.components=t}dispose(){this.mouse.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}castRay(t=Array.from(this.world.meshes),e=this.mouse.position){if(!this.world)throw new Error("A world is needed to cast rays!");const i=this.world.camera.three;return this.three.setFromCamera(e,i),this.intersect(t)}castRayFromVector(t,e,i=Array.from(this.world.meshes)){return this.three.set(t,e),this.intersect(i)}intersect(t=Array.from(this.world.meshes)){const e=this.three.intersectObjects(t),i=this.filterClippingPlanes(e);return i.length>0?i[0]:null}filterClippingPlanes(t){if(!this.world.renderer)throw new Error("Renderer not found!");const e=this.world.renderer.three;if(!e.clippingPlanes)return t;const i=e.clippingPlanes;return t.length<=0||!i||i?.length<=0?t:t.filter(s=>i.every(n=>n.distanceToPoint(s.point)>0))}}const EA=class CA extends xt{constructor(t){super(t),P(this,"enabled",!0),P(this,"list",new Map),P(this,"onDisposed",new nt),t.add(CA.uuid,this)}get(t){if(this.list.has(t.uuid))return this.list.get(t.uuid);const e=new aU(this.components,t);return this.list.set(t.uuid,e),t.onDisposed.add(()=>{this.delete(t)}),e}delete(t){const e=this.list.get(t.uuid);e&&e.dispose(),this.list.delete(t.uuid)}dispose(){for(const[t,e]of this.list)e.dispose();this.list.clear(),this.onDisposed.trigger()}};P(EA,"uuid","d5d8bdf0-db25-4952-b951-b643af207ace");let es=EA;class cU extends Wc{constructor(){super(...arguments),P(this,"_config",{visible:{value:!0,type:"Boolean"},color:{value:new Rt,type:"Color"},primarySize:{type:"Number",interpolable:!0,value:1,min:0,max:1e3},secondarySize:{type:"Number",interpolable:!0,value:10,min:0,max:1e3},distance:{type:"Number",interpolable:!0,value:500,min:0,max:500}})}get visible(){return this._config.visible.value}set visible(t){this._config.visible.value=t,this._component.visible=t}get color(){return this._config.color.value}set color(t){this._config.color.value=t,this._component.material.uniforms.uColor.value=t,this._component.material.uniformsNeedUpdate=!0}get primarySize(){return this._config.primarySize.value}set primarySize(t){this._config.primarySize.value=t,this._component.material.uniforms.uSize1.value=t,this._component.material.uniformsNeedUpdate=!0}get secondarySize(){return this._config.secondarySize.value}set secondarySize(t){this._config.secondarySize.value=t,this._component.material.uniforms.uSize2.value=t,this._component.material.uniformsNeedUpdate=!0}get distance(){return this._config.distance.value}set distance(t){this._config.distance.value=t,this._component.material.uniforms.uDistance.value=t,this._component.material.uniformsNeedUpdate=!0}}class lU{constructor(t,e){P(this,"onDisposed",new nt),P(this,"onSetup",new nt),P(this,"isSetup",!1),P(this,"world"),P(this,"components"),P(this,"config"),P(this,"_defaultConfig",{visible:!0,color:new Rt(12303291),primarySize:1,secondarySize:10,distance:500}),P(this,"three"),P(this,"_fade",3),P(this,"updateZoom",()=>{this.world.camera instanceof mg&&(this.material.uniforms.uZoom.value=this.world.camera.three.zoom)}),this.world=e;const{color:i,primarySize:s,secondarySize:n,distance:o}=this._defaultConfig;this.components=t,this.config=new cU(this,this.components,"Grid");const a=new Uo(2,2,1,1),c=new qe({side:Ps,uniforms:{uSize1:{value:s},uSize2:{value:n},uColor:{value:i},uDistance:{value:o},uFade:{value:this._fade},uZoom:{value:1}},transparent:!0,vertexShader:`
            
            varying vec3 worldPosition;
            
            uniform float uDistance;
            
            void main() {
            
                    vec3 pos = position.xzy * uDistance;
                    pos.xz += cameraPosition.xz;
                    
                    worldPosition = pos;
                    
                    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
            
            }
            `,fragmentShader:`
            
            varying vec3 worldPosition;
            
            uniform float uZoom;
            uniform float uFade;
            uniform float uSize1;
            uniform float uSize2;
            uniform vec3 uColor;
            uniform float uDistance;
                
                
                
                float getGrid(float size) {
                
                    vec2 r = worldPosition.xz / size;
                    
                    
                    vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
                    float line = min(grid.x, grid.y);
                    
                
                    return 1.0 - min(line, 1.0);
                }
                
            void main() {
            
                    
                    float d = 1.0 - min(distance(cameraPosition.xz, worldPosition.xz) / uDistance, 1.0);
                    
                    float g1 = getGrid(uSize1);
                    float g2 = getGrid(uSize2);
                    
                    // Ortho camera fades the grid away when zooming out
                    float minZoom = step(0.2, uZoom);
                    float zoomFactor = pow(min(uZoom, 1.), 2.) * minZoom;
                    
                    gl_FragColor = vec4(uColor.rgb, mix(g2, g1, g1) * pow(d, uFade));
                    gl_FragColor.a = mix(0.5 * gl_FragColor.a, gl_FragColor.a, g2) * zoomFactor;
                    
                    if ( gl_FragColor.a <= 0.0 ) discard;
                    
            
            }
            
            `,extensions:{derivatives:!0}});this.three=new it(a,c),this.three.frustumCulled=!1,e.scene.three.add(this.three),this.setupEvents(!0)}get visible(){return this.three.visible}set visible(t){t?this.world.scene.three.add(this.three):this.three.removeFromParent()}get material(){return this.three.material}get fade(){return this._fade===3}set fade(t){this._fade=t?3:0,this.material.uniforms.uFade.value=this._fade}setup(t){const e={...this._defaultConfig,...t};this.config.visible=!0,this.config.color=e.color,this.config.primarySize=e.primarySize,this.config.secondarySize=e.secondarySize,this.config.distance=e.distance,this.isSetup=!0,this.onSetup.trigger()}dispose(){this.setupEvents(!1),this.components.get(bp).list.delete(this.config.uuid),this.components.get(en).destroy(this.three),this.onDisposed.trigger(),this.onDisposed.reset(),this.world=null,this.components=null}setupEvents(t){if(this.world.isDisposing||!(this.world.camera instanceof mg))return;const e=this.world.camera.controls;t?e.addEventListener("update",this.updateZoom):e.removeEventListener("update",this.updateZoom)}}const hU=class bA extends xt{constructor(t){super(t),P(this,"list",new Map),P(this,"onDisposed",new nt),P(this,"enabled",!0),t.add(bA.uuid,this)}create(t){if(this.list.has(t.uuid))throw new Error("This world already has a grid!");const e=new lU(this.components,t);return this.list.set(t.uuid,e),t.onDisposed.add(()=>{this.delete(t)}),e}delete(t){const e=this.list.get(t.uuid);e&&e.dispose(),this.list.delete(t.uuid)}dispose(){for(const[t,e]of this.list)e.dispose();this.list.clear(),this.onDisposed.trigger(),this.onDisposed.reset()}};P(hU,"uuid","d1e814d5-b81c-4452-87a2-f039375e0489");const Kr=new Mo,ti=new M,Zn=new M,fe=new Ce,iT={X:new M(1,0,0),Y:new M(0,1,0),Z:new M(0,0,1)},qm={type:"change"},sT={type:"mouseDown"},nT={type:"mouseUp",mode:null},rT={type:"objectChange"};class uU extends ws{constructor(t,e){super(),e===void 0&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),e=document),this.isTransformControls=!0,this.visible=!1,this.domElement=e,this.domElement.style.touchAction="none";const i=new gU;this._gizmo=i,this.add(i);const s=new EU;this._plane=s,this.add(s);const n=this;function o(C,b){let E=b;Object.defineProperty(n,C,{get:function(){return E!==void 0?E:b},set:function(T){E!==T&&(E=T,s[C]=T,i[C]=T,n.dispatchEvent({type:C+"-changed",value:T}),n.dispatchEvent(qm))}}),n[C]=b,s[C]=b,i[C]=b}o("camera",t),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const a=new M,c=new M,l=new Ce,h=new Ce,u=new M,d=new Ce,f=new M,p=new M,m=new M,g=0,I=new M;o("worldPosition",a),o("worldPositionStart",c),o("worldQuaternion",l),o("worldQuaternionStart",h),o("cameraPosition",u),o("cameraQuaternion",d),o("pointStart",f),o("pointEnd",p),o("rotationAxis",m),o("rotationAngle",g),o("eye",I),this._offset=new M,this._startNorm=new M,this._endNorm=new M,this._cameraScale=new M,this._parentPosition=new M,this._parentQuaternion=new Ce,this._parentQuaternionInv=new Ce,this._parentScale=new M,this._worldScaleStart=new M,this._worldQuaternionInv=new Ce,this._worldScale=new M,this._positionStart=new M,this._quaternionStart=new Ce,this._scaleStart=new M,this._getPointer=dU.bind(this),this._onPointerDown=pU.bind(this),this._onPointerHover=fU.bind(this),this._onPointerMove=mU.bind(this),this._onPointerUp=IU.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(t){if(this.object===void 0||this.dragging===!0)return;Kr.setFromCamera(t,this.camera);const e=Qm(this._gizmo.picker[this.mode],Kr);e?this.axis=e.object.name:this.axis=null}pointerDown(t){if(!(this.object===void 0||this.dragging===!0||t.button!==0)&&this.axis!==null){Kr.setFromCamera(t,this.camera);const e=Qm(this._plane,Kr,!0);e&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(e.point).sub(this.worldPositionStart)),this.dragging=!0,sT.mode=this.mode,this.dispatchEvent(sT)}}pointerMove(t){const e=this.axis,i=this.mode,s=this.object;let n=this.space;if(i==="scale"?n="local":(e==="E"||e==="XYZE"||e==="XYZ")&&(n="world"),s===void 0||e===null||this.dragging===!1||t.button!==-1)return;Kr.setFromCamera(t,this.camera);const o=Qm(this._plane,Kr,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),i==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),n==="local"&&e!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),e.indexOf("X")===-1&&(this._offset.x=0),e.indexOf("Y")===-1&&(this._offset.y=0),e.indexOf("Z")===-1&&(this._offset.z=0),n==="local"&&e!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),s.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(n==="local"&&(s.position.applyQuaternion(fe.copy(this._quaternionStart).invert()),e.search("X")!==-1&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.position.applyQuaternion(this._quaternionStart)),n==="world"&&(s.parent&&s.position.add(ti.setFromMatrixPosition(s.parent.matrixWorld)),e.search("X")!==-1&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.parent&&s.position.sub(ti.setFromMatrixPosition(s.parent.matrixWorld))));else if(i==="scale"){if(e.search("XYZ")!==-1){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),Zn.set(a,a,a)}else ti.copy(this.pointStart),Zn.copy(this.pointEnd),ti.applyQuaternion(this._worldQuaternionInv),Zn.applyQuaternion(this._worldQuaternionInv),Zn.divide(ti),e.search("X")===-1&&(Zn.x=1),e.search("Y")===-1&&(Zn.y=1),e.search("Z")===-1&&(Zn.z=1);s.scale.copy(this._scaleStart).multiply(Zn),this.scaleSnap&&(e.search("X")!==-1&&(s.scale.x=Math.round(s.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Y")!==-1&&(s.scale.y=Math.round(s.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Z")!==-1&&(s.scale.z=Math.round(s.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(i==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(ti.setFromMatrixPosition(this.camera.matrixWorld));let c=!1;e==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(ti.copy(this.rotationAxis).cross(this.eye))*a):(e==="X"||e==="Y"||e==="Z")&&(this.rotationAxis.copy(iT[e]),ti.copy(iT[e]),n==="local"&&ti.applyQuaternion(this.worldQuaternion),ti.cross(this.eye),ti.length()===0?c=!0:this.rotationAngle=this._offset.dot(ti.normalize())*a),(e==="E"||c)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),n==="local"&&e!=="E"&&e!=="XYZE"?(s.quaternion.copy(this._quaternionStart),s.quaternion.multiply(fe.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),s.quaternion.copy(fe.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),s.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(qm),this.dispatchEvent(rT)}}pointerUp(t){t.button===0&&(this.dragging&&this.axis!==null&&(nT.mode=this.mode,this.dispatchEvent(nT)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(t){t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()})}attach(t){return this.object=t,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(qm),this.dispatchEvent(rT),this.pointStart.copy(this.pointEnd))}getRaycaster(){return Kr}getMode(){return this.mode}setMode(t){this.mode=t}setTranslationSnap(t){this.translationSnap=t}setRotationSnap(t){this.rotationSnap=t}setScaleSnap(t){this.scaleSnap=t}setSize(t){this.size=t}setSpace(t){this.space=t}}function dU(r){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:r.button};{const t=this.domElement.getBoundingClientRect();return{x:(r.clientX-t.left)/t.width*2-1,y:-(r.clientY-t.top)/t.height*2+1,button:r.button}}}function fU(r){if(this.enabled)switch(r.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(r));break}}function pU(r){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(r.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(r)),this.pointerDown(this._getPointer(r)))}function mU(r){this.enabled&&this.pointerMove(this._getPointer(r))}function IU(r){this.enabled&&(this.domElement.releasePointerCapture(r.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(r)))}function Qm(r,t,e){const i=t.intersectObject(r,!0);for(let s=0;s<i.length;s++)if(i[s].object.visible||e)return i[s];return!1}const Fd=new tE,ie=new M(0,1,0),oT=new M(0,0,0),aT=new ht,Od=new Ce,rf=new Ce,Gs=new M,cT=new ht,th=new M(1,0,0),co=new M(0,1,0),eh=new M(0,0,1),xd=new M,Yl=new M,Gl=new M;let gU=class extends ws{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const t=new Ue({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),e=new xi({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=t.clone();i.opacity=.15;const s=e.clone();s.opacity=.5;const n=t.clone();n.color.setHex(16711680);const o=t.clone();o.color.setHex(65280);const a=t.clone();a.color.setHex(255);const c=t.clone();c.color.setHex(16711680),c.opacity=.5;const l=t.clone();l.color.setHex(65280),l.opacity=.5;const h=t.clone();h.color.setHex(255),h.opacity=.5;const u=t.clone();u.opacity=.25;const d=t.clone();d.color.setHex(16776960),d.opacity=.25,t.clone().color.setHex(16776960);const f=t.clone();f.color.setHex(7895160);const p=new Xt(0,.04,.1,12);p.translate(0,.05,0);const m=new kt(.08,.08,.08);m.translate(0,.04,0);const g=new Ut;g.setAttribute("position",new Cr([0,0,0,1,0,0],3));const I=new Xt(.0075,.0075,.5,3);I.translate(0,.25,0);function C(y,U){const H=new Zs(y,.0075,3,64,U*Math.PI*2);return H.rotateY(Math.PI/2),H.rotateX(Math.PI/2),H}function b(){const y=new Ut;return y.setAttribute("position",new Cr([0,0,0,1,1,1],3)),y}const E={X:[[new it(p,n),[.5,0,0],[0,0,-Math.PI/2]],[new it(p,n),[-.5,0,0],[0,0,Math.PI/2]],[new it(I,n),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new it(p,o),[0,.5,0]],[new it(p,o),[0,-.5,0],[Math.PI,0,0]],[new it(I,o)]],Z:[[new it(p,a),[0,0,.5],[Math.PI/2,0,0]],[new it(p,a),[0,0,-.5],[-Math.PI/2,0,0]],[new it(I,a),null,[Math.PI/2,0,0]]],XYZ:[[new it(new ur(.1,0),u.clone()),[0,0,0]]],XY:[[new it(new kt(.15,.15,.01),h.clone()),[.15,.15,0]]],YZ:[[new it(new kt(.15,.15,.01),c.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new it(new kt(.15,.15,.01),l.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},T={X:[[new it(new Xt(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new it(new Xt(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new it(new Xt(.2,0,.6,4),i),[0,.3,0]],[new it(new Xt(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new it(new Xt(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new it(new Xt(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new it(new ur(.2,0),i)]],XY:[[new it(new kt(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new it(new kt(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new it(new kt(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},A={START:[[new it(new ur(.01,2),s),null,null,null,"helper"]],END:[[new it(new ur(.01,2),s),null,null,null,"helper"]],DELTA:[[new Qt(b(),s),null,null,null,"helper"]],X:[[new Qt(g,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Qt(g,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Qt(g,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},S={XYZE:[[new it(C(.5,1),f),null,[0,Math.PI/2,0]]],X:[[new it(C(.5,.5),n)]],Y:[[new it(C(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new it(C(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new it(C(.75,1),d),null,[0,Math.PI/2,0]]]},_={AXIS:[[new Qt(g,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},w={XYZE:[[new it(new Dy(.25,10,8),i)]],X:[[new it(new Zs(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new it(new Zs(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new it(new Zs(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new it(new Zs(.75,.1,2,24),i)]]},F={X:[[new it(m,n),[.5,0,0],[0,0,-Math.PI/2]],[new it(I,n),[0,0,0],[0,0,-Math.PI/2]],[new it(m,n),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new it(m,o),[0,.5,0]],[new it(I,o)],[new it(m,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new it(m,a),[0,0,.5],[Math.PI/2,0,0]],[new it(I,a),[0,0,0],[Math.PI/2,0,0]],[new it(m,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new it(new kt(.15,.15,.01),h),[.15,.15,0]]],YZ:[[new it(new kt(.15,.15,.01),c),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new it(new kt(.15,.15,.01),l),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new it(new kt(.1,.1,.1),u.clone())]]},D={X:[[new it(new Xt(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new it(new Xt(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new it(new Xt(.2,0,.6,4),i),[0,.3,0]],[new it(new Xt(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new it(new Xt(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new it(new Xt(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new it(new kt(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new it(new kt(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new it(new kt(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new it(new kt(.2,.2,.2),i),[0,0,0]]]},R={X:[[new Qt(g,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Qt(g,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Qt(g,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function O(y){const U=new ws;for(const H in y)for(let k=y[H].length;k--;){const X=y[H][k][0].clone(),$=y[H][k][1],et=y[H][k][2],Y=y[H][k][3],z=y[H][k][4];X.name=H,X.tag=z,$&&X.position.set($[0],$[1],$[2]),et&&X.rotation.set(et[0],et[1],et[2]),Y&&X.scale.set(Y[0],Y[1],Y[2]),X.updateMatrix();const st=X.geometry.clone();st.applyMatrix4(X.matrix),X.geometry=st,X.renderOrder=1/0,X.position.set(0,0,0),X.rotation.set(0,0,0),X.scale.set(1,1,1),U.add(X)}return U}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=O(E)),this.add(this.gizmo.rotate=O(S)),this.add(this.gizmo.scale=O(F)),this.add(this.picker.translate=O(T)),this.add(this.picker.rotate=O(w)),this.add(this.picker.scale=O(D)),this.add(this.helper.translate=O(A)),this.add(this.helper.rotate=O(_)),this.add(this.helper.scale=O(R)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(t){const e=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:rf;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let i=[];i=i.concat(this.picker[this.mode].children),i=i.concat(this.gizmo[this.mode].children),i=i.concat(this.helper[this.mode].children);for(let s=0;s<i.length;s++){const n=i[s];n.visible=!0,n.rotation.set(0,0,0),n.position.copy(this.worldPosition);let o;if(this.camera.isOrthographicCamera?o=(this.camera.top-this.camera.bottom)/this.camera.zoom:o=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),n.scale.set(1,1,1).multiplyScalar(o*this.size/4),n.tag==="helper"){n.visible=!1,n.name==="AXIS"?(n.visible=!!this.axis,this.axis==="X"&&(fe.setFromEuler(Fd.set(0,0,0)),n.quaternion.copy(e).multiply(fe),Math.abs(ie.copy(th).applyQuaternion(e).dot(this.eye))>.9&&(n.visible=!1)),this.axis==="Y"&&(fe.setFromEuler(Fd.set(0,0,Math.PI/2)),n.quaternion.copy(e).multiply(fe),Math.abs(ie.copy(co).applyQuaternion(e).dot(this.eye))>.9&&(n.visible=!1)),this.axis==="Z"&&(fe.setFromEuler(Fd.set(0,Math.PI/2,0)),n.quaternion.copy(e).multiply(fe),Math.abs(ie.copy(eh).applyQuaternion(e).dot(this.eye))>.9&&(n.visible=!1)),this.axis==="XYZE"&&(fe.setFromEuler(Fd.set(0,Math.PI/2,0)),ie.copy(this.rotationAxis),n.quaternion.setFromRotationMatrix(aT.lookAt(oT,ie,co)),n.quaternion.multiply(fe),n.visible=this.dragging),this.axis==="E"&&(n.visible=!1)):n.name==="START"?(n.position.copy(this.worldPositionStart),n.visible=this.dragging):n.name==="END"?(n.position.copy(this.worldPosition),n.visible=this.dragging):n.name==="DELTA"?(n.position.copy(this.worldPositionStart),n.quaternion.copy(this.worldQuaternionStart),ti.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),ti.applyQuaternion(this.worldQuaternionStart.clone().invert()),n.scale.copy(ti),n.visible=this.dragging):(n.quaternion.copy(e),this.dragging?n.position.copy(this.worldPositionStart):n.position.copy(this.worldPosition),this.axis&&(n.visible=this.axis.search(n.name)!==-1));continue}n.quaternion.copy(e),this.mode==="translate"||this.mode==="scale"?(n.name==="X"&&Math.abs(ie.copy(th).applyQuaternion(e).dot(this.eye))>.99&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),n.name==="Y"&&Math.abs(ie.copy(co).applyQuaternion(e).dot(this.eye))>.99&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),n.name==="Z"&&Math.abs(ie.copy(eh).applyQuaternion(e).dot(this.eye))>.99&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),n.name==="XY"&&Math.abs(ie.copy(eh).applyQuaternion(e).dot(this.eye))<.2&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),n.name==="YZ"&&Math.abs(ie.copy(th).applyQuaternion(e).dot(this.eye))<.2&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),n.name==="XZ"&&Math.abs(ie.copy(co).applyQuaternion(e).dot(this.eye))<.2&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1)):this.mode==="rotate"&&(Od.copy(e),ie.copy(this.eye).applyQuaternion(fe.copy(e).invert()),n.name.search("E")!==-1&&n.quaternion.setFromRotationMatrix(aT.lookAt(this.eye,oT,co)),n.name==="X"&&(fe.setFromAxisAngle(th,Math.atan2(-ie.y,ie.z)),fe.multiplyQuaternions(Od,fe),n.quaternion.copy(fe)),n.name==="Y"&&(fe.setFromAxisAngle(co,Math.atan2(ie.x,ie.z)),fe.multiplyQuaternions(Od,fe),n.quaternion.copy(fe)),n.name==="Z"&&(fe.setFromAxisAngle(eh,Math.atan2(ie.y,ie.x)),fe.multiplyQuaternions(Od,fe),n.quaternion.copy(fe))),n.visible=n.visible&&(n.name.indexOf("X")===-1||this.showX),n.visible=n.visible&&(n.name.indexOf("Y")===-1||this.showY),n.visible=n.visible&&(n.name.indexOf("Z")===-1||this.showZ),n.visible=n.visible&&(n.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),n.material._color=n.material._color||n.material.color.clone(),n.material._opacity=n.material._opacity||n.material.opacity,n.material.color.copy(n.material._color),n.material.opacity=n.material._opacity,this.enabled&&this.axis&&(n.name===this.axis||this.axis.split("").some(function(a){return n.name===a}))&&(n.material.color.setHex(16776960),n.material.opacity=1)}super.updateMatrixWorld(t)}},EU=class extends it{constructor(){super(new Uo(1e5,1e5,2,2),new Ue({visible:!1,wireframe:!0,side:Ps,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(t){let e=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(e="local"),xd.copy(th).applyQuaternion(e==="local"?this.worldQuaternion:rf),Yl.copy(co).applyQuaternion(e==="local"?this.worldQuaternion:rf),Gl.copy(eh).applyQuaternion(e==="local"?this.worldQuaternion:rf),ie.copy(Yl),this.mode){case"translate":case"scale":switch(this.axis){case"X":ie.copy(this.eye).cross(xd),Gs.copy(xd).cross(ie);break;case"Y":ie.copy(this.eye).cross(Yl),Gs.copy(Yl).cross(ie);break;case"Z":ie.copy(this.eye).cross(Gl),Gs.copy(Gl).cross(ie);break;case"XY":Gs.copy(Gl);break;case"YZ":Gs.copy(xd);break;case"XZ":ie.copy(Gl),Gs.copy(Yl);break;case"XYZ":case"E":Gs.set(0,0,0);break}break;case"rotate":default:Gs.set(0,0,0)}Gs.length()===0?this.quaternion.copy(this.cameraQuaternion):(cT.lookAt(ti.set(0,0,0),Gs,ie),this.quaternion.setFromRotationMatrix(cT)),super.updateMatrixWorld(t)}},TA=class yA{constructor(t,e,i,s,n,o=5,a=!0){if(P(this,"onDraggingStarted",new nt),P(this,"onDraggingEnded",new nt),P(this,"onDisposed",new nt),P(this,"normal"),P(this,"origin"),P(this,"three",new Qe),P(this,"components"),P(this,"world"),P(this,"type","default"),P(this,"_helper"),P(this,"_visible",!0),P(this,"_enabled",!0),P(this,"_controlsActive",!1),P(this,"_arrowBoundBox",new it),P(this,"_planeMesh"),P(this,"_controls"),P(this,"_hiddenMaterial",new Ue({visible:!1})),P(this,"update",()=>{this._enabled&&this.three.setFromNormalAndCoplanarPoint(this.normal,this._helper.position)}),P(this,"changeDrag",c=>{this._visible=!c.value,this.preventCameraMovement(),this.notifyDraggingChanged(c)}),this.components=t,this.world=e,!e.renderer)throw new Error("The given world must have a renderer!");this.normal=s,this.origin=i,e.renderer.setPlane(!0,this.three),this._planeMesh=yA.newPlaneMesh(o,n),this._helper=this.newHelper(),this._controls=this.newTransformControls(),this.three.setFromNormalAndCoplanarPoint(s,i),a&&this.toggleControls(!0)}get enabled(){return this._enabled}set enabled(t){if(!this.world.isDisposing){if(!this.world.renderer)throw new Error("No renderer found for clipping plane!");this._enabled=t,this.world.renderer.setPlane(t,this.three)}}get visible(){return this._visible}set visible(t){this._visible=t,this._controls.visible=t,this._helper.visible=t,this.toggleControls(t)}get meshes(){return[this._planeMesh,this._arrowBoundBox]}get planeMaterial(){return this._planeMesh.material}set planeMaterial(t){this._planeMesh.material=t}get size(){return this._planeMesh.scale.x}set size(t){this._planeMesh.scale.set(t,t,t)}get helper(){return this._helper}setFromNormalAndCoplanarPoint(t,e){this.reset(),this.normal.equals(t)||(this.normal.copy(t),this._helper.lookAt(t)),this.origin.copy(e),this._helper.position.copy(e),this._helper.updateMatrix(),this.update()}dispose(){this._enabled=!1,this.onDraggingStarted.reset(),this.onDraggingEnded.reset(),this._helper.removeFromParent(),this.world.renderer&&this.world.renderer.setPlane(!1,this.three),this._arrowBoundBox.removeFromParent(),this._arrowBoundBox.geometry.dispose(),this._planeMesh.geometry.dispose(),this._controls.removeFromParent(),this._controls.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}reset(){const t=new M(1,0,0),e=new M;this.normal.equals(t)||(this.normal.copy(t),this._helper.lookAt(t)),this.origin.copy(e),this._helper.position.copy(e),this._helper.updateMatrix()}toggleControls(t){if(t){if(this._controlsActive)return;this._controls.addEventListener("change",this.update),this._controls.addEventListener("dragging-changed",this.changeDrag)}else this._controls.removeEventListener("change",this.update),this._controls.removeEventListener("dragging-changed",this.changeDrag);this._controlsActive=t}newTransformControls(){if(!this.world.renderer)throw new Error("No renderer found for clipping plane!");const t=this.world.camera.three,e=this.world.renderer.three.domElement,i=new uU(t,e);return this.initializeControls(i),this.world.scene.three.add(i),i}initializeControls(t){t.attach(this._helper),t.showX=!1,t.showY=!1,t.setSpace("local"),this.createArrowBoundingBox(),t.children[0].children[0].add(this._arrowBoundBox)}createArrowBoundingBox(){this._arrowBoundBox.geometry=new Xt(.18,.18,1.2),this._arrowBoundBox.material=this._hiddenMaterial,this._arrowBoundBox.rotateX(Math.PI/2),this._arrowBoundBox.updateMatrix(),this._arrowBoundBox.geometry.applyMatrix4(this._arrowBoundBox.matrix)}notifyDraggingChanged(t){t.value?this.onDraggingStarted.trigger():this.onDraggingEnded.trigger()}preventCameraMovement(){this.world.camera.enabled=this._visible}newHelper(){const t=new ws;return t.lookAt(this.normal),t.position.copy(this.origin),this._planeMesh.position.z+=.01,t.add(this._planeMesh),this.world.scene.three.add(t),t}static newPlaneMesh(t,e){const i=new Uo(1),s=new it(i,e);return s.scale.set(t,t,t),s}},CU=class extends Wc{constructor(){super(...arguments),P(this,"_config",{enabled:{value:!0,type:"Boolean"},visible:{value:!0,type:"Boolean"},color:{value:new Rt,type:"Color"},opacity:{type:"Number",interpolable:!0,value:1,min:0,max:1},size:{type:"Number",interpolable:!0,value:2,min:0,max:100}})}get enabled(){return this._config.enabled.value}set enabled(t){this._config.enabled.value=t,this._component.enabled=t}get visible(){return this._config.visible.value}set visible(t){this._config.visible.value=t,this._component.visible=t}get color(){return this._config.color.value}set color(t){this._config.color.value=t,this._component.material.color.copy(t)}get opacity(){return this._config.opacity.value}set opacity(t){this._config.opacity.value=t,this._component.material.opacity=t}get size(){return this._config.size.value}set size(t){this._config.size.value=t,this._component.size=t}};const vA=class of extends xt{constructor(t){super(t),P(this,"onSetup",new nt),P(this,"onBeforeDrag",new nt),P(this,"onAfterDrag",new nt),P(this,"onBeforeCreate",new nt),P(this,"onBeforeCancel",new nt),P(this,"onAfterCancel",new nt),P(this,"onBeforeDelete",new nt),P(this,"onAfterCreate",new nt),P(this,"onAfterDelete",new nt),P(this,"onDisposed",new nt),P(this,"isSetup",!1),P(this,"orthogonalY",!1),P(this,"toleranceOrthogonalY",.7),P(this,"Type",TA),P(this,"list",[]),P(this,"config",new CU(this,this.components,"Clipper",of.uuid)),P(this,"_defaultConfig",{color:new Rt(12255487),opacity:.2,size:2}),P(this,"_material",new Ue({color:12255487,side:Ps,transparent:!0,opacity:.2})),P(this,"_size",5),P(this,"_enabled",!1),P(this,"_visible",!0),P(this,"_onStartDragging",()=>{this.onBeforeDrag.trigger()}),P(this,"_onEndDragging",()=>{this.onAfterDrag.trigger()}),this.components.add(of.uuid,this)}get enabled(){return this._enabled}set enabled(t){this._enabled=t;for(const e of this.list)e.enabled=t;this.updateMaterialsAndPlanes()}get visible(){return this._visible}set visible(t){this._visible=t;for(const e of this.list)e.visible=t}get material(){return this._material}set material(t){this._material=t;for(const e of this.list)e.planeMaterial=t}get size(){return this._size}set size(t){this._size=t;for(const e of this.list)e.size=t}dispose(){this._enabled=!1,this.components.get(bp).list.delete(this.config.uuid);for(const t of this.list)t.dispose();this.list.length=0,this._material.dispose(),this.onBeforeCreate.reset(),this.onBeforeCancel.reset(),this.onBeforeDelete.reset(),this.onBeforeDrag.reset(),this.onAfterCreate.reset(),this.onAfterCancel.reset(),this.onAfterDelete.reset(),this.onAfterDrag.reset(),this.onDisposed.trigger(of.uuid),this.onDisposed.reset()}create(t){const e=this.components.get(es).get(t).castRay();return e?this.createPlaneFromIntersection(t,e):null}createFromNormalAndCoplanarPoint(t,e,i){const s=this.newPlane(t,i,e);return this.updateMaterialsAndPlanes(),s}delete(t,e){e||(e=this.pickPlane(t)),e&&this.deletePlane(e)}deleteAll(t){const e=[...this.list];for(const i of e)if(!t||t.has(i.type)){this.delete(i.world,i);const s=this.list.indexOf(i);s!==-1&&this.list.splice(s,1)}}setup(t){const e={...this._defaultConfig,...t};this.config.color=e.color,this.config.opacity=e.opacity,this.config.size=e.size,this.isSetup=!0,this.onSetup.trigger()}deletePlane(t){const e=this.list.indexOf(t);if(e!==-1){if(this.list.splice(e,1),!t.world.renderer)throw new Error("Renderer not found for this plane's world!");t.world.renderer.setPlane(!1,t.three),t.dispose(),this.updateMaterialsAndPlanes(),this.onAfterDelete.trigger(t)}}pickPlane(t){const e=this.components.get(es).get(t),i=this.getAllPlaneMeshes(),s=e.castRay(i);if(s){const n=s.object;return this.list.find(o=>o.meshes.includes(n))}}getAllPlaneMeshes(){const t=[];for(const e of this.list)t.push(...e.meshes);return t}createPlaneFromIntersection(t,e){var i;if(!t.renderer)throw new Error("The given world must have a renderer!");const s=e.point.distanceTo(new M(0,0,0)),n=(i=e.face)==null?void 0:i.normal;if(!s||!n)return null;const o=this.getWorldNormal(e,n),a=this.newPlane(t,e.point,o.negate());return a.visible=this._visible,a.size=this._size,t.renderer.setPlane(!0,a.three),this.updateMaterialsAndPlanes(),a}getWorldNormal(t,e){const i=t.object;let s=t.object.matrixWorld.clone();if(i instanceof Pe&&t.instanceId!==void 0){const a=new ht;i.getMatrixAt(t.instanceId,a),s=a.multiply(s)}const n=new fi().getNormalMatrix(s),o=e.clone().applyMatrix3(n).normalize();return this.normalizePlaneDirectionY(o),o}normalizePlaneDirectionY(t){this.orthogonalY&&(t.y>this.toleranceOrthogonalY&&(t.x=0,t.y=1,t.z=0),t.y<-this.toleranceOrthogonalY&&(t.x=0,t.y=-1,t.z=0))}newPlane(t,e,i){const s=new this.Type(this.components,t,e,i,this._material);return s.onDraggingStarted.add(this._onStartDragging),s.onDraggingEnded.add(this._onEndDragging),this.list.push(s),this.onAfterCreate.trigger(s),s}updateMaterialsAndPlanes(){const t=this.components.get(mA);for(const[e,i]of t.list){if(!i.renderer)continue;i.renderer.updateClippingPlanes();const{clippingPlanes:s}=i.renderer;for(const n of i.meshes)if(n.material)if(Array.isArray(n.material))for(const o of n.material)o.clippingPlanes=s;else n.material.clippingPlanes=s}}};P(vA,"uuid","66290bc5-18c4-4cd1-9379-2e17a0617611");let cc=vA,bU=class{constructor(t){P(this,"enabled",!1),P(this,"id","FirstPerson"),this.camera=t}set(t){if(this.enabled=t,t){if(this.camera.projection.current!=="Perspective"){this.camera.set("Orbit");return}this.setupFirstPersonCamera()}}setupFirstPersonCamera(){const t=this.camera.controls,e=new M;t.distance--,t.getPosition(e),t.minDistance=1,t.maxDistance=1,t.distance=1,t.moveTo(e.x,e.y,e.z),t.truckSpeed=50,t.mouseButtons.wheel=yi.ACTION.DOLLY,t.touches.two=yi.ACTION.TOUCH_ZOOM_TRUCK}},TU=class{constructor(t){P(this,"enabled",!0),P(this,"id","Orbit"),this.camera=t,this.activateOrbitControls()}set(t){this.enabled=t,t&&this.activateOrbitControls()}activateOrbitControls(){const t=this.camera.controls;t.minDistance=1,t.maxDistance=300;const e=new M;t.getPosition(e);const i=e.length();t.distance=i,t.truckSpeed=2;const{rotation:s}=this.camera.three,n=new M(0,0,-1).applyEuler(s),o=e.addScaledVector(n,i);t.moveTo(o.x,o.y,o.z)}},yU=class{constructor(t){P(this,"enabled",!1),P(this,"id","Plan"),P(this,"mouseAction1"),P(this,"mouseAction2"),P(this,"mouseInitialized",!1),P(this,"defaultAzimuthSpeed"),P(this,"defaultPolarSpeed"),this.camera=t,this.defaultAzimuthSpeed=t.controls.azimuthRotateSpeed,this.defaultPolarSpeed=t.controls.polarRotateSpeed}set(t){this.enabled=t;const e=this.camera.controls;e.azimuthRotateSpeed=t?0:this.defaultAzimuthSpeed,e.polarRotateSpeed=t?0:this.defaultPolarSpeed,this.mouseInitialized||(this.mouseAction1=e.touches.one,this.mouseAction2=e.touches.two,this.mouseInitialized=!0),t?(e.mouseButtons.left=yi.ACTION.TRUCK,e.touches.one=yi.ACTION.TOUCH_TRUCK,e.touches.two=yi.ACTION.TOUCH_ZOOM):(e.mouseButtons.left=yi.ACTION.ROTATE,e.touches.one=this.mouseAction1,e.touches.two=this.mouseAction2)}},vU=class{constructor(t){P(this,"onChanged",new nt),P(this,"current","Perspective"),P(this,"camera"),P(this,"matchOrthoDistanceEnabled",!1),P(this,"_component"),P(this,"_previousDistance",-1),this._component=t,this.camera=t.three}async set(t){this.current!==t&&(t==="Orthographic"?this.setOrthoCamera():await this.setPerspectiveCamera(),this.onChanged.trigger(this.camera))}async toggle(){const t=this.current==="Perspective"?"Orthographic":"Perspective";await this.set(t)}setOrthoCamera(){if(this._component.mode===null||this._component.mode.id==="FirstPerson")return;this._previousDistance=this._component.controls.distance,this._component.controls.distance=200;const t=this.getPerspectiveDims();if(!t)return;const{width:e,height:i}=t;this.setupOrthoCamera(i,e),this.camera=this._component.threeOrtho,this.current="Orthographic"}getPerspectiveDims(){const t=this._component.currentWorld;if(!t||!t.renderer)return null;const e=new M;this._component.threePersp.getWorldDirection(e);const i=new M;this._component.controls.getTarget(i);const s=i.clone().sub(this._component.threePersp.position).dot(e),n=t.renderer.getSize(),o=n.x/n.y,a=this._component.threePersp,c=s*2*Math.atan(a.fov*(Math.PI/180)/2);return{width:c*o,height:c}}setupOrthoCamera(t,e){this._component.controls.mouseButtons.wheel=yi.ACTION.ZOOM,this._component.controls.mouseButtons.middle=yi.ACTION.ZOOM;const i=this._component.threePersp,s=this._component.threeOrtho;s.zoom=1,s.left=e/-2,s.right=e/2,s.top=t/2,s.bottom=t/-2,s.updateProjectionMatrix(),s.position.copy(i.position),s.quaternion.copy(i.quaternion),this._component.controls.camera=s}getDistance(){const t=this._component.threePersp,e=this._component.threeOrtho;return(e.top-e.bottom)/e.zoom/(2*Math.atan(t.fov*(Math.PI/180)/2))}async setPerspectiveCamera(){this._component.controls.mouseButtons.wheel=yi.ACTION.DOLLY,this._component.controls.mouseButtons.middle=yi.ACTION.DOLLY;const t=this._component.threePersp,e=this._component.threeOrtho;t.position.copy(e.position),t.quaternion.copy(e.quaternion),this._component.controls.mouseButtons.wheel=yi.ACTION.DOLLY,this.matchOrthoDistanceEnabled?this._component.controls.distance=this.getDistance():this._component.controls.distance=this._previousDistance,await this._component.controls.zoomTo(1),t.updateProjectionMatrix(),this._component.controls.camera=t,this.camera=t,this.current="Perspective"}},RU=class extends mg{constructor(t){super(t),P(this,"projection"),P(this,"threeOrtho"),P(this,"threePersp"),P(this,"_userInputButtons",{}),P(this,"_frustumSize",50),P(this,"_navigationModes",new Map),P(this,"_mode",null),P(this,"previousSize",null),this.threePersp=this.three,this.threeOrtho=this.newOrthoCamera(),this.projection=new vU(this),this.onAspectUpdated.add(()=>{this.setOrthoPerspCameraAspect()}),this.projection.onChanged.add(e=>{this.three=e,this.updateAspect()}),this.onWorldChanged.add(({action:e})=>{e==="added"&&(this._navigationModes.clear(),this._navigationModes.set("Orbit",new TU(this)),this._navigationModes.set("FirstPerson",new bU(this)),this._navigationModes.set("Plan",new yU(this)),this._mode=this._navigationModes.get("Orbit"),this.mode.set(!0,{preventTargetAdjustment:!0}),this.currentWorld&&this.currentWorld.renderer&&(this.previousSize=this.currentWorld.renderer.getSize().clone()))})}get mode(){if(!this._mode)throw new Error("Mode not found, camera not initialized");return this._mode}dispose(){super.dispose(),this.threeOrtho.removeFromParent()}set(t){if(this.mode!==null&&this.mode.id!==t){if(this.mode.set(!1),!this._navigationModes.has(t))throw new Error("The specified mode does not exist!");this._mode=this._navigationModes.get(t),this.mode.set(!0)}}async fit(t,e=1.5){if(!this.enabled)return;const i=Number.MAX_VALUE,s=Number.MIN_VALUE,n=new M(i,i,i),o=new M(s,s,s);for(const d of t){const f=new vt().setFromObject(d);f.min.x<n.x&&(n.x=f.min.x),f.min.y<n.y&&(n.y=f.min.y),f.min.z<n.z&&(n.z=f.min.z),f.max.x>o.x&&(o.x=f.max.x),f.max.y>o.y&&(o.y=f.max.y),f.max.z>o.z&&(o.z=f.max.z)}const a=new vt(n,o),c=new M;a.getSize(c);const l=new M;a.getCenter(l);const h=Math.max(c.x,c.y,c.z)*e,u=new as(l,h);await this.controls.fitToSphere(u,!0)}setUserInput(t){t?this.enableUserInput():this.disableUserInput()}disableUserInput(){this._userInputButtons.left=this.controls.mouseButtons.left,this._userInputButtons.right=this.controls.mouseButtons.right,this._userInputButtons.middle=this.controls.mouseButtons.middle,this._userInputButtons.wheel=this.controls.mouseButtons.wheel,this.controls.mouseButtons.left=0,this.controls.mouseButtons.right=0,this.controls.mouseButtons.middle=0,this.controls.mouseButtons.wheel=0}enableUserInput(){Object.keys(this._userInputButtons).length!==0&&(this.controls.mouseButtons.left=this._userInputButtons.left,this.controls.mouseButtons.right=this._userInputButtons.right,this.controls.mouseButtons.middle=this._userInputButtons.middle,this.controls.mouseButtons.wheel=this._userInputButtons.wheel)}newOrthoCamera(){const t=window.innerWidth/window.innerHeight;return new cs(this._frustumSize*t/-2,this._frustumSize*t/2,this._frustumSize/2,this._frustumSize/-2,.1,1e3)}setOrthoPerspCameraAspect(){if(!this.currentWorld||!this.currentWorld.renderer||!this.previousSize)return;const t=this.currentWorld.renderer.getSize(),e=this.threeOrtho.top,i=this.threeOrtho.right,s=t.y/this.previousSize.y,n=t.x/this.previousSize.x,o=e*s,a=i*n;this.threeOrtho.left=-a,this.threeOrtho.right=a,this.threeOrtho.top=o,this.threeOrtho.bottom=-o,this.threeOrtho.updateProjectionMatrix(),this.previousSize.copy(t)}};const lT=new Map([[xr,{forRelated:"Decomposes",forRelating:"IsDecomposedBy"}],[bc,{forRelated:"HasAssociations",forRelating:"AssociatedTo"}],[Tc,{forRelated:"HasAssociations",forRelating:"ClassificationForObjects"}],[yc,{forRelated:"HasAssignments",forRelating:"IsGroupedBy"}],[on,{forRelated:"IsDefinedBy",forRelating:"DefinesOcurrence"}],[vc,{forRelated:"IsTypedBy",forRelating:"Types"}],[Rc,{forRelated:"IsDefinedBy",forRelating:"Defines"}],[Nr,{forRelated:"ContainedInStructure",forRelating:"ContainsElements"}],[Ac,{forRelated:"AssignedToFlowElement",forRelating:"HasControlElements"}],[Sc,{forRelated:"ConnectedFrom",forRelating:"ConnectedTo"}],[wc,{forRelated:"HasAssignments",forRelating:"ReferencedBy"}],[_c,{forRelated:"HasContext",forRelating:"Declares"}],[Fc,{forRelated:"HasAssignments",forRelating:"Controls"}],[Oc,{forRelated:"Nests",forRelating:"IsNestedBy"}],[xc,{forRelated:"HasAssociations",forRelating:"DocumentRefForObjects"}]]),_f={950732822:"IFCURIREFERENCE",4075327185:"IFCTIME",1209108979:"IFCTEMPERATURERATEOFCHANGEMEASURE",3457685358:"IFCSOUNDPRESSURELEVELMEASURE",4157543285:"IFCSOUNDPOWERLEVELMEASURE",2798247006:"IFCPROPERTYSETDEFINITIONSET",1790229001:"IFCPOSITIVEINTEGER",525895558:"IFCNONNEGATIVELENGTHMEASURE",1774176899:"IFCLINEINDEX",1275358634:"IFCLANGUAGEID",2541165894:"IFCDURATION",3701338814:"IFCDAYINWEEKNUMBER",2195413836:"IFCDATETIME",937566702:"IFCDATE",1683019596:"IFCCARDINALPOINTREFERENCE",2314439260:"IFCBINARY",1500781891:"IFCAREADENSITYMEASURE",3683503648:"IFCARCINDEX",4065007721:"IFCYEARNUMBER",1718600412:"IFCWARPINGMOMENTMEASURE",51269191:"IFCWARPINGCONSTANTMEASURE",2593997549:"IFCVOLUMETRICFLOWRATEMEASURE",3458127941:"IFCVOLUMEMEASURE",3345633955:"IFCVAPORPERMEABILITYMEASURE",1278329552:"IFCTORQUEMEASURE",2591213694:"IFCTIMESTAMP",2726807636:"IFCTIMEMEASURE",743184107:"IFCTHERMODYNAMICTEMPERATUREMEASURE",2016195849:"IFCTHERMALTRANSMITTANCEMEASURE",857959152:"IFCTHERMALRESISTANCEMEASURE",2281867870:"IFCTHERMALEXPANSIONCOEFFICIENTMEASURE",2645777649:"IFCTHERMALCONDUCTIVITYMEASURE",232962298:"IFCTHERMALADMITTANCEMEASURE",296282323:"IFCTEXTTRANSFORMATION",603696268:"IFCTEXTFONTNAME",3490877962:"IFCTEXTDECORATION",1460886941:"IFCTEXTALIGNMENT",2801250643:"IFCTEXT",58845555:"IFCTEMPERATUREGRADIENTMEASURE",361837227:"IFCSPECULARROUGHNESS",2757832317:"IFCSPECULAREXPONENT",3477203348:"IFCSPECIFICHEATCAPACITYMEASURE",993287707:"IFCSOUNDPRESSUREMEASURE",846465480:"IFCSOUNDPOWERMEASURE",3471399674:"IFCSOLIDANGLEMEASURE",408310005:"IFCSHEARMODULUSMEASURE",2190458107:"IFCSECTIONALAREAINTEGRALMEASURE",3467162246:"IFCSECTIONMODULUSMEASURE",2766185779:"IFCSECONDINMINUTE",3211557302:"IFCROTATIONALSTIFFNESSMEASURE",1755127002:"IFCROTATIONALMASSMEASURE",2133746277:"IFCROTATIONALFREQUENCYMEASURE",200335297:"IFCREAL",96294661:"IFCRATIOMEASURE",3972513137:"IFCRADIOACTIVITYMEASURE",3665567075:"IFCPRESSUREMEASURE",2169031380:"IFCPRESENTABLETEXT",1364037233:"IFCPOWERMEASURE",1245737093:"IFCPOSITIVERATIOMEASURE",3054510233:"IFCPOSITIVEPLANEANGLEMEASURE",2815919920:"IFCPOSITIVELENGTHMEASURE",4042175685:"IFCPLANEANGLEMEASURE",2642773653:"IFCPLANARFORCEMEASURE",2260317790:"IFCPARAMETERVALUE",929793134:"IFCPHMEASURE",2395907400:"IFCNUMERICMEASURE",2095195183:"IFCNORMALISEDRATIOMEASURE",765770214:"IFCMONTHINYEARNUMBER",2615040989:"IFCMONETARYMEASURE",3114022597:"IFCMOMENTOFINERTIAMEASURE",1648970520:"IFCMOLECULARWEIGHTMEASURE",3177669450:"IFCMOISTUREDIFFUSIVITYMEASURE",1753493141:"IFCMODULUSOFSUBGRADEREACTIONMEASURE",1052454078:"IFCMODULUSOFROTATIONALSUBGRADEREACTIONMEASURE",2173214787:"IFCMODULUSOFLINEARSUBGRADEREACTIONMEASURE",3341486342:"IFCMODULUSOFELASTICITYMEASURE",102610177:"IFCMINUTEINHOUR",3531705166:"IFCMASSPERLENGTHMEASURE",3124614049:"IFCMASSMEASURE",4017473158:"IFCMASSFLOWRATEMEASURE",1477762836:"IFCMASSDENSITYMEASURE",2486716878:"IFCMAGNETICFLUXMEASURE",286949696:"IFCMAGNETICFLUXDENSITYMEASURE",151039812:"IFCLUMINOUSINTENSITYMEASURE",2755797622:"IFCLUMINOUSINTENSITYDISTRIBUTIONMEASURE",2095003142:"IFCLUMINOUSFLUXMEASURE",503418787:"IFCLOGICAL",3086160713:"IFCLINEARVELOCITYMEASURE",1307019551:"IFCLINEARSTIFFNESSMEASURE",2128979029:"IFCLINEARMOMENTMEASURE",191860431:"IFCLINEARFORCEMEASURE",1243674935:"IFCLENGTHMEASURE",3258342251:"IFCLABEL",2054016361:"IFCKINEMATICVISCOSITYMEASURE",3192672207:"IFCISOTHERMALMOISTURECAPACITYMEASURE",3686016028:"IFCIONCONCENTRATIONMEASURE",3809634241:"IFCINTEGERCOUNTRATEMEASURE",1939436016:"IFCINTEGER",2679005408:"IFCINDUCTANCEMEASURE",3358199106:"IFCILLUMINANCEMEASURE",983778844:"IFCIDENTIFIER",2589826445:"IFCHOURINDAY",1158859006:"IFCHEATINGVALUEMEASURE",3113092358:"IFCHEATFLUXDENSITYMEASURE",3064340077:"IFCGLOBALLYUNIQUEID",3044325142:"IFCFREQUENCYMEASURE",1361398929:"IFCFORCEMEASURE",2590844177:"IFCFONTWEIGHT",2715512545:"IFCFONTVARIANT",1102727119:"IFCFONTSTYLE",2078135608:"IFCENERGYMEASURE",2506197118:"IFCELECTRICVOLTAGEMEASURE",2951915441:"IFCELECTRICRESISTANCEMEASURE",3790457270:"IFCELECTRICCURRENTMEASURE",2093906313:"IFCELECTRICCONDUCTANCEMEASURE",3818826038:"IFCELECTRICCHARGEMEASURE",1827137117:"IFCELECTRICCAPACITANCEMEASURE",69416015:"IFCDYNAMICVISCOSITYMEASURE",524656162:"IFCDOSEEQUIVALENTMEASURE",4134073009:"IFCDIMENSIONCOUNT",1514641115:"IFCDESCRIPTIVEMEASURE",300323983:"IFCDAYLIGHTSAVINGHOUR",86635668:"IFCDAYINMONTHNUMBER",94842927:"IFCCURVATUREMEASURE",1778710042:"IFCCOUNTMEASURE",3238673880:"IFCCONTEXTDEPENDENTMEASURE",3812528620:"IFCCOMPOUNDPLANEANGLEMEASURE",2991860651:"IFCCOMPLEXNUMBER",1867003952:"IFCBOXALIGNMENT",2735952531:"IFCBOOLEAN",2650437152:"IFCAREAMEASURE",632304761:"IFCANGULARVELOCITYMEASURE",360377573:"IFCAMOUNTOFSUBSTANCEMEASURE",4182062534:"IFCACCELERATIONMEASURE",3699917729:"IFCABSORBEDDOSEMEASURE",1971632696:"IFCGEOSLICE",2680139844:"IFCGEOMODEL",24726584:"IFCELECTRICFLOWTREATMENTDEVICE",3693000487:"IFCDISTRIBUTIONBOARD",3460952963:"IFCCONVEYORSEGMENT",3999819293:"IFCCAISSONFOUNDATION",3314249567:"IFCBOREHOLE",4196446775:"IFCBEARING",325726236:"IFCALIGNMENT",3425753595:"IFCTRACKELEMENT",991950508:"IFCSIGNAL",3798194928:"IFCREINFORCEDSOIL",3290496277:"IFCRAIL",1383356374:"IFCPAVEMENT",2182337498:"IFCNAVIGATIONELEMENT",234836483:"IFCMOORINGDEVICE",2078563270:"IFCMOBILETELECOMMUNICATIONSAPPLIANCE",1638804497:"IFCLIQUIDTERMINAL",1154579445:"IFCLINEARPOSITIONINGELEMENT",2696325953:"IFCKERB",2713699986:"IFCGEOTECHNICALASSEMBLY",2142170206:"IFCELECTRICFLOWTREATMENTDEVICETYPE",3376911765:"IFCEARTHWORKSFILL",1077100507:"IFCEARTHWORKSELEMENT",3071239417:"IFCEARTHWORKSCUT",479945903:"IFCDISTRIBUTIONBOARDTYPE",3426335179:"IFCDEEPFOUNDATION",1502416096:"IFCCOURSE",2940368186:"IFCCONVEYORSEGMENTTYPE",3203706013:"IFCCAISSONFOUNDATIONTYPE",3862327254:"IFCBUILTSYSTEM",1876633798:"IFCBUILTELEMENT",963979645:"IFCBRIDGEPART",644574406:"IFCBRIDGE",3649138523:"IFCBEARINGTYPE",1662888072:"IFCALIGNMENTVERTICAL",317615605:"IFCALIGNMENTSEGMENT",1545765605:"IFCALIGNMENTHORIZONTAL",4266260250:"IFCALIGNMENTCANT",3956297820:"IFCVIBRATIONDAMPERTYPE",1530820697:"IFCVIBRATIONDAMPER",840318589:"IFCVEHICLE",1953115116:"IFCTRANSPORTATIONDEVICE",618700268:"IFCTRACKELEMENTTYPE",2281632017:"IFCTENDONCONDUITTYPE",3663046924:"IFCTENDONCONDUIT",42703149:"IFCSINESPIRAL",1894708472:"IFCSIGNALTYPE",3599934289:"IFCSIGNTYPE",33720170:"IFCSIGN",1027922057:"IFCSEVENTHORDERPOLYNOMIALSPIRAL",544395925:"IFCSEGMENTEDREFERENCECURVE",3649235739:"IFCSECONDORDERPOLYNOMIALSPIRAL",550521510:"IFCROADPART",146592293:"IFCROAD",3818125796:"IFCRELADHERESTOELEMENT",4021432810:"IFCREFERENT",1891881377:"IFCRAILWAYPART",3992365140:"IFCRAILWAY",1763565496:"IFCRAILTYPE",1946335990:"IFCPOSITIONINGELEMENT",514975943:"IFCPAVEMENTTYPE",506776471:"IFCNAVIGATIONELEMENTTYPE",710110818:"IFCMOORINGDEVICETYPE",1950438474:"IFCMOBILETELECOMMUNICATIONSAPPLIANCETYPE",976884017:"IFCMARINEPART",525669439:"IFCMARINEFACILITY",1770583370:"IFCLIQUIDTERMINALTYPE",2176059722:"IFCLINEARELEMENT",679976338:"IFCKERBTYPE",3948183225:"IFCIMPACTPROTECTIONDEVICETYPE",2568555532:"IFCIMPACTPROTECTIONDEVICE",2898700619:"IFCGRADIENTCURVE",1594536857:"IFCGEOTECHNICALSTRATUM",4230923436:"IFCGEOTECHNICALELEMENT",4228831410:"IFCFACILITYPARTCOMMON",1310830890:"IFCFACILITYPART",24185140:"IFCFACILITY",4234616927:"IFCDIRECTRIXDERIVEDREFERENCESWEPTAREASOLID",1306400036:"IFCDEEPFOUNDATIONTYPE",4189326743:"IFCCOURSETYPE",2000195564:"IFCCOSINESPIRAL",3497074424:"IFCCLOTHOID",1626504194:"IFCBUILTELEMENTTYPE",3651464721:"IFCVEHICLETYPE",1229763772:"IFCTRIANGULATEDIRREGULARNETWORK",3665877780:"IFCTRANSPORTATIONDEVICETYPE",782932809:"IFCTHIRDORDERPOLYNOMIALSPIRAL",2735484536:"IFCSPIRAL",1356537516:"IFCSECTIONEDSURFACE",1290935644:"IFCSECTIONEDSOLIDHORIZONTAL",1862484736:"IFCSECTIONEDSOLID",1441486842:"IFCRELPOSITIONS",1033248425:"IFCRELASSOCIATESPROFILEDEF",3381221214:"IFCPOLYNOMIALCURVE",2485787929:"IFCOFFSETCURVEBYDISTANCES",590820931:"IFCOFFSETCURVE",3465909080:"IFCINDEXEDPOLYGONALTEXTUREMAP",593015953:"IFCDIRECTRIXCURVESWEPTAREASOLID",4212018352:"IFCCURVESEGMENT",3425423356:"IFCAXIS2PLACEMENTLINEAR",823603102:"IFCSEGMENT",2165702409:"IFCPOINTBYDISTANCEEXPRESSION",182550632:"IFCOPENCROSSPROFILEDEF",388784114:"IFCLINEARPLACEMENT",536804194:"IFCALIGNMENTHORIZONTALSEGMENT",3752311538:"IFCALIGNMENTCANTSEGMENT",1010789467:"IFCTEXTURECOORDINATEINDICESWITHVOIDS",222769930:"IFCTEXTURECOORDINATEINDICES",2691318326:"IFCQUANTITYNUMBER",3633395639:"IFCALIGNMENTVERTICALSEGMENT",2879124712:"IFCALIGNMENTPARAMETERSEGMENT",25142252:"IFCCONTROLLER",3087945054:"IFCALARM",4288193352:"IFCACTUATOR",630975310:"IFCUNITARYCONTROLELEMENT",4086658281:"IFCSENSOR",2295281155:"IFCPROTECTIVEDEVICETRIPPINGUNIT",182646315:"IFCFLOWINSTRUMENT",1426591983:"IFCFIRESUPPRESSIONTERMINAL",819412036:"IFCFILTER",3415622556:"IFCFAN",1003880860:"IFCELECTRICTIMECONTROL",402227799:"IFCELECTRICMOTOR",264262732:"IFCELECTRICGENERATOR",3310460725:"IFCELECTRICFLOWSTORAGEDEVICE",862014818:"IFCELECTRICDISTRIBUTIONBOARD",1904799276:"IFCELECTRICAPPLIANCE",1360408905:"IFCDUCTSILENCER",3518393246:"IFCDUCTSEGMENT",342316401:"IFCDUCTFITTING",562808652:"IFCDISTRIBUTIONCIRCUIT",4074379575:"IFCDAMPER",3640358203:"IFCCOOLINGTOWER",4136498852:"IFCCOOLEDBEAM",2272882330:"IFCCONDENSER",3571504051:"IFCCOMPRESSOR",3221913625:"IFCCOMMUNICATIONSAPPLIANCE",639361253:"IFCCOIL",3902619387:"IFCCHILLER",4217484030:"IFCCABLESEGMENT",1051757585:"IFCCABLEFITTING",3758799889:"IFCCABLECARRIERSEGMENT",635142910:"IFCCABLECARRIERFITTING",2938176219:"IFCBURNER",32344328:"IFCBOILER",2906023776:"IFCBEAMSTANDARDCASE",277319702:"IFCAUDIOVISUALAPPLIANCE",2056796094:"IFCAIRTOAIRHEATRECOVERY",177149247:"IFCAIRTERMINALBOX",1634111441:"IFCAIRTERMINAL",486154966:"IFCWINDOWSTANDARDCASE",4237592921:"IFCWASTETERMINAL",4156078855:"IFCWALLELEMENTEDCASE",4207607924:"IFCVALVE",4292641817:"IFCUNITARYEQUIPMENT",3179687236:"IFCUNITARYCONTROLELEMENTTYPE",3026737570:"IFCTUBEBUNDLE",3825984169:"IFCTRANSFORMER",812556717:"IFCTANK",1162798199:"IFCSWITCHINGDEVICE",385403989:"IFCSTRUCTURALLOADCASE",1404847402:"IFCSTACKTERMINAL",1999602285:"IFCSPACEHEATER",3420628829:"IFCSOLARDEVICE",3027962421:"IFCSLABSTANDARDCASE",3127900445:"IFCSLABELEMENTEDCASE",1329646415:"IFCSHADINGDEVICE",3053780830:"IFCSANITARYTERMINAL",2572171363:"IFCREINFORCINGBARTYPE",1232101972:"IFCRATIONALBSPLINECURVEWITHKNOTS",90941305:"IFCPUMP",655969474:"IFCPROTECTIVEDEVICETRIPPINGUNITTYPE",738039164:"IFCPROTECTIVEDEVICE",1156407060:"IFCPLATESTANDARDCASE",3612865200:"IFCPIPESEGMENT",310824031:"IFCPIPEFITTING",3694346114:"IFCOUTLET",144952367:"IFCOUTERBOUNDARYCURVE",2474470126:"IFCMOTORCONNECTION",1911478936:"IFCMEMBERSTANDARDCASE",1437502449:"IFCMEDICALDEVICE",629592764:"IFCLIGHTFIXTURE",76236018:"IFCLAMP",2176052936:"IFCJUNCTIONBOX",4175244083:"IFCINTERCEPTOR",2068733104:"IFCHUMIDIFIER",3319311131:"IFCHEATEXCHANGER",2188021234:"IFCFLOWMETER",1209101575:"IFCEXTERNALSPATIALELEMENT",484807127:"IFCEVAPORATOR",3747195512:"IFCEVAPORATIVECOOLER",2814081492:"IFCENGINE",2417008758:"IFCELECTRICDISTRIBUTIONBOARDTYPE",3242481149:"IFCDOORSTANDARDCASE",3205830791:"IFCDISTRIBUTIONSYSTEM",400855858:"IFCCOMMUNICATIONSAPPLIANCETYPE",905975707:"IFCCOLUMNSTANDARDCASE",1677625105:"IFCCIVILELEMENT",3296154744:"IFCCHIMNEY",2674252688:"IFCCABLEFITTINGTYPE",2188180465:"IFCBURNERTYPE",1177604601:"IFCBUILDINGSYSTEM",39481116:"IFCBUILDINGELEMENTPARTTYPE",1136057603:"IFCBOUNDARYCURVE",2461110595:"IFCBSPLINECURVEWITHKNOTS",1532957894:"IFCAUDIOVISUALAPPLIANCETYPE",4088093105:"IFCWORKCALENDAR",4009809668:"IFCWINDOWTYPE",926996030:"IFCVOIDINGFEATURE",2391383451:"IFCVIBRATIONISOLATOR",2415094496:"IFCTENDONTYPE",3081323446:"IFCTENDONANCHORTYPE",413509423:"IFCSYSTEMFURNITUREELEMENT",3101698114:"IFCSURFACEFEATURE",3657597509:"IFCSTRUCTURALSURFACEACTION",2757150158:"IFCSTRUCTURALCURVEREACTION",1004757350:"IFCSTRUCTURALCURVEACTION",338393293:"IFCSTAIRTYPE",1072016465:"IFCSOLARDEVICETYPE",4074543187:"IFCSHADINGDEVICETYPE",2157484638:"IFCSEAMCURVE",2781568857:"IFCROOFTYPE",2310774935:"IFCREINFORCINGMESHTYPE",964333572:"IFCREINFORCINGELEMENTTYPE",683857671:"IFCRATIONALBSPLINESURFACEWITHKNOTS",1469900589:"IFCRAMPTYPE",2839578677:"IFCPOLYGONALFACESET",1158309216:"IFCPILETYPE",3079942009:"IFCOPENINGSTANDARDCASE",1114901282:"IFCMEDICALDEVICETYPE",3113134337:"IFCINTERSECTIONCURVE",3946677679:"IFCINTERCEPTORTYPE",2571569899:"IFCINDEXEDPOLYCURVE",3493046030:"IFCGEOGRAPHICELEMENT",1509553395:"IFCFURNITURE",1893162501:"IFCFOOTINGTYPE",2853485674:"IFCEXTERNALSPATIALSTRUCTUREELEMENT",4148101412:"IFCEVENT",132023988:"IFCENGINETYPE",2397081782:"IFCELEMENTASSEMBLYTYPE",2323601079:"IFCDOORTYPE",1213902940:"IFCCYLINDRICALSURFACE",1525564444:"IFCCONSTRUCTIONPRODUCTRESOURCETYPE",4105962743:"IFCCONSTRUCTIONMATERIALRESOURCETYPE",2185764099:"IFCCONSTRUCTIONEQUIPMENTRESOURCETYPE",15328376:"IFCCOMPOSITECURVEONSURFACE",3875453745:"IFCCOMPLEXPROPERTYTEMPLATE",3893394355:"IFCCIVILELEMENTTYPE",2197970202:"IFCCHIMNEYTYPE",167062518:"IFCBSPLINESURFACEWITHKNOTS",2887950389:"IFCBSPLINESURFACE",2603310189:"IFCADVANCEDBREPWITHVOIDS",1635779807:"IFCADVANCEDBREP",2916149573:"IFCTRIANGULATEDFACESET",1935646853:"IFCTOROIDALSURFACE",2387106220:"IFCTESSELLATEDFACESET",3206491090:"IFCTASKTYPE",699246055:"IFCSURFACECURVE",4095615324:"IFCSUBCONTRACTRESOURCETYPE",603775116:"IFCSTRUCTURALSURFACEREACTION",4015995234:"IFCSPHERICALSURFACE",2481509218:"IFCSPATIALZONETYPE",463610769:"IFCSPATIALZONE",710998568:"IFCSPATIALELEMENTTYPE",1412071761:"IFCSPATIALELEMENT",3663146110:"IFCSIMPLEPROPERTYTEMPLATE",3243963512:"IFCREVOLVEDAREASOLIDTAPERED",816062949:"IFCREPARAMETRISEDCOMPOSITECURVESEGMENT",1521410863:"IFCRELSPACEBOUNDARY2NDLEVEL",3523091289:"IFCRELSPACEBOUNDARY1STLEVEL",427948657:"IFCRELINTERFERESELEMENTS",307848117:"IFCRELDEFINESBYTEMPLATE",1462361463:"IFCRELDEFINESBYOBJECT",2565941209:"IFCRELDECLARES",1027710054:"IFCRELASSIGNSTOGROUPBYFACTOR",3521284610:"IFCPROPERTYTEMPLATE",492091185:"IFCPROPERTYSETTEMPLATE",653396225:"IFCPROJECTLIBRARY",569719735:"IFCPROCEDURETYPE",3967405729:"IFCPREDEFINEDPROPERTYSET",1682466193:"IFCPCURVE",428585644:"IFCLABORRESOURCETYPE",2294589976:"IFCINDEXEDPOLYGONALFACEWITHVOIDS",178912537:"IFCINDEXEDPOLYGONALFACE",4095422895:"IFCGEOGRAPHICELEMENTTYPE",2652556860:"IFCFIXEDREFERENCESWEPTAREASOLID",2804161546:"IFCEXTRUDEDAREASOLIDTAPERED",4024345920:"IFCEVENTTYPE",2629017746:"IFCCURVEBOUNDEDSURFACE",1815067380:"IFCCREWRESOURCETYPE",3419103109:"IFCCONTEXT",2574617495:"IFCCONSTRUCTIONRESOURCETYPE",2059837836:"IFCCARTESIANPOINTLIST3D",1675464909:"IFCCARTESIANPOINTLIST2D",574549367:"IFCCARTESIANPOINTLIST",3406155212:"IFCADVANCEDFACE",3698973494:"IFCTYPERESOURCE",3736923433:"IFCTYPEPROCESS",901063453:"IFCTESSELLATEDITEM",1096409881:"IFCSWEPTDISKSOLIDPOLYGONAL",1042787934:"IFCRESOURCETIME",1608871552:"IFCRESOURCECONSTRAINTRELATIONSHIP",2943643501:"IFCRESOURCEAPPROVALRELATIONSHIP",2090586900:"IFCQUANTITYSET",1482703590:"IFCPROPERTYTEMPLATEDEFINITION",3778827333:"IFCPREDEFINEDPROPERTIES",2998442950:"IFCMIRROREDPROFILEDEF",853536259:"IFCMATERIALRELATIONSHIP",3404854881:"IFCMATERIALPROFILESETUSAGETAPERING",3079605661:"IFCMATERIALPROFILESETUSAGE",2852063980:"IFCMATERIALCONSTITUENTSET",3708119e3:"IFCMATERIALCONSTITUENT",1585845231:"IFCLAGTIME",2133299955:"IFCINDEXEDTRIANGLETEXTUREMAP",1437953363:"IFCINDEXEDTEXTUREMAP",3570813810:"IFCINDEXEDCOLOURMAP",1437805879:"IFCEXTERNALREFERENCERELATIONSHIP",297599258:"IFCEXTENDEDPROPERTIES",211053100:"IFCEVENTTIME",2713554722:"IFCCONVERSIONBASEDUNITWITHOFFSET",3285139300:"IFCCOLOURRGBLIST",1236880293:"IFCWORKTIME",1199560280:"IFCTIMEPERIOD",3611470254:"IFCTEXTUREVERTEXLIST",2771591690:"IFCTASKTIMERECURRING",1549132990:"IFCTASKTIME",2043862942:"IFCTABLECOLUMN",2934153892:"IFCSURFACEREINFORCEMENTAREA",609421318:"IFCSTRUCTURALLOADORRESULT",3478079324:"IFCSTRUCTURALLOADCONFIGURATION",1054537805:"IFCSCHEDULINGTIME",2439245199:"IFCRESOURCELEVELRELATIONSHIP",2433181523:"IFCREFERENCE",3915482550:"IFCRECURRENCEPATTERN",986844984:"IFCPROPERTYABSTRACTION",3843373140:"IFCPROJECTEDCRS",677532197:"IFCPRESENTATIONITEM",1507914824:"IFCMATERIALUSAGEDEFINITION",552965576:"IFCMATERIALPROFILEWITHOFFSETS",164193824:"IFCMATERIALPROFILESET",2235152071:"IFCMATERIALPROFILE",1847252529:"IFCMATERIALLAYERWITHOFFSETS",760658860:"IFCMATERIALDEFINITION",3057273783:"IFCMAPCONVERSION",4294318154:"IFCEXTERNALINFORMATION",1466758467:"IFCCOORDINATEREFERENCESYSTEM",1785450214:"IFCCOORDINATEOPERATION",775493141:"IFCCONNECTIONVOLUMEGEOMETRY",979691226:"IFCREINFORCINGBAR",3700593921:"IFCELECTRICDISTRIBUTIONPOINT",1062813311:"IFCDISTRIBUTIONCONTROLELEMENT",1052013943:"IFCDISTRIBUTIONCHAMBERELEMENT",578613899:"IFCCONTROLLERTYPE",2454782716:"IFCCHAMFEREDGEFEATURE",753842376:"IFCBEAM",3001207471:"IFCALARMTYPE",2874132201:"IFCACTUATORTYPE",3304561284:"IFCWINDOW",3512223829:"IFCWALLSTANDARDCASE",2391406946:"IFCWALL",3313531582:"IFCVIBRATIONISOLATORTYPE",2347447852:"IFCTENDONANCHOR",3824725483:"IFCTENDON",2515109513:"IFCSTRUCTURALANALYSISMODEL",4252922144:"IFCSTAIRFLIGHT",331165859:"IFCSTAIR",1529196076:"IFCSLAB",1783015770:"IFCSENSORTYPE",1376911519:"IFCROUNDEDEDGEFEATURE",2016517767:"IFCROOF",2320036040:"IFCREINFORCINGMESH",3027567501:"IFCREINFORCINGELEMENT",3055160366:"IFCRATIONALBEZIERCURVE",3283111854:"IFCRAMPFLIGHT",3024970846:"IFCRAMP",2262370178:"IFCRAILING",3171933400:"IFCPLATE",1687234759:"IFCPILE",1073191201:"IFCMEMBER",900683007:"IFCFOOTING",3508470533:"IFCFLOWTREATMENTDEVICE",2223149337:"IFCFLOWTERMINAL",707683696:"IFCFLOWSTORAGEDEVICE",987401354:"IFCFLOWSEGMENT",3132237377:"IFCFLOWMOVINGDEVICE",4037862832:"IFCFLOWINSTRUMENTTYPE",4278956645:"IFCFLOWFITTING",2058353004:"IFCFLOWCONTROLLER",4222183408:"IFCFIRESUPPRESSIONTERMINALTYPE",1810631287:"IFCFILTERTYPE",346874300:"IFCFANTYPE",1658829314:"IFCENERGYCONVERSIONDEVICE",857184966:"IFCELECTRICALELEMENT",1634875225:"IFCELECTRICALCIRCUIT",712377611:"IFCELECTRICTIMECONTROLTYPE",1217240411:"IFCELECTRICMOTORTYPE",1365060375:"IFCELECTRICHEATERTYPE",1534661035:"IFCELECTRICGENERATORTYPE",3277789161:"IFCELECTRICFLOWSTORAGEDEVICETYPE",663422040:"IFCELECTRICAPPLIANCETYPE",855621170:"IFCEDGEFEATURE",2030761528:"IFCDUCTSILENCERTYPE",3760055223:"IFCDUCTSEGMENTTYPE",869906466:"IFCDUCTFITTINGTYPE",395920057:"IFCDOOR",3041715199:"IFCDISTRIBUTIONPORT",3040386961:"IFCDISTRIBUTIONFLOWELEMENT",1945004755:"IFCDISTRIBUTIONELEMENT",2063403501:"IFCDISTRIBUTIONCONTROLELEMENTTYPE",1599208980:"IFCDISTRIBUTIONCHAMBERELEMENTTYPE",2635815018:"IFCDISCRETEACCESSORYTYPE",1335981549:"IFCDISCRETEACCESSORY",4147604152:"IFCDIAMETERDIMENSION",3961806047:"IFCDAMPERTYPE",3495092785:"IFCCURTAINWALL",1973544240:"IFCCOVERING",2954562838:"IFCCOOLINGTOWERTYPE",335055490:"IFCCOOLEDBEAMTYPE",488727124:"IFCCONSTRUCTIONPRODUCTRESOURCE",1060000209:"IFCCONSTRUCTIONMATERIALRESOURCE",3898045240:"IFCCONSTRUCTIONEQUIPMENTRESOURCE",1163958913:"IFCCONDITIONCRITERION",2188551683:"IFCCONDITION",2816379211:"IFCCONDENSERTYPE",3850581409:"IFCCOMPRESSORTYPE",843113511:"IFCCOLUMN",2301859152:"IFCCOILTYPE",2611217952:"IFCCIRCLE",2951183804:"IFCCHILLERTYPE",1285652485:"IFCCABLESEGMENTTYPE",3293546465:"IFCCABLECARRIERSEGMENTTYPE",395041908:"IFCCABLECARRIERFITTINGTYPE",1909888760:"IFCBUILDINGELEMENTPROXYTYPE",1095909175:"IFCBUILDINGELEMENTPROXY",2979338954:"IFCBUILDINGELEMENTPART",52481810:"IFCBUILDINGELEMENTCOMPONENT",3299480353:"IFCBUILDINGELEMENT",231477066:"IFCBOILERTYPE",1916977116:"IFCBEZIERCURVE",819618141:"IFCBEAMTYPE",1967976161:"IFCBSPLINECURVE",3460190687:"IFCASSET",2470393545:"IFCANGULARDIMENSION",1871374353:"IFCAIRTOAIRHEATRECOVERYTYPE",3352864051:"IFCAIRTERMINALTYPE",1411407467:"IFCAIRTERMINALBOXTYPE",3821786052:"IFCACTIONREQUEST",1213861670:"IFC2DCOMPOSITECURVE",1033361043:"IFCZONE",3342526732:"IFCWORKSCHEDULE",4218914973:"IFCWORKPLAN",1028945134:"IFCWORKCONTROL",1133259667:"IFCWASTETERMINALTYPE",1898987631:"IFCWALLTYPE",2769231204:"IFCVIRTUALELEMENT",728799441:"IFCVALVETYPE",1911125066:"IFCUNITARYEQUIPMENTTYPE",1600972822:"IFCTUBEBUNDLETYPE",3593883385:"IFCTRIMMEDCURVE",1620046519:"IFCTRANSPORTELEMENT",1692211062:"IFCTRANSFORMERTYPE",1637806684:"IFCTIMESERIESSCHEDULE",5716631:"IFCTANKTYPE",2254336722:"IFCSYSTEM",2315554128:"IFCSWITCHINGDEVICETYPE",148013059:"IFCSUBCONTRACTRESOURCE",1975003073:"IFCSTRUCTURALSURFACECONNECTION",2986769608:"IFCSTRUCTURALRESULTGROUP",1235345126:"IFCSTRUCTURALPOINTREACTION",734778138:"IFCSTRUCTURALPOINTCONNECTION",2082059205:"IFCSTRUCTURALPOINTACTION",3987759626:"IFCSTRUCTURALPLANARACTIONVARYING",1621171031:"IFCSTRUCTURALPLANARACTION",1252848954:"IFCSTRUCTURALLOADGROUP",1721250024:"IFCSTRUCTURALLINEARACTIONVARYING",1807405624:"IFCSTRUCTURALLINEARACTION",2445595289:"IFCSTRUCTURALCURVEMEMBERVARYING",214636428:"IFCSTRUCTURALCURVEMEMBER",4243806635:"IFCSTRUCTURALCURVECONNECTION",1179482911:"IFCSTRUCTURALCONNECTION",682877961:"IFCSTRUCTURALACTION",1039846685:"IFCSTAIRFLIGHTTYPE",3112655638:"IFCSTACKTERMINALTYPE",3812236995:"IFCSPACETYPE",652456506:"IFCSPACEPROGRAM",1305183839:"IFCSPACEHEATERTYPE",3856911033:"IFCSPACE",2533589738:"IFCSLABTYPE",4097777520:"IFCSITE",4105383287:"IFCSERVICELIFE",3517283431:"IFCSCHEDULETIMECONTROL",1768891740:"IFCSANITARYTERMINALTYPE",2863920197:"IFCRELASSIGNSTASKS",160246688:"IFCRELAGGREGATES",2324767716:"IFCRAMPFLIGHTTYPE",2893384427:"IFCRAILINGTYPE",3248260540:"IFCRADIUSDIMENSION",2250791053:"IFCPUMPTYPE",1842657554:"IFCPROTECTIVEDEVICETYPE",3651124850:"IFCPROJECTIONELEMENT",3642467123:"IFCPROJECTORDERRECORD",2904328755:"IFCPROJECTORDER",2744685151:"IFCPROCEDURE",3740093272:"IFCPORT",3724593414:"IFCPOLYLINE",4017108033:"IFCPLATETYPE",4231323485:"IFCPIPESEGMENTTYPE",804291784:"IFCPIPEFITTINGTYPE",3327091369:"IFCPERMIT",2382730787:"IFCPERFORMANCEHISTORY",2837617999:"IFCOUTLETTYPE",3425660407:"IFCORDERACTION",3588315303:"IFCOPENINGELEMENT",4143007308:"IFCOCCUPANT",1916936684:"IFCMOVE",977012517:"IFCMOTORCONNECTIONTYPE",3181161470:"IFCMEMBERTYPE",2108223431:"IFCMECHANICALFASTENERTYPE",377706215:"IFCMECHANICALFASTENER",2506943328:"IFCLINEARDIMENSION",1161773419:"IFCLIGHTFIXTURETYPE",1051575348:"IFCLAMPTYPE",3827777499:"IFCLABORRESOURCE",4288270099:"IFCJUNCTIONBOXTYPE",2391368822:"IFCINVENTORY",1806887404:"IFCHUMIDIFIERTYPE",1251058090:"IFCHEATEXCHANGERTYPE",2706460486:"IFCGROUP",3009204131:"IFCGRID",200128114:"IFCGASTERMINALTYPE",814719939:"IFCFURNITURESTANDARD",263784265:"IFCFURNISHINGELEMENT",3009222698:"IFCFLOWTREATMENTDEVICETYPE",2297155007:"IFCFLOWTERMINALTYPE",1339347760:"IFCFLOWSTORAGEDEVICETYPE",1834744321:"IFCFLOWSEGMENTTYPE",1482959167:"IFCFLOWMOVINGDEVICETYPE",3815607619:"IFCFLOWMETERTYPE",3198132628:"IFCFLOWFITTINGTYPE",3907093117:"IFCFLOWCONTROLLERTYPE",1287392070:"IFCFEATUREELEMENTSUBTRACTION",2143335405:"IFCFEATUREELEMENTADDITION",2827207264:"IFCFEATUREELEMENT",2489546625:"IFCFASTENERTYPE",647756555:"IFCFASTENER",3737207727:"IFCFACETEDBREPWITHVOIDS",807026263:"IFCFACETEDBREP",3390157468:"IFCEVAPORATORTYPE",3174744832:"IFCEVAPORATIVECOOLERTYPE",3272907226:"IFCEQUIPMENTSTANDARD",1962604670:"IFCEQUIPMENTELEMENT",2107101300:"IFCENERGYCONVERSIONDEVICETYPE",1704287377:"IFCELLIPSE",2590856083:"IFCELEMENTCOMPONENTTYPE",1623761950:"IFCELEMENTCOMPONENT",4123344466:"IFCELEMENTASSEMBLY",1758889154:"IFCELEMENT",360485395:"IFCELECTRICALBASEPROPERTIES",3849074793:"IFCDISTRIBUTIONFLOWELEMENTTYPE",3256556792:"IFCDISTRIBUTIONELEMENTTYPE",681481545:"IFCDIMENSIONCURVEDIRECTEDCALLOUT",1457835157:"IFCCURTAINWALLTYPE",3295246426:"IFCCREWRESOURCE",1916426348:"IFCCOVERINGTYPE",1419761937:"IFCCOSTSCHEDULE",3895139033:"IFCCOSTITEM",3293443760:"IFCCONTROL",2559216714:"IFCCONSTRUCTIONRESOURCE",2510884976:"IFCCONIC",3732776249:"IFCCOMPOSITECURVE",300633059:"IFCCOLUMNTYPE",2937912522:"IFCCIRCLEHOLLOWPROFILEDEF",3124254112:"IFCBUILDINGSTOREY",1950629157:"IFCBUILDINGELEMENTTYPE",4031249490:"IFCBUILDING",1260505505:"IFCBOUNDEDCURVE",3649129432:"IFCBOOLEANCLIPPINGRESULT",1334484129:"IFCBLOCK",3207858831:"IFCASYMMETRICISHAPEPROFILEDEF",1674181508:"IFCANNOTATION",2296667514:"IFCACTOR",2097647324:"IFCTRANSPORTELEMENTTYPE",3473067441:"IFCTASK",1580310250:"IFCSYSTEMFURNITUREELEMENTTYPE",4124788165:"IFCSURFACEOFREVOLUTION",2809605785:"IFCSURFACEOFLINEAREXTRUSION",2028607225:"IFCSURFACECURVESWEPTAREASOLID",4070609034:"IFCSTRUCTUREDDIMENSIONCALLOUT",2218152070:"IFCSTRUCTURALSURFACEMEMBERVARYING",3979015343:"IFCSTRUCTURALSURFACEMEMBER",3689010777:"IFCSTRUCTURALREACTION",530289379:"IFCSTRUCTURALMEMBER",3136571912:"IFCSTRUCTURALITEM",3544373492:"IFCSTRUCTURALACTIVITY",451544542:"IFCSPHERE",3893378262:"IFCSPATIALSTRUCTUREELEMENTTYPE",2706606064:"IFCSPATIALSTRUCTUREELEMENT",3626867408:"IFCRIGHTCIRCULARCYLINDER",4158566097:"IFCRIGHTCIRCULARCONE",1856042241:"IFCREVOLVEDAREASOLID",2914609552:"IFCRESOURCE",1401173127:"IFCRELVOIDSELEMENT",3451746338:"IFCRELSPACEBOUNDARY",366585022:"IFCRELSERVICESBUILDINGS",4122056220:"IFCRELSEQUENCE",1058617721:"IFCRELSCHEDULESCOSTITEMS",1245217292:"IFCRELREFERENCEDINSPATIALSTRUCTURE",750771296:"IFCRELPROJECTSELEMENT",202636808:"IFCRELOVERRIDESPROPERTIES",2051452291:"IFCRELOCCUPIESSPACES",3268803585:"IFCRELNESTS",4189434867:"IFCRELINTERACTIONREQUIREMENTS",279856033:"IFCRELFLOWCONTROLELEMENTS",3940055652:"IFCRELFILLSELEMENT",781010003:"IFCRELDEFINESBYTYPE",4186316022:"IFCRELDEFINESBYPROPERTIES",693640335:"IFCRELDEFINES",2551354335:"IFCRELDECOMPOSES",2802773753:"IFCRELCOVERSSPACES",886880790:"IFCRELCOVERSBLDGELEMENTS",3242617779:"IFCRELCONTAINEDINSPATIALSTRUCTURE",3678494232:"IFCRELCONNECTSWITHREALIZINGELEMENTS",504942748:"IFCRELCONNECTSWITHECCENTRICITY",1638771189:"IFCRELCONNECTSSTRUCTURALMEMBER",3912681535:"IFCRELCONNECTSSTRUCTURALELEMENT",2127690289:"IFCRELCONNECTSSTRUCTURALACTIVITY",3190031847:"IFCRELCONNECTSPORTS",4201705270:"IFCRELCONNECTSPORTTOELEMENT",3945020480:"IFCRELCONNECTSPATHELEMENTS",1204542856:"IFCRELCONNECTSELEMENTS",826625072:"IFCRELCONNECTS",2851387026:"IFCRELASSOCIATESPROFILEPROPERTIES",2655215786:"IFCRELASSOCIATESMATERIAL",3840914261:"IFCRELASSOCIATESLIBRARY",982818633:"IFCRELASSOCIATESDOCUMENT",2728634034:"IFCRELASSOCIATESCONSTRAINT",919958153:"IFCRELASSOCIATESCLASSIFICATION",4095574036:"IFCRELASSOCIATESAPPROVAL",1327628568:"IFCRELASSOCIATESAPPLIEDVALUE",1865459582:"IFCRELASSOCIATES",205026976:"IFCRELASSIGNSTORESOURCE",3372526763:"IFCRELASSIGNSTOPROJECTORDER",2857406711:"IFCRELASSIGNSTOPRODUCT",4278684876:"IFCRELASSIGNSTOPROCESS",1307041759:"IFCRELASSIGNSTOGROUP",2495723537:"IFCRELASSIGNSTOCONTROL",1683148259:"IFCRELASSIGNSTOACTOR",3939117080:"IFCRELASSIGNS",3454111270:"IFCRECTANGULARTRIMMEDSURFACE",2798486643:"IFCRECTANGULARPYRAMID",2770003689:"IFCRECTANGLEHOLLOWPROFILEDEF",3219374653:"IFCPROXY",1451395588:"IFCPROPERTYSET",4194566429:"IFCPROJECTIONCURVE",103090709:"IFCPROJECT",4208778838:"IFCPRODUCT",2945172077:"IFCPROCESS",220341763:"IFCPLANE",603570806:"IFCPLANARBOX",3566463478:"IFCPERMEABLECOVERINGPROPERTIES",3505215534:"IFCOFFSETCURVE3D",3388369263:"IFCOFFSETCURVE2D",3888040117:"IFCOBJECT",1425443689:"IFCMANIFOLDSOLIDBREP",1281925730:"IFCLINE",572779678:"IFCLSHAPEPROFILEDEF",1484403080:"IFCISHAPEPROFILEDEF",987898635:"IFCGEOMETRICCURVESET",1268542332:"IFCFURNITURETYPE",4238390223:"IFCFURNISHINGELEMENTTYPE",3455213021:"IFCFLUIDFLOWPROPERTIES",315944413:"IFCFILLAREASTYLETILES",4203026998:"IFCFILLAREASTYLETILESYMBOLWITHSTYLE",374418227:"IFCFILLAREASTYLEHATCHING",2047409740:"IFCFACEBASEDSURFACEMODEL",477187591:"IFCEXTRUDEDAREASOLID",80994333:"IFCENERGYPROPERTIES",2835456948:"IFCELLIPSEPROFILEDEF",2777663545:"IFCELEMENTARYSURFACE",339256511:"IFCELEMENTTYPE",1883228015:"IFCELEMENTQUANTITY",1472233963:"IFCEDGELOOP",4006246654:"IFCDRAUGHTINGPREDEFINEDCURVEFONT",445594917:"IFCDRAUGHTINGPREDEFINEDCOLOUR",3073041342:"IFCDRAUGHTINGCALLOUT",526551008:"IFCDOORSTYLE",1714330368:"IFCDOORPANELPROPERTIES",2963535650:"IFCDOORLININGPROPERTIES",32440307:"IFCDIRECTION",4054601972:"IFCDIMENSIONCURVETERMINATOR",606661476:"IFCDIMENSIONCURVE",693772133:"IFCDEFINEDSYMBOL",2827736869:"IFCCURVEBOUNDEDPLANE",2601014836:"IFCCURVE",2147822146:"IFCCSGSOLID",2506170314:"IFCCSGPRIMITIVE3D",194851669:"IFCCRANERAILFSHAPEPROFILEDEF",4133800736:"IFCCRANERAILASHAPEPROFILEDEF",2485617015:"IFCCOMPOSITECURVESEGMENT",2205249479:"IFCCLOSEDSHELL",1383045692:"IFCCIRCLEPROFILEDEF",1416205885:"IFCCARTESIANTRANSFORMATIONOPERATOR3DNONUNIFORM",3331915920:"IFCCARTESIANTRANSFORMATIONOPERATOR3D",3486308946:"IFCCARTESIANTRANSFORMATIONOPERATOR2DNONUNIFORM",3749851601:"IFCCARTESIANTRANSFORMATIONOPERATOR2D",59481748:"IFCCARTESIANTRANSFORMATIONOPERATOR",1123145078:"IFCCARTESIANPOINT",2898889636:"IFCCSHAPEPROFILEDEF",2713105998:"IFCBOXEDHALFSPACE",2581212453:"IFCBOUNDINGBOX",4182860854:"IFCBOUNDEDSURFACE",2736907675:"IFCBOOLEANRESULT",2740243338:"IFCAXIS2PLACEMENT3D",3125803723:"IFCAXIS2PLACEMENT2D",4261334040:"IFCAXIS1PLACEMENT",1302238472:"IFCANNOTATIONSURFACE",2265737646:"IFCANNOTATIONFILLAREAOCCURRENCE",669184980:"IFCANNOTATIONFILLAREA",3288037868:"IFCANNOTATIONCURVEOCCURRENCE",2543172580:"IFCZSHAPEPROFILEDEF",1299126871:"IFCWINDOWSTYLE",512836454:"IFCWINDOWPANELPROPERTIES",336235671:"IFCWINDOWLININGPROPERTIES",2759199220:"IFCVERTEXLOOP",1417489154:"IFCVECTOR",427810014:"IFCUSHAPEPROFILEDEF",2347495698:"IFCTYPEPRODUCT",1628702193:"IFCTYPEOBJECT",1345879162:"IFCTWODIRECTIONREPEATFACTOR",2715220739:"IFCTRAPEZIUMPROFILEDEF",3124975700:"IFCTEXTLITERALWITHEXTENT",4282788508:"IFCTEXTLITERAL",3028897424:"IFCTERMINATORSYMBOL",3071757647:"IFCTSHAPEPROFILEDEF",230924584:"IFCSWEPTSURFACE",1260650574:"IFCSWEPTDISKSOLID",2247615214:"IFCSWEPTAREASOLID",1878645084:"IFCSURFACESTYLERENDERING",2513912981:"IFCSURFACE",2233826070:"IFCSUBEDGE",3653947884:"IFCSTRUCTURALSTEELPROFILEPROPERTIES",3843319758:"IFCSTRUCTURALPROFILEPROPERTIES",1190533807:"IFCSTRUCTURALLOADSINGLEFORCEWARPING",1597423693:"IFCSTRUCTURALLOADSINGLEFORCE",1973038258:"IFCSTRUCTURALLOADSINGLEDISPLACEMENTDISTORTION",2473145415:"IFCSTRUCTURALLOADSINGLEDISPLACEMENT",2668620305:"IFCSTRUCTURALLOADPLANARFORCE",1595516126:"IFCSTRUCTURALLOADLINEARFORCE",390701378:"IFCSPACETHERMALLOADPROPERTIES",1202362311:"IFCSOUNDVALUE",2485662743:"IFCSOUNDPROPERTIES",723233188:"IFCSOLIDMODEL",2609359061:"IFCSLIPPAGECONNECTIONCONDITION",4124623270:"IFCSHELLBASEDSURFACEMODEL",2411513650:"IFCSERVICELIFEFACTOR",1509187699:"IFCSECTIONEDSPINE",2778083089:"IFCROUNDEDRECTANGLEPROFILEDEF",478536968:"IFCRELATIONSHIP",3765753017:"IFCREINFORCEMENTDEFINITIONPROPERTIES",3413951693:"IFCREGULARTIMESERIES",3615266464:"IFCRECTANGLEPROFILEDEF",110355661:"IFCPROPERTYTABLEVALUE",3650150729:"IFCPROPERTYSINGLEVALUE",3357820518:"IFCPROPERTYSETDEFINITION",941946838:"IFCPROPERTYREFERENCEVALUE",2752243245:"IFCPROPERTYLISTVALUE",4166981789:"IFCPROPERTYENUMERATEDVALUE",1680319473:"IFCPROPERTYDEFINITION",871118103:"IFCPROPERTYBOUNDEDVALUE",673634403:"IFCPRODUCTDEFINITIONSHAPE",179317114:"IFCPREDEFINEDPOINTMARKERSYMBOL",433424934:"IFCPREDEFINEDDIMENSIONSYMBOL",2559016684:"IFCPREDEFINEDCURVEFONT",759155922:"IFCPREDEFINEDCOLOUR",2775532180:"IFCPOLYGONALBOUNDEDHALFSPACE",2924175390:"IFCPOLYLOOP",1423911732:"IFCPOINTONSURFACE",4022376103:"IFCPOINTONCURVE",2067069095:"IFCPOINT",1663979128:"IFCPLANAREXTENT",2004835150:"IFCPLACEMENT",597895409:"IFCPIXELTEXTURE",3021840470:"IFCPHYSICALCOMPLEXQUANTITY",2519244187:"IFCPATH",2529465313:"IFCPARAMETERIZEDPROFILEDEF",1029017970:"IFCORIENTEDEDGE",2665983363:"IFCOPENSHELL",2833995503:"IFCONEDIRECTIONREPEATFACTOR",219451334:"IFCOBJECTDEFINITION",1430189142:"IFCMECHANICALCONCRETEMATERIALPROPERTIES",2022407955:"IFCMATERIALDEFINITIONREPRESENTATION",2347385850:"IFCMAPPEDITEM",1008929658:"IFCLOOP",2624227202:"IFCLOCALPLACEMENT",3422422726:"IFCLIGHTSOURCESPOT",1520743889:"IFCLIGHTSOURCEPOSITIONAL",4266656042:"IFCLIGHTSOURCEGONIOMETRIC",2604431987:"IFCLIGHTSOURCEDIRECTIONAL",125510826:"IFCLIGHTSOURCEAMBIENT",1402838566:"IFCLIGHTSOURCE",3741457305:"IFCIRREGULARTIMESERIES",3905492369:"IFCIMAGETEXTURE",2445078500:"IFCHYGROSCOPICMATERIALPROPERTIES",812098782:"IFCHALFSPACESOLID",178086475:"IFCGRIDPLACEMENT",3590301190:"IFCGEOMETRICSET",4142052618:"IFCGEOMETRICREPRESENTATIONSUBCONTEXT",2453401579:"IFCGEOMETRICREPRESENTATIONITEM",3448662350:"IFCGEOMETRICREPRESENTATIONCONTEXT",1446786286:"IFCGENERALPROFILEPROPERTIES",803998398:"IFCGENERALMATERIALPROPERTIES",3857492461:"IFCFUELPROPERTIES",738692330:"IFCFILLAREASTYLE",4219587988:"IFCFAILURECONNECTIONCONDITION",3008276851:"IFCFACESURFACE",803316827:"IFCFACEOUTERBOUND",1809719519:"IFCFACEBOUND",2556980723:"IFCFACE",1860660968:"IFCEXTENDEDMATERIALPROPERTIES",476780140:"IFCEDGECURVE",3900360178:"IFCEDGE",4170525392:"IFCDRAUGHTINGPREDEFINEDTEXTFONT",3732053477:"IFCDOCUMENTREFERENCE",1694125774:"IFCDIMENSIONPAIR",2273265877:"IFCDIMENSIONCALLOUTRELATIONSHIP",3632507154:"IFCDERIVEDPROFILEDEF",3800577675:"IFCCURVESTYLE",2889183280:"IFCCONVERSIONBASEDUNIT",3050246964:"IFCCONTEXTDEPENDENTUNIT",45288368:"IFCCONNECTIONPOINTECCENTRICITY",1981873012:"IFCCONNECTIONCURVEGEOMETRY",370225590:"IFCCONNECTEDFACESET",1485152156:"IFCCOMPOSITEPROFILEDEF",2542286263:"IFCCOMPLEXPROPERTY",776857604:"IFCCOLOURRGB",647927063:"IFCCLASSIFICATIONREFERENCE",3150382593:"IFCCENTERLINEPROFILEDEF",616511568:"IFCBLOBTEXTURE",2705031697:"IFCARBITRARYPROFILEDEFWITHVOIDS",1310608509:"IFCARBITRARYOPENPROFILEDEF",3798115385:"IFCARBITRARYCLOSEDPROFILEDEF",2297822566:"IFCANNOTATIONTEXTOCCURRENCE",3612888222:"IFCANNOTATIONSYMBOLOCCURRENCE",962685235:"IFCANNOTATIONSURFACEOCCURRENCE",2442683028:"IFCANNOTATIONOCCURRENCE",1065908215:"IFCWATERPROPERTIES",891718957:"IFCVIRTUALGRIDINTERSECTION",1907098498:"IFCVERTEXPOINT",3304826586:"IFCVERTEXBASEDTEXTUREMAP",2799835756:"IFCVERTEX",180925521:"IFCUNITASSIGNMENT",1735638870:"IFCTOPOLOGYREPRESENTATION",1377556343:"IFCTOPOLOGICALREPRESENTATIONITEM",581633288:"IFCTIMESERIESVALUE",1718945513:"IFCTIMESERIESREFERENCERELATIONSHIP",3101149627:"IFCTIMESERIES",3317419933:"IFCTHERMALMATERIALPROPERTIES",1210645708:"IFCTEXTUREVERTEX",2552916305:"IFCTEXTUREMAP",1742049831:"IFCTEXTURECOORDINATEGENERATOR",280115917:"IFCTEXTURECOORDINATE",1484833681:"IFCTEXTSTYLEWITHBOXCHARACTERISTICS",1640371178:"IFCTEXTSTYLETEXTMODEL",2636378356:"IFCTEXTSTYLEFORDEFINEDFONT",1983826977:"IFCTEXTSTYLEFONTMODEL",1447204868:"IFCTEXTSTYLE",912023232:"IFCTELECOMADDRESS",531007025:"IFCTABLEROW",985171141:"IFCTABLE",1290481447:"IFCSYMBOLSTYLE",626085974:"IFCSURFACETEXTURE",1351298697:"IFCSURFACESTYLEWITHTEXTURES",846575682:"IFCSURFACESTYLESHADING",1607154358:"IFCSURFACESTYLEREFRACTION",3303107099:"IFCSURFACESTYLELIGHTING",1300840506:"IFCSURFACESTYLE",3049322572:"IFCSTYLEDREPRESENTATION",3958052878:"IFCSTYLEDITEM",2830218821:"IFCSTYLEMODEL",3408363356:"IFCSTRUCTURALLOADTEMPERATURE",2525727697:"IFCSTRUCTURALLOADSTATIC",2162789131:"IFCSTRUCTURALLOAD",2273995522:"IFCSTRUCTURALCONNECTIONCONDITION",3692461612:"IFCSIMPLEPROPERTY",4240577450:"IFCSHAPEREPRESENTATION",3982875396:"IFCSHAPEMODEL",867548509:"IFCSHAPEASPECT",4165799628:"IFCSECTIONREINFORCEMENTPROPERTIES",2042790032:"IFCSECTIONPROPERTIES",448429030:"IFCSIUNIT",2341007311:"IFCROOT",3679540991:"IFCRIBPLATEPROFILEPROPERTIES",1660063152:"IFCREPRESENTATIONMAP",3008791417:"IFCREPRESENTATIONITEM",3377609919:"IFCREPRESENTATIONCONTEXT",1076942058:"IFCREPRESENTATION",1222501353:"IFCRELAXATION",1580146022:"IFCREINFORCEMENTBARPROPERTIES",2692823254:"IFCREFERENCESVALUEDOCUMENT",825690147:"IFCQUANTITYWEIGHT",2405470396:"IFCQUANTITYVOLUME",3252649465:"IFCQUANTITYTIME",931644368:"IFCQUANTITYLENGTH",2093928680:"IFCQUANTITYCOUNT",2044713172:"IFCQUANTITYAREA",3710013099:"IFCPROPERTYENUMERATION",148025276:"IFCPROPERTYDEPENDENCYRELATIONSHIP",3896028662:"IFCPROPERTYCONSTRAINTRELATIONSHIP",2598011224:"IFCPROPERTY",2802850158:"IFCPROFILEPROPERTIES",3958567839:"IFCPROFILEDEF",2267347899:"IFCPRODUCTSOFCOMBUSTIONPROPERTIES",2095639259:"IFCPRODUCTREPRESENTATION",2417041796:"IFCPRESENTATIONSTYLEASSIGNMENT",3119450353:"IFCPRESENTATIONSTYLE",1304840413:"IFCPRESENTATIONLAYERWITHSTYLE",2022622350:"IFCPRESENTATIONLAYERASSIGNMENT",1775413392:"IFCPREDEFINEDTEXTFONT",3213052703:"IFCPREDEFINEDTERMINATORSYMBOL",990879717:"IFCPREDEFINEDSYMBOL",3727388367:"IFCPREDEFINEDITEM",3355820592:"IFCPOSTALADDRESS",2226359599:"IFCPHYSICALSIMPLEQUANTITY",2483315170:"IFCPHYSICALQUANTITY",101040310:"IFCPERSONANDORGANIZATION",2077209135:"IFCPERSON",1207048766:"IFCOWNERHISTORY",1411181986:"IFCORGANIZATIONRELATIONSHIP",4251960020:"IFCORGANIZATION",1227763645:"IFCOPTICALMATERIALPROPERTIES",2251480897:"IFCOBJECTIVE",3701648758:"IFCOBJECTPLACEMENT",1918398963:"IFCNAMEDUNIT",2706619895:"IFCMONETARYUNIT",3368373690:"IFCMETRIC",677618848:"IFCMECHANICALSTEELMATERIALPROPERTIES",4256014907:"IFCMECHANICALMATERIALPROPERTIES",2597039031:"IFCMEASUREWITHUNIT",3265635763:"IFCMATERIALPROPERTIES",2199411900:"IFCMATERIALLIST",1303795690:"IFCMATERIALLAYERSETUSAGE",3303938423:"IFCMATERIALLAYERSET",248100487:"IFCMATERIALLAYER",1847130766:"IFCMATERIALCLASSIFICATIONRELATIONSHIP",1838606355:"IFCMATERIAL",30780891:"IFCLOCALTIME",1566485204:"IFCLIGHTINTENSITYDISTRIBUTION",4162380809:"IFCLIGHTDISTRIBUTIONDATA",3452421091:"IFCLIBRARYREFERENCE",2655187982:"IFCLIBRARYINFORMATION",3020489413:"IFCIRREGULARTIMESERIESVALUE",852622518:"IFCGRIDAXIS",3548104201:"IFCEXTERNALLYDEFINEDTEXTFONT",3207319532:"IFCEXTERNALLYDEFINEDSYMBOL",1040185647:"IFCEXTERNALLYDEFINEDSURFACESTYLE",2242383968:"IFCEXTERNALLYDEFINEDHATCHSTYLE",3200245327:"IFCEXTERNALREFERENCE",1648886627:"IFCENVIRONMENTALIMPACTVALUE",3796139169:"IFCDRAUGHTINGCALLOUTRELATIONSHIP",770865208:"IFCDOCUMENTINFORMATIONRELATIONSHIP",1154170062:"IFCDOCUMENTINFORMATION",1376555844:"IFCDOCUMENTELECTRONICFORMAT",2949456006:"IFCDIMENSIONALEXPONENTS",1045800335:"IFCDERIVEDUNITELEMENT",1765591967:"IFCDERIVEDUNIT",1072939445:"IFCDATEANDTIME",3510044353:"IFCCURVESTYLEFONTPATTERN",2367409068:"IFCCURVESTYLEFONTANDSCALING",1105321065:"IFCCURVESTYLEFONT",539742890:"IFCCURRENCYRELATIONSHIP",602808272:"IFCCOSTVALUE",1065062679:"IFCCOORDINATEDUNIVERSALTIMEOFFSET",347226245:"IFCCONSTRAINTRELATIONSHIP",613356794:"IFCCONSTRAINTCLASSIFICATIONRELATIONSHIP",1658513725:"IFCCONSTRAINTAGGREGATIONRELATIONSHIP",1959218052:"IFCCONSTRAINT",2732653382:"IFCCONNECTIONSURFACEGEOMETRY",4257277454:"IFCCONNECTIONPORTGEOMETRY",2614616156:"IFCCONNECTIONPOINTGEOMETRY",2859738748:"IFCCONNECTIONGEOMETRY",3264961684:"IFCCOLOURSPECIFICATION",3639012971:"IFCCLASSIFICATIONNOTATIONFACET",938368621:"IFCCLASSIFICATIONNOTATION",1098599126:"IFCCLASSIFICATIONITEMRELATIONSHIP",1767535486:"IFCCLASSIFICATIONITEM",747523909:"IFCCLASSIFICATION",622194075:"IFCCALENDARDATE",2069777674:"IFCBOUNDARYNODECONDITIONWARPING",1387855156:"IFCBOUNDARYNODECONDITION",3367102660:"IFCBOUNDARYFACECONDITION",1560379544:"IFCBOUNDARYEDGECONDITION",4037036970:"IFCBOUNDARYCONDITION",3869604511:"IFCAPPROVALRELATIONSHIP",390851274:"IFCAPPROVALPROPERTYRELATIONSHIP",2080292479:"IFCAPPROVALACTORRELATIONSHIP",130549933:"IFCAPPROVAL",1110488051:"IFCAPPLIEDVALUERELATIONSHIP",411424972:"IFCAPPLIEDVALUE",639542469:"IFCAPPLICATION",618182010:"IFCADDRESS",3630933823:"IFCACTORROLE",599546466:"FILE_DESCRIPTION",1390159747:"FILE_NAME",1109904537:"FILE_SCHEMA"};let hh=class RA{static async getUnits(t){var e,i,s;const{IFCUNITASSIGNMENT:n}=_e,o=await t.getAllPropertiesOfType(n);if(!o)return 1;const a=Object.keys(o),c=o[parseInt(a[0],10)];for(const l of c.Units){if(l.value===void 0||l.value===null)continue;const h=await t.getProperties(l.value);if(!h||!h.UnitType||!h.UnitType.value||h.UnitType.value!=="LENGTHUNIT")continue;let u=1,d=1;return h.Name.value==="METRE"&&(d=1),h.Name.value==="FOOT"&&(d=.3048),((e=h.Prefix)==null?void 0:e.value)==="MILLI"?u=.001:((i=h.Prefix)==null?void 0:i.value)==="CENTI"?u=.01:((s=h.Prefix)==null?void 0:s.value)==="DECI"&&(u=.1),d*u}return 1}static async findItemByGuid(t,e){var i;const s=t.getAllPropertiesIDs();for(const n of s){const o=await t.getProperties(n);if(o&&((i=o.GlobalId)==null?void 0:i.value)===e)return o}return null}static async getRelationMap(t,e,i){var s;const n=i??(async()=>{}),o={},a=t.getAllPropertiesIDs();for(const c of a){const l=await t.getProperties(c);if(!l)continue;const h=l.type===e,u=Object.keys(l).find(g=>g.startsWith("Relating")),d=Object.keys(l).find(g=>g.startsWith("Related"));if(!(h&&u&&d))continue;const f=await t.getProperties((s=l[u])==null?void 0:s.value),p=l[d];if(!f||!p||!(p&&Array.isArray(p)))continue;const m=p.map(g=>g.value);await n(f.expressID,m),o[f.expressID]=m}return o}static async getQsetQuantities(t,e,i){const s=i??(()=>{}),n=await t.getProperties(e);return!n||n.type!==Ks?null:(n.Quantities??[{}]).map(o=>(o.value&&s(o.value),o.value)).filter(o=>o!==null)}static async getPsetProps(t,e,i){const s=i??(()=>{}),n=await t.getProperties(e);return!n||n.type!==pi?null:(n.HasProperties??[{}]).map(o=>(o.value&&s(o.value),o.value)).filter(o=>o!==null)}static async getPsetRel(t,e){var i;if(!await t.getProperties(e))return null;const s=await t.getAllPropertiesOfType(on);if(!s)return null;const n=Object.values(s);let o=null;for(const a of n)((i=a.RelatingPropertyDefinition)==null?void 0:i.value)===e&&(o=a.expressID);return o}static async getQsetRel(t,e){return RA.getPsetRel(t,e)}static async getEntityName(t,e){var i;const s=await t.getProperties(e);if(!s)return{key:null,name:null};const n=Object.keys(s).find(a=>a.endsWith("Name"))??null,o=n?(i=s[n])==null?void 0:i.value:null;return{key:n,name:o}}static async getQuantityValue(t,e){const i=await t.getProperties(e);if(!i)return{key:null,value:null};const s=Object.keys(i).find(o=>o.endsWith("Value"))??null;let n;return s===null||i[s]===void 0||i[s]===null?n=null:n=i[s].value,{key:s,value:n}}static isRel(t){return _f[t].startsWith("IFCREL")}static async attributeExists(t,e,i){const s=await t.getProperties(e);return s?Object.keys(s).includes(i):!1}static async groupEntitiesByType(t,e){var i;const s=new Map;for(const n of e){const o=await t.getProperties(n);if(!o)continue;const a=o.type;s.get(a)||s.set(a,new Set),(i=s.get(a))==null||i.add(n)}return s}};const AU={IFCURIREFERENCE:"IfcUriReference",IFCTIME:"IfcTime",IFCTEMPERATURERATEOFCHANGEMEASURE:"IfcTemperatureRateOfChangeMeasure",IFCSOUNDPRESSURELEVELMEASURE:"IfcSoundPressureLevelMeasure",IFCSOUNDPOWERLEVELMEASURE:"IfcSoundPowerLevelMeasure",IFCPROPERTYSETDEFINITIONSET:"IfcPropertySetDefinitionSet",IFCPOSITIVEINTEGER:"IfcPositiveInteger",IFCNONNEGATIVELENGTHMEASURE:"IfcNonNegativeLengthMeasure",IFCLINEINDEX:"IfcLineIndex",IFCLANGUAGEID:"IfcLanguageId",IFCDURATION:"IfcDuration",IFCDAYINWEEKNUMBER:"IfcDayInWeekNumber",IFCDATETIME:"IfcDateTime",IFCDATE:"IfcDate",IFCCARDINALPOINTREFERENCE:"IfcCardinalPointReference",IFCBINARY:"IfcBinary",IFCAREADENSITYMEASURE:"IfcAreaDensityMeasure",IFCARCINDEX:"IfcArcIndex",IFCYEARNUMBER:"IfcYearNumber",IFCWARPINGMOMENTMEASURE:"IfcWarpingMomentMeasure",IFCWARPINGCONSTANTMEASURE:"IfcWarpingConstantMeasure",IFCVOLUMETRICFLOWRATEMEASURE:"IfcVolumetricFlowRateMeasure",IFCVOLUMEMEASURE:"IfcVolumeMeasure",IFCVAPORPERMEABILITYMEASURE:"IfcVaporPermeabilityMeasure",IFCTORQUEMEASURE:"IfcTorqueMeasure",IFCTIMESTAMP:"IfcTimestamp",IFCTIMEMEASURE:"IfcTimeMeasure",IFCTHERMODYNAMICTEMPERATUREMEASURE:"IfcThermodynamicTemperatureMeasure",IFCTHERMALTRANSMITTANCEMEASURE:"IfcThermalTransmittanceMeasure",IFCTHERMALRESISTANCEMEASURE:"IfcThermalResistanceMeasure",IFCTHERMALEXPANSIONCOEFFICIENTMEASURE:"IfcThermalExpansionCoefficientMeasure",IFCTHERMALCONDUCTIVITYMEASURE:"IfcThermalConductivityMeasure",IFCTHERMALADMITTANCEMEASURE:"IfcThermalAdmittanceMeasure",IFCTEXTTRANSFORMATION:"IfcTextTransformation",IFCTEXTFONTNAME:"IfcTextFontName",IFCTEXTDECORATION:"IfcTextDecoration",IFCTEXTALIGNMENT:"IfcTextAlignment",IFCTEXT:"IfcText",IFCTEMPERATUREGRADIENTMEASURE:"IfcTemperatureGradientMeasure",IFCSPECULARROUGHNESS:"IfcSpecularRoughness",IFCSPECULAREXPONENT:"IfcSpecularExponent",IFCSPECIFICHEATCAPACITYMEASURE:"IfcSpecificHeatCapacityMeasure",IFCSOUNDPRESSUREMEASURE:"IfcSoundPressureMeasure",IFCSOUNDPOWERMEASURE:"IfcSoundPowerMeasure",IFCSOLIDANGLEMEASURE:"IfcSolidAngleMeasure",IFCSHEARMODULUSMEASURE:"IfcShearModulusMeasure",IFCSECTIONALAREAINTEGRALMEASURE:"IfcSectionalAreaIntegralMeasure",IFCSECTIONMODULUSMEASURE:"IfcSectionModulusMeasure",IFCSECONDINMINUTE:"IfcSecondInMinute",IFCROTATIONALSTIFFNESSMEASURE:"IfcRotationalStiffnessMeasure",IFCROTATIONALMASSMEASURE:"IfcRotationalMassMeasure",IFCROTATIONALFREQUENCYMEASURE:"IfcRotationalFrequencyMeasure",IFCREAL:"IfcReal",IFCRATIOMEASURE:"IfcRatioMeasure",IFCRADIOACTIVITYMEASURE:"IfcRadioactivityMeasure",IFCPRESSUREMEASURE:"IfcPressureMeasure",IFCPRESENTABLETEXT:"IfcPresentableText",IFCPOWERMEASURE:"IfcPowerMeasure",IFCPOSITIVERATIOMEASURE:"IfcPositiveRatioMeasure",IFCPOSITIVEPLANEANGLEMEASURE:"IfcPositivePlaneAngleMeasure",IFCPOSITIVELENGTHMEASURE:"IfcPositiveLengthMeasure",IFCPLANEANGLEMEASURE:"IfcPlaneAngleMeasure",IFCPLANARFORCEMEASURE:"IfcPlanarForceMeasure",IFCPARAMETERVALUE:"IfcParameterValue",IFCPHMEASURE:"IfcPhMeasure",IFCNUMERICMEASURE:"IfcNumericMeasure",IFCNORMALISEDRATIOMEASURE:"IfcNormalisedRatioMeasure",IFCMONTHINYEARNUMBER:"IfcMonthInYearNumber",IFCMONETARYMEASURE:"IfcMonetaryMeasure",IFCMOMENTOFINERTIAMEASURE:"IfcMomentOfInertiaMeasure",IFCMOLECULARWEIGHTMEASURE:"IfcMolecularWeightMeasure",IFCMOISTUREDIFFUSIVITYMEASURE:"IfcMoistureDiffusivityMeasure",IFCMODULUSOFSUBGRADEREACTIONMEASURE:"IfcModulusOfSubgradeReactionMeasure",IFCMODULUSOFROTATIONALSUBGRADEREACTIONMEASURE:"IfcModulusOfRotationalSubgradeReactionMeasure",IFCMODULUSOFLINEARSUBGRADEREACTIONMEASURE:"IfcModulusOfLinearSubgradeReactionMeasure",IFCMODULUSOFELASTICITYMEASURE:"IfcModulusOfElasticityMeasure",IFCMINUTEINHOUR:"IfcMinuteInHour",IFCMASSPERLENGTHMEASURE:"IfcMassPerLengthMeasure",IFCMASSMEASURE:"IfcMassMeasure",IFCMASSFLOWRATEMEASURE:"IfcMassFlowRateMeasure",IFCMASSDENSITYMEASURE:"IfcMassDensityMeasure",IFCMAGNETICFLUXMEASURE:"IfcMagneticFluxMeasure",IFCMAGNETICFLUXDENSITYMEASURE:"IfcMagneticFluxDensityMeasure",IFCLUMINOUSINTENSITYMEASURE:"IfcLuminousIntensityMeasure",IFCLUMINOUSINTENSITYDISTRIBUTIONMEASURE:"IfcLuminousIntensityDistributionMeasure",IFCLUMINOUSFLUXMEASURE:"IfcLuminousFluxMeasure",IFCLOGICAL:"IfcLogical",IFCLINEARVELOCITYMEASURE:"IfcLinearVelocityMeasure",IFCLINEARSTIFFNESSMEASURE:"IfcLinearStiffnessMeasure",IFCLINEARMOMENTMEASURE:"IfcLinearMomentMeasure",IFCLINEARFORCEMEASURE:"IfcLinearForceMeasure",IFCLENGTHMEASURE:"IfcLengthMeasure",IFCLABEL:"IfcLabel",IFCKINEMATICVISCOSITYMEASURE:"IfcKinematicViscosityMeasure",IFCISOTHERMALMOISTURECAPACITYMEASURE:"IfcIsothermalMoistureCapacityMeasure",IFCIONCONCENTRATIONMEASURE:"IfcIonConcentrationMeasure",IFCINTEGERCOUNTRATEMEASURE:"IfcIntegerCountRateMeasure",IFCINTEGER:"IfcInteger",IFCINDUCTANCEMEASURE:"IfcInductanceMeasure",IFCILLUMINANCEMEASURE:"IfcIlluminanceMeasure",IFCIDENTIFIER:"IfcIdentifier",IFCHOURINDAY:"IfcHourInDay",IFCHEATINGVALUEMEASURE:"IfcHeatingValueMeasure",IFCHEATFLUXDENSITYMEASURE:"IfcHeatFluxDensityMeasure",IFCGLOBALLYUNIQUEID:"IfcGloballyUniqueId",IFCFREQUENCYMEASURE:"IfcFrequencyMeasure",IFCFORCEMEASURE:"IfcForceMeasure",IFCFONTWEIGHT:"IfcFontWeight",IFCFONTVARIANT:"IfcFontVariant",IFCFONTSTYLE:"IfcFontStyle",IFCENERGYMEASURE:"IfcEnergyMeasure",IFCELECTRICVOLTAGEMEASURE:"IfcElectricVoltageMeasure",IFCELECTRICRESISTANCEMEASURE:"IfcElectricResistanceMeasure",IFCELECTRICCURRENTMEASURE:"IfcElectricCurrentMeasure",IFCELECTRICCONDUCTANCEMEASURE:"IfcElectricConductanceMeasure",IFCELECTRICCHARGEMEASURE:"IfcElectricChargeMeasure",IFCELECTRICCAPACITANCEMEASURE:"IfcElectricCapacitanceMeasure",IFCDYNAMICVISCOSITYMEASURE:"IfcDynamicViscosityMeasure",IFCDOSEEQUIVALENTMEASURE:"IfcDoseEquivalentMeasure",IFCDIMENSIONCOUNT:"IfcDimensionCount",IFCDESCRIPTIVEMEASURE:"IfcDescriptiveMeasure",IFCDAYLIGHTSAVINGHOUR:"IfcDaylightSavingHour",IFCDAYINMONTHNUMBER:"IfcDayInMonthNumber",IFCCURVATUREMEASURE:"IfcCurvatureMeasure",IFCCOUNTMEASURE:"IfcCountMeasure",IFCCONTEXTDEPENDENTMEASURE:"IfcContextDependentMeasure",IFCCOMPOUNDPLANEANGLEMEASURE:"IfcCompoundPlaneAngleMeasure",IFCCOMPLEXNUMBER:"IfcComplexNumber",IFCBOXALIGNMENT:"IfcBoxAlignment",IFCBOOLEAN:"IfcBoolean",IFCAREAMEASURE:"IfcAreaMeasure",IFCANGULARVELOCITYMEASURE:"IfcAngularVelocityMeasure",IFCAMOUNTOFSUBSTANCEMEASURE:"IfcAmountOfSubstanceMeasure",IFCACCELERATIONMEASURE:"IfcAccelerationMeasure",IFCABSORBEDDOSEMEASURE:"IfcAbsorbedDoseMeasure",IFCGEOSLICE:"IfcGeoSlice",IFCGEOMODEL:"IfcGeoModel",IFCELECTRICFLOWTREATMENTDEVICE:"IfcElectricFlowTreatmentDevice",IFCDISTRIBUTIONBOARD:"IfcDistributionBoard",IFCCONVEYORSEGMENT:"IfcConveyorSegment",IFCCAISSONFOUNDATION:"IfcCaissonFoundation",IFCBOREHOLE:"IfcBorehole",IFCBEARING:"IfcBearing",IFCALIGNMENT:"IfcAlignment",IFCTRACKELEMENT:"IfcTrackElement",IFCSIGNAL:"IfcSignal",IFCREINFORCEDSOIL:"IfcReinforcedSoil",IFCRAIL:"IfcRail",IFCPAVEMENT:"IfcPavement",IFCNAVIGATIONELEMENT:"IfcNavigationElement",IFCMOORINGDEVICE:"IfcMooringDevice",IFCMOBILETELECOMMUNICATIONSAPPLIANCE:"IfcMobileTelecommunicationsAppliance",IFCLIQUIDTERMINAL:"IfcLiquidTerminal",IFCLINEARPOSITIONINGELEMENT:"IfcLinearPositioningElement",IFCKERB:"IfcKerb",IFCGEOTECHNICALASSEMBLY:"IfcGeotechnicalAssembly",IFCELECTRICFLOWTREATMENTDEVICETYPE:"IfcElectricFlowTreatmentDeviceType",IFCEARTHWORKSFILL:"IfcEarthworksFill",IFCEARTHWORKSELEMENT:"IfcEarthworksElement",IFCEARTHWORKSCUT:"IfcEarthworksCut",IFCDISTRIBUTIONBOARDTYPE:"IfcDistributionBoardType",IFCDEEPFOUNDATION:"IfcDeepFoundation",IFCCOURSE:"IfcCourse",IFCCONVEYORSEGMENTTYPE:"IfcConveyorSegmentType",IFCCAISSONFOUNDATIONTYPE:"IfcCaissonFoundationType",IFCBUILTSYSTEM:"IfcBuiltSystem",IFCBUILTELEMENT:"IfcBuiltElement",IFCBRIDGEPART:"IfcBridgePart",IFCBRIDGE:"IfcBridge",IFCBEARINGTYPE:"IfcBearingType",IFCALIGNMENTVERTICAL:"IfcAlignmentVertical",IFCALIGNMENTSEGMENT:"IfcAlignmentSegment",IFCALIGNMENTHORIZONTAL:"IfcAlignmentHorizontal",IFCALIGNMENTCANT:"IfcAlignmentCant",IFCVIBRATIONDAMPERTYPE:"IfcVibrationDamperType",IFCVIBRATIONDAMPER:"IfcVibrationDamper",IFCVEHICLE:"IfcVehicle",IFCTRANSPORTATIONDEVICE:"IfcTransportationDevice",IFCTRACKELEMENTTYPE:"IfcTrackElementType",IFCTENDONCONDUITTYPE:"IfcTendonConduitType",IFCTENDONCONDUIT:"IfcTendonConduit",IFCSINESPIRAL:"IfcSineSpiral",IFCSIGNALTYPE:"IfcSignalType",IFCSIGNTYPE:"IfcSignType",IFCSIGN:"IfcSign",IFCSEVENTHORDERPOLYNOMIALSPIRAL:"IfcSeventhOrderPolynomialSpiral",IFCSEGMENTEDREFERENCECURVE:"IfcSegmentedReferenceCurve",IFCSECONDORDERPOLYNOMIALSPIRAL:"IfcSecondOrderPolynomialSpiral",IFCROADPART:"IfcRoadPart",IFCROAD:"IfcRoad",IFCRELADHERESTOELEMENT:"IfcRelAdheresToElement",IFCREFERENT:"IfcReferent",IFCRAILWAYPART:"IfcRailwayPart",IFCRAILWAY:"IfcRailway",IFCRAILTYPE:"IfcRailType",IFCPOSITIONINGELEMENT:"IfcPositioningElement",IFCPAVEMENTTYPE:"IfcPavementType",IFCNAVIGATIONELEMENTTYPE:"IfcNavigationElementType",IFCMOORINGDEVICETYPE:"IfcMooringDeviceType",IFCMOBILETELECOMMUNICATIONSAPPLIANCETYPE:"IfcMobileTelecommunicationsApplianceType",IFCMARINEPART:"IfcMarinePart",IFCMARINEFACILITY:"IfcMarineFacility",IFCLIQUIDTERMINALTYPE:"IfcLiquidTerminalType",IFCLINEARELEMENT:"IfcLinearElement",IFCKERBTYPE:"IfcKerbType",IFCIMPACTPROTECTIONDEVICETYPE:"IfcImpactProtectionDeviceType",IFCIMPACTPROTECTIONDEVICE:"IfcImpactProtectionDevice",IFCGRADIENTCURVE:"IfcGradientCurve",IFCGEOTECHNICALSTRATUM:"IfcGeotechnicalStratum",IFCGEOTECHNICALELEMENT:"IfcGeotechnicalElement",IFCFACILITYPARTCOMMON:"IfcFacilityPartCommon",IFCFACILITYPART:"IfcFacilityPart",IFCFACILITY:"IfcFacility",IFCDIRECTRIXDERIVEDREFERENCESWEPTAREASOLID:"IfcDirectrixDerivedReferenceSweptAreaSolid",IFCDEEPFOUNDATIONTYPE:"IfcDeepFoundationType",IFCCOURSETYPE:"IfcCourseType",IFCCOSINESPIRAL:"IfcCosineSpiral",IFCCLOTHOID:"IfcClothoid",IFCBUILTELEMENTTYPE:"IfcBuiltElementType",IFCVEHICLETYPE:"IfcVehicleType",IFCTRIANGULATEDIRREGULARNETWORK:"IfcTriangulatedIrregularNetwork",IFCTRANSPORTATIONDEVICETYPE:"IfcTransportationDeviceType",IFCTHIRDORDERPOLYNOMIALSPIRAL:"IfcThirdOrderPolynomialSpiral",IFCSPIRAL:"IfcSpiral",IFCSECTIONEDSURFACE:"IfcSectionedSurface",IFCSECTIONEDSOLIDHORIZONTAL:"IfcSectionedSolidHorizontal",IFCSECTIONEDSOLID:"IfcSectionedSolid",IFCRELPOSITIONS:"IfcRelPositions",IFCRELASSOCIATESPROFILEDEF:"IfcRelAssociatesProfileDef",IFCPOLYNOMIALCURVE:"IfcPolynomialCurve",IFCOFFSETCURVEBYDISTANCES:"IfcOffsetCurveByDistances",IFCOFFSETCURVE:"IfcOffsetCurve",IFCINDEXEDPOLYGONALTEXTUREMAP:"IfcIndexedPolygonalTextureMap",IFCDIRECTRIXCURVESWEPTAREASOLID:"IfcDirectrixCurveSweptAreaSolid",IFCCURVESEGMENT:"IfcCurveSegment",IFCAXIS2PLACEMENTLINEAR:"IfcAxis2PlacementLinear",IFCSEGMENT:"IfcSegment",IFCPOINTBYDISTANCEEXPRESSION:"IfcPointByDistanceExpression",IFCOPENCROSSPROFILEDEF:"IfcOpenCrossProfileDef",IFCLINEARPLACEMENT:"IfcLinearPlacement",IFCALIGNMENTHORIZONTALSEGMENT:"IfcAlignmentHorizontalSegment",IFCALIGNMENTCANTSEGMENT:"IfcAlignmentCantSegment",IFCTEXTURECOORDINATEINDICESWITHVOIDS:"IfcTextureCoordinateIndicesWithVoids",IFCTEXTURECOORDINATEINDICES:"IfcTextureCoordinateIndices",IFCQUANTITYNUMBER:"IfcQuantityNumber",IFCALIGNMENTVERTICALSEGMENT:"IfcAlignmentVerticalSegment",IFCALIGNMENTPARAMETERSEGMENT:"IfcAlignmentParameterSegment",IFCCONTROLLER:"IfcController",IFCALARM:"IfcAlarm",IFCACTUATOR:"IfcActuator",IFCUNITARYCONTROLELEMENT:"IfcUnitaryControlElement",IFCSENSOR:"IfcSensor",IFCPROTECTIVEDEVICETRIPPINGUNIT:"IfcProtectiveDeviceTrippingUnit",IFCFLOWINSTRUMENT:"IfcFlowInstrument",IFCFIRESUPPRESSIONTERMINAL:"IfcFireSuppressionTerminal",IFCFILTER:"IfcFilter",IFCFAN:"IfcFan",IFCELECTRICTIMECONTROL:"IfcElectricTimeControl",IFCELECTRICMOTOR:"IfcElectricMotor",IFCELECTRICGENERATOR:"IfcElectricGenerator",IFCELECTRICFLOWSTORAGEDEVICE:"IfcElectricFlowStorageDevice",IFCELECTRICDISTRIBUTIONBOARD:"IfcElectricDistributionBoard",IFCELECTRICAPPLIANCE:"IfcElectricAppliance",IFCDUCTSILENCER:"IfcDuctSilencer",IFCDUCTSEGMENT:"IfcDuctSegment",IFCDUCTFITTING:"IfcDuctFitting",IFCDISTRIBUTIONCIRCUIT:"IfcDistributionCircuit",IFCDAMPER:"IfcDamper",IFCCOOLINGTOWER:"IfcCoolingTower",IFCCOOLEDBEAM:"IfcCooledBeam",IFCCONDENSER:"IfcCondenser",IFCCOMPRESSOR:"IfcCompressor",IFCCOMMUNICATIONSAPPLIANCE:"IfcCommunicationsAppliance",IFCCOIL:"IfcCoil",IFCCHILLER:"IfcChiller",IFCCABLESEGMENT:"IfcCableSegment",IFCCABLEFITTING:"IfcCableFitting",IFCCABLECARRIERSEGMENT:"IfcCableCarrierSegment",IFCCABLECARRIERFITTING:"IfcCableCarrierFitting",IFCBURNER:"IfcBurner",IFCBOILER:"IfcBoiler",IFCBEAMSTANDARDCASE:"IfcBeamStandardCase",IFCAUDIOVISUALAPPLIANCE:"IfcAudioVisualAppliance",IFCAIRTOAIRHEATRECOVERY:"IfcAirToAirHeatRecovery",IFCAIRTERMINALBOX:"IfcAirTerminalBox",IFCAIRTERMINAL:"IfcAirTerminal",IFCWINDOWSTANDARDCASE:"IfcWindowStandardCase",IFCWASTETERMINAL:"IfcWasteTerminal",IFCWALLELEMENTEDCASE:"IfcWallElementedCase",IFCVALVE:"IfcValve",IFCUNITARYEQUIPMENT:"IfcUnitaryEquipment",IFCUNITARYCONTROLELEMENTTYPE:"IfcUnitaryControlElementType",IFCTUBEBUNDLE:"IfcTubeBundle",IFCTRANSFORMER:"IfcTransformer",IFCTANK:"IfcTank",IFCSWITCHINGDEVICE:"IfcSwitchingDevice",IFCSTRUCTURALLOADCASE:"IfcStructuralLoadCase",IFCSTACKTERMINAL:"IfcStackTerminal",IFCSPACEHEATER:"IfcSpaceHeater",IFCSOLARDEVICE:"IfcSolarDevice",IFCSLABSTANDARDCASE:"IfcSlabStandardCase",IFCSLABELEMENTEDCASE:"IfcSlabElementedCase",IFCSHADINGDEVICE:"IfcShadingDevice",IFCSANITARYTERMINAL:"IfcSanitaryTerminal",IFCREINFORCINGBARTYPE:"IfcReinforcingBarType",IFCRATIONALBSPLINECURVEWITHKNOTS:"IfcRationalBSplineCurveWithKnots",IFCPUMP:"IfcPump",IFCPROTECTIVEDEVICETRIPPINGUNITTYPE:"IfcProtectiveDeviceTrippingUnitType",IFCPROTECTIVEDEVICE:"IfcProtectiveDevice",IFCPLATESTANDARDCASE:"IfcPlateStandardCase",IFCPIPESEGMENT:"IfcPipeSegment",IFCPIPEFITTING:"IfcPipeFitting",IFCOUTLET:"IfcOutlet",IFCOUTERBOUNDARYCURVE:"IfcOuterBoundaryCurve",IFCMOTORCONNECTION:"IfcMotorConnection",IFCMEMBERSTANDARDCASE:"IfcMemberStandardCase",IFCMEDICALDEVICE:"IfcMedicalDevice",IFCLIGHTFIXTURE:"IfcLightFixture",IFCLAMP:"IfcLamp",IFCJUNCTIONBOX:"IfcJunctionBox",IFCINTERCEPTOR:"IfcInterceptor",IFCHUMIDIFIER:"IfcHumidifier",IFCHEATEXCHANGER:"IfcHeatExchanger",IFCFLOWMETER:"IfcFlowMeter",IFCEXTERNALSPATIALELEMENT:"IfcExternalSpatialElement",IFCEVAPORATOR:"IfcEvaporator",IFCEVAPORATIVECOOLER:"IfcEvaporativeCooler",IFCENGINE:"IfcEngine",IFCELECTRICDISTRIBUTIONBOARDTYPE:"IfcElectricDistributionBoardType",IFCDOORSTANDARDCASE:"IfcDoorStandardCase",IFCDISTRIBUTIONSYSTEM:"IfcDistributionSystem",IFCCOMMUNICATIONSAPPLIANCETYPE:"IfcCommunicationsApplianceType",IFCCOLUMNSTANDARDCASE:"IfcColumnStandardCase",IFCCIVILELEMENT:"IfcCivilElement",IFCCHIMNEY:"IfcChimney",IFCCABLEFITTINGTYPE:"IfcCableFittingType",IFCBURNERTYPE:"IfcBurnerType",IFCBUILDINGSYSTEM:"IfcBuildingSystem",IFCBUILDINGELEMENTPARTTYPE:"IfcBuildingElementPartType",IFCBOUNDARYCURVE:"IfcBoundaryCurve",IFCBSPLINECURVEWITHKNOTS:"IfcBSplineCurveWithKnots",IFCAUDIOVISUALAPPLIANCETYPE:"IfcAudioVisualApplianceType",IFCWORKCALENDAR:"IfcWorkCalendar",IFCWINDOWTYPE:"IfcWindowType",IFCVOIDINGFEATURE:"IfcVoidingFeature",IFCVIBRATIONISOLATOR:"IfcVibrationIsolator",IFCTENDONTYPE:"IfcTendonType",IFCTENDONANCHORTYPE:"IfcTendonAnchorType",IFCSYSTEMFURNITUREELEMENT:"IfcSystemFurnitureElement",IFCSURFACEFEATURE:"IfcSurfaceFeature",IFCSTRUCTURALSURFACEACTION:"IfcStructuralSurfaceAction",IFCSTRUCTURALCURVEREACTION:"IfcStructuralCurveReaction",IFCSTRUCTURALCURVEACTION:"IfcStructuralCurveAction",IFCSTAIRTYPE:"IfcStairType",IFCSOLARDEVICETYPE:"IfcSolarDeviceType",IFCSHADINGDEVICETYPE:"IfcShadingDeviceType",IFCSEAMCURVE:"IfcSeamCurve",IFCROOFTYPE:"IfcRoofType",IFCREINFORCINGMESHTYPE:"IfcReinforcingMeshType",IFCREINFORCINGELEMENTTYPE:"IfcReinforcingElementType",IFCRATIONALBSPLINESURFACEWITHKNOTS:"IfcRationalBSplineSurfaceWithKnots",IFCRAMPTYPE:"IfcRampType",IFCPOLYGONALFACESET:"IfcPolygonalFaceSet",IFCPILETYPE:"IfcPileType",IFCOPENINGSTANDARDCASE:"IfcOpeningStandardCase",IFCMEDICALDEVICETYPE:"IfcMedicalDeviceType",IFCINTERSECTIONCURVE:"IfcIntersectionCurve",IFCINTERCEPTORTYPE:"IfcInterceptorType",IFCINDEXEDPOLYCURVE:"IfcIndexedPolyCurve",IFCGEOGRAPHICELEMENT:"IfcGeographicElement",IFCFURNITURE:"IfcFurniture",IFCFOOTINGTYPE:"IfcFootingType",IFCEXTERNALSPATIALSTRUCTUREELEMENT:"IfcExternalSpatialStructureElement",IFCEVENT:"IfcEvent",IFCENGINETYPE:"IfcEngineType",IFCELEMENTASSEMBLYTYPE:"IfcElementAssemblyType",IFCDOORTYPE:"IfcDoorType",IFCCYLINDRICALSURFACE:"IfcCylindricalSurface",IFCCONSTRUCTIONPRODUCTRESOURCETYPE:"IfcConstructionProductResourceType",IFCCONSTRUCTIONMATERIALRESOURCETYPE:"IfcConstructionMaterialResourceType",IFCCONSTRUCTIONEQUIPMENTRESOURCETYPE:"IfcConstructionEquipmentResourceType",IFCCOMPOSITECURVEONSURFACE:"IfcCompositeCurveOnSurface",IFCCOMPLEXPROPERTYTEMPLATE:"IfcComplexPropertyTemplate",IFCCIVILELEMENTTYPE:"IfcCivilElementType",IFCCHIMNEYTYPE:"IfcChimneyType",IFCBSPLINESURFACEWITHKNOTS:"IfcBSplineSurfaceWithKnots",IFCBSPLINESURFACE:"IfcBSplineSurface",IFCADVANCEDBREPWITHVOIDS:"IfcAdvancedBrepWithVoids",IFCADVANCEDBREP:"IfcAdvancedBrep",IFCTRIANGULATEDFACESET:"IfcTriangulatedFaceSet",IFCTOROIDALSURFACE:"IfcToroidalSurface",IFCTESSELLATEDFACESET:"IfcTessellatedFaceSet",IFCTASKTYPE:"IfcTaskType",IFCSURFACECURVE:"IfcSurfaceCurve",IFCSUBCONTRACTRESOURCETYPE:"IfcSubContractResourceType",IFCSTRUCTURALSURFACEREACTION:"IfcStructuralSurfaceReaction",IFCSPHERICALSURFACE:"IfcSphericalSurface",IFCSPATIALZONETYPE:"IfcSpatialZoneType",IFCSPATIALZONE:"IfcSpatialZone",IFCSPATIALELEMENTTYPE:"IfcSpatialElementType",IFCSPATIALELEMENT:"IfcSpatialElement",IFCSIMPLEPROPERTYTEMPLATE:"IfcSimplePropertyTemplate",IFCREVOLVEDAREASOLIDTAPERED:"IfcRevolvedAreaSolidTapered",IFCREPARAMETRISEDCOMPOSITECURVESEGMENT:"IfcReparametrisedCompositeCurveSegment",IFCRELSPACEBOUNDARY2NDLEVEL:"IfcRelSpaceBoundary2ndLevel",IFCRELSPACEBOUNDARY1STLEVEL:"IfcRelSpaceBoundary1stLevel",IFCRELINTERFERESELEMENTS:"IfcRelInterferesElements",IFCRELDEFINESBYTEMPLATE:"IfcRelDefinesByTemplate",IFCRELDEFINESBYOBJECT:"IfcRelDefinesByObject",IFCRELDECLARES:"IfcRelDeclares",IFCRELASSIGNSTOGROUPBYFACTOR:"IfcRelAssignsToGroupByFactor",IFCPROPERTYTEMPLATE:"IfcPropertyTemplate",IFCPROPERTYSETTEMPLATE:"IfcPropertySetTemplate",IFCPROJECTLIBRARY:"IfcProjectLibrary",IFCPROCEDURETYPE:"IfcProcedureType",IFCPREDEFINEDPROPERTYSET:"IfcPredefinedPropertySet",IFCPCURVE:"IfcPCurve",IFCLABORRESOURCETYPE:"IfcLaborResourceType",IFCINDEXEDPOLYGONALFACEWITHVOIDS:"IfcIndexedPolygonalFaceWithVoids",IFCINDEXEDPOLYGONALFACE:"IfcIndexedPolygonalFace",IFCGEOGRAPHICELEMENTTYPE:"IfcGeographicElementType",IFCFIXEDREFERENCESWEPTAREASOLID:"IfcFixedReferenceSweptAreaSolid",IFCEXTRUDEDAREASOLIDTAPERED:"IfcExtrudedAreaSolidTapered",IFCEVENTTYPE:"IfcEventType",IFCCURVEBOUNDEDSURFACE:"IfcCurveBoundedSurface",IFCCREWRESOURCETYPE:"IfcCrewResourceType",IFCCONTEXT:"IfcContext",IFCCONSTRUCTIONRESOURCETYPE:"IfcConstructionResourceType",IFCCARTESIANPOINTLIST3D:"IfcCartesianPointList3D",IFCCARTESIANPOINTLIST2D:"IfcCartesianPointList2D",IFCCARTESIANPOINTLIST:"IfcCartesianPointList",IFCADVANCEDFACE:"IfcAdvancedFace",IFCTYPERESOURCE:"IfcTypeResource",IFCTYPEPROCESS:"IfcTypeProcess",IFCTESSELLATEDITEM:"IfcTessellatedItem",IFCSWEPTDISKSOLIDPOLYGONAL:"IfcSweptDiskSolidPolygonal",IFCRESOURCETIME:"IfcResourceTime",IFCRESOURCECONSTRAINTRELATIONSHIP:"IfcResourceConstraintRelationship",IFCRESOURCEAPPROVALRELATIONSHIP:"IfcResourceApprovalRelationship",IFCQUANTITYSET:"IfcQuantitySet",IFCPROPERTYTEMPLATEDEFINITION:"IfcPropertyTemplateDefinition",IFCPREDEFINEDPROPERTIES:"IfcPredefinedProperties",IFCMIRROREDPROFILEDEF:"IfcMirroredProfileDef",IFCMATERIALRELATIONSHIP:"IfcMaterialRelationship",IFCMATERIALPROFILESETUSAGETAPERING:"IfcMaterialProfileSetUsageTapering",IFCMATERIALPROFILESETUSAGE:"IfcMaterialProfileSetUsage",IFCMATERIALCONSTITUENTSET:"IfcMaterialConstituentSet",IFCMATERIALCONSTITUENT:"IfcMaterialConstituent",IFCLAGTIME:"IfcLagTime",IFCINDEXEDTRIANGLETEXTUREMAP:"IfcIndexedTriangleTextureMap",IFCINDEXEDTEXTUREMAP:"IfcIndexedTextureMap",IFCINDEXEDCOLOURMAP:"IfcIndexedColourMap",IFCEXTERNALREFERENCERELATIONSHIP:"IfcExternalReferenceRelationship",IFCEXTENDEDPROPERTIES:"IfcExtendedProperties",IFCEVENTTIME:"IfcEventTime",IFCCONVERSIONBASEDUNITWITHOFFSET:"IfcConversionBasedUnitWithOffset",IFCCOLOURRGBLIST:"IfcColourRgbList",IFCWORKTIME:"IfcWorkTime",IFCTIMEPERIOD:"IfcTimePeriod",IFCTEXTUREVERTEXLIST:"IfcTextureVertexList",IFCTASKTIMERECURRING:"IfcTaskTimeRecurring",IFCTASKTIME:"IfcTaskTime",IFCTABLECOLUMN:"IfcTableColumn",IFCSURFACEREINFORCEMENTAREA:"IfcSurfaceReinforcementArea",IFCSTRUCTURALLOADORRESULT:"IfcStructuralLoadOrResult",IFCSTRUCTURALLOADCONFIGURATION:"IfcStructuralLoadConfiguration",IFCSCHEDULINGTIME:"IfcSchedulingTime",IFCRESOURCELEVELRELATIONSHIP:"IfcResourceLevelRelationship",IFCREFERENCE:"IfcReference",IFCRECURRENCEPATTERN:"IfcRecurrencePattern",IFCPROPERTYABSTRACTION:"IfcPropertyAbstraction",IFCPROJECTEDCRS:"IfcProjectedCrs",IFCPRESENTATIONITEM:"IfcPresentationItem",IFCMATERIALUSAGEDEFINITION:"IfcMaterialUsageDefinition",IFCMATERIALPROFILEWITHOFFSETS:"IfcMaterialProfileWithOffsets",IFCMATERIALPROFILESET:"IfcMaterialProfileSet",IFCMATERIALPROFILE:"IfcMaterialProfile",IFCMATERIALLAYERWITHOFFSETS:"IfcMaterialLayerWithOffsets",IFCMATERIALDEFINITION:"IfcMaterialDefinition",IFCMAPCONVERSION:"IfcMapConversion",IFCEXTERNALINFORMATION:"IfcExternalInformation",IFCCOORDINATEREFERENCESYSTEM:"IfcCoordinateReferenceSystem",IFCCOORDINATEOPERATION:"IfcCoordinateOperation",IFCCONNECTIONVOLUMEGEOMETRY:"IfcConnectionVolumeGeometry",IFCREINFORCINGBAR:"IfcReinforcingBar",IFCELECTRICDISTRIBUTIONPOINT:"IfcElectricDistributionPoint",IFCDISTRIBUTIONCONTROLELEMENT:"IfcDistributionControlElement",IFCDISTRIBUTIONCHAMBERELEMENT:"IfcDistributionChamberElement",IFCCONTROLLERTYPE:"IfcControllerType",IFCCHAMFEREDGEFEATURE:"IfcChamferEdgeFeature",IFCBEAM:"IfcBeam",IFCALARMTYPE:"IfcAlarmType",IFCACTUATORTYPE:"IfcActuatorType",IFCWINDOW:"IfcWindow",IFCWALLSTANDARDCASE:"IfcWallStandardCase",IFCWALL:"IfcWall",IFCVIBRATIONISOLATORTYPE:"IfcVibrationIsolatorType",IFCTENDONANCHOR:"IfcTendonAnchor",IFCTENDON:"IfcTendon",IFCSTRUCTURALANALYSISMODEL:"IfcStructuralAnalysisModel",IFCSTAIRFLIGHT:"IfcStairFlight",IFCSTAIR:"IfcStair",IFCSLAB:"IfcSlab",IFCSENSORTYPE:"IfcSensorType",IFCROUNDEDEDGEFEATURE:"IfcRoundedEdgeFeature",IFCROOF:"IfcRoof",IFCREINFORCINGMESH:"IfcReinforcingMesh",IFCREINFORCINGELEMENT:"IfcReinforcingElement",IFCRATIONALBEZIERCURVE:"IfcRationalBezierCurve",IFCRAMPFLIGHT:"IfcRampFlight",IFCRAMP:"IfcRamp",IFCRAILING:"IfcRailing",IFCPLATE:"IfcPlate",IFCPILE:"IfcPile",IFCMEMBER:"IfcMember",IFCFOOTING:"IfcFooting",IFCFLOWTREATMENTDEVICE:"IfcFlowTreatmentDevice",IFCFLOWTERMINAL:"IfcFlowTerminal",IFCFLOWSTORAGEDEVICE:"IfcFlowStorageDevice",IFCFLOWSEGMENT:"IfcFlowSegment",IFCFLOWMOVINGDEVICE:"IfcFlowMovingDevice",IFCFLOWINSTRUMENTTYPE:"IfcFlowInstrumentType",IFCFLOWFITTING:"IfcFlowFitting",IFCFLOWCONTROLLER:"IfcFlowController",IFCFIRESUPPRESSIONTERMINALTYPE:"IfcFireSuppressionTerminalType",IFCFILTERTYPE:"IfcFilterType",IFCFANTYPE:"IfcFanType",IFCENERGYCONVERSIONDEVICE:"IfcEnergyConversionDevice",IFCELECTRICALELEMENT:"IfcElectricalElement",IFCELECTRICALCIRCUIT:"IfcElectricalCircuit",IFCELECTRICTIMECONTROLTYPE:"IfcElectricTimeControlType",IFCELECTRICMOTORTYPE:"IfcElectricMotorType",IFCELECTRICHEATERTYPE:"IfcElectricHeaterType",IFCELECTRICGENERATORTYPE:"IfcElectricGeneratorType",IFCELECTRICFLOWSTORAGEDEVICETYPE:"IfcElectricFlowStorageDeviceType",IFCELECTRICAPPLIANCETYPE:"IfcElectricApplianceType",IFCEDGEFEATURE:"IfcEdgeFeature",IFCDUCTSILENCERTYPE:"IfcDuctSilencerType",IFCDUCTSEGMENTTYPE:"IfcDuctSegmentType",IFCDUCTFITTINGTYPE:"IfcDuctFittingType",IFCDOOR:"IfcDoor",IFCDISTRIBUTIONPORT:"IfcDistributionPort",IFCDISTRIBUTIONFLOWELEMENT:"IfcDistributionFlowElement",IFCDISTRIBUTIONELEMENT:"IfcDistributionElement",IFCDISTRIBUTIONCONTROLELEMENTTYPE:"IfcDistributionControlElementType",IFCDISTRIBUTIONCHAMBERELEMENTTYPE:"IfcDistributionChamberElementType",IFCDISCRETEACCESSORYTYPE:"IfcDiscreteAccessoryType",IFCDISCRETEACCESSORY:"IfcDiscreteAccessory",IFCDIAMETERDIMENSION:"IfcDiameterDimension",IFCDAMPERTYPE:"IfcDamperType",IFCCURTAINWALL:"IfcCurtainWall",IFCCOVERING:"IfcCovering",IFCCOOLINGTOWERTYPE:"IfcCoolingTowerType",IFCCOOLEDBEAMTYPE:"IfcCooledBeamType",IFCCONSTRUCTIONPRODUCTRESOURCE:"IfcConstructionProductResource",IFCCONSTRUCTIONMATERIALRESOURCE:"IfcConstructionMaterialResource",IFCCONSTRUCTIONEQUIPMENTRESOURCE:"IfcConstructionEquipmentResource",IFCCONDITIONCRITERION:"IfcConditionCriterion",IFCCONDITION:"IfcCondition",IFCCONDENSERTYPE:"IfcCondenserType",IFCCOMPRESSORTYPE:"IfcCompressorType",IFCCOLUMN:"IfcColumn",IFCCOILTYPE:"IfcCoilType",IFCCIRCLE:"IfcCircle",IFCCHILLERTYPE:"IfcChillerType",IFCCABLESEGMENTTYPE:"IfcCableSegmentType",IFCCABLECARRIERSEGMENTTYPE:"IfcCableCarrierSegmentType",IFCCABLECARRIERFITTINGTYPE:"IfcCableCarrierFittingType",IFCBUILDINGELEMENTPROXYTYPE:"IfcBuildingElementProxyType",IFCBUILDINGELEMENTPROXY:"IfcBuildingElementProxy",IFCBUILDINGELEMENTPART:"IfcBuildingElementPart",IFCBUILDINGELEMENTCOMPONENT:"IfcBuildingElementComponent",IFCBUILDINGELEMENT:"IfcBuildingElement",IFCBOILERTYPE:"IfcBoilerType",IFCBEZIERCURVE:"IfcBezierCurve",IFCBEAMTYPE:"IfcBeamType",IFCBSPLINECURVE:"IfcBSplineCurve",IFCASSET:"IfcAsset",IFCANGULARDIMENSION:"IfcAngularDimension",IFCAIRTOAIRHEATRECOVERYTYPE:"IfcAirToAirHeatRecoveryType",IFCAIRTERMINALTYPE:"IfcAirTerminalType",IFCAIRTERMINALBOXTYPE:"IfcAirTerminalBoxType",IFCACTIONREQUEST:"IfcActionRequest",IFC2DCOMPOSITECURVE:"Ifc2DCompositeCurve",IFCZONE:"IfcZone",IFCWORKSCHEDULE:"IfcWorkSchedule",IFCWORKPLAN:"IfcWorkPlan",IFCWORKCONTROL:"IfcWorkControl",IFCWASTETERMINALTYPE:"IfcWasteTerminalType",IFCWALLTYPE:"IfcWallType",IFCVIRTUALELEMENT:"IfcVirtualElement",IFCVALVETYPE:"IfcValveType",IFCUNITARYEQUIPMENTTYPE:"IfcUnitaryEquipmentType",IFCTUBEBUNDLETYPE:"IfcTubeBundleType",IFCTRIMMEDCURVE:"IfcTrimmedCurve",IFCTRANSPORTELEMENT:"IfcTransportElement",IFCTRANSFORMERTYPE:"IfcTransformerType",IFCTIMESERIESSCHEDULE:"IfcTimeSeriesSchedule",IFCTANKTYPE:"IfcTankType",IFCSYSTEM:"IfcSystem",IFCSWITCHINGDEVICETYPE:"IfcSwitchingDeviceType",IFCSUBCONTRACTRESOURCE:"IfcSubContractResource",IFCSTRUCTURALSURFACECONNECTION:"IfcStructuralSurfaceConnection",IFCSTRUCTURALRESULTGROUP:"IfcStructuralResultGroup",IFCSTRUCTURALPOINTREACTION:"IfcStructuralPointReaction",IFCSTRUCTURALPOINTCONNECTION:"IfcStructuralPointConnection",IFCSTRUCTURALPOINTACTION:"IfcStructuralPointAction",IFCSTRUCTURALPLANARACTIONVARYING:"IfcStructuralPlanarActionVarying",IFCSTRUCTURALPLANARACTION:"IfcStructuralPlanarAction",IFCSTRUCTURALLOADGROUP:"IfcStructuralLoadGroup",IFCSTRUCTURALLINEARACTIONVARYING:"IfcStructuralLinearActionVarying",IFCSTRUCTURALLINEARACTION:"IfcStructuralLinearAction",IFCSTRUCTURALCURVEMEMBERVARYING:"IfcStructuralCurveMemberVarying",IFCSTRUCTURALCURVEMEMBER:"IfcStructuralCurveMember",IFCSTRUCTURALCURVECONNECTION:"IfcStructuralCurveConnection",IFCSTRUCTURALCONNECTION:"IfcStructuralConnection",IFCSTRUCTURALACTION:"IfcStructuralAction",IFCSTAIRFLIGHTTYPE:"IfcStairFlightType",IFCSTACKTERMINALTYPE:"IfcStackTerminalType",IFCSPACETYPE:"IfcSpaceType",IFCSPACEPROGRAM:"IfcSpaceProgram",IFCSPACEHEATERTYPE:"IfcSpaceHeaterType",IFCSPACE:"IfcSpace",IFCSLABTYPE:"IfcSlabType",IFCSITE:"IfcSite",IFCSERVICELIFE:"IfcServiceLife",IFCSCHEDULETIMECONTROL:"IfcScheduleTimeControl",IFCSANITARYTERMINALTYPE:"IfcSanitaryTerminalType",IFCRELASSIGNSTASKS:"IfcRelAssignsTasks",IFCRELAGGREGATES:"IfcRelAggregates",IFCRAMPFLIGHTTYPE:"IfcRampFlightType",IFCRAILINGTYPE:"IfcRailingType",IFCRADIUSDIMENSION:"IfcRadiusDimension",IFCPUMPTYPE:"IfcPumpType",IFCPROTECTIVEDEVICETYPE:"IfcProtectiveDeviceType",IFCPROJECTIONELEMENT:"IfcProjectionElement",IFCPROJECTORDERRECORD:"IfcProjectOrderRecord",IFCPROJECTORDER:"IfcProjectOrder",IFCPROCEDURE:"IfcProcedure",IFCPORT:"IfcPort",IFCPOLYLINE:"IfcPolyline",IFCPLATETYPE:"IfcPlateType",IFCPIPESEGMENTTYPE:"IfcPipeSegmentType",IFCPIPEFITTINGTYPE:"IfcPipeFittingType",IFCPERMIT:"IfcPermit",IFCPERFORMANCEHISTORY:"IfcPerformanceHistory",IFCOUTLETTYPE:"IfcOutletType",IFCORDERACTION:"IfcOrderAction",IFCOPENINGELEMENT:"IfcOpeningElement",IFCOCCUPANT:"IfcOccupant",IFCMOVE:"IfcMove",IFCMOTORCONNECTIONTYPE:"IfcMotorConnectionType",IFCMEMBERTYPE:"IfcMemberType",IFCMECHANICALFASTENERTYPE:"IfcMechanicalFastenerType",IFCMECHANICALFASTENER:"IfcMechanicalFastener",IFCLINEARDIMENSION:"IfcLinearDimension",IFCLIGHTFIXTURETYPE:"IfcLightFixtureType",IFCLAMPTYPE:"IfcLampType",IFCLABORRESOURCE:"IfcLaborResource",IFCJUNCTIONBOXTYPE:"IfcJunctionBoxType",IFCINVENTORY:"IfcInventory",IFCHUMIDIFIERTYPE:"IfcHumidifierType",IFCHEATEXCHANGERTYPE:"IfcHeatExchangerType",IFCGROUP:"IfcGroup",IFCGRID:"IfcGrid",IFCGASTERMINALTYPE:"IfcGasTerminalType",IFCFURNITURESTANDARD:"IfcFurnitureStandard",IFCFURNISHINGELEMENT:"IfcFurnishingElement",IFCFLOWTREATMENTDEVICETYPE:"IfcFlowTreatmentDeviceType",IFCFLOWTERMINALTYPE:"IfcFlowTerminalType",IFCFLOWSTORAGEDEVICETYPE:"IfcFlowStorageDeviceType",IFCFLOWSEGMENTTYPE:"IfcFlowSegmentType",IFCFLOWMOVINGDEVICETYPE:"IfcFlowMovingDeviceType",IFCFLOWMETERTYPE:"IfcFlowMeterType",IFCFLOWFITTINGTYPE:"IfcFlowFittingType",IFCFLOWCONTROLLERTYPE:"IfcFlowControllerType",IFCFEATUREELEMENTSUBTRACTION:"IfcFeatureElementSubtraction",IFCFEATUREELEMENTADDITION:"IfcFeatureElementAddition",IFCFEATUREELEMENT:"IfcFeatureElement",IFCFASTENERTYPE:"IfcFastenerType",IFCFASTENER:"IfcFastener",IFCFACETEDBREPWITHVOIDS:"IfcFacetedBrepWithVoids",IFCFACETEDBREP:"IfcFacetedBrep",IFCEVAPORATORTYPE:"IfcEvaporatorType",IFCEVAPORATIVECOOLERTYPE:"IfcEvaporativeCoolerType",IFCEQUIPMENTSTANDARD:"IfcEquipmentStandard",IFCEQUIPMENTELEMENT:"IfcEquipmentElement",IFCENERGYCONVERSIONDEVICETYPE:"IfcEnergyConversionDeviceType",IFCELLIPSE:"IfcEllipse",IFCELEMENTCOMPONENTTYPE:"IfcElementComponentType",IFCELEMENTCOMPONENT:"IfcElementComponent",IFCELEMENTASSEMBLY:"IfcElementAssembly",IFCELEMENT:"IfcElement",IFCELECTRICALBASEPROPERTIES:"IfcElectricalBaseProperties",IFCDISTRIBUTIONFLOWELEMENTTYPE:"IfcDistributionFlowElementType",IFCDISTRIBUTIONELEMENTTYPE:"IfcDistributionElementType",IFCDIMENSIONCURVEDIRECTEDCALLOUT:"IfcDimensionCurveDirectedCallout",IFCCURTAINWALLTYPE:"IfcCurtainWallType",IFCCREWRESOURCE:"IfcCrewResource",IFCCOVERINGTYPE:"IfcCoveringType",IFCCOSTSCHEDULE:"IfcCostSchedule",IFCCOSTITEM:"IfcCostItem",IFCCONTROL:"IfcControl",IFCCONSTRUCTIONRESOURCE:"IfcConstructionResource",IFCCONIC:"IfcConic",IFCCOMPOSITECURVE:"IfcCompositeCurve",IFCCOLUMNTYPE:"IfcColumnType",IFCCIRCLEHOLLOWPROFILEDEF:"IfcCircleHollowProfileDef",IFCBUILDINGSTOREY:"IfcBuildingStorey",IFCBUILDINGELEMENTTYPE:"IfcBuildingElementType",IFCBUILDING:"IfcBuilding",IFCBOUNDEDCURVE:"IfcBoundedCurve",IFCBOOLEANCLIPPINGRESULT:"IfcBooleanClippingResult",IFCBLOCK:"IfcBlock",IFCASYMMETRICISHAPEPROFILEDEF:"IfcAsymmetricIShapeProfileDef",IFCANNOTATION:"IfcAnnotation",IFCACTOR:"IfcActor",IFCTRANSPORTELEMENTTYPE:"IfcTransportElementType",IFCTASK:"IfcTask",IFCSYSTEMFURNITUREELEMENTTYPE:"IfcSystemFurnitureElementType",IFCSURFACEOFREVOLUTION:"IfcSurfaceOfRevolution",IFCSURFACEOFLINEAREXTRUSION:"IfcSurfaceOfLinearExtrusion",IFCSURFACECURVESWEPTAREASOLID:"IfcSurfaceCurveSweptAreaSolid",IFCSTRUCTUREDDIMENSIONCALLOUT:"IfcStructuredDimensionCallout",IFCSTRUCTURALSURFACEMEMBERVARYING:"IfcStructuralSurfaceMemberVarying",IFCSTRUCTURALSURFACEMEMBER:"IfcStructuralSurfaceMember",IFCSTRUCTURALREACTION:"IfcStructuralReaction",IFCSTRUCTURALMEMBER:"IfcStructuralMember",IFCSTRUCTURALITEM:"IfcStructuralItem",IFCSTRUCTURALACTIVITY:"IfcStructuralActivity",IFCSPHERE:"IfcSphere",IFCSPATIALSTRUCTUREELEMENTTYPE:"IfcSpatialStructureElementType",IFCSPATIALSTRUCTUREELEMENT:"IfcSpatialStructureElement",IFCRIGHTCIRCULARCYLINDER:"IfcRightCircularCylinder",IFCRIGHTCIRCULARCONE:"IfcRightCircularCone",IFCREVOLVEDAREASOLID:"IfcRevolvedAreaSolid",IFCRESOURCE:"IfcResource",IFCRELVOIDSELEMENT:"IfcRelVoidsElement",IFCRELSPACEBOUNDARY:"IfcRelSpaceBoundary",IFCRELSERVICESBUILDINGS:"IfcRelServicesBuildings",IFCRELSEQUENCE:"IfcRelSequence",IFCRELSCHEDULESCOSTITEMS:"IfcRelSchedulesCostItems",IFCRELREFERENCEDINSPATIALSTRUCTURE:"IfcRelReferencedInSpatialStructure",IFCRELPROJECTSELEMENT:"IfcRelProjectsElement",IFCRELOVERRIDESPROPERTIES:"IfcRelOverridesProperties",IFCRELOCCUPIESSPACES:"IfcRelOccupiesSpaces",IFCRELNESTS:"IfcRelNests",IFCRELINTERACTIONREQUIREMENTS:"IfcRelInteractionRequirements",IFCRELFLOWCONTROLELEMENTS:"IfcRelFlowControlElements",IFCRELFILLSELEMENT:"IfcRelFillsElement",IFCRELDEFINESBYTYPE:"IfcRelDefinesByType",IFCRELDEFINESBYPROPERTIES:"IfcRelDefinesByProperties",IFCRELDEFINES:"IfcRelDefines",IFCRELDECOMPOSES:"IfcRelDecomposes",IFCRELCOVERSSPACES:"IfcRelCoversSpaces",IFCRELCOVERSBLDGELEMENTS:"IfcRelCoversBldgElements",IFCRELCONTAINEDINSPATIALSTRUCTURE:"IfcRelContainedInSpatialStructure",IFCRELCONNECTSWITHREALIZINGELEMENTS:"IfcRelConnectsWithRealizingElements",IFCRELCONNECTSWITHECCENTRICITY:"IfcRelConnectsWithEccentricity",IFCRELCONNECTSSTRUCTURALMEMBER:"IfcRelConnectsStructuralMember",IFCRELCONNECTSSTRUCTURALELEMENT:"IfcRelConnectsStructuralElement",IFCRELCONNECTSSTRUCTURALACTIVITY:"IfcRelConnectsStructuralActivity",IFCRELCONNECTSPORTS:"IfcRelConnectsPorts",IFCRELCONNECTSPORTTOELEMENT:"IfcRelConnectsPortToElement",IFCRELCONNECTSPATHELEMENTS:"IfcRelConnectsPathElements",IFCRELCONNECTSELEMENTS:"IfcRelConnectsElements",IFCRELCONNECTS:"IfcRelConnects",IFCRELASSOCIATESPROFILEPROPERTIES:"IfcRelAssociatesProfileProperties",IFCRELASSOCIATESMATERIAL:"IfcRelAssociatesMaterial",IFCRELASSOCIATESLIBRARY:"IfcRelAssociatesLibrary",IFCRELASSOCIATESDOCUMENT:"IfcRelAssociatesDocument",IFCRELASSOCIATESCONSTRAINT:"IfcRelAssociatesConstraint",IFCRELASSOCIATESCLASSIFICATION:"IfcRelAssociatesClassification",IFCRELASSOCIATESAPPROVAL:"IfcRelAssociatesApproval",IFCRELASSOCIATESAPPLIEDVALUE:"IfcRelAssociatesAppliedValue",IFCRELASSOCIATES:"IfcRelAssociates",IFCRELASSIGNSTORESOURCE:"IfcRelAssignsToResource",IFCRELASSIGNSTOPROJECTORDER:"IfcRelAssignsToProjectOrder",IFCRELASSIGNSTOPRODUCT:"IfcRelAssignsToProduct",IFCRELASSIGNSTOPROCESS:"IfcRelAssignsToProcess",IFCRELASSIGNSTOGROUP:"IfcRelAssignsToGroup",IFCRELASSIGNSTOCONTROL:"IfcRelAssignsToControl",IFCRELASSIGNSTOACTOR:"IfcRelAssignsToActor",IFCRELASSIGNS:"IfcRelAssigns",IFCRECTANGULARTRIMMEDSURFACE:"IfcRectangularTrimmedSurface",IFCRECTANGULARPYRAMID:"IfcRectangularPyramid",IFCRECTANGLEHOLLOWPROFILEDEF:"IfcRectangleHollowProfileDef",IFCPROXY:"IfcProxy",IFCPROPERTYSET:"IfcPropertySet",IFCPROJECTIONCURVE:"IfcProjectionCurve",IFCPROJECT:"IfcProject",IFCPRODUCT:"IfcProduct",IFCPROCESS:"IfcProcess",IFCPLANE:"IfcPlane",IFCPLANARBOX:"IfcPlanarBox",IFCPERMEABLECOVERINGPROPERTIES:"IfcPermeableCoveringProperties",IFCOFFSETCURVE3D:"IfcOffsetCurve3D",IFCOFFSETCURVE2D:"IfcOffsetCurve2D",IFCOBJECT:"IfcObject",IFCMANIFOLDSOLIDBREP:"IfcManifoldSolidBrep",IFCLINE:"IfcLine",IFCLSHAPEPROFILEDEF:"IfcLShapeProfileDef",IFCISHAPEPROFILEDEF:"IfcIShapeProfileDef",IFCGEOMETRICCURVESET:"IfcGeometricCurveSet",IFCFURNITURETYPE:"IfcFurnitureType",IFCFURNISHINGELEMENTTYPE:"IfcFurnishingElementType",IFCFLUIDFLOWPROPERTIES:"IfcFluidFlowProperties",IFCFILLAREASTYLETILES:"IfcFillAreaStyleTiles",IFCFILLAREASTYLETILESYMBOLWITHSTYLE:"IfcFillAreaStyleTileSymbolWithStyle",IFCFILLAREASTYLEHATCHING:"IfcFillAreaStyleHatching",IFCFACEBASEDSURFACEMODEL:"IfcFaceBasedSurfaceModel",IFCEXTRUDEDAREASOLID:"IfcExtrudedAreaSolid",IFCENERGYPROPERTIES:"IfcEnergyProperties",IFCELLIPSEPROFILEDEF:"IfcEllipseProfileDef",IFCELEMENTARYSURFACE:"IfcElementarySurface",IFCELEMENTTYPE:"IfcElementType",IFCELEMENTQUANTITY:"IfcElementQuantity",IFCEDGELOOP:"IfcEdgeLoop",IFCDRAUGHTINGPREDEFINEDCURVEFONT:"IfcDraughtingPredefinedCurveFont",IFCDRAUGHTINGPREDEFINEDCOLOUR:"IfcDraughtingPredefinedColour",IFCDRAUGHTINGCALLOUT:"IfcDraughtingCallout",IFCDOORSTYLE:"IfcDoorStyle",IFCDOORPANELPROPERTIES:"IfcDoorPanelProperties",IFCDOORLININGPROPERTIES:"IfcDoorLiningProperties",IFCDIRECTION:"IfcDirection",IFCDIMENSIONCURVETERMINATOR:"IfcDimensionCurveTerminator",IFCDIMENSIONCURVE:"IfcDimensionCurve",IFCDEFINEDSYMBOL:"IfcDefinedSymbol",IFCCURVEBOUNDEDPLANE:"IfcCurveBoundedPlane",IFCCURVE:"IfcCurve",IFCCSGSOLID:"IfcCsgSolid",IFCCSGPRIMITIVE3D:"IfcCsgPrimitive3D",IFCCRANERAILFSHAPEPROFILEDEF:"IfcCraneRailFShapeProfileDef",IFCCRANERAILASHAPEPROFILEDEF:"IfcCraneRailAShapeProfileDef",IFCCOMPOSITECURVESEGMENT:"IfcCompositeCurveSegment",IFCCLOSEDSHELL:"IfcClosedShell",IFCCIRCLEPROFILEDEF:"IfcCircleProfileDef",IFCCARTESIANTRANSFORMATIONOPERATOR3DNONUNIFORM:"IfcCartesianTransformationOperator3DNonUniform",IFCCARTESIANTRANSFORMATIONOPERATOR3D:"IfcCartesianTransformationOperator3D",IFCCARTESIANTRANSFORMATIONOPERATOR2DNONUNIFORM:"IfcCartesianTransformationOperator2DNonUniform",IFCCARTESIANTRANSFORMATIONOPERATOR2D:"IfcCartesianTransformationOperator2D",IFCCARTESIANTRANSFORMATIONOPERATOR:"IfcCartesianTransformationOperator",IFCCARTESIANPOINT:"IfcCartesianPoint",IFCCSHAPEPROFILEDEF:"IfcCShapeProfileDef",IFCBOXEDHALFSPACE:"IfcBoxedHalfSpace",IFCBOUNDINGBOX:"IfcBoundingBox",IFCBOUNDEDSURFACE:"IfcBoundedSurface",IFCBOOLEANRESULT:"IfcBooleanResult",IFCAXIS2PLACEMENT3D:"IfcAxis2Placement3D",IFCAXIS2PLACEMENT2D:"IfcAxis2Placement2D",IFCAXIS1PLACEMENT:"IfcAxis1Placement",IFCANNOTATIONSURFACE:"IfcAnnotationSurface",IFCANNOTATIONFILLAREAOCCURRENCE:"IfcAnnotationFillAreaOccurrence",IFCANNOTATIONFILLAREA:"IfcAnnotationFillArea",IFCANNOTATIONCURVEOCCURRENCE:"IfcAnnotationCurveOccurrence",IFCZSHAPEPROFILEDEF:"IfcZShapeProfileDef",IFCWINDOWSTYLE:"IfcWindowStyle",IFCWINDOWPANELPROPERTIES:"IfcWindowPanelProperties",IFCWINDOWLININGPROPERTIES:"IfcWindowLiningProperties",IFCVERTEXLOOP:"IfcVertexLoop",IFCVECTOR:"IfcVector",IFCUSHAPEPROFILEDEF:"IfcUShapeProfileDef",IFCTYPEPRODUCT:"IfcTypeProduct",IFCTYPEOBJECT:"IfcTypeObject",IFCTWODIRECTIONREPEATFACTOR:"IfcTwoDirectionRepeatFactor",IFCTRAPEZIUMPROFILEDEF:"IfcTrapeziumProfileDef",IFCTEXTLITERALWITHEXTENT:"IfcTextLiteralWithExtent",IFCTEXTLITERAL:"IfcTextLiteral",IFCTERMINATORSYMBOL:"IfcTerminatorSymbol",IFCTSHAPEPROFILEDEF:"IfcTShapeProfileDef",IFCSWEPTSURFACE:"IfcSweptSurface",IFCSWEPTDISKSOLID:"IfcSweptDiskSolid",IFCSWEPTAREASOLID:"IfcSweptAreaSolid",IFCSURFACESTYLERENDERING:"IfcSurfaceStyleRendering",IFCSURFACE:"IfcSurface",IFCSUBEDGE:"IfcSubedge",IFCSTRUCTURALSTEELPROFILEPROPERTIES:"IfcStructuralSteelProfileProperties",IFCSTRUCTURALPROFILEPROPERTIES:"IfcStructuralProfileProperties",IFCSTRUCTURALLOADSINGLEFORCEWARPING:"IfcStructuralLoadSingleForceWarping",IFCSTRUCTURALLOADSINGLEFORCE:"IfcStructuralLoadSingleForce",IFCSTRUCTURALLOADSINGLEDISPLACEMENTDISTORTION:"IfcStructuralLoadSingleDisplacementDistortion",IFCSTRUCTURALLOADSINGLEDISPLACEMENT:"IfcStructuralLoadSingleDisplacement",IFCSTRUCTURALLOADPLANARFORCE:"IfcStructuralLoadPlanarForce",IFCSTRUCTURALLOADLINEARFORCE:"IfcStructuralLoadLinearForce",IFCSPACETHERMALLOADPROPERTIES:"IfcSpaceThermalLoadProperties",IFCSOUNDVALUE:"IfcSoundValue",IFCSOUNDPROPERTIES:"IfcSoundProperties",IFCSOLIDMODEL:"IfcSolidModel",IFCSLIPPAGECONNECTIONCONDITION:"IfcSlippageConnectionCondition",IFCSHELLBASEDSURFACEMODEL:"IfcShellBasedSurfaceModel",IFCSERVICELIFEFACTOR:"IfcServiceLifeFactor",IFCSECTIONEDSPINE:"IfcSectionedSpine",IFCROUNDEDRECTANGLEPROFILEDEF:"IfcRoundedRectangleProfileDef",IFCRELATIONSHIP:"IfcRelationship",IFCREINFORCEMENTDEFINITIONPROPERTIES:"IfcReinforcementDefinitionProperties",IFCREGULARTIMESERIES:"IfcRegularTimeSeries",IFCRECTANGLEPROFILEDEF:"IfcRectangleProfileDef",IFCPROPERTYTABLEVALUE:"IfcPropertyTableValue",IFCPROPERTYSINGLEVALUE:"IfcPropertySingleValue",IFCPROPERTYSETDEFINITION:"IfcPropertySetDefinition",IFCPROPERTYREFERENCEVALUE:"IfcPropertyReferenceValue",IFCPROPERTYLISTVALUE:"IfcPropertyListValue",IFCPROPERTYENUMERATEDVALUE:"IfcPropertyEnumeratedValue",IFCPROPERTYDEFINITION:"IfcPropertyDefinition",IFCPROPERTYBOUNDEDVALUE:"IfcPropertyBoundedValue",IFCPRODUCTDEFINITIONSHAPE:"IfcProductDefinitionShape",IFCPREDEFINEDPOINTMARKERSYMBOL:"IfcPredefinedPointMarkerSymbol",IFCPREDEFINEDDIMENSIONSYMBOL:"IfcPredefinedDimensionSymbol",IFCPREDEFINEDCURVEFONT:"IfcPredefinedCurveFont",IFCPREDEFINEDCOLOUR:"IfcPredefinedColour",IFCPOLYGONALBOUNDEDHALFSPACE:"IfcPolygonalBoundedHalfSpace",IFCPOLYLOOP:"IfcPolyLoop",IFCPOINTONSURFACE:"IfcPointOnSurface",IFCPOINTONCURVE:"IfcPointOnCurve",IFCPOINT:"IfcPoint",IFCPLANAREXTENT:"IfcPlanarExtent",IFCPLACEMENT:"IfcPlacement",IFCPIXELTEXTURE:"IfcPixelTexture",IFCPHYSICALCOMPLEXQUANTITY:"IfcPhysicalComplexQuantity",IFCPATH:"IfcPath",IFCPARAMETERIZEDPROFILEDEF:"IfcParameterizedProfileDef",IFCORIENTEDEDGE:"IfcOrientedEdge",IFCOPENSHELL:"IfcOpenShell",IFCONEDIRECTIONREPEATFACTOR:"IfcOneDirectionRepeatFactor",IFCOBJECTDEFINITION:"IfcObjectDefinition",IFCMECHANICALCONCRETEMATERIALPROPERTIES:"IfcMechanicalConcreteMaterialProperties",IFCMATERIALDEFINITIONREPRESENTATION:"IfcMaterialDefinitionRepresentation",IFCMAPPEDITEM:"IfcMappedItem",IFCLOOP:"IfcLoop",IFCLOCALPLACEMENT:"IfcLocalPlacement",IFCLIGHTSOURCESPOT:"IfcLightSourceSpot",IFCLIGHTSOURCEPOSITIONAL:"IfcLightSourcePositional",IFCLIGHTSOURCEGONIOMETRIC:"IfcLightSourceGoniometric",IFCLIGHTSOURCEDIRECTIONAL:"IfcLightSourceDirectional",IFCLIGHTSOURCEAMBIENT:"IfcLightSourceAmbient",IFCLIGHTSOURCE:"IfcLightSource",IFCIRREGULARTIMESERIES:"IfcIrregularTimeSeries",IFCIMAGETEXTURE:"IfcImageTexture",IFCHYGROSCOPICMATERIALPROPERTIES:"IfcHygroscopicMaterialProperties",IFCHALFSPACESOLID:"IfcHalfSpaceSolid",IFCGRIDPLACEMENT:"IfcGridPlacement",IFCGEOMETRICSET:"IfcGeometricSet",IFCGEOMETRICREPRESENTATIONSUBCONTEXT:"IfcGeometricRepresentationSubContext",IFCGEOMETRICREPRESENTATIONITEM:"IfcGeometricRepresentationItem",IFCGEOMETRICREPRESENTATIONCONTEXT:"IfcGeometricRepresentationContext",IFCGENERALPROFILEPROPERTIES:"IfcGeneralProfileProperties",IFCGENERALMATERIALPROPERTIES:"IfcGeneralMaterialProperties",IFCFUELPROPERTIES:"IfcFuelProperties",IFCFILLAREASTYLE:"IfcFillAreaStyle",IFCFAILURECONNECTIONCONDITION:"IfcFailureConnectionCondition",IFCFACESURFACE:"IfcFaceSurface",IFCFACEOUTERBOUND:"IfcFaceOuterBound",IFCFACEBOUND:"IfcFaceBound",IFCFACE:"IfcFace",IFCEXTENDEDMATERIALPROPERTIES:"IfcExtendedMaterialProperties",IFCEDGECURVE:"IfcEdgeCurve",IFCEDGE:"IfcEdge",IFCDRAUGHTINGPREDEFINEDTEXTFONT:"IfcDraughtingPredefinedTextFont",IFCDOCUMENTREFERENCE:"IfcDocumentReference",IFCDIMENSIONPAIR:"IfcDimensionPair",IFCDIMENSIONCALLOUTRELATIONSHIP:"IfcDimensionCalloutRelationship",IFCDERIVEDPROFILEDEF:"IfcDerivedProfileDef",IFCCURVESTYLE:"IfcCurveStyle",IFCCONVERSIONBASEDUNIT:"IfcConversionBasedUnit",IFCCONTEXTDEPENDENTUNIT:"IfcContextDependentUnit",IFCCONNECTIONPOINTECCENTRICITY:"IfcConnectionPointEccentricity",IFCCONNECTIONCURVEGEOMETRY:"IfcConnectionCurveGeometry",IFCCONNECTEDFACESET:"IfcConnectedFaceSet",IFCCOMPOSITEPROFILEDEF:"IfcCompositeProfileDef",IFCCOMPLEXPROPERTY:"IfcComplexProperty",IFCCOLOURRGB:"IfcColourRgb",IFCCLASSIFICATIONREFERENCE:"IfcClassificationReference",IFCCENTERLINEPROFILEDEF:"IfcCenterLineProfileDef",IFCBLOBTEXTURE:"IfcBlobTexture",IFCARBITRARYPROFILEDEFWITHVOIDS:"IfcArbitraryProfileDefWithVoids",IFCARBITRARYOPENPROFILEDEF:"IfcArbitraryOpenProfileDef",IFCARBITRARYCLOSEDPROFILEDEF:"IfcArbitraryClosedProfileDef",IFCANNOTATIONTEXTOCCURRENCE:"IfcAnnotationTextOccurrence",IFCANNOTATIONSYMBOLOCCURRENCE:"IfcAnnotationSymbolOccurrence",IFCANNOTATIONSURFACEOCCURRENCE:"IfcAnnotationSurfaceOccurrence",IFCANNOTATIONOCCURRENCE:"IfcAnnotationOccurrence",IFCWATERPROPERTIES:"IfcWaterProperties",IFCVIRTUALGRIDINTERSECTION:"IfcVirtualGridIntersection",IFCVERTEXPOINT:"IfcVertexPoint",IFCVERTEXBASEDTEXTUREMAP:"IfcVertexBasedTextureMap",IFCVERTEX:"IfcVertex",IFCUNITASSIGNMENT:"IfcUnitAssignment",IFCTOPOLOGYREPRESENTATION:"IfcTopologyRepresentation",IFCTOPOLOGICALREPRESENTATIONITEM:"IfcTopologicalRepresentationItem",IFCTIMESERIESVALUE:"IfcTimeSeriesValue",IFCTIMESERIESREFERENCERELATIONSHIP:"IfcTimeSeriesReferenceRelationship",IFCTIMESERIES:"IfcTimeSeries",IFCTHERMALMATERIALPROPERTIES:"IfcThermalMaterialProperties",IFCTEXTUREVERTEX:"IfcTextureVertex",IFCTEXTUREMAP:"IfcTextureMap",IFCTEXTURECOORDINATEGENERATOR:"IfcTextureCoordinateGenerator",IFCTEXTURECOORDINATE:"IfcTextureCoordinate",IFCTEXTSTYLEWITHBOXCHARACTERISTICS:"IfcTextStyleWithBoxCharacteristics",IFCTEXTSTYLETEXTMODEL:"IfcTextStyleTextModel",IFCTEXTSTYLEFORDEFINEDFONT:"IfcTextStyleForDefinedFont",IFCTEXTSTYLEFONTMODEL:"IfcTextStyleFontModel",IFCTEXTSTYLE:"IfcTextStyle",IFCTELECOMADDRESS:"IfcTelecomAddress",IFCTABLEROW:"IfcTableRow",IFCTABLE:"IfcTable",IFCSYMBOLSTYLE:"IfcSymbolStyle",IFCSURFACETEXTURE:"IfcSurfaceTexture",IFCSURFACESTYLEWITHTEXTURES:"IfcSurfaceStyleWithTextures",IFCSURFACESTYLESHADING:"IfcSurfaceStyleShading",IFCSURFACESTYLEREFRACTION:"IfcSurfaceStyleRefraction",IFCSURFACESTYLELIGHTING:"IfcSurfaceStyleLighting",IFCSURFACESTYLE:"IfcSurfaceStyle",IFCSTYLEDREPRESENTATION:"IfcStyledRepresentation",IFCSTYLEDITEM:"IfcStyledItem",IFCSTYLEMODEL:"IfcStyleModel",IFCSTRUCTURALLOADTEMPERATURE:"IfcStructuralLoadTemperature",IFCSTRUCTURALLOADSTATIC:"IfcStructuralLoadStatic",IFCSTRUCTURALLOAD:"IfcStructuralLoad",IFCSTRUCTURALCONNECTIONCONDITION:"IfcStructuralConnectionCondition",IFCSIMPLEPROPERTY:"IfcSimpleProperty",IFCSHAPEREPRESENTATION:"IfcShapeRepresentation",IFCSHAPEMODEL:"IfcShapeModel",IFCSHAPEASPECT:"IfcShapeAspect",IFCSECTIONREINFORCEMENTPROPERTIES:"IfcSectionReinforcementProperties",IFCSECTIONPROPERTIES:"IfcSectionProperties",IFCSIUNIT:"IfcSIUnit",IFCROOT:"IfcRoot",IFCRIBPLATEPROFILEPROPERTIES:"IfcRibPlateProfileProperties",IFCREPRESENTATIONMAP:"IfcRepresentationMap",IFCREPRESENTATIONITEM:"IfcRepresentationItem",IFCREPRESENTATIONCONTEXT:"IfcRepresentationContext",IFCREPRESENTATION:"IfcRepresentation",IFCRELAXATION:"IfcRelaxation",IFCREINFORCEMENTBARPROPERTIES:"IfcReinforcementBarProperties",IFCREFERENCESVALUEDOCUMENT:"IfcReferencesValueDocument",IFCQUANTITYWEIGHT:"IfcQuantityWeight",IFCQUANTITYVOLUME:"IfcQuantityVolume",IFCQUANTITYTIME:"IfcQuantityTime",IFCQUANTITYLENGTH:"IfcQuantityLength",IFCQUANTITYCOUNT:"IfcQuantityCount",IFCQUANTITYAREA:"IfcQuantityArea",IFCPROPERTYENUMERATION:"IfcPropertyEnumeration",IFCPROPERTYDEPENDENCYRELATIONSHIP:"IfcPropertyDependencyRelationship",IFCPROPERTYCONSTRAINTRELATIONSHIP:"IfcPropertyConstraintRelationship",IFCPROPERTY:"IfcProperty",IFCPROFILEPROPERTIES:"IfcProfileProperties",IFCPROFILEDEF:"IfcProfileDef",IFCPRODUCTSOFCOMBUSTIONPROPERTIES:"IfcProductsOfCombustionProperties",IFCPRODUCTREPRESENTATION:"IfcProductRepresentation",IFCPRESENTATIONSTYLEASSIGNMENT:"IfcPresentationStyleAssignment",IFCPRESENTATIONSTYLE:"IfcPresentationStyle",IFCPRESENTATIONLAYERWITHSTYLE:"IfcPresentationLayerWithStyle",IFCPRESENTATIONLAYERASSIGNMENT:"IfcPresentationLayerAssignment",IFCPREDEFINEDTEXTFONT:"IfcPredefinedTextFont",IFCPREDEFINEDTERMINATORSYMBOL:"IfcPredefinedTerminatorSymbol",IFCPREDEFINEDSYMBOL:"IfcPredefinedSymbol",IFCPREDEFINEDITEM:"IfcPredefinedItem",IFCPOSTALADDRESS:"IfcPostalAddress",IFCPHYSICALSIMPLEQUANTITY:"IfcPhysicalSimpleQuantity",IFCPHYSICALQUANTITY:"IfcPhysicalQuantity",IFCPERSONANDORGANIZATION:"IfcPersonAndOrganization",IFCPERSON:"IfcPerson",IFCOWNERHISTORY:"IfcOwnerHistory",IFCORGANIZATIONRELATIONSHIP:"IfcOrganizationRelationship",IFCORGANIZATION:"IfcOrganization",IFCOPTICALMATERIALPROPERTIES:"IfcOpticalMaterialProperties",IFCOBJECTIVE:"IfcObjective",IFCOBJECTPLACEMENT:"IfcObjectPlacement",IFCNAMEDUNIT:"IfcNamedUnit",IFCMONETARYUNIT:"IfcMonetaryUnit",IFCMETRIC:"IfcMetric",IFCMECHANICALSTEELMATERIALPROPERTIES:"IfcMechanicalSteelMaterialProperties",IFCMECHANICALMATERIALPROPERTIES:"IfcMechanicalMaterialProperties",IFCMEASUREWITHUNIT:"IfcMeasureWithUnit",IFCMATERIALPROPERTIES:"IfcMaterialProperties",IFCMATERIALLIST:"IfcMaterialList",IFCMATERIALLAYERSETUSAGE:"IfcMaterialLayerSetUsage",IFCMATERIALLAYERSET:"IfcMaterialLayerSet",IFCMATERIALLAYER:"IfcMaterialLayer",IFCMATERIALCLASSIFICATIONRELATIONSHIP:"IfcMaterialClassificationRelationship",IFCMATERIAL:"IfcMaterial",IFCLOCALTIME:"IfcLocalTime",IFCLIGHTINTENSITYDISTRIBUTION:"IfcLightIntensityDistribution",IFCLIGHTDISTRIBUTIONDATA:"IfcLightDistributionData",IFCLIBRARYREFERENCE:"IfcLibraryReference",IFCLIBRARYINFORMATION:"IfcLibraryInformation",IFCIRREGULARTIMESERIESVALUE:"IfcIrregularTimeSeriesValue",IFCGRIDAXIS:"IfcGridAxis",IFCEXTERNALLYDEFINEDTEXTFONT:"IfcExternallyDefinedTextFont",IFCEXTERNALLYDEFINEDSYMBOL:"IfcExternallyDefinedSymbol",IFCEXTERNALLYDEFINEDSURFACESTYLE:"IfcExternallyDefinedSurfaceStyle",IFCEXTERNALLYDEFINEDHATCHSTYLE:"IfcExternallyDefinedHatchStyle",IFCEXTERNALREFERENCE:"IfcExternalReference",IFCENVIRONMENTALIMPACTVALUE:"IfcEnvironmentalImpactValue",IFCDRAUGHTINGCALLOUTRELATIONSHIP:"IfcDraughtingCalloutRelationship",IFCDOCUMENTINFORMATIONRELATIONSHIP:"IfcDocumentInformationRelationship",IFCDOCUMENTINFORMATION:"IfcDocumentInformation",IFCDOCUMENTELECTRONICFORMAT:"IfcDocumentElectronicFormat",IFCDIMENSIONALEXPONENTS:"IfcDimensionalExponents",IFCDERIVEDUNITELEMENT:"IfcDerivedUnitElement",IFCDERIVEDUNIT:"IfcDerivedUnit",IFCDATEANDTIME:"IfcDateAndTime",IFCCURVESTYLEFONTPATTERN:"IfcCurveStyleFontPattern",IFCCURVESTYLEFONTANDSCALING:"IfcCurveStyleFontAndScaling",IFCCURVESTYLEFONT:"IfcCurveStyleFont",IFCCURRENCYRELATIONSHIP:"IfcCurrencyRelationship",IFCCOSTVALUE:"IfcCostValue",IFCCOORDINATEDUNIVERSALTIMEOFFSET:"IfcCoordinatedUniversalTimeOffset",IFCCONSTRAINTRELATIONSHIP:"IfcConstraintRelationship",IFCCONSTRAINTCLASSIFICATIONRELATIONSHIP:"IfcConstraintClassificationRelationship",IFCCONSTRAINTAGGREGATIONRELATIONSHIP:"IfcConstraintAggregationRelationship",IFCCONSTRAINT:"IfcConstraint",IFCCONNECTIONSURFACEGEOMETRY:"IfcConnectionSurfaceGeometry",IFCCONNECTIONPORTGEOMETRY:"IfcConnectionPortGeometry",IFCCONNECTIONPOINTGEOMETRY:"IfcConnectionPointGeometry",IFCCONNECTIONGEOMETRY:"IfcConnectionGeometry",IFCCOLOURSPECIFICATION:"IfcColourSpecification",IFCCLASSIFICATIONNOTATIONFACET:"IfcClassificationNotationFacet",IFCCLASSIFICATIONNOTATION:"IfcClassificationNotation",IFCCLASSIFICATIONITEMRELATIONSHIP:"IfcClassificationItemRelationship",IFCCLASSIFICATIONITEM:"IfcClassificationItem",IFCCLASSIFICATION:"IfcClassification",IFCCALENDARDATE:"IfcCalendarDate",IFCBOUNDARYNODECONDITIONWARPING:"IfcBoundaryNodeConditionWarping",IFCBOUNDARYNODECONDITION:"IfcBoundaryNodeCondition",IFCBOUNDARYFACECONDITION:"IfcBoundaryFaceCondition",IFCBOUNDARYEDGECONDITION:"IfcBoundaryEdgeCondition",IFCBOUNDARYCONDITION:"IfcBoundaryCondition",IFCAPPROVALRELATIONSHIP:"IfcApprovalRelationship",IFCAPPROVALPROPERTYRELATIONSHIP:"IfcApprovalPropertyRelationship",IFCAPPROVALACTORRELATIONSHIP:"IfcApprovalActorRelationship",IFCAPPROVAL:"IfcApproval",IFCAPPLIEDVALUERELATIONSHIP:"IfcAppliedValueRelationship",IFCAPPLIEDVALUE:"IfcAppliedValue",IFCAPPLICATION:"IfcApplication",IFCADDRESS:"IfcAddress",IFCACTORROLE:"IfcActorRole"};let SU=class{constructor(){P(this,"factor",1),P(this,"complement",1)}apply(t){const e=this.getScaleMatrix().multiply(t);t.copy(e)}setUp(t){var e,i,s;this.factor=1;const n=this.getLengthUnits(t);if(!n)return;const o=n==null,a=n.Name===void 0||n.Name===null;o||a||(n.Name.value==="FOOT"&&(this.factor=.3048),((e=n.Prefix)==null?void 0:e.value)==="MILLI"?this.complement=.001:((i=n.Prefix)==null?void 0:i.value)==="CENTI"?this.complement=.01:((s=n.Prefix)==null?void 0:s.value)==="DECI"&&(this.complement=.01))}getLengthUnits(t){try{const e=t.GetLineIDsWithType(0,sE).get(0),i=t.GetLine(0,e);for(const s of i.Units){if(!s||s.value===null||s.value===void 0)continue;const n=t.GetLine(0,s.value);if(n.UnitType&&n.UnitType.value==="LENGTHUNIT")return n}return null}catch{return console.log("Could not get units"),null}}getScaleMatrix(){const t=this.factor;return new ht().fromArray([t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1])}},AA=class{constructor(){P(this,"itemsByFloor",{}),P(this,"_units",new SU)}setUp(t){this._units.setUp(t),this.cleanUp();try{const e=t.GetLineIDsWithType(0,Nr),i=new Set,s=t.GetLineIDsWithType(0,Ii);for(let l=0;l<s.size();l++)i.add(s.get(l));const n=t.GetLineIDsWithType(0,xr),o=n.size();for(let l=0;l<o;l++){const h=n.get(l),u=t.GetLine(0,h);if(!u||!u.RelatingObject||!u.RelatedObjects)continue;const d=u.RelatingObject.value,f=u.RelatedObjects;for(const p of f){const m=p.value;i.has(m)&&(this.itemsByFloor[m]=d)}}const a={},c=e.size();for(let l=0;l<c;l++){const h=e.get(l),u=t.GetLine(0,h);if(!u||!u.RelatingStructure||!u.RelatedElements)continue;const d=u.RelatingStructure.value,f=u.RelatedElements;if(i.has(d))for(const p of f){a[d]||(a[d]=[]);const m=p.value;a[d].push(m)}else for(const p of f){const m=p.value;this.itemsByFloor[m]=d}}for(const l in a){const h=this.itemsByFloor[l];if(h!==void 0){const u=a[l];for(const d of u)this.itemsByFloor[d]=h}}for(let l=0;l<o;l++){const h=n.get(l),u=t.GetLine(0,h);if(!u||!u.RelatingObject||!u.RelatedObjects)continue;const d=u.RelatingObject.value,f=u.RelatedObjects;for(const p of f){const m=p.value,g=this.itemsByFloor[d];g!==void 0&&(this.itemsByFloor[m]=g)}}}catch{console.log("Could not get floors.")}}cleanUp(){this.itemsByFloor={}}},WE=class{constructor(){P(this,"includeProperties",!0),P(this,"optionalCategories",[Ii]),P(this,"wasm",{path:"",absolute:!1,logLevel:zy.LOG_LEVEL_OFF}),P(this,"excludedCategories",new Set),P(this,"includedCategories",new Set),P(this,"saveLocations",!1),P(this,"webIfc",{COORDINATE_TO_ORIGIN:!0}),P(this,"autoSetWasm",!0),P(this,"customLocateFileHandler",null)}},SA=class{constructor(){P(this,"defLineMat",new xi({color:16777215}))}read(t){const e=t.GetAllAlignments(0),i=t.GetAllCrossSections2D(0),s=t.GetAllCrossSections3D(0),n={IfcAlignment:e,IfcCrossSection2D:i,IfcCrossSection3D:s};return this.get(n)}get(t){if(t.IfcAlignment){const e=new Map;for(const i of t.IfcAlignment){const s=new lp;s.absolute=this.getCurves(i.curve3D,s),s.horizontal=this.getCurves(i.horizontal,s),s.vertical=this.getCurves(i.vertical,s),e.set(e.size,s)}return{alignments:e,coordinationMatrix:new ht}}}getCurves(t,e){const i=[];let s=0;for(const n of t){const o={};if(n.data)for(const d of n.data){const[f,p]=d.split(": "),m=parseFloat(p);o[f]=m||p}const{points:a}=n,c=new Float32Array(a.length*3);for(let d=0;d<a.length;d++){const{x:f,y:p,z:m}=a[d];c[d*3]=f,c[d*3+1]=p,c[d*3+2]=m||0}const l=new Kt(c,3),h=new $f;h.setAttribute("position",l);const u=new hp(s,o,e,h,this.defLineMat);i.push(u.curve),s++}return i}},wA=class{getNameInfo(t){var e;const i={},{arguments:s}=t.GetHeaderLine(0,Yy)||{};if(!s)return i;const[n,o,a,c,l,h,u]=s;if(n!=null&&n.value&&(i.name=n.value),o!=null&&o.value&&(i.creationDate=new Date(o.value)),a){i.author={};const[d,f]=a;d!=null&&d.value&&(i.author.name=d.value),f!=null&&f.value&&(i.author.email=f.value)}return c&&(e=c[0])!=null&&e.value&&(i.organization=c[0].value),l!=null&&l.value&&(i.preprocessorVersion=l?.value),h!=null&&h.value&&(i.originatingSystem=h?.value),u!=null&&u.value&&(i.authorization=u?.value),i}getDescriptionInfo(t){var e;const i={},{arguments:s}=t.GetHeaderLine(0,Gy)||{};if(!s)return i;const[n,o]=s;if(Array.isArray(n)&&(e=n[0])!=null&&e.value){const a=n[0].value.match(/\[([^\]]+)\]/);a&&a[1]&&(i.viewDefinition=a[1])}return o!=null&&o.value&&(i.implementationLevel=o.value),i}},_A=class{static get(t,e){const i=[Bo,Nc,Pc,ko,Ii,Wy,jy,Xy,Zy],s=t.data;for(const n of i){const o=e.GetLineIDsWithType(0,n),a=o.size();for(let c=0;c<a;c++){const l=o.get(c);s.has(l)||s.set(l,[[],[0,n]])}}}};const FA=new Set([1123145078,574549367,1675464909,2059837836,3798115385,32440307,3125803723,3207858831,2740243338,2624227202,4240577450,3615266464,3724593414,220341763,477187591,1878645084,1300840506,3303107099,1607154358,1878645084,846575682,1351298697,2417041796,3049322572,3331915920,1416205885,776857604,3285139300,3958052878,2827736869,2732653382,673634403,3448662350,4142052618,2924175390,803316827,2556980723,1809719519,2205249479,807026263,3737207727,1660063152,2347385850,2705031697,3732776249,2485617015,2611217952,1704287377,2937912522,2770003689,1281925730,1484403080,3448662350,4142052618,3800577675,4006246654,3590301190,1383045692,2775532180,2047409740,370225590,3593883385,2665983363,4124623270,812098782,3649129432,987898635,1105321065,3510044353,1635779807,2603310189,3406155212,1310608509,4261334040,2736907675,3649129432,1136057603,1260505505,4182860854,2713105998,2898889636,59481748,3749851601,3486308946,3150382593,1062206242,3264961684,15328376,1485152156,370225590,1981873012,2859738748,45288368,2614616156,2732653382,775493141,2147822146,2601014836,2629017746,1186437898,2367409068,1213902940,3632507154,3900360178,476780140,1472233963,2804161546,3008276851,738692330,374418227,315944413,3905492369,3570813810,2571569899,178912537,2294589976,1437953363,2133299955,572779678,3092502836,388784114,2624227202,1425443689,3057273783,2347385850,1682466193,2519244187,2839578677,3958567839,2513912981,2830218821,427810014,2916149573]),OA=class xA extends xt{constructor(t){super(t),P(this,"enabled",!0),t.add(xA.uuid,this)}async export(t,e,i=!1,s=!0){const n={},o=new Set(t.GetIfcEntityList(e)),a=new Set([Bo,Nc,Pc,ko,Ii]);for(const c of a)o.add(c);for(const c of o){if(FA.has(c))continue;const l=a.has(c)&&s,h=t.GetLineIDsWithType(e,c);for(const u of h)try{const d=t.GetLine(0,u,l,i);n[d.expressID]=d}catch{console.log(`Could not get property ${u}, with recursive ${l} and indirect ${i}.`)}}return n}};P(OA,"uuid","b32c4332-cd67-436e-ba7f-196646c7a635");let wU=OA;const NA=class gg extends xt{constructor(t){super(t),P(this,"onDisposed",new nt),P(this,"onIfcStartedLoading",new nt),P(this,"onSetup",new nt),P(this,"settings",new WE),P(this,"webIfc",new is),P(this,"enabled",!0),P(this,"_material",new Er),P(this,"_spatialTree",new AA),P(this,"_metaData",new wA),P(this,"_fragmentInstances",new Map),P(this,"_civil",new SA),P(this,"_visitedFragments",new Map),P(this,"_materialT",new Er({transparent:!0,opacity:.5})),this.components.add(gg.uuid,this),this.settings.excludedCategories.add(Wf)}dispose(){this.webIfc=null,this.onDisposed.trigger(gg.uuid),this.onDisposed.reset()}async setup(t){this.settings={...this.settings,...t},this.settings.autoSetWasm&&await this.autoSetWasm(),this.onSetup.trigger()}async load(t,e=!0,i=""){const s=performance.now();this.onIfcStartedLoading.trigger(),await this.readIfcFile(t);const n=await this.getAllGeometries();n.name=i;const o=await this.components.get(wU).export(this.webIfc,0);n.setLocalProperties(o);const a=this.components.get(Nt);a.groups.set(n.uuid,n);for(const c of n.items)a.list.set(c.id,c),c.mesh.uuid=c.id,c.group=n;a.onFragmentsLoaded.trigger(n),e&&a.coordinate([n]);for(const[c]of n.data){const l=o[c];if(!l||!l.GlobalId)continue;const h=l.GlobalId.value||l.GlobalId;n.globalToExpressIDs.set(h,c)}return _A.get(n,this.webIfc),this.cleanUp(),console.log(`Streaming the IFC took ${performance.now()-s} ms!`),n}async readIfcFile(t){const{path:e,absolute:i,logLevel:s}=this.settings.wasm;return this.webIfc.SetWasmPath(e,i),await this.webIfc.Init(this.settings.customLocateFileHandler||void 0),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModel(t,this.settings.webIfc)}cleanUp(){try{this.webIfc.Dispose()}catch{console.log("Web-ifc wasn't disposed.")}this.webIfc=null,this.webIfc=new is,this._visitedFragments.clear(),this._fragmentInstances.clear()}async getAllGeometries(){this._spatialTree.setUp(this.webIfc);const t=this.webIfc.GetIfcEntityList(0),e=new si;e.ifcMetadata={name:"",description:"",...this._metaData.getNameInfo(this.webIfc),...this._metaData.getDescriptionInfo(this.webIfc),schema:this.webIfc.GetModelSchema(0)||"IFC2X3",maxExpressID:this.webIfc.GetMaxExpressID(0)};const i=[];for(const n of t){if(!this.webIfc.IsIfcElement(n)&&n!==Ii)continue;const o=this.settings.includedCategories;if(o.size>0&&!o.has(n)||this.settings.excludedCategories.has(n))continue;const a=this.webIfc.GetLineIDsWithType(0,n),c=a.size();for(let l=0;l<c;l++){const h=a.get(l);i.push(h);const u=this._spatialTree.itemsByFloor[h]||0;e.data.set(h,[[],[u,n]])}}this._spatialTree.cleanUp(),this.webIfc.StreamMeshes(0,i,n=>{this.getMesh(n,e)});for(const n of this._visitedFragments){const{index:o,fragment:a}=n[1];e.keyFragments.set(o,a.id)}for(const n of e.items){const o=this._fragmentInstances.get(n.id);if(!o)throw new Error("Fragment not found!");const a=[];for(const[c,l]of o)a.push(l);n.add(a)}const s=this.webIfc.GetCoordinationMatrix(0);return e.coordinationMatrix.fromArray(s),e.civilData=this._civil.read(this.webIfc),e}getMesh(t,e){const i=t.geometries.size(),s=t.expressID;for(let n=0;n<i;n++){const o=t.geometries.get(n),{x:a,y:c,z:l,w:h}=o.color,u=h!==1,{geometryExpressID:d}=o,f=`${d}-${u}`;if(!this._visitedFragments.has(f)){const E=this.getGeometry(this.webIfc,d),T=u?this._materialT:this._material,A=new So(E,T,1);e.add(A.mesh),e.items.push(A);const S=this._visitedFragments.size;this._visitedFragments.set(f,{index:S,fragment:A})}const p=new Rt().setRGB(a,c,l,"srgb"),m=new ht;m.fromArray(o.flatTransformation);const g=this._visitedFragments.get(f);if(g===void 0)throw new Error("Error getting geometry data for streaming!");const I=e.data.get(s);if(!I)throw new Error("Data not found!");I[0].push(g.index);const{fragment:C}=g;this._fragmentInstances.has(C.id)||this._fragmentInstances.set(C.id,new Map);const b=this._fragmentInstances.get(C.id);if(!b)throw new Error("Instances not found!");if(b.has(s)){const E=b.get(s);if(!E)throw new Error("Instance not found!");E.transforms.push(m),E.colors&&E.colors.push(p)}else b.set(s,{id:s,transforms:[m],colors:[p]})}}getGeometry(t,e){const i=t.GetGeometry(0,e),s=t.GetIndexArray(i.GetIndexData(),i.GetIndexDataSize()),n=t.GetVertexArray(i.GetVertexData(),i.GetVertexDataSize()),o=new Float32Array(n.length/2),a=new Float32Array(n.length/2);for(let u=0;u<n.length;u+=6)o[u/2]=n[u],o[u/2+1]=n[u+1],o[u/2+2]=n[u+2],a[u/2]=n[u+3],a[u/2+1]=n[u+4],a[u/2+2]=n[u+5];const c=new Ut,l=new Kt(o,3),h=new Kt(a,3);return c.setAttribute("position",l),c.setAttribute("normal",h),c.setIndex(Array.from(s)),i.delete(),c}async autoSetWasm(){const t=await fetch(`https://unpkg.com/@thatopen/components@${aA.release}/package.json`);if(!t.ok){console.warn("Couldn't get openbim-components package.json. Set wasm settings manually.");return}const e=await t.json();if(!("web-ifc"in e.peerDependencies))console.warn("Couldn't get web-ifc from peer dependencies in openbim-components. Set wasm settings manually.");else{const i=e.peerDependencies["web-ifc"];this.settings.wasm.path=`https://unpkg.com/web-ifc@${i}/`,this.settings.wasm.absolute=!0}}};P(NA,"uuid","a659add7-1418-4771-a0d6-7d4d438e4624");let _U=NA;const FU={IfcRelAssignsToControl:{related:5,relating:7},IfcRelAssignsToGroup:{related:5,relating:7},IfcRelAssignsToProduct:{related:5,relating:7},IfcRelAssociatesClassification:{related:5,relating:6},IfcRelAssociatesMaterial:{related:5,relating:6},IfcRelAssociatesDocument:{related:5,relating:6},IfcRelContainedInSpatialStructure:{related:5,relating:6},IfcRelFlowControlElements:{related:5,relating:6},IfcRelConnectsElements:{related:7,relating:6},IfcRelDeclares:{related:6,relating:5},IfcRelAggregates:{related:6,relating:5},IfcRelNests:{related:6,relating:5},IfcRelDefinesByProperties:{related:5,relating:6},IfcRelDefinesByType:{related:5,relating:6},IfcRelDefinesByTemplate:{related:5,relating:6}},OU={[Fc]:"IfcRelAssignsToControl",[yc]:"IfcRelAssignsToGroup",[wc]:"IfcRelAssignsToProduct",[Tc]:"IfcRelAssociatesClassification",[bc]:"IfcRelAssociatesMaterial",[xc]:"IfcRelAssociatesDocument",[Nr]:"IfcRelContainedInSpatialStructure",[Sc]:"IfcRelConnectsElements",[Ac]:"IfcRelFlowControlElements",[_c]:"IfcRelDeclares",[xr]:"IfcRelAggregates",[Oc]:"IfcRelNests",[on]:"IfcRelDefinesByProperties",[vc]:"IfcRelDefinesByType",[Rc]:"IfcRelDefinesByTemplate"},PA=class lo extends xt{constructor(t){super(t),P(this,"onDisposed",new nt),P(this,"onRequestFile",new nt),P(this,"ifcToExport",null),P(this,"onElementToPset",new nt),P(this,"onPropToPset",new nt),P(this,"onPsetRemoved",new nt),P(this,"onDataChanged",new nt),P(this,"wasm",{path:"/",absolute:!1}),P(this,"enabled",!0),P(this,"attributeListeners",{}),P(this,"selectedModel"),P(this,"changeMap",{}),this.components.add(lo.uuid,this)}dispose(){this.selectedModel=void 0,this.attributeListeners={},this.changeMap={},this.onElementToPset.reset(),this.onPropToPset.reset(),this.onPsetRemoved.reset(),this.onDataChanged.reset(),this.onDisposed.trigger(lo.uuid),this.onDisposed.reset()}static getIFCSchema(t){const e=t.ifcMetadata.schema;if(!e)throw new Error("IFC Schema not found");return e.startsWith("IFC2X3")?"IFC2X3":e.startsWith("IFC4")&&e.replace("IFC4","")===""?"IFC4":e.startsWith("IFC4X3")?"IFC4X3":e}async setData(t,...e){for(const i of e){const{expressID:s}=i;(!s||s===-1)&&(i.expressID=this.getNewExpressID(t)),await t.setProperties(i.expressID,i),this.registerChange(t,i.expressID)}}async newPset(t,e,i){const s=lo.getIFCSchema(t),{handle:n}=await this.getOwnerHistory(t),o=this.newGUID(t),a=new _e[s].IfcLabel(e),c=i?new _e[s].IfcText(i):null,l=new _e[s].IfcPropertySet(o,n,a,c,[]);return l.expressID=this.getNewExpressID(t),await this.setData(t,l),{pset:l}}async removePset(t,...e){for(const i of e){const s=await t.getProperties(i);if(s?.type!==pi)continue;const n=await hh.getPsetRel(t,i);if(n&&(await t.setProperties(n,null),this.registerChange(t,n)),s){for(const o of s.HasProperties)await t.setProperties(o.value,null);await t.setProperties(i,null),this.onPsetRemoved.trigger({model:t,psetID:i}),this.registerChange(t,i)}}}newSingleStringProperty(t,e,i,s){return this.newSingleProperty(t,e,i,s)}newSingleNumericProperty(t,e,i,s){return this.newSingleProperty(t,e,i,s)}newSingleBooleanProperty(t,e,i,s){return this.newSingleProperty(t,e,i,s)}async removePsetProp(t,e,i){const s=await t.getProperties(e),n=await t.getProperties(i);!s||!n||s.type===pi&&n&&(s.HasProperties=s.HasProperties.filter(o=>o.value!==i),await t.setProperties(i,null),this.registerChange(t,e,i))}addElementToPset(t,e,...i){this.components.get(_i).addEntitiesRelation(t,e,{type:on,inv:"DefinesOcurrence"},...i)}async addPropToPset(t,e,...i){const s=await t.getProperties(e);if(s){for(const n of i){if(s.HasProperties.includes(n))continue;const o=new ei(n);s.HasProperties.push(o),this.onPropToPset.trigger({model:t,psetID:e,propID:n})}this.registerChange(t,e)}}async createIfcRel(t,e,i,s){const n=OU[e];if(!n)throw new Error(`IfcPropertiesManager: ${n} is unsoported.`);const o=lo.getIFCSchema(t),a=FU[n],c=_e[o][n];if(!(a&&c))throw new Error(`IfcPropertiesManager: ${n} is unsoported.`);const l=[new _e[o].IfcGloballyUniqueId(kn.create())],{related:h,relating:u}=a,d=[...new Set(s)].map(m=>new ei(m)),f=(m,g)=>{for(let I=m;I<g-1;I++)l.push(null)};h<u?(f(1,h),l.push(d),f(h,u),l.push(new ei(i))):(f(1,u),f(u,h),l.push(new ei(i)),l.push(d));const p=new c(...l);return await this.setData(t,p),p}async saveToIfc(t,e){const i=this.components.get(_U),s=i.webIfc,n=await i.readIfcFile(e);await this.components.get(_i).applyRelationChanges();const o=this.changeMap[t.uuid]??[];for(const c of o){const l=await t.getProperties(c);l?s.WriteLine(n,l):s.GetLine(n,c)&&s.DeleteLine(n,c)}const a=s.SaveModel(n);return i.webIfc.CloseModel(n),i.cleanUp(),a}async getEntityRef(t,e){const i=await t.getAllPropertiesOfType(e);if(!i)return null;const s=[];for(const n in i){const o=new ei(Number(n));s.push(o)}return s}async setAttributeListener(t,e,i){this.attributeListeners[t.uuid]||(this.attributeListeners[t.uuid]={});const s=this.attributeListeners[t.uuid][e]?this.attributeListeners[t.uuid][e][i]:null;if(s)return s;const n=await t.getProperties(e);if(!n)throw new Error(`Entity with expressID ${e} doesn't exists.`);const o=n[i];if(Array.isArray(o)||!o)throw new Error(`Attribute ${i} is array or null, and it can't have a listener.`);const a=o.value;if(a===void 0||a==null)throw new Error(`Attribute ${i} has a badly defined handle.`);const c=new nt;return Object.defineProperty(n[i],"value",{get(){return this._value},async set(l){this._value=l,c.trigger(l)}}),n[i].value=a,this.attributeListeners[t.uuid][e]||(this.attributeListeners[t.uuid][e]={}),this.attributeListeners[t.uuid][e][i]=c,c}getNewExpressID(t){return t.ifcMetadata.maxExpressID++,t.ifcMetadata.maxExpressID}newGUID(t){const e=lo.getIFCSchema(t);return new _e[e].IfcGloballyUniqueId(kn.create())}async getOwnerHistory(t){const e=await t.getAllPropertiesOfType(By);if(!e)throw new Error("No OwnerHistory was found.");const i=Object.keys(e).map(o=>parseInt(o,10)),s=e[i[0]],n=new ei(s.expressID);return{entity:s,handle:n}}registerChange(t,...e){this.changeMap[t.uuid]||(this.changeMap[t.uuid]=new Set);for(const i of e)this.changeMap[t.uuid].add(i),this.onDataChanged.trigger({model:t,expressID:i})}async newSingleProperty(t,e,i,s){const n=lo.getIFCSchema(t),o=new _e[n].IfcIdentifier(i),a=new _e[n][e](s),c=new _e[n].IfcPropertySingleValue(o,null,a,null);return c.expressID=this.getNewExpressID(t),await this.setData(t,c),c}};P(PA,"uuid","58c2d9f0-183c-48d6-a402-dfcf5b9a34df");let xU=PA;const LA=class Eg extends xt{constructor(t){super(t),P(this,"onDisposed",new nt),P(this,"onRelationsIndexed",new nt),P(this,"relationMaps",{}),P(this,"enabled",!0),P(this,"_relToAttributesMap",lT),P(this,"_inverseAttributes",["IsDecomposedBy","Decomposes","AssociatedTo","HasAssociations","ClassificationForObjects","IsGroupedBy","HasAssignments","IsDefinedBy","DefinesOcurrence","IsTypedBy","Types","Defines","ContainedInStructure","ContainsElements","HasControlElements","AssignedToFlowElement","ConnectedTo","ConnectedFrom","ReferencedBy","Declares","HasContext","Controls","IsNestedBy","Nests","DocumentRefForObjects"]),P(this,"_ifcRels",[xr,bc,Tc,yc,on,vc,Rc,Nr,Ac,Sc,wc,_c,Fc,Oc,xc]),P(this,"onFragmentsDisposed",e=>{delete this.relationMaps[e.groupID]}),P(this,"_changeMap",{}),P(this,"onEntitiesRelated",new nt),this.components.add(Eg.uuid,this),t.get(Nt).onFragmentsDisposed.add(this.onFragmentsDisposed)}indexRelations(t,e,i,s){const n=Object.keys(e).find(h=>h.startsWith("Relating")),o=Object.keys(e).find(h=>h.startsWith("Related"));if(!(n&&o))return;const a=e[n].value,c=e[o].map(h=>h.value),l=this.getEntityRelations(t,a,s);for(const h of c)l.push(h);for(const h of c)this.getEntityRelations(t,h,i).push(a)}getAttributeIndex(t){const e=this._inverseAttributes.indexOf(t);if(e===-1)throw new Error(`IfcRelationsIndexer: ${t} is not a valid IFC Inverse Attribute name or its not supported yet by this component.`);return e}setRelationMap(t,e){this.relationMaps[t.uuid]=e,this.onRelationsIndexed.trigger({modelID:t.uuid,relationsMap:e})}async process(t,e){if(!t.hasProperties)throw new Error("FragmentsGroup properties not found");let i=this.relationMaps[t.uuid];i||(i=new Map,this.relationMaps[t.uuid]=i);const s=t.getLocalProperties();if(!s)return i;const n=e?.relationsToProcess??this._ifcRels;for(const[o,a]of Object.entries(s)){if(!n.includes(a.type))continue;const c=this._relToAttributesMap.get(a.type);if(!c)continue;const{forRelated:l,forRelating:h}=c;this.indexRelations(i,a,l,h)}return this.setRelationMap(t,i),i}async processFromWebIfc(t,e){const i=new Map;for(const s of this._ifcRels){const n=this._relToAttributesMap.get(s);if(!n)continue;const{forRelated:o,forRelating:a}=n,c=t.GetLineIDsWithType(e,s);for(let l=0;l<c.size();l++){const h=await t.properties.getItemProperties(e,c.get(l));this.indexRelations(i,h,o,a)}}return this.onRelationsIndexed.trigger({modelID:e.toString(),relationsMap:i}),i}getEntityRelations(t,e,i){const s=this.getAttributeIndex(i);let n;if(t instanceof si?n=this.relationMaps[t.uuid]:typeof t=="string"?n=this.relationMaps[t]:n=t,!n&&(t instanceof si||typeof t=="string")){n=new Map;const c=t instanceof si?t.uuid:t;this.relationMaps[c]=n}let o=n.get(e);o||(o=new Map,n.set(e,o));let a=o.get(s);return a||(a=[],o.set(s,a)),a}serializeRelations(t){const e={};for(const[i,s]of t.entries()){e[i]||(e[i]={});for(const[n,o]of s.entries())e[i][n]=o}return JSON.stringify(e)}serializeModelRelations(t){const e=this.relationMaps[t.uuid];return e?this.serializeRelations(e):null}serializeAllRelations(){const t={};for(const e in this.relationMaps){const i=this.relationMaps[e],s={};for(const[n,o]of i.entries()){s[n]||(s[n]={});for(const[a,c]of o.entries())s[n][a]=c}t[e]=s}return JSON.stringify(t)}getRelationsMapFromJSON(t){const e=JSON.parse(t),i=new Map;for(const s in e){const n=e[s],o=new Map;for(const a in n)o.set(Number(a),n[a]);i.set(Number(s),o)}return i}dispose(){this.relationMaps={},this.components.get(Nt).onFragmentsDisposed.remove(this.onFragmentsDisposed),this.onDisposed.trigger(Eg.uuid),this.onDisposed.reset()}getEntitiesWithRelation(t,e,i){const s=this.relationMaps[t.uuid];if(!s)throw new Error("IfcRelationsIndexer: the model relations are not indexed!");const n=new Set;for(const[o,a]of s){const c=this.getAttributeIndex(e),l=a.get(c);l&&l.includes(i)&&n.add(o)}return n}addEntityRelations(t,e,i,...s){const n=this.getEntityRelations(t,e,i);if(n)n.push(...s);else{const o=this.getAttributeIndex(i),a=this.relationMaps[t.uuid].get(e);a?.set(o,s)}}async applyRelationChanges(){const t=this.components.get(Nt),e=this.components.get(xU);for(const i in this._changeMap){const s=t.groups.get(i);if(!s)continue;const n=this._changeMap[i];for(const[o,a]of n)for(const[c,l]of a){const{related:h,relID:u}=l;if(u){const d=await s.getProperties(u);if(!d)continue;const f=Object.keys(d),p=f.find(g=>g.startsWith("Related")),m=f.find(g=>g.startsWith("Relating"));if(!(p&&m))continue;d[p]=[...h].map(g=>new ei(g)),d[m]=new ei(c),await e.setData(s,d)}else{const d=await e.createIfcRel(s,o,c,[...h]);if(!d)continue;l.relID=d.expressID}}}}addEntitiesRelation(t,e,i,...s){const{type:n,inv:o}=i;let a=this.relationMaps[t.uuid];if(a||(a=new Map,this.relationMaps[t.uuid]=a),!this._ifcRels.includes(n))return;const c=lT.get(n);if(!c)return;const{forRelated:l,forRelating:h}=c;if(!(l===o||h===o))return;let u=this._changeMap[t.uuid];u||(u=new Ns,this._changeMap[t.uuid]=u);const d=h===o?[e]:s,f=l===o?[e]:s;let p=u.get(n);p||(p=new Ns,p.onItemSet.add(()=>this.onEntitiesRelated.trigger({invAttribute:o,relType:n,relatingIDs:d,relatedIDs:f})),p.onItemUpdated.add(()=>this.onEntitiesRelated.trigger({invAttribute:o,relType:n,relatingIDs:d,relatedIDs:f})),u.set(n,p));for(const m of d){let g=p.get(m);g||(g={related:new gr},p.set(m,g)),g.related.add(...f)}for(const m of d)this.getEntityRelations(t,m,h).push(...f);for(const m of f)this.getEntityRelations(t,m,l).push(...d)}getEntityChildren(t,e,i=new Set){if(i.add(e),this.relationMaps[t.uuid]===void 0)throw new Error("The provided model has no indices. You have to generate them first.");const s=this.getEntityRelations(t,e,"IsDecomposedBy");if(s)for(const o of s)this.getEntityChildren(t,o,i);const n=this.getEntityRelations(t,e,"ContainsElements");if(n)for(const o of n)this.getEntityChildren(t,o,i);return i}};P(LA,"uuid","23a889ab-83b3-44a4-8bee-ead83438370b");let _i=LA;const MA=class DA extends xt{constructor(t){super(t),P(this,"onDisposed",new nt),P(this,"onFragmentsLoaded",new nt),P(this,"onFragmentsDisposed",new nt),P(this,"list",new Ns),P(this,"groups",new Ns),P(this,"baseCoordinationModel",""),P(this,"baseCoordinationMatrix",new ht),P(this,"enabled",!0),P(this,"_loader",new cp),this.components.add(DA.uuid,this)}get meshes(){const t=[];for(const[e,i]of this.list)t.push(i.mesh);return t}dispose(){for(const[t,e]of this.groups)e.dispose(!0);this.baseCoordinationModel="",this.groups.clear(),this.list.clear(),this.onFragmentsLoaded.reset(),this.onFragmentsDisposed.reset(),this.onDisposed.trigger(),this.onDisposed.reset()}disposeGroup(t){const{uuid:e}=t,i=[];for(const s of t.items)i.push(s.id),this.list.delete(s.id);t.dispose(!0),this.groups.delete(t.uuid),this.groups.size===0&&(this.baseCoordinationModel="",this.baseCoordinationMatrix=new ht),this.onFragmentsDisposed.trigger({groupID:e,fragmentIDs:i})}load(t,e){const i={coordinate:!0,...e},{coordinate:s,name:n,properties:o,relationsMap:a}=i,c=this._loader.import(t);e&&(c.isStreamed=e.isStreamed||!1),n&&(c.name=n);for(const l of c.items)l.group=c,this.list.set(l.id,l);return s&&this.coordinate([c]),this.groups.set(c.uuid,c),o&&c.setLocalProperties(o),a&&this.components.get(_i).setRelationMap(c,a),this.onFragmentsLoaded.trigger(c),c}export(t){return this._loader.export(t)}getModelIdMap(t){const e={};for(const i in t){const s=this.list.get(i);if(!(s&&s.group))continue;const n=s.group;n.uuid in e||(e[n.uuid]=new Set);const o=t[i];for(const a of o)e[n.uuid].add(a)}return e}modelIdToFragmentIdMap(t){let e={};for(const i in t){const s=this.groups.get(i);if(!s)continue;const n=t[i],o=s.getFragmentMap(n);e={...e,...o}}return e}guidToFragmentIdMap(t){const e={};for(const[i,s]of this.groups){i in e||(e[i]=new Set);for(const n of t){const o=s.globalToExpressIDs.get(n);o&&e[i].add(o)}}return this.modelIdToFragmentIdMap(e)}fragmentIdMapToGuids(t){const e=[],i=this.getModelIdMap(t);for(const s in i){const n=this.groups.get(s);if(!n)continue;const o=i[s];for(const a of o)for(const[c,l]of n.globalToExpressIDs.entries())if(l===a){e.push(c);break}}return e}coordinate(t=Array.from(this.groups.values())){if(this.baseCoordinationModel.length===0){const e=t.pop();if(!e)return;this.baseCoordinationModel=e.uuid,this.baseCoordinationMatrix=e.coordinationMatrix.clone()}if(t.length)for(const e of t)e.coordinationMatrix.equals(this.baseCoordinationMatrix)||(e.position.set(0,0,0),e.rotation.set(0,0,0),e.scale.set(1,1,1),e.updateMatrix(),this.applyBaseCoordinateSystem(e,e.coordinationMatrix))}applyBaseCoordinateSystem(t,e){e&&t.applyMatrix4(e.clone().invert()),t.applyMatrix4(this.baseCoordinationMatrix)}clone(t,e){const i=t.cloneGroup(e);this.groups.set(i.uuid,i);for(const s of i.items)this.list.set(s.id,s);return i}};P(MA,"uuid","fef46874-46a3-461b-8c44-2922ab77c806");let Nt=MA;var Nd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function NU(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Pd(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var UA={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(r,t){(function(e){r.exports=e()})(function(){return function e(i,s,n){function o(l,h){if(!s[l]){if(!i[l]){var u=typeof Pd=="function"&&Pd;if(!h&&u)return u(l,!0);if(a)return a(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var f=s[l]={exports:{}};i[l][0].call(f.exports,function(p){var m=i[l][1][p];return o(m||p)},f,f.exports,e,i,s,n)}return s[l].exports}for(var a=typeof Pd=="function"&&Pd,c=0;c<n.length;c++)o(n[c]);return o}({1:[function(e,i,s){var n=e("./utils"),o=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(c){for(var l,h,u,d,f,p,m,g=[],I=0,C=c.length,b=C,E=n.getTypeOf(c)!=="string";I<c.length;)b=C-I,u=E?(l=c[I++],h=I<C?c[I++]:0,I<C?c[I++]:0):(l=c.charCodeAt(I++),h=I<C?c.charCodeAt(I++):0,I<C?c.charCodeAt(I++):0),d=l>>2,f=(3&l)<<4|h>>4,p=1<b?(15&h)<<2|u>>6:64,m=2<b?63&u:64,g.push(a.charAt(d)+a.charAt(f)+a.charAt(p)+a.charAt(m));return g.join("")},s.decode=function(c){var l,h,u,d,f,p,m=0,g=0,I="data:";if(c.substr(0,I.length)===I)throw new Error("Invalid base64 input, it looks like a data url.");var C,b=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===a.charAt(64)&&b--,c.charAt(c.length-2)===a.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(C=o.uint8array?new Uint8Array(0|b):new Array(0|b);m<c.length;)l=a.indexOf(c.charAt(m++))<<2|(d=a.indexOf(c.charAt(m++)))>>4,h=(15&d)<<4|(f=a.indexOf(c.charAt(m++)))>>2,u=(3&f)<<6|(p=a.indexOf(c.charAt(m++))),C[g++]=l,f!==64&&(C[g++]=h),p!==64&&(C[g++]=u);return C}},{"./support":30,"./utils":32}],2:[function(e,i,s){var n=e("./external"),o=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),c=e("./stream/DataLengthProbe");function l(h,u,d,f,p){this.compressedSize=h,this.uncompressedSize=u,this.crc32=d,this.compression=f,this.compressedContent=p}l.prototype={getContentWorker:function(){var h=new o(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),u=this;return h.on("end",function(){if(this.streamInfo.data_length!==u.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new o(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},l.createWorkerFrom=function(h,u,d){return h.pipe(new a).pipe(new c("uncompressedSize")).pipe(u.compressWorker(d)).pipe(new c("compressedSize")).withStreamInfo("compression",u)},i.exports=l},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,i,s){var n=e("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},s.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,i,s){var n=e("./utils"),o=function(){for(var a,c=[],l=0;l<256;l++){a=l;for(var h=0;h<8;h++)a=1&a?3988292384^a>>>1:a>>>1;c[l]=a}return c}();i.exports=function(a,c){return a!==void 0&&a.length?n.getTypeOf(a)!=="string"?function(l,h,u,d){var f=o,p=d+u;l^=-1;for(var m=d;m<p;m++)l=l>>>8^f[255&(l^h[m])];return-1^l}(0|c,a,a.length,0):function(l,h,u,d){var f=o,p=d+u;l^=-1;for(var m=d;m<p;m++)l=l>>>8^f[255&(l^h.charCodeAt(m))];return-1^l}(0|c,a,a.length,0):0}},{"./utils":32}],5:[function(e,i,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(e,i,s){var n=null;n=typeof Promise<"u"?Promise:e("lie"),i.exports={Promise:n}},{lie:37}],7:[function(e,i,s){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=e("pako"),a=e("./utils"),c=e("./stream/GenericWorker"),l=n?"uint8array":"array";function h(u,d){c.call(this,"FlateWorker/"+u),this._pako=null,this._pakoAction=u,this._pakoOptions=d,this.meta={}}s.magic="\b\0",a.inherits(h,c),h.prototype.processChunk=function(u){this.meta=u.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(l,u.data),!1)},h.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var u=this;this._pako.onData=function(d){u.push({data:d,meta:u.meta})}},s.compressWorker=function(u){return new h("Deflate",u)},s.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,i,s){function n(f,p){var m,g="";for(m=0;m<p;m++)g+=String.fromCharCode(255&f),f>>>=8;return g}function o(f,p,m,g,I,C){var b,E,T=f.file,A=f.compression,S=C!==l.utf8encode,_=a.transformTo("string",C(T.name)),w=a.transformTo("string",l.utf8encode(T.name)),F=T.comment,D=a.transformTo("string",C(F)),R=a.transformTo("string",l.utf8encode(F)),O=w.length!==T.name.length,y=R.length!==F.length,U="",H="",k="",X=T.dir,$=T.date,et={crc32:0,compressedSize:0,uncompressedSize:0};p&&!m||(et.crc32=f.crc32,et.compressedSize=f.compressedSize,et.uncompressedSize=f.uncompressedSize);var Y=0;p&&(Y|=8),S||!O&&!y||(Y|=2048);var z=0,st=0;X&&(z|=16),I==="UNIX"?(st=798,z|=function(Q,gt){var Ct=Q;return Q||(Ct=gt?16893:33204),(65535&Ct)<<16}(T.unixPermissions,X)):(st=20,z|=function(Q){return 63&(Q||0)}(T.dosPermissions)),b=$.getUTCHours(),b<<=6,b|=$.getUTCMinutes(),b<<=5,b|=$.getUTCSeconds()/2,E=$.getUTCFullYear()-1980,E<<=4,E|=$.getUTCMonth()+1,E<<=5,E|=$.getUTCDate(),O&&(H=n(1,1)+n(h(_),4)+w,U+="up"+n(H.length,2)+H),y&&(k=n(1,1)+n(h(D),4)+R,U+="uc"+n(k.length,2)+k);var K="";return K+=`
\0`,K+=n(Y,2),K+=A.magic,K+=n(b,2),K+=n(E,2),K+=n(et.crc32,4),K+=n(et.compressedSize,4),K+=n(et.uncompressedSize,4),K+=n(_.length,2),K+=n(U.length,2),{fileRecord:u.LOCAL_FILE_HEADER+K+_+U,dirRecord:u.CENTRAL_FILE_HEADER+n(st,2)+K+n(D.length,2)+"\0\0\0\0"+n(z,4)+n(g,4)+_+U+D}}var a=e("../utils"),c=e("../stream/GenericWorker"),l=e("../utf8"),h=e("../crc32"),u=e("../signature");function d(f,p,m,g){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=m,this.encodeFileName=g,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(d,c),d.prototype.push=function(f){var p=f.meta.percent||0,m=this.entriesCount,g=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,c.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:m?(p+100*(m-g-1))/m:100}}))},d.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var p=this.streamFiles&&!f.file.dir;if(p){var m=o(f,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:m.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(f){this.accumulate=!1;var p=this.streamFiles&&!f.file.dir,m=o(f,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(m.dirRecord),p)this.push({data:function(g){return u.DATA_DESCRIPTOR+n(g.crc32,4)+n(g.compressedSize,4)+n(g.uncompressedSize,4)}(f),meta:{percent:100}});else for(this.push({data:m.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var f=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var m=this.bytesWritten-f,g=function(I,C,b,E,T){var A=a.transformTo("string",T(E));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(I,2)+n(I,2)+n(C,4)+n(b,4)+n(A.length,2)+A}(this.dirRecords.length,m,f,this.zipComment,this.encodeFileName);this.push({data:g,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(f){this._sources.push(f);var p=this;return f.on("data",function(m){p.processChunk(m)}),f.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),f.on("error",function(m){p.error(m)}),this},d.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(f){var p=this._sources;if(!c.prototype.error.call(this,f))return!1;for(var m=0;m<p.length;m++)try{p[m].error(f)}catch{}return!0},d.prototype.lock=function(){c.prototype.lock.call(this);for(var f=this._sources,p=0;p<f.length;p++)f[p].lock()},i.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,i,s){var n=e("../compressions"),o=e("./ZipFileWorker");s.generateWorker=function(a,c,l){var h=new o(c.streamFiles,l,c.platform,c.encodeFileName),u=0;try{a.forEach(function(d,f){u++;var p=function(C,b){var E=C||b,T=n[E];if(!T)throw new Error(E+" is not a valid compression method !");return T}(f.options.compression,c.compression),m=f.options.compressionOptions||c.compressionOptions||{},g=f.dir,I=f.date;f._compressWorker(p,m).withStreamInfo("file",{name:d,dir:g,date:I,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(h)}),h.entriesCount=u}catch(d){h.error(d)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,i,s){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new n;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(o,a){return new n().loadAsync(o,a)},n.external=e("./external"),i.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,i,s){var n=e("./utils"),o=e("./external"),a=e("./utf8"),c=e("./zipEntries"),l=e("./stream/Crc32Probe"),h=e("./nodejsUtils");function u(d){return new o.Promise(function(f,p){var m=d.decompressed.getContentWorker().pipe(new l);m.on("error",function(g){p(g)}).on("end",function(){m.streamInfo.crc32!==d.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}i.exports=function(d,f){var p=this;return f=n.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),h.isNode&&h.isStream(d)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",d,!0,f.optimizedBinaryString,f.base64).then(function(m){var g=new c(f);return g.load(m),g}).then(function(m){var g=[o.Promise.resolve(m)],I=m.files;if(f.checkCRC32)for(var C=0;C<I.length;C++)g.push(u(I[C]));return o.Promise.all(g)}).then(function(m){for(var g=m.shift(),I=g.files,C=0;C<I.length;C++){var b=I[C],E=b.fileNameStr,T=n.resolve(b.fileNameStr);p.file(T,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:f.createFolders}),b.dir||(p.file(T).unsafeOriginalName=E)}return g.zipComment.length&&(p.comment=g.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,i,s){var n=e("../utils"),o=e("../stream/GenericWorker");function a(c,l){o.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(l)}n.inherits(a,o),a.prototype._bindStream=function(c){var l=this;(this._stream=c).pause(),c.on("data",function(h){l.push({data:h,meta:{percent:0}})}).on("error",function(h){l.isPaused?this.generatedError=h:l.error(h)}).on("end",function(){l.isPaused?l._upstreamEnded=!0:l.end()})},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,i,s){var n=e("readable-stream").Readable;function o(a,c,l){n.call(this,c),this._helper=a;var h=this;a.on("data",function(u,d){h.push(u)||h._helper.pause(),l&&l(d)}).on("error",function(u){h.emit("error",u)}).on("end",function(){h.push(null)})}e("../utils").inherits(o,n),o.prototype._read=function(){this._helper.resume()},i.exports=o},{"../utils":32,"readable-stream":16}],14:[function(e,i,s){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,o);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,o)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var o=new Buffer(n);return o.fill(0),o},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(e,i,s){function n(T,A,S){var _,w=a.getTypeOf(A),F=a.extend(S||{},h);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(T=I(T)),F.createFolders&&(_=g(T))&&C.call(this,_,!0);var D=w==="string"&&F.binary===!1&&F.base64===!1;S&&S.binary!==void 0||(F.binary=!D),(A instanceof u&&A.uncompressedSize===0||F.dir||!A||A.length===0)&&(F.base64=!1,F.binary=!0,A="",F.compression="STORE",w="string");var R=null;R=A instanceof u||A instanceof c?A:p.isNode&&p.isStream(A)?new m(T,A):a.prepareContent(T,A,F.binary,F.optimizedBinaryString,F.base64);var O=new d(T,R,F);this.files[T]=O}var o=e("./utf8"),a=e("./utils"),c=e("./stream/GenericWorker"),l=e("./stream/StreamHelper"),h=e("./defaults"),u=e("./compressedObject"),d=e("./zipObject"),f=e("./generate"),p=e("./nodejsUtils"),m=e("./nodejs/NodejsStreamInputAdapter"),g=function(T){T.slice(-1)==="/"&&(T=T.substring(0,T.length-1));var A=T.lastIndexOf("/");return 0<A?T.substring(0,A):""},I=function(T){return T.slice(-1)!=="/"&&(T+="/"),T},C=function(T,A){return A=A!==void 0?A:h.createFolders,T=I(T),this.files[T]||n.call(this,T,null,{dir:!0,createFolders:A}),this.files[T]};function b(T){return Object.prototype.toString.call(T)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(T){var A,S,_;for(A in this.files)_=this.files[A],(S=A.slice(this.root.length,A.length))&&A.slice(0,this.root.length)===this.root&&T(S,_)},filter:function(T){var A=[];return this.forEach(function(S,_){T(S,_)&&A.push(_)}),A},file:function(T,A,S){if(arguments.length!==1)return T=this.root+T,n.call(this,T,A,S),this;if(b(T)){var _=T;return this.filter(function(F,D){return!D.dir&&_.test(F)})}var w=this.files[this.root+T];return w&&!w.dir?w:null},folder:function(T){if(!T)return this;if(b(T))return this.filter(function(w,F){return F.dir&&T.test(w)});var A=this.root+T,S=C.call(this,A),_=this.clone();return _.root=S.name,_},remove:function(T){T=this.root+T;var A=this.files[T];if(A||(T.slice(-1)!=="/"&&(T+="/"),A=this.files[T]),A&&!A.dir)delete this.files[T];else for(var S=this.filter(function(w,F){return F.name.slice(0,T.length)===T}),_=0;_<S.length;_++)delete this.files[S[_].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(T){var A,S={};try{if((S=a.extend(T||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=S.type.toLowerCase(),S.compression=S.compression.toUpperCase(),S.type==="binarystring"&&(S.type="string"),!S.type)throw new Error("No output type specified.");a.checkSupport(S.type),S.platform!=="darwin"&&S.platform!=="freebsd"&&S.platform!=="linux"&&S.platform!=="sunos"||(S.platform="UNIX"),S.platform==="win32"&&(S.platform="DOS");var _=S.comment||this.comment||"";A=f.generateWorker(this,S,_)}catch(w){(A=new c("error")).error(w)}return new l(A,S.type||"string",S.mimeType)},generateAsync:function(T,A){return this.generateInternalStream(T).accumulate(A)},generateNodeStream:function(T,A){return(T=T||{}).type||(T.type="nodebuffer"),this.generateInternalStream(T).toNodejsStream(A)}};i.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,i,s){i.exports=e("stream")},{stream:void 0}],17:[function(e,i,s){var n=e("./DataReader");function o(a){n.call(this,a);for(var c=0;c<this.data.length;c++)a[c]=255&a[c]}e("../utils").inherits(o,n),o.prototype.byteAt=function(a){return this.data[this.zero+a]},o.prototype.lastIndexOfSignature=function(a){for(var c=a.charCodeAt(0),l=a.charCodeAt(1),h=a.charCodeAt(2),u=a.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===c&&this.data[d+1]===l&&this.data[d+2]===h&&this.data[d+3]===u)return d-this.zero;return-1},o.prototype.readAndCheckSignature=function(a){var c=a.charCodeAt(0),l=a.charCodeAt(1),h=a.charCodeAt(2),u=a.charCodeAt(3),d=this.readData(4);return c===d[0]&&l===d[1]&&h===d[2]&&u===d[3]},o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},i.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,i,s){var n=e("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var c,l=0;for(this.checkOffset(a),c=this.index+a-1;c>=this.index;c--)l=(l<<8)+this.byteAt(c);return this.index+=a,l},readString:function(a){return n.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},i.exports=o},{"../utils":32}],19:[function(e,i,s){var n=e("./Uint8ArrayReader");function o(a){n.call(this,a)}e("../utils").inherits(o,n),o.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},i.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,i,s){var n=e("./DataReader");function o(a){n.call(this,a)}e("../utils").inherits(o,n),o.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},o.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},o.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},o.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},i.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,i,s){var n=e("./ArrayReader");function o(a){n.call(this,a)}e("../utils").inherits(o,n),o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},i.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,i,s){var n=e("../utils"),o=e("../support"),a=e("./ArrayReader"),c=e("./StringReader"),l=e("./NodeBufferReader"),h=e("./Uint8ArrayReader");i.exports=function(u){var d=n.getTypeOf(u);return n.checkSupport(d),d!=="string"||o.uint8array?d==="nodebuffer"?new l(u):o.uint8array?new h(n.transformTo("uint8array",u)):new a(n.transformTo("array",u)):new c(u)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,i,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,i,s){var n=e("./GenericWorker"),o=e("../utils");function a(c){n.call(this,"ConvertWorker to "+c),this.destType=c}o.inherits(a,n),a.prototype.processChunk=function(c){this.push({data:o.transformTo(this.destType,c.data),meta:c.meta})},i.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,i,s){var n=e("./GenericWorker"),o=e("../crc32");function a(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,n),a.prototype.processChunk=function(c){this.streamInfo.crc32=o(c.data,this.streamInfo.crc32||0),this.push(c)},i.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,i,s){var n=e("../utils"),o=e("./GenericWorker");function a(c){o.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}n.inherits(a,o),a.prototype.processChunk=function(c){if(c){var l=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=l+c.data.length}o.prototype.processChunk.call(this,c)},i.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,i,s){var n=e("../utils"),o=e("./GenericWorker");function a(c){o.call(this,"DataWorker");var l=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(h){l.dataIsReady=!0,l.data=h,l.max=h&&h.length||0,l.type=n.getTypeOf(h),l.isPaused||l._tickAndRepeat()},function(h){l.error(h)})}n.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,l=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,l);break;case"uint8array":c=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":c=this.data.slice(this.index,l)}return this.index=l,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,i,s){function n(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var c=0;c<this._listeners[o].length;c++)this._listeners[o][c].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(c){a.processChunk(c)}),o.on("end",function(){a.end()}),o.on("error",function(c){a.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},i.exports=n},{}],29:[function(e,i,s){var n=e("../utils"),o=e("./ConvertWorker"),a=e("./GenericWorker"),c=e("../base64"),l=e("../support"),h=e("../external"),u=null;if(l.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(p,m){return new h.Promise(function(g,I){var C=[],b=p._internalType,E=p._outputType,T=p._mimeType;p.on("data",function(A,S){C.push(A),m&&m(S)}).on("error",function(A){C=[],I(A)}).on("end",function(){try{var A=function(S,_,w){switch(S){case"blob":return n.newBlob(n.transformTo("arraybuffer",_),w);case"base64":return c.encode(_);default:return n.transformTo(S,_)}}(E,function(S,_){var w,F=0,D=null,R=0;for(w=0;w<_.length;w++)R+=_[w].length;switch(S){case"string":return _.join("");case"array":return Array.prototype.concat.apply([],_);case"uint8array":for(D=new Uint8Array(R),w=0;w<_.length;w++)D.set(_[w],F),F+=_[w].length;return D;case"nodebuffer":return Buffer.concat(_);default:throw new Error("concat : unsupported type '"+S+"'")}}(b,C),T);g(A)}catch(S){I(S)}C=[]}).resume()})}function f(p,m,g){var I=m;switch(m){case"blob":case"arraybuffer":I="uint8array";break;case"base64":I="string"}try{this._internalType=I,this._outputType=m,this._mimeType=g,n.checkSupport(I),this._worker=p.pipe(new o(I)),p.lock()}catch(C){this._worker=new a("error"),this._worker.error(C)}}f.prototype={accumulate:function(p){return d(this,p)},on:function(p,m){var g=this;return p==="data"?this._worker.on(p,function(I){m.call(g,I.data,I.meta)}):this._worker.on(p,function(){n.delay(m,arguments,g)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:this._outputType!=="nodebuffer"},p)}},i.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,i,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var n=new ArrayBuffer(0);try{s.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(n),s.blob=o.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!e("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(e,i,s){for(var n=e("./utils"),o=e("./support"),a=e("./nodejsUtils"),c=e("./stream/GenericWorker"),l=new Array(256),h=0;h<256;h++)l[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;l[254]=l[254]=1;function u(){c.call(this,"utf-8 decode"),this.leftOver=null}function d(){c.call(this,"utf-8 encode")}s.utf8encode=function(f){return o.nodebuffer?a.newBufferFrom(f,"utf-8"):function(p){var m,g,I,C,b,E=p.length,T=0;for(C=0;C<E;C++)(64512&(g=p.charCodeAt(C)))==55296&&C+1<E&&(64512&(I=p.charCodeAt(C+1)))==56320&&(g=65536+(g-55296<<10)+(I-56320),C++),T+=g<128?1:g<2048?2:g<65536?3:4;for(m=o.uint8array?new Uint8Array(T):new Array(T),C=b=0;b<T;C++)(64512&(g=p.charCodeAt(C)))==55296&&C+1<E&&(64512&(I=p.charCodeAt(C+1)))==56320&&(g=65536+(g-55296<<10)+(I-56320),C++),g<128?m[b++]=g:(g<2048?m[b++]=192|g>>>6:(g<65536?m[b++]=224|g>>>12:(m[b++]=240|g>>>18,m[b++]=128|g>>>12&63),m[b++]=128|g>>>6&63),m[b++]=128|63&g);return m}(f)},s.utf8decode=function(f){return o.nodebuffer?n.transformTo("nodebuffer",f).toString("utf-8"):function(p){var m,g,I,C,b=p.length,E=new Array(2*b);for(m=g=0;m<b;)if((I=p[m++])<128)E[g++]=I;else if(4<(C=l[I]))E[g++]=65533,m+=C-1;else{for(I&=C===2?31:C===3?15:7;1<C&&m<b;)I=I<<6|63&p[m++],C--;1<C?E[g++]=65533:I<65536?E[g++]=I:(I-=65536,E[g++]=55296|I>>10&1023,E[g++]=56320|1023&I)}return E.length!==g&&(E.subarray?E=E.subarray(0,g):E.length=g),n.applyFromCharCode(E)}(f=n.transformTo(o.uint8array?"uint8array":"array",f))},n.inherits(u,c),u.prototype.processChunk=function(f){var p=n.transformTo(o.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var m=p;(p=new Uint8Array(m.length+this.leftOver.length)).set(this.leftOver,0),p.set(m,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var g=function(C,b){var E;for((b=b||C.length)>C.length&&(b=C.length),E=b-1;0<=E&&(192&C[E])==128;)E--;return E<0||E===0?b:E+l[C[E]]>b?E:b}(p),I=p;g!==p.length&&(o.uint8array?(I=p.subarray(0,g),this.leftOver=p.subarray(g,p.length)):(I=p.slice(0,g),this.leftOver=p.slice(g,p.length))),this.push({data:s.utf8decode(I),meta:f.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=u,n.inherits(d,c),d.prototype.processChunk=function(f){this.push({data:s.utf8encode(f.data),meta:f.meta})},s.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,i,s){var n=e("./support"),o=e("./base64"),a=e("./nodejsUtils"),c=e("./external");function l(m){return m}function h(m,g){for(var I=0;I<m.length;++I)g[I]=255&m.charCodeAt(I);return g}e("setimmediate"),s.newBlob=function(m,g){s.checkSupport("blob");try{return new Blob([m],{type:g})}catch{try{var I=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return I.append(m),I.getBlob(g)}catch{throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(m,g,I){var C=[],b=0,E=m.length;if(E<=I)return String.fromCharCode.apply(null,m);for(;b<E;)g==="array"||g==="nodebuffer"?C.push(String.fromCharCode.apply(null,m.slice(b,Math.min(b+I,E)))):C.push(String.fromCharCode.apply(null,m.subarray(b,Math.min(b+I,E)))),b+=I;return C.join("")},stringifyByChar:function(m){for(var g="",I=0;I<m.length;I++)g+=String.fromCharCode(m[I]);return g},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function d(m){var g=65536,I=s.getTypeOf(m),C=!0;if(I==="uint8array"?C=u.applyCanBeUsed.uint8array:I==="nodebuffer"&&(C=u.applyCanBeUsed.nodebuffer),C)for(;1<g;)try{return u.stringifyByChunk(m,I,g)}catch{g=Math.floor(g/2)}return u.stringifyByChar(m)}function f(m,g){for(var I=0;I<m.length;I++)g[I]=m[I];return g}s.applyFromCharCode=d;var p={};p.string={string:l,array:function(m){return h(m,new Array(m.length))},arraybuffer:function(m){return p.string.uint8array(m).buffer},uint8array:function(m){return h(m,new Uint8Array(m.length))},nodebuffer:function(m){return h(m,a.allocBuffer(m.length))}},p.array={string:d,array:l,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return a.newBufferFrom(m)}},p.arraybuffer={string:function(m){return d(new Uint8Array(m))},array:function(m){return f(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:l,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return a.newBufferFrom(new Uint8Array(m))}},p.uint8array={string:d,array:function(m){return f(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:l,nodebuffer:function(m){return a.newBufferFrom(m)}},p.nodebuffer={string:d,array:function(m){return f(m,new Array(m.length))},arraybuffer:function(m){return p.nodebuffer.uint8array(m).buffer},uint8array:function(m){return f(m,new Uint8Array(m.length))},nodebuffer:l},s.transformTo=function(m,g){if(g=g||"",!m)return g;s.checkSupport(m);var I=s.getTypeOf(g);return p[I][m](g)},s.resolve=function(m){for(var g=m.split("/"),I=[],C=0;C<g.length;C++){var b=g[C];b==="."||b===""&&C!==0&&C!==g.length-1||(b===".."?I.pop():I.push(b))}return I.join("/")},s.getTypeOf=function(m){return typeof m=="string"?"string":Object.prototype.toString.call(m)==="[object Array]"?"array":n.nodebuffer&&a.isBuffer(m)?"nodebuffer":n.uint8array&&m instanceof Uint8Array?"uint8array":n.arraybuffer&&m instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(m){if(!n[m.toLowerCase()])throw new Error(m+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(m){var g,I,C="";for(I=0;I<(m||"").length;I++)C+="\\x"+((g=m.charCodeAt(I))<16?"0":"")+g.toString(16).toUpperCase();return C},s.delay=function(m,g,I){setImmediate(function(){m.apply(I||null,g||[])})},s.inherits=function(m,g){function I(){}I.prototype=g.prototype,m.prototype=new I},s.extend=function(){var m,g,I={};for(m=0;m<arguments.length;m++)for(g in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],g)&&I[g]===void 0&&(I[g]=arguments[m][g]);return I},s.prepareContent=function(m,g,I,C,b){return c.Promise.resolve(g).then(function(E){return n.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader<"u"?new c.Promise(function(T,A){var S=new FileReader;S.onload=function(_){T(_.target.result)},S.onerror=function(_){A(_.target.error)},S.readAsArrayBuffer(E)}):E}).then(function(E){var T=s.getTypeOf(E);return T?(T==="arraybuffer"?E=s.transformTo("uint8array",E):T==="string"&&(b?E=o.decode(E):I&&C!==!0&&(E=function(A){return h(A,n.uint8array?new Uint8Array(A.length):new Array(A.length))}(E))),E):c.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,i,s){var n=e("./reader/readerFor"),o=e("./utils"),a=e("./signature"),c=e("./zipEntry"),l=e("./support");function h(u){this.files=[],this.loadOptions=u}h.prototype={checkSignature:function(u){if(!this.reader.readAndCheckSignature(u)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(d)+", expected "+o.pretty(u)+")")}},isSignature:function(u,d){var f=this.reader.index;this.reader.setIndex(u);var p=this.reader.readString(4)===d;return this.reader.setIndex(f),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var u=this.reader.readData(this.zipCommentLength),d=l.uint8array?"uint8array":"array",f=o.transformTo(d,u);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var u,d,f,p=this.zip64EndOfCentralSize-44;0<p;)u=this.reader.readInt(2),d=this.reader.readInt(4),f=this.reader.readData(d),this.zip64ExtensibleData[u]={id:u,length:d,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var u,d;for(u=0;u<this.files.length;u++)d=this.files[u],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var u;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(u=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(u);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var u=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(u<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(u);var d=u;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(u=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(u),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var p=d-f;if(0<p)this.isSignature(d,a.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(u){this.reader=n(u)},load:function(u){this.prepareReader(u),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,i,s){var n=e("./reader/readerFor"),o=e("./utils"),a=e("./compressedObject"),c=e("./crc32"),l=e("./utf8"),h=e("./compressions"),u=e("./support");function d(f,p){this.options=f,this.loadOptions=p}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var p,m;if(f.skip(22),this.fileNameLength=f.readInt(2),m=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=function(g){for(var I in h)if(Object.prototype.hasOwnProperty.call(h,I)&&h[I].magic===g)return h[I];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,p,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var p=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(p),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=n(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var p,m,g,I=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<I;)p=f.readInt(2),m=f.readInt(2),g=f.readData(m),this.extraFields[p]={id:p,length:m,value:g};f.setIndex(I)},handleUTF8:function(){var f=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var m=o.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var g=this.findExtraFieldUnicodeComment();if(g!==null)this.fileCommentStr=g;else{var I=o.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(I)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var p=n(f.value);return p.readInt(1)!==1||c(this.fileName)!==p.readInt(4)?null:l.utf8decode(p.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var p=n(f.value);return p.readInt(1)!==1||c(this.fileComment)!==p.readInt(4)?null:l.utf8decode(p.readData(f.length-5))}return null}},i.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,i,s){function n(p,m,g){this.name=p,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=m,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}}var o=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),c=e("./utf8"),l=e("./compressedObject"),h=e("./stream/GenericWorker");n.prototype={internalStream:function(p){var m=null,g="string";try{if(!p)throw new Error("No output type specified.");var I=(g=p.toLowerCase())==="string"||g==="text";g!=="binarystring"&&g!=="text"||(g="string"),m=this._decompressWorker();var C=!this._dataBinary;C&&!I&&(m=m.pipe(new c.Utf8EncodeWorker)),!C&&I&&(m=m.pipe(new c.Utf8DecodeWorker))}catch(b){(m=new h("error")).error(b)}return new o(m,g,"")},async:function(p,m){return this.internalStream(p).accumulate(m)},nodeStream:function(p,m){return this.internalStream(p||"nodebuffer").toNodejsStream(m)},_compressWorker:function(p,m){if(this._data instanceof l&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new c.Utf8EncodeWorker)),l.createWorkerFrom(g,p,m)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof h?this._data:new a(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<u.length;f++)n.prototype[u[f]]=d;i.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,i,s){(function(n){var o,a,c=n.MutationObserver||n.WebKitMutationObserver;if(c){var l=0,h=new c(p),u=n.document.createTextNode("");h.observe(u,{characterData:!0}),o=function(){u.data=l=++l%2}}else if(n.setImmediate||n.MessageChannel===void 0)o="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var m=n.document.createElement("script");m.onreadystatechange=function(){p(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},n.document.documentElement.appendChild(m)}:function(){setTimeout(p,0)};else{var d=new n.MessageChannel;d.port1.onmessage=p,o=function(){d.port2.postMessage(0)}}var f=[];function p(){var m,g;a=!0;for(var I=f.length;I;){for(g=f,f=[],m=-1;++m<I;)g[m]();I=f.length}a=!1}i.exports=function(m){f.push(m)!==1||a||o()}}).call(this,typeof Nd<"u"?Nd:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,i,s){var n=e("immediate");function o(){}var a={},c=["REJECTED"],l=["FULFILLED"],h=["PENDING"];function u(I){if(typeof I!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,I!==o&&m(this,I)}function d(I,C,b){this.promise=I,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function f(I,C,b){n(function(){var E;try{E=C(b)}catch(T){return a.reject(I,T)}E===I?a.reject(I,new TypeError("Cannot resolve promise with itself")):a.resolve(I,E)})}function p(I){var C=I&&I.then;if(I&&(typeof I=="object"||typeof I=="function")&&typeof C=="function")return function(){C.apply(I,arguments)}}function m(I,C){var b=!1;function E(S){b||(b=!0,a.reject(I,S))}function T(S){b||(b=!0,a.resolve(I,S))}var A=g(function(){C(T,E)});A.status==="error"&&E(A.value)}function g(I,C){var b={};try{b.value=I(C),b.status="success"}catch(E){b.status="error",b.value=E}return b}(i.exports=u).prototype.finally=function(I){if(typeof I!="function")return this;var C=this.constructor;return this.then(function(b){return C.resolve(I()).then(function(){return b})},function(b){return C.resolve(I()).then(function(){throw b})})},u.prototype.catch=function(I){return this.then(null,I)},u.prototype.then=function(I,C){if(typeof I!="function"&&this.state===l||typeof C!="function"&&this.state===c)return this;var b=new this.constructor(o);return this.state!==h?f(b,this.state===l?I:C,this.outcome):this.queue.push(new d(b,I,C)),b},d.prototype.callFulfilled=function(I){a.resolve(this.promise,I)},d.prototype.otherCallFulfilled=function(I){f(this.promise,this.onFulfilled,I)},d.prototype.callRejected=function(I){a.reject(this.promise,I)},d.prototype.otherCallRejected=function(I){f(this.promise,this.onRejected,I)},a.resolve=function(I,C){var b=g(p,C);if(b.status==="error")return a.reject(I,b.value);var E=b.value;if(E)m(I,E);else{I.state=l,I.outcome=C;for(var T=-1,A=I.queue.length;++T<A;)I.queue[T].callFulfilled(C)}return I},a.reject=function(I,C){I.state=c,I.outcome=C;for(var b=-1,E=I.queue.length;++b<E;)I.queue[b].callRejected(C);return I},u.resolve=function(I){return I instanceof this?I:a.resolve(new this(o),I)},u.reject=function(I){var C=new this(o);return a.reject(C,I)},u.all=function(I){var C=this;if(Object.prototype.toString.call(I)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=I.length,E=!1;if(!b)return this.resolve([]);for(var T=new Array(b),A=0,S=-1,_=new this(o);++S<b;)w(I[S],S);return _;function w(F,D){C.resolve(F).then(function(R){T[D]=R,++A!==b||E||(E=!0,a.resolve(_,T))},function(R){E||(E=!0,a.reject(_,R))})}},u.race=function(I){var C=this;if(Object.prototype.toString.call(I)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=I.length,E=!1;if(!b)return this.resolve([]);for(var T=-1,A=new this(o);++T<b;)S=I[T],C.resolve(S).then(function(_){E||(E=!0,a.resolve(A,_))},function(_){E||(E=!0,a.reject(A,_))});var S;return A}},{immediate:36}],38:[function(e,i,s){var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),i.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,i,s){var n=e("./zlib/deflate"),o=e("./utils/common"),a=e("./utils/strings"),c=e("./zlib/messages"),l=e("./zlib/zstream"),h=Object.prototype.toString,u=0,d=-1,f=0,p=8;function m(I){if(!(this instanceof m))return new m(I);this.options=o.assign({level:d,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},I||{});var C=this.options;C.raw&&0<C.windowBits?C.windowBits=-C.windowBits:C.gzip&&0<C.windowBits&&C.windowBits<16&&(C.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var b=n.deflateInit2(this.strm,C.level,C.method,C.windowBits,C.memLevel,C.strategy);if(b!==u)throw new Error(c[b]);if(C.header&&n.deflateSetHeader(this.strm,C.header),C.dictionary){var E;if(E=typeof C.dictionary=="string"?a.string2buf(C.dictionary):h.call(C.dictionary)==="[object ArrayBuffer]"?new Uint8Array(C.dictionary):C.dictionary,(b=n.deflateSetDictionary(this.strm,E))!==u)throw new Error(c[b]);this._dict_set=!0}}function g(I,C){var b=new m(C);if(b.push(I,!0),b.err)throw b.msg||c[b.err];return b.result}m.prototype.push=function(I,C){var b,E,T=this.strm,A=this.options.chunkSize;if(this.ended)return!1;E=C===~~C?C:C===!0?4:0,typeof I=="string"?T.input=a.string2buf(I):h.call(I)==="[object ArrayBuffer]"?T.input=new Uint8Array(I):T.input=I,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new o.Buf8(A),T.next_out=0,T.avail_out=A),(b=n.deflate(T,E))!==1&&b!==u)return this.onEnd(b),!(this.ended=!0);T.avail_out!==0&&(T.avail_in!==0||E!==4&&E!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(T.output,T.next_out))):this.onData(o.shrinkBuf(T.output,T.next_out)))}while((0<T.avail_in||T.avail_out===0)&&b!==1);return E===4?(b=n.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===u):E!==2||(this.onEnd(u),!(T.avail_out=0))},m.prototype.onData=function(I){this.chunks.push(I)},m.prototype.onEnd=function(I){I===u&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=I,this.msg=this.strm.msg},s.Deflate=m,s.deflate=g,s.deflateRaw=function(I,C){return(C=C||{}).raw=!0,g(I,C)},s.gzip=function(I,C){return(C=C||{}).gzip=!0,g(I,C)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,i,s){var n=e("./zlib/inflate"),o=e("./utils/common"),a=e("./utils/strings"),c=e("./zlib/constants"),l=e("./zlib/messages"),h=e("./zlib/zstream"),u=e("./zlib/gzheader"),d=Object.prototype.toString;function f(m){if(!(this instanceof f))return new f(m);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},m||{});var g=this.options;g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),!(0<=g.windowBits&&g.windowBits<16)||m&&m.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&!(15&g.windowBits)&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var I=n.inflateInit2(this.strm,g.windowBits);if(I!==c.Z_OK)throw new Error(l[I]);this.header=new u,n.inflateGetHeader(this.strm,this.header)}function p(m,g){var I=new f(g);if(I.push(m,!0),I.err)throw I.msg||l[I.err];return I.result}f.prototype.push=function(m,g){var I,C,b,E,T,A,S=this.strm,_=this.options.chunkSize,w=this.options.dictionary,F=!1;if(this.ended)return!1;C=g===~~g?g:g===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof m=="string"?S.input=a.binstring2buf(m):d.call(m)==="[object ArrayBuffer]"?S.input=new Uint8Array(m):S.input=m,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new o.Buf8(_),S.next_out=0,S.avail_out=_),(I=n.inflate(S,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&w&&(A=typeof w=="string"?a.string2buf(w):d.call(w)==="[object ArrayBuffer]"?new Uint8Array(w):w,I=n.inflateSetDictionary(this.strm,A)),I===c.Z_BUF_ERROR&&F===!0&&(I=c.Z_OK,F=!1),I!==c.Z_STREAM_END&&I!==c.Z_OK)return this.onEnd(I),!(this.ended=!0);S.next_out&&(S.avail_out!==0&&I!==c.Z_STREAM_END&&(S.avail_in!==0||C!==c.Z_FINISH&&C!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=a.utf8border(S.output,S.next_out),E=S.next_out-b,T=a.buf2string(S.output,b),S.next_out=E,S.avail_out=_-E,E&&o.arraySet(S.output,S.output,b,E,0),this.onData(T)):this.onData(o.shrinkBuf(S.output,S.next_out)))),S.avail_in===0&&S.avail_out===0&&(F=!0)}while((0<S.avail_in||S.avail_out===0)&&I!==c.Z_STREAM_END);return I===c.Z_STREAM_END&&(C=c.Z_FINISH),C===c.Z_FINISH?(I=n.inflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===c.Z_OK):C!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(S.avail_out=0))},f.prototype.onData=function(m){this.chunks.push(m)},f.prototype.onEnd=function(m){m===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},s.Inflate=f,s.inflate=p,s.inflateRaw=function(m,g){return(g=g||{}).raw=!0,p(m,g)},s.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,i,s){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(c){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var h=l.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var u in h)h.hasOwnProperty(u)&&(c[u]=h[u])}}return c},s.shrinkBuf=function(c,l){return c.length===l?c:c.subarray?c.subarray(0,l):(c.length=l,c)};var o={arraySet:function(c,l,h,u,d){if(l.subarray&&c.subarray)c.set(l.subarray(h,h+u),d);else for(var f=0;f<u;f++)c[d+f]=l[h+f]},flattenChunks:function(c){var l,h,u,d,f,p;for(l=u=0,h=c.length;l<h;l++)u+=c[l].length;for(p=new Uint8Array(u),l=d=0,h=c.length;l<h;l++)f=c[l],p.set(f,d),d+=f.length;return p}},a={arraySet:function(c,l,h,u,d){for(var f=0;f<u;f++)c[d+f]=l[h+f]},flattenChunks:function(c){return[].concat.apply([],c)}};s.setTyped=function(c){c?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,o)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,a))},s.setTyped(n)},{}],42:[function(e,i,s){var n=e("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var c=new n.Buf8(256),l=0;l<256;l++)c[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function h(u,d){if(d<65537&&(u.subarray&&a||!u.subarray&&o))return String.fromCharCode.apply(null,n.shrinkBuf(u,d));for(var f="",p=0;p<d;p++)f+=String.fromCharCode(u[p]);return f}c[254]=c[254]=1,s.string2buf=function(u){var d,f,p,m,g,I=u.length,C=0;for(m=0;m<I;m++)(64512&(f=u.charCodeAt(m)))==55296&&m+1<I&&(64512&(p=u.charCodeAt(m+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),m++),C+=f<128?1:f<2048?2:f<65536?3:4;for(d=new n.Buf8(C),m=g=0;g<C;m++)(64512&(f=u.charCodeAt(m)))==55296&&m+1<I&&(64512&(p=u.charCodeAt(m+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),m++),f<128?d[g++]=f:(f<2048?d[g++]=192|f>>>6:(f<65536?d[g++]=224|f>>>12:(d[g++]=240|f>>>18,d[g++]=128|f>>>12&63),d[g++]=128|f>>>6&63),d[g++]=128|63&f);return d},s.buf2binstring=function(u){return h(u,u.length)},s.binstring2buf=function(u){for(var d=new n.Buf8(u.length),f=0,p=d.length;f<p;f++)d[f]=u.charCodeAt(f);return d},s.buf2string=function(u,d){var f,p,m,g,I=d||u.length,C=new Array(2*I);for(f=p=0;f<I;)if((m=u[f++])<128)C[p++]=m;else if(4<(g=c[m]))C[p++]=65533,f+=g-1;else{for(m&=g===2?31:g===3?15:7;1<g&&f<I;)m=m<<6|63&u[f++],g--;1<g?C[p++]=65533:m<65536?C[p++]=m:(m-=65536,C[p++]=55296|m>>10&1023,C[p++]=56320|1023&m)}return h(C,p)},s.utf8border=function(u,d){var f;for((d=d||u.length)>u.length&&(d=u.length),f=d-1;0<=f&&(192&u[f])==128;)f--;return f<0||f===0?d:f+c[u[f]]>d?f:d}},{"./common":41}],43:[function(e,i,s){i.exports=function(n,o,a,c){for(var l=65535&n|0,h=n>>>16&65535|0,u=0;a!==0;){for(a-=u=2e3<a?2e3:a;h=h+(l=l+o[c++]|0)|0,--u;);l%=65521,h%=65521}return l|h<<16|0}},{}],44:[function(e,i,s){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,i,s){var n=function(){for(var o,a=[],c=0;c<256;c++){o=c;for(var l=0;l<8;l++)o=1&o?3988292384^o>>>1:o>>>1;a[c]=o}return a}();i.exports=function(o,a,c,l){var h=n,u=l+c;o^=-1;for(var d=l;d<u;d++)o=o>>>8^h[255&(o^a[d])];return-1^o}},{}],46:[function(e,i,s){var n,o=e("../utils/common"),a=e("./trees"),c=e("./adler32"),l=e("./crc32"),h=e("./messages"),u=0,d=4,f=0,p=-2,m=-1,g=4,I=2,C=8,b=9,E=286,T=30,A=19,S=2*E+1,_=15,w=3,F=258,D=F+w+1,R=42,O=113,y=1,U=2,H=3,k=4;function X(v,j){return v.msg=h[j],j}function $(v){return(v<<1)-(4<v?9:0)}function et(v){for(var j=v.length;0<=--j;)v[j]=0}function Y(v){var j=v.state,W=j.pending;W>v.avail_out&&(W=v.avail_out),W!==0&&(o.arraySet(v.output,j.pending_buf,j.pending_out,W,v.next_out),v.next_out+=W,j.pending_out+=W,v.total_out+=W,v.avail_out-=W,j.pending-=W,j.pending===0&&(j.pending_out=0))}function z(v,j){a._tr_flush_block(v,0<=v.block_start?v.block_start:-1,v.strstart-v.block_start,j),v.block_start=v.strstart,Y(v.strm)}function st(v,j){v.pending_buf[v.pending++]=j}function K(v,j){v.pending_buf[v.pending++]=j>>>8&255,v.pending_buf[v.pending++]=255&j}function Q(v,j){var W,N,x=v.max_chain_length,V=v.strstart,Z=v.prev_length,q=v.nice_match,G=v.strstart>v.w_size-D?v.strstart-(v.w_size-D):0,J=v.window,ot=v.w_mask,tt=v.prev,ft=v.strstart+F,At=J[V+Z-1],bt=J[V+Z];v.prev_length>=v.good_match&&(x>>=2),q>v.lookahead&&(q=v.lookahead);do if(J[(W=j)+Z]===bt&&J[W+Z-1]===At&&J[W]===J[V]&&J[++W]===J[V+1]){V+=2,W++;do;while(J[++V]===J[++W]&&J[++V]===J[++W]&&J[++V]===J[++W]&&J[++V]===J[++W]&&J[++V]===J[++W]&&J[++V]===J[++W]&&J[++V]===J[++W]&&J[++V]===J[++W]&&V<ft);if(N=F-(ft-V),V=ft-F,Z<N){if(v.match_start=j,q<=(Z=N))break;At=J[V+Z-1],bt=J[V+Z]}}while((j=tt[j&ot])>G&&--x!=0);return Z<=v.lookahead?Z:v.lookahead}function gt(v){var j,W,N,x,V,Z,q,G,J,ot,tt=v.w_size;do{if(x=v.window_size-v.lookahead-v.strstart,v.strstart>=tt+(tt-D)){for(o.arraySet(v.window,v.window,tt,tt,0),v.match_start-=tt,v.strstart-=tt,v.block_start-=tt,j=W=v.hash_size;N=v.head[--j],v.head[j]=tt<=N?N-tt:0,--W;);for(j=W=tt;N=v.prev[--j],v.prev[j]=tt<=N?N-tt:0,--W;);x+=tt}if(v.strm.avail_in===0)break;if(Z=v.strm,q=v.window,G=v.strstart+v.lookahead,J=x,ot=void 0,ot=Z.avail_in,J<ot&&(ot=J),W=ot===0?0:(Z.avail_in-=ot,o.arraySet(q,Z.input,Z.next_in,ot,G),Z.state.wrap===1?Z.adler=c(Z.adler,q,ot,G):Z.state.wrap===2&&(Z.adler=l(Z.adler,q,ot,G)),Z.next_in+=ot,Z.total_in+=ot,ot),v.lookahead+=W,v.lookahead+v.insert>=w)for(V=v.strstart-v.insert,v.ins_h=v.window[V],v.ins_h=(v.ins_h<<v.hash_shift^v.window[V+1])&v.hash_mask;v.insert&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[V+w-1])&v.hash_mask,v.prev[V&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=V,V++,v.insert--,!(v.lookahead+v.insert<w)););}while(v.lookahead<D&&v.strm.avail_in!==0)}function Ct(v,j){for(var W,N;;){if(v.lookahead<D){if(gt(v),v.lookahead<D&&j===u)return y;if(v.lookahead===0)break}if(W=0,v.lookahead>=w&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+w-1])&v.hash_mask,W=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),W!==0&&v.strstart-W<=v.w_size-D&&(v.match_length=Q(v,W)),v.match_length>=w)if(N=a._tr_tally(v,v.strstart-v.match_start,v.match_length-w),v.lookahead-=v.match_length,v.match_length<=v.max_lazy_match&&v.lookahead>=w){for(v.match_length--;v.strstart++,v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+w-1])&v.hash_mask,W=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart,--v.match_length!=0;);v.strstart++}else v.strstart+=v.match_length,v.match_length=0,v.ins_h=v.window[v.strstart],v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+1])&v.hash_mask;else N=a._tr_tally(v,0,v.window[v.strstart]),v.lookahead--,v.strstart++;if(N&&(z(v,!1),v.strm.avail_out===0))return y}return v.insert=v.strstart<w-1?v.strstart:w-1,j===d?(z(v,!0),v.strm.avail_out===0?H:k):v.last_lit&&(z(v,!1),v.strm.avail_out===0)?y:U}function lt(v,j){for(var W,N,x;;){if(v.lookahead<D){if(gt(v),v.lookahead<D&&j===u)return y;if(v.lookahead===0)break}if(W=0,v.lookahead>=w&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+w-1])&v.hash_mask,W=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),v.prev_length=v.match_length,v.prev_match=v.match_start,v.match_length=w-1,W!==0&&v.prev_length<v.max_lazy_match&&v.strstart-W<=v.w_size-D&&(v.match_length=Q(v,W),v.match_length<=5&&(v.strategy===1||v.match_length===w&&4096<v.strstart-v.match_start)&&(v.match_length=w-1)),v.prev_length>=w&&v.match_length<=v.prev_length){for(x=v.strstart+v.lookahead-w,N=a._tr_tally(v,v.strstart-1-v.prev_match,v.prev_length-w),v.lookahead-=v.prev_length-1,v.prev_length-=2;++v.strstart<=x&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+w-1])&v.hash_mask,W=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),--v.prev_length!=0;);if(v.match_available=0,v.match_length=w-1,v.strstart++,N&&(z(v,!1),v.strm.avail_out===0))return y}else if(v.match_available){if((N=a._tr_tally(v,0,v.window[v.strstart-1]))&&z(v,!1),v.strstart++,v.lookahead--,v.strm.avail_out===0)return y}else v.match_available=1,v.strstart++,v.lookahead--}return v.match_available&&(N=a._tr_tally(v,0,v.window[v.strstart-1]),v.match_available=0),v.insert=v.strstart<w-1?v.strstart:w-1,j===d?(z(v,!0),v.strm.avail_out===0?H:k):v.last_lit&&(z(v,!1),v.strm.avail_out===0)?y:U}function pt(v,j,W,N,x){this.good_length=v,this.max_lazy=j,this.nice_length=W,this.max_chain=N,this.func=x}function mt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=C,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*S),this.dyn_dtree=new o.Buf16(2*(2*T+1)),this.bl_tree=new o.Buf16(2*(2*A+1)),et(this.dyn_ltree),et(this.dyn_dtree),et(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(_+1),this.heap=new o.Buf16(2*E+1),et(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*E+1),et(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function yt(v){var j;return v&&v.state?(v.total_in=v.total_out=0,v.data_type=I,(j=v.state).pending=0,j.pending_out=0,j.wrap<0&&(j.wrap=-j.wrap),j.status=j.wrap?R:O,v.adler=j.wrap===2?0:1,j.last_flush=u,a._tr_init(j),f):X(v,p)}function zt(v){var j=yt(v);return j===f&&function(W){W.window_size=2*W.w_size,et(W.head),W.max_lazy_match=n[W.level].max_lazy,W.good_match=n[W.level].good_length,W.nice_match=n[W.level].nice_length,W.max_chain_length=n[W.level].max_chain,W.strstart=0,W.block_start=0,W.lookahead=0,W.insert=0,W.match_length=W.prev_length=w-1,W.match_available=0,W.ins_h=0}(v.state),j}function Lt(v,j,W,N,x,V){if(!v)return p;var Z=1;if(j===m&&(j=6),N<0?(Z=0,N=-N):15<N&&(Z=2,N-=16),x<1||b<x||W!==C||N<8||15<N||j<0||9<j||V<0||g<V)return X(v,p);N===8&&(N=9);var q=new mt;return(v.state=q).strm=v,q.wrap=Z,q.gzhead=null,q.w_bits=N,q.w_size=1<<q.w_bits,q.w_mask=q.w_size-1,q.hash_bits=x+7,q.hash_size=1<<q.hash_bits,q.hash_mask=q.hash_size-1,q.hash_shift=~~((q.hash_bits+w-1)/w),q.window=new o.Buf8(2*q.w_size),q.head=new o.Buf16(q.hash_size),q.prev=new o.Buf16(q.w_size),q.lit_bufsize=1<<x+6,q.pending_buf_size=4*q.lit_bufsize,q.pending_buf=new o.Buf8(q.pending_buf_size),q.d_buf=1*q.lit_bufsize,q.l_buf=3*q.lit_bufsize,q.level=j,q.strategy=V,q.method=W,zt(v)}n=[new pt(0,0,0,0,function(v,j){var W=65535;for(W>v.pending_buf_size-5&&(W=v.pending_buf_size-5);;){if(v.lookahead<=1){if(gt(v),v.lookahead===0&&j===u)return y;if(v.lookahead===0)break}v.strstart+=v.lookahead,v.lookahead=0;var N=v.block_start+W;if((v.strstart===0||v.strstart>=N)&&(v.lookahead=v.strstart-N,v.strstart=N,z(v,!1),v.strm.avail_out===0)||v.strstart-v.block_start>=v.w_size-D&&(z(v,!1),v.strm.avail_out===0))return y}return v.insert=0,j===d?(z(v,!0),v.strm.avail_out===0?H:k):(v.strstart>v.block_start&&(z(v,!1),v.strm.avail_out),y)}),new pt(4,4,8,4,Ct),new pt(4,5,16,8,Ct),new pt(4,6,32,32,Ct),new pt(4,4,16,16,lt),new pt(8,16,32,32,lt),new pt(8,16,128,128,lt),new pt(8,32,128,256,lt),new pt(32,128,258,1024,lt),new pt(32,258,258,4096,lt)],s.deflateInit=function(v,j){return Lt(v,j,C,15,8,0)},s.deflateInit2=Lt,s.deflateReset=zt,s.deflateResetKeep=yt,s.deflateSetHeader=function(v,j){return v&&v.state?v.state.wrap!==2?p:(v.state.gzhead=j,f):p},s.deflate=function(v,j){var W,N,x,V;if(!v||!v.state||5<j||j<0)return v?X(v,p):p;if(N=v.state,!v.output||!v.input&&v.avail_in!==0||N.status===666&&j!==d)return X(v,v.avail_out===0?-5:p);if(N.strm=v,W=N.last_flush,N.last_flush=j,N.status===R)if(N.wrap===2)v.adler=0,st(N,31),st(N,139),st(N,8),N.gzhead?(st(N,(N.gzhead.text?1:0)+(N.gzhead.hcrc?2:0)+(N.gzhead.extra?4:0)+(N.gzhead.name?8:0)+(N.gzhead.comment?16:0)),st(N,255&N.gzhead.time),st(N,N.gzhead.time>>8&255),st(N,N.gzhead.time>>16&255),st(N,N.gzhead.time>>24&255),st(N,N.level===9?2:2<=N.strategy||N.level<2?4:0),st(N,255&N.gzhead.os),N.gzhead.extra&&N.gzhead.extra.length&&(st(N,255&N.gzhead.extra.length),st(N,N.gzhead.extra.length>>8&255)),N.gzhead.hcrc&&(v.adler=l(v.adler,N.pending_buf,N.pending,0)),N.gzindex=0,N.status=69):(st(N,0),st(N,0),st(N,0),st(N,0),st(N,0),st(N,N.level===9?2:2<=N.strategy||N.level<2?4:0),st(N,3),N.status=O);else{var Z=C+(N.w_bits-8<<4)<<8;Z|=(2<=N.strategy||N.level<2?0:N.level<6?1:N.level===6?2:3)<<6,N.strstart!==0&&(Z|=32),Z+=31-Z%31,N.status=O,K(N,Z),N.strstart!==0&&(K(N,v.adler>>>16),K(N,65535&v.adler)),v.adler=1}if(N.status===69)if(N.gzhead.extra){for(x=N.pending;N.gzindex<(65535&N.gzhead.extra.length)&&(N.pending!==N.pending_buf_size||(N.gzhead.hcrc&&N.pending>x&&(v.adler=l(v.adler,N.pending_buf,N.pending-x,x)),Y(v),x=N.pending,N.pending!==N.pending_buf_size));)st(N,255&N.gzhead.extra[N.gzindex]),N.gzindex++;N.gzhead.hcrc&&N.pending>x&&(v.adler=l(v.adler,N.pending_buf,N.pending-x,x)),N.gzindex===N.gzhead.extra.length&&(N.gzindex=0,N.status=73)}else N.status=73;if(N.status===73)if(N.gzhead.name){x=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>x&&(v.adler=l(v.adler,N.pending_buf,N.pending-x,x)),Y(v),x=N.pending,N.pending===N.pending_buf_size)){V=1;break}V=N.gzindex<N.gzhead.name.length?255&N.gzhead.name.charCodeAt(N.gzindex++):0,st(N,V)}while(V!==0);N.gzhead.hcrc&&N.pending>x&&(v.adler=l(v.adler,N.pending_buf,N.pending-x,x)),V===0&&(N.gzindex=0,N.status=91)}else N.status=91;if(N.status===91)if(N.gzhead.comment){x=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>x&&(v.adler=l(v.adler,N.pending_buf,N.pending-x,x)),Y(v),x=N.pending,N.pending===N.pending_buf_size)){V=1;break}V=N.gzindex<N.gzhead.comment.length?255&N.gzhead.comment.charCodeAt(N.gzindex++):0,st(N,V)}while(V!==0);N.gzhead.hcrc&&N.pending>x&&(v.adler=l(v.adler,N.pending_buf,N.pending-x,x)),V===0&&(N.status=103)}else N.status=103;if(N.status===103&&(N.gzhead.hcrc?(N.pending+2>N.pending_buf_size&&Y(v),N.pending+2<=N.pending_buf_size&&(st(N,255&v.adler),st(N,v.adler>>8&255),v.adler=0,N.status=O)):N.status=O),N.pending!==0){if(Y(v),v.avail_out===0)return N.last_flush=-1,f}else if(v.avail_in===0&&$(j)<=$(W)&&j!==d)return X(v,-5);if(N.status===666&&v.avail_in!==0)return X(v,-5);if(v.avail_in!==0||N.lookahead!==0||j!==u&&N.status!==666){var q=N.strategy===2?function(G,J){for(var ot;;){if(G.lookahead===0&&(gt(G),G.lookahead===0)){if(J===u)return y;break}if(G.match_length=0,ot=a._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++,ot&&(z(G,!1),G.strm.avail_out===0))return y}return G.insert=0,J===d?(z(G,!0),G.strm.avail_out===0?H:k):G.last_lit&&(z(G,!1),G.strm.avail_out===0)?y:U}(N,j):N.strategy===3?function(G,J){for(var ot,tt,ft,At,bt=G.window;;){if(G.lookahead<=F){if(gt(G),G.lookahead<=F&&J===u)return y;if(G.lookahead===0)break}if(G.match_length=0,G.lookahead>=w&&0<G.strstart&&(tt=bt[ft=G.strstart-1])===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]){At=G.strstart+F;do;while(tt===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]&&tt===bt[++ft]&&ft<At);G.match_length=F-(At-ft),G.match_length>G.lookahead&&(G.match_length=G.lookahead)}if(G.match_length>=w?(ot=a._tr_tally(G,1,G.match_length-w),G.lookahead-=G.match_length,G.strstart+=G.match_length,G.match_length=0):(ot=a._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++),ot&&(z(G,!1),G.strm.avail_out===0))return y}return G.insert=0,J===d?(z(G,!0),G.strm.avail_out===0?H:k):G.last_lit&&(z(G,!1),G.strm.avail_out===0)?y:U}(N,j):n[N.level].func(N,j);if(q!==H&&q!==k||(N.status=666),q===y||q===H)return v.avail_out===0&&(N.last_flush=-1),f;if(q===U&&(j===1?a._tr_align(N):j!==5&&(a._tr_stored_block(N,0,0,!1),j===3&&(et(N.head),N.lookahead===0&&(N.strstart=0,N.block_start=0,N.insert=0))),Y(v),v.avail_out===0))return N.last_flush=-1,f}return j!==d?f:N.wrap<=0?1:(N.wrap===2?(st(N,255&v.adler),st(N,v.adler>>8&255),st(N,v.adler>>16&255),st(N,v.adler>>24&255),st(N,255&v.total_in),st(N,v.total_in>>8&255),st(N,v.total_in>>16&255),st(N,v.total_in>>24&255)):(K(N,v.adler>>>16),K(N,65535&v.adler)),Y(v),0<N.wrap&&(N.wrap=-N.wrap),N.pending!==0?f:1)},s.deflateEnd=function(v){var j;return v&&v.state?(j=v.state.status)!==R&&j!==69&&j!==73&&j!==91&&j!==103&&j!==O&&j!==666?X(v,p):(v.state=null,j===O?X(v,-3):f):p},s.deflateSetDictionary=function(v,j){var W,N,x,V,Z,q,G,J,ot=j.length;if(!v||!v.state||(V=(W=v.state).wrap)===2||V===1&&W.status!==R||W.lookahead)return p;for(V===1&&(v.adler=c(v.adler,j,ot,0)),W.wrap=0,ot>=W.w_size&&(V===0&&(et(W.head),W.strstart=0,W.block_start=0,W.insert=0),J=new o.Buf8(W.w_size),o.arraySet(J,j,ot-W.w_size,W.w_size,0),j=J,ot=W.w_size),Z=v.avail_in,q=v.next_in,G=v.input,v.avail_in=ot,v.next_in=0,v.input=j,gt(W);W.lookahead>=w;){for(N=W.strstart,x=W.lookahead-(w-1);W.ins_h=(W.ins_h<<W.hash_shift^W.window[N+w-1])&W.hash_mask,W.prev[N&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=N,N++,--x;);W.strstart=N,W.lookahead=w-1,gt(W)}return W.strstart+=W.lookahead,W.block_start=W.strstart,W.insert=W.lookahead,W.lookahead=0,W.match_length=W.prev_length=w-1,W.match_available=0,v.next_in=q,v.input=G,v.avail_in=Z,W.wrap=V,f},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,i,s){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,i,s){i.exports=function(n,o){var a,c,l,h,u,d,f,p,m,g,I,C,b,E,T,A,S,_,w,F,D,R,O,y,U;a=n.state,c=n.next_in,y=n.input,l=c+(n.avail_in-5),h=n.next_out,U=n.output,u=h-(o-n.avail_out),d=h+(n.avail_out-257),f=a.dmax,p=a.wsize,m=a.whave,g=a.wnext,I=a.window,C=a.hold,b=a.bits,E=a.lencode,T=a.distcode,A=(1<<a.lenbits)-1,S=(1<<a.distbits)-1;t:do{b<15&&(C+=y[c++]<<b,b+=8,C+=y[c++]<<b,b+=8),_=E[C&A];e:for(;;){if(C>>>=w=_>>>24,b-=w,(w=_>>>16&255)===0)U[h++]=65535&_;else{if(!(16&w)){if(!(64&w)){_=E[(65535&_)+(C&(1<<w)-1)];continue e}if(32&w){a.mode=12;break t}n.msg="invalid literal/length code",a.mode=30;break t}F=65535&_,(w&=15)&&(b<w&&(C+=y[c++]<<b,b+=8),F+=C&(1<<w)-1,C>>>=w,b-=w),b<15&&(C+=y[c++]<<b,b+=8,C+=y[c++]<<b,b+=8),_=T[C&S];i:for(;;){if(C>>>=w=_>>>24,b-=w,!(16&(w=_>>>16&255))){if(!(64&w)){_=T[(65535&_)+(C&(1<<w)-1)];continue i}n.msg="invalid distance code",a.mode=30;break t}if(D=65535&_,b<(w&=15)&&(C+=y[c++]<<b,(b+=8)<w&&(C+=y[c++]<<b,b+=8)),f<(D+=C&(1<<w)-1)){n.msg="invalid distance too far back",a.mode=30;break t}if(C>>>=w,b-=w,(w=h-u)<D){if(m<(w=D-w)&&a.sane){n.msg="invalid distance too far back",a.mode=30;break t}if(O=I,(R=0)===g){if(R+=p-w,w<F){for(F-=w;U[h++]=I[R++],--w;);R=h-D,O=U}}else if(g<w){if(R+=p+g-w,(w-=g)<F){for(F-=w;U[h++]=I[R++],--w;);if(R=0,g<F){for(F-=w=g;U[h++]=I[R++],--w;);R=h-D,O=U}}}else if(R+=g-w,w<F){for(F-=w;U[h++]=I[R++],--w;);R=h-D,O=U}for(;2<F;)U[h++]=O[R++],U[h++]=O[R++],U[h++]=O[R++],F-=3;F&&(U[h++]=O[R++],1<F&&(U[h++]=O[R++]))}else{for(R=h-D;U[h++]=U[R++],U[h++]=U[R++],U[h++]=U[R++],2<(F-=3););F&&(U[h++]=U[R++],1<F&&(U[h++]=U[R++]))}break}}break}}while(c<l&&h<d);c-=F=b>>3,C&=(1<<(b-=F<<3))-1,n.next_in=c,n.next_out=h,n.avail_in=c<l?l-c+5:5-(c-l),n.avail_out=h<d?d-h+257:257-(h-d),a.hold=C,a.bits=b}},{}],49:[function(e,i,s){var n=e("../utils/common"),o=e("./adler32"),a=e("./crc32"),c=e("./inffast"),l=e("./inftrees"),h=1,u=2,d=0,f=-2,p=1,m=852,g=592;function I(R){return(R>>>24&255)+(R>>>8&65280)+((65280&R)<<8)+((255&R)<<24)}function C(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(R){var O;return R&&R.state?(O=R.state,R.total_in=R.total_out=O.total=0,R.msg="",O.wrap&&(R.adler=1&O.wrap),O.mode=p,O.last=0,O.havedict=0,O.dmax=32768,O.head=null,O.hold=0,O.bits=0,O.lencode=O.lendyn=new n.Buf32(m),O.distcode=O.distdyn=new n.Buf32(g),O.sane=1,O.back=-1,d):f}function E(R){var O;return R&&R.state?((O=R.state).wsize=0,O.whave=0,O.wnext=0,b(R)):f}function T(R,O){var y,U;return R&&R.state?(U=R.state,O<0?(y=0,O=-O):(y=1+(O>>4),O<48&&(O&=15)),O&&(O<8||15<O)?f:(U.window!==null&&U.wbits!==O&&(U.window=null),U.wrap=y,U.wbits=O,E(R))):f}function A(R,O){var y,U;return R?(U=new C,(R.state=U).window=null,(y=T(R,O))!==d&&(R.state=null),y):f}var S,_,w=!0;function F(R){if(w){var O;for(S=new n.Buf32(512),_=new n.Buf32(32),O=0;O<144;)R.lens[O++]=8;for(;O<256;)R.lens[O++]=9;for(;O<280;)R.lens[O++]=7;for(;O<288;)R.lens[O++]=8;for(l(h,R.lens,0,288,S,0,R.work,{bits:9}),O=0;O<32;)R.lens[O++]=5;l(u,R.lens,0,32,_,0,R.work,{bits:5}),w=!1}R.lencode=S,R.lenbits=9,R.distcode=_,R.distbits=5}function D(R,O,y,U){var H,k=R.state;return k.window===null&&(k.wsize=1<<k.wbits,k.wnext=0,k.whave=0,k.window=new n.Buf8(k.wsize)),U>=k.wsize?(n.arraySet(k.window,O,y-k.wsize,k.wsize,0),k.wnext=0,k.whave=k.wsize):(U<(H=k.wsize-k.wnext)&&(H=U),n.arraySet(k.window,O,y-U,H,k.wnext),(U-=H)?(n.arraySet(k.window,O,y-U,U,0),k.wnext=U,k.whave=k.wsize):(k.wnext+=H,k.wnext===k.wsize&&(k.wnext=0),k.whave<k.wsize&&(k.whave+=H))),0}s.inflateReset=E,s.inflateReset2=T,s.inflateResetKeep=b,s.inflateInit=function(R){return A(R,15)},s.inflateInit2=A,s.inflate=function(R,O){var y,U,H,k,X,$,et,Y,z,st,K,Q,gt,Ct,lt,pt,mt,yt,zt,Lt,v,j,W,N,x=0,V=new n.Buf8(4),Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!R||!R.state||!R.output||!R.input&&R.avail_in!==0)return f;(y=R.state).mode===12&&(y.mode=13),X=R.next_out,H=R.output,et=R.avail_out,k=R.next_in,U=R.input,$=R.avail_in,Y=y.hold,z=y.bits,st=$,K=et,j=d;t:for(;;)switch(y.mode){case p:if(y.wrap===0){y.mode=13;break}for(;z<16;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(2&y.wrap&&Y===35615){V[y.check=0]=255&Y,V[1]=Y>>>8&255,y.check=a(y.check,V,2,0),z=Y=0,y.mode=2;break}if(y.flags=0,y.head&&(y.head.done=!1),!(1&y.wrap)||(((255&Y)<<8)+(Y>>8))%31){R.msg="incorrect header check",y.mode=30;break}if((15&Y)!=8){R.msg="unknown compression method",y.mode=30;break}if(z-=4,v=8+(15&(Y>>>=4)),y.wbits===0)y.wbits=v;else if(v>y.wbits){R.msg="invalid window size",y.mode=30;break}y.dmax=1<<v,R.adler=y.check=1,y.mode=512&Y?10:12,z=Y=0;break;case 2:for(;z<16;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(y.flags=Y,(255&y.flags)!=8){R.msg="unknown compression method",y.mode=30;break}if(57344&y.flags){R.msg="unknown header flags set",y.mode=30;break}y.head&&(y.head.text=Y>>8&1),512&y.flags&&(V[0]=255&Y,V[1]=Y>>>8&255,y.check=a(y.check,V,2,0)),z=Y=0,y.mode=3;case 3:for(;z<32;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}y.head&&(y.head.time=Y),512&y.flags&&(V[0]=255&Y,V[1]=Y>>>8&255,V[2]=Y>>>16&255,V[3]=Y>>>24&255,y.check=a(y.check,V,4,0)),z=Y=0,y.mode=4;case 4:for(;z<16;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}y.head&&(y.head.xflags=255&Y,y.head.os=Y>>8),512&y.flags&&(V[0]=255&Y,V[1]=Y>>>8&255,y.check=a(y.check,V,2,0)),z=Y=0,y.mode=5;case 5:if(1024&y.flags){for(;z<16;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}y.length=Y,y.head&&(y.head.extra_len=Y),512&y.flags&&(V[0]=255&Y,V[1]=Y>>>8&255,y.check=a(y.check,V,2,0)),z=Y=0}else y.head&&(y.head.extra=null);y.mode=6;case 6:if(1024&y.flags&&($<(Q=y.length)&&(Q=$),Q&&(y.head&&(v=y.head.extra_len-y.length,y.head.extra||(y.head.extra=new Array(y.head.extra_len)),n.arraySet(y.head.extra,U,k,Q,v)),512&y.flags&&(y.check=a(y.check,U,Q,k)),$-=Q,k+=Q,y.length-=Q),y.length))break t;y.length=0,y.mode=7;case 7:if(2048&y.flags){if($===0)break t;for(Q=0;v=U[k+Q++],y.head&&v&&y.length<65536&&(y.head.name+=String.fromCharCode(v)),v&&Q<$;);if(512&y.flags&&(y.check=a(y.check,U,Q,k)),$-=Q,k+=Q,v)break t}else y.head&&(y.head.name=null);y.length=0,y.mode=8;case 8:if(4096&y.flags){if($===0)break t;for(Q=0;v=U[k+Q++],y.head&&v&&y.length<65536&&(y.head.comment+=String.fromCharCode(v)),v&&Q<$;);if(512&y.flags&&(y.check=a(y.check,U,Q,k)),$-=Q,k+=Q,v)break t}else y.head&&(y.head.comment=null);y.mode=9;case 9:if(512&y.flags){for(;z<16;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(Y!==(65535&y.check)){R.msg="header crc mismatch",y.mode=30;break}z=Y=0}y.head&&(y.head.hcrc=y.flags>>9&1,y.head.done=!0),R.adler=y.check=0,y.mode=12;break;case 10:for(;z<32;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}R.adler=y.check=I(Y),z=Y=0,y.mode=11;case 11:if(y.havedict===0)return R.next_out=X,R.avail_out=et,R.next_in=k,R.avail_in=$,y.hold=Y,y.bits=z,2;R.adler=y.check=1,y.mode=12;case 12:if(O===5||O===6)break t;case 13:if(y.last){Y>>>=7&z,z-=7&z,y.mode=27;break}for(;z<3;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}switch(y.last=1&Y,z-=1,3&(Y>>>=1)){case 0:y.mode=14;break;case 1:if(F(y),y.mode=20,O!==6)break;Y>>>=2,z-=2;break t;case 2:y.mode=17;break;case 3:R.msg="invalid block type",y.mode=30}Y>>>=2,z-=2;break;case 14:for(Y>>>=7&z,z-=7&z;z<32;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if((65535&Y)!=(Y>>>16^65535)){R.msg="invalid stored block lengths",y.mode=30;break}if(y.length=65535&Y,z=Y=0,y.mode=15,O===6)break t;case 15:y.mode=16;case 16:if(Q=y.length){if($<Q&&(Q=$),et<Q&&(Q=et),Q===0)break t;n.arraySet(H,U,k,Q,X),$-=Q,k+=Q,et-=Q,X+=Q,y.length-=Q;break}y.mode=12;break;case 17:for(;z<14;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(y.nlen=257+(31&Y),Y>>>=5,z-=5,y.ndist=1+(31&Y),Y>>>=5,z-=5,y.ncode=4+(15&Y),Y>>>=4,z-=4,286<y.nlen||30<y.ndist){R.msg="too many length or distance symbols",y.mode=30;break}y.have=0,y.mode=18;case 18:for(;y.have<y.ncode;){for(;z<3;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}y.lens[Z[y.have++]]=7&Y,Y>>>=3,z-=3}for(;y.have<19;)y.lens[Z[y.have++]]=0;if(y.lencode=y.lendyn,y.lenbits=7,W={bits:y.lenbits},j=l(0,y.lens,0,19,y.lencode,0,y.work,W),y.lenbits=W.bits,j){R.msg="invalid code lengths set",y.mode=30;break}y.have=0,y.mode=19;case 19:for(;y.have<y.nlen+y.ndist;){for(;pt=(x=y.lencode[Y&(1<<y.lenbits)-1])>>>16&255,mt=65535&x,!((lt=x>>>24)<=z);){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(mt<16)Y>>>=lt,z-=lt,y.lens[y.have++]=mt;else{if(mt===16){for(N=lt+2;z<N;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(Y>>>=lt,z-=lt,y.have===0){R.msg="invalid bit length repeat",y.mode=30;break}v=y.lens[y.have-1],Q=3+(3&Y),Y>>>=2,z-=2}else if(mt===17){for(N=lt+3;z<N;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}z-=lt,v=0,Q=3+(7&(Y>>>=lt)),Y>>>=3,z-=3}else{for(N=lt+7;z<N;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}z-=lt,v=0,Q=11+(127&(Y>>>=lt)),Y>>>=7,z-=7}if(y.have+Q>y.nlen+y.ndist){R.msg="invalid bit length repeat",y.mode=30;break}for(;Q--;)y.lens[y.have++]=v}}if(y.mode===30)break;if(y.lens[256]===0){R.msg="invalid code -- missing end-of-block",y.mode=30;break}if(y.lenbits=9,W={bits:y.lenbits},j=l(h,y.lens,0,y.nlen,y.lencode,0,y.work,W),y.lenbits=W.bits,j){R.msg="invalid literal/lengths set",y.mode=30;break}if(y.distbits=6,y.distcode=y.distdyn,W={bits:y.distbits},j=l(u,y.lens,y.nlen,y.ndist,y.distcode,0,y.work,W),y.distbits=W.bits,j){R.msg="invalid distances set",y.mode=30;break}if(y.mode=20,O===6)break t;case 20:y.mode=21;case 21:if(6<=$&&258<=et){R.next_out=X,R.avail_out=et,R.next_in=k,R.avail_in=$,y.hold=Y,y.bits=z,c(R,K),X=R.next_out,H=R.output,et=R.avail_out,k=R.next_in,U=R.input,$=R.avail_in,Y=y.hold,z=y.bits,y.mode===12&&(y.back=-1);break}for(y.back=0;pt=(x=y.lencode[Y&(1<<y.lenbits)-1])>>>16&255,mt=65535&x,!((lt=x>>>24)<=z);){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(pt&&!(240&pt)){for(yt=lt,zt=pt,Lt=mt;pt=(x=y.lencode[Lt+((Y&(1<<yt+zt)-1)>>yt)])>>>16&255,mt=65535&x,!(yt+(lt=x>>>24)<=z);){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}Y>>>=yt,z-=yt,y.back+=yt}if(Y>>>=lt,z-=lt,y.back+=lt,y.length=mt,pt===0){y.mode=26;break}if(32&pt){y.back=-1,y.mode=12;break}if(64&pt){R.msg="invalid literal/length code",y.mode=30;break}y.extra=15&pt,y.mode=22;case 22:if(y.extra){for(N=y.extra;z<N;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}y.length+=Y&(1<<y.extra)-1,Y>>>=y.extra,z-=y.extra,y.back+=y.extra}y.was=y.length,y.mode=23;case 23:for(;pt=(x=y.distcode[Y&(1<<y.distbits)-1])>>>16&255,mt=65535&x,!((lt=x>>>24)<=z);){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(!(240&pt)){for(yt=lt,zt=pt,Lt=mt;pt=(x=y.distcode[Lt+((Y&(1<<yt+zt)-1)>>yt)])>>>16&255,mt=65535&x,!(yt+(lt=x>>>24)<=z);){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}Y>>>=yt,z-=yt,y.back+=yt}if(Y>>>=lt,z-=lt,y.back+=lt,64&pt){R.msg="invalid distance code",y.mode=30;break}y.offset=mt,y.extra=15&pt,y.mode=24;case 24:if(y.extra){for(N=y.extra;z<N;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}y.offset+=Y&(1<<y.extra)-1,Y>>>=y.extra,z-=y.extra,y.back+=y.extra}if(y.offset>y.dmax){R.msg="invalid distance too far back",y.mode=30;break}y.mode=25;case 25:if(et===0)break t;if(Q=K-et,y.offset>Q){if((Q=y.offset-Q)>y.whave&&y.sane){R.msg="invalid distance too far back",y.mode=30;break}gt=Q>y.wnext?(Q-=y.wnext,y.wsize-Q):y.wnext-Q,Q>y.length&&(Q=y.length),Ct=y.window}else Ct=H,gt=X-y.offset,Q=y.length;for(et<Q&&(Q=et),et-=Q,y.length-=Q;H[X++]=Ct[gt++],--Q;);y.length===0&&(y.mode=21);break;case 26:if(et===0)break t;H[X++]=y.length,et--,y.mode=21;break;case 27:if(y.wrap){for(;z<32;){if($===0)break t;$--,Y|=U[k++]<<z,z+=8}if(K-=et,R.total_out+=K,y.total+=K,K&&(R.adler=y.check=y.flags?a(y.check,H,K,X-K):o(y.check,H,K,X-K)),K=et,(y.flags?Y:I(Y))!==y.check){R.msg="incorrect data check",y.mode=30;break}z=Y=0}y.mode=28;case 28:if(y.wrap&&y.flags){for(;z<32;){if($===0)break t;$--,Y+=U[k++]<<z,z+=8}if(Y!==(4294967295&y.total)){R.msg="incorrect length check",y.mode=30;break}z=Y=0}y.mode=29;case 29:j=1;break t;case 30:j=-3;break t;case 31:return-4;case 32:default:return f}return R.next_out=X,R.avail_out=et,R.next_in=k,R.avail_in=$,y.hold=Y,y.bits=z,(y.wsize||K!==R.avail_out&&y.mode<30&&(y.mode<27||O!==4))&&D(R,R.output,R.next_out,K-R.avail_out)?(y.mode=31,-4):(st-=R.avail_in,K-=R.avail_out,R.total_in+=st,R.total_out+=K,y.total+=K,y.wrap&&K&&(R.adler=y.check=y.flags?a(y.check,H,K,R.next_out-K):o(y.check,H,K,R.next_out-K)),R.data_type=y.bits+(y.last?64:0)+(y.mode===12?128:0)+(y.mode===20||y.mode===15?256:0),(st==0&&K===0||O===4)&&j===d&&(j=-5),j)},s.inflateEnd=function(R){if(!R||!R.state)return f;var O=R.state;return O.window&&(O.window=null),R.state=null,d},s.inflateGetHeader=function(R,O){var y;return R&&R.state&&2&(y=R.state).wrap?((y.head=O).done=!1,d):f},s.inflateSetDictionary=function(R,O){var y,U=O.length;return R&&R.state?(y=R.state).wrap!==0&&y.mode!==11?f:y.mode===11&&o(1,O,U,0)!==y.check?-3:D(R,O,U,U)?(y.mode=31,-4):(y.havedict=1,d):f},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,i,s){var n=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(h,u,d,f,p,m,g,I){var C,b,E,T,A,S,_,w,F,D=I.bits,R=0,O=0,y=0,U=0,H=0,k=0,X=0,$=0,et=0,Y=0,z=null,st=0,K=new n.Buf16(16),Q=new n.Buf16(16),gt=null,Ct=0;for(R=0;R<=15;R++)K[R]=0;for(O=0;O<f;O++)K[u[d+O]]++;for(H=D,U=15;1<=U&&K[U]===0;U--);if(U<H&&(H=U),U===0)return p[m++]=20971520,p[m++]=20971520,I.bits=1,0;for(y=1;y<U&&K[y]===0;y++);for(H<y&&(H=y),R=$=1;R<=15;R++)if($<<=1,($-=K[R])<0)return-1;if(0<$&&(h===0||U!==1))return-1;for(Q[1]=0,R=1;R<15;R++)Q[R+1]=Q[R]+K[R];for(O=0;O<f;O++)u[d+O]!==0&&(g[Q[u[d+O]]++]=O);if(S=h===0?(z=gt=g,19):h===1?(z=o,st-=257,gt=a,Ct-=257,256):(z=c,gt=l,-1),R=y,A=m,X=O=Y=0,E=-1,T=(et=1<<(k=H))-1,h===1&&852<et||h===2&&592<et)return 1;for(;;){for(_=R-X,F=g[O]<S?(w=0,g[O]):g[O]>S?(w=gt[Ct+g[O]],z[st+g[O]]):(w=96,0),C=1<<R-X,y=b=1<<k;p[A+(Y>>X)+(b-=C)]=_<<24|w<<16|F|0,b!==0;);for(C=1<<R-1;Y&C;)C>>=1;if(C!==0?(Y&=C-1,Y+=C):Y=0,O++,--K[R]==0){if(R===U)break;R=u[d+g[O]]}if(H<R&&(Y&T)!==E){for(X===0&&(X=H),A+=y,$=1<<(k=R-X);k+X<U&&!(($-=K[k+X])<=0);)k++,$<<=1;if(et+=1<<k,h===1&&852<et||h===2&&592<et)return 1;p[E=Y&T]=H<<24|k<<16|A-m|0}}return Y!==0&&(p[A+Y]=R-X<<24|64<<16|0),I.bits=H,0}},{"../utils/common":41}],51:[function(e,i,s){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,i,s){var n=e("../utils/common"),o=0,a=1;function c(x){for(var V=x.length;0<=--V;)x[V]=0}var l=0,h=29,u=256,d=u+1+h,f=30,p=19,m=2*d+1,g=15,I=16,C=7,b=256,E=16,T=17,A=18,S=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],_=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=new Array(2*(d+2));c(D);var R=new Array(2*f);c(R);var O=new Array(512);c(O);var y=new Array(256);c(y);var U=new Array(h);c(U);var H,k,X,$=new Array(f);function et(x,V,Z,q,G){this.static_tree=x,this.extra_bits=V,this.extra_base=Z,this.elems=q,this.max_length=G,this.has_stree=x&&x.length}function Y(x,V){this.dyn_tree=x,this.max_code=0,this.stat_desc=V}function z(x){return x<256?O[x]:O[256+(x>>>7)]}function st(x,V){x.pending_buf[x.pending++]=255&V,x.pending_buf[x.pending++]=V>>>8&255}function K(x,V,Z){x.bi_valid>I-Z?(x.bi_buf|=V<<x.bi_valid&65535,st(x,x.bi_buf),x.bi_buf=V>>I-x.bi_valid,x.bi_valid+=Z-I):(x.bi_buf|=V<<x.bi_valid&65535,x.bi_valid+=Z)}function Q(x,V,Z){K(x,Z[2*V],Z[2*V+1])}function gt(x,V){for(var Z=0;Z|=1&x,x>>>=1,Z<<=1,0<--V;);return Z>>>1}function Ct(x,V,Z){var q,G,J=new Array(g+1),ot=0;for(q=1;q<=g;q++)J[q]=ot=ot+Z[q-1]<<1;for(G=0;G<=V;G++){var tt=x[2*G+1];tt!==0&&(x[2*G]=gt(J[tt]++,tt))}}function lt(x){var V;for(V=0;V<d;V++)x.dyn_ltree[2*V]=0;for(V=0;V<f;V++)x.dyn_dtree[2*V]=0;for(V=0;V<p;V++)x.bl_tree[2*V]=0;x.dyn_ltree[2*b]=1,x.opt_len=x.static_len=0,x.last_lit=x.matches=0}function pt(x){8<x.bi_valid?st(x,x.bi_buf):0<x.bi_valid&&(x.pending_buf[x.pending++]=x.bi_buf),x.bi_buf=0,x.bi_valid=0}function mt(x,V,Z,q){var G=2*V,J=2*Z;return x[G]<x[J]||x[G]===x[J]&&q[V]<=q[Z]}function yt(x,V,Z){for(var q=x.heap[Z],G=Z<<1;G<=x.heap_len&&(G<x.heap_len&&mt(V,x.heap[G+1],x.heap[G],x.depth)&&G++,!mt(V,q,x.heap[G],x.depth));)x.heap[Z]=x.heap[G],Z=G,G<<=1;x.heap[Z]=q}function zt(x,V,Z){var q,G,J,ot,tt=0;if(x.last_lit!==0)for(;q=x.pending_buf[x.d_buf+2*tt]<<8|x.pending_buf[x.d_buf+2*tt+1],G=x.pending_buf[x.l_buf+tt],tt++,q===0?Q(x,G,V):(Q(x,(J=y[G])+u+1,V),(ot=S[J])!==0&&K(x,G-=U[J],ot),Q(x,J=z(--q),Z),(ot=_[J])!==0&&K(x,q-=$[J],ot)),tt<x.last_lit;);Q(x,b,V)}function Lt(x,V){var Z,q,G,J=V.dyn_tree,ot=V.stat_desc.static_tree,tt=V.stat_desc.has_stree,ft=V.stat_desc.elems,At=-1;for(x.heap_len=0,x.heap_max=m,Z=0;Z<ft;Z++)J[2*Z]!==0?(x.heap[++x.heap_len]=At=Z,x.depth[Z]=0):J[2*Z+1]=0;for(;x.heap_len<2;)J[2*(G=x.heap[++x.heap_len]=At<2?++At:0)]=1,x.depth[G]=0,x.opt_len--,tt&&(x.static_len-=ot[2*G+1]);for(V.max_code=At,Z=x.heap_len>>1;1<=Z;Z--)yt(x,J,Z);for(G=ft;Z=x.heap[1],x.heap[1]=x.heap[x.heap_len--],yt(x,J,1),q=x.heap[1],x.heap[--x.heap_max]=Z,x.heap[--x.heap_max]=q,J[2*G]=J[2*Z]+J[2*q],x.depth[G]=(x.depth[Z]>=x.depth[q]?x.depth[Z]:x.depth[q])+1,J[2*Z+1]=J[2*q+1]=G,x.heap[1]=G++,yt(x,J,1),2<=x.heap_len;);x.heap[--x.heap_max]=x.heap[1],function(bt,ae){var Is,ye,gs,Pt,cn,Hr,Le=ae.dyn_tree,nl=ae.max_code,kp=ae.stat_desc.static_tree,Vp=ae.stat_desc.has_stree,zp=ae.stat_desc.extra_bits,rl=ae.stat_desc.extra_base,Es=ae.stat_desc.max_length,ln=0;for(Pt=0;Pt<=g;Pt++)bt.bl_count[Pt]=0;for(Le[2*bt.heap[bt.heap_max]+1]=0,Is=bt.heap_max+1;Is<m;Is++)Es<(Pt=Le[2*Le[2*(ye=bt.heap[Is])+1]+1]+1)&&(Pt=Es,ln++),Le[2*ye+1]=Pt,nl<ye||(bt.bl_count[Pt]++,cn=0,rl<=ye&&(cn=zp[ye-rl]),Hr=Le[2*ye],bt.opt_len+=Hr*(Pt+cn),Vp&&(bt.static_len+=Hr*(kp[2*ye+1]+cn)));if(ln!==0){do{for(Pt=Es-1;bt.bl_count[Pt]===0;)Pt--;bt.bl_count[Pt]--,bt.bl_count[Pt+1]+=2,bt.bl_count[Es]--,ln-=2}while(0<ln);for(Pt=Es;Pt!==0;Pt--)for(ye=bt.bl_count[Pt];ye!==0;)nl<(gs=bt.heap[--Is])||(Le[2*gs+1]!==Pt&&(bt.opt_len+=(Pt-Le[2*gs+1])*Le[2*gs],Le[2*gs+1]=Pt),ye--)}}(x,V),Ct(J,At,x.bl_count)}function v(x,V,Z){var q,G,J=-1,ot=V[1],tt=0,ft=7,At=4;for(ot===0&&(ft=138,At=3),V[2*(Z+1)+1]=65535,q=0;q<=Z;q++)G=ot,ot=V[2*(q+1)+1],++tt<ft&&G===ot||(tt<At?x.bl_tree[2*G]+=tt:G!==0?(G!==J&&x.bl_tree[2*G]++,x.bl_tree[2*E]++):tt<=10?x.bl_tree[2*T]++:x.bl_tree[2*A]++,J=G,At=(tt=0)===ot?(ft=138,3):G===ot?(ft=6,3):(ft=7,4))}function j(x,V,Z){var q,G,J=-1,ot=V[1],tt=0,ft=7,At=4;for(ot===0&&(ft=138,At=3),q=0;q<=Z;q++)if(G=ot,ot=V[2*(q+1)+1],!(++tt<ft&&G===ot)){if(tt<At)for(;Q(x,G,x.bl_tree),--tt!=0;);else G!==0?(G!==J&&(Q(x,G,x.bl_tree),tt--),Q(x,E,x.bl_tree),K(x,tt-3,2)):tt<=10?(Q(x,T,x.bl_tree),K(x,tt-3,3)):(Q(x,A,x.bl_tree),K(x,tt-11,7));J=G,At=(tt=0)===ot?(ft=138,3):G===ot?(ft=6,3):(ft=7,4)}}c($);var W=!1;function N(x,V,Z,q){K(x,(l<<1)+(q?1:0),3),function(G,J,ot,tt){pt(G),st(G,ot),st(G,~ot),n.arraySet(G.pending_buf,G.window,J,ot,G.pending),G.pending+=ot}(x,V,Z)}s._tr_init=function(x){W||(function(){var V,Z,q,G,J,ot=new Array(g+1);for(G=q=0;G<h-1;G++)for(U[G]=q,V=0;V<1<<S[G];V++)y[q++]=G;for(y[q-1]=G,G=J=0;G<16;G++)for($[G]=J,V=0;V<1<<_[G];V++)O[J++]=G;for(J>>=7;G<f;G++)for($[G]=J<<7,V=0;V<1<<_[G]-7;V++)O[256+J++]=G;for(Z=0;Z<=g;Z++)ot[Z]=0;for(V=0;V<=143;)D[2*V+1]=8,V++,ot[8]++;for(;V<=255;)D[2*V+1]=9,V++,ot[9]++;for(;V<=279;)D[2*V+1]=7,V++,ot[7]++;for(;V<=287;)D[2*V+1]=8,V++,ot[8]++;for(Ct(D,d+1,ot),V=0;V<f;V++)R[2*V+1]=5,R[2*V]=gt(V,5);H=new et(D,S,u+1,d,g),k=new et(R,_,0,f,g),X=new et(new Array(0),w,0,p,C)}(),W=!0),x.l_desc=new Y(x.dyn_ltree,H),x.d_desc=new Y(x.dyn_dtree,k),x.bl_desc=new Y(x.bl_tree,X),x.bi_buf=0,x.bi_valid=0,lt(x)},s._tr_stored_block=N,s._tr_flush_block=function(x,V,Z,q){var G,J,ot=0;0<x.level?(x.strm.data_type===2&&(x.strm.data_type=function(tt){var ft,At=4093624447;for(ft=0;ft<=31;ft++,At>>>=1)if(1&At&&tt.dyn_ltree[2*ft]!==0)return o;if(tt.dyn_ltree[18]!==0||tt.dyn_ltree[20]!==0||tt.dyn_ltree[26]!==0)return a;for(ft=32;ft<u;ft++)if(tt.dyn_ltree[2*ft]!==0)return a;return o}(x)),Lt(x,x.l_desc),Lt(x,x.d_desc),ot=function(tt){var ft;for(v(tt,tt.dyn_ltree,tt.l_desc.max_code),v(tt,tt.dyn_dtree,tt.d_desc.max_code),Lt(tt,tt.bl_desc),ft=p-1;3<=ft&&tt.bl_tree[2*F[ft]+1]===0;ft--);return tt.opt_len+=3*(ft+1)+5+5+4,ft}(x),G=x.opt_len+3+7>>>3,(J=x.static_len+3+7>>>3)<=G&&(G=J)):G=J=Z+5,Z+4<=G&&V!==-1?N(x,V,Z,q):x.strategy===4||J===G?(K(x,2+(q?1:0),3),zt(x,D,R)):(K(x,4+(q?1:0),3),function(tt,ft,At,bt){var ae;for(K(tt,ft-257,5),K(tt,At-1,5),K(tt,bt-4,4),ae=0;ae<bt;ae++)K(tt,tt.bl_tree[2*F[ae]+1],3);j(tt,tt.dyn_ltree,ft-1),j(tt,tt.dyn_dtree,At-1)}(x,x.l_desc.max_code+1,x.d_desc.max_code+1,ot+1),zt(x,x.dyn_ltree,x.dyn_dtree)),lt(x),q&&pt(x)},s._tr_tally=function(x,V,Z){return x.pending_buf[x.d_buf+2*x.last_lit]=V>>>8&255,x.pending_buf[x.d_buf+2*x.last_lit+1]=255&V,x.pending_buf[x.l_buf+x.last_lit]=255&Z,x.last_lit++,V===0?x.dyn_ltree[2*Z]++:(x.matches++,V--,x.dyn_ltree[2*(y[Z]+u+1)]++,x.dyn_dtree[2*z(V)]++),x.last_lit===x.lit_bufsize-1},s._tr_align=function(x){K(x,2,3),Q(x,b,D),function(V){V.bi_valid===16?(st(V,V.bi_buf),V.bi_buf=0,V.bi_valid=0):8<=V.bi_valid&&(V.pending_buf[V.pending++]=255&V.bi_buf,V.bi_buf>>=8,V.bi_valid-=8)}(x)}},{"../utils/common":41}],53:[function(e,i,s){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,i,s){(function(n){(function(o,a){if(!o.setImmediate){var c,l,h,u,d=1,f={},p=!1,m=o.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(o);g=g&&g.setTimeout?g:o,c={}.toString.call(o.process)==="[object process]"?function(E){process.nextTick(function(){C(E)})}:function(){if(o.postMessage&&!o.importScripts){var E=!0,T=o.onmessage;return o.onmessage=function(){E=!1},o.postMessage("","*"),o.onmessage=T,E}}()?(u="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",b,!1):o.attachEvent("onmessage",b),function(E){o.postMessage(u+E,"*")}):o.MessageChannel?((h=new MessageChannel).port1.onmessage=function(E){C(E.data)},function(E){h.port2.postMessage(E)}):m&&"onreadystatechange"in m.createElement("script")?(l=m.documentElement,function(E){var T=m.createElement("script");T.onreadystatechange=function(){C(E),T.onreadystatechange=null,l.removeChild(T),T=null},l.appendChild(T)}):function(E){setTimeout(C,0,E)},g.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var T=new Array(arguments.length-1),A=0;A<T.length;A++)T[A]=arguments[A+1];var S={callback:E,args:T};return f[d]=S,c(d),d++},g.clearImmediate=I}function I(E){delete f[E]}function C(E){if(p)setTimeout(C,0,E);else{var T=f[E];if(T){p=!0;try{(function(A){var S=A.callback,_=A.args;switch(_.length){case 0:S();break;case 1:S(_[0]);break;case 2:S(_[0],_[1]);break;case 3:S(_[0],_[1],_[2]);break;default:S.apply(a,_)}})(T)}finally{I(E),p=!1}}}}function b(E){E.source===o&&typeof E.data=="string"&&E.data.indexOf(u)===0&&C(+E.data.slice(u.length))}})(typeof self>"u"?n===void 0?this:n:self)}).call(this,typeof Nd<"u"?Nd:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(UA);var PU=UA.exports;const hT=NU(PU);var BA={},Tp={};(function(r){const t=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",e=t+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",i="["+t+"]["+e+"]*",s=new RegExp("^"+i+"$"),n=function(a,c){const l=[];let h=c.exec(a);for(;h;){const u=[];u.startIndex=c.lastIndex-h[0].length;const d=h.length;for(let f=0;f<d;f++)u.push(h[f]);l.push(u),h=c.exec(a)}return l},o=function(a){const c=s.exec(a);return!(c===null||typeof c>"u")};r.isExist=function(a){return typeof a<"u"},r.isEmptyObject=function(a){return Object.keys(a).length===0},r.merge=function(a,c,l){if(c){const h=Object.keys(c),u=h.length;for(let d=0;d<u;d++)l==="strict"?a[h[d]]=[c[h[d]]]:a[h[d]]=c[h[d]]}},r.getValue=function(a){return r.isExist(a)?a:""},r.isName=o,r.getAllMatches=n,r.nameRegexp=i})(Tp);const jE=Tp,LU={allowBooleanAttributes:!1,unpairedTags:[]};BA.validate=function(r,t){t=Object.assign({},LU,t);const e=[];let i=!1,s=!1;r[0]==="\uFEFF"&&(r=r.substr(1));for(let n=0;n<r.length;n++)if(r[n]==="<"&&r[n+1]==="?"){if(n+=2,n=dT(r,n),n.err)return n}else if(r[n]==="<"){let o=n;if(n++,r[n]==="!"){n=fT(r,n);continue}else{let a=!1;r[n]==="/"&&(a=!0,n++);let c="";for(;n<r.length&&r[n]!==">"&&r[n]!==" "&&r[n]!=="	"&&r[n]!==`
`&&r[n]!=="\r";n++)c+=r[n];if(c=c.trim(),c[c.length-1]==="/"&&(c=c.substring(0,c.length-1),n--),!YU(c)){let u;return c.trim().length===0?u="Invalid space after '<'.":u="Tag '"+c+"' is an invalid name.",Re("InvalidTag",u,ri(r,n))}const l=UU(r,n);if(l===!1)return Re("InvalidAttr","Attributes for '"+c+"' have open quote.",ri(r,n));let h=l.value;if(n=l.index,h[h.length-1]==="/"){const u=n-h.length;h=h.substring(0,h.length-1);const d=pT(h,t);if(d===!0)i=!0;else return Re(d.err.code,d.err.msg,ri(r,u+d.err.line))}else if(a)if(l.tagClosed){if(h.trim().length>0)return Re("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",ri(r,o));if(e.length===0)return Re("InvalidTag","Closing tag '"+c+"' has not been opened.",ri(r,o));{const u=e.pop();if(c!==u.tagName){let d=ri(r,u.tagStartPos);return Re("InvalidTag","Expected closing tag '"+u.tagName+"' (opened in line "+d.line+", col "+d.col+") instead of closing tag '"+c+"'.",ri(r,o))}e.length==0&&(s=!0)}}else return Re("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",ri(r,n));else{const u=pT(h,t);if(u!==!0)return Re(u.err.code,u.err.msg,ri(r,n-h.length+u.err.line));if(s===!0)return Re("InvalidXml","Multiple possible root nodes found.",ri(r,n));t.unpairedTags.indexOf(c)!==-1||e.push({tagName:c,tagStartPos:o}),i=!0}for(n++;n<r.length;n++)if(r[n]==="<")if(r[n+1]==="!"){n++,n=fT(r,n);continue}else if(r[n+1]==="?"){if(n=dT(r,++n),n.err)return n}else break;else if(r[n]==="&"){const u=VU(r,n);if(u==-1)return Re("InvalidChar","char '&' is not expected.",ri(r,n));n=u}else if(s===!0&&!uT(r[n]))return Re("InvalidXml","Extra text at the end",ri(r,n));r[n]==="<"&&n--}}else{if(uT(r[n]))continue;return Re("InvalidChar","char '"+r[n]+"' is not expected.",ri(r,n))}if(i){if(e.length==1)return Re("InvalidTag","Unclosed tag '"+e[0].tagName+"'.",ri(r,e[0].tagStartPos));if(e.length>0)return Re("InvalidXml","Invalid '"+JSON.stringify(e.map(n=>n.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return Re("InvalidXml","Start tag expected.",1);return!0};function uT(r){return r===" "||r==="	"||r===`
`||r==="\r"}function dT(r,t){const e=t;for(;t<r.length;t++)if(r[t]=="?"||r[t]==" "){const i=r.substr(e,t-e);if(t>5&&i==="xml")return Re("InvalidXml","XML declaration allowed only at the start of the document.",ri(r,t));if(r[t]=="?"&&r[t+1]==">"){t++;break}else continue}return t}function fT(r,t){if(r.length>t+5&&r[t+1]==="-"&&r[t+2]==="-"){for(t+=3;t<r.length;t++)if(r[t]==="-"&&r[t+1]==="-"&&r[t+2]===">"){t+=2;break}}else if(r.length>t+8&&r[t+1]==="D"&&r[t+2]==="O"&&r[t+3]==="C"&&r[t+4]==="T"&&r[t+5]==="Y"&&r[t+6]==="P"&&r[t+7]==="E"){let e=1;for(t+=8;t<r.length;t++)if(r[t]==="<")e++;else if(r[t]===">"&&(e--,e===0))break}else if(r.length>t+9&&r[t+1]==="["&&r[t+2]==="C"&&r[t+3]==="D"&&r[t+4]==="A"&&r[t+5]==="T"&&r[t+6]==="A"&&r[t+7]==="["){for(t+=8;t<r.length;t++)if(r[t]==="]"&&r[t+1]==="]"&&r[t+2]===">"){t+=2;break}}return t}const MU='"',DU="'";function UU(r,t){let e="",i="",s=!1;for(;t<r.length;t++){if(r[t]===MU||r[t]===DU)i===""?i=r[t]:i!==r[t]||(i="");else if(r[t]===">"&&i===""){s=!0;break}e+=r[t]}return i!==""?!1:{value:e,index:t,tagClosed:s}}const BU=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function pT(r,t){const e=jE.getAllMatches(r,BU),i={};for(let s=0;s<e.length;s++){if(e[s][1].length===0)return Re("InvalidAttr","Attribute '"+e[s][2]+"' has no space in starting.",Hl(e[s]));if(e[s][3]!==void 0&&e[s][4]===void 0)return Re("InvalidAttr","Attribute '"+e[s][2]+"' is without value.",Hl(e[s]));if(e[s][3]===void 0&&!t.allowBooleanAttributes)return Re("InvalidAttr","boolean attribute '"+e[s][2]+"' is not allowed.",Hl(e[s]));const n=e[s][2];if(!zU(n))return Re("InvalidAttr","Attribute '"+n+"' is an invalid name.",Hl(e[s]));if(!i.hasOwnProperty(n))i[n]=1;else return Re("InvalidAttr","Attribute '"+n+"' is repeated.",Hl(e[s]))}return!0}function kU(r,t){let e=/\d/;for(r[t]==="x"&&(t++,e=/[\da-fA-F]/);t<r.length;t++){if(r[t]===";")return t;if(!r[t].match(e))break}return-1}function VU(r,t){if(t++,r[t]===";")return-1;if(r[t]==="#")return t++,kU(r,t);let e=0;for(;t<r.length;t++,e++)if(!(r[t].match(/\w/)&&e<20)){if(r[t]===";")break;return-1}return t}function Re(r,t,e){return{err:{code:r,msg:t,line:e.line||e,col:e.col}}}function zU(r){return jE.isName(r)}function YU(r){return jE.isName(r)}function ri(r,t){const e=r.substring(0,t).split(/\r?\n/);return{line:e.length,col:e[e.length-1].length+1}}function Hl(r){return r.startIndex+r[1].length}var XE={};const kA={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(r,t){return t},attributeValueProcessor:function(r,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(r,t,e){return r}},GU=function(r){return Object.assign({},kA,r)};XE.buildOptions=GU;XE.defaultOptions=kA;let HU=class{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}};var $U=HU;const WU=Tp;function jU(r,t){const e={};if(r[t+3]==="O"&&r[t+4]==="C"&&r[t+5]==="T"&&r[t+6]==="Y"&&r[t+7]==="P"&&r[t+8]==="E"){t=t+9;let i=1,s=!1,n=!1,o="";for(;t<r.length;t++)if(r[t]==="<"&&!n)s&&ZU(r,t)?(t+=7,[entityName,val,t]=XU(r,t+1),val.indexOf("&")===-1&&(e[JU(entityName)]={regx:RegExp(`&${entityName};`,"g"),val})):s&&qU(r,t)||s&&QU(r,t)?t+=8:s&&KU(r,t)?t+=9:n=!0,i++,o="";else if(r[t]===">"){if(n?r[t-1]==="-"&&r[t-2]==="-"&&(n=!1,i--):i--,i===0)break}else r[t]==="["?s=!0:o+=r[t];if(i!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:e,i:t}}function XU(r,t){let e="";for(;t<r.length&&r[t]!=="'"&&r[t]!=='"';t++)e+=r[t];if(e=e.trim(),e.indexOf(" ")!==-1)throw new Error("External entites are not supported");const i=r[t++];let s="";for(;t<r.length&&r[t]!==i;t++)s+=r[t];return[e,s,t]}function ZU(r,t){return r[t+1]==="!"&&r[t+2]==="E"&&r[t+3]==="N"&&r[t+4]==="T"&&r[t+5]==="I"&&r[t+6]==="T"&&r[t+7]==="Y"}function qU(r,t){return r[t+1]==="!"&&r[t+2]==="E"&&r[t+3]==="L"&&r[t+4]==="E"&&r[t+5]==="M"&&r[t+6]==="E"&&r[t+7]==="N"&&r[t+8]==="T"}function QU(r,t){return r[t+1]==="!"&&r[t+2]==="A"&&r[t+3]==="T"&&r[t+4]==="T"&&r[t+5]==="L"&&r[t+6]==="I"&&r[t+7]==="S"&&r[t+8]==="T"}function KU(r,t){return r[t+1]==="!"&&r[t+2]==="N"&&r[t+3]==="O"&&r[t+4]==="T"&&r[t+5]==="A"&&r[t+6]==="T"&&r[t+7]==="I"&&r[t+8]==="O"&&r[t+9]==="N"}function JU(r){if(WU.isName(r))return r;throw new Error(`Invalid entity name ${r}`)}var t4=jU;const e4=/^[-+]?0x[a-fA-F0-9]+$/,i4=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const s4={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function n4(r,t={}){if(t=Object.assign({},s4,t),!r||typeof r!="string")return r;let e=r.trim();if(t.skipLike!==void 0&&t.skipLike.test(e))return r;if(t.hex&&e4.test(e))return Number.parseInt(e,16);{const i=i4.exec(e);if(i){const s=i[1],n=i[2];let o=r4(i[3]);const a=i[4]||i[6];if(!t.leadingZeros&&n.length>0&&s&&e[2]!=="."||!t.leadingZeros&&n.length>0&&!s&&e[1]!==".")return r;{const c=Number(e),l=""+c;return l.search(/[eE]/)!==-1||a?t.eNotation?c:r:e.indexOf(".")!==-1?l==="0"&&o===""||l===o||s&&l==="-"+o?c:r:n?o===l||s+o===l?c:r:e===l||e===s+l?c:r}}else return r}}function r4(r){return r&&r.indexOf(".")!==-1&&(r=r.replace(/0+$/,""),r==="."?r="0":r[0]==="."?r="0"+r:r[r.length-1]==="."&&(r=r.substr(0,r.length-1))),r}var o4=n4;const VA=Tp,$l=$U,a4=t4,c4=o4;let l4=class{constructor(r){this.options=r,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""},num_dec:{regex:/&#([0-9]{1,7});/g,val:(t,e)=>String.fromCharCode(Number.parseInt(e,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(t,e)=>String.fromCharCode(Number.parseInt(e,16))}},this.addExternalEntities=h4,this.parseXml=m4,this.parseTextData=u4,this.resolveNameSpace=d4,this.buildAttributesMap=p4,this.isItStopNode=C4,this.replaceEntitiesValue=g4,this.readStopNodeData=T4,this.saveTextToParentTag=E4,this.addChild=I4}};function h4(r){const t=Object.keys(r);for(let e=0;e<t.length;e++){const i=t[e];this.lastEntities[i]={regex:new RegExp("&"+i+";","g"),val:r[i]}}}function u4(r,t,e,i,s,n,o){if(r!==void 0&&(this.options.trimValues&&!i&&(r=r.trim()),r.length>0)){o||(r=this.replaceEntitiesValue(r));const a=this.options.tagValueProcessor(t,r,e,s,n);return a==null?r:typeof a!=typeof r||a!==r?a:this.options.trimValues?bg(r,this.options.parseTagValue,this.options.numberParseOptions):r.trim()===r?bg(r,this.options.parseTagValue,this.options.numberParseOptions):r}}function d4(r){if(this.options.removeNSPrefix){const t=r.split(":"),e=r.charAt(0)==="/"?"/":"";if(t[0]==="xmlns")return"";t.length===2&&(r=e+t[1])}return r}const f4=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function p4(r,t,e){if(!this.options.ignoreAttributes&&typeof r=="string"){const i=VA.getAllMatches(r,f4),s=i.length,n={};for(let o=0;o<s;o++){const a=this.resolveNameSpace(i[o][1]);let c=i[o][4],l=this.options.attributeNamePrefix+a;if(a.length)if(this.options.transformAttributeName&&(l=this.options.transformAttributeName(l)),l==="__proto__"&&(l="#__proto__"),c!==void 0){this.options.trimValues&&(c=c.trim()),c=this.replaceEntitiesValue(c);const h=this.options.attributeValueProcessor(a,c,t);h==null?n[l]=c:typeof h!=typeof c||h!==c?n[l]=h:n[l]=bg(c,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(n[l]=!0)}if(!Object.keys(n).length)return;if(this.options.attributesGroupName){const o={};return o[this.options.attributesGroupName]=n,o}return n}}const m4=function(r){r=r.replace(/\r\n?/g,`
`);const t=new $l("!xml");let e=t,i="",s="";for(let n=0;n<r.length;n++)if(r[n]==="<")if(r[n+1]==="/"){const o=fo(r,">",n,"Closing Tag is not closed.");let a=r.substring(n+2,o).trim();if(this.options.removeNSPrefix){const h=a.indexOf(":");h!==-1&&(a=a.substr(h+1))}this.options.transformTagName&&(a=this.options.transformTagName(a)),e&&(i=this.saveTextToParentTag(i,e,s));const c=s.substring(s.lastIndexOf(".")+1);if(a&&this.options.unpairedTags.indexOf(a)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${a}>`);let l=0;c&&this.options.unpairedTags.indexOf(c)!==-1?(l=s.lastIndexOf(".",s.lastIndexOf(".")-1),this.tagsNodeStack.pop()):l=s.lastIndexOf("."),s=s.substring(0,l),e=this.tagsNodeStack.pop(),i="",n=o}else if(r[n+1]==="?"){let o=Cg(r,n,!1,"?>");if(!o)throw new Error("Pi Tag is not closed.");if(i=this.saveTextToParentTag(i,e,s),!(this.options.ignoreDeclaration&&o.tagName==="?xml"||this.options.ignorePiTags)){const a=new $l(o.tagName);a.add(this.options.textNodeName,""),o.tagName!==o.tagExp&&o.attrExpPresent&&(a[":@"]=this.buildAttributesMap(o.tagExp,s,o.tagName)),this.addChild(e,a,s)}n=o.closeIndex+1}else if(r.substr(n+1,3)==="!--"){const o=fo(r,"-->",n+4,"Comment is not closed.");if(this.options.commentPropName){const a=r.substring(n+4,o-2);i=this.saveTextToParentTag(i,e,s),e.add(this.options.commentPropName,[{[this.options.textNodeName]:a}])}n=o}else if(r.substr(n+1,2)==="!D"){const o=a4(r,n);this.docTypeEntities=o.entities,n=o.i}else if(r.substr(n+1,2)==="!["){const o=fo(r,"]]>",n,"CDATA is not closed.")-2,a=r.substring(n+9,o);i=this.saveTextToParentTag(i,e,s);let c=this.parseTextData(a,e.tagname,s,!0,!1,!0,!0);c==null&&(c=""),this.options.cdataPropName?e.add(this.options.cdataPropName,[{[this.options.textNodeName]:a}]):e.add(this.options.textNodeName,c),n=o+2}else{let o=Cg(r,n,this.options.removeNSPrefix),a=o.tagName;const c=o.rawTagName;let l=o.tagExp,h=o.attrExpPresent,u=o.closeIndex;this.options.transformTagName&&(a=this.options.transformTagName(a)),e&&i&&e.tagname!=="!xml"&&(i=this.saveTextToParentTag(i,e,s,!1));const d=e;if(d&&this.options.unpairedTags.indexOf(d.tagname)!==-1&&(e=this.tagsNodeStack.pop(),s=s.substring(0,s.lastIndexOf("."))),a!==t.tagname&&(s+=s?"."+a:a),this.isItStopNode(this.options.stopNodes,s,a)){let f="";if(l.length>0&&l.lastIndexOf("/")===l.length-1)a[a.length-1]==="/"?(a=a.substr(0,a.length-1),s=s.substr(0,s.length-1),l=a):l=l.substr(0,l.length-1),n=o.closeIndex;else if(this.options.unpairedTags.indexOf(a)!==-1)n=o.closeIndex;else{const m=this.readStopNodeData(r,c,u+1);if(!m)throw new Error(`Unexpected end of ${c}`);n=m.i,f=m.tagContent}const p=new $l(a);a!==l&&h&&(p[":@"]=this.buildAttributesMap(l,s,a)),f&&(f=this.parseTextData(f,a,s,!0,h,!0,!0)),s=s.substr(0,s.lastIndexOf(".")),p.add(this.options.textNodeName,f),this.addChild(e,p,s)}else{if(l.length>0&&l.lastIndexOf("/")===l.length-1){a[a.length-1]==="/"?(a=a.substr(0,a.length-1),s=s.substr(0,s.length-1),l=a):l=l.substr(0,l.length-1),this.options.transformTagName&&(a=this.options.transformTagName(a));const f=new $l(a);a!==l&&h&&(f[":@"]=this.buildAttributesMap(l,s,a)),this.addChild(e,f,s),s=s.substr(0,s.lastIndexOf("."))}else{const f=new $l(a);this.tagsNodeStack.push(e),a!==l&&h&&(f[":@"]=this.buildAttributesMap(l,s,a)),this.addChild(e,f,s),e=f}i="",n=u}}else i+=r[n];return t.child};function I4(r,t,e){const i=this.options.updateTag(t.tagname,e,t[":@"]);i===!1||(typeof i=="string"&&(t.tagname=i),r.addChild(t))}const g4=function(r){if(this.options.processEntities){for(let t in this.docTypeEntities){const e=this.docTypeEntities[t];r=r.replace(e.regx,e.val)}for(let t in this.lastEntities){const e=this.lastEntities[t];r=r.replace(e.regex,e.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const e=this.htmlEntities[t];r=r.replace(e.regex,e.val)}r=r.replace(this.ampEntity.regex,this.ampEntity.val)}return r};function E4(r,t,e,i){return r&&(i===void 0&&(i=Object.keys(t.child).length===0),r=this.parseTextData(r,t.tagname,e,!1,t[":@"]?Object.keys(t[":@"]).length!==0:!1,i),r!==void 0&&r!==""&&t.add(this.options.textNodeName,r),r=""),r}function C4(r,t,e){const i="*."+e;for(const s in r){const n=r[s];if(i===n||t===n)return!0}return!1}function b4(r,t,e=">"){let i,s="";for(let n=t;n<r.length;n++){let o=r[n];if(i)o===i&&(i="");else if(o==='"'||o==="'")i=o;else if(o===e[0])if(e[1]){if(r[n+1]===e[1])return{data:s,index:n}}else return{data:s,index:n};else o==="	"&&(o=" ");s+=o}}function fo(r,t,e,i){const s=r.indexOf(t,e);if(s===-1)throw new Error(i);return s+t.length-1}function Cg(r,t,e,i=">"){const s=b4(r,t+1,i);if(!s)return;let n=s.data;const o=s.index,a=n.search(/\s/);let c=n,l=!0;a!==-1&&(c=n.substring(0,a),n=n.substring(a+1).trimStart());const h=c;if(e){const u=c.indexOf(":");u!==-1&&(c=c.substr(u+1),l=c!==s.data.substr(u+1))}return{tagName:c,tagExp:n,closeIndex:o,attrExpPresent:l,rawTagName:h}}function T4(r,t,e){const i=e;let s=1;for(;e<r.length;e++)if(r[e]==="<")if(r[e+1]==="/"){const n=fo(r,">",e,`${t} is not closed`);if(r.substring(e+2,n).trim()===t&&(s--,s===0))return{tagContent:r.substring(i,e),i:n};e=n}else if(r[e+1]==="?")e=fo(r,"?>",e+1,"StopNode is not closed.");else if(r.substr(e+1,3)==="!--")e=fo(r,"-->",e+3,"StopNode is not closed.");else if(r.substr(e+1,2)==="![")e=fo(r,"]]>",e,"StopNode is not closed.")-2;else{const n=Cg(r,e,">");n&&((n&&n.tagName)===t&&n.tagExp[n.tagExp.length-1]!=="/"&&s++,e=n.closeIndex)}}function bg(r,t,e){if(t&&typeof r=="string"){const i=r.trim();return i==="true"?!0:i==="false"?!1:c4(r,e)}else return VA.isExist(r)?r:""}var y4=l4,zA={};function v4(r,t){return YA(r,t)}function YA(r,t,e){let i;const s={};for(let n=0;n<r.length;n++){const o=r[n],a=R4(o);let c="";if(e===void 0?c=a:c=e+"."+a,a===t.textNodeName)i===void 0?i=o[a]:i+=""+o[a];else{if(a===void 0)continue;if(o[a]){let l=YA(o[a],t,c);const h=S4(l,t);o[":@"]?A4(l,o[":@"],c,t):Object.keys(l).length===1&&l[t.textNodeName]!==void 0&&!t.alwaysCreateTextNode?l=l[t.textNodeName]:Object.keys(l).length===0&&(t.alwaysCreateTextNode?l[t.textNodeName]="":l=""),s[a]!==void 0&&s.hasOwnProperty(a)?(Array.isArray(s[a])||(s[a]=[s[a]]),s[a].push(l)):t.isArray(a,c,h)?s[a]=[l]:s[a]=l}}}return typeof i=="string"?i.length>0&&(s[t.textNodeName]=i):i!==void 0&&(s[t.textNodeName]=i),s}function R4(r){const t=Object.keys(r);for(let e=0;e<t.length;e++){const i=t[e];if(i!==":@")return i}}function A4(r,t,e,i){if(t){const s=Object.keys(t),n=s.length;for(let o=0;o<n;o++){const a=s[o];i.isArray(a,e+"."+a,!0,!0)?r[a]=[t[a]]:r[a]=t[a]}}}function S4(r,t){const{textNodeName:e}=t,i=Object.keys(r).length;return!!(i===0||i===1&&(r[e]||typeof r[e]=="boolean"||r[e]===0))}zA.prettify=v4;const{buildOptions:w4}=XE,_4=y4,{prettify:F4}=zA,O4=BA;let x4=class{constructor(r){this.externalEntities={},this.options=w4(r)}parse(r,t){if(typeof r!="string")if(r.toString)r=r.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(t){t===!0&&(t={});const s=O4.validate(r,t);if(s!==!0)throw Error(`${s.err.msg}:${s.err.line}:${s.err.col}`)}const e=new _4(this.options);e.addExternalEntities(this.externalEntities);const i=e.parseXml(r);return this.options.preserveOrder||i===void 0?i:F4(i,this.options)}addEntity(r,t){if(t.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(r.indexOf("&")!==-1||r.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(t==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[r]=t}};var N4=x4;const P4=N4;var GA={XMLParser:P4};let Tg=class{constructor(t,e){P(this,"date",new Date),P(this,"author"),P(this,"guid",kn.create()),P(this,"viewpoint"),P(this,"modifiedAuthor"),P(this,"modifiedDate"),P(this,"topic"),P(this,"_components"),P(this,"_comment",""),this._components=t,this._comment=e;const i=this._components.get(oi);this.author=i.config.author}set comment(t){var e;const i=this._components.get(oi);this._comment=t,this.modifiedDate=new Date,this.modifiedAuthor=i.config.author,(e=this.topic)==null||e.comments.set(this.guid,this)}get comment(){return this._comment}serialize(){let t=null;this.viewpoint&&(t=`<Viewpoint Guid="${this.viewpoint.guid}"/>`);let e=null;this.modifiedDate&&(e=`<ModifiedDate>${this.modifiedDate.toISOString()}</ModifiedDate>`);let i=null;return this.modifiedAuthor&&(i=`<ModifiedAuthor>${this.modifiedAuthor}</ModifiedAuthor>`),`
      <Comment Guid="${this.guid}">
        <Date>${this.date.toISOString()}</Date>
        <Author>${this.author}</Author>
        <Comment>${this.comment}</Comment>
        ${t??""}
        ${i??""}
        ${e??""}
      </Comment>
    `}};const HA=class er{constructor(t){P(this,"guid",kn.create()),P(this,"title",er.default.title),P(this,"creationDate",new Date),P(this,"creationAuthor",""),P(this,"viewpoints",new gr),P(this,"relatedTopics",new gr),P(this,"comments",new Ns),P(this,"customData",{}),P(this,"description"),P(this,"serverAssignedId"),P(this,"dueDate"),P(this,"modifiedAuthor"),P(this,"modifiedDate"),P(this,"index"),P(this,"_type",er.default.type),P(this,"_status",er.default.status),P(this,"_priority",er.default.priority),P(this,"_stage",er.default.stage),P(this,"_assignedTo",er.default.assignedTo),P(this,"_labels",er.default.labels??new Set),P(this,"_components"),this._components=t;const e=t.get(oi);this.creationAuthor=e.config.author,this.relatedTopics.guard=i=>i!==this.guid}set type(t){const e=this._components.get(oi),{strict:i,types:s}=e.config;(!i||s.has(t))&&(this._type=t)}get type(){return this._type}set status(t){const e=this._components.get(oi),{strict:i,statuses:s}=e.config;(!i||s.has(t))&&(this._status=t)}get status(){return this._status}set priority(t){const e=this._components.get(oi);if(t){const{strict:i,priorities:s}=e.config;if(!(!i||s.has(t)))return;this._priority=t}else this._priority=t}get priority(){return this._priority}set stage(t){const e=this._components.get(oi);if(t){const{strict:i,stages:s}=e.config;if(!(!i||s.has(t)))return;this._stage=t}else this._stage=t}get stage(){return this._stage}set assignedTo(t){const e=this._components.get(oi);if(t){const{strict:i,users:s}=e.config;if(!(!i||s.has(t)))return;this._assignedTo=t}else this._assignedTo=t}get assignedTo(){return this._assignedTo}set labels(t){const e=this._components.get(oi),{strict:i,labels:s}=e.config;if(i){const n=new Set;for(const o of t)(!i||s.has(o))&&n.add(o);this._labels=n}else this._labels=t}get labels(){return this._labels}get _managerVersion(){return this._components.get(oi).config.version}set(t){const e=t,i=this;for(const s in t){if(s==="guid")continue;const n=e[s];s in this&&(i[s]=n)}return this._components.get(oi).list.set(this.guid,this),this}createComment(t,e){const i=new Tg(this._components,t);return i.viewpoint=e,i.topic=this,this.comments.set(i.guid,i),i}createLabelTags(t=this._managerVersion){let e="Labels";t==="2.1"&&(e="Labels"),t==="3"&&(e="Label");let i=[...this.labels].map(s=>`<${e}>${s}</${e}>`).join(`
`);for(const s in this.customData){const n=this.customData[s];typeof n=="string"&&(i+=`
<${e}>${n}</${e}>`)}return t==="2.1"?i:t==="3"?i.length!==0?`<Labels>
${i}
</Labels>`:"<Labels/>":i}createCommentTags(t=this._managerVersion){const e=[...this.comments.values()].map(i=>i.serialize()).join(`
`);return t==="2.1"?e:t==="3"?e.length!==0?`<Comments>
${e}
</Comments>`:"<Comments/>":e}createViewpointTags(t=this._managerVersion){let e="Viewpoints";t==="2.1"&&(e="Viewpoints"),t==="3"&&(e="ViewPoint");const i=this._components.get(Rn),s=[...this.viewpoints].map(n=>i.list.get(n)).filter(n=>n).map(n=>`<${e} Guid="${n.guid}">
          <Viewpoint>${n.guid}.bcfv</Viewpoint>
          <Snapshot>${n.guid}.jpeg</Snapshot>
        </${e}>
      `).join(`
`);return t==="2.1"?s:t==="3"?s.length!==0?`<Viewpoints>
${s}
</Viewpoints>`:"<Viewpoints />":s}createRelatedTopicTags(t=this._managerVersion){const e=[...this.relatedTopics].map(i=>`<RelatedTopic Guid="${i}"></RelatedTopic>
      `).join(`
`);return t==="2.1"?e:t==="3"?e.length!==0?`<RelatedTopics>
${e}
</RelatedTopics>`:"<RelatedTopics />":e}serialize(){const t=this._managerVersion;let e=null;this.serverAssignedId&&(e=`ServerAssignedId="${this.serverAssignedId}"`);let i=null;this.priority&&(i=`<Priority>${this.priority}</Priority>`);let s=null;this.index&&t==="2.1"&&(s=`<Index>${this.index}</Index>`);let n=null;this.modifiedDate&&(n=`<ModifiedDate>${this.modifiedDate.toISOString()}</ModifiedDate>`);let o=null;this.modifiedAuthor&&(o=`<ModifiedAuthor>${this.modifiedAuthor}</ModifiedAuthor>`);let a=null;this.dueDate&&(a=`<DueDate>${this.dueDate.toISOString()}</DueDate>`);let c=null;this.assignedTo&&(c=`<AssignedTo>${this.assignedTo}</AssignedTo>`);let l=null;this.description&&(l=`<Description>${this.description}</Description>`);let h=null;this.stage&&(h=`<Stage>${this.stage}</Stage>`);const u=this.createCommentTags(t),d=this.createViewpointTags(t),f=this.createLabelTags(t),p=this.createRelatedTopicTags(t);return`
      <?xml version="1.0" encoding="UTF-8"?>
      <Markup>
        <Topic Guid="${this.guid}" TopicType="${this.type}" TopicStatus="${this.status}" ${e??""}>
          <Title>${this.title}</Title>
          <CreationDate>${this.creationDate.toISOString()}</CreationDate>
          <CreationAuthor>${this.creationAuthor}</CreationAuthor>
          ${i??""}
          ${s??""}
          ${n??""}
          ${o??""}
          ${a??""}
          ${c??""}
          ${l??""}
          ${h??""}
          ${f}
          ${p}
          ${t==="3"?u:""}
          ${t==="3"?d:""}
        </Topic>
        ${t==="2.1"?u:""}
        ${t==="2.1"?d:""}
      </Markup>
    `}};P(HA,"default",{title:"BCF Topic",type:"Issue",status:"Active"});let mT=HA;const L4=(r,t)=>{if(t.trim()==="")return;const e=oi.xmlParser.parse(t).Extensions;if(!e)return;const{Priorities:i,TopicStatuses:s,TopicTypes:n,Users:o}=e;if(i&&i.Priority){const a=Array.isArray(i.Priority)?i.Priority:[i.Priority];for(const c of a)r.config.priorities.add(c)}if(s&&s.TopicStatus){const a=Array.isArray(s.TopicStatus)?s.TopicStatus:[s.TopicStatus];for(const c of a)r.config.statuses.add(c)}if(n&&n.TopicType){const a=Array.isArray(n.TopicType)?n.TopicType:[n.TopicType];for(const c of a)r.config.types.add(c)}if(o&&o.User){const a=Array.isArray(o.User)?o.User:[o.User];for(const c of a)r.config.users.add(c)}};class M4 extends Wc{constructor(){super(...arguments),P(this,"_config",{version:{type:"Select",options:new Set(["2.1","3"]),multiple:!1,value:""},author:{type:"Text",value:""},types:{type:"TextSet",value:new Set},statuses:{type:"TextSet",value:new Set},priorities:{type:"TextSet",value:new Set},labels:{type:"TextSet",value:new Set},stages:{type:"TextSet",value:new Set},users:{type:"TextSet",value:new Set},includeSelectionTag:{type:"Boolean",value:!1},updateExtensionsOnImport:{type:"Boolean",value:!1},strict:{type:"Boolean",value:!1},includeAllExtensionsOnExport:{type:"Boolean",value:!1},fallbackVersionOnImport:{type:"Select",multiple:!1,options:new Set(["2.1","3"]),value:""},ignoreIncompleteTopicsOnImport:{type:"Boolean",value:!1}})}get version(){return this._config.version.value}set version(t){this._config.version.value=t}get author(){return this._config.author.value}set author(t){this._config.author.value=t}get types(){return this._config.types.value}set types(t){this._config.types.value=t}get statuses(){return this._config.statuses.value}set statuses(t){this._config.statuses.value=t}get priorities(){return this._config.priorities.value}set priorities(t){this._config.priorities.value=t}get labels(){return this._config.labels.value}set labels(t){this._config.labels.value=t}get stages(){return this._config.stages.value}set stages(t){this._config.stages.value=t}get users(){return this._config.users.value}set users(t){this._config.users.value=t}get includeSelectionTag(){return this._config.includeSelectionTag.value}set includeSelectionTag(t){this._config.includeSelectionTag.value=t}get updateExtensionsOnImport(){return this._config.updateExtensionsOnImport.value}set updateExtensionsOnImport(t){this._config.updateExtensionsOnImport.value=t}get strict(){return this._config.strict.value}set strict(t){this._config.strict.value=t}get includeAllExtensionsOnExport(){return this._config.includeAllExtensionsOnExport.value}set includeAllExtensionsOnExport(t){this._config.includeAllExtensionsOnExport.value=t}get fallbackVersionOnImport(){return this._config.fallbackVersionOnImport.value}set fallbackVersionOnImport(t){this._config.fallbackVersionOnImport.value=t}get ignoreIncompleteTopicsOnImport(){return this._config.ignoreIncompleteTopicsOnImport.value}set ignoreIncompleteTopicsOnImport(t){this._config.ignoreIncompleteTopicsOnImport.value=t}}const ZE=class ih extends xt{constructor(){super(...arguments),P(this,"enabled",!1),P(this,"_defaultConfig",{author:"jhon.doe@example.com",version:"2.1",types:new Set(["Clash","Failure","Fault","Inquiry","Issue","Remark","Request"]),statuses:new Set(["Active","In Progress","Done","In Review","Closed"]),priorities:new Set(["On hold","Minor","Normal","Major","Critical"]),labels:new Set,stages:new Set,users:new Set,includeSelectionTag:!1,updateExtensionsOnImport:!0,strict:!1,includeAllExtensionsOnExport:!0,fallbackVersionOnImport:"2.1",ignoreIncompleteTopicsOnImport:!1}),P(this,"config",new M4(this,this.components,"BCF Topics",ih.uuid)),P(this,"list",new Ns),P(this,"onSetup",new nt),P(this,"isSetup",!1),P(this,"onBCFImported",new nt),P(this,"onDisposed",new nt)}setup(t){if(this.isSetup)return;const e={...this._defaultConfig,...t};this.config.version=e.version,this.config.author=e.author,this.config.types=e.types,this.config.statuses=e.statuses,this.config.priorities=e.priorities,this.config.labels=e.labels,this.config.stages=e.stages,this.config.users=e.users,this.config.includeSelectionTag=e.includeSelectionTag,this.config.updateExtensionsOnImport=e.updateExtensionsOnImport,this.config.strict=e.strict,this.config.includeAllExtensionsOnExport=e.includeAllExtensionsOnExport,this.config.fallbackVersionOnImport=e.fallbackVersionOnImport||"",this.config.ignoreIncompleteTopicsOnImport=e.ignoreIncompleteTopicsOnImport,this.isSetup=!0,this.enabled=!0,this.onSetup.trigger()}create(t){const e=new mT(this.components);return t?(e.guid=t.guid??e.guid,e.set(t)):this.list.set(e.guid,e),e}dispose(){this.list.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}get usedTypes(){const t=[...this.list].map(([e,i])=>i.type);return new Set(t)}get usedStatuses(){const t=[...this.list].map(([e,i])=>i.status);return new Set(t)}get usedPriorities(){const t=[...this.list].map(([e,i])=>i.priority).filter(e=>e);return new Set(t)}get usedStages(){const t=[...this.list].map(([e,i])=>i.stage).filter(e=>e);return new Set(t)}get usedUsers(){const t=[];for(const[e,i]of this.list){t.push(i.creationAuthor),i.assignedTo&&t.push(i.assignedTo),i.modifiedAuthor&&t.push(i.modifiedAuthor);for(const[s,n]of i.comments)t.push(n.author),n.modifiedAuthor&&t.push(n.modifiedAuthor)}return new Set(t)}get usedLabels(){const t=[];for(const[e,i]of this.list)t.push(...i.labels);return new Set(t)}updateExtensions(){for(const[t,e]of this.list){for(const i of e.labels)this.config.labels.add(i);this.config.types.add(e.type),e.priority&&this.config.priorities.add(e.priority),e.stage&&this.config.stages.add(e.stage),this.config.statuses.add(e.status),this.config.users.add(e.creationAuthor),e.assignedTo&&this.config.users.add(e.assignedTo),e.modifiedAuthor&&this.config.users.add(e.modifiedAuthor);for(const[i,s]of e.comments)this.config.users.add(s.author),s.modifiedAuthor&&this.config.users.add(s.modifiedAuthor)}}updateViewpointReferences(){const t=this.components.get(Rn);for(const[e,i]of this.list)for(const s of i.viewpoints)t.list.has(s)||i.viewpoints.delete(s)}async export(t=this.list.values()){const e=new hT;e.file("bcf.version",`<?xml version="1.0" encoding="UTF-8"?>
    <Version VersionId="${this.config.version}" xsi:noNamespaceSchemaLocation="https://raw.githubusercontent.com/buildingSMART/BCF-XML/release_3_0/Schemas/version.xsd"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    </Version>`),e.file("bcf.extensions",this.serializeExtensions());const i=await(await fetch("https://thatopen.github.io/engine_components/resources/favicon.ico")).arrayBuffer(),s=this.components.get(Rn);for(const n of t){const o=e.folder(n.guid);o.file("markup.bcf",n.serialize());for(const a of n.viewpoints){const c=s.list.get(a);c&&(o.file(`${a}.jpeg`,i,{binary:!0}),o.file(`${a}.bcfv`,await c.serialize()))}}return await e.generateAsync({type:"blob"})}serializeExtensions(){const t=[...this.config.types].map(a=>`<TopicType>${a}</TopicType>`).join(`
`),e=[...this.config.statuses].map(a=>`<TopicStatus>${a}</TopicStatus>`).join(`
`),i=[...this.config.priorities].map(a=>`<Priority>${a}</Priority>`).join(`
`),s=[...this.config.labels].map(a=>`<TopicLabel>${a}</TopicLabel>`).join(`
`),n=[...this.config.stages].map(a=>`<Stage>${a}</Stage>`).join(`
`),o=[...this.config.users].map(a=>`<User>${a}</User>`).join(`
`);return`
      <?xml version="1.0" encoding="UTF-8"?>
      <Extensions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="your-schema-location.xsd">
        ${t.length!==0?`<TopicTypes>
${t}
</TopicTypes>`:""}
        ${e.length!==0?`<TopicStatuses>
${e}
</TopicStatuses>`:""}
        ${i.length!==0?`<Priorities>
${i}
</Priorities>`:""}
        ${s.length!==0?`<TopicLabels>
${s}
</TopicLabels>`:""}
        ${n.length!==0?`<Stages>
${n}
</Stages>`:""}
        ${o.length!==0?`<Users>
${o}
</Users>`:""}
      </Extensions>
    `}processMarkupComment(t){const{Guid:e,Date:i,Author:s,Comment:n,Viewpoint:o}=t;if(!(e&&i&&s&&Tg))return null;const a=this.components.get(Rn),c=new Tg(this.components,n??"");return c.guid=e,c.date=new Date(i),c.author=s,c.viewpoint=o!=null&&o.Guid?a.list.get(o.Guid):void 0,c.modifiedAuthor=t.ModifiedAuthor,c.modifiedDate=t.ModifiedDate?new Date(t.ModifiedDate):void 0,c}getMarkupComments(t,e){var i;let s;if(e==="2.1"&&(s=t.Comment),e==="3"&&(s=(i=t.Topic.Comments)==null?void 0:i.Comment),!s)return[];s=Array.isArray(s)?s:[s];const n=s.map(o=>this.processMarkupComment(o)).filter(o=>o);return Array.isArray(n)?n:[n]}getMarkupLabels(t,e){var i;let s;return e==="2.1"&&(s=t.Topic.Labels),e==="3"&&(s=(i=t.Topic.Labels)==null?void 0:i.Label),s?Array.isArray(s)?s:[s]:[]}getMarkupViewpoints(t,e){var i;let s;return e==="2.1"&&(s=t.Viewpoints),e==="3"&&(s=(i=t.Topic.Viewpoints)==null?void 0:i.ViewPoint),s?(s=Array.isArray(s)?s:[s],s):[]}getMarkupRelatedTopics(t,e){var i;let s;return e==="2.1"&&(s=t.Topic.RelatedTopic),e==="3"&&(s=(i=t.Topic.RelatedTopics)==null?void 0:i.RelatedTopic),s?(Array.isArray(s)?s:[s]).map(n=>n.Guid):[]}async load(t,e){var i;const{fallbackVersionOnImport:s,ignoreIncompleteTopicsOnImport:n,updateExtensionsOnImport:o}=this.config,a=new hT;await a.loadAsync(t);const c=Object.values(a.files);let l=s;const h=c.find(C=>C.name.endsWith(".version"));if(h){const C=await h.async("string"),b=ih.xmlParser.parse(C).Version.VersionId;l=String(b)}if(!(l&&(l==="2.1"||l==="3")))throw new Error(`BCFTopics: ${l} is not supported.`);const u=c.find(C=>C.name.endsWith(".extensions"));if(o&&u){const C=await u.async("string");L4(this,C)}const d=[],f=this.components.get(Rn),p=c.filter(C=>C.name.endsWith(".bcfv"));for(const C of p){const b=await C.async("string"),E=ih.xmlParser.parse(b).VisualizationInfo;if(!E){console.warn("Missing VisualizationInfo in Viewpoint");continue}const T={},{Guid:A,ClippingPlanes:S,Components:_,OrthogonalCamera:w,PerspectiveCamera:F}=E;if(A&&(T.guid=A),_){const{Selection:R,Visibility:O}=_;if(R&&R.Component){const U=Array.isArray(R.Component)?R.Component:[R.Component];T.selectionComponents=U.map(H=>H.IfcGuid).filter(H=>H)}if(O&&"DefaultVisibility"in O&&(T.defaultVisibility=O.DefaultVisibility),O&&O.Exceptions&&"Component"in O.Exceptions){const{Component:U}=O.Exceptions,H=Array.isArray(U)?U:[U];T.exceptionComponents=H.map(k=>k.IfcGuid).filter(k=>k)}let y;l==="2.1"&&(y=_.ViewSetupHints),l==="3"&&(y=(i=_.Visibility)==null?void 0:i.ViewSetupHints),y&&("OpeningsVisible"in y&&(T.openingsVisible=y.OpeningsVisible),"SpacesVisible"in y&&(T.spacesVisible=y.SpacesVisible),"SpaceBoundariesVisible"in y&&(T.spaceBoundariesVisible=y.SpaceBoundariesVisible))}if(w||F){const R=E.PerspectiveCamera??E.OrthogonalCamera,{CameraViewPoint:O,CameraDirection:y}=R,U=new M(Number(O.X),Number(O.Z),Number(-O.Y)),H=new M(Number(y.X),Number(y.Z),Number(-y.Y)),k={position:{x:U.x,y:U.y,z:U.z},direction:{x:H.x,y:H.y,z:H.z},aspectRatio:"AspectRatio"in R?R.AspectRatio:1};"ViewToWorldScale"in R&&(T.camera={...k,viewToWorldScale:R.ViewToWorldScale}),"FieldOfView"in R&&(T.camera={...k,fov:R.FieldOfView})}const D=new oS(this.components,e,{data:T,setCamera:!1});if(_){const{Coloring:R}=_;if(R&&R.Color){const O=Array.isArray(R.Color)?R.Color:[R.Color];for(const y of O){const{Color:U,Component:H}=y,k=(Array.isArray(H)?H:[H]).map(X=>X.IfcGuid);D.componentColors.set(U,k)}}}if(d.push(D),S){const R=this.components.get(cc),O=Array.isArray(S.ClippingPlane)?S.ClippingPlane:[S.ClippingPlane];for(const y of O){const{Location:U,Direction:H}=y;if(!(U&&H))continue;const k=new M(U.X,U.Z,-U.Y),X=new M(H.X,-H.Z,H.Y),$=R.createFromNormalAndCoplanarPoint(e,X,k);$.visible=!1,$.enabled=!1,D.clippingPlanes.add($)}}}const m={},g=[],I=c.filter(C=>C.name.endsWith(".bcf"));for(const C of I){const b=await C.async("string"),E=ih.xmlParser.parse(b).Markup,T=E.Topic,{Guid:A,TopicType:S,TopicStatus:_,Title:w,CreationDate:F,CreationAuthor:D}=T;if(n&&!(A&&S&&_&&w&&F&&D))continue;const R=new mT(this.components);R.guid=A??R.guid;const O=this.getMarkupRelatedTopics(E,l);m[R.guid]=new Set(O),R.type=S??R.type,R.status=_??R.status,R.title=w??R.title,R.creationDate=F?new Date(F):R.creationDate,R.creationAuthor=D??R.creationAuthor,R.serverAssignedId=T.ServerAssignedId,R.priority=T.Priority,R.index=T.Index,R.modifiedDate=T.ModifiedDate?new Date(T.ModifiedDate):void 0,R.modifiedAuthor=T.ModifiedAuthor,R.dueDate=T.DueDate?new Date(T.DueDate):void 0,R.assignedTo=T.AssignedTo,R.description=T.Description,R.stage=T.Stage;const y=this.getMarkupLabels(E,l);for(const k of y)R.labels.add(k);const U=this.getMarkupComments(E,l);for(const k of U)R.comments.set(k.guid,k);const H=this.getMarkupViewpoints(E,l);for(const k of H){if(!(k&&k.Guid))continue;const X=f.list.get(k.Guid);X&&R.viewpoints.add(X.guid)}this.list.set(R.guid,R),g.push(R)}for(const C in m){const b=this.list.get(C);if(!b)continue;const E=m[C];for(const T of E)b.relatedTopics.add(T)}return this.onBCFImported.trigger(g),{viewpoints:d,topics:g}}};P(ZE,"uuid","de977976-e4f6-4e4f-a01a-204727839802");P(ZE,"xmlParser",new GA.XMLParser({allowBooleanAttributes:!0,attributeNamePrefix:"",ignoreAttributes:!1,ignoreDeclaration:!0,ignorePiTags:!0,numberParseOptions:{leadingZeros:!0,hex:!0},parseAttributeValue:!0,preserveOrder:!1,processEntities:!1,removeNSPrefix:!0,trimValues:!0}));let oi=ZE;const $A=class En extends xt{constructor(t){super(t),P(this,"enabled",!0),P(this,"onDisposed",new nt),P(this,"_absoluteMin"),P(this,"_absoluteMax"),P(this,"_meshes",[]),this.components.add(En.uuid,this),this._absoluteMin=En.newBound(!0),this._absoluteMax=En.newBound(!1)}static getDimensions(t){const{min:e,max:i}=t,s=Math.abs(i.x-e.x),n=Math.abs(i.y-e.y),o=Math.abs(i.z-e.z),a=new M;return a.subVectors(i,e).divideScalar(2).add(e),{width:s,height:n,depth:o,center:a}}static newBound(t){const e=t?1:-1;return new M(e*Number.MAX_VALUE,e*Number.MAX_VALUE,e*Number.MAX_VALUE)}static getBounds(t,e,i){const s=i||this.newBound(!1),n=e||this.newBound(!0);for(const o of t)o.x<n.x&&(n.x=o.x),o.y<n.y&&(n.y=o.y),o.z<n.z&&(n.z=o.z),o.x>s.x&&(s.x=o.x),o.y>s.y&&(s.y=o.y),o.z>s.z&&(s.z=o.z);return new vt(e,i)}dispose(){const t=this.components.get(en);for(const e of this._meshes)t.destroy(e);this._meshes=[],this.onDisposed.trigger(En.uuid),this.onDisposed.reset()}get(){const t=this._absoluteMin.clone(),e=this._absoluteMax.clone();return new vt(t,e)}getSphere(){const t=this._absoluteMin.clone(),e=this._absoluteMax.clone(),i=Math.abs((e.x-t.x)/2),s=Math.abs((e.y-t.y)/2),n=Math.abs((e.z-t.z)/2),o=new M(t.x+i,t.y+s,t.z+n),a=o.distanceTo(t);return new as(o,a)}getMesh(){const t=new vt(this._absoluteMin,this._absoluteMax),e=En.getDimensions(t),{width:i,height:s,depth:n,center:o}=e,a=new kt(i,s,n),c=new it(a);return this._meshes.push(c),c.position.copy(o),c}reset(){this._absoluteMin=En.newBound(!0),this._absoluteMax=En.newBound(!1)}add(t){for(const e of t.items)this.addMesh(e.mesh)}addMesh(t,e){if(!t.geometry.index)return;const i=En.getFragmentBounds(t);t.updateMatrixWorld();const s=t.matrixWorld,n=new ht,o=t instanceof Pe,a=new Set;if(t instanceof Rh){e||(e=t.fragment.ids);for(const c of e){const l=t.fragment.getInstancesIDs(c);if(l)for(const h of l)a.add(h)}}else a.add(0);for(const c of a){const l=i.min.clone(),h=i.max.clone();o&&(t.getMatrixAt(c,n),l.applyMatrix4(n),h.applyMatrix4(n)),l.applyMatrix4(s),h.applyMatrix4(s),l.x<this._absoluteMin.x&&(this._absoluteMin.x=l.x),l.y<this._absoluteMin.y&&(this._absoluteMin.y=l.y),l.z<this._absoluteMin.z&&(this._absoluteMin.z=l.z),l.x>this._absoluteMax.x&&(this._absoluteMax.x=l.x),l.y>this._absoluteMax.y&&(this._absoluteMax.y=l.y),l.z>this._absoluteMax.z&&(this._absoluteMax.z=l.z),h.x>this._absoluteMax.x&&(this._absoluteMax.x=h.x),h.y>this._absoluteMax.y&&(this._absoluteMax.y=h.y),h.z>this._absoluteMax.z&&(this._absoluteMax.z=h.z),h.x<this._absoluteMin.x&&(this._absoluteMin.x=h.x),h.y<this._absoluteMin.y&&(this._absoluteMin.y=h.y),h.z<this._absoluteMin.z&&(this._absoluteMin.z=h.z)}}addFragmentIdMap(t){const e=this.components.get(Nt);for(const i in t){const s=e.list.get(i);if(!s)continue;const n=t[i];this.addMesh(s.mesh,n)}}static getFragmentBounds(t){const e=t.geometry.attributes.position,i=Number.MAX_VALUE,s=-i,n=new M(i,i,i),o=new M(s,s,s);if(!t.geometry.index)throw new Error("Geometry must be indexed!");const a=Array.from(t.geometry.index.array);for(let c=0;c<a.length;c++){if(c%3===0&&a[c]===0&&a[c+1]===0&&a[c+2]===0){c+=2;continue}const l=a[c],h=e.getX(l),u=e.getY(l),d=e.getZ(l);h<n.x&&(n.x=h),u<n.y&&(n.y=u),d<n.z&&(n.z=d),h>o.x&&(o.x=h),u>o.y&&(o.y=u),d>o.z&&(o.z=d)}return new vt(n,o)}};P($A,"uuid","d1444724-dba6-4cdd-a0c7-68ee1450d166");let Ff=$A;const D4=class WA extends xt{constructor(t){super(t),P(this,"enabled",!0),t.add(WA.uuid,this)}async getIsolatedElements(t,e,i){const s=new Set;function n(c){if(s.has(c))return;const l=t.GetLine(e,c);if(l){s.add(c);for(const h in l){const u=l[h];u&&u.constructor.name==="Handle"&&u.value>0?n(u.value):Array.isArray(u)&&u.forEach(d=>{d&&d.constructor.name==="Handle"&&d.value>0&&n(d.value)})}}}for(const c of i)n(c);const o=[];for(const c of s)o.push(c);o.sort((c,l)=>c-l);const a=[];return o.forEach(c=>{const l=t.GetLine(e,c);a.push(l)}),a}async export(t,e,i){return i.forEach(s=>{t.WriteLine(e,s)}),t.SaveModel(e)}async splitIfc(t,e,i){const s=new Uint8Array(e),n=t.OpenModel(s),o=await this.getIsolatedElements(t,n,i),a=t.CreateModel({schema:ky.IFC2X3});return await this.export(t,a,o)}};P(D4,"uuid","6eb0ba2f-71c0-464e-bcec-2d7c335186b2");const jA=class XA{constructor(t){P(this,"onProgress",new nt),P(this,"inclusive",!1),P(this,"rules",[]),P(this,"ids",{}),P(this,"needsUpdate",new Map),P(this,"components"),this.components=t}static import(t,e){const i=XA.importers.get(e.type);return i?i(t,e):(console.warn("Invalid query data:.",e),null)}static importRules(t){const e=[];for(const i of t){const s={};for(const n in i){const o=i[n];o.regexp?s[n]=new RegExp(o.value):s[n]=o}e.push(s)}return e}static importIds(t){const e={};for(const i in t.ids)e[i]=new Set(t.ids[i]);return e}clear(t){if(t===void 0){this.ids={},this.needsUpdate.clear();return}delete this.ids[t],this.needsUpdate.delete(t)}addID(t,e){this.ids[t]||(this.ids[t]=new Set),this.ids[t].add(e)}getData(){const t={};for(const i in this.ids)t[i]=Array.from(this.ids[i]);const e=this.exportRules();return{name:this.name,inclusive:this.inclusive,type:"IfcFinderQuery",ids:t,rules:e}}exportRules(){const t=[];for(const e of this.rules){const i={};for(const s in e){const n=e[s];n instanceof RegExp?i[s]={regexp:!0,value:n.source}:i[s]=n}t.push(i)}return t}findInFile(t,e){return new Promise(i=>{const s=new FileReader,n=new TextDecoder("utf-8"),o=1e4*1024,a=1e3;let c=0;const l=/;/,h=()=>{if(c>=e.size){i();return}const u=Math.min(c+o+a,e.size),d=e.slice(c,u);s.readAsArrayBuffer(d)};s.onload=()=>{if(!(s.result instanceof ArrayBuffer))return;const u=new Uint8Array(s.result),d=n.decode(u).split(l);d.shift(),this.findInLines(t,d),this.onProgress.trigger(c/e.size),c+=o,h()},h()})}getIdFromLine(t){const e=t.slice(t.indexOf("#")+1,t.indexOf("="));return parseInt(e,10)}testRules(t){let e=null,i=null,s=null,n=!1;for(const o of this.rules){if(o.type==="category"){if(e===null&&(e=this.getCategoryFromLine(t),e===null)){if(this.inclusive)continue;break}if(!o.value.test(e)){if(this.inclusive)continue;n=!1;break}n=!0;continue}if(i===null&&(i=this.getAttributesFromLine(t),i===null)){if(this.inclusive)continue;n=!1;break}if(e===null&&(e=this.getCategoryFromLine(t),e===null)){if(this.inclusive)continue;n=!1;break}if(s===null&&(s=Object.keys(new Vy[e]),s=s.slice(2),s===null)){if(this.inclusive)continue;n=!1;break}if(o.type==="property"){const{name:a,value:c}=o;if(!c.test(t)){if(this.inclusive)continue;n=!1;break}let l=!1;for(let h=0;h<i.length;h++){const u=i[h],d=s[h];if(c.test(u)&&a.test(d)){l=!0;break}}if(l)n=!0;else if(!this.inclusive){n=!1;break}}if(o.type==="operator"){const{name:a,value:c,operator:l}=o;let h=!1;for(let u=0;u<i.length;u++){const d=s[u],f=i[u].replace(/IFCLENGTHMEASURE\(|IFCVOLUMEMEASURE\(|\)/g,"");if(a.test(d)){if(l==="="&&parseFloat(f)===c){h=!0;break}else if(l==="<"&&parseFloat(f)<c){h=!0;break}else if(l===">"&&parseFloat(f)>c){h=!0;break}else if(l===">="&&parseFloat(f)>=c){h=!0;break}else if(l==="<="&&parseFloat(f)<=c){h=!0;break}}}if(h)n=!0;else if(!this.inclusive){n=!1;break}}}return n}getCategoryFromLine(t){const e=t.indexOf("=")+1,i=t.indexOf("("),s=t.slice(e,i).trim();return AU[s]||null}getAttributesFromLine(t){const e=/\((.*)\)/,i=t.match(e);if(!(i&&i[1]))return null;const s=/,(?![^()]*\))/g;return i[1].split(s).map(n=>n.trim())}};P(jA,"importers",new Map);let Fn=jA,IT=class{constructor(t){P(this,"list",new Map),P(this,"id",Ss.generateUUID()),P(this,"mode","intersect"),P(this,"_components"),this._components=t}get queries(){return new Set(this.list.values())}get items(){const t=[];for(const e of this.queries)t.push(e.items);return this.mode==="combine"?ns.combine(t):ns.intersect(t)}add(t){if(this.list.has(t.name))throw new Error(`This group already has a query with the name ${t.name}.`);this.list.set(t.name,t)}clear(t){for(const e of this.queries)e.clear(t)}import(t){this.mode=t.mode,this.id=t.id;for(const e in t.queries){const i=Fn.import(this._components,t.queries[e]);i&&this.list.set(e,i)}}export(){const t={};for(const[e,i]of this.list)t[e]=i.export();return{mode:this.mode,id:this.id,queries:t}}async update(t,e){for(const i of this.queries){const s=i.needsUpdate.get(t);(s===void 0||s)&&await i.update(t,e)}}};const ZA=class qA extends Fn{constructor(t,e){super(t),P(this,"name"),this.name=e.name,this.rules=e.rules,this.inclusive=e.inclusive}get items(){const t=this.components.get(Nt),e=[];for(const i in this.ids){const s=this.ids[i],n=t.groups.get(i);if(!n){console.warn(`Model ${i} not found!`);continue}const o=n.getFragmentMap(s);e.push(o)}return ns.combine(e)}export(){const t=this.getData();return t.type=qA.type,t}async update(t,e){this.ids[t]=new Set,await this.findInFile(t,e),this.needsUpdate.set(t,!1)}findInLines(t,e){for(const i of e)if(this.testRules(i)){const s=this.getIdFromLine(i);this.addID(t,s)}}};P(ZA,"type","IfcBasicQuery");let gT=ZA;Fn.importers.set(gT.type,(r,t)=>{const e=new gT(r,{name:t.name,rules:Fn.importRules(t.rules),inclusive:t.inclusive});return e.ids=Fn.importIds(t),e});const QA=class KA extends Fn{constructor(t,e){super(t),P(this,"name"),P(this,"psets",[]),this.name=e.name,this.rules=e.rules,this.inclusive=e.inclusive}get items(){const t=this.components.get(_i),e=this.components.get(Nt),i=[];for(const s in this.ids){const n=e.groups.get(s);if(!n){console.log(`Model not found: ${s}.`);continue}const o=this.ids[s];for(const a of o){const c=t.getEntityRelations(s,a,"DefinesOcurrence");if(c){const l=n.getFragmentMap(c);i.push(l)}}}return ns.combine(i)}export(){const t=this.getData();return t.type=KA.type,t}async update(t,e){await this.findInFile(t,e);const i=new Set;for(const s of this.psets){const n=this.getAttributesFromLine(s);if(n===null)continue;const o=n[4].replace("(","[").replace(")","]").replace(/#/g,""),a=JSON.parse(o);for(const c of a){const l=this.ids[t];if(l&&l.has(c)){const h=this.getIdFromLine(s);i.add(h);break}}}this.ids[t]=i,this.psets=[],this.needsUpdate.set(t,!1)}findInLines(t,e){for(const i of e){const s=this.getCategoryFromLine(i);if(s==="IfcPropertySet"){this.psets.push(i);continue}if(s==="IfcPropertySingleValue"&&this.testRules(i)){const n=this.getIdFromLine(i);this.addID(t,n)}}}};P(QA,"type","IfcPropertyQuery");let ET=QA;Fn.importers.set(ET.type,(r,t)=>{const e=new ET(r,{name:t.name,inclusive:t.inclusive,rules:Fn.importRules(t.rules)});return e.ids=Fn.importIds(t),e});const U4=class JA extends xt{constructor(t){super(t),P(this,"enabled",!0),P(this,"list",new Map),t.add(JA.uuid,this)}get queries(){const t=new Set;for(const[,e]of this.list)for(const i of e.queries)t.add(i);return t}import(t){for(const e in t){const i=new IT(this.components);i.import(t[e]),this.list.set(e,i)}}export(){const t={};for(const[e,i]of this.list)t[e]=i.export();return t}create(){const t=new IT(this.components);return this.list.set(t.id,t),t}delete(t){this.list.delete(t)}clear(){this.list.clear()}};P(U4,"uuid","0da7ad77-f734-42ca-942f-a074adfd1e3a");const tS=class eS extends xt{constructor(t){super(t),P(this,"enabled",!0),P(this,"list",{}),P(this,"onDisposed",new nt),P(this,"onFragmentsDisposed",e=>{const{groupID:i,fragmentIDs:s}=e;for(const n in this.list){const o=this.list[n],a=Object.keys(o);if(a.includes(i))delete o[i],Object.values(o).length===0&&delete this.list[n];else for(const c of a){const l=o[c];for(const h of s)delete l.map[h];Object.values(l).length===0&&delete o[c]}}}),t.add(eS.uuid,this),t.get(Nt).onFragmentsDisposed.add(this.onFragmentsDisposed)}dispose(){this.list={},this.components.get(Nt).onFragmentsDisposed.remove(this.onFragmentsDisposed),this.onDisposed.trigger(),this.onDisposed.reset()}remove(t){for(const e in this.list){const i=this.list[e];for(const s in i){const n=i[s];delete n.map[t]}}}find(t){const e=this.components.get(Nt);if(!t){const o={};for(const[a,c]of e.list)o[a]=new Set(c.ids);return o}const i=Object.keys(t).length,s={};for(const o in t){const a=t[o];if(!this.list[o]){console.warn(`Classification ${o} does not exist.`);continue}for(const c of a){const l=this.list[o][c];if(l)for(const h in l.map){s[h]||(s[h]=new Map);for(const u of l.map[h]){const d=s[h].get(u);d===void 0?s[h].set(u,1):s[h].set(u,d+1)}}}}const n={};for(const o in s){const a=s[o];for(const[c,l]of a){if(l===void 0)throw new Error("Malformed fragments map!");l===i&&(n[o]||(n[o]=new Set),n[o].add(c))}}return n}byModel(t,e){this.list.models||(this.list.models={});const i=this.list.models;i[t]||(i[t]={map:{},id:null,name:t});const s=i[t];for(const[n,o]of e.data){const a=o[0];for(const c of a){const l=e.keyFragments.get(c);l&&(s.map[l]||(s.map[l]=new Set),s.map[l].add(n))}}}async byPredefinedType(t){var e;this.list.predefinedTypes||(this.list.predefinedTypes={});const i=this.list.predefinedTypes,s=t.getAllPropertiesIDs();for(const n of s){const o=await t.getProperties(n);if(!o)continue;const a=String((e=o.PredefinedType)==null?void 0:e.value).toUpperCase();i[a]||(i[a]={map:{},id:null,name:a});const c=i[a];for(const[l,h]of t.data){const u=h[0];for(const d of u){const f=t.keyFragments.get(d);if(!f)throw new Error("Fragment ID not found!");c.map[f]||(c.map[f]=new Set),c.map[f].add(o.expressID)}}}}byEntity(t){this.list.entities||(this.list.entities={});for(const[e,i]of t.data){const s=i[1][1],n=_f[s];this.saveItem(t,"entities",n,e)}}async byIfcRel(t,e,i){hh.isRel(e)&&await hh.getRelationMap(t,e,async(s,n)=>{const{name:o}=await hh.getEntityName(t,s);for(const a of n)this.saveItem(t,i,o??"NO REL NAME",a)})}async bySpatialStructure(t,e={}){var i,s;const n=this.components.get(_i),o=n.relationMaps[t.uuid];if(!o)throw new Error(`Classifier: model relations of ${t.name||t.uuid} have to exists to group by spatial structure.`);const a=e.systemName??"spatialStructures",c=e.useProperties===void 0||e.useProperties;for(const[l]of o){if(e.isolate){const f=t.data.get(l);if(!f)continue;const p=f[1][1];if(p===void 0||!e.isolate.has(p))continue}const h=n.getEntityRelations(t,l,"Decomposes");if(h)for(const f of h){let p=f.toString();if(c){const m=await t.getProperties(f);if(!m)continue;p=(i=m.Name)==null?void 0:i.value}this.saveItem(t,a,p,l,f)}const u=n.getEntityRelations(t,l,"ContainsElements");if(!u)continue;let d=l.toString();if(c){const f=await t.getProperties(l);if(!f)continue;d=(s=f.Name)==null?void 0:s.value}for(const f of u){this.saveItem(t,a,d,f,l);const p=n.getEntityRelations(t,Number(f),"IsDecomposedBy");if(p)for(const m of p)this.saveItem(t,a,d,m,l)}}}setColor(t,e,i=!1){const s=this.components.get(Nt);for(const n in t){const o=s.list.get(n);if(!o)continue;const a=t[n];o.setColor(e,a,i)}}resetColor(t){const e=this.components.get(Nt);for(const i in t){const s=e.list.get(i);if(!s)continue;const n=t[i];s.resetColor(n)}}export(){const t={};for(const e in this.list){t[e]={};const i=this.list[e];for(const s in i){const n=i[s];t[e][s]={map:ns.export(n.map),name:n.name,id:n.id}}}return t}import(t){for(const e in t){this.list[e]||(this.list[e]={});const i=t[e];for(const s in i){const n=i[s];this.list[e][s]={map:ns.import(n.map),name:n.name,id:n.id}}}}saveItem(t,e,i,s,n=null){this.list[e]||(this.list[e]={});const o=t.data.get(s);if(o)for(const a of o[0]){const c=t.keyFragments.get(a);if(c){const l=this.list[e];l[i]||(l[i]={map:{},id:n,name:i}),l[i].map[c]||(l[i].map[c]=new Set),l[i].map[c].add(s)}}}};P(tS,"uuid","e25a7f3c-46c4-4a14-9d3d-5115f24ebeb7");let yg=tS;const B4=class iS extends xt{constructor(t){super(t),P(this,"onDisposed",new nt),P(this,"enabled",!0),P(this,"height",10),P(this,"groupName","spatialStructures"),P(this,"list",new Set),t.add(iS.uuid,this)}dispose(){this.list.clear(),this.onDisposed.trigger(),this.onDisposed.reset()}set(t){if(!this.enabled)return;const e=this.components.get(yg),i=this.components.get(Nt),s=t?1:-1;let n=0;const o=e.list[this.groupName],a=new ht;for(const c in o){a.elements[13]=n*s*this.height;for(const l in o[c].map){const h=i.list.get(l),u=c+l,d=this.list.has(u);if(!h||t&&d||!t&&!d)continue;t?this.list.add(u):this.list.delete(u);const f=o[c].map[l];h.applyTransform(f,a),h.mesh.computeBoundingSphere(),h.mesh.computeBoundingBox()}n++}}};P(B4,"uuid","d260618b-ce88-4c7d-826c-6debb91de3e2");const sS=class nS extends xt{constructor(t){super(t),P(this,"enabled",!0),this.components.add(nS.uuid,this)}set(t,e){const i=this.components.get(Nt);if(!e){for(const[s,n]of i.list)n&&(n.setVisibility(t),this.updateCulledVisibility(n));return}for(const s in e){const n=e[s],o=i.list.get(s);o&&(o.setVisibility(t,n),this.updateCulledVisibility(o))}}isolate(t){this.set(!1),this.set(!0,t)}updateCulledVisibility(t){const e=this.components.get(rU);for(const[i,s]of e.list){const n=s.colorMeshes.get(t.id);n&&(n.count=t.mesh.count)}}};P(sS,"uuid","dd9ccf2d-8a21-4821-b7f6-2949add16a29");let k4=sS;class V4 extends WE{constructor(){super(...arguments),P(this,"minGeometrySize",10),P(this,"minAssetsSize",1e3),P(this,"maxTriangles",null)}}const z4=class rS extends xt{constructor(t){super(t),P(this,"onGeometryStreamed",new vn),P(this,"onAssetStreamed",new vn),P(this,"onProgress",new vn),P(this,"onIfcLoaded",new vn),P(this,"onDisposed",new nt),P(this,"settings",new V4),P(this,"enabled",!0),P(this,"webIfc",new is),P(this,"_nextAvailableID",0),P(this,"_splittedGeometries",new Map),P(this,"_spatialTree",new AA),P(this,"_metaData",new wA),P(this,"_visitedGeometries",new Map),P(this,"_streamSerializer",new RE),P(this,"_geometries",new Map),P(this,"_geometryCount",0),P(this,"_civil",new SA),P(this,"_groupSerializer",new cp),P(this,"_assets",[]),P(this,"_meshesWithHoles",new Set),this.components.add(rS.uuid,this),this.settings.excludedCategories.add(Wf)}dispose(){this.onIfcLoaded.reset(),this.onGeometryStreamed.reset(),this.onAssetStreamed.reset(),this.webIfc=null,this.onDisposed.trigger(),this.onDisposed.reset()}async streamFromBuffer(t){await this.readIfcFile(t),await this.streamAllGeometries(),this.cleanUp()}async streamFromCallBack(t){await this.streamIfcFile(t),await this.streamAllGeometries(),this.cleanUp()}async readIfcFile(t){const{path:e,absolute:i,logLevel:s}=this.settings.wasm;this.webIfc.SetWasmPath(e,i),await this.webIfc.Init(),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModel(t,this.settings.webIfc),this._nextAvailableID=this.webIfc.GetMaxExpressID(0)}async streamIfcFile(t){const{path:e,absolute:i,logLevel:s}=this.settings.wasm;this.webIfc.SetWasmPath(e,i),await this.webIfc.Init(),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModelFromCallback(t,this.settings.webIfc),this._nextAvailableID=this.webIfc.GetMaxExpressID(0)}async streamAllGeometries(){console.log("Converting geometries to tiles...");const{minGeometrySize:t,minAssetsSize:e}=this.settings;this._spatialTree.setUp(this.webIfc);const i=this.webIfc.GetIfcEntityList(0),s=[[]],n=new si;n.ifcMetadata={name:"",description:"",...this._metaData.getNameInfo(this.webIfc),...this._metaData.getDescriptionInfo(this.webIfc),schema:this.webIfc.GetModelSchema(0)||"IFC2X3",maxExpressID:this.webIfc.GetMaxExpressID(0)};let o=0,a=0;for(const p of i){if(!this.webIfc.IsIfcElement(p)&&p!==Ii||this.settings.excludedCategories.has(p))continue;const m=this.webIfc.GetLineIDsWithType(0,p),g=m.size();for(let I=0;I<g;I++){o>t&&(o=0,a++,s.push([]));const C=m.get(I);s[a].push(C);const b=this.webIfc.GetLine(0,C);if(b.GlobalId){const T=b?.GlobalId.value||b?.GlobalId;n.globalToExpressIDs.set(T,C)}const E=this._spatialTree.itemsByFloor[C]||0;n.data.set(C,[[],[E,p]]),o++}}this._spatialTree.cleanUp();let c=.01,l=0;for(const p of s){l++,this.webIfc.StreamMeshes(0,p,g=>{this.getMesh(this.webIfc,g,n)}),this._geometryCount>this.settings.minGeometrySize&&await this.streamGeometries(),this._assets.length>e&&await this.streamAssets();const m=l/s.length;m>c&&(c+=.01,c=Math.max(c,m),await this.onProgress.trigger(Math.round(c*100)/100))}this._geometryCount&&await this.streamGeometries(),this._assets.length&&await this.streamAssets();const{opaque:h,transparent:u}=n.geometryIDs;for(const[p,{index:m,uuid:g}]of this._visitedGeometries)n.keyFragments.set(m,g),(p>1?h:u).set(p,m);_A.get(n,this.webIfc);const d=this.webIfc.GetCoordinationMatrix(0);n.coordinationMatrix.fromArray(d),n.civilData=this._civil.read(this.webIfc);const f=this._groupSerializer.export(n);await this.onIfcLoaded.trigger(f),n.dispose(!0)}cleanUp(){try{this.webIfc.Dispose()}catch{}this.webIfc=null,this.webIfc=new is,this._visitedGeometries.clear(),this._geometries.clear(),this._assets=[],this._meshesWithHoles.clear()}getMesh(t,e,i){const s=e.geometries.size(),n=e.expressID,o={id:n,geometries:[]};for(let a=0;a<s;a++){const c=e.geometries.get(a),l=c.geometryExpressID,h=c.color.w===1,u=l*(h?1:-1);this._visitedGeometries.has(u)||this.getGeometry(t,l,h),this.registerGeometryData(i,n,c,o,l,u);const d=this._splittedGeometries.get(l);if(d)for(const f of d)this.registerGeometryData(i,n,c,o,f,f)}this._assets.push(o)}getGeometry(t,e,i){const s=t.GetGeometry(0,e),n=t.GetIndexArray(s.GetIndexData(),s.GetIndexDataSize()),o=t.GetVertexArray(s.GetVertexData(),s.GetVertexDataSize()),a=new Float32Array(o.length/2),c=new Float32Array(o.length/2);for(let d=0;d<o.length;d+=6)a[d/2]=o[d],a[d/2+1]=o[d+1],a[d/2+2]=o[d+2],c[d/2]=o[d+3],c[d/2+1]=o[d+4],c[d/2+2]=o[d+5];const l=i?1:-1;if(n.length===0){const d=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1]);this._geometries.set(e,{position:a,normal:c,index:n,boundingBox:d,hasHoles:!1});const f=this._visitedGeometries.size,p=Ss.generateUUID(),m=e*l;this._visitedGeometries.set(m,{uuid:p,index:f}),this._geometryCount++,s.delete();return}const h=(this.settings.maxTriangles||n.length/3)*3;let u=!0;for(let d=0;d<n.length;d+=h){const f=n.length-d,p=Math.min(f,h),m=d+p,g=[],I=[],C=[];let b=0;for(let y=d;y<m;y++){g.push(b++);const U=n[y];I.push(a[U*3]),I.push(a[U*3+1]),I.push(a[U*3+2]),C.push(c[U*3]),C.push(c[U*3+1]),C.push(c[U*3+2])}const E=new Uint32Array(g),T=new Float32Array(I),A=new Float32Array(C),S=W3(T),_=new Float32Array(S.transformation.elements),w=!1,F=u?e:this._nextAvailableID++;this._geometries.set(F,{position:T,normal:A,index:E,boundingBox:_,hasHoles:w}),u||(this._splittedGeometries.has(e)||this._splittedGeometries.set(e,new Set),this._splittedGeometries.get(e).add(F));const D=this._visitedGeometries.size,R=Ss.generateUUID(),O=F*l;this._visitedGeometries.set(O,{uuid:R,index:D}),this._geometryCount++,u=!1}s.delete()}async streamAssets(){await this.onAssetStreamed.trigger(this._assets),this._assets=null,this._assets=[]}async streamGeometries(){const t=new Map;for(const[e,i]of this._geometries)t.set(e,i),t.size>this.settings.minGeometrySize&&await this.outputGeometries(t);await this.outputGeometries(t),this._geometries.clear(),this._geometryCount=0}async outputGeometries(t){let e=this._streamSerializer.export(t),i={};for(const[s,{boundingBox:n,hasHoles:o}]of t)i[s]={boundingBox:n,hasHoles:o};await this.onGeometryStreamed.trigger({data:i,buffer:e}),i=null,e=null,t.clear()}registerGeometryData(t,e,i,s,n,o){const a=this._visitedGeometries.get(o);if(a===void 0)throw new Error("Error getting geometry data for streaming!");const c=t.data.get(e);if(!c)throw new Error("Data not found!");c[0].push(a.index);const{x:l,y:h,z:u,w:d}=i.color,f=[l,h,u,d],p=i.flatTransformation;s.geometries.push({color:f,geometryID:n,transformation:p})}};P(z4,"uuid","d9999a00-e1f5-4d3f-8cfe-c56e08609764");class Y4 extends WE{constructor(){super(...arguments),P(this,"propertiesSize",100)}}class G4 extends xt{constructor(){super(...arguments),P(this,"onPropertiesStreamed",new vn),P(this,"onProgress",new vn),P(this,"onIndicesStreamed",new vn),P(this,"onDisposed",new nt),P(this,"enabled",!0),P(this,"settings",new Y4),P(this,"webIfc",new is)}async dispose(){this.onIndicesStreamed.reset(),this.onPropertiesStreamed.reset(),this.webIfc=null,this.onDisposed.reset()}async streamFromBuffer(t){await this.readIfcFile(t),await this.streamAllProperties(),this.cleanUp()}async streamFromCallBack(t){await this.streamIfcFile(t),await this.streamAllProperties(),this.cleanUp()}async readIfcFile(t){const{path:e,absolute:i,logLevel:s}=this.settings.wasm;this.webIfc.SetWasmPath(e,i),await this.webIfc.Init(),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModel(t,this.settings.webIfc)}async streamIfcFile(t){const{path:e,absolute:i,logLevel:s}=this.settings.wasm;this.webIfc.SetWasmPath(e,i),await this.webIfc.Init(),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModelFromCallback(t,this.settings.webIfc)}async streamAllProperties(){const{propertiesSize:t}=this.settings,e=new Set(this.webIfc.GetIfcEntityList(0)),i=new Set([Bo,Nc,Pc,ko,Ii]);for(const a of i)e.add(a);let s=.01,n=0;for(const a of e){if(n++,FA.has(a))continue;const c=i.has(a),l=this.webIfc.GetLineIDsWithType(0,a),h=l.size();let u=0;for(let d=0;d<h-t;d+=t){const f={};for(let p=0;p<t;p++){u++;const m=l.get(d+p);try{const g=this.webIfc.GetLine(0,m,c);f[g.expressID]=g}catch{console.log(`Could not get property: ${m}`)}}await this.onPropertiesStreamed.trigger({type:a,data:f})}if(u!==h){const d={};for(let f=u;f<h;f++){const p=l.get(f);try{const m=this.webIfc.GetLine(0,p,c);d[m.expressID]=m}catch{console.log(`Could not get property: ${p}`)}}await this.onPropertiesStreamed.trigger({type:a,data:d})}n/e.size>s&&(s=Math.round(s*100)/100,await this.onProgress.trigger(s),s+=.01)}await this.onProgress.trigger(1);const o=await this.components.get(_i).processFromWebIfc(this.webIfc,0);await this.onIndicesStreamed.trigger(o)}cleanUp(){this.webIfc.Dispose(),this.webIfc=null,this.webIfc=new is}}P(G4,"uuid","88d2c89c-ce32-47d7-8cb6-d51e4b311a0b");let oS=class{constructor(t,e,i){P(this,"title"),P(this,"guid",kn.create()),P(this,"clippingPlanes",new gr),P(this,"camera",{aspectRatio:1,fov:60,direction:{x:0,y:0,z:0},position:{x:0,y:0,z:0}}),P(this,"exceptionComponents",new gr),P(this,"selectionComponents",new gr),P(this,"componentColors",new Ns),P(this,"spacesVisible",!1),P(this,"spaceBoundariesVisible",!1),P(this,"openingsVisible",!1),P(this,"defaultVisibility",!0),P(this,"_components"),P(this,"world");const s={setCamera:!0,...i},{data:n,setCamera:o}=s;this._components=t,this.world=e,n&&(this.guid=n.guid??this.guid,this.set(n)),o&&this.updateCamera()}get _selectionModelIdMap(){const t=this._components.get(Nt),e={};for(const[i,s]of t.groups){i in e||(e[i]=new Set);for(const n of this.selectionComponents){const o=s.globalToExpressIDs.get(n);o&&e[i].add(o)}}return e}get _exceptionModelIdMap(){const t=this._components.get(Nt),e={};for(const[i,s]of t.groups){i in e||(e[i]=new Set);for(const n of this.exceptionComponents){const o=s.globalToExpressIDs.get(n);o&&e[i].add(o)}}return e}get selection(){return this._components.get(Nt).modelIdToFragmentIdMap(this._selectionModelIdMap)}get exception(){return this._components.get(Nt).modelIdToFragmentIdMap(this._exceptionModelIdMap)}get projection(){return"fov"in this.camera?"Perspective":"Orthographic"}get position(){const t=this._components.get(Nt),{position:e}=this.camera,{x:i,y:s,z:n}=e,o=new M(i,s,n);return t.applyBaseCoordinateSystem(o,new ht),o}get direction(){const{direction:t}=this.camera,{x:e,y:i,z:s}=t;return new M(e,i,s)}get _managerVersion(){return this._components.get(oi).config.version}get topics(){return[...this._components.get(oi).list.values()].filter(t=>t.viewpoints.has(this.guid))}addComponentsFromMap(t){const e=this._components.get(Nt).fragmentIdMapToGuids(t);this.selectionComponents.add(...e),this._components.get(Rn).list.set(this.guid,this)}set(t){const e=t,i=this;for(const s in t){if(s==="guid")continue;const n=e[s];if(s==="selectionComponents"){this.selectionComponents.clear(),this.selectionComponents.add(...n);continue}if(s==="exceptionComponents"){this.exceptionComponents.clear(),this.exceptionComponents.add(...n);continue}s in this&&(i[s]=n)}return this._components.get(Rn).list.set(this.guid,this),this}async go(t,e=!0){const{camera:i}=t??this.world;if(!i.hasCameraControls())throw new Error("Viewpoint: the world's camera need controls to set the viewpoint.");i instanceof RU&&i.projection.set(this.projection);const s=new M(this.camera.position.x,this.camera.position.y,this.camera.position.z),n=new M(this.camera.direction.x,this.camera.direction.y,this.camera.direction.z);if(s.equals(new M)&&n.equals(new M))return;const o=this.position,a=this.direction;let c={x:o.x+a.x*80,y:o.y+a.y*80,z:o.z+a.z*80};const l=this.selection;if(Object.keys(l).length===0){const h=this._components.get(es).get(this.world).castRayFromVector(o,this.direction);h&&(c=h.point)}else{const h=this._components.get(Ff);h.reset(),h.addFragmentIdMap(l),c=h.getSphere().center,h.reset()}await i.controls.setLookAt(o.x,o.y,o.z,c.x,c.y,c.z,e)}updateCamera(t){const{camera:e,renderer:i}=t??this.world;if(!i)throw new Error("Viewpoint: the world needs to have a renderer!");if(!e.hasCameraControls())throw new Error("Viewpoint: world's camera need camera controls!");const s=new M;e.controls.getPosition(s);const n=e.three,o=new M(0,0,-1).applyEuler(n.rotation),{width:a,height:c}=i.getSize();let l=a/c;Number.isNaN(l)&&(l=1);const h=this._components.get(Nt);s.applyMatrix4(h.baseCoordinationMatrix.clone().invert());const u={aspectRatio:l,position:{x:s.x,y:s.y,z:s.z},direction:{x:o.x,y:o.y,z:o.z}};n instanceof hr?this.camera={...u,fov:n.fov}:n instanceof cs&&(this.camera={...u,viewToWorldScale:n.top-n.bottom}),this._components.get(Rn).list.set(this.guid,this)}applyVisibility(){const t=this._components.get(k4);t.set(this.defaultVisibility),t.set(!this.defaultVisibility,this.exception),t.set(!0,this.selection)}applyColors(){const t=this._components.get(Rn),e=this._components.get(Nt),i=this._components.get(yg);for(const[s,n]of this.componentColors){const o=e.guidToFragmentIdMap(n);i.setColor(o,s,t.config.overwriteColors)}}resetColors(){const t=this._components.get(Nt),e=this._components.get(yg);for(const[i,s]of this.componentColors){const n=t.guidToFragmentIdMap(s);e.resetColor(n)}}async createComponentTags(t){var e,i;const s=this._components.get(Nt),n=this._components.get(oi);let o="";if(n.config.includeSelectionTag){const a=t==="selection"?this._selectionModelIdMap:this._exceptionModelIdMap;for(const c in a){const l=s.groups.get(c);if(!l)continue;const h=a[c];for(const u of h){const d=await l.getProperties(u);if(!d)continue;const f=(e=d.GlobalId)==null?void 0:e.value;if(!f)continue;const p=(i=d.Tag)==null?void 0:i.value;let m=null;p&&(m=`AuthoringToolId="${p}"`),o+=`
<Component IfcGuid="${f}" ${m??""} />`}}}else o=[...this.selectionComponents].map(a=>`<Component IfcGuid="${a}" />`).join(`
`);return o}createColorTags(){let t="";for(const[e,i]of this.componentColors.entries()){const s=`#${e.getHexString()}`,n=i.map(o=>`
<Component IfcGuid="${o}" />`).join(`
`);t+=`<Color Color="${s}">
${n}
</Color>`}return t.length!==0?`<Coloring>
${t}
</Coloring>`:"<Coloring />"}async serialize(t=this._managerVersion){const e=this._components.get(Nt),i=this.position;i.applyMatrix4(e.baseCoordinationMatrix.clone().invert());const s=this.direction;s.normalize();const n=new ht().makeRotationX(Math.PI/2),o=s.clone().applyMatrix4(n);o.normalize();const a=`<CameraViewPoint>
      <X>${i.x}</X>
      <Y>${-i.z}</Y>
      <Z>${i.y}</Z>
    </CameraViewPoint>`,c=`<CameraDirection>
      <X>${s.x}</X>
      <Y>${-s.z}</Y>
      <Z>${s.y}</Z>
    </CameraDirection>`,l=`<CameraUpVector>
      <X>${o.x}</X>
      <Y>${-o.z}</Y>
      <Z>${o.y}</Z>
    </CameraUpVector>`,h=`<AspectRatio>${this.camera.aspectRatio}</AspectRatio>`;let u="";"viewToWorld"in this.camera?u=`<OrthogonalCamera>
        ${a}
        ${c}
        ${l}
        ${h}
        <ViewToWorldScale>${this.camera.viewToWorld}</ViewToWorldScale>
      </OrthogonalCamera>`:"fov"in this.camera&&(u=`<PerspectiveCamera>
        ${a}
        ${c}
        ${l}
        ${h}
        <FieldOfView>${this.camera.fov}</FieldOfView>
      </PerspectiveCamera>`);const d=`<ViewSetupHints SpacesVisible="${this.spacesVisible??!1}" SpaceBoundariesVisible="${this.spaceBoundariesVisible??!1}" OpeningsVisible="${this.openingsVisible??!1}" />`,f=(await this.createComponentTags("selection")).trim(),p=(await this.createComponentTags("exception")).trim(),m=this.createColorTags();return`<?xml version="1.0" encoding="UTF-8"?>
    <VisualizationInfo Guid="${this.guid}">
      <Components>
        ${t==="2.1"?d:""}
        ${f.length!==0?`<Selection>${f}</Selection>`:""}
        <Visibility DefaultVisibility="${this.defaultVisibility}">
          ${t==="3"?d:""}
          ${p.length!==0?`<Exceptions>${p}</Exceptions>`:""}
        </Visibility>
        ${m}
      </Components>
      ${u}
    </VisualizationInfo>`}};class H4 extends Wc{constructor(){super(...arguments),P(this,"_config",{overwriteColors:{value:!1,type:"Boolean"}})}get overwriteColors(){return this._config.overwriteColors.value}set overwriteColors(t){this._config.overwriteColors.value=t}}const aS=class vg extends xt{constructor(t){super(t),P(this,"enabled",!0),P(this,"list",new Ns),P(this,"isSetup",!1),P(this,"onSetup",new nt),P(this,"config",new H4(this,this.components,"Viewpoints",vg.uuid)),P(this,"onDisposed",new nt),t.add(vg.uuid,this)}create(t,e){const i=new oS(this.components,t,{data:e});return e||this.list.set(i.guid,i),i}setup(){}dispose(){this.list.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}};P(aS,"uuid","ee867824-a796-408d-8aa0-4e5962a83c66");let Rn=aS;class $4 extends Wc{constructor(){super(...arguments),P(this,"_config",{visible:{value:!0,type:"Boolean"},lockRotation:{value:!0,type:"Boolean"},zoom:{type:"Number",interpolable:!0,value:.05,min:.001,max:5},frontOffset:{type:"Number",interpolable:!0,value:0,min:0,max:100},sizeX:{type:"Number",interpolable:!0,value:320,min:20,max:5e3},sizeY:{type:"Number",interpolable:!0,value:160,min:20,max:5e3},backgroundColor:{value:new Rt,type:"Color"}})}get visible(){return this._config.visible.value}set visible(t){this._config.visible.value=t;const e=this._component.renderer.domElement.style;e.display=t?"block":"none"}get lockRotation(){return this._config.lockRotation.value}set lockRotation(t){this._config.lockRotation.value=t,this._component.lockRotation=t}get zoom(){return this._config.zoom.value}set zoom(t){this._config.zoom.value=t,this._component.zoom=t}get frontOffset(){return this._config.frontOffset.value}set frontOffset(t){this._config.frontOffset.value=t,this._component.frontOffset=t}get sizeX(){return this._config.sizeX.value}set sizeX(t){this._config.sizeX.value=t;const{sizeX:e,sizeY:i}=this._config,s=new Ot(e.value,i.value);this._component.resize(s)}get sizeY(){return this._config.sizeY.value}set sizeY(t){this._config.sizeY.value=t;const{sizeX:e,sizeY:i}=this._config,s=new Ot(e.value,i.value);this._component.resize(s)}get backgroundColor(){return this._config.backgroundColor.value}set backgroundColor(t){this._config.backgroundColor.value=t,this._component.backgroundColor=t}}class W4{constructor(t,e){if(P(this,"onDisposed",new nt),P(this,"onAfterUpdate",new nt),P(this,"onBeforeUpdate",new nt),P(this,"onResize",new nt),P(this,"onSetup",new nt),P(this,"frontOffset",0),P(this,"overrideMaterial",new Jg),P(this,"backgroundColor",new Rt(395274)),P(this,"renderer"),P(this,"enabled",!0),P(this,"world"),P(this,"config"),P(this,"isSetup",!1),P(this,"_defaultConfig",{visible:!0,lockRotation:!1,zoom:.05,frontOffset:0,sizeX:320,sizeY:160,backgroundColor:new Rt(395274)}),P(this,"_lockRotation",!0),P(this,"_size",new Ot(320,160)),P(this,"_camera"),P(this,"_plane"),P(this,"_tempVector1",new M),P(this,"_tempVector2",new M),P(this,"_tempTarget",new M),P(this,"down",new M(0,-1,0)),P(this,"updatePlanes",()=>{if(!this.world.renderer)throw new Error("The given world must have a renderer!");const n=[],o=this.world.renderer.three;for(const a of o.clippingPlanes)n.push(a);n.push(this._plane),this.renderer.clippingPlanes=n}),this.world=t,!this.world.renderer)throw new Error("The given world must have a renderer!");this.renderer=new Qa,this.renderer.setSize(this._size.x,this._size.y);const i=1,s=this._size.x/this._size.y;this._camera=new cs(i*s/-2,i*s/2,i/2,i/-2),this.world.renderer.onClippingPlanesUpdated.add(this.updatePlanes),this._camera.position.set(0,200,0),this._camera.zoom=.1,this._camera.rotation.x=-Math.PI/2,this._plane=new Qe(this.down,200),this.updatePlanes(),this.config=new $4(this,e,"MiniMap")}get lockRotation(){return this._lockRotation}set lockRotation(t){this._lockRotation=t,t&&(this._camera.rotation.z=0)}get zoom(){return this._camera.zoom}set zoom(t){this._camera.zoom=t,this._camera.updateProjectionMatrix()}dispose(){this.enabled=!1,this.onBeforeUpdate.reset(),this.onAfterUpdate.reset(),this.onResize.reset(),this.overrideMaterial.dispose(),this.renderer.forceContextLoss(),this.renderer.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}get(){return this._camera}update(){if(!this.enabled)return;this.onBeforeUpdate.trigger();const t=this.world.scene.three,e=this.world.camera;if(!e.hasCameraControls())throw new Error("The given world must use camera controls!");if(!(t instanceof rn))throw new Error("The given world must have a THREE.Scene as a root!");const i=e.controls;if(i.getPosition(this._tempVector1),this._camera.position.x=this._tempVector1.x,this._camera.position.z=this._tempVector1.z,this.frontOffset!==0&&(i.getTarget(this._tempVector2),this._tempVector2.sub(this._tempVector1),this._tempVector2.normalize().multiplyScalar(this.frontOffset),this._camera.position.x+=this._tempVector2.x,this._camera.position.z+=this._tempVector2.z),!this._lockRotation){i.getTarget(this._tempTarget);const n=Math.atan2(this._tempTarget.x-this._tempVector1.x,this._tempTarget.z-this._tempVector1.z);this._camera.rotation.z=n+Math.PI}this._plane.set(this.down,this._tempVector1.y);const s=t.background;t.background=this.backgroundColor,this.renderer.render(t,this._camera),t.background=s,this.onAfterUpdate.trigger()}getSize(){return this._size}resize(t=this._size){this._size.copy(t),this.renderer.setSize(t.x,t.y);const e=t.x/t.y,i=1;this._camera.left=i*e/-2,this._camera.right=i*e/2,this._camera.top=i/2,this._camera.bottom=-i/2,this._camera.updateProjectionMatrix(),this.onResize.trigger(t)}setup(t){const e={...this._defaultConfig,...t};this.config.visible=!0,this.config.lockRotation=e.lockRotation,this.config.zoom=e.zoom,this.config.frontOffset=e.frontOffset,this.config.sizeX=e.sizeX,this.config.sizeY=e.sizeY,this.config.backgroundColor=e.backgroundColor,this.isSetup=!0,this.onSetup.trigger()}}const j4=class cS extends xt{constructor(t){super(t),P(this,"onAfterUpdate",new nt),P(this,"onBeforeUpdate",new nt),P(this,"onDisposed",new nt),P(this,"onSetup",new nt),P(this,"enabled",!0),P(this,"list",new Map),this.components.add(cS.uuid,this)}create(t){if(this.list.has(t.uuid))throw new Error("This world already has a minimap!");const e=new W4(t,this.components);return this.list.set(t.uuid,e),e}delete(t){const e=this.list.get(t);e&&e.dispose(),this.list.delete(t)}dispose(){for(const[t,e]of this.list)e.dispose();this.list.clear(),this.onDisposed.trigger()}update(){for(const[t,e]of this.list)e.update()}};P(j4,"uuid","39ad6aad-84c8-4adf-a1e0-7f25313a9e7f");const lS=class hS extends xt{constructor(t){super(t),P(this,"enabled",!0),t.add(hS.uuid,this)}static distanceFromPointToLine(t,e,i,s=!1){const n=new Vt,o=new M;return n.set(e,i),n.closestPointToPoint(t,s,o),o.distanceTo(t)}getFace(t,e,i){if(!t.geometry.index)throw new Error("Geometry must be indexed!");const s=new Map,n=t.geometry.index.array,{plane:o}=this.getFaceData(e,i,t),a=[];for(let u=0;u<n.length/3;u++){const{plane:d,edges:f}=this.getFaceData(u,i,t);if(d.equals(o)){a.push({index:u,edges:f});for(const{id:p,points:m,distance:g}of f)s.set(p,{points:m,distance:g})}}let c=0;const l=new Map,h=new Map;for(const{index:u,edges:d}of a){const f=new Map;for(const{id:E}of d)if(l.has(E)){const T=l.get(E);f.set(E,T)}const p=d.map(E=>E.id);if(!f.size){const E=c++;for(const{id:T}of d)l.set(T,E);h.set(E,{edges:new Set(p),indices:new Set([u])});continue}let m=null;const g=new Set,I=new Set(p);for(const[E,T]of f){m===null?m=T:T!==m&&g.add(T),l.delete(E);const{edges:A}=h.get(T);A.delete(E),I.delete(E)}if(m===null)throw new Error("Error computing face!");const C=h.get(m),{indices:b}=C;b.add(u);for(const E of I){l.set(E,m);const{edges:T}=C;T.add(E)}for(const E of g){const T=h.get(E),{edges:A,indices:S}=T,_=h.get(m),{edges:w,indices:F}=_;for(const D of A)w.add(D),l.set(D,m);for(const D of S)F.add(D);h.delete(E)}}for(const[u,{indices:d,edges:f}]of h)if(d.has(e)){const p=[];for(const m of f){const g=s.get(m);p.push(g)}return{edges:p,indices:d}}return null}getVerticesAndNormal(t,e,i){if(!t.geometry.index)throw new Error("Geometry must be indexed!");const s=t.geometry.index.array,n=t.geometry.attributes.position.array,o=t.geometry.attributes.normal.array,a=s[e*3]*3,c=s[e*3+1]*3,l=s[e*3+2]*3,h=new M(n[a],n[a+1],n[a+2]),u=new M(n[c],n[c+1],n[c+2]),d=new M(n[l],n[l+1],n[l+2]),f=new M(o[a],o[a+1],o[a+2]),p=new M(o[c],o[c+1],o[c+2]),m=new M(o[l],o[l+1],o[l+2]),g=(f.x+p.x+m.x)/3,I=(f.y+p.y+m.y)/3,C=(f.z+p.z+m.z)/3,b=new M(g,I,C);if(i!==void 0&&t instanceof Pe){const E=new ht;t.getMatrixAt(i,E);const T=new ht;T.extractRotation(E),b.applyMatrix4(T),h.applyMatrix4(E),u.applyMatrix4(E),d.applyMatrix4(E)}return{p1:h,p2:u,p3:d,faceNormal:b}}round(t){t.x=Math.trunc(t.x*1e3)/1e3,t.y=Math.trunc(t.y*1e3)/1e3,t.z=Math.trunc(t.z*1e3)/1e3}getVolumeFromFragments(t){const e=this.components.get(Nt),i=new ht,s=[];for(const o in t){const a=e.list.get(o);if(!a)continue;const c=t[o];let l=0;for(const d of c){const f=a.getInstancesIDs(d);f&&(l+=f.size)}const h=new Pe(a.mesh.geometry,void 0,l);let u=0;for(const d of c){const f=a.getInstancesIDs(d);if(f)for(const p of f)a.mesh.getMatrixAt(p,i),h.setMatrixAt(u++,i)}s.push(h)}const n=this.getVolumeFromMeshes(s);for(const o of s)o.geometry=null,o.material=[],o.dispose();return n}getVolumeFromMeshes(t){let e=0;for(const i of t)e+=this.getVolumeOfMesh(i);return e}getFaceData(t,e,i){const s=this.getVerticesAndNormal(i,t,e),{p1:n,p2:o,p3:a,faceNormal:c}=s;this.round(n),this.round(o),this.round(a),this.round(c);const l=[{id:`${n.x}|${n.y}|${n.z}`,value:n},{id:`${o.x}|${o.y}|${o.z}`,value:o},{id:`${a.x}|${a.y}|${a.z}`,value:a}];l.sort((C,b)=>C.id<b.id?-1:C.id>b.id?1:0);const[{id:h,value:u},{id:d,value:f},{id:p,value:m}]=l,g=[{id:`${h}|${d}`,distance:u.distanceTo(f),points:[u,f]},{id:`${d}|${p}`,distance:f.distanceTo(m),points:[f,m]},{id:`${h}|${p}`,distance:u.distanceTo(m),points:[u,m]}],I=new Qe;return I.setFromNormalAndCoplanarPoint(c,n),I.constant=Math.round(I.constant*10)/10,{plane:I,edges:g}}getVolumeOfMesh(t){let e=0;const i=new M,s=new M,n=new M,{index:o}=t.geometry,a=t.geometry.attributes.position.array;if(!o)return console.warn("Geometry must be indexed to compute its volume!"),0;const c=[];if(t instanceof Pe)for(let h=0;h<t.count;h++){const u=new ht;t.getMatrixAt(h,u),c.push(u)}else c.push(new ht().identity());const{matrixWorld:l}=t;for(let h=0;h<o.array.length-2;h+=3)for(const u of c){const d=u.multiply(l),f=o.array[h]*3,p=o.array[h+1]*3,m=o.array[h+2]*3;i.set(a[f],a[f+1],a[f+2]).applyMatrix4(d),s.set(a[p],a[p+1],a[p+2]).applyMatrix4(d),n.set(a[m],a[m+1],a[m+2]).applyMatrix4(d),e+=this.getSignedVolumeOfTriangle(i,s,n)}return Math.abs(e)}getSignedVolumeOfTriangle(t,e,i){const s=i.x*e.y*t.z,n=e.x*i.y*t.z,o=i.x*t.y*e.z,a=t.x*i.y*e.z,c=e.x*t.y*i.z,l=t.x*e.y*i.z;return 1/6*(-s+n+o-a-c+l)}};P(lS,"uuid","267ca032-672f-4cb0-afa9-d24e904f39d6");let go=lS,yp=class{constructor(t){P(this,"cardinality","required"),P(this,"instructions"),P(this,"evalRequirement",(e,i,s,n)=>{const o={parameter:s,currentValue:e,requiredValue:i.parameter,pass:!1};n&&this.addCheckResult(o,n);let a=!1;if(i.type==="simple"&&(a=e===i.parameter),i.type==="enumeration"&&(a=i.parameter.includes(e)),i.type==="pattern"&&(a=new RegExp(i.parameter).test(String(e))),i.type==="length"){const{min:c,length:l,max:h}=i.parameter;l!==void 0&&(a=String(e).length===l),c!==void 0&&(a=String(e).length>=c),h!==void 0&&(a=String(e).length<=h)}if(i.type==="bounds"&&typeof e=="number"){const{min:c,minInclusive:l,max:h,maxInclusive:u}=i.parameter;let d=!0,f=!0;c!==void 0&&(d=l?e<=c:e<c),h!==void 0&&(f=u?e>=h:e>h),a=d&&f}return this.cardinality==="prohibited"&&(a=!a),this.cardinality==="optional"&&(a=!0),o.pass=a,o.pass}),P(this,"testResult",[]),this.components=t}addCheckResult(t,e){const i=e.findIndex(({parameter:s})=>s===t.parameter);i!==-1?e[i]=t:e.push(t)}saveResult(t,e){const{GlobalId:i}=t;if(!i)return;const{value:s}=i,n={expressID:s,pass:e,checks:[],cardinality:this.cardinality};this.testResult.push(n)}};const On=(r,t)=>{let e="";return t?(t.type==="simple"&&(e=`<ids:simpleValue>${t.parameter}</ids:simpleValue>`),t.type==="enumeration"&&(e=`<xs:restriction base="xs:string">
    ${t.parameter.map(i=>`<xs:enumeration value="${i}" />`).join(`\r
`)}
    </xs:restriction>`),t.type==="pattern"&&(e=`<xs:restriction base="xs:string">
      <xs:pattern value="${t.parameter}" />
    </xs:restriction>`),`<ids:${r[0].toLowerCase()+r.slice(1)}>
    ${e}
  </ids:${r[0].toLowerCase()+r.slice(1)}>`):e};class X4 extends yp{constructor(t,e){super(t),P(this,"facetType","Attribute"),P(this,"name"),P(this,"value"),this.name=e}serialize(t){const e=On("Name",this.name),i=On("Value",this.value);let s="";return t==="requirement"&&(s+=`cardinality="${this.cardinality}"`,s+=this.instructions?`instructions="${this.instructions}"`:""),`<ids:attribute ${s}>
  ${e}
  ${i}
</ids:attribute>`}async getEntities(){return[]}async test(t){var e;this.testResult=[];for(const s in t){const n=Number(s),o=t[n],a=[],c={guid:(e=o.GlobalId)==null?void 0:e.value,expressID:n,pass:!1,checks:a,cardinality:this.cardinality};this.testResult.push(c);const l=Object.keys(o).filter(u=>{const d=this.evalRequirement(u,this.name,"Name"),f=o[u];return d&&f===null?this.cardinality==="optional"||this.cardinality==="prohibited":d&&f?.type===3&&f.value===2||d&&Array.isArray(f)&&f.length===0||d&&f?.type===1&&f.value.trim()===""?!1:d}),h=l.length>0;if(a.push({parameter:"Name",currentValue:h?l[0]:null,requiredValue:this.name.parameter,pass:this.cardinality==="prohibited"?!h:h}),this.value)if(l[0]){const u=o[l[0]];u?.type===5?a.push({parameter:"Value",currentValue:null,requiredValue:this.value.parameter,pass:this.cardinality==="prohibited"}):this.evalRequirement(u?u.value:null,this.value,"Value",a)}else a.push({parameter:"Value",currentValue:null,requiredValue:this.value.parameter,pass:this.cardinality==="prohibited"});c.pass=a.every(({pass:u})=>u)}const i=[...this.testResult];return this.testResult=[],i}}class Z4 extends yp{constructor(t,e){super(t),P(this,"facetType","Classification"),P(this,"system"),P(this,"value"),P(this,"uri"),this.system=e}serialize(t){const e=On("System",this.system),i=On("Value",this.value);let s="";return t==="requirement"&&(s+=`cardinality="${this.cardinality}"`,s+=this.uri?`uri=${this.uri}`:"",s+=this.instructions?`instructions="${this.instructions}"`:""),`<ids:classification ${s}>
  ${e}
  ${i}
</ids:classification>`}async getEntities(t,e={}){var i;const s=[],n=await t.getAllPropertiesOfType(Me),o=await t.getAllPropertiesOfType(Vi),a={...n,...o},c=[];for(const h in a){const u=Number(h),d=await t.getProperties(u);if(!d)continue;const f=(i=d.ReferencedSource)==null?void 0:i.value;if(!f)continue;const p=await t.getProperties(f);!p||!this.evalSystem(p)||!this.evalValue(d)||!this.evalURI(d)||c.push(u)}const l=this.components.get(_i);for(const h of c){const u=l.getEntitiesWithRelation(t,"HasAssociations",h);for(const d of u){if(d in e)continue;const f=await t.getProperties(d);f&&(e[d]=f,s.push(d))}}return s}async test(t,e){var i;this.testResult=[];for(const n in t){const o=Number(n),a=t[o],c=[],l={guid:(i=a.GlobalId)==null?void 0:i.value,expressID:o,pass:!1,checks:c,cardinality:this.cardinality};this.testResult.push(l);let h=!0;const u=await this.getSystems(e,o),d=u.map(f=>this.getSystemName(f)).filter(f=>f);for(const f of u){if(!this.evalSystem(f,c))continue;if(h=!1,!(this.value&&this.system))break;if(f.type!==Me)continue;const p=!this.value||this.evalValue(f,c),m=!this.uri||this.evalURI(f,c);if(p&&m)break}h&&this.addCheckResult({parameter:"System",currentValue:d,requiredValue:this.system,pass:this.cardinality==="optional"},c),l.pass=c.every(({pass:f})=>f)}const s=[...this.testResult];return this.testResult=[],s}async processReferencedSource(t,e){var i;const s=(i=e.ReferencedSource)==null?void 0:i.value;if(!s)return null;const n=await t.getProperties(s);return n?(n.type===Me&&(n.ReferencedSource=await this.processReferencedSource(t,n)),n):null}async getSystems(t,e){var i;const s=[],n=this.components.get(_i),o=n.getEntityRelations(t,e,"HasAssociations");if(o)for(const u of o){const d=await t.getProperties(u);d&&(d.type===Vi&&s.push(d),d.type===Me&&(d.ReferencedSource=await this.processReferencedSource(t,d),d.ReferencedSource&&s.push(d)))}const a=s.map(u=>{var d,f,p;return u.type===Vi?(d=u.Name)==null?void 0:d.value:u.type===Me?(p=(f=u.ReferencedSource)==null?void 0:f.Name)==null?void 0:p.value:null}).filter(u=>u),c=n.getEntityRelations(t,e,"IsTypedBy");if(!(c&&c[0]))return s;const l=c[0],h=n.getEntityRelations(t,l,"HasAssociations");if(h)for(const u of h){const d=await t.getProperties(u);if(d){if(d.type===Vi){if(a.includes((i=d.Name)==null?void 0:i.value))continue;s.push(d)}d.type===Me&&(d.ReferencedSource=await this.processReferencedSource(t,d),d.ReferencedSource&&s.push(d))}}return s}getSystemName(t){var e,i,s,n;if(t.type===Vi)return(e=t.Name)==null?void 0:e.value;if(t.type===Me){if(((i=t.ReferencedSource)==null?void 0:i.type)===Me)return this.getSystemName(t.ReferencedSource);if(((s=t.ReferencedSource)==null?void 0:s.type)===Vi)return(n=t.ReferencedSource.Name)==null?void 0:n.value}return null}getAllReferenceIdentifications(t){if(t.type!==Me)return null;const e=[];if(t.Identification&&e.push(t.Identification.value),t.ReferencedSource){const i=this.getAllReferenceIdentifications(t.ReferencedSource);i&&e.push(...i)}return e}evalSystem(t,e){const i=this.getSystemName(t);return this.evalRequirement(i,this.system,"System",e)}evalValue(t,e){if(!this.value)return!0;const i=this.getAllReferenceIdentifications(t);if(!i)return!1;const s=i.find(n=>this.value?this.evalRequirement(n,this.value,"Value"):!1);return e&&this.addCheckResult({parameter:"Value",currentValue:s??null,requiredValue:this.value,pass:!!s},e),!!s}evalURI(t,e){var i;return this.uri?this.evalRequirement((i=t.Location)==null?void 0:i.value,{type:"simple",parameter:this.uri},"URI",e):!0}}class q4 extends yp{constructor(t,e){super(t),P(this,"facetType","Entity"),P(this,"name"),P(this,"predefinedType"),this.name=e}serialize(t){const e=On("Name",this.name),i=On("Name",this.predefinedType);let s="";return t==="requirement"&&(s+=`cardinality="${this.cardinality}"`,s+=this.instructions?`instructions="${this.instructions}"`:""),`<ids:entity ${s}>
  ${e}
  ${i}
</ids:entity>`}async getEntities(t,e={}){const i=Object.entries(_f),s=[];for(const[a]of i)await this.evalName({type:a})&&s.push(Number(a));let n={};for(const a of s){const c=await t.getAllPropertiesOfType(a);c&&(n={...n,...c})}if(!this.predefinedType){for(const a in n)a in e||(e[a]=n[a]);return Object.keys(n).map(Number)}const o=[];for(const a in n){const c=Number(a);if(c in e)continue;const l=n[c];await this.evalPredefinedType(t,l)&&(e[c]=l,o.push(c))}return o}async test(t,e){var i;this.testResult=[];for(const s in t){const n=Number(s),o=t[n],a=[],c={guid:(i=o.GlobalId)==null?void 0:i.value,expressID:n,pass:!1,checks:a,cardinality:this.cardinality};this.testResult.push(c),await this.evalName(o,a),await this.evalPredefinedType(e,o,a),c.pass=a.every(({pass:l})=>l)}return this.testResult}async evalName(t,e){const i=_f[t.type];return this.evalRequirement(i,this.name,"Name",e)}async evalPredefinedType(t,e,i){var s,n,o,a;if(!this.predefinedType)return null;const c=this.components.get(_i),l=typeof this.predefinedType.parameter=="string"&&this.predefinedType.parameter==="USERDEFINED";let h=(s=e.PredefinedType)==null?void 0:s.value;if(h==="USERDEFINED"&&!l){const u=Object.keys(e).find(d=>/^((?!Predefined).)*Type$/.test(d));h=u?(n=e[u])==null?void 0:n.value:"USERDEFINED"}if(!h){const u=c.getEntityRelations(t,e.expressID,"IsTypedBy");if(u&&u[0]){const d=await t.getProperties(u[0]);if(d&&(h=(o=d.PredefinedType)==null?void 0:o.value,h==="USERDEFINED"&&!l)){const f=Object.keys(d).find(p=>/^((?!Predefined).)*Type$/.test(p));h=f?(a=d[f])==null?void 0:a.value:"USERDEFINED"}}}return this.evalRequirement(h,this.predefinedType,"PredefinedType",i)}}class Q4 extends yp{constructor(t,e,i){super(t),P(this,"facetType","Property"),P(this,"propertySet"),P(this,"baseName"),P(this,"value"),P(this,"dataType"),P(this,"uri"),P(this,"_unsupportedTypes",[Hy,$y]),this.propertySet=e,this.baseName=i}serialize(t){const e=On("PropertySet",this.propertySet),i=On("BaseName",this.baseName),s=On("Value",this.value),n=this.dataType?`dataType=${this.dataType}`:"";let o="";return t==="requirement"&&(o+=`cardinality="${this.cardinality}"`,o+=this.uri?`uri=${this.uri}`:"",o+=this.instructions?`instructions="${this.instructions}"`:""),`<ids:property ${n} ${o}>
  ${e}
  ${i}
  ${s}
</ids:property>`}async getEntities(t,e={}){var i,s;let n={};const o=await t.getAllPropertiesOfType(pi);n={...n,...o};const a=await t.getAllPropertiesOfType(Ks);if(n={...n,...a},Object.keys(n).length===0)return[];const c=[];for(const h in n){const u=Number(h),d=await t.getProperties(u);if(!d||((i=d.Name)==null?void 0:i.value)!==this.propertySet.parameter)continue;let f;if(d.type===pi&&(f="HasProperties"),d.type===Ks&&(f="Quantities"),!!f)for(const p of d[f]){const m=await t.getProperties(p.value);if(!(!m||((s=m.Name)==null?void 0:s.value)!==this.baseName.parameter)){if(this.value){const g=Object.keys(m).find(I=>I.endsWith("Value"));if(!g||m[g].value!==this.value.parameter)continue}c.push(u)}}}const l=this.components.get(_i);for(const h of c){const u=l.getEntitiesWithRelation(t,"IsDefinedBy",h);for(const d of u){if(d in e)continue;const f=await t.getProperties(d);f&&(e[d]=f)}}return[]}async test(t,e){var i;this.testResult=[];for(const n in t){const o=Number(n),a=t[o],c=[],l={guid:(i=a.GlobalId)==null?void 0:i.value,expressID:o,pass:!1,checks:c,cardinality:this.cardinality};this.testResult.push(l);const h=(await this.getPsets(e,o)).filter(u=>{var d;return this.evalRequirement(((d=u.Name)==null?void 0:d.value)??null,this.propertySet,"PropertySet")?(c.push({currentValue:u.Name.value,parameter:"PropertySet",pass:!0,requiredValue:this.propertySet.parameter}),!0):!1});if(h.length===0){c.push({currentValue:null,parameter:"PropertySet",pass:!1,requiredValue:this.propertySet.parameter});continue}for(const u of h){const d=this.getItemsAttrName(u.type);if(!d){c.push({currentValue:null,parameter:"BaseName",pass:!1,requiredValue:this.baseName.parameter});continue}const f=u[d].filter(p=>{var m;return this._unsupportedTypes.includes(p.type)||!this.evalRequirement(((m=p.Name)==null?void 0:m.value)??null,this.baseName,"BaseName")?!1:(c.push({currentValue:p.Name.value,parameter:"BaseName",pass:!0,requiredValue:this.baseName.parameter}),!0)});if(f.length===0){c.push({currentValue:null,parameter:"BaseName",pass:!1,requiredValue:this.baseName.parameter});continue}for(const p of f)this.evalValue(p,c),this.evalDataType(p,c),this.evalURI()}l.pass=c.every(({pass:u})=>u)}const s=[...this.testResult];return this.testResult=[],s}getItemsAttrName(t){let e;return t===pi&&(e="HasProperties"),t===Ks&&(e="Quantities"),e}getValueKey(t){return Object.keys(t).find(e=>e.endsWith("Value")||e.endsWith("Values"))}async getPsetProps(t,e,i){const s=structuredClone(e),n=[],o=s[i];if(!o)return n;for(const{value:a}of o){const c=await t.getProperties(a);c&&n.push(c)}return s[i]=n,s}async getTypePsets(t,e){const i=[],s=this.components.get(_i).getEntityRelations(t,e,"IsTypedBy");if(!(s&&s[0]))return i;const n=await t.getProperties(s[0]);if(!(n&&"HasPropertySets"in n&&Array.isArray(n.HasPropertySets)))return i;for(const{value:o}of n.HasPropertySets){const a=await t.getProperties(o);if(!(a&&"HasProperties"in a&&Array.isArray(a.HasProperties)))continue;const c=await this.getPsetProps(t,a,"HasProperties");i.push(c)}return i}async getPsets(t,e){const i=await this.getTypePsets(t,e),s=this.components.get(_i).getEntityRelations(t,e,"IsDefinedBy");if(!s)return i;for(const n of s){const o=await t.getProperties(n);if(!o)continue;const a=this.getItemsAttrName(o.type);if(!a)continue;const c=await this.getPsetProps(t,o,a);i.push(c)}return i}evalValue(t,e){const i=this.getValueKey(t),s=t[i];if(this.value){if(!s)return e?.push({parameter:"Value",currentValue:null,pass:!1,requiredValue:this.value.parameter}),!1;const n=structuredClone(this.value);if(s.name==="IFCLABEL"&&n.type==="simple"&&(n.parameter=String(n.parameter)),(t.type===ff||t.type===pf)&&Array.isArray(s)){const o=s.map(c=>c.value),a=s.find(c=>n?this.evalRequirement(c.value,n,"Value"):!1);return e?.push({currentValue:o,pass:!!a,parameter:"Value",requiredValue:n.parameter}),!!a}return this.evalRequirement(s.value,n,"Value",e)}return i?s.type===3&&s.value===2?(e?.push({parameter:"Value",currentValue:null,pass:!1,requiredValue:null}),!1):s.type===1&&s.value.trim()===""?(e?.push({parameter:"Value",currentValue:"",pass:!1,requiredValue:null}),!1):!0:!0}evalDataType(t,e){if(!this.dataType)return!0;const i=this.getValueKey(t),s=t[i];if(!s)return e?.push({parameter:"DataType",currentValue:null,pass:!1,requiredValue:this.dataType}),!1;if((t.type===ff||t.type===pf)&&Array.isArray(s)&&s[0]){const n=s[0].name;return this.evalRequirement(n,{type:"simple",parameter:this.dataType},"DataType",e)}return this.evalRequirement(s.name,{type:"simple",parameter:this.dataType},"DataType",e)}evalURI(){return!0}}class K4{constructor(t,e,i){P(this,"name"),P(this,"ifcVersion",new Set),P(this,"identifier",kn.create()),P(this,"description"),P(this,"instructions"),P(this,"requirementsDescription"),P(this,"applicability",new gr),P(this,"requirements",new gr),P(this,"components"),this.components=t,this.name=e;for(const s of i)this.ifcVersion.add(s)}set(t){const e=t,i=this;for(const s in t){if(s==="identifier")continue;const n=e[s];s in this&&(i[s]=n)}return this.components.get(i5).list.set(this.identifier,this),this}async test(t){let e=[];if(this.requirements.size===0)return e;const i={};for(const s of this.applicability)await s.getEntities(t,i);return e=await[...this.requirements][0].test(i,t),e}serialize(){const t=`name="${this.name}"`,e=this.identifier?`identifier="${this.identifier}"`:"",i=this.description?`description="${this.description}"`:"",s=this.instructions?`instructions="${this.instructions}"`:"";return`<ids:specification ifcVersion="${[...this.ifcVersion].join(" ")}" ${t} ${e} ${i} ${s}>
      <ids:applicability minOccurs="1" maxOccurs="unbounded">
        ${[...this.applicability].map(n=>n.serialize("applicability"))}
      </ids:applicability>
      <ids:requirements>
        ${[...this.requirements].map(n=>n.serialize("requirement"))}
      </ids:requirements>
    </ids:specification>`}}const xn=r=>{if(!r)return;const t={};if("simpleValue"in r&&(t.type="simple",t.parameter=r.simpleValue),"restriction"in r){const e=r.restriction;if("pattern"in e&&(t.type="pattern",t.parameter=e.pattern.value),"enumeration"in e){t.type="enumeration";const i=e.enumeration.map(({value:s})=>s);t.parameter=i}}if(t.parameter!==void 0)return t},CT=(r,t)=>{const e=[];for(const i of t){const s=i.name,n=xn(s);if(!n)continue;const o=new q4(r,n);i.cardinality&&(o.cardinality=i.cardinality),o.predefinedType=xn(i.predefinedType),o.instructions=i.instructions,e.push(o)}return e},J4=(r,t)=>{const e=[];for(const i of t){const s=i.name,n=xn(s);if(!n)continue;const o=new X4(r,n);i.cardinality&&(o.cardinality=i.cardinality),o.value=xn(i.value),o.instructions=i.instructions,e.push(o)}return e},t5=(r,t)=>{const e=[];for(const i of t){const s=i.system,n=xn(s);if(!n)continue;const o=new Z4(r,n);i.cardinality&&(o.cardinality=i.cardinality);const a=xn(i.value);a?.type==="simple"&&(a.parameter=String(a.parameter)),a?.type==="enumeration"&&Array.isArray(a.parameter)&&(a.parameter=a.parameter.map(String)),o.value=a,o.uri=i.uri,o.instructions=i.instructions,e.push(o)}return e},e5=(r,t)=>{const e=[];for(const i of t){const s=i.propertySet,n=i.baseName,o=xn(s),a=xn(n);if(!(a&&o))continue;const c=new Q4(r,o,a);i.cardinality&&(c.cardinality=i.cardinality);const l=xn(i.value);l?.type==="enumeration"&&Array.isArray(l.parameter)&&(l.parameter=l.parameter.map(String)),c.value=l,c.dataType=i.dataType,c.uri=i.uri,c.instructions=i.instructions,e.push(c)}return e},qE=class Rg extends xt{constructor(t){super(t),P(this,"enabled",!0),P(this,"list",new Ns),t.add(Rg.uuid,this)}getFragmentIdMap(t,e){const i=e.filter(a=>a.pass).map(a=>a.expressID),s=t.getFragmentMap(i),n=e.filter(a=>!a.pass).map(a=>a.expressID),o=t.getFragmentMap(n);return{pass:s,fail:o}}create(t,e,i){const s=new K4(this.components,t,e);return i&&(s.identifier=i),this.list.set(s.identifier,s),s}load(t){const e=[],i=Rg.xmlParser.parse(t).ids,{specifications:s}=i;if(s&&s.specification){const n=Array.isArray(s.specification)?s.specification:[s.specification];for(const o of n){const{name:a,ifcVersion:c,description:l,instructions:h,identifier:u}=o;if(!(a&&c))continue;const d=[],f=[],{applicability:p,requirements:m}=o;if(p){const{maxOccurs:I,...C}=p,b=Array.isArray(C)?C:[C];for(const E of b)for(const T in E){const A=Array.isArray(E[T])?E[T]:[E[T]];if(T==="entity"){const S=CT(this.components,A);d.push(...S)}}}let g;if(m){const{maxOccurs:I,...C}=m;g=m.description;const b=Array.isArray(C)?C:[C];for(const E of b)for(const T in E){const A=Array.isArray(E[T])?E[T]:[E[T]];if(T==="entity"){const S=CT(this.components,A);f.push(...S)}if(T==="attribute"){const S=J4(this.components,A);f.push(...S)}if(T==="classification"){const S=t5(this.components,A);f.push(...S)}if(T==="property"){const S=e5(this.components,A);f.push(...S)}}}if(d.length>0&&f.length>0){const I=this.create(a,c.split(/\s+/),u);I.description=l,I.instructions=h,I.requirementsDescription=g,I.applicability.add(...d),I.requirements.add(...f),e.push(I)}}}return e}export(t,e=this.list.values()){const i=e??this.list;return`<ids:ids xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://standards.buildingsmart.org/IDS http://standards.buildingsmart.org/IDS/1.0/ids.xsd" xmlns:ids="http://standards.buildingsmart.org/IDS">
  <!-- Made with That Open Engine ${aA.release} (https://github.com/thatopen/engine_components) -->
  <ids:info>
    <ids:title>${t.title}</ids:title>
    ${t.copyright?`<ids:copyright>${t.copyright}</ids:copyright>`:""}
    ${t.version?`<ids:version>${t.version}</ids:version>`:""}
    ${t.description?`<ids:description>${t.description}</ids:description>`:""}
    ${t.author?`<ids:author>${t.author}</ids:author>`:""}
    ${t.date?`<ids:date>${t.date.toISOString().split("T")[0]}</ids:date>`:""}
    ${t.purpose?`<ids:purpose>${t.purpose}</ids:purpose>`:""}
    ${t.milestone?`<ids:milestone>${t.milestone}</ids:milestone>`:""}
  </ids:info>
  <ids:specifications>
    ${[...i].map(s=>s.serialize()).join(`
`)}
  </ids:specifications>
</ids:ids>`}};P(qE,"uuid","9f0b9f78-9b2e-481a-b766-2fbfd01f342c");P(qE,"xmlParser",new GA.XMLParser({allowBooleanAttributes:!0,attributeNamePrefix:"",ignoreAttributes:!1,ignoreDeclaration:!0,ignorePiTags:!0,numberParseOptions:{leadingZeros:!0,hex:!0},parseAttributeValue:!0,preserveOrder:!1,processEntities:!1,removeNSPrefix:!0,trimValues:!0}));let i5=qE;const bT=new vt,Ld=new M;let uS=class extends Q_{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const t=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],e=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],i=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(i),this.setAttribute("position",new Cr(t,3)),this.setAttribute("uv",new Cr(e,2))}applyMatrix4(t){const e=this.attributes.instanceStart,i=this.attributes.instanceEnd;return e!==void 0&&(e.applyMatrix4(t),i.applyMatrix4(t),e.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(t){let e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));const i=new cI(e,6,1);return this.setAttribute("instanceStart",new ka(i,3,0)),this.setAttribute("instanceEnd",new ka(i,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(t){let e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));const i=new cI(e,6,1);return this.setAttribute("instanceColorStart",new ka(i,3,0)),this.setAttribute("instanceColorEnd",new ka(i,3,3)),this}fromWireframeGeometry(t){return this.setPositions(t.attributes.position.array),this}fromEdgesGeometry(t){return this.setPositions(t.attributes.position.array),this}fromMesh(t){return this.fromWireframeGeometry(new K_(t.geometry)),this}fromLineSegments(t){const e=t.geometry;return this.setPositions(e.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new vt);const t=this.attributes.instanceStart,e=this.attributes.instanceEnd;t!==void 0&&e!==void 0&&(this.boundingBox.setFromBufferAttribute(t),bT.setFromBufferAttribute(e),this.boundingBox.union(bT))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new as),this.boundingBox===null&&this.computeBoundingBox();const t=this.attributes.instanceStart,e=this.attributes.instanceEnd;if(t!==void 0&&e!==void 0){const i=this.boundingSphere.center;this.boundingBox.getCenter(i);let s=0;for(let n=0,o=t.count;n<o;n++)Ld.fromBufferAttribute(t,n),s=Math.max(s,i.distanceToSquared(Ld)),Ld.fromBufferAttribute(e,n),s=Math.max(s,i.distanceToSquared(Ld));this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(t){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(t)}};$d.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Ot(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Wd.line={uniforms:eE.merge([$d.common,$d.fog,$d.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};let iu=class extends qe{constructor(t){super({type:"LineMaterial",uniforms:eE.clone(Wd.line.uniforms),vertexShader:Wd.line.vertexShader,fragmentShader:Wd.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(t)}get color(){return this.uniforms.diffuse.value}set color(t){this.uniforms.diffuse.value=t}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(t){t===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(t){this.uniforms.linewidth&&(this.uniforms.linewidth.value=t)}get dashed(){return"USE_DASH"in this.defines}set dashed(t){t===!0!==this.dashed&&(this.needsUpdate=!0),t===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(t){this.uniforms.dashScale.value=t}get dashSize(){return this.uniforms.dashSize.value}set dashSize(t){this.uniforms.dashSize.value=t}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(t){this.uniforms.dashOffset.value=t}get gapSize(){return this.uniforms.gapSize.value}set gapSize(t){this.uniforms.gapSize.value=t}get opacity(){return this.uniforms.opacity.value}set opacity(t){this.uniforms&&(this.uniforms.opacity.value=t)}get resolution(){return this.uniforms.resolution.value}set resolution(t){this.uniforms.resolution.value.copy(t)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(t){this.defines&&(t===!0!==this.alphaToCoverage&&(this.needsUpdate=!0),t===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1))}};const TT=new M,yT=new M,We=new Do,je=new Do,Hs=new Do,Km=new M,Jm=new ht,Ze=new Vt,vT=new M,Md=new vt,Dd=new as,$s=new Do;let Qs,Eo;function RT(r,t,e){return $s.set(0,0,-t,1).applyMatrix4(r.projectionMatrix),$s.multiplyScalar(1/$s.w),$s.x=Eo/e.width,$s.y=Eo/e.height,$s.applyMatrix4(r.projectionMatrixInverse),$s.multiplyScalar(1/$s.w),Math.abs(Math.max($s.x,$s.y))}function s5(r,t){const e=r.matrixWorld,i=r.geometry,s=i.attributes.instanceStart,n=i.attributes.instanceEnd,o=Math.min(i.instanceCount,s.count);for(let a=0,c=o;a<c;a++){Ze.start.fromBufferAttribute(s,a),Ze.end.fromBufferAttribute(n,a),Ze.applyMatrix4(e);const l=new M,h=new M;Qs.distanceSqToSegment(Ze.start,Ze.end,h,l),h.distanceTo(l)<Eo*.5&&t.push({point:h,pointOnLine:l,distance:Qs.origin.distanceTo(h),object:r,face:null,faceIndex:a,uv:null,uv1:null})}}function n5(r,t,e){const i=t.projectionMatrix,s=r.material.resolution,n=r.matrixWorld,o=r.geometry,a=o.attributes.instanceStart,c=o.attributes.instanceEnd,l=Math.min(o.instanceCount,a.count),h=-t.near;Qs.at(1,Hs),Hs.w=1,Hs.applyMatrix4(t.matrixWorldInverse),Hs.applyMatrix4(i),Hs.multiplyScalar(1/Hs.w),Hs.x*=s.x/2,Hs.y*=s.y/2,Hs.z=0,Km.copy(Hs),Jm.multiplyMatrices(t.matrixWorldInverse,n);for(let u=0,d=l;u<d;u++){if(We.fromBufferAttribute(a,u),je.fromBufferAttribute(c,u),We.w=1,je.w=1,We.applyMatrix4(Jm),je.applyMatrix4(Jm),We.z>h&&je.z>h)continue;if(We.z>h){const I=We.z-je.z,C=(We.z-h)/I;We.lerp(je,C)}else if(je.z>h){const I=je.z-We.z,C=(je.z-h)/I;je.lerp(We,C)}We.applyMatrix4(i),je.applyMatrix4(i),We.multiplyScalar(1/We.w),je.multiplyScalar(1/je.w),We.x*=s.x/2,We.y*=s.y/2,je.x*=s.x/2,je.y*=s.y/2,Ze.start.copy(We),Ze.start.z=0,Ze.end.copy(je),Ze.end.z=0;const f=Ze.closestPointToPointParameter(Km,!0);Ze.at(f,vT);const p=Ss.lerp(We.z,je.z,f),m=p>=-1&&p<=1,g=Km.distanceTo(vT)<Eo*.5;if(m&&g){Ze.start.fromBufferAttribute(a,u),Ze.end.fromBufferAttribute(c,u),Ze.start.applyMatrix4(n),Ze.end.applyMatrix4(n);const I=new M,C=new M;Qs.distanceSqToSegment(Ze.start,Ze.end,C,I),e.push({point:C,pointOnLine:I,distance:Qs.origin.distanceTo(C),object:r,face:null,faceIndex:u,uv:null,uv1:null})}}}class r5 extends it{constructor(t=new uS,e=new iu({color:Math.random()*16777215})){super(t,e),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const t=this.geometry,e=t.attributes.instanceStart,i=t.attributes.instanceEnd,s=new Float32Array(2*e.count);for(let o=0,a=0,c=e.count;o<c;o++,a+=2)TT.fromBufferAttribute(e,o),yT.fromBufferAttribute(i,o),s[a]=a===0?0:s[a-1],s[a+1]=s[a]+TT.distanceTo(yT);const n=new cI(s,2,1);return t.setAttribute("instanceDistanceStart",new ka(n,1,0)),t.setAttribute("instanceDistanceEnd",new ka(n,1,1)),this}raycast(t,e){const i=this.material.worldUnits,s=t.camera;s===null&&!i&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const n=t.params.Line2!==void 0&&t.params.Line2.threshold||0;Qs=t.ray;const o=this.matrixWorld,a=this.geometry,c=this.material;Eo=c.linewidth+n,a.boundingSphere===null&&a.computeBoundingSphere(),Dd.copy(a.boundingSphere).applyMatrix4(o);let l;if(i)l=Eo*.5;else{const u=Math.max(s.near,Dd.distanceToPoint(Qs.origin));l=RT(s,u,c.resolution)}if(Dd.radius+=l,Qs.intersectsSphere(Dd)===!1)return;a.boundingBox===null&&a.computeBoundingBox(),Md.copy(a.boundingBox).applyMatrix4(o);let h;if(i)h=Eo*.5;else{const u=Math.max(s.near,Md.distanceToPoint(Qs.origin));h=RT(s,u,c.resolution)}Md.expandByScalar(h),Qs.intersectsBox(Md)!==!1&&(i?s5(this,e):n5(this,s,e))}}let Of=class extends uS{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(t){const e=t.length-3,i=new Float32Array(2*e);for(let s=0;s<e;s+=3)i[2*s]=t[s],i[2*s+1]=t[s+1],i[2*s+2]=t[s+2],i[2*s+3]=t[s+3],i[2*s+4]=t[s+4],i[2*s+5]=t[s+5];return super.setPositions(i),this}setColors(t){const e=t.length-3,i=new Float32Array(2*e);for(let s=0;s<e;s+=3)i[2*s]=t[s],i[2*s+1]=t[s+1],i[2*s+2]=t[s+2],i[2*s+3]=t[s+3],i[2*s+4]=t[s+4],i[2*s+5]=t[s+5];return super.setColors(i),this}fromLine(t){const e=t.geometry;return this.setPositions(e.attributes.position.array),this}},dS=class extends r5{constructor(t=new Of,e=new iu({color:Math.random()*16777215})){super(t,e),this.isLine2=!0,this.type="Line2"}};const fS=class pS{constructor(t,e){B(this,"scene"),B(this,"onSelect",new nt),B(this,"type"),B(this,"selectCurve"),B(this,"selectPoints"),B(this,"hoverCurve"),B(this,"hoverPoints"),B(this,"caster",new Mo),this.scene=t,this.type=e,this.hoverCurve=this.newCurve(.003,4473924,!1),this.hoverPoints=this.newPoints(5,4473924),this.selectCurve=this.newCurve(.005,16777215,!0),this.selectPoints=this.newPoints(7,16777215)}dispose(){this.selectCurve&&this.scene.remove(this.selectCurve),this.selectCurve.material.dispose(),this.selectCurve.geometry.dispose(),this.selectCurve=null,this.hoverCurve.material.dispose(),this.hoverCurve.geometry.dispose(),this.hoverCurve=null,this.hoverPoints.material.dispose(),this.hoverPoints.geometry.dispose(),this.selectPoints.material.dispose(),this.selectPoints.geometry.dispose(),this.scene=null}castRay(t,e,i,s){const n=new Ot,o=i.getBoundingClientRect();n.x=(t.clientX-o.left)/o.width*2-1,n.y=-((t.clientY-o.top)/o.height)*2+1,this.caster.setFromCamera(n,e);const a=this.caster.intersectObjects(s);return a.length?a[0]:null}select(t){this.highlight(t,this.selectCurve,this.selectPoints,!0),this.onSelect.trigger(t)}unSelect(){this.selectCurve.removeFromParent(),this.selectPoints.removeFromParent()}hover(t){this.highlight(t,this.hoverCurve,this.hoverPoints,!1)}unHover(){this.hoverCurve.removeFromParent(),this.hoverPoints.removeFromParent()}setResolution({x:t,y:e}){this.selectCurve.material.resolution.set(t/e,1),this.hoverCurve.material.resolution.set(t/e,1)}highlight(t,e,i,s){const{alignment:n}=t.curve;this.scene.add(e),this.scene.add(i);const o=[],a=[],c=[];for(const d of n[this.type]){const f=d.mesh.geometry.attributes.position;for(const I of f.array)o.push(I);if(s){let I;if(this.type==="absolute"){const{horizontal:b}=d.alignment;I=b[d.index].data.TYPE}else I=d.data.TYPE;const C=pS.settings.colors[I]||[1,1,1];for(let b=0;b<f.count;b++)a.push(...C)}const[p,m,g]=f.array;c.push(new M(p,m,g))}const l=o[o.length-3],h=o[o.length-2],u=o[o.length-1];c.push(new M(l,h,u)),o.length/3>e.geometry.attributes.position.count&&(e.geometry.dispose(),e.geometry=new Of),e.geometry.setPositions(o),s&&e.geometry.setColors(a),i.geometry.setFromPoints(c)}newCurve(t,e,i){const s=new Of,n=new iu({color:e,linewidth:t,vertexColors:i,worldUnits:!1,depthTest:!1}),o=new dS(s,n);return this.scene.add(o),o}newPoints(t,e){const i=new Ut,s=new Kt(new Float32Array,3);i.setAttribute("position",s);const n=new U_({size:t,color:e,sizeAttenuation:!1,depthTest:!1}),o=new B_(i,n);return o.frustumCulled=!1,this.scene.add(o),o}};B(fS,"settings",{colors:{LINE:[213/255,0/255,255/255],CIRCULARARC:[0/255,46,255/255],CLOTHOID:[0/255,255/255,0/255],PARABOLICARC:[0/255,255/255,72/255],CONSTANTGRADIENT:[213/255,0/255,255/255]}});let mS=fS;class o5 extends ws{constructor(t=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Ot(.5,.5),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof Element&&e.element.parentNode!==null&&e.element.parentNode.removeChild(e.element)})})}copy(t,e){return super.copy(t,e),this.element=t.element.cloneNode(!0),this.center=t.center,this}}const La=new M,AT=new ht,ST=new ht,wT=new M,_T=new M;class a5{constructor(t={}){const e=this;let i,s,n,o;const a={objects:new WeakMap},c=t.element!==void 0?t.element:document.createElement("div");c.style.overflow="hidden",this.domElement=c,this.getSize=function(){return{width:i,height:s}},this.render=function(f,p){f.matrixWorldAutoUpdate===!0&&f.updateMatrixWorld(),p.parent===null&&p.matrixWorldAutoUpdate===!0&&p.updateMatrixWorld(),AT.copy(p.matrixWorldInverse),ST.multiplyMatrices(p.projectionMatrix,AT),l(f,f,p),d(f)},this.setSize=function(f,p){i=f,s=p,n=i/2,o=s/2,c.style.width=f+"px",c.style.height=p+"px"};function l(f,p,m){if(f.isCSS2DObject){La.setFromMatrixPosition(f.matrixWorld),La.applyMatrix4(ST);const g=f.visible===!0&&La.z>=-1&&La.z<=1&&f.layers.test(m.layers)===!0;if(f.element.style.display=g===!0?"":"none",g===!0){f.onBeforeRender(e,p,m);const C=f.element;C.style.transform="translate("+-100*f.center.x+"%,"+-100*f.center.y+"%)translate("+(La.x*n+n)+"px,"+(-La.y*o+o)+"px)",C.parentNode!==c&&c.appendChild(C),f.onAfterRender(e,p,m)}const I={distanceToCameraSquared:h(m,f)};a.objects.set(f,I)}for(let g=0,I=f.children.length;g<I;g++)l(f.children[g],p,m)}function h(f,p){return wT.setFromMatrixPosition(f.matrixWorld),_T.setFromMatrixPosition(p.matrixWorld),wT.distanceToSquared(_T)}function u(f){const p=[];return f.traverse(function(m){m.isCSS2DObject&&p.push(m)}),p}function d(f){const p=u(f).sort(function(g,I){if(g.renderOrder!==I.renderOrder)return I.renderOrder-g.renderOrder;const C=a.objects.get(g).distanceToCameraSquared,b=a.objects.get(I).distanceToCameraSquared;return C-b}),m=p.length;for(let g=0,I=p.length;g<I;g++)p[g].element.style.zIndex=m-g}}}let mi=class{constructor(t,e,i){B(this,"three"),B(this,"world"),B(this,"onDisposed",new nt),this.world=t;let s;e?s=e:(s=document.createElement("div"),s.style.width="15px",s.style.height="15px",s.style.border="5px solid red"),this.three=new o5(s),(i||t.scene.three).add(this.three),this.visible=!0}set visible(t){this.three.visible=t}get visible(){return this.three.visible}toggleVisibility(){this.visible=!this.visible}dispose(){this.three.removeFromParent(),this.three.element.remove(),this.onDisposed.trigger(),this.onDisposed.reset()}};class IS extends Z3{constructor(t,e,i){super(t,e,i),B(this,"three2D",new a5),this.onAfterUpdate.add(()=>{if(this.onBeforeUpdate.trigger(this),!this.enabled||!this.currentWorld)return;const s=this.currentWorld.scene.three,n=this.currentWorld.camera.three;s instanceof rn&&this.three2D.render(s,n)}),this.onDisposed.add(()=>{this.three2D.domElement.remove()}),this.onResize.add(({x:s,y:n})=>{this.three2D.setSize(s,n)}),this.setupHtmlRenderer(),this.resize()}setupHtmlRenderer(){this.three2D.domElement.style.position="absolute",this.three2D.domElement.style.top="0px",this.three2D.domElement.style.pointerEvents="none",this.container&&this.container.appendChild(this.three2D.domElement)}}const gS=class ES extends xt{constructor(t){super(t),B(this,"onDisposed",new nt),B(this,"enabled",!0),B(this,"threshold",50),B(this,"autoCluster",!0),B(this,"list",new Map),B(this,"clusterLabels",new Set),B(this,"currentKeys",new Set),B(this,"_color","white"),B(this,"_markerKey",0),B(this,"_clusterKey",0),B(this,"_worldEvents",new Map),B(this,"_setupWorlds",new Set),t.add(ES.uuid,this)}get color(){return this._color}set color(t){this._color=t;for(const[e,i]of this.list)for(const[s,n]of i)n.label.three.element.style.color=t}create(t,e,i,s=!1){this.setupEvents(t,!0);const n=this._markerKey.toString(),o=this.getWorldMarkerList(t);if(o.has(n))return;const a=document.createElement("span");a.innerHTML=e,a.style.color=this._color;const c=new mi(t,a);return c.three.position.copy(i),o.set(n,{key:n,label:c,merged:!1,static:s}),this._markerKey++,n}delete(t){for(const[e,i]of this.list){const s=i.get(t);s&&s.label.dispose(),i.delete(t)}}getWorldMarkerList(t){return this.list.has(t.uuid)||this.list.set(t.uuid,new Map),this.list.get(t.uuid)}dispose(t){for(const[e,i]of this.list){const s=[...i.keys()];for(const n of s){const o=i.get(n);t&&o.type!==t||(o.label.dispose(),i.delete(n))}}if(!t){this.list.clear(),this._markerKey=0;for(const e of this.clusterLabels)e.label.dispose();this.clusterLabels.clear(),this._clusterKey=0,this.currentKeys.clear()}this.onDisposed.trigger()}setupEvents(t,e){if(e&&this._setupWorlds.has(t.uuid)||!t.camera.hasCameraControls())return;const i=this.getWorldEvent(t);t.camera.controls.removeEventListener("sleep",i),t.camera.controls.removeEventListener("rest",i),e&&(t.camera.controls.addEventListener("sleep",i),t.camera.controls.addEventListener("rest",i))}cluster(t){if(!this.autoCluster)return;this.resetMarkers();const e=this.list.get(t.uuid);if(e){for(const[i,s]of e)if(!s.merged&&!s.static){this.currentKeys.clear();for(const[n,o]of e)o.static||s.key!==o.key&&!o.merged&&this.distance(s.label,o.label)<this.threshold&&(this.currentKeys.add(o.key),o.merged=!0);if(this.currentKeys.size>0){this.currentKeys.add(s.key),s.merged=!0;const n=Array.from(this.currentKeys),o=this.getAveragePositionFromLabels(n),a=new mi(s.label.world,this.createClusterElement(this._clusterKey.toString())),{element:c}=a.three;c.textContent=n.length.toString(),a.three.position.copy(o),this.clusterLabels.add({key:this._clusterKey.toString(),markerKeys:n,label:a}),this._clusterKey++}}this.removeMergeMarkers(t)}}getWorldEvent(t){if(!this._worldEvents.has(t.uuid)){const e=()=>{this.cluster(t)};this._worldEvents.set(t.uuid,e)}return this._worldEvents.get(t.uuid)}resetMarkers(){for(const[t,e]of this.list)for(const[i,s]of e)s.merged=!1;for(const t of this.clusterLabels)t.label.dispose();this.clusterLabels.clear(),this._clusterKey=0}removeMergeMarkers(t){const e=this.list.get(t.uuid);if(e){for(const[i,s]of e)s.merged?s.label.dispose():s.label.world.scene.three.add(s.label.three);for(const i of this.clusterLabels)if(i.markerKeys.length===1){for(const[s,n]of this.list){const o=n.get(i.markerKeys[0]);o&&(o.label.world.scene.three.add(o.label.three),o.merged=!1)}i.label.dispose(),this.clusterLabels.delete(i)}}}getAveragePositionFromLabels(t){const e=t.map(i=>{for(const[s,n]of this.list){const o=n.get(i);if(o)return o.label.three.position}return new M});return e.reduce((i,s)=>i.add(s),new M).divideScalar(e.length)}createClusterElement(t){const e=document.createElement("div");return e.textContent=t,e.style.color="#000000",e.style.background="#FFFFFF",e.style.fontSize="1.2rem",e.style.fontWeight="500",e.style.pointerEvents="auto",e.style.borderRadius="50%",e.style.padding="5px 11px",e.style.textAlign="center",e.style.cursor="pointer",e.addEventListener("pointerdown",()=>{this.navigateToCluster(t)}),e.addEventListener("pointerover",()=>{e.style.background="#BCF124"}),e.addEventListener("pointerout",()=>{e.style.background="#FFFFFF"}),e}getScreenPosition(t){const e=new M;if(!t.world.renderer)throw new Error("Renderer not found!");const i=t.three.position.clone();i.project(t.world.camera.three);const s=t.world.renderer.getSize();return e.x=i.x*s.x/2+s.x/2,e.y=-(i.y*s.y/2)+s.y/2,e}distance(t,e){const i=this.getScreenPosition(t),s=this.getScreenPosition(e),n=i.x-s.x,o=i.y-s.y,a=Math.sqrt(n*n+o*o)*.5;return a===0?this.threshold+1:a}navigateToCluster(t){const e=[],i=Array.from(this.clusterLabels).find(l=>l.key===t);if(!i)return;const s=i.label.world.camera;if(!s.hasCameraControls()){console.warn("Zoom to clusters only supported with Camera Controls!");return}for(const l of i.markerKeys)for(const[h,u]of this.list){const d=u.get(l);if(d){const{x:f,y:p,z:m}=d.label.three.position;e.push(f,p,m)}}i.label.dispose(),this.clusterLabels.delete(i);const n=new Ut,o=new Float32Array(e),a=new Kt(o,3);n.setAttribute("position",a);const c=new it(n);c.geometry.computeBoundingSphere(),c.geometry.boundingSphere&&s.controls.fitToSphere(c,!0),n.dispose(),c.clear(),e.length=0}};B(gS,"uuid","4079eb91-79b0-4ede-bcf2-15b837129236");let Jr=gS;function c5(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var QE={exports:{}};QE.exports=vp;QE.exports.default=vp;function vp(r,t,e){e=e||2;var i=t&&t.length,s=i?t[0]*e:r.length,n=CS(r,0,s,e,!0),o=[];if(!n||n.next===n.prev)return o;var a,c,l,h,u,d,f;if(i&&(n=f5(r,t,n,e)),r.length>80*e){a=l=r[0],c=h=r[1];for(var p=e;p<s;p+=e)u=r[p],d=r[p+1],u<a&&(a=u),d<c&&(c=d),u>l&&(l=u),d>h&&(h=d);f=Math.max(l-a,h-c),f=f!==0?32767/f:0}return Oh(n,o,e,a,c,f,0),o}function CS(r,t,e,i,s){var n,o;if(s===wg(r,t,e,i)>0)for(n=t;n<e;n+=i)o=FT(n,r[n],r[n+1],o);else for(n=e-i;n>=t;n-=i)o=FT(n,r[n],r[n+1],o);return o&&Rp(o,o.next)&&(Nh(o),o=o.next),o}function Oo(r,t){if(!r)return r;t||(t=r);var e=r,i;do if(i=!1,!e.steiner&&(Rp(e,e.next)||Te(e.prev,e,e.next)===0)){if(Nh(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function Oh(r,t,e,i,s,n,o){if(r){!o&&n&&E5(r,i,s,n);for(var a=r,c,l;r.prev!==r.next;){if(c=r.prev,l=r.next,n?h5(r,i,s,n):l5(r)){t.push(c.i/e|0),t.push(r.i/e|0),t.push(l.i/e|0),Nh(r),r=l.next,a=l.next;continue}if(r=l,r===a){o?o===1?(r=u5(Oo(r),t,e),Oh(r,t,e,i,s,n,2)):o===2&&d5(r,t,e,i,s,n):Oh(Oo(r),t,e,i,s,n,1);break}}}}function l5(r){var t=r.prev,e=r,i=r.next;if(Te(t,e,i)>=0)return!1;for(var s=t.x,n=e.x,o=i.x,a=t.y,c=e.y,l=i.y,h=s<n?s<o?s:o:n<o?n:o,u=a<c?a<l?a:l:c<l?c:l,d=s>n?s>o?s:o:n>o?n:o,f=a>c?a>l?a:l:c>l?c:l,p=i.next;p!==t;){if(p.x>=h&&p.x<=d&&p.y>=u&&p.y<=f&&Ha(s,a,n,c,o,l,p.x,p.y)&&Te(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function h5(r,t,e,i){var s=r.prev,n=r,o=r.next;if(Te(s,n,o)>=0)return!1;for(var a=s.x,c=n.x,l=o.x,h=s.y,u=n.y,d=o.y,f=a<c?a<l?a:l:c<l?c:l,p=h<u?h<d?h:d:u<d?u:d,m=a>c?a>l?a:l:c>l?c:l,g=h>u?h>d?h:d:u>d?u:d,I=Ag(f,p,t,e,i),C=Ag(m,g,t,e,i),b=r.prevZ,E=r.nextZ;b&&b.z>=I&&E&&E.z<=C;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==s&&b!==o&&Ha(a,h,c,u,l,d,b.x,b.y)&&Te(b.prev,b,b.next)>=0||(b=b.prevZ,E.x>=f&&E.x<=m&&E.y>=p&&E.y<=g&&E!==s&&E!==o&&Ha(a,h,c,u,l,d,E.x,E.y)&&Te(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;b&&b.z>=I;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==s&&b!==o&&Ha(a,h,c,u,l,d,b.x,b.y)&&Te(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;E&&E.z<=C;){if(E.x>=f&&E.x<=m&&E.y>=p&&E.y<=g&&E!==s&&E!==o&&Ha(a,h,c,u,l,d,E.x,E.y)&&Te(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function u5(r,t,e){var i=r;do{var s=i.prev,n=i.next.next;!Rp(s,n)&&bS(s,i,i.next,n)&&xh(s,n)&&xh(n,s)&&(t.push(s.i/e|0),t.push(i.i/e|0),t.push(n.i/e|0),Nh(i),Nh(i.next),i=r=n),i=i.next}while(i!==r);return Oo(i)}function d5(r,t,e,i,s,n){var o=r;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&T5(o,a)){var c=TS(o,a);o=Oo(o,o.next),c=Oo(c,c.next),Oh(o,t,e,i,s,n,0),Oh(c,t,e,i,s,n,0);return}a=a.next}o=o.next}while(o!==r)}function f5(r,t,e,i){var s=[],n,o,a,c,l;for(n=0,o=t.length;n<o;n++)a=t[n]*i,c=n<o-1?t[n+1]*i:r.length,l=CS(r,a,c,i,!1),l===l.next&&(l.steiner=!0),s.push(b5(l));for(s.sort(p5),n=0;n<s.length;n++)e=m5(s[n],e);return e}function p5(r,t){return r.x-t.x}function m5(r,t){var e=I5(r,t);if(!e)return t;var i=TS(e,r);return Oo(i,i.next),Oo(e,e.next)}function I5(r,t){var e=t,i=r.x,s=r.y,n=-1/0,o;do{if(s<=e.y&&s>=e.next.y&&e.next.y!==e.y){var a=e.x+(s-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(a<=i&&a>n&&(n=a,o=e.x<e.next.x?e:e.next,a===i))return o}e=e.next}while(e!==t);if(!o)return null;var c=o,l=o.x,h=o.y,u=1/0,d;e=o;do i>=e.x&&e.x>=l&&i!==e.x&&Ha(s<h?i:n,s,l,h,s<h?n:i,s,e.x,e.y)&&(d=Math.abs(s-e.y)/(i-e.x),xh(e,r)&&(d<u||d===u&&(e.x>o.x||e.x===o.x&&g5(o,e)))&&(o=e,u=d)),e=e.next;while(e!==c);return o}function g5(r,t){return Te(r.prev,r,t.prev)<0&&Te(t.next,r,r.next)<0}function E5(r,t,e,i){var s=r;do s.z===0&&(s.z=Ag(s.x,s.y,t,e,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==r);s.prevZ.nextZ=null,s.prevZ=null,C5(s)}function C5(r){var t,e,i,s,n,o,a,c,l=1;do{for(e=r,r=null,n=null,o=0;e;){for(o++,i=e,a=0,t=0;t<l&&(a++,i=i.nextZ,!!i);t++);for(c=l;a>0||c>0&&i;)a!==0&&(c===0||!i||e.z<=i.z)?(s=e,e=e.nextZ,a--):(s=i,i=i.nextZ,c--),n?n.nextZ=s:r=s,s.prevZ=n,n=s;e=i}n.nextZ=null,l*=2}while(o>1);return r}function Ag(r,t,e,i,s){return r=(r-e)*s|0,t=(t-i)*s|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1}function b5(r){var t=r,e=r;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==r);return e}function Ha(r,t,e,i,s,n,o,a){return(s-o)*(t-a)>=(r-o)*(n-a)&&(r-o)*(i-a)>=(e-o)*(t-a)&&(e-o)*(n-a)>=(s-o)*(i-a)}function T5(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!y5(r,t)&&(xh(r,t)&&xh(t,r)&&v5(r,t)&&(Te(r.prev,r,t.prev)||Te(r,t.prev,t))||Rp(r,t)&&Te(r.prev,r,r.next)>0&&Te(t.prev,t,t.next)>0)}function Te(r,t,e){return(t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y)}function Rp(r,t){return r.x===t.x&&r.y===t.y}function bS(r,t,e,i){var s=Bd(Te(r,t,e)),n=Bd(Te(r,t,i)),o=Bd(Te(e,i,r)),a=Bd(Te(e,i,t));return!!(s!==n&&o!==a||s===0&&Ud(r,e,t)||n===0&&Ud(r,i,t)||o===0&&Ud(e,r,i)||a===0&&Ud(e,t,i))}function Ud(r,t,e){return t.x<=Math.max(r.x,e.x)&&t.x>=Math.min(r.x,e.x)&&t.y<=Math.max(r.y,e.y)&&t.y>=Math.min(r.y,e.y)}function Bd(r){return r>0?1:r<0?-1:0}function y5(r,t){var e=r;do{if(e.i!==r.i&&e.next.i!==r.i&&e.i!==t.i&&e.next.i!==t.i&&bS(e,e.next,r,t))return!0;e=e.next}while(e!==r);return!1}function xh(r,t){return Te(r.prev,r,r.next)<0?Te(r,t,r.next)>=0&&Te(r,r.prev,t)>=0:Te(r,t,r.prev)<0||Te(r,r.next,t)<0}function v5(r,t){var e=r,i=!1,s=(r.x+t.x)/2,n=(r.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&s<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==r);return i}function TS(r,t){var e=new Sg(r.i,r.x,r.y),i=new Sg(t.i,t.x,t.y),s=r.next,n=t.prev;return r.next=t,t.prev=r,e.next=s,s.prev=e,i.next=e,e.prev=i,n.next=i,i.prev=n,i}function FT(r,t,e,i){var s=new Sg(r,t,e);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function Nh(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Sg(r,t,e){this.i=r,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}vp.deviation=function(r,t,e,i){var s=t&&t.length,n=s?t[0]*e:r.length,o=Math.abs(wg(r,0,n,e));if(s)for(var a=0,c=t.length;a<c;a++){var l=t[a]*e,h=a<c-1?t[a+1]*e:r.length;o-=Math.abs(wg(r,l,h,e))}var u=0;for(a=0;a<i.length;a+=3){var d=i[a]*e,f=i[a+1]*e,p=i[a+2]*e;u+=Math.abs((r[d]-r[p])*(r[f+1]-r[d+1])-(r[d]-r[f])*(r[p+1]-r[d+1]))}return o===0&&u===0?0:Math.abs((u-o)/o)};function wg(r,t,e,i){for(var s=0,n=t,o=e-i;n<e;n+=i)s+=(r[o]-r[n])*(r[n+1]+r[o+1]),o=n;return s}vp.flatten=function(r){for(var t=r[0][0].length,e={vertices:[],holes:[],dimensions:t},i=0,s=0;s<r.length;s++){for(var n=0;n<r[s].length;n++)for(var o=0;o<t;o++)e.vertices.push(r[s][n][o]);s>0&&(i+=r[s-1].length,e.holes.push(i))}return e};var R5=QE.exports;const A5=c5(R5),S5={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};let jc=class{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}};const w5=new cs(-1,1,1,-1,0,1);let _5=class extends Ut{constructor(){super(),this.setAttribute("position",new Cr([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Cr([0,2,0,0,2,0],2))}};const F5=new _5;let yS=class{constructor(t){this._mesh=new it(F5,t)}dispose(){this._mesh.geometry.dispose()}render(t){t.render(this._mesh,w5)}get material(){return this._mesh.material}set material(t){this._mesh.material=t}},vS=class extends jc{constructor(t,e){super(),this.textureID=e!==void 0?e:"tDiffuse",t instanceof qe?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=eE.clone(t.uniforms),this.material=new qe({name:t.name!==void 0?t.name:"unspecified",defines:Object.assign({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.fsQuad=new yS(this.material)}render(t,e,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),this.fsQuad.render(t))}dispose(){this.material.dispose(),this.fsQuad.dispose()}},OT=class extends jc{constructor(t,e){super(),this.scene=t,this.camera=e,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(t,e,i){const s=t.getContext(),n=t.state;n.buffers.color.setMask(!1),n.buffers.depth.setMask(!1),n.buffers.color.setLocked(!0),n.buffers.depth.setLocked(!0);let o,a;this.inverse?(o=0,a=1):(o=1,a=0),n.buffers.stencil.setTest(!0),n.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),n.buffers.stencil.setFunc(s.ALWAYS,o,4294967295),n.buffers.stencil.setClear(a),n.buffers.stencil.setLocked(!0),t.setRenderTarget(i),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(e),this.clear&&t.clear(),t.render(this.scene,this.camera),n.buffers.color.setLocked(!1),n.buffers.depth.setLocked(!1),n.buffers.color.setMask(!0),n.buffers.depth.setMask(!0),n.buffers.stencil.setLocked(!1),n.buffers.stencil.setFunc(s.EQUAL,1,4294967295),n.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),n.buffers.stencil.setLocked(!0)}},O5=class extends jc{constructor(){super(),this.needsSwap=!1}render(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}},x5=class{constructor(t,e){if(this.renderer=t,this._pixelRatio=t.getPixelRatio(),e===void 0){const i=t.getSize(new Ot);this._width=i.width,this._height=i.height,e=new ts(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:iE}),e.texture.name="EffectComposer.rt1"}else this._width=e.width,this._height=e.height;this.renderTarget1=e,this.renderTarget2=e.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new vS(S5),this.copyPass.material.blending=V_,this.clock=new Kg}swapBuffers(){const t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t}addPass(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(t,e){this.passes.splice(e,0,t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(t){const e=this.passes.indexOf(t);e!==-1&&this.passes.splice(e,1)}isLastEnabledPass(t){for(let e=t+1;e<this.passes.length;e++)if(this.passes[e].enabled)return!1;return!0}render(t){t===void 0&&(t=this.clock.getDelta());const e=this.renderer.getRenderTarget();let i=!1;for(let s=0,n=this.passes.length;s<n;s++){const o=this.passes[s];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),o.render(this.renderer,this.writeBuffer,this.readBuffer,t,i),o.needsSwap){if(i){const a=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),c.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}OT!==void 0&&(o instanceof OT?i=!0:o instanceof O5&&(i=!1))}}this.renderer.setRenderTarget(e)}reset(t){if(t===void 0){const e=this.renderer.getSize(new Ot);this._pixelRatio=this.renderer.getPixelRatio(),this._width=e.width,this._height=e.height,t=this.renderTarget1.clone(),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(t,e){this._width=t,this._height=e;const i=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(i,s),this.renderTarget2.setSize(i,s);for(let n=0;n<this.passes.length;n++)this.passes[n].setSize(i,s)}setPixelRatio(t){this._pixelRatio=t,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}},N5=class extends jc{constructor(t,e,i=null,s=null,n=null){super(),this.scene=t,this.camera=e,this.overrideMaterial=i,this.clearColor=s,this.clearAlpha=n,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Rt}render(t,e,i){const s=t.autoClear;t.autoClear=!1;let n,o;this.overrideMaterial!==null&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(t.getClearColor(this._oldClearColor),t.setClearColor(this.clearColor)),this.clearAlpha!==null&&(n=t.getClearAlpha(),t.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:i),this.clear===!0&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor!==null&&t.setClearColor(this._oldClearColor),this.clearAlpha!==null&&t.setClearAlpha(n),this.overrideMaterial!==null&&(this.scene.overrideMaterial=o),t.autoClear=s}};const su=new Ut;su.setAttribute("position",new Kt(new Float32Array([-1,-1,3,-1,-1,3]),2));su.setAttribute("uv",new Kt(new Float32Array([0,0,2,0,0,2]),2));su.boundingSphere=new as;su.computeBoundingSphere=function(){};const P5=new cs;class kd{constructor(t){this._mesh=new it(su,t),this._mesh.frustumCulled=!1}render(t){t.render(this._mesh,P5)}get material(){return this._mesh.material}set material(t){this._mesh.material=t}dispose(){this._mesh.material.dispose(),this._mesh.geometry.dispose()}}const L5={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},sceneNormal:{value:null},projMat:{value:new ht},viewMat:{value:new ht},projViewMat:{value:new ht},projectionMatrixInv:{value:new ht},viewMatrixInv:{value:new ht},cameraPos:{value:new M},resolution:{value:new Ot},time:{value:0},samples:{value:[]},samplesR:{value:[]},bluenoise:{value:null},distanceFalloff:{value:1},radius:{value:5},near:{value:.1},far:{value:1e3},logDepth:{value:!1},ortho:{value:!1},screenSpaceRadius:{value:!1}},vertexShader:`
varying vec2 vUv;
void main() {
  vUv = uv;
  gl_Position = vec4(position, 1);
}`,fragmentShader:`
    #define SAMPLES 16
    #define FSAMPLES 16.0
uniform sampler2D sceneDiffuse;
uniform sampler2D sceneNormal;
uniform highp sampler2D sceneDepth;
uniform mat4 projectionMatrixInv;
uniform mat4 viewMatrixInv;
uniform mat4 projMat;
uniform mat4 viewMat;
uniform mat4 projViewMat;
uniform vec3 cameraPos;
uniform vec2 resolution;
uniform float time;
uniform vec3[SAMPLES] samples;
uniform float[SAMPLES] samplesR;
uniform float radius;
uniform float distanceFalloff;
uniform float near;
uniform float far;
uniform bool logDepth;
uniform bool ortho;
uniform bool screenSpaceRadius;
uniform sampler2D bluenoise;
    varying vec2 vUv;
    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        return (zFar * zNear) / (zFar - d * (zFar - zNear));
    }
    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
      return nearZ + (farZ - nearZ) * d;
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      return ortho ? linearize_depth_ortho(
        linDepth,
        nearZ,
        farZ
      ) :linearize_depth(linDepth, nearZ, farZ);
    }

    vec3 getWorldPosLog(vec3 posS) {
      vec2 uv = posS.xy;
      float z = posS.z;
      float nearZ =near;
      float farZ = far;
      float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
      vec4 wpos = viewMatrixInv * projectionMatrixInv * clipVec;
      return wpos.xyz / wpos.w;
    }
    vec3 getWorldPos(float depth, vec2 coord) {
      #ifdef LOGDEPTH
        return getWorldPosLog(vec3(coord, depth));
      #endif
      float z = depth * 2.0 - 1.0;
      vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
      vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
      // Perspective division
     vec4 worldSpacePosition = viewMatrixInv * viewSpacePosition;
     worldSpacePosition.xyz /= worldSpacePosition.w;
      return worldSpacePosition.xyz;
  }

  vec3 computeNormal(vec3 worldPos, vec2 vUv) {
    ivec2 p = ivec2(vUv * resolution);
    float c0 = texelFetch(sceneDepth, p, 0).x;
    float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
    float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
    float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
    float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
    float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
    float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
    float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
    float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;

    float dl = abs((2.0 * l1 - l2) - c0);
    float dr = abs((2.0 * r1 - r2) - c0);
    float db = abs((2.0 * b1 - b2) - c0);
    float dt = abs((2.0 * t1 - t2) - c0);

    vec3 ce = getWorldPos(c0, vUv).xyz;

    vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                          : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
    vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                          : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;

    return normalize(cross(dpdx, dpdy));
}

void main() {
      vec4 diffuse = texture2D(sceneDiffuse, vUv);
      float depth = texture2D(sceneDepth, vUv).x;
      if (depth == 1.0) {
        gl_FragColor = vec4(vec3(1.0), 1.0);
        return;
      }
      vec3 worldPos = getWorldPos(depth, vUv);
    //  vec3 normal = texture2D(sceneNormal, vUv).rgb;//computeNormal(worldPos, vUv);
      #ifdef HALFRES
        vec3 normal = texture2D(sceneNormal, vUv).rgb;
      #else
        vec3 normal = computeNormal(worldPos, vUv);
      #endif
      vec4 noise = texture2D(bluenoise, gl_FragCoord.xy / 128.0);
      vec3 randomVec = normalize(noise.rgb * 2.0 - 1.0);
      vec3 tangent = normalize(randomVec - normal * dot(randomVec, normal));
      vec3 bitangent = cross(normal, tangent);
      mat3 tbn = mat3(tangent, bitangent, normal);
      float occluded = 0.0;
      float totalWeight = 0.0;
     /* float radiusScreen = distance(
        worldPos,
        getWorldPos(depth, vUv + 
          vec2(48.0, 0.0) / resolution)
      );/*vUv.x < 0.5 ? radius : min(distance(
        worldPos,
        getWorldPos(depth, vUv + 
          vec2(100.0, 0.0) / resolution)
      ), radius);
      float distanceFalloffScreen = radiusScreen * 0.2;*/
      float radiusToUse = screenSpaceRadius ? distance(
        worldPos,
        getWorldPos(depth, vUv +
          vec2(radius, 0.0) / resolution)
      ) : radius;
      float distanceFalloffToUse =screenSpaceRadius ?
          radiusToUse * distanceFalloff
      : distanceFalloff;
      float bias = (0.1 / near) * fwidth(distance(worldPos, cameraPos)) / radiusToUse;
      for(float i = 0.0; i < FSAMPLES; i++) {
        vec3 sampleDirection = 
        tbn * 
        samples[int(i)];
        ;
        float moveAmt = samplesR[int(mod(i + noise.a * FSAMPLES, FSAMPLES))];
        vec3 samplePos = worldPos + radiusToUse * moveAmt * sampleDirection;
        vec4 offset = projViewMat * vec4(samplePos, 1.0);
        offset.xyz /= offset.w;
        offset.xyz = offset.xyz * 0.5 + 0.5;
        float sampleDepth = textureLod(sceneDepth, offset.xy, 0.0).x;
        /*float distSample = logDepth ? linearize_depth_log(sampleDepth, near, far) 
         (ortho ?  linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far));*/
        #ifdef LOGDEPTH
        float distSample = linearize_depth_log(sampleDepth, near, far);
        #else
        float distSample = ortho ? linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far);
        #endif
        float distWorld = ortho ? linearize_depth_ortho(offset.z, near, far) : linearize_depth(offset.z, near, far);
        float rangeCheck = smoothstep(0.0, 1.0, distanceFalloffToUse / (abs(distSample - distWorld)));
        vec2 diff = gl_FragCoord.xy - ( offset.xy * resolution);
        float weight = dot(sampleDirection, normal);
          occluded += rangeCheck * weight * 
            (distSample + bias
               < distWorld ? 1.0 : 0.0) * (
          (dot(
            diff,
            diff
             
            ) < 1.0 || (sampleDepth == depth) || (
              offset.x < 0.0 || offset.x > 1.0 || offset.y < 0.0 || offset.y > 1.0
            ) ? 0.0 : 1.0)
          );
          totalWeight += weight;
      }
      float occ = clamp(1.0 - occluded / totalWeight, 0.0, 1.0);
      gl_FragColor = vec4(0.5 + 0.5 * normal, occ);
}`},M5={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new ht},viewMat:{value:new ht},projectionMatrixInv:{value:new ht},viewMatrixInv:{value:new ht},cameraPos:{value:new M},resolution:{value:new Ot},color:{value:new M(0,0,0)},blueNoise:{value:null},downsampledDepth:{value:null},time:{value:0},intensity:{value:10},renderMode:{value:0},gammaCorrection:{value:!1},logDepth:{value:!1},ortho:{value:!1},near:{value:.1},far:{value:1e3},screenSpaceRadius:{value:!1},radius:{value:0},distanceFalloff:{value:1}},vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = vec4(position, 1);
		}`,fragmentShader:`
		uniform sampler2D sceneDiffuse;
    uniform sampler2D sceneDepth;
    uniform sampler2D downsampledDepth;
    uniform sampler2D tDiffuse;
    uniform sampler2D blueNoise;
    uniform vec2 resolution;
    uniform vec3 color;
    uniform mat4 projectionMatrixInv;
    uniform mat4 viewMatrixInv;
    uniform float intensity;
    uniform float renderMode;
    uniform float near;
    uniform float far;
    uniform bool gammaCorrection;
    uniform bool logDepth;
    uniform bool ortho;
    uniform bool screenSpaceRadius;
    uniform float radius;
    uniform float distanceFalloff;
    varying vec2 vUv;
    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        return (zFar * zNear) / (zFar - d * (zFar - zNear));
    }
    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
      return nearZ + (farZ - nearZ) * d;
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
      float a = farZ / (farZ - nearZ);
      float b = farZ * nearZ / (nearZ - farZ);
      float linDepth = a + b / depth;
      return ortho ? linearize_depth_ortho(
        linDepth,
        nearZ,
        farZ
      ) :linearize_depth(linDepth, nearZ, farZ);
    }
    vec3 getWorldPosLog(vec3 posS) {
        vec2 uv = posS.xy;
        float z = posS.z;
        float nearZ =near;
        float farZ = far;
        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
        float a = farZ / (farZ - nearZ);
        float b = farZ * nearZ / (nearZ - farZ);
        float linDepth = a + b / depth;
        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
        vec4 wpos = viewMatrixInv * projectionMatrixInv * clipVec;
        return wpos.xyz / wpos.w;
      }
      vec3 getWorldPos(float depth, vec2 coord) {
       // if (logDepth) {
        #ifdef LOGDEPTH
          return getWorldPosLog(vec3(coord, depth));
        #endif
      //  }
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewMatrixInv * viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
  
    vec3 computeNormal(vec3 worldPos, vec2 vUv) {
      ivec2 p = ivec2(vUv * resolution);
      float c0 = texelFetch(sceneDepth, p, 0).x;
      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;
  
      float dl = abs((2.0 * l1 - l2) - c0);
      float dr = abs((2.0 * r1 - r2) - c0);
      float db = abs((2.0 * b1 - b2) - c0);
      float dt = abs((2.0 * t1 - t2) - c0);
  
      vec3 ce = getWorldPos(c0, vUv).xyz;
  
      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;
  
      return normalize(cross(dpdx, dpdy));
  }

    #include <common>
    #include <dithering_pars_fragment>
    void main() {
        //vec4 texel = texture2D(tDiffuse, vUv);//vec3(0.0);
        vec4 sceneTexel = texture2D(sceneDiffuse, vUv);

        #ifdef HALFRES 
        float depth = texture2D(
            sceneDepth,
            vUv
        ).x;
        vec4 texel;
        if (depth == 1.0) {
            texel = vec4(0.0, 0.0, 0.0, 1.0);
        } else {
        vec3 worldPos = getWorldPos(depth, vUv);
        vec3 normal = computeNormal(getWorldPos(depth, vUv), vUv);
       // vec4 texel = texture2D(tDiffuse, vUv);
       // Find closest depth;
       float totalWeight = 0.0;
       float radiusToUse = screenSpaceRadius ? distance(
        worldPos,
        getWorldPos(depth, vUv +
          vec2(radius, 0.0) / resolution)
      ) : radius;
      float distanceFalloffToUse =screenSpaceRadius ?
          radiusToUse * distanceFalloff
      : distanceFalloff;
        for(float x = -1.0; x <= 1.0; x++) {
            for(float y = -1.0; y <= 1.0; y++) {
                vec2 offset = vec2(x, y);
                ivec2 p = ivec2(
                    (vUv * resolution * 0.5) + offset
                );
                vec2 pUv = vec2(p) / (resolution * 0.5);
                float sampleDepth = texelFetch(downsampledDepth,p, 0).x;
                vec4 sampleInfo = texelFetch(tDiffuse, p, 0);
                vec3 normalSample = sampleInfo.xyz * 2.0 - 1.0;
                vec3 worldPosSample = getWorldPos(sampleDepth, pUv);
                float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));
                float rangeCheck = exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0);
                float weight = rangeCheck;
                totalWeight += weight;
                texel += sampleInfo * weight;
            }
        }
        if (totalWeight == 0.0) {
            texel = texture2D(tDiffuse, vUv);
        } else {
            texel /= totalWeight;
        }
    }
        #else
        vec4 texel = texture2D(tDiffuse, vUv);
        #endif

     
        float finalAo = pow(texel.a, intensity);
        if (renderMode == 0.0) {
            gl_FragColor = vec4( mix(sceneTexel.rgb, color * sceneTexel.rgb, 1.0 - finalAo), sceneTexel.a);
        } else if (renderMode == 1.0) {
            gl_FragColor = vec4( mix(vec3(1.0), color * sceneTexel.rgb, 1.0 - finalAo), sceneTexel.a);
        } else if (renderMode == 2.0) {
            gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
        } else if (renderMode == 3.0) {
            if (vUv.x < 0.5) {
                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {
                gl_FragColor = vec4(1.0);
            } else {
                gl_FragColor = vec4( mix(sceneTexel.rgb, color * sceneTexel.rgb, 1.0 - finalAo), sceneTexel.a);
            }
        } else if (renderMode == 4.0) {
            if (vUv.x < 0.5) {
                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);
            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {
                gl_FragColor = vec4(1.0);
            } else {
                gl_FragColor = vec4( mix(vec3(1.0), color * sceneTexel.rgb, 1.0 - finalAo), sceneTexel.a);
            }
        }
        #include <dithering_fragment>
        if (gammaCorrection) {
            gl_FragColor = LinearTosRGB(gl_FragColor);
        }
    }
    `},D5={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new ht},viewMat:{value:new ht},projectionMatrixInv:{value:new ht},viewMatrixInv:{value:new ht},cameraPos:{value:new M},resolution:{value:new Ot},time:{value:0},r:{value:5},blueNoise:{value:null},radius:{value:12},worldRadius:{value:5},index:{value:0},poissonDisk:{value:[]},distanceFalloff:{value:1},near:{value:.1},far:{value:1e3},logDepth:{value:!1},screenSpaceRadius:{value:!1}},vertexShader:`
		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = vec4(position, 1.0);
		}`,fragmentShader:`
		uniform sampler2D sceneDiffuse;
    uniform highp sampler2D sceneDepth;
    uniform sampler2D tDiffuse;
    uniform sampler2D blueNoise;
    uniform mat4 projectionMatrixInv;
    uniform mat4 viewMatrixInv;
    uniform vec2 resolution;
    uniform float r;
    uniform float radius;
     uniform float worldRadius;
    uniform float index;
     uniform float near;
     uniform float far;
     uniform float distanceFalloff;
     uniform bool logDepth;
     uniform bool screenSpaceRadius;
    varying vec2 vUv;

    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)
    {
        highp float z_n = 2.0 * d - 1.0;
        return 2.0 * zNear * zFar / (zFar + zNear - z_n * (zFar - zNear));
    }
    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {
     float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;
     float a = farZ / (farZ - nearZ);
     float b = farZ * nearZ / (nearZ - farZ);
     float linDepth = a + b / depth;
     return linearize_depth(linDepth, nearZ, farZ);
   }
   highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {
     return nearZ + (farZ - nearZ) * d;
   }
   vec3 getWorldPosLog(vec3 posS) {
     vec2 uv = posS.xy;
     float z = posS.z;
     float nearZ =near;
     float farZ = far;
     float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
     float a = farZ / (farZ - nearZ);
     float b = farZ * nearZ / (nearZ - farZ);
     float linDepth = a + b / depth;
     vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
     vec4 wpos = viewMatrixInv * projectionMatrixInv * clipVec;
     return wpos.xyz / wpos.w;
   }
    vec3 getWorldPos(float depth, vec2 coord) {
     #ifdef LOGDEPTH
          return getWorldPosLog(vec3(coord, depth));
     #endif
        
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewMatrixInv * viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
    #include <common>
    #define NUM_SAMPLES 16
    uniform vec2 poissonDisk[NUM_SAMPLES];
    void main() {
        const float pi = 3.14159;
        vec2 texelSize = vec2(1.0 / resolution.x, 1.0 / resolution.y);
        vec2 uv = vUv;
        vec4 data = texture2D(tDiffuse, vUv);
        float occlusion = data.a;
        float baseOcc = data.a;
        vec3 normal = data.rgb * 2.0 - 1.0;
        float count = 1.0;
        float d = texture2D(sceneDepth, vUv).x;
        vec3 worldPos = getWorldPos(d, vUv);
        float size = radius;
        float angle;
        if (index == 0.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).x * PI2;
        } else if (index == 1.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).y * PI2;
        } else if (index == 2.0) {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).z * PI2;
        } else {
             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).w * PI2;
        }

        mat2 rotationMatrix = mat2(cos(angle), -sin(angle), sin(angle), cos(angle));
        float radiusToUse = screenSpaceRadius ? distance(
          worldPos,
          getWorldPos(d, vUv +
            vec2(worldRadius, 0.0) / resolution)
        ) : worldRadius;
        float distanceFalloffToUse =screenSpaceRadius ?
            radiusToUse * distanceFalloff
        : distanceFalloff;


        for(int i = 0; i < NUM_SAMPLES; i++) {
            vec2 offset = (rotationMatrix * poissonDisk[i]) * texelSize * size;
            vec4 dataSample = texture2D(tDiffuse, uv + offset);
            float occSample = dataSample.a;
            vec3 normalSample = dataSample.rgb * 2.0 - 1.0;
            float dSample = texture2D(sceneDepth, uv + offset).x;
            vec3 worldPosSample = getWorldPos(dSample, uv + offset);
            float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));
            float rangeCheck = exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0) * (1.0 - abs(occSample - baseOcc));
            occlusion += occSample * rangeCheck;
            count += rangeCheck;
        }
        occlusion /= count;
        gl_FragColor = vec4(0.5 + 0.5 * normal, occlusion);
    }
    `},U5={uniforms:{sceneDepth:{value:null},resolution:{value:new Ot},near:{value:.1},far:{value:1e3},viewMatrixInv:{value:new ht},projectionMatrixInv:{value:new ht},logDepth:{value:!1}},vertexShader:`
    varying vec2 vUv;
    void main() {
        vUv = uv;
        gl_Position = vec4(position, 1);
    }`,fragmentShader:`
    uniform sampler2D sceneDepth;
    uniform vec2 resolution;
    uniform float near;
    uniform float far;
    uniform bool logDepth;
    uniform mat4 viewMatrixInv;
    uniform mat4 projectionMatrixInv;
    varying vec2 vUv;
    layout(location = 1) out vec4 gNormal;
    vec3 getWorldPosLog(vec3 posS) {
        vec2 uv = posS.xy;
        float z = posS.z;
        float nearZ =near;
        float farZ = far;
        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;
        float a = farZ / (farZ - nearZ);
        float b = farZ * nearZ / (nearZ - farZ);
        float linDepth = a + b / depth;
        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;
        vec4 wpos = viewMatrixInv * projectionMatrixInv * clipVec;
        return wpos.xyz / wpos.w;
      }
      vec3 getWorldPos(float depth, vec2 coord) {
        if (logDepth) {
          return getWorldPosLog(vec3(coord, depth));
        }
        float z = depth * 2.0 - 1.0;
        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;
        // Perspective division
       vec4 worldSpacePosition = viewMatrixInv * viewSpacePosition;
       worldSpacePosition.xyz /= worldSpacePosition.w;
        return worldSpacePosition.xyz;
    }
  
    vec3 computeNormal(vec3 worldPos, vec2 vUv) {
      ivec2 p = ivec2(vUv * resolution);
      float c0 = texelFetch(sceneDepth, p, 0).x;
      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;
      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;
      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;
      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;
      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;
      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;
      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;
      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;
  
      float dl = abs((2.0 * l1 - l2) - c0);
      float dr = abs((2.0 * r1 - r2) - c0);
      float db = abs((2.0 * b1 - b2) - c0);
      float dt = abs((2.0 * t1 - t2) - c0);
  
      vec3 ce = getWorldPos(c0, vUv).xyz;
  
      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz
                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;
      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz
                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;
  
      return normalize(cross(dpdx, dpdy));
  }
    void main() {
        vec2 uv = vUv - vec2(0.5) / resolution;
        vec2 pixelSize = vec2(1.0) / resolution;
        vec2[] uvSamples = vec2[4](
            uv,
            uv + vec2(pixelSize.x, 0.0),
            uv + vec2(0.0, pixelSize.y),
            uv + pixelSize
        );
        float depth00 = texture2D(sceneDepth, uvSamples[0]).r;
        float depth10 = texture2D(sceneDepth, uvSamples[1]).r;
        float depth01 = texture2D(sceneDepth, uvSamples[2]).r;
        float depth11 = texture2D(sceneDepth, uvSamples[3]).r;
        float minDepth = min(min(depth00, depth10), min(depth01, depth11));
        float maxDepth = max(max(depth00, depth10), max(depth01, depth11));
        float targetDepth = minDepth;
        // Checkerboard pattern to avoid artifacts
        if (mod(gl_FragCoord.x + gl_FragCoord.y, 2.0) > 0.5) { 
            targetDepth = maxDepth;
        }
        int chosenIndex = 0;
        float[] samples = float[4](depth00, depth10, depth01, depth11);
        for(int i = 0; i < 4; ++i) {
            if (samples[i] == targetDepth) {
                chosenIndex = i;
                break;
            }
        }
        gl_FragColor = vec4(samples[chosenIndex], 0.0, 0.0, 1.0);
        gNormal = vec4(computeNormal(
            getWorldPos(samples[chosenIndex], uvSamples[chosenIndex]), uvSamples[chosenIndex]
        ), 0.0);
       /* float[] samples = float[4](depth00, depth10, depth01, depth11);
        float c = 0.25 * (depth00 + depth10 + depth01 + depth11);
        float[] distances = float[4](depth00, depth10, depth01, depth11);
        float maxDistance = max(max(distances[0], distances[1]), max(distances[2], distances[3]));

        int remaining[3];
        int rejected[3];
        int i, j, k;

        for(i = 0, j = 0, k = 0; i < 4; ++i) {
            if (distances[i] < maxDistance) {
                remaining[j++] = i;
            } else {
                rejected[k++] = i;
            }
        }
        for(;j < 3;++j) {
            remaining[j] = rejected[--k];
        }
        vec3 s = vec3(
            samples[remaining[0]],
            samples[remaining[1]],
            samples[remaining[2]]
        );
        c = (s.x + s.y + s.z) / 3.0;

        distances[0] = abs(c - s.x);
        distances[1] = abs(c - s.y);
        distances[2] = abs(c - s.z);

        float minDistance = min(min(distances[0], distances[1]), distances[2]);

        for(i = 0; i < 3; ++i) {
            if (distances[i] == minDistance) {
                break;
            }
        }*/
      /*  gl_FragColor = vec4(samples[remaining[i]], 0.0, 0.0, 0.0);
        gNormal = vec4(computeNormal(
            getWorldPos(samples[remaining[i]], uvSamples[remaining[i]]), uvSamples[remaining[i]]
        ), 0.0);*/
    }`};var RS="5L7pP4UXrOIr/VZ1G3f6p89FIWU7lqc7J3DPxKjJUXODJoHQzf/aNVM+ABlvhXeBGN7iC0WkmTjEaAqOItBfBdaK5KSGV1ET5SOKl3x9JOX5w2sAl6+6KjDhVUHgbqq7DZ5EeYzbdSNxtrQLW/KkPJoOTG4u5CBUZkCKHniY9l7DUgjuz708zG1HIC8qfohi1vPjPH9Lq47ksjRrjwXD4MlVCjdAqYFGodQ8tRmHkOfq4wVRIAHvoavPHvN1lpk3X4Y1yzAPGe8S9KBs3crc4GwlU1dEOXiWol/mgQqxkNqB1xd04+0Bmpwj0GcCc4NUi+c731FUxjvaexCkCJ0qhrJJ++htWqetNC4NewClu8aFRSwrqiJEGe+qtTg4CYCHaF1wJI0sy/ZBQAI0qAMyBvVjWZlv2pdkCaro9eWDLK5I4mbb8E4d7hZr9dDJiTJm6Bmb5S+2F7yal/JPdeLUfwq7jmVLaQfhv4tWMJAt7V4sG9LuAv2oPJgSj1nnlBvPibfHM2TrlWHwGCLGxW/5Jm2TotaDL+pHDM5pn1r0UuTZ24N8S5k68bLHW9tfD+2k4zGev23ExJb4YTRKWrj82N5LjJ26lj1BkGZ0CsXLGGELoPaYQomjTqPxYqhfwOwDliNGVqux9ffuybqOKgsbB51B1GbZfG8vHDBE2JQGib1mnCmWOWAMJcHN0cKeDHYTflbDTVXajtr68mwfRje6WueQ/6yWqmZMLWNH7P27zGFhMFqaqfg11Q88g/9UA/FROe9yfq0yOO0pnNAxvepFy2BpEbcgG+mCyjCC01JWlOZlIPdf1TtlyOt7L94ToYGCukoFt4OqwOrofamjECpSgKLLmrRM+sNRAw12eaqk8KtdFk7pn2IcDQiPXCh16t1a+psi+w9towHTKPyQM0StKr61b2BnN1HU+aezFNBLfHTiXwhGTbdxLLmrsAGIVSiNAeCGE8GlB0iOv2v78kP0CTmAPUEqnHYRSDlP+L6m/rYjEK6Q85GRDJi2W20/7NLPpSOaMR++IFvpkcwRuc59j8hh9tYlc1xjdt2jmp9KJczB7U9P43inuxLOv11P5/HYH5d6gLB0CsbGC8APjh+EcCP0zFWqlaACZweLhVfv3yiyd8R3bdVg8sRKsxPvhDaPpiFp9+MN+0Ua0bsPr+lhxfZhMhlevkLbR4ZvcSRP6ApQLy3+eMh9ehCB3z5DVAaN3P6J8pi5Qa88ZQsOuCTWyH6q8yMfBw8y8nm6jaOxJhPH6Hf0I4jmALUBsWKH4gWBnyijHh7z3/1HhQzFLRDRrIQwUtu11yk7U0gDw/FatOIZOJaBx3UqbUxSZ6dboFPm5pAyyXC2wYdSWlpZx/D2C6hDO2sJM4HT9IKWWmDkZIO2si/6BKHruXIEDpfAtz3xDlIdKnnlqnkfCyy6vNOPyuoWsSWBeiN0mcfIrnOtp2j7bxjOkr25skfS/lwOC692cEp7TKSlymbsyzoWg/0AN66SvQYo6BqpNwPpTaUu25zMWlwVUdfu1EEdc0O06TI0JmHk4f6GZQbfOs//OdgtGPO6uLoadJycR8Z80rkd88QoNmimZd8vcpQKScCFkxH1RMTkPlN3K7CL/NSMOiXEvxrn9VyUPFee63uRflgaPMSsafvqMgzTt3T1RaHNLLFatQbD0Vha4YXZ/6Ake7onM65nC9cyLkteYkDfHoJtef7wCrWXTK0+vH38VUBcFJP0+uUXpkiK0gDXNA39HL/qdVcaOA16kd2gzq8aHpNSaKtgMLJC6fdLLS/I/4lUWV2+djY9Rc3QuJOUrlHFQERtXN4xJaAHZERCUQZ9ND2pEtZg8dsnilcnqmqYn3c1sRyK0ziKpHNytEyi2gmzxEFchvT1uBWxZUikkAlWuyqvvhteSG9kFhTLNM97s3X1iS2UbE6cvApgbmeJ/KqtP0NNT3bZiG9TURInCZtVsNZzYus6On0wcdMlVfqo8XLhT5ojaOk4DtCyeoQkBt1mf5luFNaLFjI/1cnPefyCQwcq5ia/4pN4NB+xE/3SEPsliJypS964SI6o5fDVa0IERR8DoeQ+1iyRLU1qGYexB61ph4pkG1rf3c2YD6By1pFCmww9B0r2VjFeaubkIdgWx4RKLQRPLENdGo8ezI5mkNtdCws19aP1uHhenD+HKa8GDeLulb2fiMRhU2xJzzz9e4yOMPvEnGEfbCiQ17nUDpcFDWthr68mhZ4WiHUkRpaVWJNExuULcGkuyVLsQj59pf6OHFR7tofhy9FMrWPCEvX1d5sCVJt8yBFiB6NoOuwMy4wlso9I2G4E5/5B2c6vIZUUY9fFujT3hpkdTuVhbhBwLCtnlIjBpN4cq+waZ0wXSrmebcl+dcrb7sPh9jKxFINkScDTBgjSUfLkC3huJJs/M4M8AOFxbbSIVpBUarYFmLpGsv+V6TJnWNTwI41tubwo7QSI1VOdRKT/Pp8U3oK2ciDbeuWnAGAANvQjGfcewdAdo6H83XzqlK/4yudtFHJSv9Y+qJskwnVToH1I0+tJ3vsLBXtlvMzLIxUj/8LcqZnrNHfVRgabFNXW0qpUvDgxnP3f54KooR3NI+2Q/VHAYFigMkQE5dLH6C6fGs/TKeE6E2jOhZQcP9/rrJjJKcLYdn5cw6XLCUe9F7quk5Yhac+nYL5HOXvp6Q/5qbiQHkuebanX77YSNx34YaWYpcEHuY1u/lEVTCQ7taPaw3oNcn/qJhMzGPZUs3XAq48wj/hCIO2d5aFdfXnS0yg57/jxzDJBwkdOgeVnyyh19Iz1UqiysT4J1eeKwUuWEYln23ydtP7g3R1BnvnxqFPAnOMgOIop2dkXPfUh/9ZKV3ZQbZNactPD4ql5Qg9CxSBnIwzlj/tseQKWRstwNbf17neGwDFFWdm/8f+nDWt/WlKV3MUiAm3ci6xXMDSL5ubPXBg/gKEE7TsZVGUcrIbdXILcMngvGs7unvlPJh6oadeBDqiAviIZ/iyiUMdQZAuf/YBAY0VP1hcgInuWoKbx31AOjyTN2OOHrlthB3ny9JKHOAc8BMvqopikPldcwIQoFxTccKKIeI815GcwaKDLsMbCsxegrzXl8E0bpic/xffU9y1DCgeKZoF2PIY77RIn6kSRdBiGd8NtNwT74dyeFBMkYraPkudN26x9NPuBt4iCOAnBFaNSKVgKiZQruw22kM1fgBKG7cPYAxdHJ8M4V/jzBn2jEJg+jk/jjV4oMmMNOpKB5oVpVh7tK529Z+5vKZ0NSY2A4YdcT0x4BdkoNEDrpsTmekSTjvx9ZBiTHrm9M/n/hGmgpjz4WEjttRfAEy5DYH5vCK/9GuVPa4hoApFaNlrFD/n2PpKOw24iKujKhVIz41p1E0HwsCd/c17OA0H0RjZi1V/rjJLexUzpmXTMIMuzaOBbU4dxvQMgyvxJvR6DyF3BaHkaqT4P3FRYlm+zh8EEGgmkNqD1WRUubDW62VqLoH8UEelIpL7C8CguWWGGCAIDPma9bnh+7IJSt0Cn6ACER2mYk8dLsrN70RUVLiE0ig+08yPY9IOtuqHf/KYsT84BwhMcVq7t8q1WVjpJGNyXdtIPIjhAzabtrX03Itn29QO3TCixE9WpkHIOdAoGvqCrw1D3x9g9Px8u0yZZuulZuGy0veSY34KDSlhsO1zx2ZMrpDBzCHPB4niwApk6NevIvmBxU3+4yaewDvgEQDJ6Of5iRxjAIpp9UO8EzNY4blj4qh8SCSZTqbe/lShE6tNU9Y5IoWHeJxPcHF9KwYQD7lFcIpcscHrcfkHJfL2lL1zczKywEF7BwkjXEirgBcvNWayatqdTVT5oLbzTmED3EOYBSXFyb2VIYk3t0dOZWJdG1nP+W7Qfyeb8MSIyUGKEA57ptPxrPHKYGZPHsuBqQuVSrn0i8KJX+rlzAqo8AawchsJ26FckxTf5+joTcw+2y8c8bushpRYEbgrdr64ltEYPV2AbVgKXV3XACoD1gbs01CExbJALkuItjfYN3+6I8kbiTYmdzBLaNC+xu9z/eXcRQV1Lo8cJoSsKyWJPuTncu5vcmfMUAWmuwhjymK1rhYR8pQMXNQg9X+5ha5fEnap+LhUL1d5SURZz9rGdOWLhrMcMKSaU3LhOQ/6a6qSCwgzQxCW2gFs53fpvfWxhH+xDHdKRV6w29nQ6rNqd9by+zm1OpzYyJwvFyOkrVXQUwt4HaapnweCa7Tj2Mp/tT4YcY3Q/tk1czgkzlV5mpDrdp1spOYB8ionAwxujjdhj5y9qEHu0uc36PAKAYsKLaEoiwPnob0pdluPWdv4sNSlG8GWViI+x/Z4DkW/kSs2iE3ADFjg4TCvgCbX3v0Hz0KZkerrpzEIukAusidDs2g/w0zgmLnZXvVr5kkpwQTLZ0L6uaTHl0LVikIuNIVPmL3fOQJqIdfzymUN0zucIrDintBn6ICl/inj5zteISv5hEMGMqtHc2ghcFJvmH3ZhIZi34vqqTFCb9pltTYz582Y3dwYaHb9khdfve1YryzEwEKbI8qm62qv+NyllC+WxLLAJjz0ZaEF2aTn35qeFmkbP6LDYcbwqWxA0WKsteB7vy8bRHE4r8LhubWDc0pbe90XckSDDAkRej0TQlmWsWwaz18Tx2phykVvwuIRzf4kt9srT8N7gsMjMs0NLAAldabFf2tiMoaaxHcZSX51WPc1BrwApMxih227qTZkcgtkdK1h314XvZKUKh/XysWYnk1ST4kiBI1B9OlfTjB3WHzTAReFLofsGtikwpIXzQBc/gOjz2Thlj36WN0sxyf4RmAFtrYt64fwm+ThjbhlmUTZzebLl4yAkAqzJSfjPBZS2H/IvkkTUdVh0qdB6EuiHEjEil5lk9BTPzxmoW4Jx543hiyy4ASdYA2DNoprsR9iwGFwFG3F2vIROy4L5CZrl230+k733JwboSNBKngsaFPtqo+q3mFFSjC1k0kIAFmKihaYSwaSF7konmYHZWmchuaq15TpneA2ADSRvA07I7US0lTOOfKrgxhzRl0uJihcEZhhYWxObjvNTJ/5sR4Aa5wOQhGClGLb746cJhQ2E6Jie1hbGgWxUH7YSKETptrTeR/xfcMNk2WM12S0XElC9klR8O7jLYekEOZdscP0ypSdoCVZAoK+2ju2PHE869Q9rxCs9DVQco4BriiPbCjN/8tBjsah4IuboR5QbmbyDpcdXVxGMxvWKIjocBuKbjb+B4HvkunbG0wX0IFCjQKoNMFIKcJSJXtkP3EO+J16uh4img0LQlBAOYwBLupu5r1NALMo0g3xkd9b4f7KoCBWHeyk24FmYUCy/PGLv0xErOTyORp8TJ5nnc2k1dOVBTJok7iHye9dwxwRVP3c7eAS8pMmJYHGpzIHz6ii2WJm8HMTPAZdA4q+ugj3PNCL/N45kyglqvQV4f/+ryDDG5RPy5HVoV9FVuJcq2dxF9Y0heVoipV6q1LyfAeuMzbsUV+rsSBmCSV+1CdKlxy0T0Y6Om0X6701URm2Ml6DIQgJ/3KO6kwcMYRrmKsY7TfxWhSXZll+1PfyRXe9HS0t1IKTQMZL7ZqQ8D/o+en57Y9XAQ9C+kZYykNr0xOMxEwu2+Cppm69mQyTm3H7QX6kHvXF201r+KVAf354qypJC5OHSeBU47bM1bTaVmdVEWQ+9CcvvHdu8Ue5UndHM+EeukmR82voQpetZ7WJjyXs+tPS60nk09gymuORoHNtbm0VuvyigiEvOsyHiRBW7V6FyTCppLPEHvesan91SlEh1/QEunq+qgREFXByDwNKcAH5s8/RFg8hP4wcPmFqX0xXGSKY087bqRLsBZe52jThx0XLkhKQUWPvI18WQQS3g2Ra1pzQ1oNFKdfJJjyaH5tJH6w0/upJobwB8KZ5cIs9LnVGxfBaHXBfvLkNpab7dpU6TdcbBIc+A4bqXE/Xt8/xsGQOdoXra4Us5nDAM6v2BNBQaGMmgMfQQV+ikTteSHvyl8wUxULiYRIEKaiDxpBJnyf9OoqQdZVJ8ahqOvuwqq5mnDUAUzUr/Lvs1wLu2F+r4eZMfJPL4gV5mKLkITmozRnTvA7VABaxZmFRtkhvU5iH9RQ1z26ku7aABokvptx7RKZBVL6dveLKOzg0NC7HAxcg5kE1wuyJiEQLOpO0ma3AtWD2Q2Wmn2oPZeDYAwVyEpxuwDy7ivmdUDSL95ol3h2JByTMovOCgxZ1q4E5nwwa7+4WtDAse6bDdr27XgAi5Px3IWbyZ/vRiECKwOMeJSuIl8A4Ds0emI3SgKVVWVO5uyiEUET+ucEq0casA+DQyhzRc8j+Plo0pxKynB/t0uXod1FVV4fX1sC4kDfwFaUDGQ4p9HYgaMqIWX3OF/S8+vcR0JS0bDapWKJwAIIQiRUzvh5YwtzkjccbbrT9Ky/qt5X7MAGA0lzh43mDF9EB6lCGuO/aFCMhdOqNryvd73KdJNy3mxtT8AqgmG4xq7eE1jKu6rV0g8UGyMatzyIMjiOCf4lIJFzAfwDbIfC72TJ/TK+cGsLR8blpjlEILjD8Mxr7IffhbFhgo12CzXRQ2O8JqBJ70+t12385tSmFC8Or+U8svOaoGoojT1/EmjRMT7x2iTUZ7Ny02VGeMZTtGy029tGN1/9k7x3mFu63lYnaWjfJT1m1zpWO3HSXpGkFqVd/m3kDMv4X9rmLOpwEeu8r6TI6C2zUG+MT6v90OU3y5hKqLhpyFLGtkZhDmUg/W1JGSmA8N1TapR4Kny+P6+DuMadZ9+xBbv06nfOjMwkoTsjG0zFmNbvlxEjw+Pl5QYK+V8Qyb+nknZ0Nb/Ofi9+V0eoNtTrtD1/0wzUGGG5u2D/J1ouO/PjXFJVx6LurVnPOyFVbZx7s3ZSjSq+7YN3wzTbFbUvP8GBh7cKieJt56SIowQ2I577+UEXrxUKMFO+XaLLCALuiJWB2vUdpsT+kQ+adoeTfwOulXhd/KZ7ygjj6PhvGT1xzfT7hTwd6dzSB4xV70CesHC0dsg2VyujlMGBKjg5snbrHHX/LNj3SsoLGSX+bZNTDDCNTXh+dCVPlj4K8+hJ/kVddrbtZw26Hx5qYiv3oNNg5blHRSPtmojhZmBQAz8sLC9nAuWNSz1dIofFtlryEKklbdkhBCcx5dhj7pinXDNlCeatCeTCEjYCpZ3HRf5QzUcRR1Tdb3gwtYtpPdgMxmWfJGoZSu1EsCJbIhS16Ed97+8br4Ar1mB1GcnZVx/HPtJl4CgbHXrrDPwlE4od8deRQYLt9IlsvCqgesMmLAVxB+igH7WGTcY/e3lLHJ4rkBgh2p1QpUBRb/cSQsJCbosFDkalbJigimldVK7TIHKSq2w8mezku9hgw8fXJxGdXoL1ggma52kXzjP78l0d0zMwtTVlt0FqnRyGLPGEjmICzgSp7XPFlUr7AeMclQ4opqwBFInziM5F8oJJ8qeuckGOnAcZZOLl1+ZhGF17pfIuujipwFJL7ChIIB2vlo0IQZGTJPNa2YjNcGUw+a/gWYLkCp+bOGIYhWr08UIE709ZEHlUoEbumzgpJv1D0+hWYNEpj+laoZIK5weO2DFwLL6UBYNrXTm9YvvxeN9U9oKsB3zKBwzFFwDgid5ESMhy68xBnVa55sCZd+l5AnzT8etYjIwF/BGwEx1jjzFv32bk6EeJulESARh8RZ48o7rKw67UZpudPa15SDnL8AL8xMV2SC0D1P53p190zhCFkMmEiir2olwxcJppl/kLm6/0QSUQLNaxi1AC3Pg1CTosX2YQr73PjEIxIlg4mJ62vP7ZyoHE55B0SX9YrrrCPtNsrJEwtn6KOSt7nLT3n3DLJTPbLulcqQ1kETP6Huts29oP+JLEqRGWgnrqMD+mhCl1XCZifjgQ39AeudE8pyu2DqnYU3PyPbJhStq1HbP+VxgseWL+hQ+4w1okADlA9WqoaRuoS7IY77Cm40cJiE6FLomUMltT+xO3Upcv5dzSh9F57hodSBnMHukcH1kd9tqlpprBQ/Ij9E+wMQXrZG5PlzwYJ6jmRdnQtRj64wC/7vsDaaMFteBOUDR4ebRrNZJHhwlNEK9Bz3k7jqOV5KJpL74p2sQnd7vLE374Jz+G7H3RUbX17SobYOe9wKkL/Ja/zeiKExOBmPo0X29bURQMxJkN4ddbrHnOkn6+M1zTZHo0efsB23WSSsByfmye2ZuTEZ12J3Y8ffT6Fcv8XVfA/k+p+xJGreKHJRVUIBqfEIlRt987/QXkssXuvLkECSpVEBs+gE1meB6Xn1RWISG6sV3+KOVjiE9wGdRHS8rmTERRnk0mDNU/+kOQYN/6jdeq0IHeh9c6xlSNICo9OcX1MmAiEuvGay43xCZgxHeZqD7etZMigoJI5V2q7xDcXcPort7AEjLwWlEf4ouzy2iPa3lxpcJWdIcHjhLZf1zg/Kv3/yN1voOmCLrI1Fe0MuFbB0TFSUt+t4Wqe2Mj1o2KS0TFQPGRlFm26IvVP9OXKIQkjfueRtMPoqLfVgDhplKvWWJA673+52FgEEgm+HwEgzOjaTuBz639XtCTwaQL/DrCeRdXun0VU3HDmNmTkc6YrNR6tTVWnbqHwykSBswchFLnvouR0KRhDhZiTYYYNWdvXzY+61Jz5IBcTJavGXr9BcHdk/3tqaLbwCbfpwjxCFSUs1xfFcRzRfMAl+QYuCpsYGz9H01poc1LyzhXwmODmUSg/xFq/RosgYikz4Om/ni9QCcr28ZPISaKrY7O+CspM/s+sHtnA9o9WgFWhcBX2LDN2/AL5uB6UxL/RaBp7EI+JHGz6MeLfvSNJnBgI9THFdUwmg1AXb9pvd7ccLqRdmcHLRT1I2VuEAghBduBm7pHNrZIjb2UVrijpZPlGL68hr+SDlC31mdis0BjP4aZFEOcw+uB17y5u7WOnho60Vcy7gRr7BZ9z5zY1uIwo+tW1YKpuQpdR0Vi7AxKmaIa4jXTjUh7MRlNM0W/Ut/CSD7atFd4soMsX7QbcrUZZaWuN0KOVCL9E09UcJlX+esWK56mre/s6UO9ks0owQ+foaVopkuKG+HZYbE1L1e0VwY2J53aCpwC77HqtpyNtoIlBVzOPtFvzBpDV9TjiP3CcTTGqLKh+m7urHvtHSB/+cGuRk4SsTma9sPCVJ19UPvaAv5WB8u57lNeUewwKpXmmKm5XZV91+FqCCT6nVrrrOgXfYmGFlVjqsSn3/yufkGIdtmdD0yVBcYFR3hDx43e3E4iuiEtP3Me9gcsBqveQdKojKR//qD2nEDY0IktMgFvH+SqVWi9mAorym92NEGbY8MeDjp553MiTXCRSASPt+Ga5q7pB9vwFQCTpaoevx0yEfrq9rMs3eU6wclBMJ9Ve8m6QuLYZ58J41YG3jW/khW92h6M/vbFIUPuopZ6VVtpciesU74Ef7ic8iSymDohGeUn4ubT0vRsXmbsjaJaYhL8f+8I5EiD5l680MJbxX/4GYrOg4iPQqpKp0qddSu/HKtznHeVyxgTwhfEORMCwnaqetVSzvidaWN9P+fXtGXfEP9cTdwx2gKVfDdICq7hecgRhIs0qlCt6+5pGlCc6kWoplHa/KjP+FJdXBU/IDoKMxRjFhSYkggIkhvRKiN/b2ud8URPF+lB87AGAwyMjr/Wju2Uj5IrppXZWjI3d14BdKE2fhALyQPmHqqA+AXd2LwvRHcBq4mhOQ4oNRWH7wpzc6Pggfcbv9kqhLxrJKEaJqA6Rxi+TDNOJstd5DoRVCDjmVspCVyHJsFEWPg9+NA8l1e4X2PDvOd5MPZAGw6LRhWqeZoSQcPf9/dGJYAyzCmttlRnx0BfrKQ/G9i5DVJft9fuJwMi3OD/0Dv1bRoxcXAyZ0wMJ6rwk9RjRTF4ZK8JviCCNuVt/BqQYiphOzWCpnbwOZt6qXuiAabQWrS4mNXQ7cEErXR/yJcbdFp5nWE1bPBjD0fmG3ovMxmOq5blpcOs0DtNQpci1t+9DKERWAO53IVV/S4yhMklvIp0j0FIQgwjdUptqmoMYGVWSI5YkTKLHZdXRDv9zs+HdFZt1QVcdlGOgATro3fg6ticCrDQKUJC7bYX50wdvetilEwVenHhlr85HMLRLTD6nDXWId4ORLwwe5IXiOhpuZTVTv+xdkTxJofqeCRM/jcZqQlU0gFVTlYlfwMi6HKR2YG4fQ8TOtgR+yV+BMZb6L5OwDc/28/xdfD7GXFaVA2ZSObiIxBwT2Zev637EuvpM6rxcogdM4FJFa0ZhF7nrqtNsqWg5M7hZMORpjd4szf/wS+Ahs1shY54Ct5J1dOBO4sdEtSnRc0P9PhgyOCt6aQW98R22DpAcNTDe72AHK40vutKTPfpokghRPuGvz0dulBPKfC3O4KVDCyWrJGO7Ikdu06A0keKlVfi0tGcpO0NhzXEh75NHyMysAMV19fq7//sPC0For1k2uFEvq8lwrMAfmP7afR69U2RqaILHe7glpc8HmVf87Qb2ohsw+Di9U+ePdHLecS66MhB/0OwdcXR5WBcWTZLGq/kiAaT+bzkjR8GIpWdv6pfIgQ+Q0xdiKvo+gNB7/Nf9knNJGxnh7LeZEFtMn517tNc74PPS0M4K3I6HHZqNPA+VZcBc/g5a2ARyqKrJ4Z3krsuA+VOJJz2KJpBMgCCWFln3u7k6/q3DETAubKG/pt3ObaNT0NI0Qug90L2ip5dHnZJUjPTvK5E96aX/4mRU2u8n8kh6MKbY7ANBro3huF06U+JvfyELQP25oIaj+n0ITQ4KT9rXZD4EtBIOj95fYNldDN3io/VMIvWNj9P/b95WEMq8UAVfG2XG0N6fSYdnBEC7sUEbatbDICH9qA8TTuW9kEt9DlFOZFP7bdfYLa/khSY8W5K/AkIIAPXtMvyVKyESjKx9nfragssxC0jFMVY94d8lOAwRocdS/l/P43cBGa3IqDa0ihGPcmwS8O8Vj16Uy55rOrnN0shhRJZdW8I7F0Q0KeHc35GFo4aJOFc25gNafBu1V/VO0qS4Qkb6wjRrnlepUWjtYyaDABZceValuOMtoDdeIITWKOJiwGPpB12lQgwkmXh9M86podb0D117mNQ8ElluFvbaS8RTKQ6lyj88dUwoJU/ofOeubhoXWBF8eNumkVJu+As3ED/AvLlrV91UowIWI2m8HBG+a3k247ZKAGYsOcWe7fTWqL8eqwM5ZFuoXbeugPKuMOAtOsN+4dSwkhrSAlfGNTzFwEmCNWtzpa9CgPbYNcmoHtO8pj8qMvlGET6nrkJoQ2lp5MEUV1E2A4ZH70JUlCLXvqTIpZlzyxdr5p/GZiD1/BuFOGbyfFzhuxaC/l3lC2jjt6GNRBa06AqqPlYtdA7kiidYa5Qi0/XpXiMDyMXNOj3kmJEaXufW0GO8+DF8OoMULX1vvjCePKNis4AmxQKLCF+cjf/wyilCJvuiyLVPSdsuRTPZ0AhpdDF/1uFmDwG7iP3qYwNsKzqd3sYdnMolCOuQOIHWy1eQpWhuV+jmSeAC5zCc0/KsOIXkZPdiw8vtB33jEBpezpGDBP4JLY2wH1J7Fzp8y8RICqVd25mDT2tDb/L1mh4fv9TOfDH5dTeATqu+diOZi+/sIt18hiTovPsVQVaqXLPRx/4R/uH/86tBMcF+WBkThKLfblcVCIECc8DgNRVX97KdrsCeIK+CvJZMfwrftcDZDZyp7G8HeKl7bPYnTKX88dXAwAyz66O2chkPDHy/2K2XcT/61XnlAKgPwtI8yP9Vu45yh55KHhJu93mL4nfo8szp/IyDjmFHtSMqqoWsj8WaVhbjXgzZxcqZcyOe7pUK6aXF/Y32LnBOt0WN28UmHRiOpL525C63I2JQPX8vvOU0fz2ij74OeJ1Apgu3JRObfdo9xGDpp7cv3TdULEfNS6Gu3EJu7drBsBsogUqUc6wAUW3ux0/1hLVI/JEKJrAGm8g72C2aJSsGAsKFW4CBvBXVlNIKa5r7HvT1BeGYBfxTR1vhNlFFNN8WQYwr39yT/13XzRGiF2IsfE8HcN0+lN1zN/OnzekVBKkFY11GgrK5CLxrE/2HCEMwQb9yOuP2rTXiZzTEETp/ismFGcTWmbM9G1Sn2D/x3G74uWYZY4rgKB2Zo2bTKS6QnM5x1Yee66Y1L7K44AyiY5K2MH5wrTwxMFh+S8LzNQ25z6sunWZyiRwFIIvSnioltUXNiOr+XMZ6O9h9HcHxZJkfF0tUm6QkU7iJ2ozXARitiL86aqVsMOpmvdIBROhUoanPtCjgft8up3hAaKpw9Qs9MzYtBA2ijHXotzarkV3zKEK0dFFQUwT74NgCmGGuSCEDmFCezXPC9BhyGhmzNa6rQeQQz+r9CmGUZjIQEPsHwe86oCOQhWaHERsv5ia9rZvJ//7UXO7B329YUkLLAiqpLRsVV5XpcfdawlJqi/BVcCqO6dr9YJTFFRMVGhfUbB9YWNvYPY6RyaydAFYq1YIBQxuNAGfYWLMAHtt2XRHoOKCLz+qf5HCVBDOPOktQ3SdJBfxUkaiD585bmTzMwU3oeXUHZ55EC99Kz9kk4ZXMIENwVVpqW2JmGIcUiutIMj2KkpjE2QD+dIZUCxcX57kH7hiuUPnKCTdaw4KN95XPeFRvMcvo5L8LexWqvaJPECzwXCs/4XPAlSMpWUzBBjK3pEnkbueMkMJQrYcnXf7PjbAoJra1VLX4YuscQLpaeYWbT+h24hCFrfcHjxxx6WTSe4AGY/KHRZCQKqTuFWt0D8RmGWmvXSdg1ptIefYPshuIVZT7CV4Ny67fvjJugy0TNYHqoCO45CB88kxrvIsih19DqjD0UqiJsTFPcGW3P/ULOG3nb8CjpgVTIoa5nO9ZYEX4uEHu8hLXrJPjV1lTQ5xTdZVagg+Wj8V0EE4yPsTc345KM6lVXqLiHtm+G6edC4GVEiPgd98g+twSYm18gCsPnjqlLcFm9e72CLJbYD+ocIZOxuVjrX6IKh9fh7WqdIZ66x9PWkDGOVVGkx7jM76Ywe16DX9ng205kg5eq+R2q2MguTJxYv/wWHliD9mOYpzZKNXYC3Wr4iBGkm54hBwkPzFhiX/VBHdVH/KJ1ZIMOHxIN6arKdxrm6EBsgwDt0mPe0MX1HRUMq8ctcmysU6xX0bzM1J07kAvq33jw1q0Pq2cyMWme8F7aVkfhzZEFdyi8fVBQav0YZqvAjZ83WKH726rBx5Bn7GHFthR6H4lFsltu+jWmsAibJ3kpWMG/QbncU7n9skIBL0MuXXtj9sJg+4Dl0XhKJ1LcrMydaIgyrgZgScP4k8YQvcsBmD26X1iYXKLzMYfZn2IfRjznsrJ1e5cnl/3a5xiNoI6n1x1U36FWckJbyx+hiSZg0QqAqeeSvzFYMlZ2REnO/a6yoQhu7PdHMYEPFIvfyGeyCU8e7rpju4DrlOhszj9rOIpNsvCkuD+TLyf5J7D/wsPkBpscFVI1q7oUSU9bN30vH5AqnO7bsf+9rGhtVjOJQ32H9hHSAzR2ape4L0Cz4WxaySm4jvuGXwkFp5NMMLrgZ8LdA+5uLuyxO5SMOmJNDBcbbLefv7z6LyxBwltnfQLd7qqpG1MmNcoLUcx73BkNF/xpdS0cKd6G646ntChXSeTZJJTFYGw39T7fqXDPKoG2cF7/ZcTvME42gXLVjTqzAER1Rt5m7GYsh0X0+XgOeW9MJqE5j/rpGzY6vUu6ACcCTzDMdZHiWELpDnvgE1hmztLcSYz0MtNyUBLqvylUJJnJu79Sku9NMHCTkgqozTnhMFfduV2NLCSYvAI5HUvQp1h/M02vKFD6eosIkGTg6mujUo1W8hy5Knf/erkBQC9LzNqPAYCgR+hczgevta88NNqSlBZryq9QNeUK7RpbvHjoNhUKAAeNYH55LeTW36KyFaXdAkBvyNP9xmRuBokPi2OhqDby6IZ61mwfzG+GmACkS+G80A4WGON5izgJWeeDK91jzusfOi0RmEsVJXwbVUr8u/J2LCQaMnHhi+wJTEPN9tS2b6W4GRGCNmtjAMgPsP357nOeD3H2tcDAPu5xQBKMHf/j4ZhXlkvvy3YmBJsjsd4pSOlfPZCnw5JvzxEXM5JIc+E2mU4CgB0mdJnH4NEsCHYNeVRDXFNuyZUE4nuvaJf1h+11AWLdAZ72D9XNRcxfb2+XHZN/SN48U7yl+sNZhg5gn/PD8wkBtnRj1zBUPIWnoMP6yGUEEzuT+VaX3x2jEIZAZsr3rs9wCfY1Ss0EdIFFzBbyruUup4EPanbSYew5tf16/ZWVup5iykttuqL4xoC/jdZWsAZeSfDSd3fP9kbyAFYXkf0Q2lmxaTkKRZrCo9XCoiUG4yP1URJ5G7+HSOhhJp0Anz0N07QZtyFUye6rcgiOFbtyoO1lkuV0iQ602MTyFK9xLqNHtNy4cJaTO6hjtiwNynVc34ZA6H7k8ai6S6eF6jIG0xJx+JfP97lzuCZr8vU5SIzImaNpiQhyvDbz23//PJcOk7hD4iIvJzfIgOGIR6ZPEJpWHZQoacbF+omeHw8aWHaNOfaIyGeG4lEryMfhtNmWh4RAIpn8dLs7ZE2eTVDwK++xDoSUgh47WDmKlZ/k6OosEUoQjk7Q+Kp7OxwgMFShAv6z4pTW8loVj2+qXLQ0T3hmIue8qHy1o/HXjm089m71t6mrrUyDftqMYtmfvQXKDlZ+K1HR/FkqPSqcjGlcPPIwbMw3wIFKBdVMJ4pFLt+oOIkWZMw8pkoYZ3byw4LmAF+7BdicGXFcb5PWtDw5XNNVc6eB9dv0rAEpgr5J+bLr010bpfGw+IkRoxDbkDFmQdEQUSElP5bViLo1ur/23KN0jEwl+rGC6AUMKxHcv+T9F1Ktpn8jSSrKxJnVkK8UD/tH5DN6nXB8mjUdFU539e9ywLtLYCwmHYVEVqnFmdubduaSd1ivIo4pTsX+mJcOAkrR1D60RIoocCBIdwJhCBM1rOE2XSlPo0U+khALvw+zfxYzwzd4roWlLJkZheFRR8QB8v4USwmAcDswUZ2P/7v7Xa51Fs7orYebYyww4YW5869Y/c6Kq2eTR9HLSjYuChTkXaDygoo8nz/yJ0KzfX8oowaNAwz8HvQdlLU9V9hjqYMURyYvPzZ60G0itmUdZwB+sY6rUkMAZZtWStbDFmnk/dQorhwr3121XQWffrK3as0g29ASwxbsZ3dZAq/96b7/XWckbjmo8+jwdE680DzoEUUivnBgowMuBQxHXoGyp+w/cSGY88rWtmwoyNNIvChs/QsZRnbdV7y8x7t2RkliJV/j8e6qfctrTsMV22zoqgQuTSNFh7U7p/Q49L0kygXNnEYXCBDgi5BeNWxu7VjULcUHI+lGj+OTCEATzWrDmaynq3wT9IAejtvh3esCu6sEu9JOsXxMDpqxm4Tzl+pt2Wa5Bq3TM5TKH4N7KLir8FGIPA569+uJ1VEL3fW8Jyigz/nEUjAVYrdCWq2MnS4hQVgcvXq9aF7Xke/k++rAtIQqckPNwjKrV2t7HCOrA1ps88Y5Rw1Zp+9itnB71j8tNiQc7mV1kUCQXkoi5fOsq1uC6hUPUL7Z69NAM6lg0c/aeiifHoi35v+pVBh7CDM1XfvYpiK5JIbIQFHafmnhHfRTnMagKcjdE7zzgtxkTPKVrObTySTT51g9bB5ro/dzn/sB24fNM2LGJuRQsmC49PLi1jTRfZaLpo8Txxxczij5Pl2vur+S1wQW3W5qyVcIUySZHtFDQHv+EYDoZG1T1J7D91vEIV8dHzUBzW1UyuxRbP+M/CM/vsas6RzmS5traXnQ0Jzv9hYXxKHcs15TQCP744XsLjzFjILYURXFnhM+nnV0iO6nwls9TR4tlz1J9/NvE8FGg5mgpZA4htS05AK0NnU2gxuqf2vjCyWlm3ypKvaX4vxh8Um1MHGB2NTeAFhbDyGm+5w2zqJAWxVlj6dVePb5yR+aMhuz05YubCQJ0BOtoYQ6PoDoW5fCwCtXj5SHvCgL/3B5z2mcXWaRTf8/GsFAfX/ntdWZWFc2xg8MJeenwZ4dZUToce43If4zVb1ex3BMAWGhgkPwR5EgktZhW3Yi+nsnZTUr9FYI160YhAraB0zMV+ouHz6hYm25/ETDM0MTmcypoGgZISSkfwYAQaHGY45yZ91K4A4Mm4fnbMk8GTc4orypT3NLBqAxYdcY/qCH82PpIkmVOEHi1NoYaUymuImLLcib5pmd2MHTB3JR+4rLdRc3gtQ9zeFdciciRiWviu3HkqaLSxJeI2rgc7OKQslItumACQow89elXmi4P3gTZeCauvMH5nF4VrBcLjjwGD+KlKqe/RWIEgT2wGqAgSuL6b+RTTPnQZzxZ5y5HQJkEEKJp5NfoB8hJBM8qn6xbOFtyzBjVBrwSS1zCJR3lEc9ODQ5Wu/xct9/2Q6qLHnmNx6XwZus/i8rEd6UsVxGtoDrm+Br0L5oUojlwdcqyVV4PIMsR60JhZwJtgX7izQWj+GOeF9DA8Wexdmv6DWjgR8LEBp9YuPAM8tJDu3uCumNqHnF2ATYX/tuVO55OgQuiUhmDmJbF9jJyifBRtxOVI9DCNLUY71IXZYTuiYcnILQ/XHuVJ8aHDStL0N+3eYNvXwHi2vEiTPnBqzsC4TsPnFVnYY042j5i7C11AVdBZ1pGSa52jM9dIL119rry0mgGxFzI8xPs+7bmMfYKh37A4HtA081olG1m9S4Zch2hoNCGVvVhd6UL7C2d5hKIBHoB+Uxarq/4aQXhh7IWjSj+ca7Vhqb4+ZwY3nHXh2S9JH4XZxQojbe/eINxYlozTYtT2rpU/xbj+W2hXjFQ+z+dQ8wh9751MP0UpjutQdxz3/FJYAEG5BF400JXWCBs7KrCRf/l+F+d9EuwVk6thOPDB+HNS9iWlLmDgXvY6K0vgiyoeA3An+jWufdAG1suUMBuJT+/w0FNJZbObUT8c5q5WtQxASQF6E+/u8UwVBs1eo8jTamCrcdhZJlADJbqn3crcDHQlBQNGq7btcGKiJXW6q0cn3F0xzf+k1JJS2testB3rx15ZPTDXm8QV5XE2qxBOdM2n6t5YbxyNOmEdsHx+hMp+y9pWkcgw1NikeXuafJvzcjaNwE1Ad6gG79S68aO7jWpKgBETYLmV4ONHhBk7Be8tjf2WVvWMDQvQdOnk448yeMv1tQKU1xev0L171e/qxkMZbmkfKnd29XRCK2hgNNJhwt1qiYWZGKz7Di6K3fGDT7DO2YQ7WU33svE/WKGbWQEvzUV2w+VNYDocI4yxQ6i3i4zU2TjmjCwu5Pk+Ja9HSwLpEoUswq3tFJ1jimthgMXd7KjSl6Qd0K+vxWT8G4/+xITHsWDGSfQTSdFQth5uVVfa8wrkDZHTGVgpJys2ik+3I0dSf6TNo6A/sVptyY/kx1hdAWKPI6t/xj6s+fPMU3hg1vkEB0RRHq/tCy3KUUhzU/d0JKxTyjvUms5iy1GbOFco0NA4t83SK9sBmtLWm4kOLLflyxqgQYP08iyXwYXzKnlQ6VTipuaspSJ9g5H5Lu3eLMnPKbhcwuEg0VZ80ppJWjUnhS3rL35erzysp+fJhxsUs86m28/UwW+IgrS5Y0zWaxlFJ8xML5wk8sg1ragF+eNajyI0Y4mwStxt1RZH2BjaAhvu+SnNNIK88thEgZEsoHv+ii+OMmXJL7dnAiINVDz3tCnqDgpQX9OguNGgZj3axcjq1UgxDw785yNIpqNiLgv57399jVmJ0/RStNswaFIs6FtnkilFZldxj6m562jL4p5g3Y9XCiXRJX6nq2PGJFifFR7EyPG4jDMnBM4t+O8ZpEp3th7TCxEw+ZG4afHl4sNFaqxyLh6+979tt0Aq9BrqI+CS2U7HJoKiGmyVU1lFa3/0O5mNC1bzRgNMy+GXyifLwJP7FwUSUmxmVRpn+gnXWoIuswPutsiciurvN6lsMG7yqEc2Y5ZI3jrPgPq0xEKPZpF7teJa0TQn8BQL4Th+hjv2ByfwKookyXEmj0d1KMcsmfKaeKK3cZZubiYqmSCrnGpYTwgPk5itKucVtjViuswQsDR6TuyGSIHYvlz7wkLg1Rr0K9kV1o8RgABlhbLrN74cVWJW6TnfXN0q12JFMpUbEa8t1+j440FA+17o8qa8PQ9igkctVROVIfB3jU5vtGm5pYYHYSDvU2TEc15pIz19ka1q6c/7WXfF8+POkApdOw7nn7Kqz6V4tru7NXgnA/u0g6+fPRT3hp/QrDQwMsjwNCZxdWrR6pgCBDJNc7/KAlwC0UZ4yWQs0KsuwbbOgcTxQPK54wiXr7s+221hzZ8RVxfoRUKM3e4lpxHC83JllxlrV760tl06f7/65qhE1jhMfivAUXIXfRMe3uY/G2TpWYzDrw5Cm5cS062Bx9lhHq9gtJp8xZwAtSdSuW/Kd7+orEAiswA76N8ezmVGYgNaYlQ/xk930LAWAtKVBC4U6R08L45IohB1kFia7XJs0TcaT2zBZoLFuOGu4iJaoAnfjL3uS6gnRH7G7A+aT6ETlmkYUfgrBuaSLLDJfhPJe01PfN0oqBTeQURasl3N8BZiQSgdr0aDv3hPTiog4NSyfAUyy98WP7dnTDWQTY+Qwzgk1uxwRqHl5MpC/84Cuw1TXfRlgJrwPop10kCHjmffnFdxCe2J3R3J5j+3H/sZn3IUu3Suy+I+dAOMWvzwExNR3RRPVelZAhtarKlXPWNjPRIVP4JsAFSRXs3o/fSYAPaV/zP8q6DltH47/rYhCLdy/LrpOsbaLf09eACcClJosNefetNElkSFSuCgeY7oTAAl+8Y2zOXJb/bgEDpoDXfQqc6lnlBr/WsmVznkBS1M7ufiqpxvKXjwvR4WxLbh5NbMNy8LsnX4UiuAi8XonbSUcVZKQOWBYUecSOMj6jMG8gHu7WNreBHY90lV7FocDprSrSbexkAtMW9KlXcnrOyLnZdodGYdxz8aw71HztIqLhRdCOB6NyzHPoS2hDy6wLk0I5Jr2t+U0A+A7EsgSn/Ih03A5CspHnVF4MOic+Lck3m61Um+GHDEe4DrHBhmgtDlRQl1XJ/V/VumCHtUDDcZCkgjVMBOmVOGYW0Rcdi1ahdjhBcFlfjA+5cRjBop1aNDvdrf7CxkLVgxiCxhRctW8wczM8+kVmIrGtkaHGlr8y2D098HXE23r7fnJFUU68zyeyM265igNOGPzFG0dIgUDWN6S3ZcfMERJdWVvpGhVEHXNLeWqHiTcF3wOt0FbJY4XHEpmkoG9MQPJJ4ueQ01+MB+SR0rCSGzlE8zod19q75LlLWgzogpnJoD4gPxUYcX+Gpc5Ly4nk+Zm8LDXcNR7SNVxLh6NAcx8ekjb/AC7ADlRnfuHaHJaBodZr7RBX9FLTvocY6kY8bavdAkQicE9bbwGLkZu6whTCJ56lOvM39ijehpTOFqR3V53nQx4hfOvwRPU2y2w7UU8yiRbcyaX6jGJ9CRvl9ybV1tebTp5MMuMnwLcx/lven0w9T0atJuiUE2WtYGiVMaP3EchABl5AsyaCpu/BKAWDFvU2vaCL2/fJBKCKLjxG6xzT4Mh4wHhH3/EqsGSoQAHu2wbHmXHj2LvoW19GXDa2oyeKRwGG1PU+S7mE/S+UmjHiDF1oqJ0R5QsdjAZYN1MzpNX5YDqWYfhfdjAXyFQaVyGKkp1oEGTR8MK6jaGfRDFd41u2Ex8ac8jKPYu3pXsk8gu+m9tr1RVzTTuDsACW4S1h32yFHX7qpXSmA0QVEcR8W9j2Juu0pcYqTmdis88VgT3gq7iYue5Hx/3K6hFQa9rZrNSDcjaSQlNn4LSqs20bypnKqpzvnnxjMdz5StbzvoAJKgVZa4DLCVoJW765/KyTF4s4YztmAT1c0pTmKJHTpa106FegDo8p2zD6uOnwpYi0vJlRMDe9wPT6964UfAf6lq3qWypUOx9q6BbKEYt7K3gWMXDNN6wAm1fNnSOnZ4JkbPq7jLQrl0wL1V7QwO/sXneKGfTgUL28I5iPVG9dA2gS7Ki005JUR7Vmw4gX4TJvy1WS74cIXD08LCF5obqcZwamuoZ+FPMJEck0TLHjyH1baPr55/Cy0ptDfRJ7d89pbP48tLMHG5dO11Z8xSSpPGQSgXDWmpsNsmm+MvxJjMCi7OFDHxxpmTtjgnOCq+c7Fi1DybfhAntviKccz+sj+OPKPYOKeYYPLvq6MpUx/chSvBccg9dfbeqetQNCs3eiCFZTU1mrDido/mib64STMgsa+IKLk9PyxGGbVSQB9GsHto6f5prAFIbRDSItDedz3t5+Nn69FFS0nEfmkF7hKBmNVce5xv65USKGBoHYxJyutSGnRIq7vMDsAMvirOEJOzNi5Kt7fypuSU2c2Npo6UH5jMOkePH0TwgpammO3Fb2FX6f11309z/mqRmQ949HHRj/wMzKNx95M9pwKf+UQkMEwisL3YVotvHhCv4y00Ui0Ql8dR7tGqFcSdYtmoAOuAodkBNs4PZSjAAF7S/szwLddFMdCyB/dWPgFUiUE+WmUUCjYrKfJLQfNNpQ4NKaF57w7Kp/isZVwQPUJyjJavN3fQNKU+F74jVBJYQEcEdw0Niinyea0l9PJ1/AcTm/LI91RZjDvLI81pnat7RKU2P4/TnIAa3hIEfeg4iGQ+wTDlURK6YjNpN5s5VkQW9w7sDYKU4XmjyZsCQLxztqd4SDQvLyuPDhURAJXKfR1c7tq3mRu4usFHPqz7HgS0X7kNxiWWR3fb3uVwbgKpmgLYkwKrXKt09COw4MjhxeZlDXKy7nNLHXAIKPtferWQnZLboonQXK81x+BB3oUidBehK1swSXxVbscj/LsfONu/xYEXYPM3aMqIYd+2hAnFvDHbdrJLhGEd3sG5PyxqhzejhQJo9wauFK3xmPYqxB99J8zYU9/yzrEZNzzbvPoR9vUlE3Ha4zspVDzHHffPZMJ1VLZkKqGCf8ZqupqMt6T+NRPfmPm2xeDgvzMrRJEL4/zzlu7Z35smvzbgeC25VP2CUrZkRxEi15A0769ojdO1d7C9OG+swj1ROMM3NgKdeBADoRMeJkRZcZ1FbQu6C0BS9NNSaoxtFzYT4lX7+PQ7BKa84yrN+ujVVef+SgnEie1G0N+eOtbZF/UU+wkeerWjloYqFiqo0vBnmxh+TwNMo9I/8lfU2XTCT0K4OoWE08ipyNHjxHvfhY6qa3x4HzdQ8+jkiO5+j91YkihS5memfpFREHP/2veN5XcRue2zCVuAub8V6vDlOvyP+PBm+owyRhMmng5wwGGIXsOkQekXrXpE/6dFjkHwwoFoj5bIFiqp+4wHpSWRbv2xGrRpd2c87FzMP6Hfj/3LWIBqFiNOAxBw+AAP1XqUBszdZhzOSQrQS4Ein4fyV7MaGsB0VsMF4bPb4lx/foTGQRJv45LpoxDd84xCawHaX7jpXUrOdkFxx2oUvY2xqpgIvcVufwd+zAnaaVTnEyDXD7S/o/xrrk4mgTjXhcjj5Rzrbr23NmuZQvpdNzny5MCR9bwvIRIqzOZZLsstZSCDYa56JTvzxgBs20dYTtTUbe21uljlWqGfSh2bYAzOpf6UguK30ZxNXgLHs6Y6urtxFA5iLYvlue5mDONW0MOtQjhqr8fRbCkYneiDkvzHkQVT4F9v9vxh2SIGPBH8bZb8ugo/BSgXojeSdNXbBAIDsB6DUNSXnwlu/bFLaCqSbvu4+YLplwO1JbtrMf9ZUfsxerAZjB7E/zl3qwgK27FswemUmSM4i37YAVhQSocuV8AcDI/CSeCDNPavESshDQ8A/lVIrAJAMdP/rHXouiNU8RL/TIvfQiuZEb6dkIKMGGOW5kT8vO8pivWnT4v7qmwuJo52AS1r/RyQ2g/7c9ZJgmMIzf0GvJJRfMNu1utRNuLWHOm9JIMcJK3qiDtVpGCDP45W1oTTMUnMC91kYhP0GHjhCW8V38xhjHgFFBfuWMsmSQ9MvNqKXiqtUhDAkIy0PW7YSKaKUv6zctAiIk+Jt17kG6LpNVOeMvJnlVBaJSkKe0HTJJUMvf8R2zna35/yh2wNlWLzIP3BJR5aRNxkV94ICOlycI1/JYRZtzvWMNoIpQrdNvyBuBydhSwhRwPo079Xk/XQZpbhzN/KK4NbdJQV0JIMP+Y5UBIM3TTYlFGYVjcvA5yVozkimco91Fx/eo+ydgAx1gMezTh+bYxCtXPYkMoPdtaElRusxlmdSV9zgF4Np+iylun3LVxCycAFxGCFsmARf6y4I6zXY0tx81aQyalr3/ih+ZjxGNWdhItgNLdEZ/BOIJpPoAveh2bKbEFxU/M0+4xqDo3Ox8MnNn8Lmv15NJigSvJV+y2W/ZogEXNiv0/nuFzZGr0pKujOShzcdkEVlMw8mNZXZCbtM9V+mfawtLxCTvo+enFWhJcFv8LVTFycDjPGBXRQKNN+z68HJtYdpH++g5WdhQpCO+DE7Qdu6TmZgtetrpU2ZlgpslOx+4hb3aXaqbdc92LCh51er8vm1GQ9uWD9+fAPRV50ixhgc5zi2Jsg1xQVxzlaELRWJ5biyF+eCwNV0oFnTbBHr3Glm9qlGVOpoOsQC8hlNG88fxeAekkCGnHFn6i5WzyO7ShDYbZ2KM4eqndyy01v+6TFhmkxgc0dndt7EzRCcEfBxSaWZwcev6MDZcuvSZQ9CNSd4Tx25TY6UAbrhikuP1vNFfPdZhCG1pe6vx4D6Ez3zIb0zDa42FPpxWvIpEeXb7YTcfZOahSpSYaWLH/vq0F3U1KO7ZxliZpoMBBYJs91IE0bOkrPNQ/USYY0qKCO3CU+AFbOYxzKWBkIglrX34377BZ18MKQCv1KWfIHEeguSpvrNH5RQOD4LeiH2gdx1MOAKphlL41F4RpxaU4dy8xERFgqoyICQq9XmQ8WJSokwqvhQM0fLtsvyCO2PAkJ3BZg5IqoR5q/GdTLgOWPFR53Nqw9Ma5vBzZcQ4+iZgetmKg5ZIn+/7Jbi+VlViXuD9CaAUtdEmnwWTS7wZWuskVvc/SDaaKV+Jz6HrZTHo3UrAu0IZDBkXWmL+mTTjdTb1A+MdhKkY/hvFNwXj1FzUngsN58u/kTdJ3Xi0hy7efR6faAOi4SKGaiOty8lxDFkiD9wq2GW1EZEsoWGw/WzxXhWDzYY8CC7WuLFHc+x19jhH+FiLXwDIARRtnkJPF2BUPZ9+grZ3tjqAWhhN3h74w5pooRQUNATy05A9HDLnILGSCtfESoSilqtqAIQ/TV2t3KhOc+teDf5t+DqZDdB8Ob9YXyklrSO73pR0QAxPvQj57c6FIR5dOciqeHZ2LRABMROo8Jk8V6JFewCL8TCd/A5MSbXLky1cW7mXobqgeEXdFDoEydKo5oCuyn+2JYI/7pIGFAzErlHZ5hOaiT17HC3zp2HpJwsIAb4/oIoZ8x8ak43Yp83Ermq55Dg8HxKGHXbXs47sh0PzQELTGFsf5eO3lYAuJjMneoYWk8W/3tW2WLntEKBZEW4hOFgo8K58Rj0vk5KLyezu1d8SO/JcuxpOJqFUM2sxBmbQ/9qqwb90R0WulpR/Ju84bQ5/fTh7po/pbBb7AQaYNdK3fatD3K4TLHAaa66MQzp/+ZGyCjzo5OXRzJ8UHyg/YpNHvvlOpwQIOjakpLHwGV4WsLDPjEIqG23ily3LL0dlkYQxj3Xx0ApCo35zYGoGOtIclYS83MnI5TwVdQ+Hg453WFQN694DaqhGaL/dm0KncXYqXLi5polgT4DOrzD4oSVhrkh8GW2PaXjOFDCLPcn4RQj8dRGIJuV81LxMPZ0UL6zpkaebhbFBxcRJe38UiTbUPDjFWk2jBqzrBvXcKmgdDcmRyJhIpuq+3DQY464AlY42z2EM0yIK0I6b+VgpanMfpdWo7OxKY8RM5tSJv340/qD8SxrYsybMuUkF8fHj7HcvxEPC5YYrH4LW1YKg6QaeFZLvPbrHZHvi4OXLKkN8cGQO8019OKqcv6QnBlj01e7qS5evoGm53rv+VmDxxCXDiOrDg+IaPeMPrn8TJ1oReXYI3yb+4HQbikxP5TQXHk4YXPUv95+KmkxGsRgTwP71YiMpqNXp0loHZeXRp9i3euKrVtxMM0e6XAoACwNtcc6sOuhZVb1htBLudzahrDFt5GkdlwHjZl5y0LbvSHwII+qYeDwRKTTzyXaInHIM+8rc5TrjUlPRVwB5LKFpQnV8e7vLv7T7V/iJTW9h9TnRtNCSGcofBWYm5P7wZcAq3AFamEW/GMbo27ldz0plt5HI53ddWkn9IuCZY+Iy0MATUh3YenRTbVgdLYtu893SuN6EL4e9V4NhlzUjI8nOS6B99ecyC1Ot8sDahQpWHbmt2YvWGyL3S9tEVLKYs+LnghBmmSl2uPWfqPobPwBHNLW21LUjfZb7jfLMTsMp3icGO1npK/rCsUgdBVKVg0Ys+/WKuTmVJoC8Oe5h3PK1TQhbpZ2ytP9nlutQPtLAEt+CVT90DfVkn7lHLOX8AfS6HLzfHeAhu1alnl19RHKV1LI0G7RPzYgVaSpX7th9f06uo2WpxjL86i/2uzK2qj/ClHbGDyQr3F9/axmq4kJ7zZFVXVVwfiFr5bhUGVZeQJHKFAcsnqPKsb8vHyB9SpFpT9U1U7D4aS9vYgqajxhC+hOkolJV2dKAxysCkWBo3SPiPUrSQYZxOWwWCoQzbV0oeaDEcgUtqI3nq9TSmpQ688/+wb26P2CHLY1H7q5lypXSrnwnnztq/jN1o9lyvLmLyGguV0VJnDCREkiUNrZqGG06MsyA+Phd9CuFoM5M1Pyk7S6TJaHdTw0ni3n5ysAup0kyxr65lFc81NcH8xSmpp+iOEtQZrH/y01k1rGMRJAGFhi+nDecpUlnrh+qBOCMZCcSCovOPJrxjZnZJDMLdpMVu+tBSVS1nKxsYjY9Dtq1/++riVfLUVhzofIcIgQQPOqHioELxU3EpCcZMoL9laa5YlOZAMEp5apx7CphrkL+fyKbBAf8ctwVd93FTo7F5Oc/alNsCgK6lHruPROtN2RybiLqx8P5LTUZXU+Aoyz08zYHasR3U8hPDKj+6arWXR9yWdJoMn45prCSURKKy3+JHgvs2Ot6v6GbEtdCumgCttv2VNoU3KOqUwqNIWHqYm4eMijTM9VWB7umEyp7UPOI8fduHJY0W9xSCZdvc2xMjo3Zdu2o/WZKDMOSh9UmLvo45IBppD2dG++HJu8kbfFdlwuIxk2KHhgHQeNKcHhFkYGRzL2VJVMOAb0Co64wvds5CaYl9ZmBm4zuGDeaO2eI1XM4+rD/HmZyRF62SabgAe8TF43VuMutigJJMfbW2UK0azGLFbOfujnHD+GGBYmSmOQbUCOY99HYvswBQA6r9hrc2jtsUUxLVjxnZ4JnIrTwIVdWCTPtpJpvlA7m01/4tbUMyz9mv1jdN1jkiHQCJXXKg8bJ+aqW6rbwbn5yDSHBTcFXIegrhHGAjJOZI1pyP83Z3vMYTAJoo8V9IwyS+U6OVg78+IhSYHDYjRs8FrF8smHQ9h4qAYxp49rRP2d5uxLAuP72GvZaYvfeLOkMrcg0PkPuq7NsXhMFmiZa6PKBH1l+oKHI5DBLdZCvCwTPdXqmnz8gLzVRb/ixLTSdit2nrzt0x+5rDeZT+ac31NKNskQs6noKlQccyD3UxzfVZFmcbpmrfPsZD0Ve34xpKWk/E9Khn4A5yVPVq+dwnv0EyYecPqXGU7R8suTW0A6NJWweLI3iSGDlQXzMYsSWkSMhFTfyA2vTDt/3wXk+mVU6bRNkZvNnyVHYiA4tmnNwdh/RVsk/EgSerfTIf5VBmuAc2IKSeL5Nbrg3acgFj80mI8SWsc3dNAGCBLLMP89gH5UnLTKq78d9SxQH/g7DVnBh/qnBdw5CDrw/uMzcdXSxWqGIFcnQZt/1aOHxUg88MN2w+FPx/V75gy2wzEVe6G51PQIR2tZsxbv62HhgjwtlzrVREw/yzlaAiuXC26cnpvQzWXp2mOgihyPCWqq38nEadX2T7f1Y5zGxEGBaT//IcL/BsquAJX5EDbX8X1p8nLWR2yyjFRvqC/jssoCJBCDJOsZvoBfXqQSEKhNARH1YfueeKBslAwLi24/wAO1BHptlf1kQFNsOPlDvlYednrEp3a4SAz/G7LIVEsZBu0EKWZu/euB/XKdkGonP6t6lgEcCOw8mceuzvEVzyoPnMyzrqoNQXJb9C8ZCXSiedKiCgNwfNkpVlHbUgE2Rb9WFScOeEad+T+jT8XlSc8rcvkIuhAv/gxRu2eb2GonLTyokjcGF1EBpCJbhy2H3lhL0rdZIw1okA5pBg2oRfQceXTPzhuNKorTEF7t1UIgDqIo7/loxyTgbtKu29o9K9KujvCqUGyPY7upcfiZLNBVKh5uXAAZjQjhlhBp0ukmO4Avxu4xAVhCtnsOIA/tAm94U3HEuSr3wq+ZLo8pyoC9EB/q3pOzQRyCTkozmJwo1Ln/2xEbtNnS2S0NUIS3yz3/mBIdxONHxqP9FW+uoGI1F415lI1nZwK0SoPA0+flaokBGEoXgZnO4GOExU7VOjdPns59ekmDxqNhEHeAF5i5N/3W2NC1XGFjTpqLrnCECiwVkOTrLtp2ehUIaejOG6+1336YQSKMSsL4zhUjw6SQKryVRz5Ldn3R5/r8AOi02RJkQXPdvPsl/FMg96E/cJmIFLmEDzr1Gkh9G3zisG4pqM/MV6XIz+CtDUh6hmJB97VzN8jaPSS90vgDjvnaNlKky2/zIhE9ObugwrftI+Oi2a4VVaB/Mwn3VmaWjsU9NOf2usbcN/GLQMjvfeU/YvyEERPKw1leXZWWk1HXzY3P9MUq6MZq1hkEgFzds51mv8mnp1i4pQprPwY0TId1szXwe5TG+R5mMD76nGPQr7/EhQWksjsgGs7Zy5QYvMcGV5tcXJR+6hlHFIAc/M6XjkKYtwm673Bi+K1tNO9i1YBePTur4I+gMsOK7f7980mcJXhgdWdhNzUN2JvFsvXq3zZRG2V30sJtJYxj0aUv1u4/ppVHi1iHnTY3gDHsrQS8YwMX5XwZ2gcFYYe2wd7ZO9swr0gb8zf/fXx8QWKPXcK1UdJk3760B/TMlpWLCbhkqVoSTsOqzgkmFmFteCCTGhNyvFhw1RrTIWzRxq8Tj5FirvKvtkp2GAVhnZ7vnr71pyI0rKwQbVxKZuqM7GAvn2mRBj5p8djlHUsh/r/eBECptpbbjP5nFyuN4mvQLZCaxeTkDUzd/kNGLIzBFv1CElQO+xmf7Dzt1f7GM1Bh+wLDCJZlhcVDXbtPuGssdEie3lZNiWcXMTjZtWAT5MCmpq6JCRuFSHZYGKcSFZ9kOYJfEqLIcWdzpTA+Hmu+ktgSUwXVSwkaa/aHdZXh7IOyrudCBalCZpgXGRNbhN2XpEY60DXXO1Ci5ayZSoxtG0WRCC50+XtgWz7qgX5MRA5S+jzXCYy7O7Nn0ljVxiBxQNCZKZMTqi6mPfy2LZx76uyRUXHjnpJJEimflHDUxyX7fFg7iJvSrsZMH6Uv2xbfQNx5eCbx3oKycUrBY22KPmgfg/w07CDVsw6tb5VxPg5/X38cQtXI47U7MAGGjO28II12T+PjaXHlstPtkUQNn0DKkCYis+kVAkA1wyAJgYKLGnKD3nlVCarYqCkNIZbiVwO2Ydjl7N6iOtvvbAfuq7VKZLo0jEdw1YdsRaHcuJQulgb51JyELzYBkP1hd03IDcZfPg5XmNvYQSOINsCSn3BuLtkCPZRalK7+S97zxvJHiJCZJM9XP785NZ8B8fqDe/Ot0BS3PH1ptErwxBtpgfOj4d/41nrSjJQf9bV1kfdBHJxYbHILxOsWkZvoP/Z4Sl0Yx3bDjTF96xf96+6uIoQ351Ce6DeTwTnkPr20YwATlnhskWIddUohklNITCq/07zkiEc3B58uiBG6d9YAc4h/7s44FN2RG1UuZWeojrOZIhElvDP4KqHcOYbqqS95o7ilQH5ONJfy+aYiB+sPpn35HfHG3duLpNvBjXc+Klf4IKrFHjeVty02xPTNnbdL4gtkqPqMLhSgR/fDXzxJbSScqewiF1wdVoJ/fGL/nGWZfVlDHOQKD+/i/mqwXqvNqxtZeRHwoe/bodk66B9soOnZp36gdzVMRRQsQiBFf+HXjRcrRf9FsGghw3+qoN0JeeMvDJrkSBPsESDai/uVOzn2Ohge+UVdi050fdWpsjP0D/QuTdYs6QyI9xnhU8WT2+KBKzoZ7Bq8fOdKPeLulUhJjT34/EOnUloqus8+pzqNh/UdUOhgTlrbkuTfsaIYDm87u/GNIl3N53uaU8bgaBjpz0jdu1f59K4KFDtwUUeEUoeYx6DEkWKHdi7dtHhQF44lbysk7PqERrsuAQu2D5tDMl7kFoGdI8r/s8rMytJzYBU40wqeFvTl0ZVLdOB6Ya9E/f8VPbGx5MdpYqYMLMyB0QxVdnoJ+tgAQVWfH+jtOHD3PsjuT8dOTSrupuvHWRHQoGI1Qj1Hc6k+Mg84FAZ/gzl3SEzuGWZKFwuo2D3EiG95D2Z1szTqAuFRmT1nEh20tkC4ysmXx6JtN0taK1iRR62s2uNW5rSAvMEJ8yotr3UhJe22brlQn8Gvcq1I0aODaHJucQKVe6SXyfcDWODMw8xf+2C7Zx5a4Qlh7pJs550DictL4OxcDXKvVmLgVWRwb3moxv4kcxzm89EERJXCl7X/BziBkGQWOHPGF+6K5NFJYOFVv4+NyFq+OPMaSWZKoydplufY+CYyL63T8MCMmwqLTmAE8h0prhi174wnx7DHZWYuRJSYZ63uz97AGOzyI3aebclnud77znbZetbWUripe+AadLQeZPtWsF+FNiaXCy/98km137lWewyc7Gamai1Hd3Ls+KMMVh0R3NKTQ08TIClDfMKwUGKy/7YZlJHU3uW60X0r74Afh02v5MJgVOYkjmors6GAaDU7yKHydfkXYd6nEjYc76xws1LDLWCNNKBtUHNyLseOyNDgmHiJ41lXvq638RzDGis8WIniOb/pbTs+HsQVGPi6mxG+CU+oflMR6/qx3pVP+GPgqa0U0lo8MVmI1cBgSnPGgrh+J+m9TVg8nivua0EQP7xai44ruC5gsAVOp9bLsDXfHQujo6IpBmpfbbU8PDavZpTuJtmflVQuOImnRQ5kKoQz2NBFjdiHH3cF9QLgDP5vz/W5trCy22Uk+TCjXjdbCCHB3rJhKYTwiyQUf8xu6yTKtIwrbw4tzFgXDODmWYEnnpDupk3b4AP3qz4AZ2En5wi6aZV287AgCF4vH8TlWLni1E5Hd93vLxSYLBWSuj3eXGFtWyWpBkIeKu+YsBh19VeakA8OePM0ILu6dYYl9DNIK3kU1ybH+A5xYhFI/EqSX3vtNs6V5eQgxYLvu0hYFjiG+n8JzqLQVROiVa8XNQDYJtDAetPFSuEtGI3B8rnbbrNo9TJn/z3lRYq0ecBIe7a03vLESwhKOm1bGTk2kPMv/Sh9wyCOmIore7JhSFT9HIjonBfi+gcdDLfFt7dpShJmW1gkcXmitWwm1cC480CraHm/or2MHphB9Q1bmt/SBXFqXJdcv5GTt3IS2fRgqThhInCjRkh7Dk1iS2vMBLSGtRPppb4FEu762JehUMQxxLQre365CKoJGvJwVde91XQ+bDp5ZsMu/QHmLgITmwGXSpQFQlQBajqquxlwIOe2cyfezaSHIoRNLcwjW+epnmAtmmWA9KU29v/cA2iuWbj9ZV7HR4anhHkjbxnzKPHnIZ7Mm5wAf2o/3xUhnfH++quS20TdhalHgNhusidPKWyKWV8ZjFLgb1fX2r7ifLyUtxuKHHIfCWXQJ/DKeU61vxmPT34MTi2Q9r7/sK1CYuHVqMBsgtfenn31bUzCoyPN89KiO5wHveqnk3uyHnJSUBVTQQ3NyRPmeRKTQvWEBZ4QWcSgMyZF0RQgvUXRcp6KflF056fwahSioP622TdcTVYi4cAwSZLWDvfjoKFLMowPQpzn6ogXHc93fFA5NZmnwslSuesOyNI1EE3RM8kzat6thkmpOiGmm69Yn8yNuxz1YuuPWekoybkee106T9WTPXo44ea9E5QH2Ig6FZn716DBa2FyXHG1B+YfnmhbEpANlOi61BoGO4+G3WMJDokJXj9GhNsFqdaLjA1pkhLP+/mGCZoYsxNI+A+sMvWyoj+PMWeR8koRz+r9pNVEWT70WhiAkNTrojdr0sBLwxIM7D4zT+cVy96ZE+ABi9CqkM9VK7iOfkJVp7AqCqQ9EZ9emn8rB8zfoQZUBrVd6YS2AqiTFt0nJ8HfPGmnBWf3Xi5CgyWoLAmHJp/AfTdHB0+Ns5DlhL6UJ+O/6xys+CWVKtL9S8fVHkpwZZMJn6jVtiUTtXjywmiVXw9a6f/G7Qd4tZtcoS3aytxXYA9aGGmEeBobjiammhUaMDicH3nlOkDvvz19NqWOvHC2SMv7OQHtDIykYerPuoLz6SQNOBtw6oX2Sj3ZLITBDcWNx9CuZYYVaE+vleXnATrwn+PnuQ34jL52tp85aIOk684SUlQ8uyO2t+eIOHndZ3oxD+BcMAba/JVxRYUAUZoEw3D80WWOz0/ul+fYbhFnffx3PgOy2LLiu82D5FMSpi+Pd4EkIFTgfv7p/0vnX1wp0VpNzyXs/5S/4z0RFS21vIF67k1ERTfFuhLM/8fdbKognohMqTNF/+oqvXXLuJB7IHeDdn1X2eParLBEpz8y9CAN2g5VdE7EimekAOhkw+tTzqeEsgyQL4iVDnWrP/RcBd6CDm16/5t+I1SAxCn9wo8knzmpg8DYP8V/vHw8Stu7cliAt+G/VR4XPNZXWF2rZBeQO75os2jFJrbtkfhN9BzHT4HGgXTjyTy8NGsiQdeOw12GjYKCyxP+34kRHZqYsn0pFvVubB0+/emKRgiGXNRWQwMSvAB1xvTprD0Zyt08BjP/4W9HGNfNBcA0Qb9qF5hdQ4dDqpKAFLoIW2gFEVKOganw3M9/4WP9ckP0/g6kaJDRurtxNgT+PjvWYEWlFa80wKYCkd/0ZChV94njjGyg0t98Pz3AL2AFAhvRRiJwdfRcQqqhWkv/o6X45d5w1YLJOye3v7rgta7Ya0jAl/an42ng5Wz4S5we7n2+1W94JnpoGyV8WW2HYjKLkKmp4hBKlNtb5y4W1MrsG/wfq2N5Xrz2kqhdPQL/YoxgCQd6Y2KNkADVu7TxugQRWVuNL0BUj3JRFyWNeCmB74Wsz54OPnbq0GFFxzSkoiJ3Rtq8yEJMKvOMMalFKH7YFHKjb2nwrKVfuUUuRtTfJDiBuaEHHoX+MUrM2bBaAsSdnY5PjqcMBn/wwojQxzt2MoOCC3OEArr09ghhsj2M0mue5ntQcmcC1R/sK3zfShGJuazS+mJUeKxk5u36CYj8+SJCq8ZEv7bNf1+BywGeDQoTDGq6Yh1xW3Suwo2O/ykazTPK/TdVOICyiwK8MuQpK+FX3mqSPzxfLwFJ/iYDjs0WgW2kqXYgm+gkNToB5+jYH83Xlt0cbtEmkkBaVGlHz61rVuWzrK1yjn5nYHKvKCrBPPRth3AKDQQB83fdrbgIeIfB3iHya5NPpEyxbzmtN5Dnk7GqrQ4uu4h3QSoHU+74zs31cWqIx4SZ2bwWLvIxUtR6gufZhNZoMcmSB5z1O9TKvHMORD+VmuiqzsyJKA1OaApB+b9x6u9FTvUkalgl0r7raV+wRqimc2D7B1z/OiSagdd5UME2igLGUcgPlMSX1VsKQp/9yDiYei87KTBA2NPCUmgaLwVdvQFFFxWp2vGCY/KCUvxt3FOu6xIgwS4Vybvbj6feUCkrQPpO/wPHJPhAobSj/aa5YrUvjHMcQkDZwfc9mvghrk/PIPvcJa5InhVBfjh3Xr9vIvA4ac+m+pywS/EqkSX55xgiyj0TB1EE0NT3W2CPFdVD88P72SpdFzHS/6XsmbGtM8JE/m8eojzd4PM1bNADliZ+XG/9hbcKg6PftVKyKKt/8Bz4lGsHyT0VKj2vDGp/qDGBajSHrqzmpEjW5LXsb5kTV6HgbMcnPW2dzQju9N1sI/gPVlgGmk0bHKOX2Ws1q4aPizhcM/XiJ5EZNUK6bZNUeFaUJVTvGxglRUY7vdnoVOe0Raho3huh1XDeTlHpk/2gBjjhUQXe8FN5A4zcRqkNtKpSVq0xyw9j3yQlQxq/Lnqklpz8lXmzHkz8sX9HJjHwyn8UAjblvN0ZFIk4liejx0lVACoKvpsT9+pQoLY4weMHRzcuVC60DUFkaqLfclS4UJti5WK4FE3dYcc0OilX50uscLJomlR6pXriD6ELNNBWOSMt50CJjPkyt3Zn/xj1dlPVP1t6XExK+b3jMoULLPOrEGvjELfAMM1qcuBb0AijkIuFca8f8xapUlkvLjmmJW7RK94r8HaPzvmHHSqX9MXdivNI4A+JHy0VCe79UZZJvzMGzpnsj+Q6k3EItDBiA12fTMlSbEOMAWCdQq9TtyUiAaAqJozMzryEg0k+yVHqCc/DyJcCE2V4WXIhEnsOc5c8f4ChWfUaONhPPWogpDs/lyVCvp3m0NSfrAJKNiVy5aNC9gZ6c9BqwYgj/cDO3kdam6gCjhR+akALFYmt4ixHkWxKhDTGs5K+CwRiKJnvxP9dbxRPCBHbiVa8gsd2GuiNHZD98MNwXMdMC0MubVodd7dnyk3UQFfCIIL1osPxY0ZJ6DvZXwtZ2I0th6aqlTMULVo+lhSIU/5qO63lTSa3MgPRJEOi0AJ8/UlZuvgqLw9dyEDQoHTKWOsq+6fzoAyvIpv14fLaY+braPd6NkSaq0RClMenK1QLH87NZriUaeuCo6SZ7/CfUt2K6VOt0AjIK2jR0vorf6R8+TVzxZb+QdLimH9pU5tQc73xW93QRPMGy/gCK+R+YzmV4fHK52GWBEBL05EEoTY6OYG1WWji66dWnVTg0uPNw839p/yjLxkCfdTaH+v6hVUCd6HlROj6W8Mil6AYGC7NI2+qkZvJh/dAw/iQspXQNwwWHr6slLIp0hBHYTDh/J7Ba7ZR6cp3iU4bSXdmzhTahYDev4yKiIHyN64EANhI5OHYv1G4KXfIOvQizYWchPhzQg5eVGNMxsqrvWVxjtIbkKuHzE+IcA2NZ83GKz0D8z5zmgRnoJGKigseP9TmMS7BgAqtqyixA/SLc1KEUWrhXOQ6kA5ZQRazp3wwSa404cppBnfsS8EsEpbr/gXyW36cZ9pt1RhzyxGxDUmnZeBz/Uf1AP+gyLIg9x04u1fThm2w/H1ZXGvVqsO1VqutV5gUhFkdkwoCjzz3F3FUr1v0njGYT2mSZYvoF/fSd1W11c5VIhkEO06US5wYRmHVPYXmZnbK5YHQ8pkIDJ0yqssqFK34CuHE8RWb+Dr4omk779QOOcYomAMYQ9ILt2KUk2uNlahW/IjGtenuGLxb/t3aFoVz4oNwMZ7iyp4td8mdzgJAfnCcYtklubGAUB9k6bGC5DSkf5VFarnGEBWz600VGR8QywZ+jIYFZbtKT2QdDOYP6k7D8qVgEZByGmRedZRWaQDTggLyNgDD6pQwEeSs82+hTxWypqwU3zuAWqfwil+mytzVnKztyvMFJyJwPFaPr4Z3mTjyxCR2Jv674JVGGMUSWb0l+GtcYtd+NBGChwr8mB2hlyccget9liJhQEb0XgXfgVRlHlbO+jlZ9CcAew0Nw+tRcWgNnz/GL9Kur7RohRhaYZBBmQA6JhvzkazHRcdZDn0zDkfBmYP1PfQjP3d6qqx6gE7vrb3lBKEfK3Y/nCe4COdpr23oZCoIpssGXmqE8CGpO2bEwkSN6uqeqR4UtWR+xsgOzNeR49PTLJpFEAkXha5YaecJ8t/KR+eG7/HKV23zPZAMvHDC1rdxQ0l+6wlIgZbUybjBe6yusL7isRuuYYwg4+8+4lia2ox8RCdvmXlt00ZshBnAIfLkSwIqUzCcsD/d1ZG6Az728L4FCIqBKpbA6bzkJ87lYQpbaHpwPpqu3S0UqNDCwgg3q9MEn02X16E4xibz/rLx7NMDtHcwMOt9r1dVU6Hws9TvJVH7THrnSFESgN5eBy53Nq2Fdb8mySTxz5CitvVE+ZjHaYS3hq9Bax+uS7TxMIT4qJE7HGdsHM1/9uPNBylhP04Lck39JMe8v2dPOSJzyQoy8m/8Fc6h+X+5/mBVA9jAsG4vmx/KdUW+NXxgRt//SS2Ib7aGILsjOz+ZZQu/NMeuAsP1pFRTN90rqIVULbJ20ZJlrjoZD1VxHEoDFFGVWCVOT3jGK+vFD06gc3yDUSnZ7ZHjGmw4ZiAglY2nm78aUpXxI4BfUHqL6YQKFDCazUIryLi53RczlaTh0ry7WN4WpWK9sPJ0J49fu6RGUMYZd3+NrRvEdOrS5n+EJOTkr4lNzo8vawcYnR/n1Dq0rCHu5o2BGBEHABJbsFLi/mlWFO1MjpvUu6UPJjXlXse6MtBROT/mQfyegWGmFRQ7Q/O+rJp471+tQF10+bvkExfBoTQrewd5UwhAUODpyeW+aK6vx2AroUo2bGBZ/ZjcsJFfMYEMsm47LdQSq7T7peI2Ex+4/9oIAJGfhidbXA9UYPNhxigFTg83CETNYfYVkoambj3vv4MZNtE/wrIfTguBNqkQk9ebLPTmY2U4UCzbYqPKO5vjaZXeVksobDAJzhVjoU7p9TdFmNMyLyCQJryBSOcm0hFk/pcwcV15KZ/+IIqeQGPkTbiY1haWSnuQYBeyW5uSPHGtYw28cQS/v3rToNAUGVBSQ6zpBt4CHvaOfEJhuDJYZCcxvPeOStdCzaoSQn9nDe8wDc1MXrJ0+9N9TAKcS6u8ANLCLY4UfHLGf884/LFIn4OLOlRcNl7FS1IJgu1/vLm4INkgHt5ISp2vC3MFJHz1zJnopnKS1AgJtCmhJRZDaW6wis8CJ0KAJW0Yy0+kWI3lJ9N8yqJht68FMNVgkgaAGi5LuKmkZWm+ztKvf9gT8hJrXZkM/QdHI6wy9BqVeWa7g7ZM1YLbUv37YSnLmGsCrl/UVi/tG+fZbzY4bGye0zH08VQpGmyd/v++fS9EtasmbkQEIYnmLZLxO+tNHp3myIGwYBZVXjlWvrCiQcsP/Fu9l0HWmLBu3gvuJ4phtJsXXllJdM8iZIQR8Z6zEMs+cqVL7+TYhxDd0c0l4sbyIEw6N+V0v3ZbUlidyekdcz/aIomGdZtmdI+1QUrrHw7eDXT+G3zbTZMXxpEgJc4zY5bH5az8eHzwoo8QUleUKpVRrsErGmSF6GPJ2OltKYL6/C4zx4rHdcfsrQTcWBmrBWMMiFiU4NGtpYeACqYafRyu8j8x7ltp3nxVbsPO0MSoaR8tv61/q+YCqHX3h4vy4HzjCYEl+4ZDtj2+mawuj4J0rBpcDw+spzuCQ2khFbks09lPGxK8HYJl0Y/lNLUxGLZ+2h6+EFSaD22bYzF7dk/EhCWh6u/v1HUVKC/r/Wl6JHtd1V68J9zdOTgbvJuQug4r4vUV3JJolQQ5tecHKqcNoYjOIs6BZTlfB+yHGfGdxTKsGxbU/4taKuH8Qpd/M7fIG5zebrpiDHV97T4jiUNt7K64/u1e/+erXV34aOjfddcKNO76EzIf1pfD+KivBsRlzlsjj17aDPq/lnKHQCLsD+3TK021HNzhZyuwpLRKS3KE0XH/0TqUOr3VqLMcsSZM6349QJDznPG+sUqeS6wwMWp28TAoDKdmjzW6f+2au71HsOzLIeWencRa5JapKkVTYpvwMIC8u2L+/hYGJmk0588rq6Nnqe041NMzU6lj1K5KmSj0ZRiVpzu2FSTl4PBYHAuhe5dtwnRQwvvNqIELVxKMFWedxxB7UO4zpYRe2x0zH4X6pI2m4g6YdCs08vR9B7omy/goQUYbUZA+wJamq7/c0FhkNm74Mp05NSCK1Dcy1+9qp82p8XVkUB4+SsVRJ/Tqtn8v2esmemr7zjCfjLicMb05JqNoL6zzz0KaYkXeStBrF9+T7EbZTo2Fa/wS5NhJvRoZc8QUfS46HX8HIZ8A6LK8zKtROnakAnEEFoonVlvYR71xYuBAXbjtxfu/bteN8WkArB3//qp+3btpi2SIMyK6rX03iCLnzOd2OrPnD6xqgVT35e6NUMpN7EJSz0DRRzyze1J+Dx3cfx0M577W84qifD51mZG8VNbBf+5PxmGGrGOmkO+Q41YnCkx51D+X3CXsNAjaz/XfcPJUXJ00vaQyfYDtmFq4kU1ZHdnep48T4IskzPsYT9or3rd/ubiYLqeBqjnGbuNWb9ZdPDxkeBmJwYTjsTU+VugQmtz5+C3QBX0piVh3d7BK+Hk4mO3q8qJVQXeIqs4hKuRvBfIwwUyKg9W1x8dv+EwESuk2Bgs1+Zc3wzx4eGasynWs3V360wH3fKXZFTckeHZdgtzTqcQPC2hCHhSXyFMyljvrneLE+c+b/YQ0XcDBam1oAPzvKmmcgER6AqnyC32Ic4HMP4FQN2rh4Y2ntrawByV+9oq/Z8hdwQEPYRYiELBCnuGGXDQbl3ZLuUo0vfKU/AuMwYfNXmNM2vkn/GRrpc5WDP+MEL80tbJDZfDNBRfpfcvVpf75u0LrkIIjnU4adaolZWzB2yjIVwNrF7zF//n4N5xHeaGc7Vh1EYRdc0h2l23qFvLBNQ5kHbmX8Yta2Vj4DU6eBN3XyJBvJf9iL4x+hw1hx/7Ej5U8EZr/Qhgoni5r9PxBfU3fdvXICGW9DzST7GV141bvyMDXblFG5PizNjJUVAWNSxIAStz6+eDAbkYeAKTj6DIR6ysFvZAloBLCgSdMFd3ol/WXDQh3BbBtLqO9hp08BfumZjLpTJGRAIHzDizXZfhbgqejNSS27BIXQLV0muwzgXGqYt9McSvtLWo1Fos3k6Nu2qGyFftqQyDz0/bmgvtZyiFce/SLYnjt2Q9BnlmUVBWOtbDPvUgOSizvJDhdiSkbLLP96MJ7dKO3eUK2nZnpb4s4b2XGF4T6gC4qo9TDv9z2SY4Rffb/RjPs76P0YiWADpPB/nQjC2tDRlxt4sdNCIjmMsLgU+cr8cpyaMSYI9maP4HHww2jTPkGKvF6H6+DFAF+jAZKT9oi23gpZ2zavE0xXPkF7a2FTNJ3bwxvsJV+o0fXZAkmouYq6B2+6ccHhnUIeL10QtZaPoZPJB7/Xry/2Nv+JJFmQ/p2NSiO5bYGA8ej1vh5QlWhaX3JMs5gMBnyyIfXIMf4im0WEUnCPAJzq9q04Tmxzy7nGKKEf31kAp6IFk95aj0AogL7iljLVJlOXNvV7BwZn4dKfuZweSEZBqy+Mvual0TVDHiwHuIuXbvaw+OkU7aeAfck0Hc6H0jgt9g6Rxb6dAuaiKEN1cUYtD88y0b9Arq1q6ML9B20/FunTnZNF+IHgsg641FfllDFpQ+dqrIPKQ8IkLx/2ppx0ivQSrehNaf5dwtBjnPHroRGzG/RWOdiW0COPzepxIqcsWjhfmBXSUD7YCvPm/qTGcSnhcriFKew6a5s0AgK03I1gEifX6y90cJBY9REbQ7yW/XB+zAXN1XZQVEs7r+0ajtx8KvVBKJksKj5YFGdhEennMbwgCJJIMdt/pJD6FIcNVegt2LiQS70DAJeiNNG86dQVNYNZmYEfo8oa002xKLh1+rHlBX40iY8Wlv7FqswQFktpyLn5oSdo1jBRz8V3aRIOmhSnrs2wxGwGBEVEXvRm8RZVvSQ0xlKMVWs9Y7nnmJ9jEVuDL08D2ES3plzvCNP3FpKQeSknFeVBXv5T1Yk0/X5vdj1J1LYa6Ffxxrv90ObLHARkCI+tz6+0i5cZTinvgIYLMVnV/OL+m4RCsTy/+9VQPsYv6X2qSSlVdQ3KM1SOntMNUBpb4C0MsDh10xHQ0cbJK0gsR6X93ru63BDYbRZmPISt1casVwVVE7+u3l55XJGJ0Ev6S+2zpNqOAH66RuzpVskXE6X8x6wHOfp5PAI/7YG3Zozh1U27IXGEEKIm13Rt/nTE3pKWA7i1NFdVQKQ0CNdqEsBkjiuM41dd5rIbR4DMnoDva07v1esxYBGU4JWJUJQyejYbI9p7pqjrpHZUNlz2exX1lTAks+WxY6CExoPlSlNNv6AIsE0VdPmHOj4m0a8bigDelTpIL1WoePLhblmhRlkPDKiZvkzz6eG8vLeJjCGJL1+VFa4QREBVyuhcpZm1ygJm9kuQ+8v4yEMw0VO+TKee6sMFRVc/kS4IirJupnw48LoR2aRk+GuDBZ25xnKFxdSYqZqvWlEcemsbzl7wvQg5z2xKxEUsquyGziyzd/X+XFl/ct9KRLzyyb6ComIL8Wam9x6LPNZXvhO0QQZmQ8T2MFjmRJ42WyRzfyLGkJKft94uO0Yy6Fflo3AoIEon3XBygpi3Je932ToU5EKoikvqkeLFACpsBN5dseemiMdHxOJKrVJDdTS0qCcTzPCyz506oyENFdelskwdghmUnWyXK2WeJX2CBXudNUBON/i8kMdtJm52REvmGqVmxe5aricuTCGLbgZtYvigT++E7xltEh/ZgUoMP+d8vaPU/HdhZaUjsgQ8OoqZeezvNR2JFm2on+IliVyYQ/58LmZ2stgKoBbs4SllwiTpNRw7ecL2WR8bbg05aTN00C8aGWtReWSsYsirJ0K0I97flI2gJRRN717wESryWahXUAFZAdyD08j9SIZQm+wq5GkoUkK5cQ3wk1x01x4fKLPgPIj6D6lZiylqvWGtl6KxCfoSQXlNZIHeDsrIRqhINxdrCinM0iMMkveNxhqrEzhnBn8F6nXVY5zUDLzOXpp338I2HycFa2pueObEof3HQgFEMnHS3/CDKwJAyYl3HyA4X5vXUE8MMa79gYELseTf0IEUJRsfSa873vl6n29lFq+GCqF1I+mB5PSyLFvgHv6hG5Hd14PAHTKhY+xzCgOwwRZxygPwNET0UiO9ynH0p3j7GAFEs+VSjl4ArhHJbySohRLfm6B7FxxYJLJxJlQr5UdD+5Vs0nM6CehSZZNYw4FzcpYoL6nS+wGGSNKLVLXgbgvzAbT4B1J4GMS16IKMlo5S/dzM/NM4NI+a1Fuk4qwaewoHqGp78vgp+SkuhLyAVhI2Or50Id4LlHwRon9o7JT3D2pibchFvFi2VTEx6cLX/qorW2YGSSmnu9+M8teW9DIRH1TfabuDIuLk16NFz3kNr5QLPGAd0JzN2IYFA140yqfi9LfBcZI3aUK/Gt2bfMMk8eqttN8c92OmUYKUaHbB9C9cpEwaOYs49MztuGtI0VMqDDHN8HiRP55BpRIJtIWbSyi0/LOC94XhzqGVyuzaVaBfg0f++sV8wy7ytxlQYA9w1ejE0XaCkpM9zbOrymf4OrEaIyQX84Z9e6wQ1czIvOihnSaq/fcFdkxJcMzE2kWcARwWT1U80dW6B+v6HdclWMyMWLYr49iKWrhm7o1yumJKxVGiv1Rx3Tw61jrh+vuNjikpFRxa0F9G7ZWs57nuhaIeT8ZRjYzuyq4WZBEXs4CyfvmZxGcS4/G2aWon2O/UkjqrfdbBUF0yavSPdNJacaaZxFQNejGDPK7SCF82XxiahbNpwFs/t07gbCJkDUvvKjqaYv1SNJBa21RKsOuGJNKO/F6HTjc1Q5t8lqLL4e83gWTT4aubYGtE+D4e9zdPPo2R3dvG7bDrCQosp62YhTaV3B/kEQGqtzvu59fbgA6lFyGe7urhYr3TWCBFYBmrEpB78fWnXUEd1z0LSzMcWL6vuh4CJYR0tg1jX4H0wkw9mkbM07MXopLJ2Rt7/aL3Hl3MjO8h/1lqNlK74QTbgkurmgd23XflEcMhjO52Y/Wsz+CqwkBCDN8SUcd0hvJ6srikURdDKw75ZZMyms8NdzvzfsXreeCzpVaPKbkgWo0BlD+qWqaXziVa7YTSezNkCD1UBphMwE3IFwG3+Oja0AILbwR+VMjirrIkRPt+DMtp+OKLpkiE15AVv3jn19brZGZkhhAsuT2sTiWSjLvxJkMICAGdQY6CcJ1bmQsycrXCCxoxrME8B5k7aYQkl31h4kmnvmUA1Uo5bGEJkzebQNuMeVIRwKr7shM3Y3iowzuO8Jm833ALhjeDbR9i+ajGdiv5nuQcBDW0PZ0CB/GHvnmE702e3iEmWKin/StmkbfvsVh9mXnjLzZCRfht3g5Fu6OpDSsq1DSVUie4hNThGTSTWkOhTKbARv54Bxp1m/BqW0CfvfUJMQYci+HzQBrAw7lHJI8klNzq1wbwtxf0zzTFIpYQcsU3ddDWDMuciKmN+BHJ47B6FkgX4uR5QSWzLqgN2wQK1aLp2hgMJGqMII4rLK56VcDk89QQhw6cy8PCM19olNpuDwdrQFvP+77wiyyKx8Z4MVJNxV5vJWOwvF+aDouZMW5HNno5d960qcPPO89qYm6Zh6UO7MyFx272aWYtu/0+UZ6eThOP3s/uMGRarrYNGVN2bkl0VbM7ZArP2AnCQLuPoIbkry4nTS/RsIdFmPg98zeYI4R0RY41FQsBym1OXnJcHtmKPjfEXuujVQGfCPrCZsaT+vFbMFWIvUy7OxquIvdi2DVp3+q3E3NGG06d/cz77wgHGWrfcy5LJIzCMZHkk6m2QnZCXYVXwMsVhJI9nJcgG/CrU5lgDb/DlVEsXG06BHIuqVfnTyLdAQZYmJlEEk43pdgF69V12XC+sB9W5Tfm3jPwiHn/VmGszkYx+Er49CLbyk3hDBSKuzDj+nzCo77ZO40EIP4ZROdSwWlf5S8wfYcAzjNdj/aZ8uknw3tur126RfCzMA+cUo5mPaZL9cVp33X0mRTUIS2vgtwDRgsSSX5xcJUWR8gZbdeqyqQEEAeDu3+BMlrgYP2SH/le2u1yfVFn5JX9VQ04X9mmABR/KOd3rAYqR+OQwLWao9MXVS1y+0OKo0FlXuirKuPaY1BQbY3Vo05Gf/+N+u4rDcFBQqiCrYhgRAEjvVW9eNCaOsukcJWEaDuo/pWCYGJLadm4ssTCPvVVEJNBfVXAcTIxH4EFtWFMJUy5of50QNXNZBl+oRuFIkdbt04DeU6j2A3vzzP+IkMahLD6zBVJv+xRBIc5fODvnJMmJRMI8kcyMFqxpeWZAHxC68tGFNyl6yyGN95SwNYXwDSIQCPlL9bzjZaWNWvs5puiP2lbEBlDw5vCHtVmb/sD8QBgOhRassChwM5o5g4lhlD4u86wmdmVmhmEXnCyLeQJ0rRtqYIWRhg72ieDnqmPvOkDTWtKR38TeJwrK/7IRYfbNspygrU6yV9YtJyw3I3uEkDgbPrpcNUpISYvzv3beFg3ZN+swedqf3IVKkcdiAezu/KpHGHPyvX9oT6qzTS342/DenW9ctM197UfFl4rk21KxSma1KnLIWlGGasMF4+G3dxTnqBscul4CqNda6Qy8ita7HCzKlYa86yljm+HQA2B5ArJoZy4LNxeT9izFuQhEoEhUTNJQj2pCc/O44h8GpQX6XgpaAvAQJLVNq0yXGFbzb3O54XQ6sm557+lT3A+VWPyCJn1MLbsssHIdFhJcMtBFQYi0bS+exQ4Rq74xNE2CIRSzi3nj5TNy2AoO0gdyBC0/2iH67UB581jmM92OHqgD4EzAzyxDauPnlIdZu0nWwB4dtxWN+meq/faIuQpK2hoRP/ULwIJ9r3xyxtXxfFwJ3YquXldSEnxoPiYD85u0OAHvKOG6+3eBraUiOgvdfp1EjiroeSLLFutuPPV9XqhAReYPaRy87OAkV5tzSqvyfufCvOMTtkpxApWsJ9n+cNM2uBWu4lj1oDjGasCfCt6cfgCzh6UbZanbL/qCgf/iHjKYaavIiRLJrU2BuzdsP97XHkXLYbbfsHVTlXSohKOXOJ+3LiR6ix9UFLo9qieejYk+P4e5wC64jGQLSxJzYt3cErx1Rtc2+xlJaEBynLN4hLl/qOrgBM7a+yswC0Mh2OieA4SR6MfM9WK/FOWbVyoUBIUAKOhhIZp2LOgukk0/DInn7sF7dRP6Nw77MaAcYg6k0gdjQN9/1wtGVSBm+6LwkI+xfcK9l+JiWepXul+/EEdV7XXp/9lUsW4RQmIkda9H38FJj3EYJTrG4hEU9YWtNd2lKI1683cXFVzSMkh+2nuu9K0JUBoAnrYkKVZpAKF9G7y5n/KMZrP2xPuUFSOaruqriffSEX9Euj/k5dgewEyQCFTif83LhkIjt5qJ1LyI4ynIznWl1SoAdecEp+I5WmKBB2fr5yw33NX94q6HIP0jW3Np2E0r1f7fUjqdxV+iCRULU+yAwPXFvTL7HqfFLj+wCfIbOg+nsW03rGTf1haLvAZA/nC52pSDnC4f0qOiA6WtK20BldZUaA6GO3m5ZOCGyemGK4a12hM3BXnbladA/yTRV+pH7IiT/9WOijGGNXzV+K4wmdmRjU3It+QwUCRat2mGkEHhOcQY06pWeQqBGjHkWcceX8/drkk+tYysHMXVk8hLhLGjUVgivK1Ra4K+RtUcZO5fkVkWQ4W8fyo2tafhGEDSsflUH7yj8wsATBE9YpskR+r7Ac8xqdxtEAfRioGXSprjbLI2DAZZz9HAYR7rUHzvh/UPpFvrLbd/hFf7sF3RimWNpiGsQRZ11RqfZkck9IJu/FPU2DYr/HWUdskJHuLufXCvDbKn0F9sM31Hn3zIuAMTUc+tQsO9ll6jnNnW9Ulo7d32jEQMqJIrWQL5+Se0a8lKRp+XhYp4IfyUaTRC58vFEjKupeFEpU4EOp1AjeALc7vZV0ovza8QSl3ru6xFpY0/ckElMOChkhLWSDHLCKaFK/qC/SIfT50GJZnkCr5SgXZRddXq8Gc6XNjIzSdCF+9YlUFKMiri/sn1Gp/dEMhARah97GidLqitLNBlF+H8XoQmdrM3GXBSCN6izNn2ON0OzpCxOuM917OZCw2ZC0DSvNuTOFCGGYf1TYgUbgK2KKc4zm/25dz3GhVpFqs6x4yhZBbiy/6FD1vXW/aIcDiSUoIhwrUtxuGGZijb47Jz8JfUTblzx4eNPbXeYpygkQo1xXonjeouTuJvAH/zH+FK50zOLAtbN9AO6xjfX09CsjKitMVlHWmmQybLoBHBPkC5IbAZxvs3cH1VAcy2X90WL6y/0SXNsGeLBdr1OWVuYg+/wUNiR7QnP2ec7jNrZZOosT6Olwn02Dh6zSwKoDnMFLfk7lBO0p9mWjex7gEFXNfxFO19qmaoISUZEgdTuy7sHgrD/36o3XeFdzLFoFnOJa4yaENBXdTSmVZacz+5IGdVkEgjQt/TxuhNGHGtQuzNDfM4iNZ28Ly9S9WkUGMNAfDRLr4ipZkJxUA6HnlOi4Yb04/Ze8rB+HEXpDGC5Jpr4fN62LQh8o6kxknE1P5/rNmz43jehFlRUvCyNi3Y5St7lC7a2ogCt3Za6M7AshQdbVV2+R2DuuiLEJz0MLhnn/1/F2Z2U3h560PrnhR0Gc/5GW5DwO/DGrR/4PvL046BKjUp1lfrtKfE4osRTS9/oB0GrNW3cYgvhU8ld61sHhKOf4P94t4n7h9zdRXDaFv4ORPHokkY+NA9QA49RmsGMfJLu1/RXuluq0J4fsUUBoa9dL9T0yDJXvGtuoln8aYrNzoapa7E8cR73/wX6KwBPpwCUUlxsBtOj0rnca7zu5FqJC5W0U8Yt529SAI0S6nmWnS8zguQLRzf/gRLaqSQ6E9T6Q84u1cs56dzBMv2eBG+zAKw2V0x1NJX1gC8M2MYZpScdXEKPG1442UFWTEUlkM9OjbR4FurtJNV4IqEu1htlgltESO0SeZMHZ1JM7bNtYegevwPSCmW+S8uEGj7FTSSV0HbDg1rOnt4Ws8DxqN2T/HOXNd5NGboZ8VTSD6g6rLWcoWOwsyeG08GPG6KHPiLRunEdTPNmY74ObRGT1VCHP7nmBYmjnH+kqK6rDyrEoNjdqc8uG8yZrHWBXU9weqD5rpQ6S/annq7P/GiYepA2ZDdJA/GbdxpHYatPgkXt5sop564gVHZamW6cq/cdADaLCXWt1WgK7y11WaQR90YOen8BECQ56pmJbLvzzfWBhUUJP+dAEEK4o4wZv2+IBAFEdNkNF3mKntsLE5PDLA/IEiV0rziyORzLJsoxRMCQV/HlpCkXsaizcHT/vxU9iadf2hOkKehGum3973fFs7uRlqxz/oDerFL0617PqG+VYIxjeRb2IRLZJGH8vp8ITzF7U7HUg8Crs3WpVY5r8wxn8tzGvUUwY5csVu15Vmm1xcs0UL/lUCkrOXdLtlaa4pHLeQgpd/vu1ZzjMOcgzfQaIwiZK+fMZjRLAHUf83TSCOkovb3xPkD0jElmb4TBqFrwn8G4KWr+RM58qhCnlVimQ390m8YLz+fNHbBRDs7GJgHSK+v5Z9cwZq4glnR2eTjnqTy8Wo7BEg24CL/RT1AKzOIE7muo8oegzn8R6qab08LzTcbb0ippsScfjQoJhsr4jKG2pMVczpCYqptZcGD5rxTHFbL3+NDnEUptRMyARhF2FMiM7pgaB/IpAna1AHa5EPt7oBdzMGg7kOdSOpxrPXbdP3l/+QCfCLMpCsxFd3VAxA/IPVvK8JaenCYCadhyZ6rJeGxTUh11+OOAjrXIJxb/EbIy8rv6h7hywPp9ZhPCcgt9BN808JhGIaKwtL85jO5nipQyAF690xJ9A2DMuCx55TSG88fN6rqBMYDI+I+DtFmoAqJB27B/xxN9xMLnQwLcLCHOx4GIFCq3/6i7gwJePjoG/HKNb0XjhuEQmYFzTgtt/uIo1bBX4C+y1jrb+R0mRj+RyaDkRus8W4WW73qbcjpjIh2tGUY6KJyhEaKiK+LHG5euQeYZO4zXoKbZOWiJTvJNNVrWugpXkIIIE4zK/g4JKATQjtaC1qbJ6khaJHxOTS2goU5zGyjmaPKvVPrBh27E7E2iZ/6omwpBARV/9EKeU1m4Msz8Q7y3MzEF0C8VIIqAxB+Fk8qG970lhV/ZIX6CsxiHqybemqil3Qv/cWKm96fPoMJWSA1dcF03dSwSyNMdvKKBCYVYLuqr2pISKPaNRJJw2R43RNE6avh/TNA1tGJ/ilW/e4LbOvIh7cS2OsbjyXcD6WS0DYaDa+og0lSxehZQiDSt2fVdtF+DO7/cEUAM3uju47Fl17rUPkRPaheA+6/jpSYK5Nh6rSwO8Pbi1y4/L0L5SStva0NcscpH0pw/3Y9+Eqw1SDVvRn2r2d8vRC6YhQywdhKWraKGBMILqjiU2l5d3jb1tnQIwi95QiTJW7MAjJD4Plr9FGRGlM4NQyAiG8wSAKUbRCpmxE+zk9YhXjiC/Rbt983pV0VzovJW+90dH65IOb2VS+Wk+MpsRgZ86uEuxeGPyB++07HlAwqFjq0sm5Lvom/rcHSaLduJrDdabujYJRWbbY2QZptvGwTHAiaqsAafE9NQa2oq6hV8+E2YRbdEcrirxyx9JVWpti7CsFfA/egMevH0MR40/X1jQzMYbw6mr01MI833RiE3EuU79cpspC8tuN6QxFB7ExHF8yrFQ4vRniEkTgKc8kT2tC2HgNJJ+l/FwYXky6qbHj1cMtBGVOw3SFMHn5l5odYVrLqhL6R4DujKq/CEsEj742QjUogvrSb9DOh1Mm5Z7n6MI+YHii3bWp2abi25FJIiX3GM/137MQVr4wwQ5IQETnYx0CoXX1nLeqLjQ2VlOulhy58iVxN5d0Q2TEV6MPr+wA6lluGEC5890db42elDUvTbbMcjHGrT7WA4eEhNLqVT35NhLruSPkwg1UCAUz94Dj23i6dqS1MPh40Oyi0W+wfoWYXIw+siweU3qKdQM/IWLUwDjgMQuiK+CTyRgR/Cg+XmfazCLiF1JChK7C2x+ROCl4t2WjYngGRxBWRQqqrNqx1EesLx8Z8GOimBJK3Ip3O0TWp1z6fhibUBvCtBpCBH7Wz0MrsYEtW/6gd/rLbB2IcMxOrxgW5u+/ZBOjd+9Zg9SRf7ln5tqXgM7wZE2rj4u7BOezWvuyca2TpJkQOR8U/bR+LRjmN6RAS7MCfYSPtJWSbZYnQL8vGmJb39SyiYiER2Via1nlShjJEe3JgCwTOTiIQJ5h+NQeEs7qWkpIDJiQHb7VwcR7T1gLGhKAqUT5DPO5zvGPny/DOh+Lo+Xhxf5wTkF5p5yY0vM1gw2UZQ2nhCedQ+PBxACaAeuBYTyBs9aNWvYATPBLUtXJ3H/+rMIUQ3Xz5MJKdV6OhLEEK73rb9hfjPlA0gKO4j120U6VHh4AJvL3WqjaY/KCbwpCzUCADZmnJdpD4p4U5ry6/YuhcWXcVV4dFm5J8qADBWw9jPITjUtkf0lhIJkzhXLTcXQBZaaunvCCxyWh6ifYzNTTCGJcUD6DyfGam2zj4qdBy7DwBaL2S2IxicF7F2ubPDvx0+DEQVydAIF4Utn+/niyxDQpGlaaG5eRQcfYEHaZeHBOfZ8x6KnSsZnB8YZbLVBcEF3Mv/87cj4r/BYDYAaUWrrm/rWPImSVpvPlB3xQvVG305B+bCj4kIW4ZWzFnX7/nApDibPZxncAV04laDsD872g54z55DZylkUKHXF7Y5iFwsc0HDovYpJ1P+XIAb4pKZnw/e2BrTZn6jCeAAvAt6Z8EdXqS/KoRwK37xhZL7w17n2PYpqnoCtRAvnU/CocUq+el+PFEwM2GkhLBAJXvVbqxBMfPWlA8XMNY1+dfsV9Uy0C+WgSzcXw/ylN23DlELK9DPZ1nzFCvyDWygh1ABv0LXhuVuDEraYOrX0J/NpbYoxjl/mfncXN1DorfumMjOo/dWEk/OvdZ8w/66CtISpGM2htGRpT929qEz+kRM+2XpAqcSS9GOrLWVVUVIm3Ez/yIqAWm019Td/ytbE6eeYJaY+mJpelcp0h+4Y1hmcF9J6cZQEJi7foY8n1psVTCzE0QYMX+ScYxKxb/bU9eproUaSNTxHeNhomtba4y/CfLAZYXndn5ndeIjFIsRWRpwX3HwrIsKxRgd52tRs/iun5uy44w8u2wZgayiPbOTWGXUn/BDqak5EZebXbdQHyE0yEhUO5HcDnE6xlAuZFDSKLDTTZz9bWcfe1wy8KhSOwh15cBRibt+faUQgl7/5na6Nl5d1o7iUWTjOhjQa4z2Pha1PNGSn0hZFeICMKGtHJ6EGQbB+HF6+M2e8YSQjJ2cnG2SVpdzXlnkzxYqwXv0s0WM8nggSh7Viq5joXNiF3RJ0A9637p1HFJd2I7GrQ4ZTOWRi8jcZaL/25Pox9feMT7VDPV6TT++0Ri3a1aLS8IABZh2dWfxnBmXDWPdvrxmBiF3eePVqd2ZM5bI9YAN23/3qVLElDeD61xvgRdjkXkl2tqif3zsX1gGp9mzEm6suh1kWL75XC2kXlrCreiNi2pfI+iWVFJDXPd3MBNp7VSAZRp1jpt3ug1pQEM470lZXwotpDljklvGxuNeKwTuKNJw0EK74nc0d851QXL9P4pxZdM7pkmbA7IU2S2Xa/AJRP2VOz3Kyp9oW6FgoQi4noNkoHeNnprbQod8n+dQSSbMzNRZIuL/riHaxoOHkaGYwROCZwqcbK1tUnU2Qt1J+3UTvklj6wOD/d8lrZG7ucjZiCyHxK5XVtzq9lDJ4N1FvARCTUfnLeOLc5bmrtGvb8mmsr0lDDyR5607k41wzglZH1fExfmsXrEjiNLSzSKGb7FVusl07/BgeCclDsQkds2G654GVeUpX7UHaqQBEmJsIyvfxvz85+WyRaoYuQfSH9WpJLeUoXpUt7+Crnl1Jqz+eARyCmzL59OUUBwBuoQAl5VddIrfG6xvDA/RZBOV5AfwjOrJ2xRo4N42rCSFCcnOY7xfewl6tVLetiM2tGLqRLc9k/owyHriX1A9BnluzfDc5xdEUKyuwzWPG+tZGNDV0WLl1JyHPflzcBpj92G0AR0lGaMSZuKui5/LUMn69X9wPKc6FVkNEHEjHjQKPQjuFCokjN+N/6DlMscpE48IhHIa0Ghrc36GwGEiPRymXWKD/di92yfjZjDM3fdHBdwSxJRSBVKHSwh6Ey1/zWZRZ4kk+KMS8HuroIw1UPa+PDVpsSIKvmqZnZisbfHFWNW/dl9n5+wM4VIzhmrETz3k9WU3s+z84SHh2f7dGT/G5WvoisBYAgwm+pqFS0A8xyhy4PiKfgS+6TgnQD5hDEerpzgFSaMcw3yvDZ0+xfL0yznf0uY8N6APiqHdoJZOWqTPnTIbeBLc5dvFdh+mvD+sDtl8BAWzYR7QkSgnx30Ru7TH5a/g4byacurCNvG0lTgpkj9w42uqBp1zMsKr2riOCQwfCRKkuSX9CGADOYGqCHh1JUsk6RwvI9OvM9fCJoL7Sap8NUQ7mAvdB2ougA01NdqxVo8NeGta0R9C7QybiN4uAtDxw2zLTG9+0we68JkqZrj9tJilUV/f4wOLc83GfstXOVF2bAJ6zf56YworQQEDj6QnC+lqyMkGAr0QuAikm0jqS7fy9bYSBz5hekPILc94b8aUau3Kt69QI1kFEmcb19aFQA4bSegA9/hFi61RDIVQ7iOBqViYdGaK8d3zH5qWIjed0hR9e6o4zELdXWhOVOcPCmZIYYXvgUsAyGUoCszsCiTdwOaPEL2kRnYh0mNSZGb6/kr8XfbyUdbEZ7mDBYy0yTDxhkrpIoJmVutN6FHk/E4cTEolaGnv7x+QxQIKZus8IEygpdtBDxj+lC5M6HaJ313pLDYbjpCA+oYl11ISRJ/fB2oIdDBHFLefQmF1uHk7vtSmIyI7Q9HG0qxu8QRWecP8ipKR1o4bGrAhR2KcGEDE6k8r2F7N9lNUZCswXi/EXaOlPb9fdsaw1Sspku1xrmyADIImEs//XiPqI3Jl8BlrsHf1mAVCBmlqE7usMbDEpilt45ia5CXzVqlIZ95Fesu48LEATS3dyXVEjwQAqVbFBttbLfXvX4LhaGKv6P3XBsKWvqEFfq1rPYdohHtQH03ehlVMpZ/BRCBFV6dffGCrIa7OngRAbORd6wsIcR/gQSxhfrfHFmb9Ws3Pk/SikwIvAIYljNbXbvIpKTROSiPcmBDp4hxLkrjR+MfBFZLV5I4usLY6WYmjhT2kzW9XAxxLYCELLIf6lg6p/GFgpoRTm+yQ6PYtmKVvdTHyBxv28y3vTiy+reYBZqmC7x0TDasiMCcA+TxdKgDY4s61MpZyI1+RUzeMfx1qh9MBXg1tI/HSKpcUj7+qTrwp35J3ezefo6UZiEWMPBtx0/tJyaej7NUmUHVRBJfB1q0bsw4yHfui2ZOPNh/6R2/I0j09t9QGeRxpuJzB6DNbaPTOmER6WTXYEGXq7DhzkvCP247uSz6r7MfaasDs419fVF4RAt4XoxkFRmk3sjrhpNSeuDoG5RpjE4pI3rH/ESPaF6RIIJBiAbVU/ct/nKrDmBQPBYlNob0WmW07GhOvvz0m/BXTsPB8qA8Iesm6PsDuOLEEm5+jbniDFyXfndwIXHgWBB1GCyGV52MU+5iXguncQS8T+WyxaPDqCCXMjwPJxGObdF8mBkG2+SpqaBQkeN+1IL8Cbb72d3ySQUR/uO+N9v36KAiKVEPx8EERU0vfKi53JWN50+LSYqgHmF0UrnnHCNpcwfX8ezokGL4sK/rgFZlXnIqg6a8EJh7DfMOwMgTwRjjZ+TrXsj7SA6EaMRroFgxXRIOGDPYZgkadllrCosfuVZqNQwAY1cDJzuD4ocR7PgZYXbCA3g9Jd1PRx7PyRTNad56qFMVIv/9AYYd32opL/KQOuEa2LIoyMUHWsHVeJEgDnTAizkdfigKSmZVUDrztoGXA+B+9B+MYT2q5BETXJUKRLiEw3upTpXnlh7hkEk8/0D3rV1lUxxSlnDzLfFArxdnXRhBNu085RxiTwTISjItGPuj0MQknBfLTi9AeLTT9QUKRG7bxHm7P2Kei6fVAeNBP31q/OVsTuBJZfKaxLodsCxObxFdyJNLV2tAt+2SCAO5/VWcDOd7Or0wzbVGwbXJr73+/PYn3VfNQ4CSxdqgXNPWDqh9ZFVRQbSeb+bFmOpdkO7C70y6dTSHVuHlIY33/KV1QHDJ226atG4ltS4fk0ZNDrmPZ2Lps6qyMYO+Wkmsyw/ECuxfXcZ0zM7vmLjkk/LsX/XG0vaL3KZb2C51I5TVf8fBJmMxHHzKvaXDwSTGiya0f8ZZ3olqbqcd2cjXM0jicXlX0cJsaB81POyuItwEiYZwsHn4gymrnlD0mfAro2YoSC7KxDdL1DQVO+0a7fN1fLkv8ElaXx46Z8EGJ/W6akIr6uEuiFIQB9fHujgNzIzAgaDEYVITJJO5XQkyimdgaTBvra1hUbw4jb8imqVpd7G9dSoQVNPatqBlbm7NLsdI/einfpw6HdFlo9bpLb/wBxf2BGK/YWhn6LhzEvBuRuBZJTDv7HV9WfnA2SyT3HV/F6f+23aOYC8rxO7QQ1FI4/0m/OAHdCwYedzx6F6TIlSh668B+Id3ZxNP3V+Z82Tt/AHYSzDsxyYC8mxyk+Za4Q6u8y70AKpUm1NPP2WMeSHfqCc5mUcG67RR+sJWZg7P5iG4FPnFmWKv1nwwk+fM0IIA5p7xmHnj1zbj89sN0hc81tzI6enBjIyPd6P5GXzsmp9IRHKS506SAEK7IxfjQLxkNK1x+M8YAYLrD1qWXqo03kTvXgYllmtbguZX1FQGpXYjbZzgqSLxcXTKqQ/GhYqBJzZtvPaYGODBTozt0Rw6/vP+hTUJGOAYcEWWr5Mqy4792lLWmElkf2k2HiF5268DSkEL2oQl+VXl2NXgbfa8xxQoI7lpuNkURcA/pNz/go3LD+w41q4eQy20ecjCwekr0XfODump0XPUm2vvNfk4P/tAVA2PLhl21zoFOrSKjd6D1AiMtz/f41uWlBWCDDY4tDRMhyGsls4GW7P8b0/dGx6VTgC6oCCWxMyJyOgl5RPaFDE/EzGGGL9XUm5X9L3crn0DvEELm/Vx6HwlGWtnfZK7dA8/zJkr9b7PBgLeFlmXyfUBxZHF8kxgW5tcxvkEz0roS70jNLvk3QNCTUIwCHnqk5NRDEaewDCzjTR5lKzNzx1RHHJNiZZJ0lXrAsSM03iKPyYNdJfMwUAvRlKP49yIx7XS9cvseBWVvGNAc2I0PmR6Xc9KjqauqjgG/Q8i16OIPtQ2Ll3qDkunTNq2O65AEFG5qycHaB2/159N4n67iMEpyNowNdkq/ZlDxsX4dRKNvBUJaYqhID70qa2Rgq8+AzqTaJhuYrqrDDO1n/0rWggrBcFsYwo7ujJZblKGamFf+3B5MTAXNUOKn5PW91Gx56gtqTqz1dYMML1dFR/KZUZom7Wky7v9EfKnYbBseAvDuBFBFFCuXnhvWc/JS4ipUIe59Ls/kL+W5lteo1xt5bkJYfug17vGw6cqrOjTG4nQXZ+RbEDCMTf5JZ4DBcuVv+tGPyucc3B6R9NMF/lc4ubulrqcBPhRUjGBILbQ+4uBJ9eUHMAj2ijfMskRMLcV5FdgqIWhiEvxNVlZSRrzTzySfBUjZHCJQtbgDZ8nRWLwk6rQKWD5aSHuJh0vBgvlNTP+a4P7p59l0FYBPtoNpiFl/dOo05KHesQCueTxj7IB6io9sqTWxTu2PK2C3ACiXWNyxs52441hxg3eco87pSRV1NUvQeac35o3tgUpXtmtl2yHh3QO1mQ55wSqIri3PtVxJ57l0nOuyav/0ixzLEq3QlLZmLb8Y2JVlrdQMjhpcC1j0DS+VHrYIB4JgyXacVu9PCRoC5Y2+p8qfeJA3OFreaabxWxz5omyn/l55+ufQkO5e9iODCdLWl2crwLrUpaMCi8EUcVXGb3Z8oBCUdwuuohn1sivwQp1O+DaRFYXIbHQibdPfq4dU8WeiYJ4WKMlNEuQr/BRIGwOrAIM3Ppjmzvh27Lyx6xK14sUHgNy2ggNG57CBbXznFP/0NVrUQef5mMdso3AJ33SJxInqYebzcZ2pEVYHYczXE/+mcptBHb4ANtGohwQabL1xmFHav/wFH/al8TKjzGnYiFLEifJHL7OJD0x/rtzWuCrDToEWPBNtRKXFZqz/kBH6gsxzy/TUzP6R+C/A456FbGm8soK/uYyafgNmX0re6fgXeehUvtDCXdAUJElJt7AMv+VMdIrrOK7TAaHo6E8Khx1rq48yOqMqtC08so9cQh/AV760CiEtSm6PBL7JKCZBV4m7t8Gbbc4TQRawpuwTFyS/vt1JBnAQUBDPdEddlJlVAfbGy+OKkohOw9BB/JY9rDZQK1o/kpfl82umHijUnj0gVqhJCsrzUxYl+ygkRPDEPZqUIo/+AtsGplmBSxL8bUE1iBc8lCtShF2iqMC1DdHIH1DcucbSNtxOF9LY4IMng4T9eTYzDr+gnOPVxWBYMambJUexTzxyvFOneFg3r4FBEHqG3QZRgnKISYUQKv9B23A8vhFRe8uNZpBtiMtXqOQlVEbO/HzkRbqVaGj4s2XRVlhO+ewkvEaTp4pNLXG1OVF6ncxf3Fq94KmGuG29LLsFI1fuX35J0TsRNGo+TCioyTrXLVEjPztNVQL1/q5tGSrMPhfJEaQxHcrnqhVVqN1gfF+JK9Pgcud/lGa+Ig7eKQpJuUN+PYhBYQ/b6ahi4nLNe5+d8rQlfK/gl3OQ3WDGWuUMOt1YlBKoX+99JWlZr6tTAVgDF0NSHs5fqbU0euO7cXKnvVB3taBFHP6/KKZCBfGqzNo6DgZgiAELh1EYOni64dmOWUuwAQCKu+L8tnTFLlL6uKkaNtO8YGlOBVU9mQFYx4aGPgGEI/HTycxYXBClfKbmSErtcsuhalOh73FnzRz/thPjvRJcRwPtZmCHs1nYjivLMWWGprl4fRUOlrCDiwNU+9TZuaVsuCxj/4DzKfcla139igH7Z+0uskWkEq/c0mrsRLlVpl8ln0G77hwK9rLKc+RLeI6KLKy3Um5C6Of3qiKNoY/7ad3EFvdP4VICsuTMTii/bee9efmKAiym0A+l3hS7SofuEJ46In7BEO+Kf597wnd6s5mL1d5zNRBdOEmfNKyPdUuCW3u/SfFQes7nYlfV/B1DOE9p/pmgK+bx+eZdZUMu44uBGlaPvej5wxU9aumiyt/uCCZ4PyO0OYfFAMMqTaYcI8GxYeHO/3tDJsJisLleLpS/gvPLbEksIm3R4OCJ21S4P//uyzQ4EJZyYmWZjtknKJbz0vFEi0zDWnZHl4kvpMSPlVI8cEAG5r0JoNN59joEsMhUcPZ1YtIDYX9cnR711x6SQEnBGgTz6d3b1iebIdotlgqE03w87xlD0+qEykcVizaOB3Z+ocaMGWybZTIdpR4niV9mDm65EzKK8VQq59iMlABk54A7zAlMdkYNmaRuWJN+bLJ7RqEZf8vrpM0+3cwD0NctuwJJA13JIJVFlPStNIXzAW4pp1OnTx3rMZQfF+o4p92WDkF2tx1MUdC14Er9l1RlYsEYnOubj2IotL4tkgKwnE219ZsjXb8PJFkzakaWhRBJAkgbR6myiYFsJgC/lellsN9g1ML0j4HX4rwIzHbq20FDkBdfqN9SUnIbJf0QQr+QxHx4f0kRekXaqKZYUXYMbRKa6OObLPOaKGft7xFAgT2pHuSw7kdfloER91zsJPWQJbkAzyDFkkgUg80kW7n7n+WBN3CMXA3lU6QR23Ipx/98577h2OGkpcp5YiTX/TikBkcza+iwBGNBi/j+GwW8tGbKxpiSNEQqUDdqfscbVMQ+OSYGoeQKSLwREfUGDjR/emc+ZAJsy3sraTZkpHFZAI69dwO1dvsOw/Q+O/2lgghmEsk6NKzmfI+OYuOG2UoagP9Le/y9UABk4VHk54+6fW891qe1yVDT2KUc5hNeePBaQwVb5BQYPt/+2xEpqsHC4GY37hXyRSGvfwYa7DGUDbMKd8vud28h67mpOl7fe4uFRe/HOKf3TFs+9RX+QpL0+C2b4R/8VfkUQOABt4tcaDV34nU/UFXBUDvPYMYe0F24AZPIWphY9bLwt+tWvmuWwhvAgPN1rxvo3hpXvQNSPsVKgFUKENrmSCjWPYCUoQfJFpepI6oqpsVwJt6IlBFGO4soABNOS2KtnF9P7E9sSLK1WWOdGvYNhxKO5/D5ACMSM3oLy6XvjzPe57hP26DKKsIbhLZqcz8tJOcm1zlVKV87cVqDh5iOgGkNIKp7JU8eBp4VRPvv6peu3DR+ROhro3GOnpo6Cdltkq395hUi+pDXzwcONA2YjC4BKvX3JGZi77wJboSzwwPelRCe5297Gau3hHdjkNfDMaoCdfo4BX1IthlFNEHUm2nTsuiPe/rOux7FSlxIwT09NqnvyBmWQYcleqlPEreuoCZRFvXL07v84AxlxNdJM/atDmCjpmzumIoYOf4uVqV/8ZnSwV78WW0S0R7AwI0EDq4B6IaI6AUBwPrNLY0eeSw24zQ6qVAgBGW5aK79Mg+Skj4XxdPl8axMl4x6nwmnAfEBIju1ssp4yr/gdi9kl+ScGW3r5NVqJ1fXRkW9O0A6JBottvWGypQioSH2C46bepNpt5dXRK28XY0hseEnW9fDBaUMHziavWy8Q7jttulrsjOd5WunqGz20rPiwX/3fdKuQgv0g4CDqGBMamo9htCyKqN0qTOxWP5MmZG0lur+eIMwtcrfYqJujT19J3dps8mrCySt1MRdmlNIykG8cIMszw/nMlRV1DmpxNn2zf3gflXm1sXSH00EqrICj29dnyNSbIteQOqjPLqBf2QDDVVCAgcCz7vER9m5X4XkTIeB4ppqaFa2UHE05QSkAhs7FkyPf40UFGlKG8GnrdKq0ZLUk9m5jleTBwhdDsYP8HCDKRE6LS48qLHD4pvSl3XFvmH8KBEmyeyNwwJzAJQd8MqhmKsdandB6Ec1bHOw8agmVGP/vvY2C60X8AnR2r2HhdkUbclW9+ozjmxmipA1AJIZnqxg4aa1Le0RHfU2vkpf68y/rFMYgCXue7eNqxoS0NkOw9a9/WcDFJOh0Grb8zYjPgaSDENIFMCM0H5OlIqq2r2FKGkaQSMzVm87r9L7fysa4xxVMD0h7CIExLBVbCe1/r/WavK3yPhHVe3XBjyVTDOqI4/90N/Cm5KnqxFrVYOHbwMIXa3GwNwVME+38OpXvNwD6l+jN8BDCRDEjGDFC+WObTdm+5/tfm0QeEfVUYFtA7gTobiCnl8rywroMyBHNClofz+W7OhssrGuos+fRhh8kBA+Ni0fYdhKK+qCZaY0LUDpn17UUKCX6dOZccCYzSsD2iSQP74pFnhlkOzACsapdT20zbjF6ZqLgELUPT8IglaX38zP6zfdyBF+NjNf247XNtmIz4QCO5iRy/GcS8jjaWMfTxI3EbUvzrprtgRQDOz/eMnyVQVbbFiTMZfhfQLeu+j6iY0Qs/QYGFdHefwzAYuVpPhVZK/tXsy6DAioLlmNDzAu1eQ5ihCnobO+MOZtSD0+uTpiOAvPwGWf52xDUHj4zbdFtZULPV4c1TmWflDGMkg/Ia6kPHprHErwFTGoBg+1D6oX8lSPdz5srAF0RbktUTmq44+USAYYowZQOVbM3BWMc603Oy9SQD3buNTgzJ7yaMBbo/pjkzVrpW5xYH0Ra11ykiz32vo4nBg9Zvm92KHWhJm7uQJV5DMPA1JHBWBMcjz/uZupwXqjoTffeHZ17N3waXUaR7cZDs94ewlhsbQrmI7/A4zJDUZj0qKiVQhn3f3AneEhDwl6GUdCBdKY14q9n6ay58twW2PRXXPJ6UE6TUs6oqH/0xgDpP3bx/mfcCUy5oo91agCPtpTfowGZ0tyw5mIOsUqvdURDhjuWLX/WIqaPlYx3zmJ3ahTcxtC5xQgKWrQskF57LaOvwYN0lzIwz/joNYkiZwLyB7Joi0CsWWRC6SapEN5TClIisNQtNPmfwKaKYb+Hguo76RtcQMXdRZWjEJNHq8KZKeg/uWWDOW6aygLP9JDrNNW7JfWDyHPR8GL+29zBAD5FY1WZXsmYfdKU1VTLLzAHERJJGTpwKZH5k0uZrDYM8zG9WX+RVDM8bsmN8cI2wKz0Td8GEq9T4DvY6FuhMsqPGHC1tkLdxuwBYP0Lu2RvjXaxodrZhKfkkIwGcfm+lFS4WMFPCz3FwWwuvNLNqv7c85xnk3aXWl49yCW0YTzTqwyKuKWSIFJum5G8BBjvxx2yDOZMh18M2WhRGX5VA0p3eAilBsGa54P+iEat2c0lLnTrXg7fzDLJrjO/213hRmT/92zHwHShntUiR+9KUWKWRcx9OrMWfefEo/p2FR7dbNWoP/P/se7JJUfBzJixcPvTzMvSTQrccDAmpwoLnh6pnsAF37U9Cakvwb0EZzywhYhfUyAZ4oAu4R1X55yrbJifKRbLIC6NaYqZxbpzV9ec4/SFSjJKEvmVGa9tHfUJayAvrPPbVHNaxlbdJOOn7f43GTTdGGufXu/daAhuYtol2y5rFVUxlDpyKCfYRz3fOyJZEjhxizetlF5kpK8kUuEpKNWnSG9VEdmcn7Tu0/U9Pho+IZiTincXepD9zQXGusmr6j19TKRCe4dmbGmRl1cDDNABYeOKT51fHc6+d1Q9T2n1UMmkd+aiSUgNIrogqtnInezaEs7HmtmpjKttWg7ulLhPvEEnGE5TqPY3iCItPzYojGET4V755b+cNmqdG6OBTlbYjDs4AAp+ho1Iq8R/eWa0/FOyB4K5JLQ/WqwpaNPuaoufHcJMEld4peiw/7uIRZ9U4otV2lACBY2PfSUUu7vJ/iZUtvPoJmd8K/BmbnNo2iumTtQxEeARnjsHdzf1JrE1L6NGFsI7t81c5GCgmWILKM5pWDA5HO53I6aju6916JkUl1YcYyk9Hwwf/waKzGbNaeXD2d1jBd+rriDyPgR5p32kxAb41vjMM5QjUrVztISMmbVDBnx2qArnLJ6ECRGZcfK4U6LCAMxRtE+Y32MobWIYqbeJLCsaF4pCXyZjPABVmN36NRAavX8RXO80JuF2m/Snmg2NL0dSW67EVH9I4fcFSjpL73r6ohLh/V+uK3786Tpz4u9p1byZEEFVjn4eK4wBNeQ7DGhdbFbRTt6/9b55EBMfJGakrqZ4U+Fgnh2uIpidUcG+iBjHE5HMRX2ZKkKLyYQElkw/Kbj2w8OvDaxd8rzWoSUnwkiP9DB4L1FBdrrf9anTqNfPehHTBlyG9cgcQLrR8tQEZN9zuxs8BV1Zf+cIk9kSStcCODphQCbZP7NYhgTuqPh967gyo6DhJVEeM/gq2arEo3NkVtX7D7mzM4zzsjwEazeZbygY6xwP5F5NLqPJ0Hxncni2XMn/GdHQmTbQF1zee4LOhZaDlBzMZLsKXcJ3sJsBmPODcSW/FKYiVgzz7wLdz0C3bFpTwedWpIZzG+H0kpS6hOFF5yNj/xUGHEQK75qxYUFuXq2vFITPVf7aaAWUF+eBV5VbBqFcUccHNaTmGaDdRTdXTurKJ8ATxX0DHWz2qNhGP4nrYJRCKI12hvvahdfR6RlR+zca42mjybVuHEEGrU2KvnHy9+mmlQDH4jYHZKC6knkne5Q28ldgrISAF0p2u8YVTy2bGLZqUkIV6zWDXi0DuZMiQhOJwUgZQNnrjzpboxif7CaCAFdxHukA5fPTubF6aLOTWCnS/EP8ZSOIyNGpkn86BVLEgxNoCo5XDdJHdnSB0Zy+5O4NQSsoKdZzikwg0eSvXAE6j6WW27irlXjNHHxiuOY/LaFsSgXv62JfK2/O09r1DMjpxv32Y457Wd8wFBf9V6i6CdLP2Z9qNFsxcP88S7N6b5FAkZAkO78T3f4mpUVnXed/QQC1AAudBr+gg118i202+jHf4m1tBvD2iwt/8PqoAWQSajReU2kDJ91lZ9cqfgKVbzge5mUlKDSh7aeClFOoVz9UEdTQyNyjj+u7JaX9DWyqtt6955fcvBJF1aKEjjPQjYV4+FQr9Fnd8NqWavBRL91OUcILzXVselzvLQtPmmvtdhkUNi8G+O+b/qcVyHvls9lJjRGbe0YWtuq9zXA02yIjtBjoQd1vY0EmEFvb3u3xiPt9Wix6NZ7ljWQVbw229SAPrh/hsIECHTLmxKxWD3/K6TUieQeqJIfpcIoOQcgmvHDyyRUevzKImeikRzg+ly1+qSicz7hh/DCm/39Fyk6M86XNkhcEgJKANNt1matUHBPuMmqkqR0Irsee0uIofjg8efSzC4Ml6OzAV1PuydANODV+SaVqKrg8qTvT2ROpiQHqoOAq3EdFRo1QW+1ak/AYmGEVA4cF99A82GRm5mLHhLHqOSqBVNF5d+tjFko2morW+bAtWqE3Mhi2uYPJEeL+puWOoJaLV9uHtQIj2GvjqEnPiF3gSNk2kq1rb+v31DDwcalu1nsmfE1n7J39uQgliDyyoBoudkZrUtnIUrDsC6iGs/DA1YU+EpC8VYQ4iw91D0O8kJIRK0Zo3YzUzYnm6vxq+9EDAP5SWf+Eyupwlhcyq7rgfu0UcsS/cyy18bZBvpooyg1q0GNkTJ+MwtXBtDoaChHEqMdF/a7GjUgboSb8jHDJrfqRhQ/bbI62r8nHoOa6UgOaJLxxg1EhXpXmkd3Rch7uNxgpPzxP/mBdrGsygnoth1z7Q/YLYJb7LwpuGREdhP+ef4imi3CBmJrq9pWR8/s43S4uxqNYHUv9ha9RBACBhuz+S4xTQTZaCKSoDHnxC8CxGhiHczvJUTlt4rrWQpu9+AvsrR2wMvwqpTTd2ETTsO/P3JJiLBUvcs0TXCPCRY2h9Nx8ZqMz8XSEqa9ByDLoNM8PxxK/62v/Wkztb9dlxfHsl4u4UjIZo5lD7knNDevOZvFRYHhwFE22lXrX+Sffrt3y9R1DKaG/GlAPLQQX/Hetzpmce0TT69U3cFZSUWj1hcJa25OoCXx3O5jXSizjPu68eF6JRu4ly0GPmihJAcdY54LAu+PeTtHdGWaRfb6RVp9zxwP+2PoTSQm+qFhD5LkhsYuT1IwWLIAUjU9P0z7IOUj2QP4sYABt2vX5hJCVUnjOBPVGQTmwyR8LSRc2WvhlmD4DMitovW8AmruHvsuxxMnY/ybXB0f6jgvY+7tMu0sJN5r4DBEBXa37SH5PepbiAlY5L6+09qF9dbg57qZdXr+Lkj+9ODwIdoY9Ogs9QXAMPBK9sNLNDM1mFaODMVpqeBBx3+/X8BkyPofOmxl+kYJsG1PP50FDBXj0A4uVUwSXOnyDvjHd5pupMiy5DyOMVDjPDi22YVTeKKPxtGz5/wLm/x/DzHO4PBKlriUyR2fdazZ8MZwZO2yzm40RwLqezNhsNT7aqhOqWBMfTbYcyVtVzrROKLQ/cw8h9MBYgLQZ5m7RtajLhjAmwWRubbOysVY9+MbTxulvSqQymjxTj0/yGmowXOk8LorLHbyciHZbi5Wipq5e028xOnXPq0SO1Ei/BmXFCr+iw4toQwld1d5KXZJaq1eDPduqLEuVRpKA9CzB7KJsTTpdrYpMaOsIFM7Wgr9Oh/caoRAohQN6A6HSrmbUuxffYlS4ymc4W40QYfauuqpQ/JTXe2l3gW1vBU3Q0CQWi+YnGMAlM7QCe806vIrrgQmejgYb3z21bFn0KNZj8qMbtk0fubcrDYYwmBhjZezZtAK7N3MQKKCODWwtmN/WYEGctudKJzRB3xrBGIXPbh2oyOsQ4psvw2packPl36ulG2AlW5rvS3xsDrZG0jPgcLNOBZVquBKudvtx5EyYnivmLREWPn30cbkfL4RsfTwuJVSFZZJFh6UkofGq/bkz/WqbPwyDk8xppCVNz7JQstijvxEWrb40THMQJebLnzyY2q2jx2SLecaR7/0b676f5ddR3aDQqQxzS6YlPvFcYbw+8vic5SAk75H9CSsEorQCVlJSk7DU5HBRkzDnV2QtTJe9fsfqy1sQNBXqUXzv+3HDVDSjlHNPKEmNGm5+zlEP/Pa0mLR8hxOG5PeuHfsO4YAaC+btxGwKVWC9Se7tv8fBJBx1n+Kox6GyPB1SVukkNQkjh9dl8s6dR8uwRo6Ep3zrpyoDHwNvpGU0zV5/27gpveUjCyrt2ZF4TOPsS/WygLkfE2dbNXsNDXjU0kggbh+REnbrOGVNbeYAoc4ZX0aRdyTYOFzlRKaGo4MoHLkMH9FMwYlY+jItBYVbIzsByLIUmu7xM7N3q4VtOAzdBtYpwYx/5yTIIJ9yh2VZWg/uPZimDRgASUeaIeF/TU+n3NBLOkQvsf4CKuJi9s4FqpE2p0HLaw6yIcFU8mcl8Jx6XPWv+eL9Uv+Eyr1QVYQfaJcVwJ6kjFn9GSZ3uvbIxaZMwi7x+nNLp60sgdzogotqc5oVT+LDsygUDk+S361me7L2BWYFkcDER/Rx+J0tgDZ6wwKRu7kFtxCpqtt19WgsF6LzpqmDlLORvOsY68JnuZgBdo7ozFmFR6uGXxbySNeCvPKl92vkVsYEYjZ70nSsNQz9WiIy0pcd4Cjnd16gHVj3X+IIr+ZH/gTnYy0JQvVtpoQKA3yqTH8ZK5WAWFLSXjNeHCwtYmaan6uJoOWW3ktmR0n9j0uxSEniCHfobcaa4adhh6U65iKCHer9DsvpoFJxkj5jhGLhPSjJ+hLddzatV/1Ocn1CE5uZoZAMtgkhUYN5zk9+VUjJxOTjDsX8kQFan+fCSw0rK8IhXNp3dynfHXSYCNq076Pn60lpsgbLC41pl75UNjAtdkXJ0OFBP9SOFxYd/qxoACmCf2c4BNjgll3P8P77ikGQPLbKe6Bprf5RR7SLTcoLj+WEriYD+XvlnCQ6gwN09MIkc6PH+xS8JfJD7iyBoSsLx/L/1AzaxG7e0eIP2dxroERhpC6jg8arrg7XQBksDHIJZIPRhy16WjWaucMUOLtxrgBU9rezETjoCtMnBYdaOAagkVHdueRkp+p0+SRoZ4ejQaCwhOiYRYYJC7NsV73oO8dwYLioC3qILoo9B/eMud5uERJdTB+L3gaZcXObntZ43fegezhpmSwHyw4dM10xfsXF1MY5XAR1XmGR9Qz8Yrc2BSBiUUf1wSye1tGQLKtmsheBI0zWEKzJu8/tdWQ84lcWgnXo9INPwDU5XiJi0OyBQbwRH1ahR14L10g9kAYWlDK/0N3VzcgYYursjTtw/2wSHmfTGJsx5NOXmMmVliBLLHGu6G0jFBLZtUkH7EzFzorhlKhKRrLqXXlXpO8crQ3CHEcZLu9XzwCc9SvkPe94gxwonijdizLHtGfLLKLF1cdtXMFa7Mf4P/JQHiBZIRXBzCKoqPaIuvh7X4/SQdEJnxbsIECUF90ZnrLUpBjTXiX4XAc3Mse7eTXKyZp8Q3Sf1S3esZyDQl+BBER4PmbGOeQ+K1112FbEeyqQZg56WiQ0jRCUmP+Kew9A1ZxSjutLVOfkpuBwoSkP4RGNoe7WrmyTXKI6nk1Tnz0oe2Vm3PjBDf8Gwhe+fwAYSAjlPra1TtCj1uu1GcdIAm6ViQn9Srqf1ym9fPIxInLxt48mCIl6DSTi4ZJ+XkJrz2dXWQqhpSF4nNWapdIjJH+p1Opedufkw0xHlr4vORb9BCJ3W8vAPdZSqI7VxbNaaOfqhI/8w7L9horVKv7MLnEr2l2XgUM6+i5Ix58xgRlYVxa+ltEdaupD5yktPEOlldMIatEHTM9j7h7hxVvQPEbtQP6BmDdVaPz2u/o7+Aiy4lsXGE+Km2ss6828uqY4y28croxcwQBaemP2+4hEA88WmmXnQTmIMFje/i5qVzP/dynhApy5GEB55hU7+jPdveexxyrULupZB1hjyqISvKscuKXOXZUnp8dPLlTkOIlOhMu9t4Vx5PLPIDK0SdUiZ95AlS0+/1macnq6hXYYejgXigt9NePxN2PY9CC0HftH0q8httvBeLZ48ootbmSIZgK7/Wm1zqq/lUDZBL6CYC5KDyLg/WfRKIQMNyN2X432uLr/f/9AoV132hvDNWvIbdgJKmzFwnqjd8+MjwrCINW480Y/0ve7EpvtXHg4WzJv5MuILg89gjdMk86QRO9Q/YKdmb+HV6eMqRTq/oudO/E6zvH3NzGgHNz/zI4Clc1kXUMDTrnDpBI2KbWe//7iI6d1A8nhX4F+4tGki7hfsA4VOK83fdLmcdAGqQRjtItVXa3J7vhE+x0h3K+fVJpM2FZDdY7gVF9ME1rtQmyQOE+F7b6vQAUregqMnIegpxtIKRhyTvfx+DFWZLf+VUZHUO+CicH8sE+9LpldACFUpG+WMfE56X+8xIB5l+Eu4ij2kBUNYythq4o1kyIEuD1kt9XQ97gS9+waaIHokWae6jm/Y8Govgmk31Z2M0SBZAIeudbA/y6RkBys3zsWVHoPxD73jIs92cougppJ3Uxf/pQcoOw/qt20epdVJgHhT5/Rg5mNf+bvQ4LJnwSxs7VE9Qc/myZF4IFBUAom49bMTIghVW6RJ2gfXkP6ovc0THTEpxZWx4zTkARVTfH75vftaIkZptS+h3ERciwL+zFBfxojqrdRqqdkYWAVmXpf+ueckOfXPrN5b9eEwl8OJWgoXwyPM73RDn5ix09+qYTUbhIRquBAIHnO03H3q5TFdSXzP+sPDF+FV61ALiJwLttts7/NF2qhFJI57p4sixeZfoEtm0Dg5wGwPCH6tc6aqO8oe5R+IkDR8TuyFEN2w2kBdTxxvejaSoap3bQlCW4svakUIjVrpe7zCbbcGL0xSe/T3hysCfb20Xj0oFitmmY1Q+1QAbHJj3MfeeZfxuvYYoF7mLnb9sF2SPQEFrRwt08qapY0ODw4ReEM3TamVg4j3BvgKWWLIeWrMXPSM+I3hBzjUn6TbqMNWIPDWj5FBYrWBwXYB71BOpmX+5iYomjHoQ7LUcQ867QRS3qZXYnBbLy/FO2tEGfzE/rGyNxED2nvMySIIs4Fx3fZIsIZn/tCkocG9krZ5TWha4eDI3zmyCQeBMYsXlRDNsMfjEEBFh6/Qhq12c9IUp606kEY5bwbG/QnU+IAyJhlftn2f8iRL5A7v4R9oAJGU2GYjNHqZUGg2z6az4YMtQyXcV9X9WBRlaYnfVIRsmuVGDhDBIoG6C8AkCK6LdXd0NgeShgVCNpx7iacd6L5r4rVi1Gco6rCBwBfwyIJs4Fhnq8IZrURn9zhkJ2FenUPijnbIom4cDNJT3zqMfvySGt4ko2KqwoGDH25QLfuWMbcuRhuQwYKgCX9VgClxETR6DM5DNjTv7F3ysG0kI8NKZ5AZDzjJnJD4VVPwVR/fNKHpzgM8QQGSapVEbQCuiSw0xjHphp0eDxZeames1Mp9WwQ2puhmhj5ql1Lv0eYJEpN8RFa01yfNY0KZkTpYzcO/Ckhbb36k9esVXSMPl1G/K7/sR9Mcqvz7tEmdFwGaO02c6azfLxlRg6byx5y5aqHXBgH+N8X+0pGSjHsaENs0tEcJU4XtLrRLBJGIFVEe3TvIYkvc3siaU1d3xi9t7TPq1L/+hMRqojqmp8jBLyo7KEuYZeOKHFM3mUkV+XkyhiFhmwxtLgSsGMbh8fE6hCR2rTOIinlmsF74yj7IpViQkLbyCbrvDt5/yX6I7Y1abrFs7QBI3D9QnlxlwbgZHvFTKeaFKcI3NvUQFQURMimQ5M+eF6vwSlYff+7/cWpYmvPrIh9BVONzVYOe2tQdAWWT5fJSYL5Upt0L6Dl/pZObBEdo+FPC4b2+iU09eJ6vb/kc2/uq9CvCUV9KB+C/CPAJdOu7vq8wf/Yxy8081PEnm7VGsIzzoFYnDvfYTUyPhdXV2yICWljxWqkyEe4e1n+SZCRACDyiLTdzj5Dq5ThMdA+CNJhV09iM2iW1Pgf2XiLDkIpNo8ugDtNdVTMEBsO+uHzrqEI+EwMOFr2gevD8TkmyjvrYH9Bw6rkARUFwc7DRpOCIaACn2Edjv7bmiS3MFeVgdj1y0Rv+v1DYqY6EwHst3CNlpq6XBW7Q/fu+F1R20aHUR5Z1LIZ7wvY0E/w99bKzAyUjG7671ZUYF6F5+Ynv4Cm0twLZ+GTrBp8VL/LMeq8XYgzYldrklMglyWJS7iWBhdA5GraO3m3rO2AorN4N62bHcpIhG8kbvIkybnRVTEWt5a5f7iIYJN61OO1gLp+lMKa9CuaUR/y9eoF3/jHgqh6iPSadglFYQ/GTsLkzIXMTFtBelXwJHtvmQtoXItuOsLGvL2IK/M295YD8SaNfSND8zTfgUXGYQRyrzsPYC1cxWOto+YkW9R3EinZBFUy/5HWXF6WeqLcPADGeJH3U642mjV9hMqA/GY+7DcN2bpls25VizlGv+FyH0qhDmmd0gUS8y90rDX+Xk6y6McJ6S7gM/DYcoTHv/2NeKg4rjMw8TqrlL9LBcLKWQxtuJxVX7ObKDCs6fNlfUj6iRrGPFdJD+ziFknCJKgixZ5RJQEQZi2MefRmUYi5crYu3Oh50a5Jf+upvNzFAo7KhxO8WRvoqnLO0wvvdcPsaVUOIcvfZoUierdTyFyoxwnJI91KCBroEodybtBGshuLseewOL8RJP+H2Oqsca/SYdeeRtivXY+FFQeTQ33eeX3DdtS0+wgHXVCCQk/CkG/az4aY+ExO9eyJRmpeKAXose57USPZEoRKo6m3uIY0rsGhjw0xAS7X1DuBTFVuo29v3dChgu70cPjpl5/xQmrPdA36PXNZRWOszr9FtTYYxG7dHUooremnYo1QnUGWsN/xygLq9TDGLLhVH/pc4pD+15uGiALFzU4PINmfD25G8LAsJea1dQlpC1s7rkYJUQqIwFNDY4Eh0dawLn8fCol/rhUCEbEHM1dJlCBpXxKfm7zt/ZpsbXgy68nEkEoLjs9rk0E9GFFZoYLZv/4qZR7nl7qBbeALu0FWvdWoNb4hCvlkME+i5nbMafn9uVxxXlpXBlOxHA7IKvKJLMXQanWkuK9A+2VI1JSDoY06+R0/g5TPJIHfO3roljfhM9ncx6Qrk66xY1H0+2UgF+oQgm28A27u9+T4rGo0sT6suA8Jdwthg1T9gojZro33dFb5pubkZ5ZHchLzsKkibaR3DHxf769V4iImNuKKrpgMMK8vcvF4YgFx9Asca63MVyNPtp5+zXPASns3bwdmsxnn1S54GTdkB4DwX4L7JXMnQGqIaS+mPgWxbIZbFcDNIrMilEIEGFczfvcACtmReTyzqnpITyfsh5QK4RKX9ZWtvUy4bWXjsLYbNV7MrrZsT82c9cmf4f8I0sSYqVIlcUYgI782imxBuEKs3OWcogWDmwlr9TGLtVSSTlyzHUW4PU9f7Wv06gLioBSoAf5esTj3FD9kKtTKQZfTKEIOcCYWcfIk4IkcfoFGKSLqsHhBpBOTfEJ6dxkBJXCSlknDrb8XJYO4/96XFd4ThAg4/Heg3u5p1kP3QG2yMuUrty2cFQaT3cWMABIB2diEu/1KfFFSKbfjTp8aUhb99C/ZA5m7h8JWsGwT5Ml9Uhw6CmNHyRA15TyVwIsOH0I1tFeVqQaoqT7wGjyqrJ9bI+WtpjMv5CAGQfj+k2aPOJZ/zLvxAtkd/Bzh9BZPEwVE0I0DI82uWK72P5+mHKig5zbXYrQE5bSNA9/gHvSND2qLV3hLPnoJp5q/NeZX7mhb2aWf7qkF8iM4HEHQ6YiYA+E+kPmfMGabHq62QBi8sSJ3yb68iTcA4YT6f+gJb6G3adGkY9eeu7XQZiQEi2fXRSKUOj/zLkyh4R3hOAX6xhT1yCvCHT2Jb9tAzSMxe0RFbM3g6b/VHgP8nyZkt45j1ZYBTwOpQIaFU7nU5focNbiclNOds9b6I+FOnBXwyAf1ViJPMKBBofmR8wg+77g5o3CiYUzQ+KdNxUo14XQc58/GKrIq3XSIefM9azql5sX7KlTsU8DGT1HlHIYnd10cJYsAEHoN0mLKcHTySHsjTFesKWsmK+siZFXhlavE6F44mweXOrX6FBoELRrvIrsst4OH+O47VaML4CK/cNrjlTodfRr3u2XZsHCcw9kXLGX/15sm10DYmP3G3387x7LDyVoplrs0pzIvfcy41eb2Ob/wM6tQNLxQKnfSbL0eyYL+RWR09qeHT/lWpCFvcISYlmdF/jMaIWDyxE/LA1tguYOSiQtSqHfgqHr1n/k5nFhnUBnU1J1eys/8qySmWwIplgfD3uNcFHlg6trf2B11Om/f7E9onO53sWHhas4nNuhBJsUn2OjOnOAFZi2dcAvexHytVxIdybjHcEdXUcp0jkab19hwZ0RddTUGjtyulBmpbfGD+4d+oynTEjmMlYS/pfoCyhEk9XbgbBf7wtFs5qleFrCmB0NrUYZLxmw+2wFqYEUy2hYP3ZxY8uhRZeFXZfhOD58zGBx7lo4yMjiBc0zvOGqVQm8d4tk1CRpyGJOGJWVU4EpHPxqgMP6hV7f0IxJugziIEJHavrZauRXe0/THYEOKpl/a4jm/fah+oAzHRBqwetjJBSjNp5LaZ3ZUNQElZJBDOF1e4muumSHF6da394Cvppq45QN1B2wYBfbx4Y9fnq5b+heTNTCmP9XhMQGniDhmdhGzfPUY5YPvTUhEcaaA2ucNDUO/xvaUVhXDIodrM/05R31bnFkjUjn34N7Aiuagl9VB9SjYsu83Ws9eoevaZVwZMC4uiZko2GtNzZCyMHRq6GKhvEGBiM1gLyvMZk3eR2dGcn19YX72JnDBY6RWncG7lGAg0YZR9lyoCyQ13gtnyBi05gPlO9yOeIYGqQrhgRpR+pAvx4czdaBMpVI7SgZMAhMSsdPUEQ9stTtwSabBmrln0uHsOMhDvi0bNRUWUmqnu3eiLgzk2XKGyTaHCe59vZZcmDkk8aOO6pTw5H+DWALBPMcCOmfIz4cF9E5zesXbQkQNDFk7vlnAcetbpid+Ce9MnTb3Clhv0lL7lyusJYCpLpalVXmQ67YNR+IIDh9vW7XeWnU3FFfdnO0yqCON1josSLVMTTaH/T3Q7Y+gOUofDwwXaGyGRB+4GRC2kk7zANlgd7PmE5kXda4IpmTbP2OqUJ/O9EXW4aslQR5PtYy3tNMamtk4Lwzb6WIFll7MVBneG5vPfEGslblvK4unzLLIvceI6WxhiZNc/nr10k9nn8ikKPz5jmA9oC+lWIE8QR4XYTcO6WZ7VMORykmWLBbTE1NQc8/TBpYSaYjlsyOK50EEwZC6/hyMiltFDU/OcVfSs/4s0Rk68qJkU5mIFxzQcySQSzLKmqQzkbb2ZlC8MLMP8Tt/ui2UK3r3IoyOWjDNfAV+2/iYAbaU/gcEuC9PqZbBCpHpobrsMSJpIpAbdk+lZArMaQfdQP2kY9Krk6TsjNb/ad7Ghc/HTlJyxRISEoijGyuLhUJB5Ch35PrR1oibmRE3vvhC5cWj/AFFMlliT5ELHoj9ieMLEG0BOkVRUXKuv2bfaF8AdXORnzTtMfXYqB8UVY5TvybX4Mkg9YXaiDDrp7KV8wVHpmx3MIlmRkznG4Q7DbYNTZBEi2yxQfQW37NrAOyCP8AXP/EHi/BLLFg/ip1tleZLojlnpdzKgSmJyi4IRDWNifCtFxTRjzh2z9DNa3KUZLZnixrksQWHwp2gRkmuu7HYPHYIQrdjih0WnNb7CL7hFDLjbfGaVLQh5Fu7SHtZTqDYzgY4QnM/x2PC8v6+qmCAMbOvWxZOIxjgpUF1ud2/e41K1bJAXPTZ0ctJLsigJDqNH6fNsXGGXNx7cwJPgP6INK3Qxc3ylfv0L1e9m37k+CqkJJTN6MvvQuae8WjO1l0JvBh6yHIrZgf/Bt/DNS1QULgHfUCLdwH6GVXxn8JChzrTEJL4dTZGD6nCwPWD+eeU/jxNc/wph/HYngIZcSTOnA7ZoHemc7pUYXx0Nr45Sbce9CyAvFnCzoIYbXxoDXYVwt/7sf509VEfvoLzjbFrRKr4vntb5dgeDiwRX6neO0yQZsOSoVjVvOOSAuP4PT+ezKgOTL5CMeBFh5fTyCTneXHNexLrs1pBpLHH3kmt/Gi6938ByjJyGR1wM7/rvRQQoS1drQjQ0vefqIJKlavxUAyi0PuILAyGGfaeCzz00DKjY1cowpRuwwf7rYPEZOByjttnqj6EUZ84F5gZp+4HJmTpMjNq0q/lyKFhwHKG0wkVp5h+gESx82VKGR+mbao8YOh23JnEy+eNJ45yos7d1gFc6GC67dt+OzE5TpAYicEpe2YtuuIHNt0hQpdLBdS8eqx9D9RSrya3h16jYIp9Ogfv58USTrQa6bOJgC6Fuw3VSohoUOQpQ/XY+PVKw2eV8Q1N6yxzymT6QIiLizm3kcA+jtFVJVj/IlTTGr7Tj6P8fQmh0ag3AJfRbLs8nmEQ1QHGUtaUv9djTgKNG5hVLyiujHLL77tNlHcYLwqquU6Z2V+WMoDwfBiMDqK39/tNhs7dXQhQTHYkold5VgNmV+WJr8ETyoKTHTS8g1RZL+KCbZw1LZoGTgR6eNleq+XGRggG9pbw1+WcW0jzJpvQle+pDWTA3yPaJogeuohg7EijR/48Se6kjwNpGStelAHWNOtzrfgmNxtH9r1eSRWLz79nRNF5th43Vy+rZ9FcwK7PlfJojQmk6yDIgDVpS2IJtFflHkl2pdrA/ZK4Grks9dfURGUNk54HimplKaYEZX5dE2M9W/60vxTLBE6XeIZ01h4YiHBHGMX+eAHZAHpSk2dFZUbQL/ylbq8VdzyOCnwzB532xAsz2XqmJFNJCZ6YuvEpyZtLa07GuhPki8MeZUI63KN4jC30SSX7/bWpsMyfpqrzmMI+cCYlmRUB0Mu4kG/untuIlFzWG2JnuSThOvNB87WuxDF4K9MPLtApA2nPV+2yMqZtQu/5eBgMzg8/6FBhddJz3kV0onK4Jbo71w6dhI4czF3ksh7/wVe0vAH8B/pVGb1v7xscPIhg6KL+hvTtq6g1+kCPpBURUhkj6yrfPgZ3/Xtc22MaQJp0ouI8smF0IW7P8ZfkCNRlxyoz5rOlXJ2YoBYf+hZJACLpIW6Ecg7s2fptIWtvuAgGvGV7dSNLkYv17ghjkJQx6tLucnApd6V56PAKNj/7Yyi6MOC9uwvXC4HnQSolMT49c6/5ZRIfWauOyw+arQBxET3gqjgZPldHDuhPDdYxffuJ1ityuwa75OUwVzCfQ3DhhKAfuieBFYqqN1i5usxjNFwKad4V39gjt2wLjcS1yX59qz0LCyVW9KbSYU9A28hy5DC7hdtdQxRU9PX4vfg8R4KZzpT7OhJe4Rwnuob88KsYJT3Xdb5uQj/iI2b9k+IAL2RazReg2nxwi3ia771jH8mWcStAs1NJu+cMgx6oarFqLe8b1HSRxQ7za0WtQhVKdhOSo+l5MyUbO7l4rtMf8vOidRDYSBoESyiDirZR/lirb7mNwOHR9B00U3KDHjR+/6/p0FjHCVpWNOzJcWfIRQkZ6XmbdXoGNbYi+/6K31kVQSpEiFHlf0XTAzQKDh03BJv6aoldSXInQfAEINY34mN7TGvaILI1iq1F8qQD9LdUyM1y1GkmIcoViAyaqPmTF6srtanuyTM4L1D0wyuj0tEVAfuycGdwEON4fnsCqlt5T6S1obgnUutprS4s5WpzQgzd4U9TRXJErli2+o2bS7A/uISBZhgh/679K/zLda6gWtuZwAvTGNdCbAN9uwZti3Hk9kKWrIq/zDHz00+fSYLcc5sgjgY5sWd/F9nGirgGojICMTxUzGmVVyjsC+0iZ7i++UKuLA2KCekIgylXj+DAZVKUFgBgXYW5+1bwyASMUltB5MhCcaMuivyyhZw3MJ7OjjmJyH+sH7zwWOwFaztw+KQpl6ETunGZ4wgXDkkep9RDpXHKdERy5R1KfOfi61l4kXklOVi+UvIPbGuKxTqSuKxjgg5aUU0X3V/EKdOugbYyeYKlYTyfe6Py6u2Z+A0k4k2giHiUVqkoC8MKxTXxmChSs68WryAMhUxyo84ORdwTONcLdmrVJbnyH+ugmyyx9iKEPADsMijuo2U3uJDa7Wnfr9gcycQq006VxIwrhk0FV/BDjqzquNOsEJXdrimGw0G+JVU4/5BNk+lE5kSCYz9cOOfNBtbtPUoVHnu1jfPwwGlaTc7GUxPcDFnEgwaHh5znVnSwPAAdXz5o6vI34Epz0NKfx11wmUjfW8nTAn60/CwPV4XjHM2yzXbq/EA9hUimpPyH+gMWQc8fiEpaTtk7l1iADxvDO8EMdlaQ0nXdXnhCuCrsoC+Uvlb9IaXpTbhDyzTzYYUPRsJ1khYU6+UMPk1YHn7mE5V3/F28Yia/wrwDdF+R6TmVzsqudzix7NyUGk46wXs0WaHIURcZDicGiV7SEhoVNTU0zgBoaSd49LNnCcmSgWRMUa0JKdpcVnfovdDcIyEcqOXD4VeP1baW1O5XKi8DuZzNuEL/drafxlkHz2RIla0Jp8ILNn7S3fdeg9UhAx9q0+SKtkZq2KsJrdjjyAjr3GfTjVIDAz98414NxYOtS7EWs2ZaFK7+4WBYoC5Hkeq4b/TVXen2W5sxGUXGVbea0PfIOieEzqtacY9iZH8JBwrLvaO9mQx8S8Xs1qoQA5mRuhLUFIcDGMj1wJK/K+vclB5Bl071Plrpq5+L4WJ77f/haemR3QBDVN+DYo/NMMFkqokI7b1nRwuzDmI5dEx4XMlGANd6UtZZVQ12+CHjwiLfAM9yPWaei6wRjGbxBRZUWxyt/lA3BanlqVbrdSdMBG5p3j4Pa9sSfYjUr77zB9h2qpnC6V8u1+XFmGBTP3y97KCCHykGfB6mbCNng2OYcDfFxSp12MaqtqOwry+xB9gUkHlnfW9DENAGqcYOxFOWwZHAJEeIuPuyLr3pc8euQGkJA6K1rmHJDoeAl370hmHY+Wk02WBNr6bOj8owlbEPXZobBQ/xU4JVN9l2GH0nnIedokXyCvBiq+jOf90wECFhhyXgaKiOos+J5t5i72+cySCooSeyr88ULT2mwUuMCLDw9Pty72PByiEtatpiqNeZF8Kladg4jD+8iY+w8ru/PveAVmrABMft/YevFyzmyB1LNidUz8yrnolKmitwK2bPJrQzSfyMg7RCZtnj801QmxB2Hh1RdODJ04NYCR84mkyeVmLrySQsPfWBiZawIPusj3W803YTrCIFZh55a7RhYSAh5uolGsv0TMC+pfZ8CJFMfhrjIkPX4iPlpoVij0m+1EDPaObMhssohxiQLjAb8un88eH/6Z8SnJxoDDY9JjIkM28xe9G9BMqE8CdRizNqXF+yzFoq+i0JXmGCunk6mGwVz7dw0Aht2yZLXL1jgrrUpP84ikBVljLiJmABWcOUt5aq4e2FLPP4IYwNw6/6kBGhUw92jqGvzzSz2IXFoSGkFThCZ6Hdi95k3hbTR+UyOtNXxKf3qOHtoG1+tO5u2H6XvCe4OZ0IsSdV2C22f4X0XRjnoLI9dkAJcmaPzyLbgrWgj/dizWHsrNz5PzGCCZ7zywhZMyk6RrEJ5ucZ5k4Fosm8+U94ZyJFHYaHthMhJSLgoHd9plpggxNFeaBMx2BdSg8d0qM1P9s3xHTr7n+uvFsfU5qJafAkyfAi/gC+OLxCw0uMl/XJ+id3bpdG4VxQwyKvZaxCWrPaRHIy9KcdR43jv9jfykGUTzB9KjyF1G0SkyMHMeY5wgAmcEp9B8ffD92GR4FQExXAD/Rm70xyf9mrg0HowJ+Y5o1trz3gJx6Em+pGPt0PvCVSXsmyA7BLMqIiL8iKyvmFzR0O7FJPoUD5dZJ1eKn4tDUJJ4Umb72XTHqR1qs8KsHPpu1Bas2jM6FoTMyoX5aScTz2RVJH0xso6SkxxuMBg3uUblz4fj83SnK1GADX8ZJtrY6l5lrbF1/ZuSi1BShVAdFnfBB3Sh1SW4KQz2mL+Y4svWwspzeGp4W6pTFKdMDjOxHzkJHkAfLjLjqf+T1Axa9og+Cl7gRTi70bSWjsQM9F19HqH1IdJOoerLMQTLpuVpFU//G6/hsxG6sFsnzMJ7n73SbIizBrcriqJQot6sKe+uP1gONUVuBIPlDJA49atkvafSdkS4NR+zciAFrwoHjdIsVSJKqDxAVrM15uFJb4cUI1Z5j3Wgo4gLqLZDMdNtYKJ1P7oBTGSBKZGTqguAYXj9FtcQ4sSbuwAvEKj0iSHfGzNYpAzMhIVEl+O5tVLe4s/3uEd9Gsrl6bogS5HKQwX3XK8Vnj7lf+5qIQiTSzRnfkEpdxxgU0LAZG7OSxjiHkVD2gFaZ1GjKhIedce7dFUwac8qA8Ut250wwH7O4rKHFECWEhhPfyyNNFFWeFrcIjCB9QkpXuz0U80DXFirexggv6bCvxlzrpYL2A02HykHogeIIum14ATyzZnKSfKNZqYUHkFr6qN2/mPO1WK01C9CpwXcl3fLEficn+qMiFNH5a/JFJBAF2ZZWJ5EP8mGzPCF9CDlr0z0YHruP+6bAUG47CNw5yDdR0WDTjq/DqDE8W+/fc6iTB4r9945YbHjR76ZqoOFAkp3KnRniRLdWK5iKvLCCH/Jf9vzHnX4LfdHlAiEucOADd6aaTJnMDTB0DnLoW9pvA/TvJPoH2GYOwUyBgDkGv7VLqRPzjz9nIWylnnWqIlm7L9YRAuucHIleKaTQCeUrXP0Wnyp2nmBxzeDiVOPsap6l6MYLHO4xg8HBAK3J1dgvBpIjcYDKZexJV5mf8c0hpw5ODKTwdkKCeeTezcPXh/9nI/FlRcIYy8sH3nKCQ0EEucVi+uinLNXGTmZXSuB5jYC2k1R6X8FYDLSs7G3qg+Wa30/SZZVsN+vbIWPDRqs9HMz/V2eXRrxClGwzMRZTnpwuqrD1GTjLUluOf9uPygJGxe+/EB6Ak5UCCsCWe2GLD5iZX8ywqGyaP9CGKOOsQ504tSVjAMPPpKo7Ex8LT3xYdh4QReijfasLvMKd8/bu689y+WY+S8IO9LXV7KYzmOOycnb7imsjeiBPCZgNd2Hd2fLIQOaLorPkKjFZcGRaNO6lp+pBPTMvw9QIbYuQZBlhu48VmV3i/3Y0m71BChUWR3cdNSS4D96YC5J0Y7ZFqMHBW6G9p9pf1EMvsoq2dzX2wSvNYXqdP47zyePLrk+nreb97cBNao7U34lHDXeFQ+HqT8XvcE26g42SyQZmHFRlH2UZ0kohpcgm7Li2wAo0IHMre/0XfRV0HtarB6og11KC3Z7/RUcqKzEPA7ZEJQgZNgBZE02MFT702HN67p516Nvqkm0Gjx83wQdQMeqxlml8LDK0V5SdTdnatEK7C+bhiQ3CLRBupVuTeGYhJY/BbrqiE1SY1vdXZ2SFuvNbcrI6ErGJV8/qH1acDEtu58Cm9IYXlR4R//8FS+sjKjiIPcuzVQ+9bV25MODrRYTzxFJYbLhp2Um/HKOncgLdKHj7tOrMZfxR6CrV1qRAGh+vD5dMMDkqvh3RtFI8M/B+95gOm4879zLjARkfVycAOqjJdoBfgWjWNsJnafTkmc7B3nIQv/Doeol9zaGW/DlpeEHHLSCVAFpPcoRFbXqIB0NIfCnsKcK8GmaNVe1S1WmDjR9kV2WjYdDpu3d+gX3edjZ363f9jQEbUhFXtuRXOQv+gmYCubqBrqUoagUdP7xj0HIFEZg93/KZ2CrZfN9t0A6WcpUJBI5WLyoLnqf11jJxzi7XP7icTGifXh8HPdPwOvmb7A1BFcfY2H1yrgpQ9LL1WPc8f4dqfuE91BNq8DtcEql3/06rGk4gsNyWI77GnH9IKwUsAFlrpUmA3zzUPojorig8/2Cbd3TjsCKM9wxliCLyKPngKsM1KFkqM6bMFtyxYYrU2eewcxYM6RkLIzuCbt2tjjkrWkSVoIS5lGaeH9ACsgsCD8uBJTg2FG+jOXwTTSCvGIWOiSPmrIKKcqEISVvUcMWhHEeUKjXTMdtBmPl8s4WipwTYa2j7rmaa0RNf7IXAOT77NGep/q0h0KdWRo5UPERTufgAqHgtum1dZEPq6OH8ILA+nokd8MXPhCko+zgkNqNlrLQew5ugiVBI+TSaF0+Nh/0lIpsCoBQWlDacVD+Vx3x3aSXTbkp6URafBo7r4W0YMJYL0MnwFM5mzSBvH459mHAZ0yzT09dEXgjVW9/ggg2LxRO6yGo5FTpGQS5EwMSjG3crtd3U4X4CO+KX5W46TC5B/X/DpEipFhWLaE6rpYO0r44KwsS9Ge9H2dfFY3QNvXA1sWHN6WR25HgQ091u/FmxcmTXpvXerH0b5xRi1MwmGmrK4ZAT1TapoD8+smzXuW4xfFWkVDOL7zk9xNtB53A3+dJrIzc5OTB601UXSFtQkX3hWaSnhB0fIWaxp9w7vGQDYtDAeTTDigrLMhVNfLUpJcIxhrMjO0Amicb+Ubauev6gApJbByzVQRTWq047GGRSYgxukHnlk5+xWTYTi31cQQCJ9ILZRJ3tV05M1AIgNeeDW2H8IBJqkzSl9nnKSajGYOD7eMyjHHWbG4SEV8CvAH8Iew6SodPSlX4spOyb4O8XdYQ2bne98jMMolgBIbc8j1VfPhmdPcqVcmf5qMjZcC2VzGSMF9s4863hYPVGq86Huy5cmg6zBz+qDU3yje9vmEr3yJ6kZhF5z8UdlkJdjq/581O9VuCR2B3lyEAfQoUZot9HdVILawreyRxAy11JlpE3UoO/fi5/5omkUs0A7Gvb5+bsteFVIW+9l+qR2dINow47smAidv0bLLEr/yqKcUanjvixyzAQCM5CVzq0r7rDR9M7wjLxBq9eBWRVmyK9TfSJqXHjL8T3l8phqzWGZrkRC5oiPO6C5Wf59fFDP+ituUaiEqytebX0Feyu7U5Leql5gBMTdDPsmK7KUOyA5TuWxjGc7dN7kJKEYpro0VWRhjMArMIGbutu6vN2OSHb6nvd508S4Q34uCRKu96bSAD7YHASNVhzXv8N8jroYf5Y7E9s4wTpkvo3BZkkWqpF0M1vka3jjUC/JuZvw9V8avX+D9bciICl12vr/bQJxDe+TN9MQwDJwOe5HRWZKtCtH/1/2brHVDE381FF3JIILjZf20UTFL4MLwmZtFv3M88Bv1x6hEyoaAlZ5p5QEWzlw8bJBt8orARhiododtduYtJBSF7octT9JzbeKdozaif0LBWL/u9RjbeVNLZ8UV44Ye6Sz56Vn8QlwftWL01WoPryii3ZZ930Zx6Ins/HGvGQmHAD+2qvuKQAs8Y6ublb+Dvhp3Y2NNMjsuzOvb6m4YtkPzbhlctKadex8tBQuo0zhmSxfDIZm5VnEDdG2vZ6kcykYFxgAz3wrkVyXQnwxyQIeYMIHQYT+257jBWD0yJIiC3PqmohMzTC/65XVgSsowG2kgnlR7pYY18nBQ8aVfJ64D79rH2pymM4xMU1Zk/OS14XiDcldhO0c0RhQxiPSY72XYxpiaKVYmzOcEvI1PzQa7+LVZ6pBIwn8ffWvhqa38b3IskTs4RBkYs9i+i9/AqdAQg2IOeWv2fuo5tEcFyefI9nATJXQchbBEQO2Cj3kaBe2X+81o97B22kYSwjOkgZybf53qZFQ6p/N0dL/VnuL1cYTGi8k6rMpkKGx4j+Mc/fcHUVNXTKhyO10FkvHiN+qSbJGepJ/aLXoLZ8RET0Bshv/4hAQgzeS7yl0n74cedqdnmAeHmQ2CyXvMM0MWpEvA2ezZIKU+WvUSaGpTt1kvMloerqnqxHLfT01Yh2n3iD29EWnrQsyjedi1I5SUgvQKBM9G+oAai15cO1con2QFz3UK7w7ZgzM+vPmbk2QqR87fzlbdTSAhrLXzqVfLnWBA/4+5aC+0BRMZ6iX9lH3QXtKU9D01K3HprdilL456y5lsl38VQaMbz9hk0LgquziMY01Znz2WE4ClHG9cF/e7stVmn89oNFUE9NZ1RAc97KzDEWHLoKwlCG6L20/2Gj7/M6PDhsvhY+FMzYRg+v/0jo2gPT0UTCfaLBDRVvKQgUSYPMG1dr6ox7ohepBUS0msHq/V7A6Y9WfKDgSLatqTzwhOXnuXAoFc1LsdlV/Nv7XHqg5TAohZGa1mOn44SyY1fyPMCxL1QmxvhBC7mxDyj9DUnBpbjdAzrBW0mUzZ51brDVW3f0A8oKL6FYBf0mwK6YxDMJogq94OPgpZyKHKBYvJXMfs6u0pYnEn/jPeTVQMK6uY9Egww5setjqwdQmwi1ea0/uoNw7QKPorCWZohFt4VB+HUy/ObjCDdxryIg/y0wXGMwFyftSyf0v/ESOVaUNOHg1aA0SQ0KOwx/oqBneMvSoxZc7SqvQaHcx3ZLg7I0FQgQ9799KuVGTfGNgWvzIMnHqMNnCyCLJMNoNQK9XA4Wkq+6tVuCUREehKj+szE6KlaSwgAPfb6JeGqIyBrjJK/wNw2yPaYB9wHia3A56M5r4OplAvdVjO1vrsc4I8LAy1zqqpo0yM1hfixHeLNDG6ufXaX/4mWxYpqL3hBHpPbnox49P3jj/wGgdZFaJe1JTer036xd0Xak5qCI6SV86xqAdAChv6sj7ESw0SU7w0leCi/08lfYfucRQHdzjO3JkA7lvHw0ouMCSCweP+ms5HlStT1HLlgQ/pkLQ0HiDkuoPtTY6fDW0UPlH3ebKJKJsiIlEwAnWQ1ExfQhfs1IRdbEO6sgyC7u2YqSye9WFoH3s0+d4P2X78UPcUsRitbiSflMds3+5ixk47wEAbwHOouv3l0AUb9zZIP32hh+8n3fJx3LXT4wqErJXRmufydvyJuKW5IkA+rD7B5y3hJGUFrf+je8x2WEZ93MMZZjKF3R4hY4E82J7y0z9znWEXqtnGce0dejOBkrf6CbP1VCh4ixhRvmOXO9yA0A2XQqeWYNfk1eUkRWlybRDBiE5SOOtjudxOpqC6Hv0XRqdL58/dsrEItVoppvb13l9MrZRKzOe/vtw9JP9aAkOa7ra6MbT/3YE4LlEJ5ticKWKe+rOGibg+N20Vx6Vg7J3byZG9+hIpULnZWH4Tq3LmlMA+oUfgAbbzPl3twbDuQozSElI95KSsXaBWevUxIWPQdY+4eolMlTtLwn+51SP6BWFEiioYy+r2Rza4OqKJPMbx7t0CZCtpMKxYQ5JCowbAH7J4Y3Eh3C04j1H/2a7qH3cVo01mg0KjVVR59qENmLLCnQ4LNMS3i2XshEK7QAIvi4D+egZPpMUywog3s+tqRiaGXIEMFp3rd3TuvLXVT9tpJGxjgQLGMKXmGL1MVjoN97by2NaOn0JoIbOQqeBIHTVbBYNON5DD3XP+rStPIfVbuHd+90TJpGh8BlfV0dLneK2wDMnndVGVvQLhvaQxu6sL3XsvtxmQzeFWUSHLeAlmTc9yNQKkXtOJWS9faewS8yotiXdJQ6EI1vpVOHgh46gljSllVDRx9qlH7i2QFU/dKpaQEbpAFUBI/eSUGbpgT2ORGcUGXXDWjQJQo+nCkQVnIMRUCP367os5Iw4Rb3LDvOi+/mwcBozzUa4WkjVcSIURKO3RTFCiY9j3O6C5MBS6Y0WbBooC0nOzhKxL8xMIIaM/tnyEzIdlABrz3f9XlCiQ0hh+C7/bNp14eUvnjcHWjBOSw8E7BjzeXkRQkpIuZSOriwZ8PiOLZxCkXFOQ4hbXa4Tu69lccJ9Hd0F1lxkg5QnAhhfx5WdcTkBH3SibBUMCLPb/cYypz6s4GGDMV5smYibldp//j9gbCEhqanpxLsoexOMik4SOt879z21iz+8V3wgG8CicQsmxcsqCc5QUqOZhnpO4qAFgzHF+noxN835P4xf5EsOcPvYWwtzK3WEYVGy5tuvxE5WZB246SGIDgeC4sMge0B4p70Tse4b6NjlPHW+90GmqnySqY83r0ilaew46qmwi4RzmOcPehbn4YPCoISjQ44RURV++dfU53vcKhkSj6cWuh75tdSSUNMysFwoP+lN2gGTwxOfrha9wWxDPpimhEBVrt6dcBIvdoUbCLTDQDZuUOVVhZP4sATqq8z7Ai0STnGxzKmAHG+3I+/tvrDN/OOTHwR6W5aWSRj+M5wmS5hfdvimlus2z4pE6RV+l6scSEX3XjFUVgbSuuufln4qZfmgBxNvIZmkPtMh4WHAtuqRVdgDOLksqdhjqc9jrNVpRsYL4L5fXaKhNXYNJfTorxbaoSpoqj6ZEp05xsc4y4Qryx7BRs3iYvuHRbCUsiCPmmGdUPXDn6H7woEjiz1YeriH6NPF5au5aVrtcw0DvEgLLKMuVq6QvzE1mu+x9AFhhIEE3jVvzGWs7x+IBGJ2hfG8Kb57q5sDsPmddrc0s2doavGt3j59SpKkbETAVxcSwwHbpAEsYTNPM1KhVl7EPpQp+gNotyPx7hI11xG47CrYE7+4xlCFpaDwvf9FWescjE9qNrcgCXvSeme0GAOo6QjsttWQcRguwWZb6OG1VPN2xZcfyUeEGLHhPkrziDDf4SHNaCcXXJ9CtFdyRMVueZNWqaoSKhpFI91MMLSXju3pGbSzJlM8FPf/oxZbRADvlZZCyb8fbb4mQVBZZ3GWV4hj4PCrLA1qQvEqs9XLsRnoal9WaSQhWRzLJmCurnGGRc6wxyAAejp0pAR70k0M8R+ziXphTbSz5jU2xp2cFe1EhegrqPqjFAtYWbYwsm9X969oYf76RSVpD5DfI8iDfFILBkfvnZaZtHikQ2tfNY1T0QOYafZ+dfiQjWZxqrDxXDWbc/jYZSbOzpgJ0HvC9wodOgTk5d5d9dmNrnM0LH8bvtI4zgktUZdf/DkYM10EF8yMhbFqvpMTi+TaLBUNd9aLSzSGAqu41xsKxsEYHFPhxozYZMPCafc4U5t8Ja7k34czb9pTsN2JFnwl8AmZSpI39KzBoEcD8fz0CAcio2KlaDIhPF8V0HkEbwc2c0mkpBazhOMI1d4cxnKG15nlJ+haP4D9g/H1z7jIEHS7enL9st+r19iJpqLFuJiKD2NT7LXyBzaAcFxIJ/fo4roeZSvHUyfgqUjSVcPiszEAuk4Fgqjxih+ln6TZW8b5sbDIvrB1Ul++c1B63XbFgHdVJTaRPzIXeh5f5u+QYvfa7pHyQV0ZUIv4SnfFMvTC0g0/fdaaBd9rcpxu/CBpbobKZgCIyVRDZGdPlZs8UGyu7+Hxb64E/k0YIIyG0d7ZSIcU1dOwyAQt25Ow5B4W/oUhgU+Gf+qB/Eqf+V11+GylEkiyGag2sSabnAwgaqTr549u7USX8FH6EnKLv1g9jl2zIU7C6GM3aeDn8kP+9aBM0Agrl165RV4/UHaXPnrBjs3YOHlrMK9jziNkwwt6+rC5FPPvSm2uVuOQouD4+Rk/8X2VoT+8bijB9PNpfsOsNhiSOVgntu7dzfzJItraFExs2ylPt0vanTgZJP3SIxPvZsgaDSBNmxIh0KPLS+EZkJ1Xy0gY8WVOZDbYF9v0GJta6+GUy7ek8lisYumJ1nyw90NF5n7L6H1aFMYqA/WI2COJA7pWaf9Ugf5pniETIJNyNXtonwZOLeCG380p2a2m5Fs4WDJIbVCtkJ77ah+h3HMvJJ0fzW8OXfnZDuzbWB935lP5zr2+vOc7CL44LjNt8p2deJJKd+d8n1mwKwxWxUjkxJRVlpIqwq1a+Sfeu1oNGDaOXyS/LVoiWAi4/RFFK77j8sVBWyTeqc13DCYWKdEbHTgEcIdtBewm3fvU99V8J4gYLJijdis2O/D+3FBz8kG/SwAXwjzKgO1TmXuA3syLPxxfnEUxttkUPpzQJgAzcN6o79tpHr3QWX3TVy4USKZJPX/G7/sFv7TB2RKaM9LvG8518UTl/oNK6/mqMpSOqsv0xRVzNjumgamqz/e3LG3e1lkrW5SquqlrDJIrN90AProjO2hsva2vAv1ZNPbHVfvH6K8KnMmDbXcZImS+YAXafdXLVILS/Q0MSKuRaLPQABT6AsH1SpBlkiSLXyhT/gT5IbfD6Z1Jx0n7l33o2uGW4lgd8BRn8WUeEHBHEn2SCXVQwlREQtvN7iSC2y8qSngF4ytc3vgOucrGccauebyUn9sdKmkhMom+XHRGLg4yr7NW/ZAq8UDCTjimw0unj204NYoihtZTNdXwgmCpqzA6Y4a3S/braI7FEXELgpjVSnB+dqkyFq3Tny2G8lAz1OtN0TZdE3wgbqL8XtsE5Ut1NayTqmPNmEhJVC0f6ZfMop0HP5VawTxA+lq1XoeRAoIGH0ojuV+9O13sh2V2zoxj5jVyNGuZDtqZVlEeSIRI05PVi7nZfKw+EuT5YTkdX/qnx/AmQXABJR8mEbt5A8Oab2RqMdG+P0zvDI0gODnGDSO2w4ZOrD1zi5LnYaIljibbOMhpDWcwsd6Ry5eUmiLQ24OpaErO6a3/sYLybm9xOJLqfn7DNg/5SKBxEfKNyyUYP4KtkSMQI5Xo7dHcIhqH4l3CRK/gB7WtFU6bj0mReNJIitL8grYbUyZpqDuMDT5s5WQsWjOEmRSbMiH7HIkEIPvRu0WxMnRCJKjGFWdlKGqK96T7jlsEHCjsPjk/9VEQ4W5qB2tRAFGJ5YGgbmyYxqxGxduvkNdd3IZKcIbvtEtH4X7aHeyV4Dcn4wkEzUNRRhISM51Av5I1mwi2lj3DP8d6K9iFzNVDCSb+eb9pBu+SEqYrvFC8WKSi8OcZDj50KV871120hgz6n6OZy1KOh8OzKNuCKFt9mVlUfJKzD9gcuL53q+oTHGGIKFz4+4/zLC13N3l3y4Fn9dzM02uGyBGoJXmF3jrwW9OguOsh1FVykE1suM6kC/e005VRngkgcn29tixbfGSx7k8JzTId+5wTXE1HgKXCtGlwA7L6FxS+RUGGP2az1Em91D7THACjjqlVdoDOltQ7Yb4S8n4kG/m/CvtFfQB0e/e/JMgICLGKds6v5THENB7WYOdJ0P5s3GQzdbeXjUAG5Y2WCUBs5LZ6xDZzv1L7jfUHqBbmnHW7U4g+UTYB/tW7B0Ya0JAbpzWFSoVQH6CbY6q9fM8ccelwWdxeWdjZm+TcmBAHpje+emw8T5mUgl7Omvks7D2xk04/HjynzVyBN2dI3dBgxTkB1keL9tMN0WgyjY0ddKI8pigHP9lOa8hb7F2bZIa/FqS6JJPPHnlyPbVl+weIG7j4ocmWH/OkvaT4qtcbnafk2ocwOkjSqUob66ehit1UDMwKXreD2R92MZugTHNe/PWAZesANg9eBbm2p+4kqK52j8MW3AhqaffDN+kK195DUM4FLVYm8BQhOF+OWoM5tTD8LImCNRenutbU6qRxpaMDXCBU37/K3Y7eobcg/IaZaBuw44FteI67Hdgufk5VqCDjlK7jDBUtVq07hpPI9ymWW/m3nNLQlusNGDSBNYXOUBDRWNnHira/1eo9GEwVgpXn2tG1PUUxT15p/fbfGXCvpsj0QlzwErC0ge/Oqlsh7E0QhpqDAcvlBJOiXDD/bv01SkM269rmghWHJPUbmpq4trj7H6cCMXMIwWgOLaTXR0w3tamzJpReC8FXDNwkxSCbmg/ag17JdPyptz7mR3k6KvXor6tFCfEv85TW7CDWLEap1AC12Ym+LK9/CxdKPnXz9Qz4xNXGn3sG1wAfthifQfjDyiCnLo2uhuMzI9yKxH4PUTt52mReMLmnHFrrLpDYcPC+cU7ge55guYhGv/ANB92YzoXrI+Hs6gdXnnfE8GGhfydGwvKBKCtpDecGnu41Mz28j9/LTVtSV9WZEoxANMgPGo4BDbY2p69ixYGQWATdyg9TRDAK7f/Lrlubat60yuVZ9wcwqZ7NBP71mX6NEgdvfK1EgMnkZzsDQl/wWDHdAoOYCo4pKwY5I/V26cKTO4aMYcV/YDdgglOtas2KtIXBJAcgotsV4YfF+CDN4T5WdX808VdXh3/UXLrAdcMDF3QIXj1HyUHIOkXBH7DXICbJt9eNiowRXiuB0d1J/FqjPFe2IlNdXnwFwpRusB5PLSv0Lk/AdI1gQmao8wwLmnoh/L9riMbMMsWAOI+5B71d+lGTKlxx4hQn4ixRfedyZUUsRcpGrgAS1XqCKzggl0/LFuyQpe9BsgvZGkEHQ4ELkl6bcLtiHZ+7uFxmRjnV7v8PP1Whug1igIT3OTMnmb/dGJPuGKY5fRdvWoatxfNU3ABi+fY7eHiPqC0gQDpAC19twVfWBtBur+ST+y7fzmSE5Q0C3mcp8/31XIdqm7sEZJHtFnXBgaTyG+fWRGAY70K10IBvKH2TE6IMzm1k92/Cn2payTupKTtojgP3uaWIgFVgV0lD0WGR0PanqiKtrBFwqznvb/rz2PgpSjWd2BESLQpxY+6tmKXZnjvY9xfR12CQ8o/aKz1t+XxCSzy0uE5f/kaFUCrwxjL8gT7SEUJshp//5/yvPFJHgJlgsvXp+gRQCSzz+vS6rl3BhMsbj/HzwJYz8GsWppOQDGVswlOHEaFE/qhImhDrt2DUfNxtt21GW7KwJRn9/mtYIjlnnwgESPEpwoLyTru3SsVGzRxnZG6x+BiseUs57lTdb3H8KG7UPeH1SSjy9wZHELnar9x5cOtOR7lOvyjWm4Ab18Q+qoMxxLCFit0V8SmOu7AU8XGY3eSXb6Ly+kaQmDkRlOstgmcj+rD34KNz7LTvLL0O1Z9J/nCjp+1flOFgtbd7Yg0t5eNrPuppxYxJfSpnJRNL4S3YTffnV+x+zVsuioseET/On2wNi/TnL2rAQIKswi7Er3Sv48D/+PLsa2WJOSk6DqcCLmusILDiz0FwKEhMewrxtNyM2IAE0/6hiopIQoUgC6U8CLirhWbfVibSnCGZlF5uywIcaUlcEaYP/evokbi1NSquO62XNnWR4+fB3M1N7LaI5pwdHYOKEjg9OaSiTtEDypKGOVxZhdQS0jEvZ46foNS4SBpwZfPn60p6pQldNUmimhWeU5LUnEpZYjPJU6hmAsh4AKaLFfJANrZ9ou428yoEIFuiY9UgOYkqtSUocWxyijxK+NTtuDdbh7NJcyLIl6CUBWQjZiL34Bk0Qe3vmT9tpIKus3r5CvEdEu5Va2Wxm8CQJT9bESzuFBeH0QIRybKFAUVqNa9tCXukd1jwLXYKWsuMuFda8R1UjVG2cvAZ+R3lBV+nLksL4Ti6lubX3hKFcSyFsG5rK9pJt5nlSGIkBLP/HFqLL/KX0S96NdOo4CS+GYPBk+lBZxz6Yie12vvUj8l4t1ik/5PmvbLOTPCcaoPeZ7APUQIKIcxcNUDin3R1okbeAUGwt7Ja3G0ntQokBhlajisyXeqbfPLrTTKpTauclKp+DGdyBsbzFHEYtIqZnlLe5wjluF/UID6EgwWPGj0FVKM59Jom3+0Y1QTb+IKqHZv/0FIEEuVItlJHSixdza2w0UN80Hyc/eUGv6SBybC/EEs9cOcLBR1eeQXXe7p7hfIhtxxBrGhk9n7jom/4LXF125WzPmMCUiNyE8iO7sVSmRf/iSNFBveZWGPeCirfJ8a43fk5jCfA3NPEJyMAamu3Q5im0DKo8aonWXtye9iE8vraixlVTAGSXFMjP3+XiOE9jrnXTDzARnt7+9gvHctQpaAI0za6N7bq9R1lb55jILwmx4Ih4OA0K1/Xx7B9jytPFBRhEO8xqXLhxotsIRjnGRvnkMK/KJ1YhE9T2mNmclLYgMSn+7dzik8BzoHt+EcXstV8yNpTspqsnS96ATq3A66NbF449w9JqViBt4gWi7yVzt3kR4XSJ8iEB5anMqG+EsSyrMQVv0sMeEysGx+yYs6G2xPJw3zqTq4RzDQXPhYra/VMlt7E8zzl4D7L3HS3kkWf4ZkmFmnjcENPQdkmohl6p/gqkOg+8McyzNxxb5Fl19DsSr3MTuSMqhSKDn95ibzYCEdrZXJiKaqu7BFBuju+jSObOPchog2IsE/u/3U/UK2mntvSnD0qNkPYoRTskBnLJ3NJamL0V4sEbryX8NMr7MKMJ0+h2+xMKY4KERpvUrd0c6ABXWHqLdY1QTugC/5dhdoLy3+KwgG5FnL0MZw6qvOvHkKQRoQrcKLuwUld15s05QxurH67A9eAr02a/vUWNBIgP6vOa69ZZuZKElWttIerRDGIAkZ54fw7HBctSZtfspPxaliwbOEH/Laxot3ZQonzvXknSVodzZHA1Jw7BcNRsYvl+KJ0Y6pMRPpIbaN/QSuHtnjUoej+vlVhq5021xMUPKxCK/D8rSRbOmduHG85/JrIimgo5wXWP83lLvRaxwCxeTGVt44fTUqsfUARmQcS3f5DbHR9SZ4nJYIEvcCjIqLezJ3I6S7xBop57j3ZyMQX0Xxr5mc6IUmrlOXM9fJG5iDZQQ9rWsGZ0Y26GzTAEsD6pjPuDa1XAT1MRpxyZ8zN53sl1YEV0E0EHvZqcnBnqMTXRh6zC9PwDXEk3OHs2zLLIjBhY5+7lDxp1X0qcm8XtWorat33mUx+kEDDgaDUdpclQq/ZM6mMYoF433nKbCKDxCozugSPVaRjNPosMDy8FujvIJSb763XuBGBIYLS9x+HZhYiUa9xod0xKV9aRt7yczWWlLgfK8qn4fULHMBSP48m/wTWfDBdTH8uDAKt5WM033+2bCpxDhmZtE+d7XP65yBTOf9/EWaCG+Gs9/5kVbWS0JlfoDH6Si2tVCzCRGfV0XZAUWfXOMJ5F9dkMagbwaeqVqqbVONDQGg8zID5MUV7IkazdAz4JLOXsn1RuZnoZNIGV2Na15+dRKYUAmXFmkWBJpPMBwT8N4bd8VZwBnhm3WzH9S0sbpoP0sgf2OmPvQ6smMyfkVK+OLjXYubmtioAhdwDb5/pLRg3PGwfHEz6v9OOe4AK8iw2cma49tV44In8Rc9jGcqSQlFXPdlC8366ke4U/ITFy0/SQBl1vWvGk40KycwWGaLf8cCtEi/4X2W8961i6lYnpfNQhGcQyC8s2oIOW+Pw545Thq3ZBEyNC8YDr/pzCEmBI8U3A4IiQJoHiD9kUMNd8wfzysC2Kqc4OGeWYsJxmDev4Jn4HV+vqpgN6xxSEMABhRMdTteHiJAgnQEX9BR2V1sNqh5EcMvQNYYa5+bblQn7Rli1UFCtQkP6ECmGkxmPNkg2CGS2mmf0/WEuTZSyPMtbbrnftPgleOmJ3jSm0m1EU9fQHQo1NZti+KczpJ8mSYIVtXzXh4rNJcL3Fm7Bbftpjmj5UnuDpPk8HvqKOj2DGJyk4R0Md1x7umiH0DTOXaLwO0EI94k7n6R8nfqiwekgUQZ1rRek0HViM5YN0JLWp4f4NRE8ErcGNSHZd58+9Kx8lmkc9ogfQmX0rX1kB8QQzNbH+eVDee0jOQNUgQcew3y+0QbifXrtLHXDIxsqsej41Kz7vfcQRE1zUnY2phYNILK8a657zyHNMzPiRhxs28s1JX2kiCMEloubOXnc8BzU+n7LM9wztf63eFWN/eWHXVivSdCWg5DfWsk2CF8aFJrOP277QEPdkWlOlewCVEkLjyd5wUn9ZzaKOJKnDQDLfliiRLTKlU8TOeQj8jOU8FfpM9tayJTDpxw6sVlZuJRAILfxn+QAGIB/W1FGDjuuVu62hFDBdvzVSfge95Ebf9pclp0GrpV3S+gwBWn5J7aGiim/fRyIN7YVVXJsnAnVeq90vDdAV0XearTqjT2Ck/AMkBW6T/ls/6VUVnFWs01wxkahKR0tRwyLRKgHefm3RWie/pTVQpUMZw+/7ozQSW+7vuZd8lsvT1iX5rwlpiaFnOnDbHsr1As6vLETd5HVbcBCGbJHcS7ax9Byd50jdYyagUtjAaHYX8ryyuR/bDkw1o4j8+hXMfbzy+CVmgrfRDyl4dn+5LxrqRAXLoDKpQREAHqdLSsVSJh1s8KnZ/SsUVq27cq+O6LMSBmhT4X3E750rmWwCsoCre6bT//oFWYALjp2SbcxnULBaTvnYDHtfEbO1m/3c9nJk8ZO5KHQTV88ivTWN/S2EXwmisTPdcupMrvI8e48QZdkZu9WHyKron7MKhGFJw6Z0KZ3tleVrvvJo89siUwByPY+Hs4gkKPBQbLQOaedcv/xeM+Ih8rl1eHEC/C65xWVciToVqSGp9HfbhVzFSrO6kBnv7mJwnRLvMEwqiNankVdJJMw4icU3lKyw/ecNSWIUddqlbThYMiq8nHjRRufs+28cq0OI9zhpvxFvFgSZE/eAYvm0x+9lZO+EH9NkBngaqU1NMYhdombNuy3awUN9p0mJQ//e9L65YbShgoc+ZUlNy+c6F6gDEHXV0JrzevPIZFAe2RyRa2dNqzLvihAAMCszYueqszzXRkSyobx5+LTLK2V3lfg3wbS9DzP3QW7VHdHbjZcttQRvtjrGveJnNn2DE2ZDIbvkCrT0H8RzbGDdmIq4P1ey+hoY/W6NuZKOz4dv4HUNznxdKV1Wf3MvqUv35r2jTKvpPWBUWNm5fytX/QJwp6qkIOsSx7Y67BSCbCDVLM8/VcMG+T0j+INrgL9sfT1ICtACH8BI0G6ViUZPVzzCmQHW2oVIwZjAoFl6+meO/pD8teO1E+1y03mCpYfW9S8qhtH2GhlFlebPf4NbezVv9xbXKWz0xezRNQWqUqtYRTUbuzK7KTvjG4rQHfzBpVmK4wDLnSIwdSzTSk1fPNeY0WOpPZTLlvQ59xwgfFrb326vT2hS1JAZ9E6sujFtKTiJ7bxI6o4cBhDaX+adXREThhR+MwA4TqD7rga/o9iY7d6TVRe14CS2S3iSQsD0R6ApnhG/2Wa0A0AY2NtWTjmabdKU+KgIRDP9RQYVjXiF1qC+xyNVG03I9vpmEpY/G/zC4nLOKgXAZ/uTikHI9Afbkhfgfgo9arWbix5eH7WUo9RQygDzwCnVSjbXc7MihEufVj6WGbK963pw8VjY3RS8IH1cy2yZbIcKLO5CgAUcXJfF2+McnDLKtXxyZaf7SPA6KJq+zF2NHyfoeTOwHhGqNcnHVr1hT73pcoyXyfvCYBnG1Bp/aR9t8hoI7CXM3UZOisWGA1SHZ2jf7k9GlRnp3mF/c1AV+JjvUsnZrsybEOQJg/dn/9eJkyykQHjbF56zgcPX6DdMG03WKUMlYz+uOZ+5DZy9E9MZOZ9GMoLFdrIPPQQLjv+GlCMpoyHPXkzIODjHAID2PrnaRpqWVHh0rnieDILKq+Emrd5RnjgE9pDUXWTmHaKuqqYlcgEz4zbi46dbWrAAFBjsQq1rLHIiPJEcwFLCOY4JNlXRXQJqCUKXk2d1RSBGzDP6HDSpo863BhVRFFF6uIpjQV7j5ebFe3UkkO/+coIo2BTAcgBqOtQ134s9a4QJvofuqBYMGOBMsWZ+sn/2AOxDx6SfAnDFGw==";Uint8Array.from(atob(RS),r=>r.charCodeAt(0));const B5=Uint8Array.from(atob(RS),r=>r.charCodeAt(0));function AS(r,t,e){if(t.getQueryParameter(r,t.QUERY_RESULT_AVAILABLE)){const i=t.getQueryParameter(r,t.QUERY_RESULT)/1e6;e.lastTime=i}else setTimeout(()=>{AS(r,t,e)},1)}let k5=class extends jc{constructor(t,e,i=512,s=512){super(),this.width=i,this.height=s,this.clear=!0,this.camera=e,this.scene=t,this.configuration=new Proxy({aoSamples:16,aoRadius:5,denoiseSamples:8,denoiseRadius:12,distanceFalloff:1,intensity:5,denoiseIterations:2,renderMode:0,color:new Rt(0,0,0),gammaCorrection:!0,logarithmicDepthBuffer:!1,screenSpaceRadius:!1,halfRes:!1,depthAwareUpsampling:!0},{set:(n,o,a)=>{const c=n[o];return n[o]=a,o==="aoSamples"&&c!==a&&this.configureAOPass(this.configuration.logarithmicDepthBuffer),o==="denoiseSamples"&&c!==a&&this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),o==="halfRes"&&c!==a&&(this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureHalfResTargets(),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.setSize(this.width,this.height)),o==="depthAwareUpsampling"&&c!==a&&this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),!0}}),this.samples=[],this.samplesR=[],this.samplesDenoise=[],this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.configureSampleDependentPasses(),this.configureHalfResTargets(),this.beautyRenderTarget=new ts(this.width,this.height,{minFilter:ol,magFilter:bn}),this.beautyRenderTarget.depthTexture=new z_(this.width,this.height,Y_),this.beautyRenderTarget.depthTexture.format=G_,this.writeTargetInternal=new ts(this.width,this.height,{minFilter:ol,magFilter:ol,depthBuffer:!1}),this.readTargetInternal=new ts(this.width,this.height,{minFilter:ol,magFilter:ol,depthBuffer:!1}),this.bluenoise=new H_(B5,128,128),this.bluenoise.colorSpace=$_,this.bluenoise.wrapS=v0,this.bluenoise.wrapT=v0,this.bluenoise.minFilter=bn,this.bluenoise.magFilter=bn,this.bluenoise.needsUpdate=!0,this.lastTime=0,this._r=new Ot,this._c=new Rt}configureHalfResTargets(){this.configuration.halfRes?(this.depthDownsampleTarget=new W_(this.width/2,this.height/2,2),this.depthDownsampleTarget.texture[0].format=j_,this.depthDownsampleTarget.texture[0].type=X_,this.depthDownsampleTarget.texture[0].minFilter=bn,this.depthDownsampleTarget.texture[0].magFilter=bn,this.depthDownsampleTarget.texture[0].depthBuffer=!1,this.depthDownsampleTarget.texture[1].format=Uy,this.depthDownsampleTarget.texture[1].type=iE,this.depthDownsampleTarget.texture[1].minFilter=bn,this.depthDownsampleTarget.texture[1].magFilter=bn,this.depthDownsampleTarget.texture[1].depthBuffer=!1,this.depthDownsampleQuad=new kd(new qe(U5))):(this.depthDownsampleTarget&&(this.depthDownsampleTarget.dispose(),this.depthDownsampleTarget=null),this.depthDownsampleQuad&&(this.depthDownsampleQuad.dispose(),this.depthDownsampleQuad=null))}configureSampleDependentPasses(){this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer)}configureAOPass(t=!1){this.samples=this.generateHemisphereSamples(this.configuration.aoSamples),this.samplesR=this.generateHemisphereSamplesR(this.configuration.aoSamples);const e={...L5};e.fragmentShader=e.fragmentShader.replace("16",this.configuration.aoSamples).replace("16.0",this.configuration.aoSamples+".0"),t&&(e.fragmentShader=`#define LOGDEPTH
`+e.fragmentShader),this.configuration.halfRes&&(e.fragmentShader=`#define HALFRES
`+e.fragmentShader),this.effectShaderQuad?(this.effectShaderQuad.material.dispose(),this.effectShaderQuad.material=new qe(e)):this.effectShaderQuad=new kd(new qe(e))}configureDenoisePass(t=!1){this.samplesDenoise=this.generateDenoiseSamples(this.configuration.denoiseSamples,11);const e={...D5};e.fragmentShader=e.fragmentShader.replace("16",this.configuration.denoiseSamples),t&&(e.fragmentShader=`#define LOGDEPTH
`+e.fragmentShader),this.poissonBlurQuad?(this.poissonBlurQuad.material.dispose(),this.poissonBlurQuad.material=new qe(e)):this.poissonBlurQuad=new kd(new qe(e))}configureEffectCompositer(t=!1){const e={...M5};t&&(e.fragmentShader=`#define LOGDEPTH
`+e.fragmentShader),this.configuration.halfRes&&this.configuration.depthAwareUpsampling&&(e.fragmentShader=`#define HALFRES
`+e.fragmentShader),this.effectCompositerQuad?(this.effectCompositerQuad.material.dispose(),this.effectCompositerQuad.material=new qe(e)):this.effectCompositerQuad=new kd(new qe(e))}generateHemisphereSamples(t){const e=[];for(let i=0;i<t;i++){const s=2.399963*i,n=Math.sqrt(i+.5)/Math.sqrt(t),o=n*Math.cos(s),a=n*Math.sin(s),c=Math.sqrt(1-(o*o+a*a));e.push(new M(o,a,c))}return e}generateHemisphereSamplesR(t){let e=[];for(let i=0;i<t;i++)e.push((i+1)/t);return e}generateDenoiseSamples(t,e){const i=2*Math.PI*e/t,s=1/t,n=s,o=[];let a=s,c=0;for(let l=0;l<t;l++)o.push(new Ot(Math.cos(c),Math.sin(c)).multiplyScalar(Math.pow(a,.75))),a+=n,c+=i;return o}setSize(t,e){this.width=t,this.height=e;const i=this.configuration.halfRes?.5:1;this.beautyRenderTarget.setSize(t,e),this.writeTargetInternal.setSize(t*i,e*i),this.readTargetInternal.setSize(t*i,e*i),this.configuration.halfRes&&this.depthDownsampleTarget.setSize(t*i,e*i)}render(t,e,i,s,n){t.capabilities.logarithmicDepthBuffer!==this.configuration.logarithmicDepthBuffer&&(this.configuration.logarithmicDepthBuffer=t.capabilities.logarithmicDepthBuffer,this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer));let o,a,c;this.debugMode&&(o=t.getContext(),a=o.getExtension("EXT_disjoint_timer_query_webgl2"),a===null&&(console.error("EXT_disjoint_timer_query_webgl2 not available, disabling debug mode."),this.debugMode=!1)),t.setRenderTarget(this.beautyRenderTarget),t.render(this.scene,this.camera),this.debugMode&&(c=o.createQuery(),o.beginQuery(a.TIME_ELAPSED_EXT,c));const l=t.xr.enabled;t.xr.enabled=!1,this.camera.updateMatrixWorld(),this._r.set(this.width,this.height);let h=this.configuration.aoRadius;this.configuration.halfRes&&this.configuration.screenSpaceRadius&&(h*=.5),this.configuration.halfRes&&(t.setRenderTarget(this.depthDownsampleTarget),this.depthDownsampleQuad.material.uniforms.sceneDepth.value=this.beautyRenderTarget.depthTexture,this.depthDownsampleQuad.material.uniforms.resolution.value=this._r,this.depthDownsampleQuad.material.uniforms.near.value=this.camera.near,this.depthDownsampleQuad.material.uniforms.far.value=this.camera.far,this.depthDownsampleQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.depthDownsampleQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.depthDownsampleQuad.material.uniforms.logDepth.value=this.configuration.logarithmicDepthBuffer,this.depthDownsampleQuad.render(t)),this.effectShaderQuad.material.uniforms.sceneDiffuse.value=this.beautyRenderTarget.texture,this.effectShaderQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.beautyRenderTarget.depthTexture,this.effectShaderQuad.material.uniforms.sceneNormal.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[1]:null,this.effectShaderQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.effectShaderQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.effectShaderQuad.material.uniforms.projViewMat.value=this.camera.projectionMatrix.clone().multiply(this.camera.matrixWorldInverse.clone()),this.effectShaderQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectShaderQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectShaderQuad.material.uniforms.cameraPos.value=this.camera.position,this.effectShaderQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.effectShaderQuad.material.uniforms.time.value=performance.now()/1e3,this.effectShaderQuad.material.uniforms.samples.value=this.samples,this.effectShaderQuad.material.uniforms.samplesR.value=this.samplesR,this.effectShaderQuad.material.uniforms.bluenoise.value=this.bluenoise,this.effectShaderQuad.material.uniforms.radius.value=h,this.effectShaderQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectShaderQuad.material.uniforms.near.value=this.camera.near,this.effectShaderQuad.material.uniforms.far.value=this.camera.far,this.effectShaderQuad.material.uniforms.logDepth.value=t.capabilities.logarithmicDepthBuffer,this.effectShaderQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectShaderQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,t.setRenderTarget(this.writeTargetInternal),this.effectShaderQuad.render(t);for(let u=0;u<this.configuration.denoiseIterations;u++)[this.writeTargetInternal,this.readTargetInternal]=[this.readTargetInternal,this.writeTargetInternal],this.poissonBlurQuad.material.uniforms.tDiffuse.value=this.readTargetInternal.texture,this.poissonBlurQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.beautyRenderTarget.depthTexture,this.poissonBlurQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.poissonBlurQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.poissonBlurQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.poissonBlurQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.poissonBlurQuad.material.uniforms.cameraPos.value=this.camera.position,this.poissonBlurQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.poissonBlurQuad.material.uniforms.time.value=performance.now()/1e3,this.poissonBlurQuad.material.uniforms.blueNoise.value=this.bluenoise,this.poissonBlurQuad.material.uniforms.radius.value=this.configuration.denoiseRadius*(this.configuration.halfRes?.5:1),this.poissonBlurQuad.material.uniforms.worldRadius.value=h,this.poissonBlurQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.poissonBlurQuad.material.uniforms.index.value=u,this.poissonBlurQuad.material.uniforms.poissonDisk.value=this.samplesDenoise,this.poissonBlurQuad.material.uniforms.near.value=this.camera.near,this.poissonBlurQuad.material.uniforms.far.value=this.camera.far,this.poissonBlurQuad.material.uniforms.logDepth.value=t.capabilities.logarithmicDepthBuffer,this.poissonBlurQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,t.setRenderTarget(this.writeTargetInternal),this.poissonBlurQuad.render(t);this.effectCompositerQuad.material.uniforms.sceneDiffuse.value=this.beautyRenderTarget.texture,this.effectCompositerQuad.material.uniforms.sceneDepth.value=this.beautyRenderTarget.depthTexture,this.effectCompositerQuad.material.uniforms.near.value=this.camera.near,this.effectCompositerQuad.material.uniforms.far.value=this.camera.far,this.effectCompositerQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectCompositerQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectCompositerQuad.material.uniforms.logDepth.value=t.capabilities.logarithmicDepthBuffer,this.effectCompositerQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectCompositerQuad.material.uniforms.downsampledDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.beautyRenderTarget.depthTexture,this.effectCompositerQuad.material.uniforms.resolution.value=this._r,this.effectCompositerQuad.material.uniforms.blueNoise.value=this.bluenoise,this.effectCompositerQuad.material.uniforms.intensity.value=this.configuration.intensity,this.effectCompositerQuad.material.uniforms.renderMode.value=this.configuration.renderMode,this.effectCompositerQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,this.effectCompositerQuad.material.uniforms.radius.value=h,this.effectCompositerQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectCompositerQuad.material.uniforms.gammaCorrection.value=this.configuration.gammaCorrection,this.effectCompositerQuad.material.uniforms.tDiffuse.value=this.writeTargetInternal.texture,this.effectCompositerQuad.material.uniforms.color.value=this._c.copy(this.configuration.color).convertSRGBToLinear(),t.setRenderTarget(this.renderToScreen?null:e),this.effectCompositerQuad.render(t),this.debugMode&&(o.endQuery(a.TIME_ELAPSED_EXT),AS(c,o,this)),t.xr.enabled=l}enableDebugMode(){this.debugMode=!0}disableDebugMode(){this.debugMode=!1}setDisplayMode(t){this.configuration.renderMode=["Combined","AO","No AO","Split","Split AO"].indexOf(t)}setQualityMode(t){t==="Performance"?(this.configuration.aoSamples=8,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):t==="Low"?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):t==="Medium"?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=12):t==="High"?(this.configuration.aoSamples=64,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=6):t==="Ultra"&&(this.configuration.aoSamples=64,this.configuration.denoiseSamples=16,this.configuration.denoiseRadius=6)}};const V5={name:"GammaCorrectionShader",uniforms:{tDiffuse:{value:null}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 tex = texture2D( tDiffuse, vUv );

			gl_FragColor = sRGBTransferOETF( tex );

		}`};function z5(){return new qe({side:2,clipping:!0,uniforms:{},vertexShader:`
    varying vec4 vColor;
    
    #include <clipping_planes_pars_vertex>
  
    void main() {
       #include <begin_vertex>
    
       vec4 absPosition = vec4(position, 1.0);
       vec3 trueNormal = normal;
       
       #ifdef USE_INSTANCING
          absPosition = instanceMatrix * absPosition;
          trueNormal = (instanceMatrix * vec4(normal, 0.)).xyz;
       #endif
       
       absPosition = modelMatrix * absPosition;
       trueNormal = (normalize(modelMatrix * vec4(trueNormal, 0.))).xyz;
       
       vec3 planePosition = absPosition.xyz / 40.;
       float d = abs(dot(trueNormal, planePosition));
       vColor = vec4(abs(trueNormal), d);
       gl_Position = projectionMatrix * viewMatrix * absPosition;
       
       #include <project_vertex>
       #include <clipping_planes_vertex>
    }
    `,fragmentShader:`
    varying vec4 vColor;
    
    #include <clipping_planes_pars_fragment>
  
    void main() {
      #include <clipping_planes_fragment>
      gl_FragColor = vColor;
    }
    `})}function Y5(){return new qe({side:2,clipping:!0,uniforms:{},vertexShader:`
    varying vec3 vCameraPosition;
    varying vec3 vPosition;
    varying vec3 vNormal;
    
    #include <clipping_planes_pars_vertex>
  
    void main() {
       #include <begin_vertex>
       
       vec4 absPosition = vec4(position, 1.0);
       vNormal = normal;
       
       #ifdef USE_INSTANCING
          absPosition = instanceMatrix * absPosition;
          vNormal = (instanceMatrix * vec4(normal, 0.)).xyz;
       #endif
       
       absPosition = modelMatrix * absPosition;
       vNormal = (normalize(modelMatrix * vec4(vNormal, 0.))).xyz;
       
       gl_Position = projectionMatrix * viewMatrix * absPosition;
       
       vCameraPosition = cameraPosition;
       vPosition = absPosition.xyz;
       
       #include <project_vertex>
       #include <clipping_planes_vertex>
    }
    `,fragmentShader:`
    varying vec3 vCameraPosition;
    varying vec3 vPosition;
    varying vec3 vNormal;
    
    #include <clipping_planes_pars_fragment>
  
    void main() {
      #include <clipping_planes_fragment>
      vec3 cameraPixelVec = normalize(vCameraPosition - vPosition);
      float difference = abs(dot(vNormal, cameraPixelVec));
      
      // This achieves a double gloss effect: when the surface is perpendicular and when it's parallel
      difference = abs((difference * 2.) - 1.);
      
      gl_FragColor = vec4(difference, difference, difference, 1.);
    }
    `})}let G5=class extends jc{constructor(t,e,i,s,n){if(super(),B(this,"components"),B(this,"resolution"),B(this,"renderScene"),B(this,"renderCamera"),B(this,"fsQuad"),B(this,"normalOverrideMaterial"),B(this,"glossOverrideMaterial"),B(this,"planeBuffer"),B(this,"glossBuffer"),B(this,"outlineBuffer"),B(this,"excludedMeshes",[]),B(this,"outlinedMeshes",{}),B(this,"outlineScene",new rn),B(this,"_outlineEnabled",!1),B(this,"_lineColor",10066329),B(this,"_opacity",.4),B(this,"_tolerance",3),B(this,"_glossEnabled",!0),B(this,"_glossExponent",1.9),B(this,"_minGloss",-.1),B(this,"_maxGloss",.1),!i.renderer)throw new Error("The given world must have a renderer!");this.components=e,this.renderScene=s,this.renderCamera=n,this.resolution=new Ot(t.x,t.y),this.fsQuad=new yS,this.fsQuad.material=this.createOutlinePostProcessMaterial(),this.planeBuffer=this.newRenderTarget(),this.glossBuffer=this.newRenderTarget(),this.outlineBuffer=this.newRenderTarget();const o=z5();o.clippingPlanes=i.renderer.clippingPlanes,this.normalOverrideMaterial=o;const a=Y5();a.clippingPlanes=i.renderer.clippingPlanes,this.glossOverrideMaterial=a}get lineColor(){return this._lineColor}set lineColor(t){this._lineColor=t,this.fsQuad.material.uniforms.lineColor.value.set(t)}get tolerance(){return this._tolerance}set tolerance(t){this._tolerance=t;const e=this.fsQuad.material;e.uniforms.tolerance.value=t}get opacity(){return this._opacity}set opacity(t){this._opacity=t;const e=this.fsQuad.material;e.uniforms.opacity.value=t}get glossEnabled(){return this._glossEnabled}set glossEnabled(t){if(t===this._glossEnabled)return;this._glossEnabled=t;const e=this.fsQuad.material;e.uniforms.glossEnabled.value=t?1:0}get glossExponent(){return this._glossExponent}set glossExponent(t){this._glossExponent=t;const e=this.fsQuad.material;e.uniforms.glossExponent.value=t}get minGloss(){return this._minGloss}set minGloss(t){this._minGloss=t;const e=this.fsQuad.material;e.uniforms.minGloss.value=t}get maxGloss(){return new Ue().color.convertLinearToSRGB(),this._maxGloss}set maxGloss(t){this._maxGloss=t;const e=this.fsQuad.material;e.uniforms.maxGloss.value=t}get outlineEnabled(){return this._outlineEnabled}set outlineEnabled(t){if(t===this._outlineEnabled)return;this._outlineEnabled=t;const e=this.fsQuad.material;e.uniforms.outlineEnabled.value=t?1:0}async dispose(){this.planeBuffer.dispose(),this.glossBuffer.dispose(),this.outlineBuffer.dispose(),this.normalOverrideMaterial.dispose(),this.glossOverrideMaterial.dispose(),this.fsQuad.material.dispose(),this.fsQuad.dispose(),this.excludedMeshes=[],this.outlineScene.children=[];const t=this.components.get(en);for(const e in this.outlinedMeshes){const i=this.outlinedMeshes[e];for(const s of i.meshes){t.destroy(s,!0,!0);const n=s;n.fragment&&n.fragment.dispose(!0)}i.material.dispose()}}setSize(t,e){this.planeBuffer.setSize(t,e),this.glossBuffer.setSize(t,e),this.outlineBuffer.setSize(t,e),this.resolution.set(t,e);const i=this.fsQuad.material;i.uniforms.screenSize.value.set(this.resolution.x,this.resolution.y,1/this.resolution.x,1/this.resolution.y),i.uniformsNeedUpdate=!0}render(t,e,i){const s=e.depthBuffer;e.depthBuffer=!1;const n=this.renderScene.overrideMaterial,o=this.renderScene.background;this.renderScene.background=null;for(const c of this.excludedMeshes)c.visible=!1;t.setRenderTarget(this.planeBuffer),this.renderScene.overrideMaterial=this.normalOverrideMaterial,t.render(this.renderScene,this.renderCamera),this._glossEnabled&&(t.setRenderTarget(this.glossBuffer),this.renderScene.overrideMaterial=this.glossOverrideMaterial,t.render(this.renderScene,this.renderCamera)),this.renderScene.overrideMaterial=n,t.setRenderTarget(this.outlineBuffer),this._outlineEnabled?t.render(this.outlineScene,this.renderCamera):t.clear();for(const c of this.excludedMeshes)c.visible=!0;this.renderScene.background=o;const a=this.fsQuad.material;a.uniforms.planeBuffer.value=this.planeBuffer.texture,a.uniforms.glossBuffer.value=this.glossBuffer.texture,a.uniforms.outlineBuffer.value=this.outlineBuffer.texture,a.uniforms.sceneColorBuffer.value=i.texture,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),this.fsQuad.render(t)),e.depthBuffer=s}get vertexShader(){return`
	  varying vec2 vUv;
	  void main() {
	  	vUv = uv;
	  	gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
	  }
	`}get fragmentShader(){return`
	  uniform sampler2D sceneColorBuffer;
	  uniform sampler2D planeBuffer;
	  uniform sampler2D glossBuffer;
	  uniform sampler2D outlineBuffer;
	  uniform vec4 screenSize;
	  uniform vec3 lineColor;
	  
	  uniform float outlineEnabled;
	  
      uniform int width;
	  uniform float opacity;
      uniform float tolerance;
      uniform float glossExponent;
      uniform float minGloss;
      uniform float maxGloss;
      uniform float glossEnabled;

	  varying vec2 vUv;

	  vec4 getValue(sampler2D buffer, int x, int y) {
	  	return texture2D(buffer, vUv + screenSize.zw * vec2(x, y));
	  }

      float normalDiff(vec3 normal1, vec3 normal2) {
        return ((dot(normal1, normal2) - 1.) * -1.) / 2.;
      }

      // Returns 0 if it's background, 1 if it's not
      float getIsBackground(vec3 normal) {
        float background = 1.0;
        background *= step(normal.x, 0.);
        background *= step(normal.y, 0.);
        background *= step(normal.z, 0.);
        background = (background - 1.) * -1.;
        return background;
      }

	  void main() {
	  
	    vec4 sceneColor = getValue(sceneColorBuffer, 0, 0);
	    vec3 normSceneColor = normalize(sceneColor.rgb);
  
        vec4 plane = getValue(planeBuffer, 0, 0);
	    vec3 normal = plane.xyz;
        float distance = plane.w;
  
        vec3 normalTop = getValue(planeBuffer, 0, width).rgb;
        vec3 normalBottom = getValue(planeBuffer, 0, -width).rgb;
        vec3 normalRight = getValue(planeBuffer, width, 0).rgb;
        vec3 normalLeft = getValue(planeBuffer, -width, 0).rgb;
        vec3 normalTopRight = getValue(planeBuffer, width, width).rgb;
        vec3 normalTopLeft = getValue(planeBuffer, -width, width).rgb;
        vec3 normalBottomRight = getValue(planeBuffer, width, -width).rgb;
        vec3 normalBottomLeft = getValue(planeBuffer, -width, -width).rgb;
  
        float distanceTop = getValue(planeBuffer, 0, width).a;
        float distanceBottom = getValue(planeBuffer, 0, -width).a;
        float distanceRight = getValue(planeBuffer, width, 0).a;
        float distanceLeft = getValue(planeBuffer, -width, 0).a;
        float distanceTopRight = getValue(planeBuffer, width, width).a;
        float distanceTopLeft = getValue(planeBuffer, -width, width).a;
        float distanceBottomRight = getValue(planeBuffer, width, -width).a;
        float distanceBottomLeft = getValue(planeBuffer, -width, -width).a;
        
        vec3 sceneColorTop = normalize(getValue(sceneColorBuffer, 1, 0).rgb);
        vec3 sceneColorBottom = normalize(getValue(sceneColorBuffer, -1, 0).rgb);
        vec3 sceneColorLeft = normalize(getValue(sceneColorBuffer, 0, -1).rgb);
        vec3 sceneColorRight = normalize(getValue(sceneColorBuffer, 0, 1).rgb);
        vec3 sceneColorTopRight = normalize(getValue(sceneColorBuffer, 1, 1).rgb);
        vec3 sceneColorBottomRight = normalize(getValue(sceneColorBuffer, -1, 1).rgb);
        vec3 sceneColorTopLeft = normalize(getValue(sceneColorBuffer, 1, 1).rgb);
        vec3 sceneColorBottomLeft = normalize(getValue(sceneColorBuffer, -1, 1).rgb);

        // Checks if the planes of this texel and the neighbour texels are different

        float planeDiff = 0.0;

        planeDiff += step(0.001, normalDiff(normal, normalTop));
        planeDiff += step(0.001, normalDiff(normal, normalBottom));
        planeDiff += step(0.001, normalDiff(normal, normalLeft));
        planeDiff += step(0.001, normalDiff(normal, normalRight));
        planeDiff += step(0.001, normalDiff(normal, normalTopRight));
        planeDiff += step(0.001, normalDiff(normal, normalTopLeft));
        planeDiff += step(0.001, normalDiff(normal, normalBottomRight));
        planeDiff += step(0.001, normalDiff(normal, normalBottomLeft));
        
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorTop));
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorBottom));
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorLeft));
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorRight));
       	planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorTopRight));
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorTopLeft));
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorBottomRight));
        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorBottomLeft));

        planeDiff += step(0.001, abs(distance - distanceTop));
        planeDiff += step(0.001, abs(distance - distanceBottom));
        planeDiff += step(0.001, abs(distance - distanceLeft));
        planeDiff += step(0.001, abs(distance - distanceRight));
        planeDiff += step(0.001, abs(distance - distanceTopRight));
        planeDiff += step(0.001, abs(distance - distanceTopLeft));
        planeDiff += step(0.001, abs(distance - distanceBottomRight));
        planeDiff += step(0.001, abs(distance - distanceBottomLeft));

        // Add extra background outline

        int width2 = width + 1;
        vec3 normalTop2 = getValue(planeBuffer, 0, width2).rgb;
        vec3 normalBottom2 = getValue(planeBuffer, 0, -width2).rgb;
        vec3 normalRight2 = getValue(planeBuffer, width2, 0).rgb;
        vec3 normalLeft2 = getValue(planeBuffer, -width2, 0).rgb;
        vec3 normalTopRight2 = getValue(planeBuffer, width2, width2).rgb;
        vec3 normalTopLeft2 = getValue(planeBuffer, -width2, width2).rgb;
        vec3 normalBottomRight2 = getValue(planeBuffer, width2, -width2).rgb;
        vec3 normalBottomLeft2 = getValue(planeBuffer, -width2, -width2).rgb;

        planeDiff += -(getIsBackground(normalTop2) - 1.);
        planeDiff += -(getIsBackground(normalBottom2) - 1.);
        planeDiff += -(getIsBackground(normalRight2) - 1.);
        planeDiff += -(getIsBackground(normalLeft2) - 1.);
        planeDiff += -(getIsBackground(normalTopRight2) - 1.);
        planeDiff += -(getIsBackground(normalBottomRight2) - 1.);
        planeDiff += -(getIsBackground(normalBottomRight2) - 1.);
        planeDiff += -(getIsBackground(normalBottomLeft2) - 1.);

        // Tolerance sets the minimum amount of differences to consider
        // this texel an edge

        float line = step(tolerance, planeDiff);

        // Exclude background and apply opacity

        float background = getIsBackground(normal);
        line *= background;
        line *= opacity;
        
        // Add gloss
        
        vec3 gloss = getValue(glossBuffer, 0, 0).xyz;
        float diffGloss = abs(maxGloss - minGloss);
        vec3 glossExpVector = vec3(glossExponent,glossExponent,glossExponent);
        gloss = min(pow(gloss, glossExpVector), vec3(1.,1.,1.));
        gloss *= diffGloss;
        gloss += minGloss;
        vec4 glossedColor = sceneColor + vec4(gloss, 1.) * glossEnabled;
        
        vec4 corrected = mix(sceneColor, glossedColor, background);
        
        // Draw lines
        
        corrected = mix(corrected, vec4(lineColor, 1.), line);
        
        // Add outline
        
        vec4 outlinePreview =getValue(outlineBuffer, 0, 0);
        float outlineColorCorrection = 1. / max(0.2, outlinePreview.a);
        vec3 outlineColor = outlinePreview.rgb * outlineColorCorrection;
        
        // thickness between 10 and 2, opacity between 1 and 0.2
	    int outlineThickness = int(outlinePreview.a * 10.);
	    
	    float outlineDiff = 0.;
        
        outlineDiff += step(0.1, getValue(outlineBuffer, 0, 0).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, 1, 0).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, -1, 0).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, 0, -1).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, 0, 1).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, outlineThickness, 0).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, -outlineThickness, 0).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, 0, -outlineThickness).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, 0, outlineThickness).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, outlineThickness, outlineThickness).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, -outlineThickness, outlineThickness).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, -outlineThickness, -outlineThickness).a);
        outlineDiff += step(0.1, getValue(outlineBuffer, outlineThickness, -outlineThickness).a);
        
        float outLine = step(4., outlineDiff) * step(outlineDiff, 12.) * outlineEnabled;
        corrected = mix(corrected, vec4(outlineColor, 1.), outLine);
        
        gl_FragColor = corrected;
	}
			`}createOutlinePostProcessMaterial(){return new qe({uniforms:{opacity:{value:this._opacity},debugVisualize:{value:0},sceneColorBuffer:{value:null},tolerance:{value:this._tolerance},planeBuffer:{value:null},glossBuffer:{value:null},outlineBuffer:{value:null},glossEnabled:{value:1},minGloss:{value:this._minGloss},maxGloss:{value:this._maxGloss},outlineEnabled:{value:0},glossExponent:{value:this._glossExponent},width:{value:1},lineColor:{value:new Rt(this._lineColor)},screenSize:{value:new Do(this.resolution.x,this.resolution.y,1/this.resolution.x,1/this.resolution.y)}},vertexShader:this.vertexShader,fragmentShader:this.fragmentShader})}newRenderTarget(){const t=new ts(this.resolution.x,this.resolution.y);return t.texture.colorSpace="srgb-linear",t.texture.format=Uy,t.texture.type=iE,t.texture.minFilter=bn,t.texture.magFilter=bn,t.texture.generateMipmaps=!1,t.stencilBuffer=!1,t}},H5=class{constructor(t,e,i){if(B(this,"composer"),B(this,"overrideClippingPlanes",!1),B(this,"_components"),B(this,"_world"),B(this,"_renderTarget"),B(this,"_enabled",!1),B(this,"_initialized",!1),B(this,"_n8ao"),B(this,"_customEffects"),B(this,"_basePass"),B(this,"_gammaPass"),B(this,"_depthTexture"),B(this,"_renderer"),B(this,"_settings",{gamma:!0,custom:!0,ao:!1}),!i.renderer)throw new Error("The given world must have a renderer!");this._components=t,this._renderer=e,this._world=i,this._renderTarget=new ts(window.innerWidth,window.innerHeight),this._renderTarget.texture.colorSpace="srgb-linear",this.composer=new x5(e,this._renderTarget),this.composer.setSize(window.innerWidth,window.innerHeight)}get basePass(){if(!this._basePass)throw new Error("Custom effects not initialized!");return this._basePass}get gammaPass(){if(!this._gammaPass)throw new Error("Custom effects not initialized!");return this._gammaPass}get customEffects(){if(!this._customEffects)throw new Error("Custom effects not initialized!");return this._customEffects}get n8ao(){if(!this._n8ao)throw new Error("Custom effects not initialized!");return this._n8ao}get enabled(){return this._enabled}set enabled(t){this._initialized||this.initialize(),this._enabled=t}get settings(){return{...this._settings}}dispose(){var t,e,i,s;this.composer.dispose(),this._renderTarget.dispose(),(t=this._depthTexture)==null||t.dispose(),(e=this._customEffects)==null||e.dispose(),(i=this._gammaPass)==null||i.dispose(),(s=this._n8ao)==null||s.dispose()}setPasses(t){let e=!1;for(const i in t){const s=i;if(this.settings[s]!==t[s]){e=!0;break}}if(e){for(const i in t){const s=i;this._settings[s]!==void 0&&(this._settings[s]=t[s])}this.updatePasses()}}setSize(t,e){if(!(t===0||e===0)&&this._initialized){const i=this._settings.custom;i&&this.setPasses({custom:!1}),this.setPasses({custom:!1}),this.composer.setSize(t,e),this.basePass.setSize(t,e),this.n8ao.setSize(t,e),this.customEffects.setSize(t,e),this.gammaPass.setSize(t,e),i&&this.setPasses({custom:!0})}}update(){this._enabled&&this.composer.render()}updateCamera(){const t=this._world.camera.three;this._n8ao&&(this._n8ao.camera=t),this._customEffects&&(this._customEffects.renderCamera=t),this._basePass&&(this._basePass.camera=t)}updateProjection(t){this.composer.passes.forEach(e=>{e.camera=t}),this.update()}initialize(){if(!this._world.renderer)throw new Error("The given world must have a renderer!");const t=this._world.scene.three,e=this._world.camera.three;if(!(t instanceof rn))throw new Error("The given scene must have a THREE.Scene as core!");const i=this._world.camera;i.projection&&i.projection.onChanged.add(()=>{this.updateCamera()});const s=this._world.renderer;this.overrideClippingPlanes||(this._renderer.clippingPlanes=s.clippingPlanes),this._renderer.outputColorSpace="srgb",this._renderer.toneMapping=k_,this.newBasePass(t,e),this.newSaoPass(t,e),this.newGammaPass(),this.newCustomPass(t,e),this._initialized=!0,this.updatePasses()}updatePasses(){for(const t of this.composer.passes)this.composer.removePass(t);this._basePass&&this.composer.addPass(this.basePass),this._settings.gamma&&this.composer.addPass(this.gammaPass),this._settings.ao&&this.composer.addPass(this.n8ao),this._settings.custom&&this.composer.addPass(this.customEffects)}newCustomPass(t,e){this._customEffects=new G5(new Ot(window.innerWidth,window.innerHeight),this._components,this._world,t,e)}newGammaPass(){this._gammaPass=new vS(V5)}newSaoPass(t,e){if(!this._world.renderer)throw new Error("The given world must have a renderer!");const{width:i,height:s}=this._world.renderer.getSize();this._n8ao=new k5(t,e,i,s);const{configuration:n}=this._n8ao;n.aoSamples=16,n.denoiseSamples=1,n.denoiseRadius=13,n.aoRadius=1,n.distanceFalloff=4,n.aoRadius=1,n.intensity=4,n.halfRes=!0,n.color=new Rt().setHex(13421772,"srgb-linear")}newBasePass(t,e){this._basePass=new N5(t,e)}};class ce extends IS{constructor(t,e,i){super(t,e,i),B(this,"_postproduction"),this.onResize.add(s=>this.resizePostproduction(s)),this.onWorldChanged.add(()=>{this.currentWorld&&(this._postproduction&&this._postproduction.dispose(),this._postproduction=new H5(t,this.three,this.currentWorld),this.setPostproductionSize())})}get postproduction(){if(!this._postproduction)throw new Error("Renderer not initialized yet with a world!");return this._postproduction}update(){if(!this.enabled||!this.currentWorld)return;this.onBeforeUpdate.trigger();const t=this.currentWorld.scene.three,e=this.currentWorld.camera.three;this.postproduction.enabled?this.postproduction.composer.render():this.three.render(t,e),t instanceof rn&&this.three2D.render(t,e),this.onAfterUpdate.trigger()}dispose(){super.dispose(),this.postproduction.dispose()}resizePostproduction(t){this.postproduction&&this.setPostproductionSize(t)}setPostproductionSize(t){if(!this.container)return;const e=t?t.x:this.container.clientWidth,i=t?t.y:this.container.clientHeight;this.postproduction.setSize(e,i)}}let $5=class{constructor(t,e,i,s,n){B(this,"mesh",new it(new Ut)),B(this,"components"),B(this,"world"),B(this,"styleName"),B(this,"_precission",1e4),B(this,"_tempVector",new M),B(this,"_plane"),B(this,"_geometry"),B(this,"_outlinedMesh"),B(this,"_plane2DCoordinateSystem",new ht),B(this,"_planeAxis"),this.components=t,this.world=e,this.mesh.material=n,this.mesh.frustumCulled=!1,this.mesh.userData.indexFragmentMap=new Map,this._plane=i;const{x:o,y:a,z:c}=i.normal;Math.abs(o)===1?this._planeAxis="x":Math.abs(a)===1?this._planeAxis="y":Math.abs(c)===1&&(this._planeAxis="z"),this._geometry=s,this.mesh.geometry.attributes.position=s.attributes.position;const l=i.normal.clone().multiplyScalar(.01);this._outlinedMesh=new it(this.mesh.geometry),this.mesh.position.copy(l),this._outlinedMesh.position.copy(l),this.visible=!0}get visible(){return this.mesh.parent!==null}set visible(t){const e=this.getStyleAndScene();if(t){if(this.world.scene.three.add(this.mesh),e){const{style:i,outlineScene:s}=e;this._outlinedMesh.material=i.material,i.meshes.add(this._outlinedMesh),s.add(this._outlinedMesh)}}else if(this.mesh.removeFromParent(),e){const{style:i}=e;i.meshes.delete(this._outlinedMesh),this._outlinedMesh.removeFromParent()}}set geometry(t){this._geometry=t,this.mesh.geometry.attributes.position=t.attributes.position}dispose(){const t=this.getStyleAndScene();if(t){const{style:e}=t;e.meshes.delete(this._outlinedMesh),this._outlinedMesh.removeFromParent()}this.mesh.material=[],this._outlinedMesh.material=[],this.mesh.userData.indexFragmentMap.clear(),this.mesh.userData={},this.mesh.geometry.dispose(),this.mesh.removeFromParent(),this.mesh.geometry=null,this._outlinedMesh.geometry=null,this.mesh=null,this._plane=null,this._geometry=null,this.components=null}update(t,e){const i=this._geometry.attributes.position.array;if(!i)return;this.updatePlane2DCoordinateSystem();const{userData:s}=this.mesh,n=s.indexFragmentMap;n.clear();let o=0;const a=[];let c=0;const l=this.components.get(Nt);for(const[h,u]of e)for(const d in u){const f=l.list.get(d);f&&(f.mesh.userData.fills||(f.mesh.userData.fills=new Set),f.mesh.userData.fills.add(this.mesh))}for(let h=0;h<t.length;h++){const u=t[h],d=[];for(let g=c;g<u;g+=2)d.push(g*3);const f=this.computeFill(d,i),p=e.get(u);let m=0;for(const g of f)a.push(g),p&&m%3===0&&n.set(o++,p),m++;c=u}this.mesh.geometry.setIndex(a)}computeFill(t,e){const i=new Map,s={},n=new Map;let o=0;const a=new Map,c=new Map,l=new Set,h=this._precission;for(let d=0;d<t.length;d++){const f=t[d];let p=0,m=0,g=0,I=0;const C=e[f],b=e[f+1],E=e[f+2],T=e[f+3],A=e[f+4],S=e[f+5];if(this._tempVector.set(C,b,E),this._tempVector.applyMatrix4(this._plane2DCoordinateSystem),p=Math.trunc(this._tempVector.x*h)/h,m=Math.trunc(this._tempVector.y*h)/h,this._tempVector.set(T,A,S),this._tempVector.applyMatrix4(this._plane2DCoordinateSystem),g=Math.trunc(this._tempVector.x*h)/h,I=Math.trunc(this._tempVector.y*h)/h,p===g&&m===I)continue;const _=`${p}|${m}`,w=`${g}|${I}`;i.has(_)||i.set(_,f/3),i.has(w)||i.set(w,f/3+1);const F=i.get(_),D=i.get(w);s[F]=[p,m],s[D]=[g,I];const R=c.has(F),O=a.has(F),y=c.has(D),U=a.has(D);if(!R&&!O&&!y&&!U)c.set(F,o),a.set(D,o),l.add(o),n.set(o,[F,D]),o++;else if(R&&U){const H=c.get(F),k=a.get(D);if(H!==k){const X=n.get(k),$=n.get(H);if(!X||!$)continue;n.delete(H),l.delete(H),a.set($[$.length-1],k),a.delete(X[X.length-1]);for(const et of $)X.push(et)}else l.delete(k);c.delete(F),a.delete(D)}else if(O&&y){const H=c.get(D),k=a.get(F);if(H!==k){const X=n.get(k),$=n.get(H);if(!X||!$)continue;n.delete(H),l.delete(H),a.set($[$.length-1],k),a.delete(X[X.length-1]);for(const et of $)X.push(et)}else l.delete(k);c.delete(D),a.delete(F)}else if(R&&y){const H=c.get(D),k=c.get(F),X=n.get(k),$=n.get(H);if(!X||!$)continue;n.delete(H),l.delete(H),c.delete(X[0]),c.delete($[0]),a.delete($[$.length-1]),c.set($[$.length-1],k),$.reverse(),X.splice(0,0,...$)}else if(O&&U){const H=a.get(D),k=a.get(F),X=n.get(k),$=n.get(H);if(!X||!$)continue;n.delete(H),l.delete(H),a.delete(X[X.length-1]),a.delete($[$.length-1]),c.delete($[0]),a.set($[0],k),$.reverse(),X.push(...$)}else if(R){const H=c.get(F),k=n.get(H);if(!k)continue;k.unshift(D),c.delete(F),c.set(D,H)}else if(O){const H=a.get(F),k=n.get(H);if(!k)continue;k.push(D),a.delete(F),a.set(D,H)}else if(y){const H=c.get(D),k=n.get(H);if(!k)continue;k.unshift(F),c.delete(D),c.set(F,H)}else if(U){const H=a.get(D),k=n.get(H);if(!k)continue;k.push(F),a.delete(D),a.set(F,H)}}const u=[];for(const[d,f]of n){if(l.has(d))continue;const p=[],m=new Map;let g=0;for(const C of f){const b=s[C];p.push(b[0],b[1]),m.set(g++,C)}const I=A5(p);for(const C of I){const b=m.get(C);if(b===void 0)throw new Error("Map error!");u.push(b)}}return u}updatePlane2DCoordinateSystem(){this._plane2DCoordinateSystem=new ht;const t=new M(1,0,0),e=new M(0,1,0),i=this._plane.normal,s=new M;this._plane.coplanarPoint(s),this._planeAxis==="x"?t.crossVectors(e,i):this._planeAxis==="y"?e.crossVectors(i,t):this._planeAxis==="z"||(t.crossVectors(e,i).normalize(),e.crossVectors(i,t)),this._plane2DCoordinateSystem.fromArray([t.x,t.y,t.z,0,e.x,e.y,e.z,0,i.x,i.y,i.z,0,s.x,s.y,s.z,1]),this._plane2DCoordinateSystem.invert()}getStyleAndScene(){if(!this.world.renderer)return null;const t=this.world.renderer instanceof ce;if(this.styleName&&t){const e=this.world.renderer,i=e.postproduction.customEffects.outlinedMeshes[this.styleName],s=e.postproduction.customEffects.outlineScene;return{style:i,outlineScene:s}}return null}},W5=class{constructor(t,e,i){B(this,"onDisposed",new nt),B(this,"onAfterUpdate",new nt),B(this,"onBeforeUpdate",new nt),B(this,"enabled",!0),B(this,"fillNeedsUpdate",!1),B(this,"components"),B(this,"world"),B(this,"_edges",{}),B(this,"_visible",!0),B(this,"_inverseMatrix",new ht),B(this,"_localPlane",new Qe),B(this,"_tempLine",new Vt),B(this,"_tempVector",new M),B(this,"_plane"),this.components=t,this.world=e,this._plane=i}get visible(){return this._visible}set visible(t){this._visible=t;for(const e in this._edges){const i=this._edges[e];t?this.world.scene.three.add(i.mesh):i.mesh.removeFromParent(),i.fill&&(i.fill.visible=t)}}get fillMeshes(){const t=[];for(const e in this._edges){const i=this._edges[e];i.fill&&t.push(i.fill.mesh)}return t}update(){const t=this.components.get(Vd).styles.list;this.updateDeletedEdges(t);for(const e in t)this.drawEdges(e);this.fillNeedsUpdate=!1}get(){return this._edges}dispose(){const t=Object.keys(this._edges);for(const e of t)this.disposeEdge(e);this.onDisposed.trigger(),this.onDisposed.reset()}newEdgesMesh(t){const e=this.components.get(Vd).styles.list[t].lineMaterial,i=new Ut,s=new Float32Array(3e5),n=new Kt(s,3,!1);n.setUsage(J_),i.setAttribute("position",n);const o=new Zg(i,e);return o.frustumCulled=!1,o}newFillMesh(t,e){const i=this.components.get(Vd).styles.list[t],s=i.fillMaterial;if(s){const n=new $5(this.components,this.world,this._plane,e,s);return this.newFillOutline(t,n,i),n}}newFillOutline(t,e,i){if(!i.outlineMaterial||!this.world.renderer)return;const s=this.world.renderer;if(s instanceof ce){const n=s.postproduction.customEffects.outlinedMeshes;n[t]||(n[t]={meshes:new Set,material:i.outlineMaterial}),e.styleName=t}}drawEdges(t){const e=this.components.get(Vd).styles.list[t];this._edges[t]||this.initializeStyle(t);const i=this._edges[t];let s=0;const n=i.mesh.geometry.attributes.position;n.array.fill(0);const o=[];let a=0;const c=new Map;for(const h of e.meshes)if(h.geometry){if(!h.geometry.boundsTree)throw new Error("Bounds tree not found for clipping edges subset.");if(h instanceof Pe){if(h.count===0)continue;const u=h;for(let d=0;d<u.count;d++){const f=u instanceof Rh,p=u,m=e.fragments[p.fragment.id];if(f&&m){const C=p.fragment.getItemID(d);if(C===null||!m.has(C))continue}const g=new it(h.geometry);g.matrix.copy(h.matrix);const I=new ht;if(u.getMatrixAt(d,I),g.applyMatrix4(I),g.applyMatrix4(h.matrixWorld),g.updateMatrix(),g.updateMatrixWorld(),this._inverseMatrix.copy(g.matrixWorld).invert(),this._localPlane.copy(this._plane).applyMatrix4(this._inverseMatrix),s=this.shapecast(g,n,s),s!==a){if(f&&m){const C=p.fragment.getItemID(d);C!==null&&c.set(s,{[p.fragment.id]:new Set([C])})}o.push(s),a=s}}}else this._inverseMatrix.copy(h.matrixWorld).invert(),this._localPlane.copy(this._plane).applyMatrix4(this._inverseMatrix),s=this.shapecast(h,n,s),s!==a&&(o.push(s),a=s)}i.mesh.geometry.setDrawRange(0,s),i.mesh.position.copy(this._plane.normal).multiplyScalar(1e-4),n.needsUpdate=!0;const l=i.mesh.geometry.attributes.position;Number.isNaN(l.array[0])||this.fillNeedsUpdate&&i.fill&&(i.fill.geometry=i.mesh.geometry,i.fill.update(o,c),i.fill.visible=this._visible)}initializeStyle(t){const e=this.newEdgesMesh(t),i=e.geometry,s=this.newFillMesh(t,i);this._edges[t]={mesh:e,name:t,fill:s}}shapecast(t,e,i){return t.geometry.boundsTree.shapecast({intersectsBounds:s=>this._localPlane.intersectsBox(s),intersectsTriangle:s=>{let n=0;if(this._tempLine.start.copy(s.a),this._tempLine.end.copy(s.b),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const o=this._tempVector.applyMatrix4(t.matrixWorld);e.setXYZ(i,o.x,o.y,o.z),n++,i++}if(this._tempLine.start.copy(s.b),this._tempLine.end.copy(s.c),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const o=this._tempVector.applyMatrix4(t.matrixWorld);e.setXYZ(i,o.x,o.y,o.z),n++,i++}if(this._tempLine.start.copy(s.c),this._tempLine.end.copy(s.a),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const o=this._tempVector.applyMatrix4(t.matrixWorld);e.setXYZ(i,o.x,o.y,o.z),n++,i++}n!==2&&(i-=n)}}),i}updateDeletedEdges(t){const e=Object.keys(this._edges);for(const i of e)t[i]===void 0&&(this.disposeEdge(i),this.disposeOutline(i))}disposeOutline(t){if(!this.world.renderer)return;const e=this.world.renderer;if(e instanceof ce){const i=e.postproduction.customEffects.outlinedMeshes;delete i[t]}}disposeEdge(t){const e=this.components.get(en),i=this._edges[t];i.fill&&i.fill.dispose(),e.destroy(i.mesh,!1),delete this._edges[t]}},xf=class extends TA{constructor(t,e,i,s,n,o=5,a=!0){super(t,e,i,s,n,o,a),B(this,"edges"),B(this,"edgesMaxUpdateRate",50),B(this,"_visible",!0),B(this,"_edgesVisible",!0),B(this,"updateFill",()=>{this.edges.fillNeedsUpdate=!0,this.edges.update()}),this.edges=new W5(t,e,this.three),this.toggleControls(!0),this.edges.visible=!0,this.onDraggingEnded.add(()=>{this.updateFill(),this.edges.visible=!0}),this.onDraggingStarted.add(()=>this.edges.visible=!1)}get visible(){return this._visible}set visible(t){super.visible=t,this.toggleControls(t)}set enabled(t){this._enabled=t,this.world.renderer&&this.world.renderer.setPlane(t,this.three)}get enabled(){return super.enabled}dispose(){super.dispose(),this.edges.dispose()}},j5=class{constructor(){B(this,"onDisposed",new nt),B(this,"enabled",!0),B(this,"list",{}),B(this,"_defaultLineMaterial",new xi({color:0,linewidth:.001})),B(this,"onAfterUpdate",new nt),B(this,"onBeforeUpdate",new nt)}update(t){this.onBeforeUpdate.trigger(this.list),this.onAfterUpdate.trigger(this.list)}create(t,e,i,s,n,o){if(!i.renderer)throw new Error("The given world doesn't have a renderer!");s||(s=this._defaultLineMaterial);for(const l of e)l.geometry.boundsTree||l.geometry.computeBoundsTree();const a=i.renderer;s.clippingPlanes=a.clippingPlanes;const c={name:t,lineMaterial:s,meshes:e,fillMaterial:n,outlineMaterial:o,fragments:{}};return this.list[t]=c,c}dispose(){const t=Object.keys(this.list);for(const e of t)this.deleteStyle(e);this.list={},this.onDisposed.trigger(),this.onDisposed.reset()}deleteStyle(t,e=!0){var i,s;const n=this.list[t];n&&(n.meshes.clear(),e&&(n.lineMaterial.dispose(),(i=n.fillMaterial)==null||i.dispose(),(s=n.outlineMaterial)==null||s.dispose())),delete this.list[t]}};const SS=class wS extends xt{constructor(t){super(t),B(this,"onDisposed",new nt),B(this,"enabled",!0),B(this,"styles"),B(this,"fillsNeedUpdate",!1),B(this,"_visible",!0),this.components.list.set(wS.uuid,this),this.styles=new j5}get visible(){return this._visible}set visible(t){this._visible=t;const e=this.components.get(cc);for(const i of e.list)i instanceof xf&&(i.edges.visible=t)}dispose(){this.styles.dispose(),this.onDisposed.trigger()}async update(t=!1){if(!this.enabled)return;const e=this.components.get(cc);for(const i of e.list)i instanceof xf&&(t||this.fillsNeedUpdate?i.updateFill():i.update());this.fillsNeedUpdate=!1}};B(SS,"uuid","24dfc306-a3c4-410f-8071-babc4afa5e4d");let Vd=SS;const X5={name:"HorizontalBlurShader",uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float h;

		varying vec2 vUv;

		void main() {

			vec4 sum = vec4( 0.0 );

			sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
			sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
			sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

			gl_FragColor = sum;

		}`},Z5={name:"VerticalBlurShader",uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float v;

		varying vec2 vUv;

		void main() {

			vec4 sum = vec4( 0.0 );

			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

			gl_FragColor = sum;

		}`},q5=class Da extends xt{constructor(t){super(t),B(this,"onDisposed",new nt),B(this,"enabled",!0),B(this,"cameraHeight",10),B(this,"darkness",1.2),B(this,"opacity",1),B(this,"resolution",512),B(this,"amount",3.5),B(this,"planeColor",16777215),B(this,"shadowOffset",0),B(this,"shadowExtraScaleFactor",1.5),B(this,"list",{}),B(this,"tempMaterial",new Ue({visible:!1})),B(this,"depthMaterial",new Jg),this.components.add(Da.uuid,this),this.initializeDepthMaterial()}dispose(){for(const t in this.list)this.deleteShadow(t);this.tempMaterial.dispose(),this.depthMaterial.dispose(),this.components=null,this.onDisposed.trigger(Da.uuid),this.onDisposed.reset()}create(t,e,i){if(this.list[e])throw new Error(`There is already a shadow with ID ${e}`);const{size:s,center:n,min:o}=this.getSizeCenterMin(t),a=this.createShadow(e,s,i);return this.initializeShadow(a,n,o),this.createPlanes(a,s),this.bakeShadow(t,a),a.root}deleteShadow(t){const e=this.components.get(en),i=this.list[t];if(delete this.list[t],!i)throw new Error(`No shadow with ID ${t} was found.`);e.destroy(i.root),e.destroy(i.blurPlane),i.rt.dispose(),i.rtBlur.dispose()}createPlanes(t,e){const i=new Uo(e.x,e.z).rotateX(Math.PI/2);this.createBasePlane(t,i),Da.createBlurPlane(t,i)}initializeShadow(t,e,i){this.initializeRoot(t,e,i),Da.initializeRenderTargets(t),Da.initializeCamera(t)}bakeShadow(t,e){const i=e.world.scene.three;if(!(i instanceof rn))throw new Error("The core of the scene of the world must be a scene!");if(!e.world.renderer)throw new Error("The given world must have a renderer!");const s=e.world.renderer.three,n=t.map(l=>!!l.parent);for(let l=0;l<t.length;l++)n[l]||i.add(t[l]);const o=i.children.filter(l=>!t.includes(l)&&l!==e.root);for(let l=o.length-1;l>=0;l--)i.remove(o[l]);const a=i.background;i.background=null,i.overrideMaterial=this.depthMaterial;const c=[];for(const l of t)c.push(l.visible),l.visible=!0;s.setRenderTarget(e.rt),s.render(i,e.camera),i.overrideMaterial=null,this.blurShadow(e,this.amount),this.blurShadow(e,this.amount*.4),s.setRenderTarget(null),i.background=a;for(let l=0;l<t.length;l++)t[l].visible=c[l];for(let l=o.length-1;l>=0;l--)i.add(o[l]);for(let l=0;l<t.length;l++)n[l]||i.remove(t[l])}static initializeCamera(t){t.camera.rotation.x=Math.PI/2,t.root.add(t.camera)}static initializeRenderTargets(t){t.rt.texture.generateMipmaps=!1,t.rtBlur.texture.generateMipmaps=!1}initializeRoot(t,e,i){const s=t.world.scene.three;t.root.position.set(e.x,i.y-this.shadowOffset,e.z),s.add(t.root)}createBasePlane(t,e){const i=this.createPlaneMaterial(t),s=new it(e,i);s.renderOrder=2,t.root.add(s),s.scale.y=-1}static createBlurPlane(t,e){t.blurPlane.geometry=e,t.blurPlane.visible=!1,t.root.add(t.blurPlane)}createPlaneMaterial(t){if(!t.world.renderer)throw new Error("The given world must have a renderer!");const e=t.world.renderer.three;return new Ue({map:t.rt.texture,opacity:this.opacity,transparent:!0,depthWrite:!1,clippingPlanes:e.clippingPlanes})}initializeDepthMaterial(){this.depthMaterial.depthTest=!1,this.depthMaterial.depthWrite=!1;const t="gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );",e="gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * darkness );";this.depthMaterial.userData.darkness={value:this.darkness},this.depthMaterial.onBeforeCompile=i=>{i.uniforms.darkness=this.depthMaterial.userData.darkness,i.fragmentShader=`
						uniform float darkness;
						${i.fragmentShader.replace(t,e)}
					`}}createShadow(t,e,i){return this.list[t]={root:new vo,world:i,rt:new ts(this.resolution,this.resolution),rtBlur:new ts(this.resolution,this.resolution),blurPlane:new it,camera:this.createCamera(e)},this.list[t]}createCamera(t){return new cs(-t.x/2,t.x/2,t.z/2,-t.z/2,0,this.cameraHeight)}getSizeCenterMin(t){const e=t[0].parent,i=new vo;i.children=t;const s=new vt().setFromObject(i);e?.add(...t);const n=new M;s.getSize(n),n.x*=this.shadowExtraScaleFactor,n.z*=this.shadowExtraScaleFactor;const o=new M;s.getCenter(o);const a=s.min;return{size:n,center:o,min:a}}blurShadow(t,e){if(!t.world.renderer)throw new Error("The given world must have a renderer!");const i=new qe(X5);i.depthTest=!1;const s=new qe(Z5);s.depthTest=!1,t.blurPlane.visible=!0,t.blurPlane.material=i,t.blurPlane.material.uniforms.tDiffuse.value=t.rt.texture,i.uniforms.h.value=e*1/256;const n=t.world.renderer.three;n.setRenderTarget(t.rtBlur),n.render(t.blurPlane,t.camera),t.blurPlane.material=s,t.blurPlane.material.uniforms.tDiffuse.value=t.rtBlur.texture,s.uniforms.v.value=e*1/256,n.setRenderTarget(t.rt),n.render(t.blurPlane,t.camera),t.blurPlane.visible=!1}};B(q5,"uuid","f833a09a-a3ab-4c58-b03e-da5298c7a1b6");const Q5=class _S extends xt{constructor(t){super(t),B(this,"enabled",!0),B(this,"inputs",["OBC","BUI"]),B(this,"_requestEventID","thatOpenCompanyComponentRequested"),B(this,"_createEventID","thatOpenCompanyComponentCreated"),t.add(_S.uuid,this)}async import(t){return new Promise(e=>{const i=document.createElement("script"),s=`
        function main() {
          const { ${this.inputs} } = window.ThatOpenCompany;
        
          ${t}
        
          const onComponentRequested = () => {
            window.removeEventListener("${this._requestEventID}", onComponentRequested);
            const event = new CustomEvent("${this._createEventID}", { detail: main });
            window.dispatchEvent(event);
          };
          
          window.addEventListener("${this._requestEventID}", onComponentRequested);
        }
        
        main();
      `,n=o=>{window.removeEventListener(this._createEventID,n);const a=o.detail,c=this.components.get(a);i.remove(),e(c)};i.addEventListener("load",()=>{window.addEventListener(this._createEventID,n),window.dispatchEvent(new Event(this._requestEventID))}),i.src=URL.createObjectURL(new File([s],"temp.js")),document.head.appendChild(i)})}};B(Q5,"uuid","74c0c370-1af8-4ca9-900a-4a4196c0f2f5");const K5=["Station","Radius","Length","InitialKP","FinalKP","KP","Slope","Height","InitialKPV","FinalKPV"],FS=class OS extends xt{constructor(t){super(t),B(this,"enabled",!0),B(this,"world",null),B(this,"_markerKey",0),B(this,"_list",new Map),B(this,"type","horizontal"),B(this,"divisionLength",100),t.add(OS.uuid,this)}addKPStation(t,e,i){const s=this.components.get(Jr),n=document.createElement("div"),o=document.createElement("div");n.appendChild(o),o.innerHTML=e,o.style.color=s.color,o.style.borderBottom="1px dotted white",o.style.width="160px",o.style.textAlign="left";const a=new mi(t,n),c=new M;c.x=i.geometry.attributes.position.getX(i.geometry.attributes.position.count-1),c.y=i.geometry.attributes.position.getY(i.geometry.attributes.position.count-1),c.z=i.geometry.attributes.position.getZ(i.geometry.attributes.position.count-1);const l=new M;l.x=i.geometry.attributes.position.getX(i.geometry.attributes.position.count-2),l.y=i.geometry.attributes.position.getY(i.geometry.attributes.position.count-2),l.z=i.geometry.attributes.position.getZ(i.geometry.attributes.position.count-2);const h=new M;h.x=(c.x+l.x)/2,h.y=(c.y+l.y)/2,h.z=(c.z+l.z)/2,a.three.position.copy(h);const u=new M;u.subVectors(c,l).normalize();const d=new Ce;d.setFromUnitVectors(new M(0,1,0),u);const f=new tE().setFromQuaternion(d).z,p=Ss.radToDeg(f);o.style.transform=`rotate(${-p-90}deg) translate(-35%, -50%)`;const m=this._markerKey.toString();s.setupEvents(t,!0),s.getWorldMarkerList(t).set(m,{label:a,key:m,merged:!1,static:!1}),this._markerKey++,this.save(m,"KP")}addVerticalMarker(t,e,i,s,n){const o=this.components.get(Jr),a=document.createElement("span");a.innerHTML=e,a.style.color=o.color;const c=new mi(t,a,n);if(s==="Height"){const h=document.createElement("span");h.innerHTML=e,h.style.color=o.color;const{position:u}=i.geometry.attributes,d=(u.array.length/3-1)*3,f=u.array.slice(d,d+3);c.three.position.set(f[0],f[1]+10,f[2])}else if(s==="InitialKPV"){const{position:h}=i.geometry.attributes,u=h.getX(0),d=h.getY(0),f=h.getZ(0);c.three.position.set(u-20,d,f)}else if(s==="FinalKPV"){const{position:h}=i.geometry.attributes,u=h.getX(i.geometry.attributes.position.count-1),d=h.getY(i.geometry.attributes.position.count-1),f=h.getZ(i.geometry.attributes.position.count-1);c.three.position.set(u+20,d,f)}else if(s==="Slope"){a.style.color="grey";const{position:h}=i.geometry.attributes,u=new M;u.x=h.getX(0),u.y=h.getY(0),u.z=h.getZ(0);const d=new M;d.x=h.getX(h.count-1),d.y=h.getY(h.count-1),d.z=h.getZ(h.count-1);const f=new M;f.addVectors(u,d).multiplyScalar(.5),c.three.position.set(f.x,f.y-10,f.z)}const l=this._markerKey.toString();return o.setupEvents(t,!0),o.getWorldMarkerList(t).set(l,{label:c,key:l,type:s,merged:!1,static:!1}),this._markerKey++,this.save(l,s),c}addCivilMarker(t,e,i,s){const n=this.components.get(Jr),o=document.createElement("span");o.innerHTML=e,o.style.color=n.color;const a=new mi(t,o);if(s==="InitialKP"){const l=i.geometry.attributes.position.getX(0),h=i.geometry.attributes.position.getY(0),u=i.geometry.attributes.position.getZ(0);a.three.position.set(l+2,h+2,u)}else if(s==="FinalKP"){const l=i.geometry.attributes.position.getX(i.geometry.attributes.position.count-1),h=i.geometry.attributes.position.getY(i.geometry.attributes.position.count-1),u=i.geometry.attributes.position.getZ(i.geometry.attributes.position.count-1);a.three.position.set(l+2,h-2,u)}else if(s==="Length"){const l=new M;l.x=i.geometry.attributes.position.getX(0),l.y=i.geometry.attributes.position.getY(0),l.z=i.geometry.attributes.position.getZ(0);const h=new M;h.x=i.geometry.attributes.position.getX(i.geometry.attributes.position.count-1),h.y=i.geometry.attributes.position.getY(i.geometry.attributes.position.count-1),h.z=i.geometry.attributes.position.getZ(i.geometry.attributes.position.count-1);const u=l.distanceTo(h);a.three.element.innerText=u.toFixed(2);const d=h.clone().add(l).divideScalar(2);a.three.position.copy(d)}const c=this._markerKey.toString();return n.setupEvents(t,!0),n.getWorldMarkerList(t).set(c,{label:a,key:c,type:s,merged:!1,static:!1}),this._markerKey++,this.save(c,s),a}showKPStations(t){if(!this.world)throw new Error("A world is needed for this component to work!");if(this.type==="horizontal"){const e=this.generateStartAndEndKP(t);for(const[,s]of e)this.addKPStation(this.world,s.value,s.normal);const i=this.generateConstantKP(t);for(const[,s]of i)this.addKPStation(this.world,s.value,s.normal)}}showCurveLength(t,e){if(!this.world)throw new Error("A world is needed for this component to work!");const i=this.components.get(Jr),s=t.length,n=`${e.toFixed(2)} m`,o=Math.round(s/2),a=t[o],c=i.create(this.world,n,a,!0);c!==void 0&&this.save(c,"Radius")}showLineLength(t,e){if(!this.world)throw new Error("A world is needed for this component to work!");const i=this.components.get(Jr),s=new M;s.x=t.geometry.getAttribute("position").getX(0),s.y=t.geometry.getAttribute("position").getY(0),s.z=t.geometry.getAttribute("position").getZ(0);const n=new M;n.x=t.geometry.getAttribute("position").getX(1),n.y=t.geometry.getAttribute("position").getY(1),n.z=t.geometry.getAttribute("position").getZ(1);const o=`${e.toFixed(2)} m`,a=new M;a.addVectors(s,n).multiplyScalar(.5);const c=i.create(this.world,o,a,!0);c!==void 0&&this.save(c,"Radius")}showCurveRadius(t,e){if(!this.world)throw new Error("A world is needed for this component to work!");const i=this.components.get(Jr),s=new M;s.x=t.geometry.getAttribute("position").getX(0),s.y=t.geometry.getAttribute("position").getY(0),s.z=t.geometry.getAttribute("position").getZ(0);const n=new M;n.x=t.geometry.getAttribute("position").getX(1),n.y=t.geometry.getAttribute("position").getY(1),n.z=t.geometry.getAttribute("position").getZ(1);const o=`R = ${e.toFixed(2)} m`,a=new M;a.addVectors(s,n).multiplyScalar(.5);const c=i.create(this.world,o,a,!0);c!==void 0&&this.save(c,"Radius")}deleteByType(t=K5){const e=this.components.get(Jr);for(const i of t){const s=this._list.get(i);if(s){for(const n of s)e.delete(n);this._list.delete(i)}}}generateStartAndEndKP(t){const{alignment:e}=t.curve,i=new Map;for(const s of e.horizontal){const n=s.getLength();if(i.size>0){const o=s.index-1,a=i.get(o).distance+n,c=s.mesh.geometry.getAttribute("position"),l=c.count-1,h=new M;h.x=c.getX(l),h.y=c.getY(l),h.z=c.getZ(l);const u=this.createNormalLine(s.mesh);i.set(s.index,{value:this.getShortendKPValue(a),distance:a,point:h,normal:u})}else{const o=s.mesh.geometry.getAttribute("position"),a=o.count-1,c=new M;c.x=o.getX(a),c.y=o.getY(a),c.z=o.getZ(a);const l=this.createNormalLine(s.mesh);i.set(s.index,{value:this.getShortendKPValue(n),distance:n,point:c,normal:l})}}return i}createNormalLine(t){const e=t.geometry.attributes.position.count-1,i=e-1,s=new M;s.x=t.geometry.attributes.position.getX(e),s.y=t.geometry.attributes.position.getY(e),s.z=t.geometry.attributes.position.getZ(e);const n=new M;n.x=t.geometry.attributes.position.getX(i),n.y=t.geometry.attributes.position.getY(i),n.z=t.geometry.attributes.position.getZ(i);const o=new M().subVectors(s,n).clone().applyAxisAngle(new M(0,0,1),Math.PI*.5).normalize(),a=new Ut().setFromPoints([o.clone().setLength(10).add(s),o.clone().setLength(-10).add(s)]);return new Qt(a)}generateConstantKP(t){const{alignment:e}=t.curve,i=new Map,s=e.getLength("horizontal"),n=Math.floor(s/this.divisionLength);for(let o=0;o<n;o++){const a=o/n,c=e.getPointAt(a,"horizontal"),l=s*a,h=this.getNormal(e,c);i.set(o,{value:this.getShortendKPValue(l),distance:l,point:c,normal:h})}return i}getNormal(t,e){const i=[],s={start:new M,end:new M};for(let a=0;a<t.horizontal.length;a++){const c=t.horizontal[a].mesh.geometry.attributes.position,l=c.count;for(let h=0;h<l;h++){const u=c.getX(h),d=c.getY(h),f=c.getZ(h);i.push(new M(u,d,f))}}for(let a=0;a<i.length-1;a++){const c=i[a],l=i[a+1],h=c.distanceTo(e),u=l.distanceTo(e),d=c.distanceTo(l);Math.abs(h+u-d)<1e-5&&(s.start=c,s.end=l)}const n=new M().subVectors(s.end,s.start).clone().applyAxisAngle(new M(0,0,1),Math.PI*.5).normalize(),o=new Ut().setFromPoints([n.clone().setLength(10).add(e),n.clone().setLength(-10).add(e)]);return new Qt(o,new xi({color:16711680}))}getShortendKPValue(t){const e=t.toFixed(2),[i,s]=e.toString().split("."),n=s||"00";if(parseInt(i,10)>1e3&&parseInt(i,10)<1e4){const[o,...a]=i;return`${o}+${a.join("")}.${n}`}if(parseInt(i,10)>1e4){const[o,a,...c]=i;return`${o}${a}+${c.join("")}.${n}`}return`0+${i.padStart(3,"0")}.${n}`}save(t,e){this._list.has(e)||this._list.set(e,new Set),this._list.get(e).add(t)}};B(FS,"uuid","0af12c32-81ee-4100-a030-e9ae546f6170");let uh=FS,xS=class extends xt{constructor(t){super(t),B(this,"onHighlight",new nt),B(this,"onMarkerChange",new nt),B(this,"onMarkerHidden",new nt),B(this,"onDisposed",new nt),B(this,"enabled",!0),B(this,"mouseMarkers"),B(this,"_curves",[]),B(this,"_previousAlignment",null),B(this,"_highlighter"),B(this,"_world",null),B(this,"updateLinesResolution",e=>{var i;(i=this._highlighter)==null||i.setResolution(e)}),B(this,"onMouseMove",e=>{var i,s,n;if(!this._world)throw new Error("No world was given for this navigator!");if(!this._world.renderer)return;const o=this._world.renderer.three.domElement.parentElement,a=this._world.camera.three,c=(i=this._highlighter)==null?void 0:i.castRay(e,a,o,this._curves);if(c){const{object:l}=c;(s=this._highlighter)==null||s.hover(l),this.updateMarker(c,"hover");return}this.mouseMarkers&&(this.mouseMarkers.hover.visible=!1),(n=this._highlighter)==null||n.unHover(),this.onMarkerHidden.trigger({type:"hover"})}),B(this,"onClick",e=>{var i,s;if(!this._world)throw new Error("No world was given for this navigator!");if(!this._world.renderer)return;const n=this._world.renderer.three.domElement.parentElement,o=this._world.camera.three,a=(i=this._highlighter)==null?void 0:i.castRay(e,o,n,this._curves);if(a){const c=a,l=c.object;if((s=this._highlighter)==null||s.select(l),this.updateMarker(c,"select"),this._world.camera.hasCameraControls()&&(l.geometry.boundingBox||l.geometry.computeBoundingBox(),l.geometry.boundingBox)){const h=this.getScaledBox(l.geometry.boundingBox,2);this._world.camera.controls.fitToBox(h,!0)}this.onHighlight.trigger({mesh:l,point:c.point}),this._previousAlignment!==l.curve.alignment&&(this.components.get(uh).showKPStations(l),this._previousAlignment=l.curve.alignment)}}),B(this,"onControlsUpdated",()=>{if(!this._world)throw new Error("No world was given for this navigator!");if(!(this._world.camera.three instanceof cs)||!this._highlighter)return;const{zoom:e,left:i,right:s,top:n,bottom:o}=this._world.camera.three,a=i-s,c=n-o,l=Math.max(a,c)/e,h=40,{caster:u}=this._highlighter;u.params.Line.threshold=l/h})}get highlighter(){if(!this._highlighter)throw new Error("Highlighter not initialized. You must set a world first!");return this._highlighter}get world(){return this._world}set world(t){var e,i,s;if(t===this._world||(this._world&&this.setupEvents(!1),this._world=t,(e=this._highlighter)==null||e.dispose(),(i=this.mouseMarkers)==null||i.hover.dispose(),(s=this.mouseMarkers)==null||s.select.dispose(),!t))return;const n=t.scene.three;this._highlighter=new mS(n,this.view),this.mouseMarkers={select:this.newMouseMarker("#ffffff",t),hover:this.newMouseMarker("#575757",t)},this.setupEvents(!0)}async draw(t,e){if(!t.civilData)throw new Error("The provided model doesn't have civil data!");if(!this._world)throw new Error("No world was given for this navigator!");const{alignments:i}=t.civilData,s=e||i.values(),n=this._world.scene.three,o=new vt;o.makeEmpty(),o.min.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),o.max.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(const c of s){if(!c)throw new Error("Alignment not found!");for(const l of c[this.view])if(n.add(l.mesh),this._curves.push(l.mesh),!o.isEmpty())o.expandByObject(l.mesh);else{l.mesh.geometry.computeBoundingBox();const h=l.mesh.geometry.boundingBox;h instanceof vt&&o.copy(h).applyMatrix4(l.mesh.matrixWorld)}}const a=this.getScaledBox(o,1.2);this._world.camera.hasCameraControls()&&await this._world.camera.controls.fitToBox(a,!1)}async dispose(){var t;(t=this._highlighter)==null||t.dispose(),this.clear(),this.onHighlight.reset(),this._curves=[],this.onDisposed.trigger(),this.onDisposed.reset()}clear(){var t,e;(t=this._highlighter)==null||t.unSelect(),(e=this._highlighter)==null||e.unHover();for(const i of this._curves)i.removeFromParent();this._curves=[]}setMarker(t,e,i){if(!this._curves.length)return;const s=t.getCurveAt(e,this.view),n=t.getPointAt(e,this.view),{index:o}=s.curve.getSegmentAt(s.percentage);this.setMouseMarker(n,s.curve.mesh,o,i)}setDefSegments(t){const e=[],i=[],s=(n,o)=>{const a=o[1]-n[1],c=o[0]-n[0];return a/c};for(let n=0;n<t.length;n++){const o=t[n];let a,c,l,h;for(let d=0;d<Object.keys(o).length/3;d++)if(o[d*3]!==void 0&&o[d*3+1]!==void 0){a=o[d*3],c=o[d*3+1];break}for(let d=Object.keys(o).length/3-1;d>=0;d--)if(o[d*3]!==void 0&&o[d*3+1]!==void 0){l=o[d*3],h=o[d*3+1];break}const u=(s([a,c],[l,h])*100).toFixed(2);i.push({slope:u})}for(const n of t)for(let o=0;o<n.length-3;o+=3){const a=n[o],c=n[o+1],l=n[o+2],h=n[o+3],u=n[o+4],d=n[o+5];e.push({start:new M(a,c,l),end:new M(h,u,d)})}return{defSegments:e,slope:i}}hideMarker(t){this.mouseMarkers&&(this.mouseMarkers[t].visible=!1)}setupEvents(t){var e,i;if(!this._world)throw new Error("No world was given for this navigator!");if(this._world.isDisposing||!this._world.renderer)return;const s=this._world.renderer.three.domElement.parentElement;(e=this._world.renderer)==null||e.onResize.remove(this.updateLinesResolution),s.removeEventListener("pointermove",this.onMouseMove),s.removeEventListener("click",this.onClick),this._world.camera.hasCameraControls()&&this._world.camera.controls.removeEventListener("update",this.onControlsUpdated),t&&(s.addEventListener("pointermove",this.onMouseMove),s.addEventListener("click",this.onClick),(i=this._world.renderer)==null||i.onResize.add(this.updateLinesResolution),this._world.camera.hasCameraControls()&&this._world.camera.controls.addEventListener("update",this.onControlsUpdated))}newMouseMarker(t,e){if(!this._world)throw new Error("No world was given for this navigator!");const i=e.scene.three,s=document.createElement("div"),n=document.createElement("div");s.appendChild(n),n.style.backgroundColor=t,n.style.width="3rem",n.style.height="3px";const o=new mi(this._world,s,i);return o.visible=!1,o}setMouseMarker(t,e,i,s){if(i===void 0||!this.mouseMarkers)return;this.mouseMarkers[s].visible=!0;const n=this.mouseMarkers[s].three;n.position.copy(t);const o=e,{startPoint:a,endPoint:c}=o.curve.getSegment(i),l=Math.atan2(c.y-a.y,c.x-a.x),h=n.element.children[0],u=90-l/Math.PI*180;h.style.transform=`rotate(${u}deg)`}updateMarker(t,e){const{point:i,index:s,object:n}=t,o=n,a=o.curve,c=o.curve.alignment,l=c.getPercentageAt(i,this.view),h=i.clone();this.setMouseMarker(h,o,s,e),l!==null&&this.onMarkerChange.trigger({alignment:c,percentage:l,type:e,curve:a})}getScaledBox(t,e){const i=new vt,s=new M,n=new M;return t.getCenter(n),t.getSize(s),s.multiplyScalar(e),i.setFromCenterAndSize(n,s),i}},J5=class{constructor(t,e,i){B(this,"components"),B(this,"_scene"),B(this,"_world"),B(this,"offset",10),B(this,"markupLines",[]),B(this,"currentCurveMesh"),B(this,"markupMaterial",new xi({color:6842472})),this.components=t,this._scene=e,this._world=i}showCurveInfo(t){switch(this.disposeMarkups(),this.currentCurveMesh=t,t.curve.data.TYPE){case"LINE":this.showLineInfo(t,this.offset);break;case"CIRCULARARC":this.showCircularArcInfo(t,this.offset);break;case"CLOTHOID":this.showClothoidInfo(t,this.offset);break;default:console.log("Unknown curve type:",t.curve.data.TYPE);break}}updateOffset(t,e,i){const s=Math.max(t.height,t.width)/(e*150);s!==this.offset&&(this.offset=s,i&&this.currentCurveMesh&&this.showCurveInfo(this.currentCurveMesh))}dispose(){for(const t of this.markupLines)t.removeFromParent();this.disposeMarkups(),this.markupMaterial.dispose()}disposeMarkups(){for(const t of this.markupLines)t.geometry.dispose(),t.removeFromParent();this.markupLines=[]}unSelect(){this.disposeMarkups()}calculateTangent(t,e){const i=e*3,s=Math.max(0,i-3),n=Math.min(t.length-3,i+3),o=new M().fromArray(t,s);return new M().fromArray(t,n).clone().sub(o).normalize()}calculateParallelCurve(t,e,i){const s=[];for(let n=0;n<e;n++){const o=this.calculateTangent(t,n).clone().applyAxisAngle(new M(0,0,1),Math.PI/2);o.normalize();const a=o.clone().multiplyScalar(i),c=n*3,l=new M().fromArray(t,c).add(a);s.push(l)}return s}calculateDimensionLines(t,e){const i=[],s=t.geometry.attributes.position.array,n=e.geometry.attributes.position.array;if(s.length<6&&n.length<6)throw new Error("Line must have at least two vertices");const o=new M(s[0],s[1],s[2]),a=new M(n[0],n[1],n[2]),c=[],l=s.length-3,h=new M(s[l],s[l+1],s[l+2]),u=n.length-3,d=new M(n[u],n[u+1],n[u+2]);return i.push(o,a),c.push(h,d),{startDimensionPoints:i,endDimensionPoints:c}}offsetDimensionLine(t,e){const i=new M().copy(t[t.length-1]).sub(t[0]).normalize().clone().multiplyScalar(e);return t.map(s=>s.clone().add(i))}showLineInfo(t,e){const i=this.components.get(uh);i.world=this._world,i.deleteByType(["Length","Radius"]);const s=t.geometry.attributes.position.array,n=this.calculateParallelCurve(s,s.length/3,e),o=new Ut().setFromPoints(n),a=new Qt(o,this.markupMaterial);i.showLineLength(a,t.curve.getLength()),this._scene.add(a),this.markupLines.push(a);const{startDimensionPoints:c,endDimensionPoints:l}=this.calculateDimensionLines(t,a),h=this.offsetDimensionLine(c,e*.1),u=this.offsetDimensionLine(l,e*.1),d=new Ut().setFromPoints(h),f=new Ut().setFromPoints(u),p=new Qt(d,this.markupMaterial);this._scene.add(p),this.markupLines.push(p);const m=new Qt(f,this.markupMaterial);this._scene.add(m),this.markupLines.push(m)}showClothoidInfo(t,e){const i=this.components.get(uh);i.world=this._world,i.deleteByType(["Length","Radius"]);const s=t.geometry.attributes.position.array,n=this.calculateParallelCurve(s,s.length/3,e),o=new Ut().setFromPoints(n);i.showCurveLength(n,t.curve.getLength());const a=new Qt(o,this.markupMaterial);this._scene.add(a),this.markupLines.push(a);const{startDimensionPoints:c,endDimensionPoints:l}=this.calculateDimensionLines(t,a),h=this.offsetDimensionLine(c,e*.1),u=this.offsetDimensionLine(l,e*.1),d=new Ut().setFromPoints(h),f=new Ut().setFromPoints(u),p=new Qt(d,this.markupMaterial);this._scene.add(p),this.markupLines.push(p);const m=new Qt(f,this.markupMaterial);this._scene.add(m),this.markupLines.push(m)}showCircularArcInfo(t,e){const i=this.components.get(uh);i.world=this._world,i.deleteByType(["Length","Radius"]);const s=t.curve.data.RADIUS,n=t.geometry.attributes.position.array,o=t.geometry.attributes.position.count,a=[],c=new M(n[0],n[1],n[2]),l=(o-1)*3,h=new M(n[l],n[l+1],n[l+2]),u=o/2*3,d=new M(n[u],n[u+1],n[u+2]),f=h.clone().sub(c).normalize(),p=new M(-f.y,f.x,0);p.multiplyScalar(s);const m=d.clone().add(p);a.push(d),a.push(m);const g=new Ut().setFromPoints(a),I=new Qt(g,this.markupMaterial);i.showCurveRadius(I,Math.abs(s)),this._scene.add(I),this.markupLines.push(I);const C=[];for(let O=0;O<o;O++){const y=this.calculateTangent(n,O),U=t.curve.data.RADIUS,H=new M(y.y,-y.x,0);H.normalize(),U<0&&H.negate();const k=H.clone().multiplyScalar(e),X=O*3,$=new M(n[X]+k.x,n[X+1]+k.y,n[X+2]+k.z);C.push($)}const b=new Ut().setFromPoints(C);i.showCurveLength(C,t.curve.getLength());const E=new Qt(b,this.markupMaterial);this._scene.add(E),this.markupLines.push(E);const{startDimensionPoints:T,endDimensionPoints:A}=this.calculateDimensionLines(t,E),S=this.offsetDimensionLine(T,e*.1),_=this.offsetDimensionLine(A,e*.1),w=new Ut().setFromPoints(S),F=new Ut().setFromPoints(_),D=new Qt(w,this.markupMaterial);this._scene.add(D),this.markupLines.push(D);const R=new Qt(F,this.markupMaterial);this._scene.add(R),this.markupLines.push(R)}};const t6=class NS extends xS{constructor(t){super(t),B(this,"view","horizontal"),B(this,"planHighlighter"),this.components.add(NS.uuid,this),this.onHighlight.add(({mesh:e})=>{!this._highlighter||!this.planHighlighter||this.planHighlighter.showCurveInfo(e)})}get world(){return super.world}set world(t){var e;super.world=t,t&&((e=this.planHighlighter)==null||e.dispose(),this.planHighlighter=new J5(this.components,t.scene.three,t))}};B(t6,"uuid","3096dea0-5bc2-41c7-abce-9089b6c9431b");const e6=class PS extends xS{constructor(t){super(t),B(this,"enabled",!0),B(this,"view","vertical"),this.components.add(PS.uuid,this)}get world(){return super.world}set world(t){this.world!==t&&(super.world=t,this._highlighter&&this._highlighter.onSelect.add(e=>{if(!this.world)throw new Error("A world is needed to work with this component!");const i=this.components.get(uh);i.deleteByType(["Slope","Height","InitialKPV","FinalKPV"]);const{alignment:s}=e.curve,n=[];for(const l of s.vertical){const h=l.mesh.geometry.attributes.position.array;n.push(h)}const{defSegments:o,slope:a}=this.setDefSegments(n),c=this.world.scene.three;for(let l=0;l<s.vertical.length;l++){const h=s.vertical[l];i.addVerticalMarker(this.world,`S: ${a[l].slope}%`,h.mesh,"Slope",c),i.addVerticalMarker(this.world,`H: ${o[l].end.y.toFixed(2)}`,h.mesh,"Height",c)}i.addVerticalMarker(this.world,"KP: 0",s.vertical[0].mesh,"InitialKPV",c),i.addVerticalMarker(this.world,`KP: ${s.vertical.length}`,s.vertical[s.vertical.length-1].mesh,"FinalKPV",c)}))}};B(e6,"uuid","097eea29-2d5a-431a-a247-204d44670621");const i6=class LS extends xt{constructor(t){super(t),B(this,"onHighlight",new nt),B(this,"onMarkerChange",new nt),B(this,"onMarkerHidden",new nt),B(this,"enabled",!0),B(this,"mouseMarkers"),B(this,"_highlighter"),B(this,"_curves",[]),B(this,"_world",null),B(this,"updateLinesResolution",e=>{var i;(i=this.highlighter)==null||i.setResolution(e)}),B(this,"onClick",e=>{if(!this.enabled||!this._highlighter)return;if(!this.world)throw new Error("No world found!");if(!this.world.renderer)return;const i=this.world.renderer.three.domElement,s=this.world.camera.three,n=this._highlighter.castRay(e,s,i,this._curves);if(n){const o=n.object;this._highlighter.select(o),this.updateMarker(n,"select");const{point:a,index:c}=n;c!==void 0&&this.onHighlight.trigger({curve:o,point:a,index:c});return}this._highlighter.unSelect(),this.mouseMarkers&&(this.mouseMarkers.hover.visible=!1),this.onMarkerHidden.trigger({type:"hover"})}),B(this,"onMouseMove",async e=>{if(!this.enabled||!this._highlighter)return;if(!this.world)throw new Error("No world found!");if(!this.world.renderer)return;const i=this.world.renderer.three.domElement,s=this.world.camera.three,n=this._highlighter.castRay(e,s,i,this._curves);if(n){this._highlighter.hover(n.object),this.updateMarker(n,"hover");return}this._highlighter.unHover()}),this.components.add(LS.uuid,this)}get world(){return this._world}set world(t){var e,i,s;if(t===this._world||(this._world&&this.setupEvents(!1),this._world=t,(e=this._highlighter)==null||e.dispose(),(i=this.mouseMarkers)==null||i.hover.dispose(),(s=this.mouseMarkers)==null||s.select.dispose(),!t))return;const n=t.scene.three;this._highlighter=new mS(n,"absolute"),this.mouseMarkers={select:this.newMouseMarker("#ffffff",t),hover:this.newMouseMarker("#575757",t)},this.setupEvents(!0)}get highlighter(){if(!this._highlighter)throw new Error("Navigator not initialized!");return this._highlighter}draw(t){if(!t.civilData)throw new Error("Model must have civil data!");if(!this.world)throw new Error("A world must be given before drawing an alignment!");const e=this.world.scene.three;for(const[i,s]of t.civilData.alignments)for(const{mesh:n}of s.absolute)e.add(n),this._curves.push(n)}setMarker(t,e,i){if(!this.mouseMarkers)throw new Error("No mouse markers found! Initialize the world before using this.");const s=t.getPointAt(e,"absolute");this.mouseMarkers[i].visible=!0,this.mouseMarkers[i].three.position.copy(s)}hideMarker(t){if(!this.mouseMarkers)throw new Error("No mouse markers found! Initialize the world before using this.");const e=this.mouseMarkers[t].three;e.visible=!1}newMouseMarker(t,e){const i=e.scene.three,s=document.createElement("div");s.style.backgroundColor=t,s.style.width="1rem",s.style.height="1rem",s.style.borderRadius="1rem";const n=new mi(e,s,i);return n.visible=!1,n}setupEvents(t){var e,i;if(!this.world)throw new Error("No world found!");if(this.world.isDisposing||!this.world.renderer)return;const s=this.world.renderer.three.domElement;(e=this.world.renderer)==null||e.onResize.remove(this.updateLinesResolution),s.removeEventListener("click",this.onClick),s.removeEventListener("pointermove",this.onMouseMove),t&&(s.addEventListener("click",this.onClick),s.addEventListener("pointermove",this.onMouseMove),(i=this.world.renderer)==null||i.onResize.add(this.updateLinesResolution))}updateMarker(t,e){if(!this.mouseMarkers)return;const{point:i,object:s}=t,n=s,o=n.curve,a=n.curve.alignment,c=a.getPercentageAt(i,"absolute");this.mouseMarkers[e].visible=!0,this.mouseMarkers[e].three.position.copy(i),c!==null&&this.onMarkerChange.trigger({alignment:a,percentage:c,type:e,curve:o})}};B(i6,"uuid","0a59c09e-2b49-474a-9320-99f51f40f182");const s6=class MS extends xt{constructor(t){super(t),B(this,"enabled",!0),B(this,"world",null),B(this,"plane"),B(this,"_world3D",null),this.components.add(MS.uuid,this)}get world3D(){return this._world3D}set world3D(t){var e;if(this._world3D=t,(e=this.plane)==null||e.dispose(),!t)return;const i=this.components.get(cc),s=i.Type;i.Type=xf,this.plane=i.createFromNormalAndCoplanarPoint(t,new M(1,0,0),new M),i.Type=s,this.plane.visible=!1,this.plane.enabled=!1}async set(t,e){if(!this.world||!this.plane)throw new Error("You must set a world before using this component");this.plane.enabled=!0;const i=t.curve.getPercentageAt(e);if(i===null)return;const{startPoint:s,endPoint:n}=t.curve.getSegmentAt(i);if(t.geometry.index===null)throw new Error("Geometry must be indexed!");const o=new M;o.subVectors(n,s),o.normalize(),this.plane.setFromNormalAndCoplanarPoint(o,e),this.plane.edges.update();const a=this.plane.helper.matrix.clone();a.invert();const c=this.world.scene.three,l=this.plane.edges.get();for(const h in l){const{mesh:u}=l[h];u.position.set(0,0,0),u.rotation.set(0,0,0),u.updateMatrix(),u.applyMatrix4(a),u.parent!==c&&c.add(u)}this.plane.enabled=!1}};B(s6,"uuid","96b2c87e-d90b-4639-8257-8f01136fe324");function wr(){const r=document.createElement("div");return r.style.backgroundColor="black",r.style.color="white",r.style.padding="8px",r.style.borderRadius="8px",r.style.fontFamily="sans-serif",r}const af=class cf{constructor(t,e,i){B(this,"label"),B(this,"boundingBox",new it),B(this,"world"),B(this,"components"),B(this,"_length"),B(this,"_visible",!0),B(this,"_start"),B(this,"_end"),B(this,"_root",new vo),B(this,"_endpoints",[]),B(this,"_line"),this.components=t,this.world=e,this._start=i.start,this._end=i.end,this._length=this.getLength(),this._line=this.createLine(i),this.newEndpointElement(i.endpointElement),this.newEndpointElement(i.endpointElement.cloneNode(!0)),this.label=this.newText(),this._root.renderOrder=2,this.world.scene.three.add(this._root)}get visible(){return this._visible}set visible(t){this._visible=t,this.label.visible=t,this._endpoints[0].visible=t,this._endpoints[1].visible=t;const[e,i]=this._endpoints,s=e.three,n=i.three,o=this.label.three;t?(this.world.scene.three.add(this._root),this._root.add(o,s,n)):(o.removeFromParent(),s.removeFromParent(),n.removeFromParent(),this._root.removeFromParent())}get endPoint(){return this._end}set endPoint(t){this._end=t;const e=this._line.geometry.attributes.position;e.setXYZ(1,t.x,t.y,t.z),e.needsUpdate=!0,this._endpoints[1].three.position.copy(t),this.updateLabel()}get startPoint(){return this._start}set startPoint(t){this._start=t;const e=this._line.geometry.attributes.position;e.setXYZ(0,t.x,t.y,t.z),e.needsUpdate=!0,this._endpoints[0].three.position.copy(t),this.updateLabel()}get _center(){let t=this._end.clone().sub(this._start);const e=t.length()*.5;return t=t.normalize().multiplyScalar(e),this._start.clone().add(t)}dispose(){const t=this.components.get(en);this.visible=!1,t.destroy(this._root),t.destroy(this._line);for(const e of this._endpoints)e.dispose();this._endpoints.length=0,this.label.dispose(),this.boundingBox&&t.destroy(this.boundingBox),this.components=null}createBoundingBox(){this.boundingBox.geometry=new kt(1,1,this._length),this.boundingBox.position.copy(this._center),this.boundingBox.lookAt(this._end),this.boundingBox.visible=!1,this._root.add(this.boundingBox)}toggleLabel(){this.label.toggleVisibility()}newEndpointElement(t){const e=this._endpoints.length===0?this._start:this._end,i=new mi(this.world,t);i.three.position.copy(e),this._endpoints.push(i),this._root.add(i.three)}updateLabel(){this._length=this.getLength(),this.label.three.element.textContent=this.getTextContent(),this.label.three.position.copy(this._center),this._line.computeLineDistances()}createLine(t){const e=new Ut;e.setFromPoints([t.start,t.end]);const i=new Qt(e,t.lineMaterial);return this._root.add(i),i}newText(){const t=wr();t.textContent=this.getTextContent();const e=new mi(this.world,t);return e.three.position.copy(this._center),this._root.add(e.three),e}getTextContent(){return`${(this._length/cf.scale).toFixed(cf.rounding)} ${cf.units}`}getLength(){return this._start.distanceTo(this._end)}};B(af,"scale",1),B(af,"units","m"),B(af,"rounding",2);let KE=af,n6=class{constructor(t,e,i){B(this,"enabled",!0),B(this,"points",[]),B(this,"workingPlane",null),B(this,"labelMarker"),B(this,"world"),B(this,"components"),B(this,"onDisposed",new nt),B(this,"onAreaComputed",new nt),B(this,"onWorkingPlaneComputed",new nt),B(this,"onPointAdded",new nt),B(this,"onPointRemoved",new nt),B(this,"_visible",!0),B(this,"_rotationMatrix",null),B(this,"_dimensionLines",[]),B(this,"_defaultLineMaterial",new xi({color:"red"})),this.world=e,this.components=t;const s=wr();this.labelMarker=new mi(e,s),this.labelMarker.visible=!1,this.onPointAdded.add(n=>{this.points.length===3&&!this._dimensionLines[2]&&(this.addDimensionLine(n,this.points[0]),this.labelMarker.visible=!0)}),i?.forEach(n=>this.setPoint(n))}get visible(){return this._visible}set visible(t){this._visible=t;for(const e of this._dimensionLines)e.visible=t,e.label.visible=!1;this.labelMarker.visible=t}setPoint(t,e){let i;if(e?i=e:i=this.points.length===0?0:this.points.length,i===0){this.points[0]=t;return}if(i<0||i>this.points.length)return;const s=this.points.length>i;this.points[i]=t,this.onPointAdded.trigger(t),s||this.addDimensionLine(this.points[i-1],t);const{previousLine:n,nextLine:o}=this.getLinesBetweenIndex(i);n&&(n.endPoint=t),o&&(o.startPoint=t)}removePoint(t){if(this.points.length===3)return;this.points.splice(t,1);const{previousLine:e,nextLine:i}=this.getLinesBetweenIndex(t);i&&(e.endPoint=i.endPoint),i?.dispose(),this._dimensionLines.splice(t,1),this.onPointRemoved.trigger()}toggleLabel(){this.labelMarker.toggleVisibility()}addDimensionLine(t,e){const i=new KE(this.components,this.world,{start:t,end:e,lineMaterial:this._defaultLineMaterial,endpointElement:wr()});return i.toggleLabel(),this._dimensionLines.length>1?this._dimensionLines.splice(this._dimensionLines.length-1,0,i):this._dimensionLines.push(i),i}getLinesBetweenIndex(t){const e=t===0?this._dimensionLines.length-1:t-1,i=this._dimensionLines[e],s=this._dimensionLines[t];return{previousLine:i,nextLine:s}}computeWorkingPlane(){this.workingPlane=new Qe().setFromCoplanarPoints(this.points[0],this.points[1],this.points[2]);const t=new M(0,1,0),e=this.workingPlane.normal.angleTo(t),i=new M().crossVectors(this.workingPlane.normal,t).normalize();this._rotationMatrix=new ht().makeRotationAxis(i,e),this.onWorkingPlaneComputed.trigger(this.workingPlane)}computeArea(){if(!(this._rotationMatrix&&this.workingPlane))return this.onAreaComputed.trigger(0),0;let t=0,e=0;const i=this._rotationMatrix,s=this.points.map(o=>{const a=o.clone().applyMatrix4(i),c=new Ot(a.x,a.z);return t+=c.x,e+=c.y,c}),n=Math.abs(Z_.area(s));return this.labelMarker.three.element.textContent=`${n.toFixed(2)} m`,this.labelMarker.three.position.set(t/s.length,-this.workingPlane.constant,e/s.length).applyMatrix4(i.clone().invert()),this.onAreaComputed.trigger(n),n}dispose(){this.onAreaComputed.reset(),this.onWorkingPlaneComputed.reset(),this.onPointAdded.reset(),this.onPointRemoved.reset();for(const t of this._dimensionLines)t.dispose();this.labelMarker.dispose(),this._dimensionLines=[],this.points=[],this._rotationMatrix=null,this.workingPlane=null,this._defaultLineMaterial.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}get(){return{points:this.points,workingPlane:this.workingPlane,area:this.computeArea()}}},JE=class extends j3{constructor(t,e){super(t,e),B(this,"onDisposed",new nt),B(this,"marker",null),B(this,"_className","default-vertex-picker"),this.onEnabled.add(i=>{this.marker&&(this.marker.visible=i)})}get className(){return this._className}set className(t){this._className=t,this.marker&&(this.marker.three.element.className=t)}dispose(){this.marker&&this.marker.dispose(),super.dispose()}get(t){const e=super.get(t);return e?(this.marker||(this.marker=new mi(t),this.marker.three.element.className=this._className),this.marker.world!==t&&(this.marker.world=t,this.marker.three.removeFromParent(),t.scene.three.add(this.marker.three)),this.marker.visible=!0,this.marker.three.position.copy(e)):this.marker&&(this.marker.visible=!1),e}};const r6=class _g extends xt{constructor(t){super(t),B(this,"onDisposed",new nt),B(this,"list",[]),B(this,"world"),B(this,"_enabled",!1),B(this,"_visible",!0),B(this,"_vertexPicker"),B(this,"_currentAreaElement",null),B(this,"_clickCount",0),B(this,"create",()=>{if(!this.enabled)return;if(!this.world)throw new Error("World not defined for the area measurement!");const e=this._vertexPicker.get(this.world);if(e){if(!this._currentAreaElement){const i=new n6(this.components,this.world);i.onPointAdded.add(()=>{this._clickCount===2&&!i.workingPlane&&(i.computeWorkingPlane(),this._vertexPicker.workingPlane=i.workingPlane)}),i.onPointRemoved.add(()=>this._clickCount--),this._currentAreaElement=i}this._currentAreaElement.setPoint(e,this._clickCount),this._currentAreaElement.computeArea(),this._clickCount++}}),B(this,"onMouseMove",()=>{if(!this.world){console.log("No world given for the area measurement!");return}const e=this._vertexPicker.get(this.world);e&&this._currentAreaElement&&(this._currentAreaElement.setPoint(e,this._clickCount),this._currentAreaElement.computeArea())}),B(this,"onKeydown",e=>{this.enabled&&(e.key==="z"&&e.ctrlKey&&this._currentAreaElement&&this._currentAreaElement.removePoint(this._clickCount-1),e.key==="Enter"&&this._currentAreaElement&&this.endCreation(),e.key==="Escape"&&(this._clickCount===0&&!this._currentAreaElement?this.enabled=!1:this.cancelCreation()))}),this.components.add(_g.uuid,this),this._vertexPicker=new JE(t)}set enabled(t){this._enabled=t,this._vertexPicker.enabled=t,this.setupEvents(t),t||this.cancelCreation()}get enabled(){return this._enabled}set workingPlane(t){this._vertexPicker.workingPlane=t}get workingPlane(){return this._vertexPicker.workingPlane}get visible(){return this._visible}set visible(t){this._visible=t;for(const e of this.list)e.visible=t}dispose(){this.setupEvents(!1),this._vertexPicker.dispose(),this._currentAreaElement&&this._currentAreaElement.dispose();for(const t of this.list)t.dispose();this.components=null,this.onDisposed.trigger(_g.uuid),this.onDisposed.reset()}delete(){}deleteAll(){for(const t of this.list)t.dispose();this.list=[]}endCreation(){this._currentAreaElement&&(this._currentAreaElement.points.length<3||(this._currentAreaElement&&(this.list.push(this._currentAreaElement),this._currentAreaElement.removePoint(this._clickCount),this._currentAreaElement.computeWorkingPlane(),this._currentAreaElement.computeArea(),this._currentAreaElement=null),this._vertexPicker.workingPlane=null,this._clickCount=0))}cancelCreation(){this._currentAreaElement&&(this._currentAreaElement.dispose(),this._currentAreaElement=null),this._vertexPicker.workingPlane=null,this._clickCount=0}setupEvents(t){if(!this.world)throw new Error("The area measurement needs a world to work!");if(this.world.isDisposing)return;if(!this.world.renderer)throw new Error("The world of the area measurement needs a renderer!");const e=this.world.renderer.three.domElement.parentElement;t?(e.addEventListener("pointermove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown)):(e.removeEventListener("pointermove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown))}};B(r6,"uuid","c453a99e-f054-4781-9060-33df617db4a5");let o6=class{constructor(t,e){B(this,"enabled",!0),B(this,"visible",!0),B(this,"points",[]),B(this,"world"),B(this,"onDisposed",new nt),B(this,"_lineMaterial",new iu({color:6629591,linewidth:2})),B(this,"_lineGeometry",new Of),B(this,"_line",new dS(this._lineGeometry,this._lineMaterial)),B(this,"_labelMarker"),B(this,"onAngleComputed",new nt),B(this,"onPointAdded",new nt),this.world=t;const i=wr();this._labelMarker=new mi(t,i),this.labelMarker.visible=!0,this.onPointAdded.add(()=>{this.points.length===1&&t.scene.three.add(this._line),this.points.length===3&&(this.labelMarker.visible=!0)}),this.onAngleComputed.add(s=>{this.labelMarker.three.element.textContent=`${s.toFixed(2)}`,this.labelMarker.three.position.copy(this.points[1]??new M)}),e?.forEach(s=>this.setPoint(s))}set lineMaterial(t){this._lineMaterial.dispose(),this._lineMaterial=t,this._line.material=t,this._lineMaterial.resolution.set(window.innerWidth,window.innerHeight)}get lineMaterial(){return this._lineMaterial}set labelMarker(t){this._labelMarker.dispose(),this._labelMarker=t}get labelMarker(){return this._labelMarker}get angle(){return{points:this.points,angle:this.computeAngle()}}setPoint(t,e){let i;if(e?i=e:i=this.points.length===0?0:this.points.length,![0,1,2].includes(i))return;this.points[i]=t,this.onPointAdded.trigger(t);const s=this.points.map(n=>[n.x,n.y,n.z]);this._lineGeometry.setPositions(s.flat())}toggleLabel(){this.labelMarker.toggleVisibility()}computeAngle(){const t=this.points[0],e=this.points[1],i=this.points[2];if(!(t&&e&&i))return 0;const s=new M().subVectors(e,t),n=new M().subVectors(e,i),o=Ss.radToDeg(s.angleTo(n));return this.onAngleComputed.trigger(o),o}dispose(){this.points=[],this.labelMarker.dispose(),this.onAngleComputed.reset(),this.onPointAdded.reset(),this.labelMarker.dispose(),this._line.removeFromParent(),this._lineMaterial.dispose(),this._lineGeometry.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}};const a6=class Fg extends xt{constructor(t){super(t),B(this,"onDisposed",new nt),B(this,"world"),B(this,"list",[]),B(this,"_lineMaterial"),B(this,"_enabled",!1),B(this,"_vertexPicker"),B(this,"_currentAngleElement",null),B(this,"_clickCount",0),B(this,"create",()=>{if(!this.enabled)return;if(!this.world){console.log("No world selected for angle measurement!");return}const e=this._vertexPicker.get(this.world);if(e){if(!this._currentAngleElement){const i=new o6(this.world);i.lineMaterial=this.lineMaterial,this._currentAngleElement=i}this._currentAngleElement.setPoint(e,this._clickCount),this._currentAngleElement.setPoint(e,this._clickCount+1),this._currentAngleElement.setPoint(e,this._clickCount+2),this._currentAngleElement.computeAngle(),this._clickCount++,this._clickCount===3&&this.endCreation()}}),B(this,"onMouseMove",()=>{if(!this.world){console.log("No world selected for angle measurement!");return}const e=this._vertexPicker.get(this.world);e&&this._currentAngleElement&&(this._currentAngleElement.setPoint(e,this._clickCount),this._currentAngleElement.computeAngle())}),B(this,"onKeyDown",e=>{this.enabled&&e.key==="Escape"&&this.cancelCreation()}),this.components.add(Fg.uuid,this),this._vertexPicker=new JE(t),this._lineMaterial=new iu({color:6629591,linewidth:2})}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this.setupEvents(t),this._vertexPicker.enabled=t,t||this.cancelCreation()}get lineMaterial(){return this._lineMaterial}set lineMaterial(t){this._lineMaterial.dispose(),this._lineMaterial=t,this._lineMaterial.resolution.set(window.innerWidth,window.innerHeight)}get workingPlane(){return this._vertexPicker.workingPlane}set workingPlane(t){this._vertexPicker.workingPlane=t}dispose(){this.setupEvents(!1),this._lineMaterial.dispose(),this._vertexPicker.dispose();for(const t of this.list)t.dispose();this._currentAngleElement&&this._currentAngleElement.dispose(),this.components=null,this.onDisposed.trigger(Fg.uuid),this.onDisposed.reset()}delete(){}deleteAll(){for(const t of this.list)t.dispose();this.list=[]}endCreation(){this._currentAngleElement&&(this.list.push(this._currentAngleElement),this._currentAngleElement.computeAngle(),this._currentAngleElement=null),this._clickCount=0}cancelCreation(){this._currentAngleElement&&(this._currentAngleElement.dispose(),this._currentAngleElement=null),this._clickCount=0}setupEvents(t){if(!this.world)throw new Error("No world selected for angle measurement!");if(this.world.isDisposing)return;if(!this.world.renderer)throw new Error("The given world doesn't have a renderer!");const e=this.world.renderer.three.domElement.parentElement;t?(e.addEventListener("pointermove",this.onMouseMove),window.addEventListener("keydown",this.onKeyDown)):(e.removeEventListener("pointermove",this.onMouseMove),window.removeEventListener("keydown",this.onKeyDown))}};B(a6,"uuid","622fb2c9-528c-4b0a-8a0e-6a1375f0a3aa");const DS=class Og extends xt{constructor(t){super(t),B(this,"onDisposed",new nt),B(this,"onBeforeUpdate",new nt),B(this,"onAfterUpdate",new nt),B(this,"snapDistance",.25),B(this,"list",[]),B(this,"world"),B(this,"_vertexPicker"),B(this,"_lineMaterial",new xi({color:"#DC2626",linewidth:2,depthTest:!1})),B(this,"_visible",!0),B(this,"_enabled",!1),B(this,"_temp",{isDragging:!1,start:new M,end:new M,dimension:void 0}),B(this,"create",e=>{const i=e instanceof ws?e:void 0;if(this._enabled){if(!this._temp.isDragging){this.drawStart(i);return}this.endCreation()}}),B(this,"onMouseMove",()=>{this.world&&this._vertexPicker.get(this.world)}),B(this,"onKeydown",e=>{this.enabled&&e.key==="Escape"&&this.cancelCreation()}),this.components.add(Og.uuid,this),this._vertexPicker=new JE(t,{previewElement:wr(),snapDistance:this.snapDistance})}get enabled(){return this._enabled}set enabled(t){t||this.cancelCreation(),this._enabled=t,this._vertexPicker.enabled=t,this.setupEvents(t)}get visible(){return this._visible}set visible(t){this._visible=t;for(const e of this.list)e.visible=t}get color(){return this._lineMaterial.color}set color(t){this._lineMaterial.color=t}dispose(){this.setupEvents(!1),this.enabled=!1;for(const t of this.list)t.dispose();this._lineMaterial.dispose(),this.list=[],this._vertexPicker.dispose(),this.onDisposed.trigger(Og.uuid),this.onDisposed.reset()}async update(t){this._enabled&&this._temp.isDragging&&this.drawInProcess()}createOnPoints(t,e){const i=this.drawDimension();i.startPoint=t,i.endPoint=e,i.createBoundingBox(),this.list.push(i)}delete(){if(!this.world)throw new Error("World is needed for Length Measurement!");if(!this._enabled||this.list.length===0)return;const t=this.getBoundingBoxes(),e=this.components.get(es).get(this.world).castRay(t);if(!e)return;const i=this.list.find(s=>s.boundingBox===e.object);if(i){const s=this.list.indexOf(i);this.list.splice(s,1),i.dispose()}}async deleteMeasurement(t){if(t){const e=this.list.indexOf(t);this.list.splice(e,1),t.dispose()}}deleteAll(){for(const t of this.list)t.dispose();this.list=[]}cancelCreation(){var t;this._temp.dimension&&(this._temp.isDragging=!1,(t=this._temp.dimension)==null||t.dispose(),this._temp.dimension=void 0)}endCreation(){this._temp.dimension&&(this._temp.dimension.createBoundingBox(),this.list.push(this._temp.dimension),this._temp.dimension=void 0,this._temp.isDragging=!1)}drawStart(t){if(!this.world)throw new Error("The length measurement needs a world to work!");const e=t?[t]:void 0,i=this.components.get(es).get(this.world).castRay(e),s=this._vertexPicker.get(this.world);i&&s&&(this._temp.isDragging=!0,this._temp.start=t?i.point:s)}drawInProcess(){if(!this.world)throw new Error("The length measurement needs a world to work!");if(!this.components.get(es).get(this.world).castRay())return;const t=this._vertexPicker.get(this.world);t&&(this._temp.end=t,this._temp.dimension||(this._temp.dimension=this.drawDimension()),this._temp.dimension.endPoint=this._temp.end)}drawDimension(){if(!this.world)throw new Error("The length measurement needs a world to work!");return new KE(this.components,this.world,{start:this._temp.start,end:this._temp.end,lineMaterial:this._lineMaterial,endpointElement:wr()})}getBoundingBoxes(){return this.list.map(t=>t.boundingBox).filter(t=>t!==void 0)}setupEvents(t){if(!this.world)throw new Error("The length measurement needs a world to work!");if(this.world.isDisposing)return;if(!this.world.renderer)throw new Error("The world of the length measurement needs a renderer!");const e=this.world.renderer.three.domElement.parentElement;e&&(e.removeEventListener("pointermove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown),t&&(e.addEventListener("pointermove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown)))}};B(DS,"uuid","2f9bcacf-18a9-4be6-a293-e898eae64ea1");let Wl=DS;const c6=class US extends xt{constructor(t){super(t),B(this,"onDisposed",new nt),B(this,"onVolumeFound",new nt),B(this,"label",null),B(this,"world"),B(this,"_enabled",!1),B(this,"create",()=>{if(!this.enabled)return;if(!this.world)throw new Error("World is needed for Volume Measurement!");const e=this.components.get(es).get(this.world).castRay(),i=this.components.get(go);if(!e||!e.object)return;const{object:s}=e;if(s instanceof it){const n=i.getVolumeFromMeshes([s]);this.onVolumeFound.trigger(n)}}),B(this,"onMouseMove",()=>{}),B(this,"onKeydown",e=>{}),this.components.add(US.uuid,this)}set enabled(t){this._enabled=t,this.setupEvents(t),t||this.cancelCreation()}get enabled(){return this._enabled}async dispose(){var t;this.setupEvents(!1),(t=this.label)==null||t.dispose(),this.onDisposed.trigger(),this.onDisposed.reset(),this.components=null}delete(){}async deleteAll(){}endCreation(){}cancelCreation(){}getVolumeFromFragments(t){const e=this.components.get(go).getVolumeFromFragments(t),i=this.components.get(Ff);i.reset(),i.addFragmentIdMap(t);const s=i.getSphere();return this.setLabel(s,e),e}getVolumeFromMeshes(t){const e=this.components.get(go),i=this.components.get(Ff);i.reset();for(const o of t)i.addMesh(o);const s=i.getSphere(),n=e.getVolumeFromMeshes(t);return this.setLabel(s,n),n}clear(){this.label&&(this.label.visible=!1)}newLabel(){if(!this.world)throw new Error("World is needed for Volume Measurement!");const t=wr();return new mi(this.world,t)}setupEvents(t){if(!this.world)throw new Error("The volume measurement needs a world to work!");if(this.world.isDisposing)return;if(!this.world.renderer)throw new Error("The world of the volume measurement needs a renderer!");const e=this.world.renderer.three.domElement.parentElement;t?(e.addEventListener("click",this.create),e.addEventListener("pointermove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown)):(e.removeEventListener("click",this.create),e.removeEventListener("pointermove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown))}setLabel(t,e){if(!this.world)throw new Error("World is needed for Volume Measurement!");this.label||(this.label=this.newLabel(),this.label.three.removeFromParent()),this.label.visible=!0,this.world.scene.three.add(this.label.three),this.label.three.position.copy(t.center);const i=Math.trunc(e*100)/100;this.label.three.element.textContent=i.toString()}};B(c6,"uuid","811da532-7af3-4635-b592-1c06ae494af5");const l6=class BS extends xt{constructor(t){super(t),B(this,"onDisposed",new nt),B(this,"selection",[]),B(this,"preview",new it(new Ut,new Ue({side:2,depthTest:!1,transparent:!0,opacity:.25,color:"#BCF124"}))),B(this,"selectionMaterial",new Ue({side:2,depthTest:!1,transparent:!0,color:"#BCF124",opacity:.75})),B(this,"world"),B(this,"_enabled",!1),B(this,"_currentSelelection",null),B(this,"create",()=>{if(!this.world)throw new Error("No world given to the face measurement!");if(!this.enabled||!this._currentSelelection)return;const e=this.world.scene.three,i=new Ut,s=new it(i,this.selectionMaterial);i.setAttribute("position",this.preview.geometry.attributes.position),e.add(s),i.computeBoundingSphere();const{area:n,perimeter:o}=this._currentSelelection,a=this.newLabel(i,n);s.add(a.three),this.selection.push({area:n,perimeter:o,mesh:s,label:a})}),B(this,"onMouseMove",()=>{if(!this.world)throw new Error("The face measurement needs a world to work!");if(!this.enabled){this.unselect();return}const e=this.components.get(es).get(this.world).castRay();if(!e||!e.object||e.faceIndex===void 0){this.unselect();return}const{object:i,faceIndex:s}=e;i instanceof it||i instanceof Pe?this.updateSelection(i,s,e.instanceId):this.unselect()}),B(this,"onKeydown",e=>{}),this.components.add(BS.uuid,this),this.preview.frustumCulled=!1}set enabled(t){if(!this.world)throw new Error("No world given for the Face measurement!");this._enabled=t,this.setupEvents(t),t?this.world.scene.three.add(this.preview):(this.preview.removeFromParent(),this.cancelCreation()),this.setVisibility(t)}get enabled(){return this._enabled}dispose(){this.setupEvents(!1),this.deleteAll(),this.preview.removeFromParent(),this.preview.material.dispose(),this.preview.geometry.dispose(),this.selectionMaterial.dispose(),this.onDisposed.trigger(),this.onDisposed.reset(),this.components=null}delete(){if(!this.world)throw new Error("No world given to the face measurement!");const t=this.selection.map(n=>n.mesh),e=this.components.get(es).get(this.world).castRay(t);if(!e||!e.object)return;const i=this.selection.find(n=>n.mesh===e.object);if(!i)return;i.mesh.removeFromParent(),i.mesh.geometry.dispose(),i.label.dispose();const s=this.selection.indexOf(i);this.selection.splice(s,1)}deleteAll(){for(const t of this.selection)t.mesh.removeFromParent(),t.mesh.geometry.dispose(),t.label.dispose();this.selection=[]}endCreation(){}cancelCreation(){}get(){const t=[];for(const e of this.selection){const i=e.mesh.geometry,{area:s,perimeter:n}=e,o=i.attributes.position.array;t.push({position:o,area:s,perimeter:n})}return t}set(t){if(!this.world)throw new Error("No world given to the face measurement!");const e=this.world.scene.three;for(const i of t){const s=new Ut,n=new it(s,this.selectionMaterial);e.add(n);const o=new Kt(i.position,3);s.setAttribute("position",o),s.computeBoundingSphere();const{area:a,perimeter:c}=i,l=this.newLabel(s,a);n.add(l.three),this.selection.push({area:a,perimeter:c,mesh:n,label:l})}}setupEvents(t){if(!this.world)throw new Error("The face measurement needs a world to work!");if(this.world.isDisposing)return;if(!this.world.renderer)throw new Error("The world of the face measurement needs a renderer!");const e=this.world.renderer.three.domElement.parentElement;e.removeEventListener("pointermove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown),t&&(e.addEventListener("pointermove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown))}setVisibility(t){if(!this.world)throw new Error("The face measurement needs a world to work!");if(this.world.isDisposing)return;const e=this.world.scene.three;for(const i of this.selection){const s=i.label.three;t?(e.add(i.mesh),i.mesh.add(s)):(i.mesh.removeFromParent(),s.removeFromParent())}}unselect(){this.preview.removeFromParent(),this._currentSelelection=null}updateSelection(t,e,i){if(!this.world)throw new Error("The face measurement needs a world to work!");this.world.scene.three.add(this.preview);const s=this.components.get(go).getFace(t,e,i);if(s===null)return;const n=this.regenerateHighlight(t,s.indices,i);let o=0;for(const{distance:a}of s.edges)o+=a;this._currentSelelection={perimeter:o,area:n}}newLabel(t,e){if(!t.boundingSphere)throw new Error("Error computing area geometry");if(!this.world)throw new Error("The face measurement needs a world to work!");const{center:i}=t.boundingSphere,s=wr(),n=Math.trunc(e*100)/100;s.textContent=n.toString();const o=new mi(this.world,s);return o.three.position.copy(i),o}regenerateHighlight(t,e,i){const s=[],n=[];let o=0,a=0;const c=new $e,l=this.components.get(go);for(const d of e){const{p1:f,p2:p,p3:m}=l.getVerticesAndNormal(t,d,i);s.push(f.x,f.y,f.z),s.push(p.x,p.y,p.z),s.push(m.x,m.y,m.z),c.set(f,p,m),a+=c.getArea(),n.push(o,o+1,o+2),o+=3}this.preview.position.set(0,0,0),this.preview.rotation.set(0,0,0),this.preview.scale.set(1,1,1),this.preview.updateMatrix(),this.preview.applyMatrix4(t.matrixWorld);const h=new Float32Array(s),u=new Kt(h,3);return this.preview.geometry.setAttribute("position",u),this.preview.geometry.setIndex(n),a}};B(l6,"uuid","30279548-1309-44f6-aa97-ce26eed73522");const h6=class kS extends xt{constructor(t){super(t),B(this,"onDisposed",new nt),B(this,"preview"),B(this,"tolerance",.3),B(this,"world"),B(this,"_enabled",!1),B(this,"_lineMaterial",new xi({color:"#DC2626",linewidth:2,depthTest:!1,transparent:!0})),B(this,"create",async()=>{if(!this.preview||!this.enabled||!this.preview.visible)return;const e=this.components.get(Wl);e.world=this.world;const i=this.preview.startPoint.clone(),s=this.preview.endPoint.clone();e.createOnPoints(i,s)}),B(this,"onMouseMove",()=>{if(!this.preview)return;if(!this.world)throw new Error("The edge measurement needs a world to work!");if(!this.enabled){this.preview.visible=!1;return}const e=this.components.get(es).get(this.world).castRay();if(!e||!e.object){this.preview.visible=!1;return}const{object:i,faceIndex:s,point:n}=e;if(s===void 0){this.preview.visible=!1;return}i instanceof it||i instanceof Pe?this.updateSelection(i,n,s,e.instanceId):this.preview.visible=!1}),B(this,"onKeydown",e=>{}),this.components.add(kS.uuid,this)}set enabled(t){if(this._enabled=t,this.setupEvents(t),t){if(!this.world)throw new Error("The edge measurement needs a world to work!");if(!this.preview){const e=document.createElement("div");e.className="w-2 h-2 bg-red-600 rounded-full",this.preview=new KE(this.components,this.world,{start:new M,end:new M,lineMaterial:this._lineMaterial,endpointElement:e}),this.preview.visible=!1}}else this.cancelCreation()}get enabled(){return this._enabled}dispose(){this.preview&&this.preview.dispose(),this._lineMaterial.dispose(),this.setupEvents(!1),this.onDisposed.trigger(),this.onDisposed.reset(),this.components=null}delete(){if(!this.enabled)return;const t=this.components.get(Wl),e=t.enabled;t.enabled=!0,t.delete(),t.enabled=e}deleteAll(){this.components.get(Wl).deleteAll()}endCreation(){}cancelCreation(){}get(){const t=this.components.get(Wl).list,e=[];for(const i of t){const s=i.startPoint,n=i.endPoint,o=[s.x,s.y,s.z,n.x,n.y,n.z];e.push(o)}return e}set(t){const e=this.components.get(Wl);e.world=this.world;for(const i of t){const[s,n,o,a,c,l]=i,h=new M(s,n,o),u=new M(a,c,l);e.createOnPoints(h,u)}}setupEvents(t){if(!this.world)throw new Error("The edge measurement needs a world to work!");if(this.world.isDisposing)return;if(!this.world.renderer)throw new Error("The world of the edge measurement needs a renderer!");const e=this.world.renderer.three.domElement.parentElement;t?(e.addEventListener("pointermove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown)):(e.removeEventListener("pointermove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown))}updateSelection(t,e,i,s){if(!this.preview||!t.geometry.index)return;const n=this.components.get(go).getFace(t,i,s);if(!n)return;const{edges:o}=n;let a=Number.MAX_VALUE,c=[];for(const u of o){const[d,f]=u.points,p=go.distanceFromPointToLine(e,d,f,!0);p<this.tolerance&&p<a&&(a=p,c=u.points)}if(!c.length){this.preview.visible=!1;return}const[l,h]=c;this.preview.startPoint=l,this.preview.endPoint=h,this.preview.visible=!0}};B(h6,"uuid","e7be5749-89df-4514-8d25-83aa38ce12d8");let u6=class extends IA{constructor(t,e){super(t,e),B(this,"threshold",50),B(this,"bboxThreshold",200),B(this,"maxLostTime",3e4),B(this,"maxHiddenTime",5e3),B(this,"boxes",new Map),B(this,"_staticGeometries",{culled:{},unculled:{}}),B(this,"_geometry"),B(this,"_material",new Ue({transparent:!1,side:2,opacity:1})),B(this,"_materialT",new q_),B(this,"onViewUpdated",new vn),B(this,"_modelIDIndex",new Map),B(this,"_indexModelID",new Map),B(this,"_nextModelID",0),B(this,"_geometries",new Map),B(this,"_geometriesGroups",new Map),B(this,"_geometriesInMemory",new Set),B(this,"_intervalID",null),B(this,"codes",new Map),B(this,"handleWorkerMessage",async s=>{const n=s.data.colors,o={},a={},c={},l={},h=performance.now();let u=!1;const d=new Set(this._geometriesInMemory);for(const[f,p]of n){const m=this._geometries.get(f);if(!m||!(p>this.threshold))continue;d.delete(f);const{exists:g}=m,I=this._indexModelID.get(m.modelIndex);g?(m.time=h,l[I]||(l[I]=new Set),l[I].add(m.geometryID),this._geometriesInMemory.add(f),u=!0):(o[I]||(o[I]=new Map),m.time=h,m.exists=!0,o[I].has(p)||o[I].set(p,new Set),o[I].get(p).add(m.geometryID),this._geometriesInMemory.add(f),u=!0)}for(const f of d){const p=this._geometries.get(f);p&&(this.handleLostGeometries(h,f,p,a,c),u=!0)}u&&await this.onViewUpdated.trigger({toLoad:o,toRemove:a,toHide:c,toShow:l}),this._isWorkerBusy=!1}),this.config.updateInterval=500,this._geometry=new kt(1,1,1),this._geometry.groups=[],this._geometry.deleteAttribute("uv");const i=this._geometry.attributes.position.array;for(let s=0;s<i.length;s++)i[s]+=.5;this._geometry.attributes.position.needsUpdate=!0,this.worker.addEventListener("message",this.handleWorkerMessage)}dispose(){super.dispose(),this.onViewUpdated.reset(),this._intervalID!==null&&(window.clearInterval(this._intervalID),this._intervalID=null);for(const[t,e]of this._geometriesGroups){e.removeFromParent();const i=[...e.children];for(const s of i)s.removeFromParent()}this._geometriesGroups.clear();for(const[t,e]of this.boxes)e.dispose(!0);this.boxes.clear();for(const[t,e]of this._geometries)e.fragment&&(e.fragment.dispose(!0),e.fragment=void 0);this._geometries.clear(),this._staticGeometries={culled:{},unculled:{}},this._geometry.dispose(),this._material.dispose(),this._modelIDIndex.clear(),this._indexModelID.clear(),this.codes.clear()}add(t,e,i){const s=this.createModelIndex(t),n=ki.enabled;ki.enabled=!1;const o=new Map,a=new ht,c=new So(this._geometry,this._material,10);this.boxes.set(s,c),this.scene.add(c.mesh);const l=new vo;this.scene.add(l),this._geometriesGroups.set(s,l);const h=new Map;for(const d of e)for(const f of d.geometries){const{geometryID:p,transformation:m,color:g}=f,I=new Rt;I.setRGB(g[0],g[1],g[2],"srgb");const C=this.getInstanceID(d.id,p),b=i[p];if(!b){console.log(`Geometry not found: ${p}`);continue}const{boundingBox:E}=b;let T;o.has(p)?T=o.get(p):(T=this.getAvailableColor(),this.increaseColor(),o.set(p,T));const{r:A,g:S,b:_,code:w}=T,F=new Rt;F.setRGB(A/255,S/255,_/255,"srgb"),this.codes.has(s)||this.codes.set(s,new Map),this.codes.get(s).set(p,w);const D=new ht,R=Object.values(E);if(D.fromArray(m),a.fromArray(R),D.multiply(a),h.has(C)){const O=h.get(C);if(O===void 0||!O.colors)throw new Error("Malformed item!");O.colors.push(F),O.geometryColors.push(I),O.transforms.push(D)}else h.set(C,{id:C,colors:[F],geometryColors:[I],transforms:[D]});if(this._geometries.has(w))this._geometries.get(w).assetIDs.add(d.id);else{const O=new Set([d.id]);this._geometries.set(w,{modelIndex:s,geometryID:p,assetIDs:O,exists:!1,hidden:!1,time:0})}}const u=Array.from(h.values());c.add(u),ki.enabled=n}remove(t){const e=this._modelIDIndex.get(t);if(e===void 0)throw new Error("Model doesn't exist!");const i=this._geometriesGroups.get(e);i.removeFromParent();const s=[...i.children];for(const o of s)o.removeFromParent();this._geometriesGroups.delete(e),this.boxes.get(e).dispose(!1),this.boxes.delete(e);const n=this.codes.get(e);this.codes.delete(e);for(const[o,a]of n){const c=this._geometries.get(a);c&&c.fragment&&(c.fragment.dispose(!1),c.fragment=void 0),this._geometries.delete(a)}this._modelIDIndex.delete(t),this._indexModelID.delete(e),this._geometriesInMemory.clear()}addFragment(t,e,i){var s,n;const o=ki.enabled;ki.enabled=!1;const a=this._modelIDIndex.get(t),c=this.codes.get(a).get(e),l=this._geometries.get(c);if(this.setGeometryVisibility(l,!1,!1),!l.fragment){const p=((n=(s=i.mesh.instanceColor)==null?void 0:s.array)==null?void 0:n[4])!==void 0&&i.mesh.instanceColor.array[4]<.9?this._materialT:this._material;l.fragment=new So(i.mesh.geometry,p,i.capacity);const m=this._geometriesGroups.get(a);if(!m)throw new Error("Group not found!");m.add(l.fragment.mesh)}const[h,u,d]=c.split("-").map(p=>parseInt(p,10)),f=[];for(const p of i.ids){const m=i.get(p);if(!m.colors)throw new Error("Malformed fragments!");for(const g of m.colors)g.setRGB(h/255,u/255,d/255,"srgb");f.push(m)}l.fragment.add(f),ki.enabled=o,this.needsUpdate=!0}removeFragment(t,e){const i=this._modelIDIndex.get(t),s=this.codes.get(i).get(e),n=this._geometries.get(s);if(n.hidden||this.setGeometryVisibility(n,!0,!1),n.fragment){const{fragment:o}=n;o.dispose(!1),n.fragment=void 0}}setModelTransformation(t,e){const i=this._modelIDIndex.get(t);if(i===void 0)throw new Error("Model not found!");const s=this.boxes.get(i);s&&(s.mesh.position.set(0,0,0),s.mesh.rotation.set(0,0,0),s.mesh.scale.set(1,1,1),s.mesh.applyMatrix4(e));const n=this._geometriesGroups.get(i);n&&(n.position.set(0,0,0),n.rotation.set(0,0,0),n.scale.set(1,1,1),n.applyMatrix4(e))}setVisibility(t,e,i){const s=this._modelIDIndex.get(e);if(s!==void 0)for(const[n,o]of i){const a=this.codes.get(s);if(a===void 0)throw new Error("Map not found!");const c=a.get(n),l=this._geometries.get(c);if(l===void 0)throw new Error("Geometry not found!");l.hidden=!t,this.setGeometryVisibility(l,t,!0,o)}}updateTransformations(t){const e=this._modelIDIndex.get(t);if(e===void 0)return;const i=this.components.get(Nt).groups.get(t);if(i){i.updateWorldMatrix(!0,!1),i.updateMatrix();const s=this.boxes.get(e);s&&(s.mesh.position.set(0,0,0),s.mesh.rotation.set(0,0,0),s.mesh.scale.set(1,1,1),s.mesh.updateMatrix(),s.mesh.applyMatrix4(i.matrixWorld),s.mesh.updateMatrix());const n=this._geometriesGroups.get(e);n&&(n.position.set(0,0,0),n.rotation.set(0,0,0),n.scale.set(1,1,1),n.updateMatrix(),n.applyMatrix4(i.matrixWorld),n.updateMatrix())}}async addStaticGeometries(t,e=!0){const i={data:{colors:new Map}},s=this.threshold+1e3;for(const n in t){const o=this._modelIDIndex.get(n);if(o===void 0)continue;const a=this.codes.get(o);if(!a)continue;const c=t[n];for(const l of c){const h=a.get(l);if(!h)continue;const u=this._geometries.get(h);if(!u)continue;u.exists=!0,e||(u.hidden=!1,u.time=performance.now(),i.data.colors.set(h,s)),this._geometriesInMemory.add(h);const d=e?this._staticGeometries.culled:this._staticGeometries.unculled;d[n]||(d[n]=new Set),d[n].add(l)}}e||await this.handleWorkerMessage(i)}removeStaticGeometries(t,e){const i=[];e===void 0?i.push("culled","unculled"):e===!0?i.push("culled"):i.push("unculled");for(const s in t){const n=t[s];for(const o of i){const a=this._staticGeometries[o][s];if(a)for(const c of n)a.delete(c)}}}cancel(t){for(const e in t){const i=this._modelIDIndex.get(e);if(i===void 0)throw new Error("Model not found.");const s=this.codes.get(i);if(s===void 0)throw new Error("Codes not found.");for(const n of t[e]){const o=s.get(n);if(o===void 0)throw new Error("Color code not found.");this._geometriesInMemory.delete(o);const a=this._geometries.get(o);if(!a)throw new Error("Geometry not found.");a.exists=!1}}}getBoundingBoxes(t){const e=new si;for(const i in t){const s=t[i],n=this._modelIDIndex.get(i);if(n===void 0)continue;const o=this.boxes.get(n);if(!o)continue;const a=o.clone(s);e.add(a.mesh),e.items.push(a)}return e}getInstanceID(t,e){const i=10**(Math.log(e)*Math.LOG10E+1|0);return t+e/i}setGeometryVisibility(t,e,i,s){const{modelIndex:n,geometryID:o,assetIDs:a}=t,c=this.boxes.get(n);if(c===void 0)throw new Error("Model not found!");const l=s||a;if(i&&t.fragment)t.fragment.setVisibility(e,l);else{const h=new Set;for(const u of l){const d=this.getInstanceID(u,o);h.add(d)}c.setVisibility(e,h)}}handleLostGeometries(t,e,i,s,n){var o,a,c;const l=this._indexModelID.get(i.modelIndex),h=t-i.time,{culled:u,unculled:d}=this._staticGeometries;if(h>this.maxLostTime){if((o=u[l])!=null&&o.has(i.geometryID)||(a=d[l])!=null&&a.has(i.geometryID))return;s[l]||(s[l]=new Set),i.exists=!1,s[l].add(i.geometryID),this._geometriesInMemory.delete(e)}else if(h>this.maxHiddenTime){if((c=d[l])!=null&&c.has(i.geometryID))return;n[l]||(n[l]=new Set),n[l].add(i.geometryID)}}createModelIndex(t){if(this._modelIDIndex.has(t))throw new Error("Can't load the same model twice!");const e=this._nextModelID;return this._nextModelID++,this._modelIDIndex.set(t,e),this._indexModelID.set(e,t),e}};const d6=class xg extends xt{constructor(t){super(t),B(this,"enabled",!0),B(this,"onFragmentsDeleted",new nt),B(this,"onFragmentsLoaded",new nt),B(this,"onDisposed",new nt),B(this,"models",{}),B(this,"serializer",new RE),B(this,"maxRamTime",5e3),B(this,"useCache",!0),B(this,"cancel",!1),B(this,"url",""),B(this,"fetch",async e=>fetch(this.url+e)),B(this,"fileDB",new Bv("that-open-company-streaming")),B(this,"_culler",null),B(this,"_world",null),B(this,"_ramCache",new Map),B(this,"_isDisposing",!1),B(this,"_geometryInstances",{}),B(this,"_loadedFragments",{}),B(this,"fragIDData",new Map),B(this,"_baseMaterial",new Er),B(this,"_baseMaterialT",new Er({transparent:!0,opacity:.5})),B(this,"disposeStreamedGroup",e=>{this._isDisposing=!0;const{groupID:i,fragmentIDs:s}=e;if(this.models[i]){delete this.models[i],delete this._geometryInstances[i],delete this._loadedFragments[i];for(const n of s)this.fragIDData.delete(n);this.culler.remove(i),this._isDisposing=!1}}),this.components.add(xg.uuid,this),this.components.get(Nt).onFragmentsDisposed.add(this.disposeStreamedGroup),si.setPropertiesDB(!0)}get world(){if(!this._world)throw new Error("You must set a world before using the streamer!");return this._world}set world(t){var e;this._world=t,(e=this._culler)==null||e.dispose(),this._culler=new u6(this.components,t),this._culler.onViewUpdated.add(async({toLoad:i,toRemove:s,toShow:n,toHide:o})=>{await this.loadFoundGeometries(i),await this.unloadLostGeometries(s),this.setMeshVisibility(n,!0),this.setMeshVisibility(o,!1)})}get culler(){if(!this._culler)throw new Error("You must set a world before using the streamer!");return this._culler}dispose(){var t;this._isDisposing=!0,this.onFragmentsLoaded.reset(),this.onFragmentsDeleted.reset(),this._ramCache.clear(),this.components.get(Nt).onFragmentsDisposed.remove(this.disposeStreamedGroup),this.models={},this._geometryInstances={},this._loadedFragments={},this.fragIDData.clear(),this._baseMaterial.dispose(),this._baseMaterialT.dispose(),(t=this._culler)==null||t.dispose(),this.onDisposed.trigger(xg.uuid),this.onDisposed.reset(),this._isDisposing=!1,si.setPropertiesDB(!1)}async load(t,e,i){const{assets:s,geometries:n,globalDataFileId:o}=t,a=await(await this.fetch(o)).arrayBuffer(),c=new Uint8Array(a),l=this.components.get(Nt).load(c,{coordinate:e,isStreamed:!0});l.name=o.replace("-processed-global",""),this.world.scene.three.add(l);const{opaque:h,transparent:u}=l.geometryIDs;for(const[m,g]of h){const I=l.keyFragments.get(g);if(I===void 0)throw new Error("Malformed fragments group!");this.fragIDData.set(I,[l,m,new Set])}for(const[m,g]of u){const I=l.keyFragments.get(g);if(I===void 0)throw new Error("Malformed fragments group!");this.fragIDData.set(I,[l,Math.abs(m),new Set])}this.culler.add(l.uuid,s,n);const d=new Map;for(const m of s)d.set(m.id,m);const f={assetsMap:d,geometries:n};Object.defineProperty(f,"assets",{get:()=>Array.from(f.assetsMap.values())}),this.models[l.uuid]=f;const p=new Map;for(const m of s){const g=m.id;for(const{transformation:I,geometryID:C,color:b}of m.geometries){p.has(C)||p.set(C,[]);const E=p.get(C);if(!E)throw new Error("Malformed instances");E.push({id:g,transformation:I,color:b})}}if(this._geometryInstances[l.uuid]=p,i){const m=new Map,g=new Map;for(const T in i.ids){const A=i.ids[T],S=parseInt(T,10);m.set(S,A)}for(const T in i.types){const A=i.types[T],S=parseInt(T,10);g.set(S,A)}const I=o.replace("-global","-properties");si.url=this.url,l.streamSettings={baseFileName:I,ids:m,types:g};const{indexesFile:C}=i,b=await(await this.fetch(C)).text(),E=this.components.get(_i);E.setRelationMap(l,E.getRelationsMapFromJSON(b))}return this.culler.updateTransformations(l.uuid),this.culler.needsUpdate=!0,l}remove(t){const e=this.components.get(Nt),i=e.groups.get(t);i&&e.disposeGroup(i)}setVisibility(t,e){const i=new Map;if(!e){const s=this.components.get(Nt),n={};for(const[,o]of s.groups){const a=o.getFragmentMap();for(const c in a)n[c]=a[c]}e=n}for(const s in e){const n=this.fragIDData.get(s);if(n===void 0)throw new Error("Geometry not found!");const[o,a,c]=n,l=o.uuid;i.has(l)||i.set(l,new Map);const h=i.get(l),u=e[s];for(const f of u)t?c.delete(f):c.add(f);h.get(a)||h.set(a,new Set);const d=h.get(a);for(const f of u)d.add(f)}for(const[s,n]of i){this.culler.setVisibility(t,s,n);for(const[o]of n){const a=this._loadedFragments[s];if(!a)continue;const c=a[o];if(c)for(const l of c){const h=e[l.id];h&&l.setVisibility(t,h)}}}this.culler.needsUpdate=!0}async clearCache(){await this.fileDB.clear()}async setStatic(t,e,i){const s={};for(const n of t){const o=this.fragIDData.get(n);if(!o){console.log(`Item not found: ${n}.`);continue}const[a,c]=o,l=a.uuid;s[l]||(s[l]=new Set),s[l].add(c)}if(e){const n={};for(const o in s){const a=new Map;a.set(1,s[o]),n[o]=a}await this.loadFoundGeometries(n,!1),await this.culler.addStaticGeometries(s,i)}else this.culler.removeStaticGeometries(s,i)}getBoundingBoxes(t){const e={},i=this.components.get(Nt),s=new Map;for(const[o,a]of i.groups)for(const[,c]of a.keyFragments)s.set(c,o);const n=new Set;for(const o in t){const a=s.get(o);if(a===void 0){console.log("Fragment group not found!");continue}const c=t[o];n.has(a)||(e[a]=new Set,n.add(a));for(const l of c){const h=this.models[a].assetsMap.get(l);if(h)for(const u of h.geometries){const d=u.geometryID,f=this.culler.getInstanceID(l,d);e[a].add(f)}}}return this.culler.getBoundingBoxes(e)}async loadFoundGeometries(t,e=!0){this.cancel=!1;const i={};for(const s in t){const n=new Set;for(const[,o]of t[s])for(const a of o)n.add(a);i[s]=n}for(const s in t){if(this._isDisposing)return;if(this.cancel){this.cancelLoading(i);return}const n=this.components.get(Nt).groups.get(s);if(!n)return;const{geometries:o}=this.models[s],a=new Map,c=new Set;for(const[f,p]of t[s])for(const m of p){if(this.cancel){this.cancelLoading(i);return}c.add(m);const g=o[m];if(!g)throw new Error("Geometry not found");if(g.geometryFile){const I=g.geometryFile,C=a.get(I)||0;a.set(I,C+f)}}if(this.useCache){const f=a.entries();for(const[p,m]of f)this.fileDB.isCached(p)&&a.set(p,m+99999)}const l=Array.from(a).sort((f,p)=>p[1]-f[1]),h=[];for(const[f]of l){const p=this.loadFragmentFile(s,n,e,f,c,i);h.push(p)}await Promise.all(h);const u=new Set,d=performance.now();for(const[f,{time:p}]of this._ramCache)d-p>this.maxRamTime&&u.add(f);for(const f of u)this._ramCache.delete(f)}}async unloadLostGeometries(t){if(this._isDisposing)return;const e=[],i=this.components.get(Nt);for(const s in t){const n=i.groups.get(s);if(!n)throw new Error("Fragment group not found!");if(!this._loadedFragments[s])continue;const o=this._loadedFragments[s],a=t[s];for(const c of a){if(this.culler.removeFragment(n.uuid,c),!o[c])continue;const l=o[c];for(const h of l)n.items.splice(n.items.indexOf(h),1),e.push(h);delete o[c]}}e.length&&this.onFragmentsDeleted.trigger(e);for(const s of e)i.list.delete(s.id),this.world.meshes.delete(s.mesh),s.mesh.material=[],s.dispose(!0)}setMeshVisibility(t,e){for(const i in t)for(const s of t[i]){const n=this._loadedFragments[i];if(!n)continue;const o=n[s];if(o)for(const a of o)a.mesh.visible=e}}newFragment(t,e,i,s,n,o,a){if(s.length===0||this._isDisposing)return;const c=t.geometryIDs,l=n?c.transparent:c.opaque,h=e*(n?-1:1),u=l.get(h);if(u===void 0)return;const d=t.keyFragments.get(u);if(d===void 0)return;const f=this.components.get(Nt);if(f.list.has(d))return;const p=n?this._baseMaterialT:this._baseMaterial,m=new So(i,p,s.length);m.mesh.visible=a,m.id=d,m.mesh.uuid=d,m.group=t,t.add(m.mesh),t.items.push(m),f.list.set(m.id,m),this.world.meshes.add(m.mesh),this._loadedFragments[t.uuid]||(this._loadedFragments[t.uuid]={});const g=this._loadedFragments[t.uuid];g[e]||(g[e]=[]),g[e].push(m);const I=new Map;for(let T=0;T<s.length;T++){const A=new ht,S=new Rt,{id:_,transformation:w,color:F}=s[T];A.fromArray(w);const[D,R,O]=F;if(S.setRGB(D,R,O,"srgb"),I.has(_)){const y=I.get(_);if(!y)continue;y.transforms.push(A),y.colors&&y.colors.push(S)}else I.set(_,{id:_,colors:[S],transforms:[A]})}const C=Array.from(I.values());m.add(C);const b=this.fragIDData.get(m.id);if(!b)throw new Error("Fragment data not found!");const E=b[2];E.size&&m.setVisibility(!1,E),this.culler.addFragment(t.uuid,e,m),o.push(m)}cancelLoading(t){this.cancel=!1,this.culler.cancel(t)}async loadFragmentFile(t,e,i,s,n,o){if(!this._ramCache.has(s)){let l=new Uint8Array;if(this.useCache){const u=await this.fileDB.get(s);if(u){const d=await u.arrayBuffer();l=new Uint8Array(d)}else{const d=await(await this.fetch(s)).arrayBuffer();l=new Uint8Array(d),await this.fileDB.add(s,l)}}else{const u=await(await this.fetch(s)).arrayBuffer();l=new Uint8Array(u)}const h=this.serializer.import(l);this._ramCache.set(s,{data:h,time:performance.now()})}const a=this._ramCache.get(s);if(!a)return;a.time=performance.now();const c=[];if(a)for(const[l,{position:h,index:u,normal:d}]of a.data){if(this._isDisposing)return;if(this.cancel){this.cancelLoading(o);return}if(o[t].delete(l),!n.has(l)||!this._geometryInstances[t]||!this._geometryInstances[t].has(l))continue;const f=this._geometryInstances[t].get(l);if(!f)throw new Error("Instances not found!");const p=new Ut,m=new Kt(h,3),g=new Kt(d,3);p.setAttribute("position",m),p.setAttribute("normal",g),p.setIndex(Array.from(u));const I=[],C=[];for(const b of f)b.color[3]===1?C.push(b):I.push(b);this.newFragment(e,l,p,I,!0,c,i),this.newFragment(e,l,p,C,!1,c,i)}c.length&&!this._isDisposing&&this.onFragmentsLoaded.trigger(c)}};B(d6,"uuid","22437e8d-9dbc-4b99-a04f-d2da280d50c8");let f6=class{constructor(){B(this,"_meshes",new Map)}highlight(t,e,i,s){if(!e.userData.indexFragmentMap||!e.geometry.index)return;const{userData:n}=e,o=n.indexFragmentMap,a=[],c=e.geometry.index.array;for(const[u,d]of o)for(const f in d)if(s[f]){for(const p of d[f])if(s[f].has(p)){const m=c[u*3],g=c[u*3+1],I=c[u*3+2];a.push(m,g,I)}}this._meshes.has(t)||this._meshes.set(t,new Map);const l=this._meshes.get(t);if(!l.has(e.uuid)){const u=new Ue({depthTest:!1,side:2,color:i}),d=new Ut;d.attributes=e.geometry.attributes;const f=new it(d,u);f.frustumCulled=!1,l.set(e.uuid,f)}const h=l.get(e.uuid);h.position.copy(e.position),e.parent&&e.parent!==h.parent&&e.parent.add(h),h.geometry.setIndex(a),h.material.color.copy(i)}clear(t){for(const[e,i]of this._meshes)if(!(t&&t!==e))for(const[s,n]of i)n.removeFromParent()}dispose(){for(const[t,e]of this._meshes)for(const[i,s]of e)s.removeFromParent(),s.geometry.attributes={},s.geometry.dispose(),s.material.dispose();this._meshes.clear()}};const VS=class Ng extends xt{constructor(t){super(t),B(this,"onDisposed",new nt),B(this,"onBeforeUpdate",new nt),B(this,"onAfterUpdate",new nt),B(this,"onSetup",new nt),B(this,"isSetup",!1),B(this,"enabled",!0),B(this,"events",{}),B(this,"multiple","ctrlKey"),B(this,"zoomFactor",1.5),B(this,"zoomToSelection",!1),B(this,"backupColor",null),B(this,"selection",{}),B(this,"config",{selectName:"select",hoverName:"hover",selectionColor:new Rt("#BCF124"),hoverColor:new Rt("#6528D7"),autoHighlightOnClick:!0,world:null,selectEnabled:!0,hoverEnabled:!0}),B(this,"colors",new Map),B(this,"autoToggle",new Set),B(this,"mouseDownPosition",{x:0,y:0}),B(this,"mouseMoveThreshold",5),B(this,"selectable",{}),B(this,"eventManager",new U3),B(this,"_fills",new f6),B(this,"_mouseState",{down:!1,moved:!1}),B(this,"_colorsBeforeSelect",{}),B(this,"saveHighlightersBeforeSelect",e=>{var i;const s=this.components.get(Nt);for(const n in e){const o=s.list.get(n);if(!o)continue;const a=(i=o.group)==null?void 0:i.uuid;if(a)for(const c in this.selection){if(c===this.config.selectName||c===this.config.hoverName)continue;const l=this.selection[c][n];if(l){c in this._colorsBeforeSelect||(this._colorsBeforeSelect[c]={}),a in this._colorsBeforeSelect[c]||(this._colorsBeforeSelect[c]={[a]:new Set});for(const h of l)this._colorsBeforeSelect[c][a].add(h)}}}}),B(this,"restoreHighlightersAfterDeselect",()=>{const e=this.components.get(Nt);for(const i in this._colorsBeforeSelect){let s={};const n=this._colorsBeforeSelect[i];for(const o in n){const a=e.groups.get(o);if(!a)continue;const c=a.getFragmentMap(n[o]);s={...s,...c}}this.highlightByID(i,s,!1,!1)}this._colorsBeforeSelect={}}),B(this,"clearHover",()=>{this.selection[this.config.hoverName]={}}),B(this,"onMouseDown",e=>{this.enabled&&(this.mouseDownPosition={x:e.clientX,y:e.clientY},this._mouseState.down=!0)}),B(this,"onMouseUp",async e=>{if(!this.enabled)return;const{world:i,autoHighlightOnClick:s,selectEnabled:n}=this.config;if(!i)throw new Error("No world found!");if(!i.renderer)throw new Error("This world doesn't have a renderer!");if(e.target===i.renderer.three.domElement){if(this._mouseState.down=!1,this._mouseState.moved||e.button!==0){this._mouseState.moved=!1;return}if(this._mouseState.moved=!1,s&&n){const o=this.multiple==="none"?!0:!e[this.multiple];await this.highlight(this.config.selectName,o,this.zoomToSelection)}}}),B(this,"onMouseMove",async e=>{if(!this.enabled)return;const i=e.clientX-this.mouseDownPosition.x,s=e.clientY-this.mouseDownPosition.y,n=Math.sqrt(i*i+s*s),{hoverName:o,hoverEnabled:a}=this.config;if(this._mouseState.moved){this.clear(o);return}if(n>this.mouseMoveThreshold){this._mouseState.moved=this._mouseState.down;const c={};for(const l in this.selection){if(l===o)continue;const h=this.selection[l];for(const u in h){u in c||(c[u]=new Set);const d=h[u];for(const f of d)c[u].add(f)}}a&&await this.highlight(this.config.hoverName,!0,!1,c)}}),this.components.add(Ng.uuid,this),this.eventManager.list.add(this.onSetup),this.eventManager.list.add(this.onDisposed)}async dispose(){this.setupEvents(!1),this._fills.dispose(),this.onBeforeUpdate.reset(),this.onAfterUpdate.reset(),this.selection={};for(const t in this.events){const{onClear:e,onHighlight:i}=this.events[t];this.eventManager.list.delete(e),this.eventManager.list.delete(i)}this.onDisposed.trigger(Ng.uuid),this.eventManager.reset()}add(t,e){if(this.selection[t]||this.colors.has(t))throw new Error("A selection with that name already exists!");this.colors.set(t,e),this.selection[t]={};const i=new nt,s=new nt,n=new nt;this.events[t]={onHighlight:i,onClear:n,onBeforeHighlight:s},this.eventManager.add([n,i,s])}remove(t){if(this.clear(t),delete this.selection[t],this.colors.delete(t),this.selection[t]||this.colors.has(t))throw new Error("A selection with that name already exists!");if(this.events[t]){const{onHighlight:e,onClear:i,onBeforeHighlight:s}=this.events[t];this.eventManager.remove([i,e,s]),delete this.events[t]}}async highlight(t,e=!0,i=this.zoomToSelection,s={}){if(!this.enabled)return null;if(!this.config.world)throw new Error("No world found in config!");const n=this.config.world;if(!this.selection[t])throw new Error(`Selection ${t} does not exist.`);const o=[],a=this.components.get(Nt).meshes;for(const g of a)o.push(g);const c=this.components.get(cc);for(const g of c.list){const I=g;if(I.edges){const C=I.edges.fillMeshes;for(const b of C)o.push(b)}}const l=this.components.get(es).get(n).castRay(o);if(!l||!l.face)return this.clear(t),null;const h=l.object;if(!h.fragment&&h.userData.indexFragmentMap){if(l.faceIndex===void 0||!h.geometry.index)return null;const{userData:g}=h,I=g.indexFragmentMap.get(l.faceIndex);if(I){await this.highlightByID(t,I,e,i,s,h,!0);const C=Object.keys(I)[0];return{id:Array.from(I[C])[0],fragments:I}}return null}const u=h.geometry,d=l.instanceId;if(!u||d===void 0)return null;const f=h.fragment.getItemID(d);if(f===null)throw new Error("Item ID not found!");const p=h.fragment.group;if(!p)throw new Error("Fragment must belong to a FragmentsGroup!");const m=p.getFragmentMap([f]);return await this.highlightByID(t,m,e,i,s,void 0,!0),{id:f,fragments:m}}async highlightByID(t,e,i=!0,s=this.zoomToSelection,n={},o=void 0,a=!1){if(!this.enabled)return;this.events[t].onBeforeHighlight.trigger(this.selection[t]),i&&this.clear(t);const c=this.components.get(Nt),l=this.colors.get(t);if(l===void 0)throw new Error("Color for selection not found!");const h={};for(const u in e){const d=e[u],f=n[u];for(const p of d)if(!(f&&f.has(p))){if(this.selectable[t]){const m=this.selectable[t];if(!m[u]||!m[u].has(p))continue}h[u]||(h[u]=new Set),h[u].add(p)}}for(const u in h){this.selection[t][u]||(this.selection[t][u]=new Set);const d=h[u],f=new Set,p=new Set;for(const g of d){const I=this.selection[t][u];a&&this.autoToggle.has(t)&&I.has(g)?(f.add(g),I.delete(g)):(I.add(g),p.add(g))}const m=c.list.get(u);if(m&&(f.size&&(this.backupColor?m.setColor(this.backupColor,f):m.resetColor(f)),p.size&&l!==null&&m.setColor(l,p),m.mesh.userData.fills&&l!==null))for(const g of m.mesh.userData.fills)this._fills.highlight(t,g,l,e)}this.events[t].onHighlight.trigger(this.selection[t]),o&&l!==null&&this._fills.highlight(t,o,l,e),s&&await this.zoomSelection(t)}clear(t,e){const i=t?[t]:Object.keys(this.selection);for(const s of i){this._fills.clear(s);const n=this.components.get(Nt),o=this.selection[s];for(const a in o){const c=n.list.get(a);if(!c)continue;let l=o[a];if(l){if(e){const h=e[a];if(!h)continue;const u=new Set,d=new Set;for(const f of l)h.has(f)?u.add(f):d.add(f);l=u,d.size?o[a]=d:delete o[a]}this.backupColor?c.setColor(this.backupColor,l):c.resetColor(l)}}e||(this.selection[s]={}),this.events[s].onClear.trigger(null)}}setup(t){this.config={...this.config,...t},this.add(this.config.selectName,this.config.selectionColor),this.autoToggle.add(this.config.selectName),this.add(this.config.hoverName,this.config.hoverColor),this.setupEvents(!0),this.enabled=!0,this.isSetup=!0,this.onSetup.trigger(this)}updateFragments(t){for(const e of t)for(const i in this.selection){const s=this.selection[i][e.id],n=this.colors.get(i);s&&n&&e.setColor(n,s)}}async zoomSelection(t){if(!this.config.world)throw new Error("No world found in config!");const e=this.config.world;if(!e.camera.hasCameraControls())return;const i=this.components.get(Ff),s=this.components.get(Nt);i.reset();const n=this.selection[t];if(!Object.keys(n).length)return;for(const m in n){const g=s.list.get(m);if(!g)continue;const I=n[m];i.addMesh(g.mesh,I)}const o=i.getSphere(),a=1/0,c=-1/0,{x:l,y:h,z:u}=o.center,d=o.radius===a||l===a||h===a||u===a,f=o.radius===c||l===c||h===c||u===c,p=o.radius===0;d||f||p||(o.radius*=this.zoomFactor,await e.camera.controls.fitToSphere(o,!0))}setupEvents(t){if(!this.config.world){console.log("No world found while setting up events!");return}if(this.config.world.isDisposing)return;if(!this.config.world.renderer)throw new Error("The given world doesn't have a renderer!");const e=this.config.world.renderer.three.domElement,i=this.events[this.config.selectName].onHighlight;i.remove(this.clearHover),i.remove(this.saveHighlightersBeforeSelect);const s=this.events[this.config.selectName].onClear;s.remove(this.restoreHighlightersAfterDeselect),e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("mouseup",this.onMouseUp),e.removeEventListener("pointermove",this.onMouseMove),t&&(i.add(this.clearHover),i.add(this.saveHighlightersBeforeSelect),s.add(this.restoreHighlightersAfterDeselect),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("mouseup",this.onMouseUp),e.addEventListener("pointermove",this.onMouseMove))}};B(VS,"uuid","cb8a76f2-654a-4b50-80c6-66fd83cafd77");let Xc=VS,p6=class extends xt{constructor(){super(...arguments),B(this,"onDisposed",new nt),B(this,"world")}get enabled(){return!this.world||this.world.isDisposing?!1:this.getRenderer().postproduction.customEffects.outlineEnabled}set enabled(t){if(!this.world||this.world.isDisposing)return;const e=this.getRenderer();e.postproduction.customEffects.outlineEnabled=t}create(t,e){const i=this.getRenderer();if(i.postproduction.customEffects.outlinedMeshes[t]!==void 0)throw new Error(`There's already a style with the name ${t}.`);i.postproduction.customEffects.outlinedMeshes[t]={material:e,meshes:new Set}}add(t,e){const i=this.getRenderer(),s=this.getStyles()[t];if(!s)throw new Error(`The style ${t} does not exist`);const n=i.postproduction.customEffects.outlineScene,o=this.components.get(Nt);for(const a in e){const c=o.list.get(a);if(!c)continue;const l=e[a],h=c.clone(l);h.mesh.position.set(0,0,0),h.mesh.rotation.set(0,0,0),h.mesh.applyMatrix4(c.mesh.matrixWorld),h.mesh.instanceColor=null,h.mesh.material=[s.material],s.meshes.add(h.mesh),n.add(h.mesh)}}clear(t){if(t){this.clearStyle(t,!1);return}const e=this.getStyles(),i=Object.keys(e);for(const s of i)this.clearStyle(s,!1);this.world=void 0}dispose(){if(this.world&&!this.world.isDisposing){const t=this.getStyles(),e=Object.keys(t);for(const i of e)this.clearStyle(i,!0)}this.onDisposed.trigger(),this.onDisposed.reset()}clearStyle(t,e){const i=this.getStyles(),s=i[t];if(!s)return;const n=this.components.get(en);for(const o of s.meshes){const a=o;a.fragment&&a.fragment.dispose(!1),n.destroy(o)}s.meshes.clear(),e&&(s.material.dispose(),delete i[t])}getStyles(){return this.getRenderer().postproduction.customEffects.outlinedMeshes}getRenderer(){if(!this.world)throw new Error("You must set a world to use the outliner!");const t=this.world.renderer;if(!t.postproduction)throw new Error("The world given to the outliner must use the postproduction renderer.");return t}};B(p6,"uuid","2fd3bcc5-b3b6-4ded-9f64-f47a02854a10");let Cn=class extends xt{constructor(){super(...arguments),B(this,"enabled",!1),B(this,"onDisposed",new nt),B(this,"onNavigated",new nt),B(this,"onExited",new nt),B(this,"planeType","section"),B(this,"offset",100),B(this,"list",new Map),B(this,"world"),B(this,"current",null),B(this,"cached3DCamera",{position:new M,target:new M,projection:"Perspective",zoom:1,top:10,bottom:-10,right:10,left:-10})}create(t){const e=this.getWorld(),{id:i,point:s,normal:n,type:o}=t;let{name:a,offset:c}=t;const l=this.components.get(cc),h=l.Type;l.Type=xf;const u=l.createFromNormalAndCoplanarPoint(e,n,s);u.visible=!1,u.edges.visible=!1,u.enabled=!1,a=a||i,c=c||this.offset,u.type=o||this.planeType,u.updateFill();const d=n.clone().multiplyScalar(-c).add(s),f=s.clone(),p={id:i,name:a,plane:u,offset:c,cached:{position:d,target:f,zoom:1,size:10}};return this.list.set(i,p),l.Type=h,p}delete(t){const e=this.list.get(t);e&&(e.plane.dispose(),this.list.delete(t))}async goTo(t,e=!1){var i;const s=this.getCamera();if(((i=this.current)==null?void 0:i.id)===t)return;const n=this.list.get(t);if(!n)throw new Error(`There's no section with the ID: ${t}.`);this.cacheCameraPosition(),await this.hidePreviousClippingPlane(),await s.projection.set("Orthographic"),this.current=n;const o=new M,a=new M,{cached:c}=n,{position:l,target:h}=c;o.copy(h),a.copy(l),await s.controls.setLookAt(a.x,a.y,a.z,o.x,o.y,o.z,e);const u=n.cached.size,d=s.threePersp.aspect;s.threeOrtho.top=u,s.threeOrtho.bottom=-u,s.threeOrtho.left=-u*d,s.threeOrtho.right=u*d,s.threeOrtho.updateProjectionMatrix(),await s.controls.zoomTo(c.zoom,!1),s.set("Plan"),this.current.plane&&(this.current.plane.enabled=!0,this.current.plane.edges.fillNeedsUpdate=!0,this.current.plane.edges.visible=!0),this.enabled=!0,this.onNavigated.trigger({id:t})}async exit(t=!1){if(!this.enabled||!this.world)return;this.cacheCameraPosition();const e=this.getCamera();e.set("Orbit");const{position:i,target:s,projection:n}=this.cached3DCamera;await e.projection.set(n),this.current&&(this.current.plane.enabled=!1,this.current.plane.edges.enabled=!1,this.current.plane.edges.visible=!1),this.current=null;const{x:o,y:a,z:c}=i,{x:l,y:h,z:u}=s;await e.controls.setLookAt(o,a,c,l,h,u,t),e.projection.current==="Orthographic"&&(await e.controls.zoomTo(this.cached3DCamera.zoom,!1),e.threeOrtho.left=this.cached3DCamera.left,e.threeOrtho.right=this.cached3DCamera.right,e.threeOrtho.top=this.cached3DCamera.top,e.threeOrtho.bottom=this.cached3DCamera.bottom),this.enabled=!1,this.onExited.trigger()}dispose(){for(const[,{plane:t}]of this.list)t.dispose();this.list.clear(),this.onDisposed.trigger(),this.onDisposed.reset()}getWorld(){if(!this.world)throw new Error("World is needed to create sections!");return this.world}getCamera(){const t=this.getWorld().camera;if(!t.hasCameraControls()||!t.projection)throw new Error("The world given to sections must have an OrthoPerspective camera.");return t}cacheCameraPosition(){if(!this.world)throw new Error("World is needed to create clipping planes!");const t=this.getCamera();if(this.enabled){if(!this.current)throw new Error("Current section not found!");const{cached:e}=this.current,{position:i,target:s}=e;t.controls.getPosition(i),t.controls.getTarget(s),e.zoom=t.threeOrtho.zoom,e.size=t.threeOrtho.top}else{t.three.getWorldPosition(this.cached3DCamera.position),t.controls.getTarget(this.cached3DCamera.target),this.cached3DCamera.projection=t.projection.current,this.cached3DCamera.zoom=t.threeOrtho.zoom;const{top:e,bottom:i,left:s,right:n}=t.threeOrtho;this.cached3DCamera.top=e,this.cached3DCamera.bottom=i,this.cached3DCamera.left=s,this.cached3DCamera.right=n}}async hidePreviousClippingPlane(){if(this.current){const t=this.current.plane;t&&(t.enabled=!1),this.current.plane.edges.visible=!1}}};B(Cn,"uuid","45b41ba3-7bb8-4e08-909f-e0fa87973965");const m6=class zS extends xt{constructor(t){super(t),B(this,"onDisposed",new nt),B(this,"planeType","floorplan"),B(this,"onNavigated",new nt),B(this,"onExited",new nt),B(this,"enabled",!1),B(this,"currentPlan",null),B(this,"offset",1.5),B(this,"list",[]),B(this,"_cachedPlanCamera",null),this.components.add(zS.uuid,this)}get world(){return this.components.get(Cn).world}set world(t){const e=this.components.get(Cn);e.world=t}get defaultCameraOffset(){return this.components.get(Cn).offset}set defaultCameraOffset(t){const e=this.components.get(Cn);e.offset=t}dispose(){this.onExited.reset(),this.onNavigated.reset();const t=this.components.get(Cn);for(const e of this.list)t.delete(e.id);this.list=[],this.onDisposed.trigger(),this.onDisposed.reset()}async generate(t){if(!t.hasProperties)throw new Error("Properties are needed to compute plan views!");const e=await t.getAllPropertiesOfType(ko);if(!e)throw new Error("Floorplans not found!");const i=t.coordinationMatrix.elements[13],s=await hh.getUnits(t);for(const n of Object.values(e)){const o={value:0};this.getAbsoluteFloorHeight(n.ObjectPlacement,o);const a=o.value*s+i+this.offset;this.create({name:n.Name.value,id:n.GlobalId.value,normal:new M(0,-1,0),point:new M(0,a,0)})}}create(t){const e=this.components.get(Cn);t.type=t.type||this.planeType;const i={...e.create(t),planOffset:this.offset};this.list.push(i)}async goTo(t,e=!1){this.enabled&&this.cachePlanCamera(),await this.components.get(Cn).goTo(t,e),await this.applyCachedPlanCamera();const i=this.list.find(s=>s.id===t);i&&(this.currentPlan=i),this.enabled=!0}async exitPlanView(t=!1){this.enabled&&(this.cachePlanCamera(),await this.components.get(Cn).exit(t),this.currentPlan=null,this.enabled=!1,this.onExited.trigger())}cachePlanCamera(){var t;const e=(t=this.world)==null?void 0:t.camera,i=new M,s=new M;e.controls.getTarget(i),e.controls.getPosition(s),this._cachedPlanCamera={target:i,position:s,zoom:e.threeOrtho.zoom,top:e.threeOrtho.top,right:e.threeOrtho.right,bottom:e.threeOrtho.bottom,left:e.threeOrtho.left}}async applyCachedPlanCamera(){var t;if(!this._cachedPlanCamera)return;const e=(t=this.world)==null?void 0:t.camera,{position:i,target:s}=this._cachedPlanCamera,n=new M,o=new M;e.controls.getPosition(n),e.controls.getTarget(o);const a=n.y,c=o.y;await e.controls.setLookAt(i.x,a,i.z,s.x,c,s.z),await e.controls.zoomTo(this._cachedPlanCamera.zoom),e.threeOrtho.top=this._cachedPlanCamera.top,e.threeOrtho.bottom=this._cachedPlanCamera.bottom,e.threeOrtho.left=this._cachedPlanCamera.left,e.threeOrtho.right=this._cachedPlanCamera.right,e.threeOrtho.updateProjectionMatrix()}getAbsoluteFloorHeight(t,e){const i=t.RelativePlacement.Location.Coordinates;e.value+=i[2].value,t.PlacementRelTo&&this.getAbsoluteFloorHeight(t.PlacementRelTo,e)}};B(m6,"uuid","a80874aa-1c93-43a4-80f2-df346da086b1");var I6=Object.defineProperty,g6=(r,t,e)=>t in r?I6(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,to=(r,t,e)=>(g6(r,typeof t!="symbol"?t+"":t,e),e);const lc=Math.min,Nn=Math.max,Nf=Math.round,_r=r=>({x:r,y:r}),E6={left:"right",right:"left",bottom:"top",top:"bottom"},C6={start:"end",end:"start"};function xT(r,t,e){return Nn(r,lc(t,e))}function nu(r,t){return typeof r=="function"?r(t):r}function Vn(r){return r.split("-")[0]}function Ap(r){return r.split("-")[1]}function YS(r){return r==="x"?"y":"x"}function GS(r){return r==="y"?"height":"width"}function xo(r){return["top","bottom"].includes(Vn(r))?"y":"x"}function HS(r){return YS(xo(r))}function b6(r,t,e){e===void 0&&(e=!1);const i=Ap(r),s=HS(r),n=GS(s);let o=s==="x"?i===(e?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[n]>t.floating[n]&&(o=Pf(o)),[o,Pf(o)]}function T6(r){const t=Pf(r);return[Pg(r),t,Pg(t)]}function Pg(r){return r.replace(/start|end/g,t=>C6[t])}function y6(r,t,e){const i=["left","right"],s=["right","left"],n=["top","bottom"],o=["bottom","top"];switch(r){case"top":case"bottom":return e?t?s:i:t?i:s;case"left":case"right":return t?n:o;default:return[]}}function v6(r,t,e,i){const s=Ap(r);let n=y6(Vn(r),e==="start",i);return s&&(n=n.map(o=>o+"-"+s),t&&(n=n.concat(n.map(Pg)))),n}function Pf(r){return r.replace(/left|right|bottom|top/g,t=>E6[t])}function R6(r){return{top:0,right:0,bottom:0,left:0,...r}}function $S(r){return typeof r!="number"?R6(r):{top:r,right:r,bottom:r,left:r}}function hc(r){const{x:t,y:e,width:i,height:s}=r;return{width:i,height:s,top:e,left:t,right:t+i,bottom:e+s,x:t,y:e}}function NT(r,t,e){let{reference:i,floating:s}=r;const n=xo(t),o=HS(t),a=GS(o),c=Vn(t),l=n==="y",h=i.x+i.width/2-s.width/2,u=i.y+i.height/2-s.height/2,d=i[a]/2-s[a]/2;let f;switch(c){case"top":f={x:h,y:i.y-s.height};break;case"bottom":f={x:h,y:i.y+i.height};break;case"right":f={x:i.x+i.width,y:u};break;case"left":f={x:i.x-s.width,y:u};break;default:f={x:i.x,y:i.y}}switch(Ap(t)){case"start":f[o]-=d*(e&&l?-1:1);break;case"end":f[o]+=d*(e&&l?-1:1);break}return f}const A6=async(r,t,e)=>{const{placement:i="bottom",strategy:s="absolute",middleware:n=[],platform:o}=e,a=n.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t));let l=await o.getElementRects({reference:r,floating:t,strategy:s}),{x:h,y:u}=NT(l,i,c),d=i,f={},p=0;for(let m=0;m<a.length;m++){const{name:g,fn:I}=a[m],{x:C,y:b,data:E,reset:T}=await I({x:h,y:u,initialPlacement:i,placement:d,strategy:s,middlewareData:f,rects:l,platform:o,elements:{reference:r,floating:t}});h=C??h,u=b??u,f={...f,[g]:{...f[g],...E}},T&&p<=50&&(p++,typeof T=="object"&&(T.placement&&(d=T.placement),T.rects&&(l=T.rects===!0?await o.getElementRects({reference:r,floating:t,strategy:s}):T.rects),{x:h,y:u}=NT(l,d,c)),m=-1)}return{x:h,y:u,placement:d,strategy:s,middlewareData:f}};async function WS(r,t){var e;t===void 0&&(t={});const{x:i,y:s,platform:n,rects:o,elements:a,strategy:c}=r,{boundary:l="clippingAncestors",rootBoundary:h="viewport",elementContext:u="floating",altBoundary:d=!1,padding:f=0}=nu(t,r),p=$S(f),m=a[d?u==="floating"?"reference":"floating":u],g=hc(await n.getClippingRect({element:(e=await(n.isElement==null?void 0:n.isElement(m)))==null||e?m:m.contextElement||await(n.getDocumentElement==null?void 0:n.getDocumentElement(a.floating)),boundary:l,rootBoundary:h,strategy:c})),I=u==="floating"?{x:i,y:s,width:o.floating.width,height:o.floating.height}:o.reference,C=await(n.getOffsetParent==null?void 0:n.getOffsetParent(a.floating)),b=await(n.isElement==null?void 0:n.isElement(C))?await(n.getScale==null?void 0:n.getScale(C))||{x:1,y:1}:{x:1,y:1},E=hc(n.convertOffsetParentRelativeRectToViewportRelativeRect?await n.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:I,offsetParent:C,strategy:c}):I);return{top:(g.top-E.top+p.top)/b.y,bottom:(E.bottom-g.bottom+p.bottom)/b.y,left:(g.left-E.left+p.left)/b.x,right:(E.right-g.right+p.right)/b.x}}const S6=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(t){var e,i;const{placement:s,middlewareData:n,rects:o,initialPlacement:a,platform:c,elements:l}=t,{mainAxis:h=!0,crossAxis:u=!0,fallbackPlacements:d,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=nu(r,t);if((e=n.arrow)!=null&&e.alignmentOffset)return{};const I=Vn(s),C=xo(a),b=Vn(a)===a,E=await(c.isRTL==null?void 0:c.isRTL(l.floating)),T=d||(b||!m?[Pf(a)]:T6(a)),A=p!=="none";!d&&A&&T.push(...v6(a,m,p,E));const S=[a,...T],_=await WS(t,g),w=[];let F=((i=n.flip)==null?void 0:i.overflows)||[];if(h&&w.push(_[I]),u){const y=b6(s,o,E);w.push(_[y[0]],_[y[1]])}if(F=[...F,{placement:s,overflows:w}],!w.every(y=>y<=0)){var D,R;const y=(((D=n.flip)==null?void 0:D.index)||0)+1,U=S[y];if(U)return{data:{index:y,overflows:F},reset:{placement:U}};let H=(R=F.filter(k=>k.overflows[0]<=0).sort((k,X)=>k.overflows[1]-X.overflows[1])[0])==null?void 0:R.placement;if(!H)switch(f){case"bestFit":{var O;const k=(O=F.filter(X=>{if(A){const $=xo(X.placement);return $===C||$==="y"}return!0}).map(X=>[X.placement,X.overflows.filter($=>$>0).reduce(($,et)=>$+et,0)]).sort((X,$)=>X[1]-$[1])[0])==null?void 0:O[0];k&&(H=k);break}case"initialPlacement":H=a;break}if(s!==H)return{reset:{placement:H}}}return{}}}};function jS(r){const t=lc(...r.map(n=>n.left)),e=lc(...r.map(n=>n.top)),i=Nn(...r.map(n=>n.right)),s=Nn(...r.map(n=>n.bottom));return{x:t,y:e,width:i-t,height:s-e}}function w6(r){const t=r.slice().sort((s,n)=>s.y-n.y),e=[];let i=null;for(let s=0;s<t.length;s++){const n=t[s];!i||n.y-i.y>i.height/2?e.push([n]):e[e.length-1].push(n),i=n}return e.map(s=>hc(jS(s)))}const _6=function(r){return r===void 0&&(r={}),{name:"inline",options:r,async fn(t){const{placement:e,elements:i,rects:s,platform:n,strategy:o}=t,{padding:a=2,x:c,y:l}=nu(r,t),h=Array.from(await(n.getClientRects==null?void 0:n.getClientRects(i.reference))||[]),u=w6(h),d=hc(jS(h)),f=$S(a);function p(){if(u.length===2&&u[0].left>u[1].right&&c!=null&&l!=null)return u.find(g=>c>g.left-f.left&&c<g.right+f.right&&l>g.top-f.top&&l<g.bottom+f.bottom)||d;if(u.length>=2){if(xo(e)==="y"){const F=u[0],D=u[u.length-1],R=Vn(e)==="top",O=F.top,y=D.bottom,U=R?F.left:D.left,H=R?F.right:D.right,k=H-U,X=y-O;return{top:O,bottom:y,left:U,right:H,width:k,height:X,x:U,y:O}}const g=Vn(e)==="left",I=Nn(...u.map(F=>F.right)),C=lc(...u.map(F=>F.left)),b=u.filter(F=>g?F.left===C:F.right===I),E=b[0].top,T=b[b.length-1].bottom,A=C,S=I,_=S-A,w=T-E;return{top:E,bottom:T,left:A,right:S,width:_,height:w,x:A,y:E}}return d}const m=await n.getElementRects({reference:{getBoundingClientRect:p},floating:i.floating,strategy:o});return s.reference.x!==m.reference.x||s.reference.y!==m.reference.y||s.reference.width!==m.reference.width||s.reference.height!==m.reference.height?{reset:{rects:m}}:{}}}};async function F6(r,t){const{placement:e,platform:i,elements:s}=r,n=await(i.isRTL==null?void 0:i.isRTL(s.floating)),o=Vn(e),a=Ap(e),c=xo(e)==="y",l=["left","top"].includes(o)?-1:1,h=n&&c?-1:1,u=nu(t,r);let{mainAxis:d,crossAxis:f,alignmentAxis:p}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),c?{x:f*h,y:d*l}:{x:d*l,y:f*h}}const XS=function(r){return{name:"offset",options:r,async fn(t){var e,i;const{x:s,y:n,placement:o,middlewareData:a}=t,c=await F6(t,r);return o===((e=a.offset)==null?void 0:e.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:s+c.x,y:n+c.y,data:{...c,placement:o}}}}},O6=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(t){const{x:e,y:i,placement:s}=t,{mainAxis:n=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:I,y:C}=g;return{x:I,y:C}}},...c}=nu(r,t),l={x:e,y:i},h=await WS(t,c),u=xo(Vn(s)),d=YS(u);let f=l[d],p=l[u];if(n){const g=d==="y"?"top":"left",I=d==="y"?"bottom":"right",C=f+h[g],b=f-h[I];f=xT(C,f,b)}if(o){const g=u==="y"?"top":"left",I=u==="y"?"bottom":"right",C=p+h[g],b=p-h[I];p=xT(C,p,b)}const m=a.fn({...t,[d]:f,[u]:p});return{...m,data:{x:m.x-e,y:m.y-i,enabled:{[d]:n,[u]:o}}}}}};function Sp(){return typeof window<"u"}function Fr(r){return ZS(r)?(r.nodeName||"").toLowerCase():"#document"}function Fi(r){var t;return(r==null||(t=r.ownerDocument)==null?void 0:t.defaultView)||window}function Br(r){var t;return(t=(ZS(r)?r.ownerDocument:r.document)||window.document)==null?void 0:t.documentElement}function ZS(r){return Sp()?r instanceof Node||r instanceof Fi(r).Node:!1}function sn(r){return Sp()?r instanceof Element||r instanceof Fi(r).Element:!1}function nn(r){return Sp()?r instanceof HTMLElement||r instanceof Fi(r).HTMLElement:!1}function PT(r){return!Sp()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof Fi(r).ShadowRoot}function ru(r){const{overflow:t,overflowX:e,overflowY:i,display:s}=rs(r);return/auto|scroll|overlay|hidden|clip/.test(t+i+e)&&!["inline","contents"].includes(s)}function x6(r){return["table","td","th"].includes(Fr(r))}function N6(r){return[":popover-open",":modal"].some(t=>{try{return r.matches(t)}catch{return!1}})}function t0(r){const t=e0(),e=sn(r)?rs(r):r;return e.transform!=="none"||e.perspective!=="none"||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(e.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(e.contain||"").includes(i))}function P6(r){let t=uc(r);for(;nn(t)&&!wp(t);){if(t0(t))return t;if(N6(t))return null;t=uc(t)}return null}function e0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function wp(r){return["html","body","#document"].includes(Fr(r))}function rs(r){return Fi(r).getComputedStyle(r)}function _p(r){return sn(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function uc(r){if(Fr(r)==="html")return r;const t=r.assignedSlot||r.parentNode||PT(r)&&r.host||Br(r);return PT(t)?t.host:t}function qS(r){const t=uc(r);return wp(t)?r.ownerDocument?r.ownerDocument.body:r.body:nn(t)&&ru(t)?t:qS(t)}function QS(r,t,e){var i;t===void 0&&(t=[]);const s=qS(r),n=s===((i=r.ownerDocument)==null?void 0:i.body),o=Fi(s);return n?(L6(o),t.concat(o,o.visualViewport||[],ru(s)?s:[],[])):t.concat(s,QS(s,[]))}function L6(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function KS(r){const t=rs(r);let e=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const s=nn(r),n=s?r.offsetWidth:e,o=s?r.offsetHeight:i,a=Nf(e)!==n||Nf(i)!==o;return a&&(e=n,i=o),{width:e,height:i,$:a}}function JS(r){return sn(r)?r:r.contextElement}function ja(r){const t=JS(r);if(!nn(t))return _r(1);const e=t.getBoundingClientRect(),{width:i,height:s,$:n}=KS(t);let o=(n?Nf(e.width):e.width)/i,a=(n?Nf(e.height):e.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const M6=_r(0);function tw(r){const t=Fi(r);return!e0()||!t.visualViewport?M6:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function D6(r,t,e){return t===void 0&&(t=!1),!e||t&&e!==Fi(r)?!1:t}function Ph(r,t,e,i){t===void 0&&(t=!1),e===void 0&&(e=!1);const s=r.getBoundingClientRect(),n=JS(r);let o=_r(1);t&&(i?sn(i)&&(o=ja(i)):o=ja(r));const a=D6(n,e,i)?tw(n):_r(0);let c=(s.left+a.x)/o.x,l=(s.top+a.y)/o.y,h=s.width/o.x,u=s.height/o.y;if(n){const d=Fi(n),f=i&&sn(i)?Fi(i):i;let p=d,m=p.frameElement;for(;m&&i&&f!==p;){const g=ja(m),I=m.getBoundingClientRect(),C=rs(m),b=I.left+(m.clientLeft+parseFloat(C.paddingLeft))*g.x,E=I.top+(m.clientTop+parseFloat(C.paddingTop))*g.y;c*=g.x,l*=g.y,h*=g.x,u*=g.y,c+=b,l+=E,p=Fi(m),m=p.frameElement}}return hc({width:h,height:u,x:c,y:l})}const U6=[":popover-open",":modal"];function ew(r){return U6.some(t=>{try{return r.matches(t)}catch{return!1}})}function B6(r){let{elements:t,rect:e,offsetParent:i,strategy:s}=r;const n=s==="fixed",o=Br(i),a=t?ew(t.floating):!1;if(i===o||a&&n)return e;let c={scrollLeft:0,scrollTop:0},l=_r(1);const h=_r(0),u=nn(i);if((u||!u&&!n)&&((Fr(i)!=="body"||ru(o))&&(c=_p(i)),nn(i))){const d=Ph(i);l=ja(i),h.x=d.x+i.clientLeft,h.y=d.y+i.clientTop}return{width:e.width*l.x,height:e.height*l.y,x:e.x*l.x-c.scrollLeft*l.x+h.x,y:e.y*l.y-c.scrollTop*l.y+h.y}}function k6(r){return Array.from(r.getClientRects())}function iw(r){return Ph(Br(r)).left+_p(r).scrollLeft}function V6(r){const t=Br(r),e=_p(r),i=r.ownerDocument.body,s=Nn(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),n=Nn(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let o=-e.scrollLeft+iw(r);const a=-e.scrollTop;return rs(i).direction==="rtl"&&(o+=Nn(t.clientWidth,i.clientWidth)-s),{width:s,height:n,x:o,y:a}}function z6(r,t){const e=Fi(r),i=Br(r),s=e.visualViewport;let n=i.clientWidth,o=i.clientHeight,a=0,c=0;if(s){n=s.width,o=s.height;const l=e0();(!l||l&&t==="fixed")&&(a=s.offsetLeft,c=s.offsetTop)}return{width:n,height:o,x:a,y:c}}function Y6(r,t){const e=Ph(r,!0,t==="fixed"),i=e.top+r.clientTop,s=e.left+r.clientLeft,n=nn(r)?ja(r):_r(1),o=r.clientWidth*n.x,a=r.clientHeight*n.y,c=s*n.x,l=i*n.y;return{width:o,height:a,x:c,y:l}}function LT(r,t,e){let i;if(t==="viewport")i=z6(r,e);else if(t==="document")i=V6(Br(r));else if(sn(t))i=Y6(t,e);else{const s=tw(r);i={...t,x:t.x-s.x,y:t.y-s.y}}return hc(i)}function sw(r,t){const e=uc(r);return e===t||!sn(e)||wp(e)?!1:rs(e).position==="fixed"||sw(e,t)}function G6(r,t){const e=t.get(r);if(e)return e;let i=QS(r,[]).filter(a=>sn(a)&&Fr(a)!=="body"),s=null;const n=rs(r).position==="fixed";let o=n?uc(r):r;for(;sn(o)&&!wp(o);){const a=rs(o),c=t0(o);!c&&a.position==="fixed"&&(s=null),(n?!c&&!s:!c&&a.position==="static"&&s&&["absolute","fixed"].includes(s.position)||ru(o)&&!c&&sw(r,o))?i=i.filter(l=>l!==o):s=a,o=uc(o)}return t.set(r,i),i}function H6(r){let{element:t,boundary:e,rootBoundary:i,strategy:s}=r;const n=[...e==="clippingAncestors"?G6(t,this._c):[].concat(e),i],o=n[0],a=n.reduce((c,l)=>{const h=LT(t,l,s);return c.top=Nn(h.top,c.top),c.right=lc(h.right,c.right),c.bottom=lc(h.bottom,c.bottom),c.left=Nn(h.left,c.left),c},LT(t,o,s));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function $6(r){const{width:t,height:e}=KS(r);return{width:t,height:e}}function W6(r,t,e){const i=nn(t),s=Br(t),n=e==="fixed",o=Ph(r,!0,n,t);let a={scrollLeft:0,scrollTop:0};const c=_r(0);if(i||!i&&!n)if((Fr(t)!=="body"||ru(s))&&(a=_p(t)),i){const u=Ph(t,!0,n,t);c.x=u.x+t.clientLeft,c.y=u.y+t.clientTop}else s&&(c.x=iw(s));const l=o.left+a.scrollLeft-c.x,h=o.top+a.scrollTop-c.y;return{x:l,y:h,width:o.width,height:o.height}}function MT(r,t){return!nn(r)||rs(r).position==="fixed"?null:t?t(r):r.offsetParent}function nw(r,t){const e=Fi(r);if(!nn(r)||ew(r))return e;let i=MT(r,t);for(;i&&x6(i)&&rs(i).position==="static";)i=MT(i,t);return i&&(Fr(i)==="html"||Fr(i)==="body"&&rs(i).position==="static"&&!t0(i))?e:i||P6(r)||e}const j6=async function(r){const t=this.getOffsetParent||nw,e=this.getDimensions;return{reference:W6(r.reference,await t(r.floating),r.strategy),floating:{x:0,y:0,...await e(r.floating)}}};function X6(r){return rs(r).direction==="rtl"}const Z6={convertOffsetParentRelativeRectToViewportRelativeRect:B6,getDocumentElement:Br,getClippingRect:H6,getOffsetParent:nw,getElementRects:j6,getClientRects:k6,getDimensions:$6,getScale:ja,isElement:sn,isRTL:X6},rw=O6,ow=S6,aw=_6,cw=(r,t,e)=>{const i=new Map,s={platform:Z6,...e},n={...s.platform,_c:i};return A6(r,t,{...s,platform:n})};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const lf=globalThis,i0=lf.ShadowRoot&&(lf.ShadyCSS===void 0||lf.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s0=Symbol(),DT=new WeakMap;let lw=class{constructor(r,t,e){if(this._$cssResult$=!0,e!==s0)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=r,this.t=t}get styleSheet(){let r=this.o;const t=this.t;if(i0&&r===void 0){const e=t!==void 0&&t.length===1;e&&(r=DT.get(t)),r===void 0&&((this.o=r=new CSSStyleSheet).replaceSync(this.cssText),e&&DT.set(t,r))}return r}toString(){return this.cssText}};const q6=r=>new lw(typeof r=="string"?r:r+"",void 0,s0),te=(r,...t)=>{const e=r.length===1?r[0]:t.reduce((i,s,n)=>i+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+r[n+1],r[0]);return new lw(e,r,s0)},Q6=(r,t)=>{if(i0)r.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(const e of t){const i=document.createElement("style"),s=lf.litNonce;s!==void 0&&i.setAttribute("nonce",s),i.textContent=e.cssText,r.appendChild(i)}},UT=i0?r=>r:r=>r instanceof CSSStyleSheet?(t=>{let e="";for(const i of t.cssRules)e+=i.cssText;return q6(e)})(r):r;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:K6,defineProperty:J6,getOwnPropertyDescriptor:t8,getOwnPropertyNames:e8,getOwnPropertySymbols:i8,getPrototypeOf:s8}=Object,dc=globalThis,BT=dc.trustedTypes,n8=BT?BT.emptyScript:"",kT=dc.reactiveElementPolyfillSupport,dh=(r,t)=>r,Lf={toAttribute(r,t){switch(t){case Boolean:r=r?n8:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,t){let e=r;switch(t){case Boolean:e=r!==null;break;case Number:e=r===null?null:Number(r);break;case Object:case Array:try{e=JSON.parse(r)}catch{e=null}}return e}},n0=(r,t)=>!K6(r,t),VT={attribute:!0,type:String,converter:Lf,reflect:!1,hasChanged:n0};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),dc.litPropertyMetadata??(dc.litPropertyMetadata=new WeakMap);class Ua extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??(this.l=[])).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,e=VT){if(e.state&&(e.attribute=!1),this._$Ei(),this.elementProperties.set(t,e),!e.noAccessor){const i=Symbol(),s=this.getPropertyDescriptor(t,i,e);s!==void 0&&J6(this.prototype,t,s)}}static getPropertyDescriptor(t,e,i){const{get:s,set:n}=t8(this.prototype,t)??{get(){return this[e]},set(o){this[e]=o}};return{get(){return s?.call(this)},set(o){const a=s?.call(this);n.call(this,o),this.requestUpdate(t,a,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??VT}static _$Ei(){if(this.hasOwnProperty(dh("elementProperties")))return;const t=s8(this);t.finalize(),t.l!==void 0&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(dh("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(dh("properties"))){const e=this.properties,i=[...e8(e),...i8(e)];for(const s of i)this.createProperty(s,e[s])}const t=this[Symbol.metadata];if(t!==null){const e=litPropertyMetadata.get(t);if(e!==void 0)for(const[i,s]of e)this.elementProperties.set(i,s)}this._$Eh=new Map;for(const[e,i]of this.elementProperties){const s=this._$Eu(e,i);s!==void 0&&this._$Eh.set(s,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const s of i)e.unshift(UT(s))}else t!==void 0&&e.push(UT(t));return e}static _$Eu(t,e){const i=e.attribute;return i===!1?void 0:typeof i=="string"?i:typeof t=="string"?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var t;this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),(t=this.constructor.l)==null||t.forEach(e=>e(this))}addController(t){var e;(this._$EO??(this._$EO=new Set)).add(t),this.renderRoot!==void 0&&this.isConnected&&((e=t.hostConnected)==null||e.call(t))}removeController(t){var e;(e=this._$EO)==null||e.delete(t)}_$E_(){const t=new Map,e=this.constructor.elementProperties;for(const i of e.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Q6(t,this.constructor.elementStyles),t}connectedCallback(){var t;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(t=this._$EO)==null||t.forEach(e=>{var i;return(i=e.hostConnected)==null?void 0:i.call(e)})}enableUpdating(t){}disconnectedCallback(){var t;(t=this._$EO)==null||t.forEach(e=>{var i;return(i=e.hostDisconnected)==null?void 0:i.call(e)})}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$EC(t,e){var i;const s=this.constructor.elementProperties.get(t),n=this.constructor._$Eu(t,s);if(n!==void 0&&s.reflect===!0){const o=(((i=s.converter)==null?void 0:i.toAttribute)!==void 0?s.converter:Lf).toAttribute(e,s.type);this._$Em=t,o==null?this.removeAttribute(n):this.setAttribute(n,o),this._$Em=null}}_$AK(t,e){var i;const s=this.constructor,n=s._$Eh.get(t);if(n!==void 0&&this._$Em!==n){const o=s.getPropertyOptions(n),a=typeof o.converter=="function"?{fromAttribute:o.converter}:((i=o.converter)==null?void 0:i.fromAttribute)!==void 0?o.converter:Lf;this._$Em=n,this[n]=a.fromAttribute(e,o.type),this._$Em=null}}requestUpdate(t,e,i){if(t!==void 0){if(i??(i=this.constructor.getPropertyOptions(t)),!(i.hasChanged??n0)(this[t],e))return;this.P(t,e,i)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(t,e,i){this._$AL.has(t)||this._$AL.set(t,e),i.reflect===!0&&this._$Em!==t&&(this._$Ej??(this._$Ej=new Set)).add(t)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[n,o]of this._$Ep)this[n]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[n,o]of s)o.wrapped!==!0||this._$AL.has(n)||this[n]===void 0||this.P(n,this[n],o)}let e=!1;const i=this._$AL;try{e=this.shouldUpdate(i),e?(this.willUpdate(i),(t=this._$EO)==null||t.forEach(s=>{var n;return(n=s.hostUpdate)==null?void 0:n.call(s)}),this.update(i)):this._$EU()}catch(s){throw e=!1,this._$EU(),s}e&&this._$AE(i)}willUpdate(t){}_$AE(t){var e;(e=this._$EO)==null||e.forEach(i=>{var s;return(s=i.hostUpdated)==null?void 0:s.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Ej&&(this._$Ej=this._$Ej.forEach(e=>this._$EC(e,this[e]))),this._$EU()}updated(t){}firstUpdated(t){}}Ua.elementStyles=[],Ua.shadowRootOptions={mode:"open"},Ua[dh("elementProperties")]=new Map,Ua[dh("finalized")]=new Map,kT?.({ReactiveElement:Ua}),(dc.reactiveElementVersions??(dc.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Mf=globalThis,Df=Mf.trustedTypes,zT=Df?Df.createPolicy("lit-html",{createHTML:r=>r}):void 0,hw="$lit$",cr=`lit$${Math.random().toFixed(9).slice(2)}$`,uw="?"+cr,r8=`<${uw}>`,No=document,Lh=()=>No.createComment(""),Mh=r=>r===null||typeof r!="object"&&typeof r!="function",r0=Array.isArray,o8=r=>r0(r)||typeof r?.[Symbol.iterator]=="function",tI=`[ 	
\f\r]`,jl=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,YT=/-->/g,GT=/>/g,eo=RegExp(`>|${tI}(?:([^\\s"'>=/]+)(${tI}*=${tI}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),HT=/'/g,$T=/"/g,dw=/^(?:script|style|textarea|title)$/i,a8=r=>(t,...e)=>({_$litType$:r,strings:t,values:e}),rt=a8(1),Po=Symbol.for("lit-noChange"),Se=Symbol.for("lit-nothing"),WT=new WeakMap,po=No.createTreeWalker(No,129);function fw(r,t){if(!r0(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return zT!==void 0?zT.createHTML(t):t}const c8=(r,t)=>{const e=r.length-1,i=[];let s,n=t===2?"<svg>":t===3?"<math>":"",o=jl;for(let a=0;a<e;a++){const c=r[a];let l,h,u=-1,d=0;for(;d<c.length&&(o.lastIndex=d,h=o.exec(c),h!==null);)d=o.lastIndex,o===jl?h[1]==="!--"?o=YT:h[1]!==void 0?o=GT:h[2]!==void 0?(dw.test(h[2])&&(s=RegExp("</"+h[2],"g")),o=eo):h[3]!==void 0&&(o=eo):o===eo?h[0]===">"?(o=s??jl,u=-1):h[1]===void 0?u=-2:(u=o.lastIndex-h[2].length,l=h[1],o=h[3]===void 0?eo:h[3]==='"'?$T:HT):o===$T||o===HT?o=eo:o===YT||o===GT?o=jl:(o=eo,s=void 0);const f=o===eo&&r[a+1].startsWith("/>")?" ":"";n+=o===jl?c+r8:u>=0?(i.push(l),c.slice(0,u)+hw+c.slice(u)+cr+f):c+cr+(u===-2?a:f)}return[fw(r,n+(r[e]||"<?>")+(t===2?"</svg>":t===3?"</math>":"")),i]};class Dh{constructor({strings:t,_$litType$:e},i){let s;this.parts=[];let n=0,o=0;const a=t.length-1,c=this.parts,[l,h]=c8(t,e);if(this.el=Dh.createElement(l,i),po.currentNode=this.el.content,e===2||e===3){const u=this.el.content.firstChild;u.replaceWith(...u.childNodes)}for(;(s=po.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const u of s.getAttributeNames())if(u.endsWith(hw)){const d=h[o++],f=s.getAttribute(u).split(cr),p=/([.?@])?(.*)/.exec(d);c.push({type:1,index:n,name:p[2],strings:f,ctor:p[1]==="."?h8:p[1]==="?"?u8:p[1]==="@"?d8:Fp}),s.removeAttribute(u)}else u.startsWith(cr)&&(c.push({type:6,index:n}),s.removeAttribute(u));if(dw.test(s.tagName)){const u=s.textContent.split(cr),d=u.length-1;if(d>0){s.textContent=Df?Df.emptyScript:"";for(let f=0;f<d;f++)s.append(u[f],Lh()),po.nextNode(),c.push({type:2,index:++n});s.append(u[d],Lh())}}}else if(s.nodeType===8)if(s.data===uw)c.push({type:2,index:n});else{let u=-1;for(;(u=s.data.indexOf(cr,u+1))!==-1;)c.push({type:7,index:n}),u+=cr.length-1}n++}}static createElement(t,e){const i=No.createElement("template");return i.innerHTML=t,i}}function fc(r,t,e=r,i){var s,n;if(t===Po)return t;let o=i!==void 0?(s=e._$Co)==null?void 0:s[i]:e._$Cl;const a=Mh(t)?void 0:t._$litDirective$;return o?.constructor!==a&&((n=o?._$AO)==null||n.call(o,!1),a===void 0?o=void 0:(o=new a(r),o._$AT(r,e,i)),i!==void 0?(e._$Co??(e._$Co=[]))[i]=o:e._$Cl=o),o!==void 0&&(t=fc(r,o._$AS(r,t.values),o,i)),t}class l8{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:e},parts:i}=this._$AD,s=(t?.creationScope??No).importNode(e,!0);po.currentNode=s;let n=po.nextNode(),o=0,a=0,c=i[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new ou(n,n.nextSibling,this,t):c.type===1?l=new c.ctor(n,c.name,c.strings,this,t):c.type===6&&(l=new f8(n,this,t)),this._$AV.push(l),c=i[++a]}o!==c?.index&&(n=po.nextNode(),o++)}return po.currentNode=No,s}p(t){let e=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}}class ou{get _$AU(){var t;return((t=this._$AM)==null?void 0:t._$AU)??this._$Cv}constructor(t,e,i,s){this.type=2,this._$AH=Se,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return e!==void 0&&t?.nodeType===11&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=fc(this,t,e),Mh(t)?t===Se||t==null||t===""?(this._$AH!==Se&&this._$AR(),this._$AH=Se):t!==this._$AH&&t!==Po&&this._(t):t._$litType$!==void 0?this.$(t):t.nodeType!==void 0?this.T(t):o8(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==Se&&Mh(this._$AH)?this._$AA.nextSibling.data=t:this.T(No.createTextNode(t)),this._$AH=t}$(t){var e;const{values:i,_$litType$:s}=t,n=typeof s=="number"?this._$AC(t):(s.el===void 0&&(s.el=Dh.createElement(fw(s.h,s.h[0]),this.options)),s);if(((e=this._$AH)==null?void 0:e._$AD)===n)this._$AH.p(i);else{const o=new l8(n,this),a=o.u(this.options);o.p(i),this.T(a),this._$AH=o}}_$AC(t){let e=WT.get(t.strings);return e===void 0&&WT.set(t.strings,e=new Dh(t)),e}k(t){r0(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,s=0;for(const n of t)s===e.length?e.push(i=new ou(this.O(Lh()),this.O(Lh()),this,this.options)):i=e[s],i._$AI(n),s++;s<e.length&&(this._$AR(i&&i._$AB.nextSibling,s),e.length=s)}_$AR(t=this._$AA.nextSibling,e){var i;for((i=this._$AP)==null?void 0:i.call(this,!1,!0,e);t&&t!==this._$AB;){const s=t.nextSibling;t.remove(),t=s}}setConnected(t){var e;this._$AM===void 0&&(this._$Cv=t,(e=this._$AP)==null||e.call(this,t))}}class Fp{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,e,i,s,n){this.type=1,this._$AH=Se,this._$AN=void 0,this.element=t,this.name=e,this._$AM=s,this.options=n,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=Se}_$AI(t,e=this,i,s){const n=this.strings;let o=!1;if(n===void 0)t=fc(this,t,e,0),o=!Mh(t)||t!==this._$AH&&t!==Po,o&&(this._$AH=t);else{const a=t;let c,l;for(t=n[0],c=0;c<n.length-1;c++)l=fc(this,a[i+c],e,c),l===Po&&(l=this._$AH[c]),o||(o=!Mh(l)||l!==this._$AH[c]),l===Se?t=Se:t!==Se&&(t+=(l??"")+n[c+1]),this._$AH[c]=l}o&&!s&&this.j(t)}j(t){t===Se?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class h8 extends Fp{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===Se?void 0:t}}class u8 extends Fp{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==Se)}}class d8 extends Fp{constructor(t,e,i,s,n){super(t,e,i,s,n),this.type=5}_$AI(t,e=this){if((t=fc(this,t,e,0)??Se)===Po)return;const i=this._$AH,s=t===Se&&i!==Se||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,n=t!==Se&&(i===Se||s);s&&this.element.removeEventListener(this.name,this,i),n&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e;typeof this._$AH=="function"?this._$AH.call(((e=this.options)==null?void 0:e.host)??this.element,t):this._$AH.handleEvent(t)}}class f8{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){fc(this,t)}}const jT=Mf.litHtmlPolyfillSupport;jT?.(Dh,ou),(Mf.litHtmlVersions??(Mf.litHtmlVersions=[])).push("3.2.1");const pc=(r,t,e)=>{const i=e?.renderBefore??t;let s=i._$litPart$;if(s===void 0){const n=e?.renderBefore??null;i._$litPart$=s=new ou(t.insertBefore(Lh(),n),n,void 0,e??{})}return s._$AI(r),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let qt=class extends Ua{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var r;const t=super.createRenderRoot();return(r=this.renderOptions).renderBefore??(r.renderBefore=t.firstChild),t}update(r){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(r),this._$Do=pc(t,this.renderRoot,this.renderOptions)}connectedCallback(){var r;super.connectedCallback(),(r=this._$Do)==null||r.setConnected(!0)}disconnectedCallback(){var r;super.disconnectedCallback(),(r=this._$Do)==null||r.setConnected(!1)}render(){return Po}};var XT;qt._$litElement$=!0,qt.finalized=!0,(XT=globalThis.litElementHydrateSupport)==null||XT.call(globalThis,{LitElement:qt});const ZT=globalThis.litElementPolyfillSupport;ZT?.({LitElement:qt});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const p8={attribute:!0,type:String,converter:Lf,reflect:!1,hasChanged:n0},m8=(r=p8,t,e)=>{const{kind:i,metadata:s}=e;let n=globalThis.litPropertyMetadata.get(s);if(n===void 0&&globalThis.litPropertyMetadata.set(s,n=new Map),n.set(e.name,r),i==="accessor"){const{name:o}=e;return{set(a){const c=t.get.call(this);t.set.call(this,a),this.requestUpdate(o,c,r)},init(a){return a!==void 0&&this.P(o,void 0,r),a}}}if(i==="setter"){const{name:o}=e;return function(a){const c=this[o];t.call(this,a),this.requestUpdate(o,c,r)}}throw Error("Unsupported decorator location: "+i)};function dt(r){return(t,e)=>typeof e=="object"?m8(r,t,e):((i,s,n)=>{const o=s.hasOwnProperty(n);return s.constructor.createProperty(n,o?{...i,wrapped:!0}:i),o?Object.getOwnPropertyDescriptor(s,n):void 0})(r,t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Zc(r){return dt({...r,state:!0,attribute:!1})}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const I8=r=>r.strings===void 0;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const pw={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},mw=r=>(...t)=>({_$litDirective$:r,values:t});let Iw=class{constructor(r){}get _$AU(){return this._$AM._$AU}_$AT(r,t,e){this._$Ct=r,this._$AM=t,this._$Ci=e}_$AS(r,t){return this.update(r,t)}update(r,t){return this.render(...t)}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const fh=(r,t)=>{var e;const i=r._$AN;if(i===void 0)return!1;for(const s of i)(e=s._$AO)==null||e.call(s,t,!1),fh(s,t);return!0},Uf=r=>{let t,e;do{if((t=r._$AM)===void 0)break;e=t._$AN,e.delete(r),r=t}while(e?.size===0)},gw=r=>{for(let t;t=r._$AM;r=t){let e=t._$AN;if(e===void 0)t._$AN=e=new Set;else if(e.has(r))break;e.add(r),C8(t)}};function g8(r){this._$AN!==void 0?(Uf(this),this._$AM=r,gw(this)):this._$AM=r}function E8(r,t=!1,e=0){const i=this._$AH,s=this._$AN;if(s!==void 0&&s.size!==0)if(t)if(Array.isArray(i))for(let n=e;n<i.length;n++)fh(i[n],!1),Uf(i[n]);else i!=null&&(fh(i,!1),Uf(i));else fh(this,r)}const C8=r=>{r.type==pw.CHILD&&(r._$AP??(r._$AP=E8),r._$AQ??(r._$AQ=g8))};class b8 extends Iw{constructor(){super(...arguments),this._$AN=void 0}_$AT(t,e,i){super._$AT(t,e,i),gw(this),this.isConnected=t._$AU}_$AO(t,e=!0){var i,s;t!==this.isConnected&&(this.isConnected=t,t?(i=this.reconnected)==null||i.call(this):(s=this.disconnected)==null||s.call(this)),e&&(fh(this,t),Uf(this))}setValue(t){if(I8(this._$Ct))this._$Ct._$AI(t,this);else{const e=[...this._$Ct._$AH];e[this._$Ci]=t,this._$Ct._$AI(e,this,0)}}disconnected(){}reconnected(){}}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const mc=()=>new T8;class T8{}const eI=new WeakMap,ai=mw(class extends b8{render(r){return Se}update(r,[t]){var e;const i=t!==this.Y;return i&&this.Y!==void 0&&this.rt(void 0),(i||this.lt!==this.ct)&&(this.Y=t,this.ht=(e=r.options)==null?void 0:e.host,this.rt(this.ct=r.element)),Se}rt(r){if(this.isConnected||(r=void 0),typeof this.Y=="function"){const t=this.ht??globalThis;let e=eI.get(t);e===void 0&&(e=new WeakMap,eI.set(t,e)),e.get(this.Y)!==void 0&&this.Y.call(this.ht,void 0),e.set(this.Y,r),r!==void 0&&this.Y.call(this.ht,r)}else this.Y.value=r}get lt(){var r,t;return typeof this.Y=="function"?(r=eI.get(this.ht??globalThis))==null?void 0:r.get(this.Y):(t=this.Y)==null?void 0:t.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}});/**
* (c) Iconify
*
* For the full copyright and license information, please view the license.txt
* files at https://github.com/iconify/iconify
*
* Licensed under MIT.
*
* @license MIT
* @version 2.0.0
*/const Ew=Object.freeze({left:0,top:0,width:16,height:16}),Bf=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),au=Object.freeze({...Ew,...Bf}),Lg=Object.freeze({...au,body:"",hidden:!1}),y8=Object.freeze({width:null,height:null}),Cw=Object.freeze({...y8,...Bf});function v8(r,t=0){const e=r.replace(/^-?[0-9.]*/,"");function i(s){for(;s<0;)s+=4;return s%4}if(e===""){const s=parseInt(r);return isNaN(s)?0:i(s)}else if(e!==r){let s=0;switch(e){case"%":s=25;break;case"deg":s=90}if(s){let n=parseFloat(r.slice(0,r.length-e.length));return isNaN(n)?0:(n=n/s,n%1===0?i(n):0)}}return t}const R8=/[\s,]+/;function A8(r,t){t.split(R8).forEach(e=>{switch(e.trim()){case"horizontal":r.hFlip=!0;break;case"vertical":r.vFlip=!0;break}})}const bw={...Cw,preserveAspectRatio:""};function qT(r){const t={...bw},e=(i,s)=>r.getAttribute(i)||s;return t.width=e("width",null),t.height=e("height",null),t.rotate=v8(e("rotate","")),A8(t,e("flip","")),t.preserveAspectRatio=e("preserveAspectRatio",e("preserveaspectratio","")),t}function S8(r,t){for(const e in bw)if(r[e]!==t[e])return!0;return!1}const ph=/^[a-z0-9]+(-[a-z0-9]+)*$/,cu=(r,t,e,i="")=>{const s=r.split(":");if(r.slice(0,1)==="@"){if(s.length<2||s.length>3)return null;i=s.shift().slice(1)}if(s.length>3||!s.length)return null;if(s.length>1){const a=s.pop(),c=s.pop(),l={provider:s.length>0?s[0]:i,prefix:c,name:a};return t&&!hf(l)?null:l}const n=s[0],o=n.split("-");if(o.length>1){const a={provider:i,prefix:o.shift(),name:o.join("-")};return t&&!hf(a)?null:a}if(e&&i===""){const a={provider:i,prefix:"",name:n};return t&&!hf(a,e)?null:a}return null},hf=(r,t)=>r?!!((r.provider===""||r.provider.match(ph))&&(t&&r.prefix===""||r.prefix.match(ph))&&r.name.match(ph)):!1;function w8(r,t){const e={};!r.hFlip!=!t.hFlip&&(e.hFlip=!0),!r.vFlip!=!t.vFlip&&(e.vFlip=!0);const i=((r.rotate||0)+(t.rotate||0))%4;return i&&(e.rotate=i),e}function QT(r,t){const e=w8(r,t);for(const i in Lg)i in Bf?i in r&&!(i in e)&&(e[i]=Bf[i]):i in t?e[i]=t[i]:i in r&&(e[i]=r[i]);return e}function _8(r,t){const e=r.icons,i=r.aliases||Object.create(null),s=Object.create(null);function n(o){if(e[o])return s[o]=[];if(!(o in s)){s[o]=null;const a=i[o]&&i[o].parent,c=a&&n(a);c&&(s[o]=[a].concat(c))}return s[o]}return Object.keys(e).concat(Object.keys(i)).forEach(n),s}function F8(r,t,e){const i=r.icons,s=r.aliases||Object.create(null);let n={};function o(a){n=QT(i[a]||s[a],n)}return o(t),e.forEach(o),QT(r,n)}function Tw(r,t){const e=[];if(typeof r!="object"||typeof r.icons!="object")return e;r.not_found instanceof Array&&r.not_found.forEach(s=>{t(s,null),e.push(s)});const i=_8(r);for(const s in i){const n=i[s];n&&(t(s,F8(r,s,n)),e.push(s))}return e}const O8={provider:"",aliases:{},not_found:{},...Ew};function iI(r,t){for(const e in t)if(e in r&&typeof r[e]!=typeof t[e])return!1;return!0}function yw(r){if(typeof r!="object"||r===null)return null;const t=r;if(typeof t.prefix!="string"||!r.icons||typeof r.icons!="object"||!iI(r,O8))return null;const e=t.icons;for(const s in e){const n=e[s];if(!s.match(ph)||typeof n.body!="string"||!iI(n,Lg))return null}const i=t.aliases||Object.create(null);for(const s in i){const n=i[s],o=n.parent;if(!s.match(ph)||typeof o!="string"||!e[o]&&!i[o]||!iI(n,Lg))return null}return t}const kf=Object.create(null);function x8(r,t){return{provider:r,prefix:t,icons:Object.create(null),missing:new Set}}function Or(r,t){const e=kf[r]||(kf[r]=Object.create(null));return e[t]||(e[t]=x8(r,t))}function o0(r,t){return yw(t)?Tw(t,(e,i)=>{i?r.icons[e]=i:r.missing.add(e)}):[]}function N8(r,t,e){try{if(typeof e.body=="string")return r.icons[t]={...e},!0}catch{}return!1}function P8(r,t){let e=[];return(typeof r=="string"?[r]:Object.keys(kf)).forEach(i=>{(typeof i=="string"&&typeof t=="string"?[t]:Object.keys(kf[i]||{})).forEach(s=>{const n=Or(i,s);e=e.concat(Object.keys(n.icons).map(o=>(i!==""?"@"+i+":":"")+s+":"+o))})}),e}let Uh=!1;function vw(r){return typeof r=="boolean"&&(Uh=r),Uh}function Bh(r){const t=typeof r=="string"?cu(r,!0,Uh):r;if(t){const e=Or(t.provider,t.prefix),i=t.name;return e.icons[i]||(e.missing.has(i)?null:void 0)}}function Rw(r,t){const e=cu(r,!0,Uh);if(!e)return!1;const i=Or(e.provider,e.prefix);return N8(i,e.name,t)}function KT(r,t){if(typeof r!="object")return!1;if(typeof t!="string"&&(t=r.provider||""),Uh&&!t&&!r.prefix){let s=!1;return yw(r)&&(r.prefix="",Tw(r,(n,o)=>{o&&Rw(n,o)&&(s=!0)})),s}const e=r.prefix;if(!hf({provider:t,prefix:e,name:"a"}))return!1;const i=Or(t,e);return!!o0(i,r)}function JT(r){return!!Bh(r)}function L8(r){const t=Bh(r);return t?{...au,...t}:null}function M8(r){const t={loaded:[],missing:[],pending:[]},e=Object.create(null);r.sort((s,n)=>s.provider!==n.provider?s.provider.localeCompare(n.provider):s.prefix!==n.prefix?s.prefix.localeCompare(n.prefix):s.name.localeCompare(n.name));let i={provider:"",prefix:"",name:""};return r.forEach(s=>{if(i.name===s.name&&i.prefix===s.prefix&&i.provider===s.provider)return;i=s;const n=s.provider,o=s.prefix,a=s.name,c=e[n]||(e[n]=Object.create(null)),l=c[o]||(c[o]=Or(n,o));let h;a in l.icons?h=t.loaded:o===""||l.missing.has(a)?h=t.missing:h=t.pending;const u={provider:n,prefix:o,name:a};h.push(u)}),t}function Aw(r,t){r.forEach(e=>{const i=e.loaderCallbacks;i&&(e.loaderCallbacks=i.filter(s=>s.id!==t))})}function D8(r){r.pendingCallbacksFlag||(r.pendingCallbacksFlag=!0,setTimeout(()=>{r.pendingCallbacksFlag=!1;const t=r.loaderCallbacks?r.loaderCallbacks.slice(0):[];if(!t.length)return;let e=!1;const i=r.provider,s=r.prefix;t.forEach(n=>{const o=n.icons,a=o.pending.length;o.pending=o.pending.filter(c=>{if(c.prefix!==s)return!0;const l=c.name;if(r.icons[l])o.loaded.push({provider:i,prefix:s,name:l});else if(r.missing.has(l))o.missing.push({provider:i,prefix:s,name:l});else return e=!0,!0;return!1}),o.pending.length!==a&&(e||Aw([r],n.id),n.callback(o.loaded.slice(0),o.missing.slice(0),o.pending.slice(0),n.abort))})}))}let U8=0;function B8(r,t,e){const i=U8++,s=Aw.bind(null,e,i);if(!t.pending.length)return s;const n={id:i,icons:t,callback:r,abort:s};return e.forEach(o=>{(o.loaderCallbacks||(o.loaderCallbacks=[])).push(n)}),s}const Mg=Object.create(null);function ty(r,t){Mg[r]=t}function Dg(r){return Mg[r]||Mg[""]}function k8(r,t=!0,e=!1){const i=[];return r.forEach(s=>{const n=typeof s=="string"?cu(s,t,e):s;n&&i.push(n)}),i}var V8={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function z8(r,t,e,i){const s=r.resources.length,n=r.random?Math.floor(Math.random()*s):r.index;let o;if(r.random){let A=r.resources.slice(0);for(o=[];A.length>1;){const S=Math.floor(Math.random()*A.length);o.push(A[S]),A=A.slice(0,S).concat(A.slice(S+1))}o=o.concat(A)}else o=r.resources.slice(n).concat(r.resources.slice(0,n));const a=Date.now();let c="pending",l=0,h,u=null,d=[],f=[];typeof i=="function"&&f.push(i);function p(){u&&(clearTimeout(u),u=null)}function m(){c==="pending"&&(c="aborted"),p(),d.forEach(A=>{A.status==="pending"&&(A.status="aborted")}),d=[]}function g(A,S){S&&(f=[]),typeof A=="function"&&f.push(A)}function I(){return{startTime:a,payload:t,status:c,queriesSent:l,queriesPending:d.length,subscribe:g,abort:m}}function C(){c="failed",f.forEach(A=>{A(void 0,h)})}function b(){d.forEach(A=>{A.status==="pending"&&(A.status="aborted")}),d=[]}function E(A,S,_){const w=S!=="success";switch(d=d.filter(F=>F!==A),c){case"pending":break;case"failed":if(w||!r.dataAfterTimeout)return;break;default:return}if(S==="abort"){h=_,C();return}if(w){h=_,d.length||(o.length?T():C());return}if(p(),b(),!r.random){const F=r.resources.indexOf(A.resource);F!==-1&&F!==r.index&&(r.index=F)}c="completed",f.forEach(F=>{F(_)})}function T(){if(c!=="pending")return;p();const A=o.shift();if(A===void 0){if(d.length){u=setTimeout(()=>{p(),c==="pending"&&(b(),C())},r.timeout);return}C();return}const S={status:"pending",resource:A,callback:(_,w)=>{E(S,_,w)}};d.push(S),l++,u=setTimeout(T,r.rotate),e(A,t,S.callback)}return setTimeout(T),I}function Sw(r){const t={...V8,...r};let e=[];function i(){e=e.filter(o=>o().status==="pending")}function s(o,a,c){const l=z8(t,o,a,(h,u)=>{i(),c&&c(h,u)});return e.push(l),l}function n(o){return e.find(a=>o(a))||null}return{query:s,find:n,setIndex:o=>{t.index=o},getIndex:()=>t.index,cleanup:i}}function a0(r){let t;if(typeof r.resources=="string")t=[r.resources];else if(t=r.resources,!(t instanceof Array)||!t.length)return null;return{resources:t,path:r.path||"/",maxURL:r.maxURL||500,rotate:r.rotate||750,timeout:r.timeout||5e3,random:r.random===!0,index:r.index||0,dataAfterTimeout:r.dataAfterTimeout!==!1}}const Op=Object.create(null),zd=["https://api.simplesvg.com","https://api.unisvg.com"],Ug=[];for(;zd.length>0;)zd.length===1||Math.random()>.5?Ug.push(zd.shift()):Ug.push(zd.pop());Op[""]=a0({resources:["https://api.iconify.design"].concat(Ug)});function ey(r,t){const e=a0(t);return e===null?!1:(Op[r]=e,!0)}function xp(r){return Op[r]}function Y8(){return Object.keys(Op)}function iy(){}const sI=Object.create(null);function G8(r){if(!sI[r]){const t=xp(r);if(!t)return;const e=Sw(t),i={config:t,redundancy:e};sI[r]=i}return sI[r]}function ww(r,t,e){let i,s;if(typeof r=="string"){const n=Dg(r);if(!n)return e(void 0,424),iy;s=n.send;const o=G8(r);o&&(i=o.redundancy)}else{const n=a0(r);if(n){i=Sw(n);const o=r.resources?r.resources[0]:"",a=Dg(o);a&&(s=a.send)}}return!i||!s?(e(void 0,424),iy):i.query(t,s,e)().abort}const sy="iconify2",kh="iconify",_w=kh+"-count",ny=kh+"-version",Fw=36e5,H8=168,$8=50;function Bg(r,t){try{return r.getItem(t)}catch{}}function c0(r,t,e){try{return r.setItem(t,e),!0}catch{}}function ry(r,t){try{r.removeItem(t)}catch{}}function kg(r,t){return c0(r,_w,t.toString())}function Vg(r){return parseInt(Bg(r,_w))||0}const Co={local:!0,session:!0},Ow={local:new Set,session:new Set};let l0=!1;function W8(r){l0=r}let Yd=typeof window>"u"?{}:window;function xw(r){const t=r+"Storage";try{if(Yd&&Yd[t]&&typeof Yd[t].length=="number")return Yd[t]}catch{}Co[r]=!1}function Nw(r,t){const e=xw(r);if(!e)return;const i=Bg(e,ny);if(i!==sy){if(i){const a=Vg(e);for(let c=0;c<a;c++)ry(e,kh+c.toString())}c0(e,ny,sy),kg(e,0);return}const s=Math.floor(Date.now()/Fw)-H8,n=a=>{const c=kh+a.toString(),l=Bg(e,c);if(typeof l=="string"){try{const h=JSON.parse(l);if(typeof h=="object"&&typeof h.cached=="number"&&h.cached>s&&typeof h.provider=="string"&&typeof h.data=="object"&&typeof h.data.prefix=="string"&&t(h,a))return!0}catch{}ry(e,c)}};let o=Vg(e);for(let a=o-1;a>=0;a--)n(a)||(a===o-1?(o--,kg(e,o)):Ow[r].add(a))}function Pw(){if(!l0){W8(!0);for(const r in Co)Nw(r,t=>{const e=t.data,i=t.provider,s=e.prefix,n=Or(i,s);if(!o0(n,e).length)return!1;const o=e.lastModified||-1;return n.lastModifiedCached=n.lastModifiedCached?Math.min(n.lastModifiedCached,o):o,!0})}}function j8(r,t){const e=r.lastModifiedCached;if(e&&e>=t)return e===t;if(r.lastModifiedCached=t,e)for(const i in Co)Nw(i,s=>{const n=s.data;return s.provider!==r.provider||n.prefix!==r.prefix||n.lastModified===t});return!0}function X8(r,t){l0||Pw();function e(i){let s;if(!Co[i]||!(s=xw(i)))return;const n=Ow[i];let o;if(n.size)n.delete(o=Array.from(n).shift());else if(o=Vg(s),o>=$8||!kg(s,o+1))return;const a={cached:Math.floor(Date.now()/Fw),provider:r.provider,data:t};return c0(s,kh+o.toString(),JSON.stringify(a))}t.lastModified&&!j8(r,t.lastModified)||Object.keys(t.icons).length&&(t.not_found&&(t=Object.assign({},t),delete t.not_found),e("local")||e("session"))}function oy(){}function Z8(r){r.iconsLoaderFlag||(r.iconsLoaderFlag=!0,setTimeout(()=>{r.iconsLoaderFlag=!1,D8(r)}))}function q8(r,t){r.iconsToLoad?r.iconsToLoad=r.iconsToLoad.concat(t).sort():r.iconsToLoad=t,r.iconsQueueFlag||(r.iconsQueueFlag=!0,setTimeout(()=>{r.iconsQueueFlag=!1;const{provider:e,prefix:i}=r,s=r.iconsToLoad;delete r.iconsToLoad;let n;!s||!(n=Dg(e))||n.prepare(e,i,s).forEach(o=>{ww(e,o,a=>{if(typeof a!="object")o.icons.forEach(c=>{r.missing.add(c)});else try{const c=o0(r,a);if(!c.length)return;const l=r.pendingIcons;l&&c.forEach(h=>{l.delete(h)}),X8(r,a)}catch(c){console.error(c)}Z8(r)})})}))}const h0=(r,t)=>{const e=k8(r,!0,vw()),i=M8(e);if(!i.pending.length){let c=!0;return t&&setTimeout(()=>{c&&t(i.loaded,i.missing,i.pending,oy)}),()=>{c=!1}}const s=Object.create(null),n=[];let o,a;return i.pending.forEach(c=>{const{provider:l,prefix:h}=c;if(h===a&&l===o)return;o=l,a=h,n.push(Or(l,h));const u=s[l]||(s[l]=Object.create(null));u[h]||(u[h]=[])}),i.pending.forEach(c=>{const{provider:l,prefix:h,name:u}=c,d=Or(l,h),f=d.pendingIcons||(d.pendingIcons=new Set);f.has(u)||(f.add(u),s[l][h].push(u))}),n.forEach(c=>{const{provider:l,prefix:h}=c;s[l][h].length&&q8(c,s[l][h])}),t?B8(t,i,n):oy},Q8=r=>new Promise((t,e)=>{const i=typeof r=="string"?cu(r,!0):r;if(!i){e(r);return}h0([i||r],s=>{if(s.length&&i){const n=Bh(i);if(n){t({...au,...n});return}}e(r)})});function K8(r){try{const t=typeof r=="string"?JSON.parse(r):r;if(typeof t.body=="string")return{...t}}catch{}}function J8(r,t){const e=typeof r=="string"?cu(r,!0,!0):null;if(!e){const n=K8(r);return{value:r,data:n}}const i=Bh(e);if(i!==void 0||!e.prefix)return{value:r,name:e,data:i};const s=h0([e],()=>t(r,e,Bh(e)));return{value:r,name:e,loading:s}}function nI(r){return r.hasAttribute("inline")}let Lw=!1;try{Lw=navigator.vendor.indexOf("Apple")===0}catch{}function tB(r,t){switch(t){case"svg":case"bg":case"mask":return t}return t!=="style"&&(Lw||r.indexOf("<a")===-1)?"svg":r.indexOf("currentColor")===-1?"bg":"mask"}const eB=/(-?[0-9.]*[0-9]+[0-9.]*)/g,iB=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function zg(r,t,e){if(t===1)return r;if(e=e||100,typeof r=="number")return Math.ceil(r*t*e)/e;if(typeof r!="string")return r;const i=r.split(eB);if(i===null||!i.length)return r;const s=[];let n=i.shift(),o=iB.test(n);for(;;){if(o){const a=parseFloat(n);isNaN(a)?s.push(n):s.push(Math.ceil(a*t*e)/e)}else s.push(n);if(n=i.shift(),n===void 0)return s.join("");o=!o}}function sB(r,t="defs"){let e="";const i=r.indexOf("<"+t);for(;i>=0;){const s=r.indexOf(">",i),n=r.indexOf("</"+t);if(s===-1||n===-1)break;const o=r.indexOf(">",n);if(o===-1)break;e+=r.slice(s+1,n).trim(),r=r.slice(0,i).trim()+r.slice(o+1)}return{defs:e,content:r}}function nB(r,t){return r?"<defs>"+r+"</defs>"+t:t}function rB(r,t,e){const i=sB(r);return nB(i.defs,t+i.content+e)}const oB=r=>r==="unset"||r==="undefined"||r==="none";function Mw(r,t){const e={...au,...r},i={...Cw,...t},s={left:e.left,top:e.top,width:e.width,height:e.height};let n=e.body;[e,i].forEach(m=>{const g=[],I=m.hFlip,C=m.vFlip;let b=m.rotate;I?C?b+=2:(g.push("translate("+(s.width+s.left).toString()+" "+(0-s.top).toString()+")"),g.push("scale(-1 1)"),s.top=s.left=0):C&&(g.push("translate("+(0-s.left).toString()+" "+(s.height+s.top).toString()+")"),g.push("scale(1 -1)"),s.top=s.left=0);let E;switch(b<0&&(b-=Math.floor(b/4)*4),b=b%4,b){case 1:E=s.height/2+s.top,g.unshift("rotate(90 "+E.toString()+" "+E.toString()+")");break;case 2:g.unshift("rotate(180 "+(s.width/2+s.left).toString()+" "+(s.height/2+s.top).toString()+")");break;case 3:E=s.width/2+s.left,g.unshift("rotate(-90 "+E.toString()+" "+E.toString()+")");break}b%2===1&&(s.left!==s.top&&(E=s.left,s.left=s.top,s.top=E),s.width!==s.height&&(E=s.width,s.width=s.height,s.height=E)),g.length&&(n=rB(n,'<g transform="'+g.join(" ")+'">',"</g>"))});const o=i.width,a=i.height,c=s.width,l=s.height;let h,u;o===null?(u=a===null?"1em":a==="auto"?l:a,h=zg(u,c/l)):(h=o==="auto"?c:o,u=a===null?zg(h,l/c):a==="auto"?l:a);const d={},f=(m,g)=>{oB(g)||(d[m]=g.toString())};f("width",h),f("height",u);const p=[s.left,s.top,c,l];return d.viewBox=p.join(" "),{attributes:d,viewBox:p,body:n}}function u0(r,t){let e=r.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const i in t)e+=" "+i+'="'+t[i]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+e+">"+r+"</svg>"}function aB(r){return r.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function cB(r){return"data:image/svg+xml,"+aB(r)}function Dw(r){return'url("'+cB(r)+'")'}const lB=()=>{let r;try{if(r=fetch,typeof r=="function")return r}catch{}};let Vf=lB();function hB(r){Vf=r}function uB(){return Vf}function dB(r,t){const e=xp(r);if(!e)return 0;let i;if(!e.maxURL)i=0;else{let s=0;e.resources.forEach(o=>{s=Math.max(s,o.length)});const n=t+".json?icons=";i=e.maxURL-s-e.path.length-n.length}return i}function fB(r){return r===404}const pB=(r,t,e)=>{const i=[],s=dB(r,t),n="icons";let o={type:n,provider:r,prefix:t,icons:[]},a=0;return e.forEach((c,l)=>{a+=c.length+1,a>=s&&l>0&&(i.push(o),o={type:n,provider:r,prefix:t,icons:[]},a=c.length),o.icons.push(c)}),i.push(o),i};function mB(r){if(typeof r=="string"){const t=xp(r);if(t)return t.path}return"/"}const IB=(r,t,e)=>{if(!Vf){e("abort",424);return}let i=mB(t.provider);switch(t.type){case"icons":{const n=t.prefix,o=t.icons.join(","),a=new URLSearchParams({icons:o});i+=n+".json?"+a.toString();break}case"custom":{const n=t.uri;i+=n.slice(0,1)==="/"?n.slice(1):n;break}default:e("abort",400);return}let s=503;Vf(r+i).then(n=>{const o=n.status;if(o!==200){setTimeout(()=>{e(fB(o)?"abort":"next",o)});return}return s=501,n.json()}).then(n=>{if(typeof n!="object"||n===null){setTimeout(()=>{n===404?e("abort",n):e("next",s)});return}setTimeout(()=>{e("success",n)})}).catch(()=>{e("next",s)})},gB={prepare:pB,send:IB};function ay(r,t){switch(r){case"local":case"session":Co[r]=t;break;case"all":for(const e in Co)Co[e]=t;break}}const rI="data-style";let Uw="";function EB(r){Uw=r}function cy(r,t){let e=Array.from(r.childNodes).find(i=>i.hasAttribute&&i.hasAttribute(rI));e||(e=document.createElement("style"),e.setAttribute(rI,rI),r.appendChild(e)),e.textContent=":host{display:inline-block;vertical-align:"+(t?"-0.125em":"0")+"}span,svg{display:block}"+Uw}function Bw(){ty("",gB),vw(!0);let r;try{r=window}catch{}if(r){if(Pw(),r.IconifyPreload!==void 0){const t=r.IconifyPreload,e="Invalid IconifyPreload syntax.";typeof t=="object"&&t!==null&&(t instanceof Array?t:[t]).forEach(i=>{try{(typeof i!="object"||i===null||i instanceof Array||typeof i.icons!="object"||typeof i.prefix!="string"||!KT(i))&&console.error(e)}catch{console.error(e)}})}if(r.IconifyProviders!==void 0){const t=r.IconifyProviders;if(typeof t=="object"&&t!==null)for(const e in t){const i="IconifyProviders["+e+"] is invalid.";try{const s=t[e];if(typeof s!="object"||!s||s.resources===void 0)continue;ey(e,s)||console.error(i)}catch{console.error(i)}}}}return{enableCache:t=>ay(t,!0),disableCache:t=>ay(t,!1),iconLoaded:JT,iconExists:JT,getIcon:L8,listIcons:P8,addIcon:Rw,addCollection:KT,calculateSize:zg,buildIcon:Mw,iconToHTML:u0,svgToURL:Dw,loadIcons:h0,loadIcon:Q8,addAPIProvider:ey,appendCustomStyle:EB,_api:{getAPIConfig:xp,setAPIModule:ty,sendAPIQuery:ww,setFetch:hB,getFetch:uB,listAPIProviders:Y8}}}const Yg={"background-color":"currentColor"},kw={"background-color":"transparent"},ly={image:"var(--svg)",repeat:"no-repeat",size:"100% 100%"},hy={"-webkit-mask":Yg,mask:Yg,background:kw};for(const r in hy){const t=hy[r];for(const e in ly)t[r+"-"+e]=ly[e]}function uy(r){return r?r+(r.match(/^[-0-9.]+$/)?"px":""):"inherit"}function CB(r,t,e){const i=document.createElement("span");let s=r.body;s.indexOf("<a")!==-1&&(s+="<!-- "+Date.now()+" -->");const n=r.attributes,o=u0(s,{...n,width:t.width+"",height:t.height+""}),a=Dw(o),c=i.style,l={"--svg":a,width:uy(n.width),height:uy(n.height),...e?Yg:kw};for(const h in l)c.setProperty(h,l[h]);return i}let mh;function bB(){try{mh=window.trustedTypes.createPolicy("iconify",{createHTML:r=>r})}catch{mh=null}}function TB(r){return mh===void 0&&bB(),mh?mh.createHTML(r):r}function yB(r){const t=document.createElement("span"),e=r.attributes;let i="";e.width||(i="width: inherit;"),e.height||(i+="height: inherit;"),i&&(e.style=i);const s=u0(r.body,e);return t.innerHTML=TB(s),t.firstChild}function Gg(r){return Array.from(r.childNodes).find(t=>{const e=t.tagName&&t.tagName.toUpperCase();return e==="SPAN"||e==="SVG"})}function dy(r,t){const e=t.icon.data,i=t.customisations,s=Mw(e,i);i.preserveAspectRatio&&(s.attributes.preserveAspectRatio=i.preserveAspectRatio);const n=t.renderedMode;let o;switch(n){case"svg":o=yB(s);break;default:o=CB(s,{...au,...e},n==="mask")}const a=Gg(r);a?o.tagName==="SPAN"&&a.tagName===o.tagName?a.setAttribute("style",o.getAttribute("style")):r.replaceChild(o,a):r.appendChild(o)}function fy(r,t,e){const i=e&&(e.rendered?e:e.lastRender);return{rendered:!1,inline:t,icon:r,lastRender:i}}function vB(r="iconify-icon"){let t,e;try{t=window.customElements,e=window.HTMLElement}catch{return}if(!t||!e)return;const i=t.get(r);if(i)return i;const s=["icon","mode","inline","observe","width","height","rotate","flip"],n=class extends e{constructor(){super(),to(this,"_shadowRoot"),to(this,"_initialised",!1),to(this,"_state"),to(this,"_checkQueued",!1),to(this,"_connected",!1),to(this,"_observer",null),to(this,"_visible",!0);const a=this._shadowRoot=this.attachShadow({mode:"open"}),c=nI(this);cy(a,c),this._state=fy({value:""},c),this._queueCheck()}connectedCallback(){this._connected=!0,this.startObserver()}disconnectedCallback(){this._connected=!1,this.stopObserver()}static get observedAttributes(){return s.slice(0)}attributeChangedCallback(a){switch(a){case"inline":{const c=nI(this),l=this._state;c!==l.inline&&(l.inline=c,cy(this._shadowRoot,c));break}case"observer":{this.observer?this.startObserver():this.stopObserver();break}default:this._queueCheck()}}get icon(){const a=this.getAttribute("icon");if(a&&a.slice(0,1)==="{")try{return JSON.parse(a)}catch{}return a}set icon(a){typeof a=="object"&&(a=JSON.stringify(a)),this.setAttribute("icon",a)}get inline(){return nI(this)}set inline(a){a?this.setAttribute("inline","true"):this.removeAttribute("inline")}get observer(){return this.hasAttribute("observer")}set observer(a){a?this.setAttribute("observer","true"):this.removeAttribute("observer")}restartAnimation(){const a=this._state;if(a.rendered){const c=this._shadowRoot;if(a.renderedMode==="svg")try{c.lastChild.setCurrentTime(0);return}catch{}dy(c,a)}}get status(){const a=this._state;return a.rendered?"rendered":a.icon.data===null?"failed":"loading"}_queueCheck(){this._checkQueued||(this._checkQueued=!0,setTimeout(()=>{this._check()}))}_check(){if(!this._checkQueued)return;this._checkQueued=!1;const a=this._state,c=this.getAttribute("icon");if(c!==a.icon.value){this._iconChanged(c);return}if(!a.rendered||!this._visible)return;const l=this.getAttribute("mode"),h=qT(this);(a.attrMode!==l||S8(a.customisations,h)||!Gg(this._shadowRoot))&&this._renderIcon(a.icon,h,l)}_iconChanged(a){const c=J8(a,(l,h,u)=>{const d=this._state;if(d.rendered||this.getAttribute("icon")!==l)return;const f={value:l,name:h,data:u};f.data?this._gotIconData(f):d.icon=f});c.data?this._gotIconData(c):this._state=fy(c,this._state.inline,this._state)}_forceRender(){if(!this._visible){const a=Gg(this._shadowRoot);a&&this._shadowRoot.removeChild(a);return}this._queueCheck()}_gotIconData(a){this._checkQueued=!1,this._renderIcon(a,qT(this),this.getAttribute("mode"))}_renderIcon(a,c,l){const h=tB(a.data.body,l),u=this._state.inline;dy(this._shadowRoot,this._state={rendered:!0,icon:a,inline:u,customisations:c,attrMode:l,renderedMode:h})}startObserver(){if(!this._observer)try{this._observer=new IntersectionObserver(a=>{const c=a.some(l=>l.isIntersecting);c!==this._visible&&(this._visible=c,this._forceRender())}),this._observer.observe(this)}catch{if(this._observer){try{this._observer.disconnect()}catch{}this._observer=null}}}stopObserver(){this._observer&&(this._observer.disconnect(),this._observer=null,this._visible=!0,this._connected&&this._forceRender())}};s.forEach(a=>{a in n.prototype||Object.defineProperty(n.prototype,a,{get:function(){return this.getAttribute(a)},set:function(c){c!==null?this.setAttribute(a,c):this.removeAttribute(a)}})});const o=Bw();for(const a in o)n[a]=n.prototype[a]=o[a];return t.define(r,n),n}vB()||Bw();const RB=te`
  ::-webkit-scrollbar {
    width: 0.4rem;
    height: 0.4rem;
    overflow: hidden;
  }

  ::-webkit-scrollbar-thumb {
    border-radius: 0.25rem;
    background-color: var(
      --bim-scrollbar--c,
      color-mix(in lab, var(--bim-ui_main-base), white 15%)
    );
  }

  ::-webkit-scrollbar-track {
    background-color: var(--bim-scrollbar--bgc, var(--bim-ui_bg-base));
  }
`,AB=te`
  :root {
    /* Grayscale Colors */
    --bim-ui_gray-0: hsl(210 10% 5%);
    --bim-ui_gray-1: hsl(210 10% 10%);
    --bim-ui_gray-2: hsl(210 10% 20%);
    --bim-ui_gray-3: hsl(210 10% 30%);
    --bim-ui_gray-4: hsl(210 10% 40%);
    --bim-ui_gray-6: hsl(210 10% 60%);
    --bim-ui_gray-7: hsl(210 10% 70%);
    --bim-ui_gray-8: hsl(210 10% 80%);
    --bim-ui_gray-9: hsl(210 10% 90%);
    --bim-ui_gray-10: hsl(210 10% 95%);

    /* Brand Colors */
    --bim-ui_main-base: #6528d7;
    --bim-ui_accent-base: #bcf124;

    /* Brand Colors Contrasts */
    --bim-ui_main-contrast: var(--bim-ui_gray-10);
    --bim-ui_accent-contrast: var(--bim-ui_gray-0);

    /* Sizes */
    --bim-ui_size-4xs: 0.375rem;
    --bim-ui_size-3xs: 0.5rem;
    --bim-ui_size-2xs: 0.625rem;
    --bim-ui_size-xs: 0.75rem;
    --bim-ui_size-sm: 0.875rem;
    --bim-ui_size-base: 1rem;
    --bim-ui_size-lg: 1.125rem;
    --bim-ui_size-xl: 1.25rem;
    --bim-ui_size-2xl: 1.375rem;
    --bim-ui_size-3xl: 1.5rem;
    --bim-ui_size-4xl: 1.625rem;
    --bim-ui_size-5xl: 1.75rem;
    --bim-ui_size-6xl: 1.875rem;
    --bim-ui_size-7xl: 2rem;
    --bim-ui_size-8xl: 2.125rem;
    --bim-ui_size-9xl: 2.25rem;
  }

  /* Background Colors */
  @media (prefers-color-scheme: dark) {
    :root {
      --bim-ui_bg-base: var(--bim-ui_gray-0);
      --bim-ui_bg-contrast-10: var(--bim-ui_gray-1);
      --bim-ui_bg-contrast-20: var(--bim-ui_gray-2);
      --bim-ui_bg-contrast-30: var(--bim-ui_gray-3);
      --bim-ui_bg-contrast-40: var(--bim-ui_gray-4);
      --bim-ui_bg-contrast-60: var(--bim-ui_gray-6);
      --bim-ui_bg-contrast-80: var(--bim-ui_gray-8);
      --bim-ui_bg-contrast-100: var(--bim-ui_gray-10);
    }
  }

  @media (prefers-color-scheme: light) {
    :root {
      --bim-ui_bg-base: var(--bim-ui_gray-10);
      --bim-ui_bg-contrast-10: var(--bim-ui_gray-9);
      --bim-ui_bg-contrast-20: var(--bim-ui_gray-8);
      --bim-ui_bg-contrast-30: var(--bim-ui_gray-7);
      --bim-ui_bg-contrast-40: var(--bim-ui_gray-6);
      --bim-ui_bg-contrast-60: var(--bim-ui_gray-4);
      --bim-ui_bg-contrast-80: var(--bim-ui_gray-2);
      --bim-ui_bg-contrast-100: var(--bim-ui_gray-0);
      --bim-ui_accent-base: #6528d7;
    }
  }

  html.bim-ui-dark {
    --bim-ui_bg-base: var(--bim-ui_gray-0);
    --bim-ui_bg-contrast-10: var(--bim-ui_gray-1);
    --bim-ui_bg-contrast-20: var(--bim-ui_gray-2);
    --bim-ui_bg-contrast-30: var(--bim-ui_gray-3);
    --bim-ui_bg-contrast-40: var(--bim-ui_gray-4);
    --bim-ui_bg-contrast-60: var(--bim-ui_gray-6);
    --bim-ui_bg-contrast-80: var(--bim-ui_gray-8);
    --bim-ui_bg-contrast-100: var(--bim-ui_gray-10);
  }

  html.bim-ui-light {
    --bim-ui_bg-base: var(--bim-ui_gray-10);
    --bim-ui_bg-contrast-10: var(--bim-ui_gray-9);
    --bim-ui_bg-contrast-20: var(--bim-ui_gray-8);
    --bim-ui_bg-contrast-30: var(--bim-ui_gray-7);
    --bim-ui_bg-contrast-40: var(--bim-ui_gray-6);
    --bim-ui_bg-contrast-60: var(--bim-ui_gray-4);
    --bim-ui_bg-contrast-80: var(--bim-ui_gray-2);
    --bim-ui_bg-contrast-100: var(--bim-ui_gray-0);
    --bim-ui_accent-base: #6528d7;
  }

  [data-context-dialog]::backdrop {
    background-color: transparent;
  }
`,kr={scrollbar:RB,globalStyles:AB},Vw=class $t{static set config(t){this._config={...$t._config,...t}}static get config(){return $t._config}static addGlobalStyles(){let t=document.querySelector("style[id='bim-ui']");if(t)return;t=document.createElement("style"),t.id="bim-ui",t.textContent=kr.globalStyles.cssText;const e=document.head.firstChild;e?document.head.insertBefore(t,e):document.head.append(t)}static defineCustomElement(t,e){customElements.get(t)||customElements.define(t,e)}static registerComponents(){$t.init()}static init(){$t.addGlobalStyles(),$t.defineCustomElement("bim-button",xB),$t.defineCustomElement("bim-checkbox",qc),$t.defineCustomElement("bim-color-input",Wo),$t.defineCustomElement("bim-context-menu",$g),$t.defineCustomElement("bim-dropdown",Gn),$t.defineCustomElement("bim-grid",f0),$t.defineCustomElement("bim-icon",kB),$t.defineCustomElement("bim-input",hu),$t.defineCustomElement("bim-label",Kc),$t.defineCustomElement("bim-number-input",Li),$t.defineCustomElement("bim-option",He),$t.defineCustomElement("bim-panel",jo),$t.defineCustomElement("bim-panel-section",Jc),$t.defineCustomElement("bim-selector",tl),$t.defineCustomElement("bim-table",ps),$t.defineCustomElement("bim-tabs",Zo),$t.defineCustomElement("bim-tab",Bi),$t.defineCustomElement("bim-table-cell",e_),$t.defineCustomElement("bim-table-children",s_),$t.defineCustomElement("bim-table-group",r_),$t.defineCustomElement("bim-table-row",Xo),$t.defineCustomElement("bim-text-input",ms),$t.defineCustomElement("bim-toolbar",Up),$t.defineCustomElement("bim-toolbar-group",Mp),$t.defineCustomElement("bim-toolbar-section",sl),$t.defineCustomElement("bim-viewport",I_)}static newRandomId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let i=0;i<10;i++){const s=Math.floor(Math.random()*t.length);e+=t.charAt(s)}return e}};Vw._config={sectionLabelOnVerticalToolbar:!1};let Oi=Vw;class Be extends qt{constructor(){super(...arguments),this._lazyLoadObserver=null,this._visibleElements=[],this.ELEMENTS_BEFORE_OBSERVER=20,this.useObserver=!1,this.elements=new Set,this.observe=t=>{if(!this.useObserver)return;for(const i of t)this.elements.add(i);const e=t.slice(this.ELEMENTS_BEFORE_OBSERVER);for(const i of e)i.remove();this.observeLastElement()}}set visibleElements(t){this._visibleElements=this.useObserver?t:[],this.requestUpdate()}get visibleElements(){return this._visibleElements}getLazyObserver(){if(!this.useObserver)return null;if(this._lazyLoadObserver)return this._lazyLoadObserver;const t=new IntersectionObserver(e=>{const i=e[0];if(!i.isIntersecting)return;const s=i.target;t.unobserve(s);const n=this.ELEMENTS_BEFORE_OBSERVER+this.visibleElements.length,o=[...this.elements][n];o&&(this.visibleElements=[...this.visibleElements,o],t.observe(o))},{threshold:.5});return t}observeLastElement(){const t=this.getLazyObserver();if(!t)return;const e=this.ELEMENTS_BEFORE_OBSERVER+this.visibleElements.length-1,i=[...this.elements][e];i&&t.observe(i)}resetVisibleElements(){const t=this.getLazyObserver();if(t){for(const e of this.elements)t.unobserve(e);this.visibleElements=[],this.observeLastElement()}}static create(t,e){const i=document.createDocumentFragment();if(t.length===0)return pc(t(),i),i.firstElementChild;if(!e)throw new Error("UIComponent: Initial state is required for statefull components.");let s=e;const n=t,o=c=>(s={...s,...c},pc(n(s,o),i),s);o(e);const a=()=>s;return[i.firstElementChild,o,a]}}const Vh=(r,t={},e=!0)=>{let i={};for(const s of r.children){const n=s,o=n.getAttribute("name")||n.getAttribute("label"),a=t[o];if(o){if("value"in n&&typeof n.value<"u"&&n.value!==null){const c=n.value;if(typeof c=="object"&&!Array.isArray(c)&&Object.keys(c).length===0)continue;i[o]=a?a(n.value):n.value}else if(e){const c=Vh(n,t);if(Object.keys(c).length===0)continue;i[o]=a?a(c):c}}else e&&(i={...i,...Vh(n,t)})}return i},Np=r=>r==="true"||r==="false"?r==="true":r&&!isNaN(Number(r))&&r.trim()!==""?Number(r):r,SB=[">=","<=","=",">","<","?","/","#"];function py(r){const t=SB.find(o=>r.split(o).length===2),e=r.split(t).map(o=>o.trim()),[i,s]=e,n=s.startsWith("'")&&s.endsWith("'")?s.replace(/'/g,""):Np(s);return{key:i,condition:t,value:n}}const Hg=r=>{try{const t=[],e=r.split(/&(?![^()]*\))/).map(i=>i.trim());for(const i of e){const s=!i.startsWith("(")&&!i.endsWith(")"),n=i.startsWith("(")&&i.endsWith(")");if(s){const o=py(i);t.push(o)}if(n){const o={operator:"&",queries:i.replace(/^(\()|(\))$/g,"").split("&").map(a=>a.trim()).map((a,c)=>{const l=py(a);return c>0&&(l.operator="&"),l})};t.push(o)}}return t}catch{return null}},my=(r,t,e)=>{let i=!1;switch(t){case"=":i=r===e;break;case"?":i=String(r).includes(String(e));break;case"<":(typeof r=="number"||typeof e=="number")&&(i=r<e);break;case"<=":(typeof r=="number"||typeof e=="number")&&(i=r<=e);break;case">":(typeof r=="number"||typeof e=="number")&&(i=r>e);break;case">=":(typeof r=="number"||typeof e=="number")&&(i=r>=e);break;case"/":i=String(r).startsWith(String(e));break}return i};var wB=Object.defineProperty,_B=Object.getOwnPropertyDescriptor,zw=(r,t,e,i)=>{for(var s=_B(t,e),n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&wB(t,e,s),s},Ve;const d0=(Ve=class extends qt{constructor(){super(...arguments),this._previousContainer=null,this._visible=!1}get placement(){return this._placement}set placement(r){this._placement=r,this.updatePosition()}static removeMenus(){for(const r of Ve.menus)r instanceof Ve&&(r.visible=!1);Ve.dialog.close(),Ve.dialog.remove()}get visible(){return this._visible}set visible(r){var t;this._visible=r,r?(Ve.dialog.parentElement||document.body.append(Ve.dialog),this._previousContainer=this.parentElement,Ve.dialog.style.top=`${window.scrollY||document.documentElement.scrollTop}px`,Ve.dialog.append(this),Ve.dialog.showModal(),this.updatePosition(),this.dispatchEvent(new Event("visible"))):((t=this._previousContainer)==null||t.append(this),this._previousContainer=null,this.dispatchEvent(new Event("hidden")))}async updatePosition(){if(!(this.visible&&this._previousContainer))return;const r=this.placement??"right",t=await cw(this._previousContainer,this,{placement:r,middleware:[XS(10),aw(),ow(),rw({padding:5})]}),{x:e,y:i}=t;this.style.left=`${e}px`,this.style.top=`${i}px`}connectedCallback(){super.connectedCallback(),Ve.menus.push(this)}render(){return rt` <slot></slot> `}},Ve.styles=[kr.scrollbar,te`
      :host {
        pointer-events: auto;
        position: absolute;
        top: 0;
        left: 0;
        z-index: 999;
        overflow: auto;
        max-height: 20rem;
        min-width: 3rem;
        flex-direction: column;
        box-shadow: 1px 2px 8px 2px rgba(0, 0, 0, 0.15);
        padding: 0.5rem;
        border-radius: var(--bim-ui_size-4xs);
        display: flex;
        background-color: var(
          --bim-context-menu--bgc,
          var(--bim-ui_bg-contrast-20)
        );
      }

      :host(:not([visible])) {
        display: none;
      }
    `],Ve.dialog=Be.create(()=>rt` <dialog
      @click=${r=>{r.target===Ve.dialog&&Ve.removeMenus()}}
      @cancel=${()=>Ve.removeMenus()}
      data-context-dialog
      style="
      width: 0;
      height: 0;
      position: relative;
      padding: 0;
      border: none;
      outline: none;
      margin: none;
      overflow: visible;
      background-color: transparent;
    "
    ></dialog>`),Ve.menus=[],Ve);zw([dt({type:String,reflect:!0})],d0.prototype,"placement");zw([dt({type:Boolean,reflect:!0})],d0.prototype,"visible");let $g=d0;var FB=Object.defineProperty,OB=Object.getOwnPropertyDescriptor,Ds=(r,t,e,i)=>{for(var s=i>1?void 0:i?OB(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&FB(t,e,s),s},Xl;const ds=(Xl=class extends qt{constructor(){super(),this.labelHidden=!1,this.active=!1,this.disabled=!1,this.vertical=!1,this.tooltipVisible=!1,this._stateBeforeLoading={disabled:!1,icon:""},this._loading=!1,this._parent=mc(),this._tooltip=mc(),this._mouseLeave=!1,this.onClick=r=>{r.stopPropagation(),this.disabled||this.dispatchEvent(new Event("click"))},this.showContextMenu=()=>{const r=this._contextMenu;if(r){const t=this.getAttribute("data-context-group");t&&r.setAttribute("data-context-group",t),this.closeNestedContexts();const e=Oi.newRandomId();for(const i of r.children)i instanceof Xl&&i.setAttribute("data-context-group",e);r.visible=!0}},this.mouseLeave=!0}set loading(r){if(this._loading=r,r)this._stateBeforeLoading={disabled:this.disabled,icon:this.icon},this.disabled=r,this.icon="eos-icons:loading";else{const{disabled:t,icon:e}=this._stateBeforeLoading;this.disabled=t,this.icon=e}}get loading(){return this._loading}set mouseLeave(r){this._mouseLeave=r,r&&(this.tooltipVisible=!1,clearTimeout(this.timeoutID))}get mouseLeave(){return this._mouseLeave}computeTooltipPosition(){const{value:r}=this._parent,{value:t}=this._tooltip;r&&t&&cw(r,t,{placement:"bottom",middleware:[XS(10),aw(),ow(),rw({padding:5})]}).then(e=>{const{x:i,y:s}=e;Object.assign(t.style,{left:`${i}px`,top:`${s}px`})})}onMouseEnter(){if(!(this.tooltipTitle||this.tooltipText))return;this.mouseLeave=!1;const r=this.tooltipTime??700;this.timeoutID=setTimeout(()=>{this.mouseLeave||(this.computeTooltipPosition(),this.tooltipVisible=!0)},r)}closeNestedContexts(){const r=this.getAttribute("data-context-group");if(r)for(const t of $g.dialog.children){const e=t.getAttribute("data-context-group");if(t instanceof $g&&e===r){t.visible=!1,t.removeAttribute("data-context-group");for(const i of t.children)i instanceof Xl&&(i.closeNestedContexts(),i.removeAttribute("data-context-group"))}}}click(){this.disabled||super.click()}get _contextMenu(){return this.querySelector("bim-context-menu")}connectedCallback(){super.connectedCallback(),this.addEventListener("click",this.showContextMenu)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("click",this.showContextMenu)}render(){const r=rt`
      <div ${ai(this._tooltip)} class="tooltip">
        ${this.tooltipTitle?rt`<p style="text-wrap: nowrap;">
              <strong>${this.tooltipTitle}</strong>
            </p>`:null}
        ${this.tooltipText?rt`<p style="width: 9rem;">${this.tooltipText}</p>`:null}
      </div>
    `,t=rt`<svg
      xmlns="http://www.w3.org/2000/svg"
      height="1.125rem"
      viewBox="0 0 24 24"
      width="1.125rem"
      style="fill: var(--bim-label--c)"
    >
      <path d="M0 0h24v24H0V0z" fill="none" />
      <path d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z" />
    </svg>`;return rt`
      <div ${ai(this._parent)} class="parent" @click=${this.onClick}>
        ${this.label||this.icon?rt`
              <div
                class="button"
                @mouseenter=${this.onMouseEnter}
                @mouseleave=${()=>this.mouseLeave=!0}
              >
                <bim-label
                  .icon=${this.icon}
                  .vertical=${this.vertical}
                  .labelHidden=${this.labelHidden}
                  >${this.label}${this.label&&this._contextMenu?t:null}</bim-label
                >
              </div>
            `:null}
        ${this.tooltipTitle||this.tooltipText?r:null}
      </div>
      <slot></slot>
    `}},Xl.styles=te`
    :host {
      --bim-label--c: var(--bim-ui_bg-contrast-100, white);
      display: block;
      flex: 1;
      pointer-events: none;
      background-color: var(--bim-button--bgc, var(--bim-ui_bg-contrast-20));
      border-radius: var(--bim-ui_size-4xs);
      transition: all 0.15s;
    }

    :host(:not([disabled]):hover) {
      cursor: pointer;
    }

    bim-label {
      pointer-events: none;
    }

    .parent {
      --bim-icon--c: var(--bim-label--c);
      position: relative;
      display: flex;
      height: 100%;
      user-select: none;
      row-gap: 0.125rem;
      min-height: var(--bim-ui_size-5xl);
      min-width: var(--bim-ui_size-5xl);
    }

    .button,
    .children {
      box-sizing: border-box;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: auto;
    }

    .children {
      padding: 0 0.375rem;
      position: absolute;
      height: 100%;
      right: 0;
    }

    :host(:not([label-hidden])[icon][vertical]) .parent {
      min-height: 2.5rem;
    }

    .button {
      flex-grow: 1;
    }

    :host(:not([label-hidden])[label]) .button {
      justify-content: var(--bim-button--jc, center);
    }

    :host(:hover),
    :host([active]) {
      --bim-label--c: var(--bim-ui_main-contrast);
      background-color: var(--bim-ui_main-base);
    }

    :host(:not([label]):not([icon])) .children {
      flex: 1;
    }

    :host([vertical]) .parent {
      justify-content: center;
    }

    :host(:not([label-hidden])[label]) .button {
      padding: 0 0.5rem;
    }

    :host([disabled]) {
      --bim-label--c: var(--bim-ui_bg-contrast-80) !important;
      background-color: gray !important;
    }

    ::slotted(bim-button) {
      --bim-icon--fz: var(--bim-ui_size-base);
      --bim-button--bdrs: var(--bim-ui_size-4xs);
      --bim-button--olw: 0;
      --bim-button--olc: transparent;
    }

    .tooltip {
      position: absolute;
      padding: 0.75rem;
      z-index: 99;
      display: flex;
      flex-flow: column;
      row-gap: 0.375rem;
      box-shadow: 0 0 10px 3px rgba(0 0 0 / 20%);
      outline: 1px solid var(--bim-ui_bg-contrast-40);
      font-size: var(--bim-ui_size-xs);
      border-radius: var(--bim-ui_size-4xs);
      background-color: var(--bim-ui_bg-contrast-20);
      color: var(--bim-ui_bg-contrast-100);
    }

    .tooltip p {
      margin: 0;
      padding: 0;
    }

    :host(:not([tooltip-visible])) .tooltip {
      display: none;
    }
  `,Xl);Ds([dt({type:String,reflect:!0})],ds.prototype,"label",2);Ds([dt({type:Boolean,attribute:"label-hidden",reflect:!0})],ds.prototype,"labelHidden",2);Ds([dt({type:Boolean,reflect:!0})],ds.prototype,"active",2);Ds([dt({type:Boolean,reflect:!0,attribute:"disabled"})],ds.prototype,"disabled",2);Ds([dt({type:String,reflect:!0})],ds.prototype,"icon",2);Ds([dt({type:Boolean,reflect:!0})],ds.prototype,"vertical",2);Ds([dt({type:Number,attribute:"tooltip-time",reflect:!0})],ds.prototype,"tooltipTime",2);Ds([dt({type:Boolean,attribute:"tooltip-visible",reflect:!0})],ds.prototype,"tooltipVisible",2);Ds([dt({type:String,attribute:"tooltip-title",reflect:!0})],ds.prototype,"tooltipTitle",2);Ds([dt({type:String,attribute:"tooltip-text",reflect:!0})],ds.prototype,"tooltipText",2);Ds([dt({type:Boolean,reflect:!0})],ds.prototype,"loading",1);let xB=ds;var NB=Object.defineProperty,lu=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&NB(t,e,s),s};const Yw=class extends qt{constructor(){super(...arguments),this.checked=!1,this.inverted=!1,this.onValueChange=new Event("change")}get value(){return this.checked}onChange(r){r.stopPropagation(),this.checked=r.target.checked,this.dispatchEvent(this.onValueChange)}render(){return rt`
      <div class="parent">
        ${this.label?rt`<bim-label .icon="${this.icon}">${this.label}</bim-label> `:null}
        <input
          type="checkbox"
          aria-label=${this.label||this.name||"Checkbox Input"}
          @change="${this.onChange}"
          .checked="${this.checked}"
        />
      </div>
    `}};Yw.styles=te`
    :host {
      display: block;
    }

    .parent {
      display: flex;
      justify-content: space-between;
      height: 1.75rem;
      column-gap: 0.25rem;
      width: 100%;
      align-items: center;
      transition: all 0.15s;
    }

    :host([inverted]) .parent {
      flex-direction: row-reverse;
      justify-content: start;
    }

    input {
      height: 1rem;
      width: 1rem;
      cursor: pointer;
      border: none;
      outline: none;
      accent-color: var(--bim-checkbox--c, var(--bim-ui_main-base));
      transition: all 0.15s;
    }

    input:focus {
      outline: var(--bim-checkbox--olw, 2px) solid
        var(--bim-checkbox--olc, var(--bim-ui_accent-base));
    }
  `;let qc=Yw;lu([dt({type:String,reflect:!0})],qc.prototype,"icon");lu([dt({type:String,reflect:!0})],qc.prototype,"name");lu([dt({type:String,reflect:!0})],qc.prototype,"label");lu([dt({type:Boolean,reflect:!0})],qc.prototype,"checked");lu([dt({type:Boolean,reflect:!0})],qc.prototype,"inverted");var PB=Object.defineProperty,Qc=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&PB(t,e,s),s};const Gw=class extends qt{constructor(){super(...arguments),this.vertical=!1,this.color="#bcf124",this._colorInput=mc(),this._textInput=mc(),this.onValueChange=new Event("input"),this.onOpacityInput=r=>{const t=r.target;this.opacity=t.value,this.dispatchEvent(this.onValueChange)}}set value(r){const{color:t,opacity:e}=r;this.color=t,e&&(this.opacity=e)}get value(){const r={color:this.color};return this.opacity&&(r.opacity=this.opacity),r}onColorInput(r){r.stopPropagation();const{value:t}=this._colorInput;t&&(this.color=t.value,this.dispatchEvent(this.onValueChange))}onTextInput(r){r.stopPropagation();const{value:t}=this._textInput;if(!t)return;const{value:e}=t;let i=e.replace(/[^a-fA-F0-9]/g,"");i.startsWith("#")||(i=`#${i}`),t.value=i.slice(0,7),t.value.length===7&&(this.color=t.value,this.dispatchEvent(this.onValueChange))}focus(){const{value:r}=this._colorInput;r&&r.click()}render(){return rt`
      <div class="parent">
        <bim-input
          .label=${this.label}
          .icon=${this.icon}
          .vertical="${this.vertical}"
        >
          <div class="color-container">
            <div
              style="display: flex; align-items: center; gap: .375rem; height: 100%; flex: 1; padding: 0 0.5rem;"
            >
              <input
                ${ai(this._colorInput)}
                @input="${this.onColorInput}"
                type="color"
                aria-label=${this.label||this.name||"Color Input"}
                value="${this.color}"
              />
              <div
                @click=${this.focus}
                class="sample"
                style="background-color: ${this.color}"
              ></div>
              <input
                ${ai(this._textInput)}
                @input="${this.onTextInput}"
                value="${this.color}"
                type="text"
                aria-label=${this.label||this.name||"Text Color Input"}
              />
            </div>
            ${this.opacity!==void 0?rt`<bim-number-input
                  @change=${this.onOpacityInput}
                  slider
                  suffix="%"
                  min="0"
                  value=${this.opacity}
                  max="100"
                ></bim-number-input>`:null}
          </div>
        </bim-input>
      </div>
    `}};Gw.styles=te`
    :host {
      --bim-input--bgc: var(--bim-ui_bg-contrast-20);
      flex: 1;
      display: block;
    }

    :host(:focus) {
      --bim-input--olw: var(--bim-number-input--olw, 2px);
      --bim-input--olc: var(--bim-ui_accent-base);
    }

    .parent {
      display: flex;
      gap: 0.375rem;
    }

    .color-container {
      position: relative;
      outline: none;
      display: flex;
      height: 100%;
      gap: 0.5rem;
      justify-content: flex-start;
      align-items: center;
      flex: 1;
      border-radius: var(--bim-color-input--bdrs, var(--bim-ui_size-4xs));
    }

    .color-container input[type="color"] {
      position: absolute;
      bottom: -0.25rem;
      visibility: hidden;
      width: 0;
      height: 0;
    }

    .color-container .sample {
      width: 1rem;
      height: 1rem;
      border-radius: 0.125rem;
      background-color: #fff;
    }

    .color-container input[type="text"] {
      height: 100%;
      flex: 1;
      width: 3.25rem;
      text-transform: uppercase;
      font-size: 0.75rem;
      background-color: transparent;
      padding: 0%;
      outline: none;
      border: none;
      color: var(--bim-color-input--c, var(--bim-ui_bg-contrast-100));
    }

    bim-number-input {
      flex-grow: 0;
    }
  `;let Wo=Gw;Qc([dt({type:String,reflect:!0})],Wo.prototype,"name");Qc([dt({type:String,reflect:!0})],Wo.prototype,"label");Qc([dt({type:String,reflect:!0})],Wo.prototype,"icon");Qc([dt({type:Boolean,reflect:!0})],Wo.prototype,"vertical");Qc([dt({type:Number,reflect:!0})],Wo.prototype,"opacity");Qc([dt({type:String,reflect:!0})],Wo.prototype,"color");var LB=Object.defineProperty,MB=Object.getOwnPropertyDescriptor,Vr=(r,t,e,i)=>{for(var s=i>1?void 0:i?MB(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&LB(t,e,s),s};const Hw=class extends qt{constructor(){super(...arguments),this.checked=!1,this.checkbox=!1,this.noMark=!1,this.vertical=!1}get value(){return this._value!==void 0?this._value:this.label?Np(this.label):this.label}set value(r){this._value=r}render(){return rt`
      <div class="parent" .title=${this.label??""}>
        ${this.img||this.icon||this.label?rt` <div style="display: flex; column-gap: 0.375rem">
              ${this.checkbox&&!this.noMark?rt`<bim-checkbox
                    style="pointer-events: none"
                    .checked=${this.checked}
                  ></bim-checkbox>`:null}
              <bim-label
                .vertical=${this.vertical}
                .icon=${this.icon}
                .img=${this.img}
                >${this.label}</bim-label
              >
            </div>`:null}
        ${!this.checkbox&&!this.noMark&&this.checked?rt`<svg
              xmlns="http://www.w3.org/2000/svg"
              height="1.125rem"
              viewBox="0 0 24 24"
              width="1.125rem"
              fill="#FFFFFF"
            >
              <path d="M0 0h24v24H0z" fill="none" />
              <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
            </svg>`:null}
        <slot></slot>
      </div>
    `}};Hw.styles=te`
    :host {
      --bim-label--c: var(--bim-ui_bg-contrast-100);
      display: block;
      box-sizing: border-box;
      flex: 1;
      padding: 0rem 0.5rem;
      border-radius: var(--bim-ui_size-4xs);
      transition: all 0.15s;
    }

    :host(:hover) {
      cursor: pointer;
      background-color: color-mix(
        in lab,
        var(--bim-selector--bgc, var(--bim-ui_bg-contrast-20)),
        var(--bim-ui_main-base) 10%
      );
    }

    :host([checked]) {
      --bim-label--c: color-mix(in lab, var(--bim-ui_main-base), white 30%);
    }

    :host([checked]) svg {
      fill: color-mix(in lab, var(--bim-ui_main-base), white 30%);
    }

    .parent {
      box-sizing: border-box;
      display: flex;
      justify-content: var(--bim-option--jc, space-between);
      column-gap: 0.5rem;
      align-items: center;
      min-height: 1.75rem;
      height: 100%;
    }

    input {
      height: 1rem;
      width: 1rem;
      cursor: pointer;
      border: none;
      outline: none;
      accent-color: var(--bim-checkbox--c, var(--bim-ui_main-base));
    }

    input:focus {
      outline: var(--bim-checkbox--olw, 2px) solid
        var(--bim-checkbox--olc, var(--bim-ui_accent-base));
    }

    bim-label {
      pointer-events: none;
    }
  `;let He=Hw;Vr([dt({type:String,reflect:!0})],He.prototype,"img",2);Vr([dt({type:String,reflect:!0})],He.prototype,"label",2);Vr([dt({type:String,reflect:!0})],He.prototype,"icon",2);Vr([dt({type:Boolean,reflect:!0})],He.prototype,"checked",2);Vr([dt({type:Boolean,reflect:!0})],He.prototype,"checkbox",2);Vr([dt({type:Boolean,attribute:"no-mark",reflect:!0})],He.prototype,"noMark",2);Vr([dt({converter:{fromAttribute(r){return r&&Np(r)}}})],He.prototype,"value",1);Vr([dt({type:Boolean,reflect:!0})],He.prototype,"vertical",2);var DB=Object.defineProperty,UB=Object.getOwnPropertyDescriptor,zr=(r,t,e,i)=>{for(var s=i>1?void 0:i?UB(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&DB(t,e,s),s};const $w=class extends Be{constructor(){super(),this.multiple=!1,this.required=!1,this.vertical=!1,this._visible=!1,this._value=new Set,this.onValueChange=new Event("change"),this._contextMenu=mc(),this.onOptionClick=r=>{const t=r.target,e=this._value.has(t);if(!this.multiple&&!this.required&&!e)this._value=new Set([t]);else if(!this.multiple&&!this.required&&e)this._value=new Set([]);else if(!this.multiple&&this.required&&!e)this._value=new Set([t]);else if(this.multiple&&!this.required&&!e)this._value=new Set([...this._value,t]);else if(this.multiple&&!this.required&&e){const i=[...this._value].filter(s=>s!==t);this._value=new Set(i)}else if(this.multiple&&this.required&&!e)this._value=new Set([...this._value,t]);else if(this.multiple&&this.required&&e){const i=[...this._value].filter(n=>n!==t),s=new Set(i);s.size!==0&&(this._value=s)}this.updateOptionsState(),this.dispatchEvent(this.onValueChange)},this.useObserver=!0}set visible(r){if(r){const{value:t}=this._contextMenu;if(!t)return;for(const e of this.elements)t.append(e);this._visible=!0}else{for(const t of this.elements)this.append(t);this._visible=!1,this.resetVisibleElements()}}get visible(){return this._visible}set value(r){if(this.required&&Object.keys(r).length===0)return;const t=new Set;for(const e of r){const i=this.findOption(e);if(i&&(t.add(i),!this.multiple&&Object.keys(r).length===1))break}this._value=t,this.updateOptionsState(),this.dispatchEvent(this.onValueChange)}get value(){return[...this._value].filter(r=>r instanceof He&&r.checked).map(r=>r.value)}get _options(){const r=new Set([...this.elements]);for(const t of this.children)t instanceof He&&r.add(t);return[...r]}onSlotChange(r){const t=r.target.assignedElements();this.observe(t);const e=new Set;for(const i of this.elements){if(!(i instanceof He)){i.remove();continue}i.checked&&e.add(i),i.removeEventListener("click",this.onOptionClick),i.addEventListener("click",this.onOptionClick)}this._value=e}updateOptionsState(){for(const r of this._options)r instanceof He&&(r.checked=this._value.has(r))}findOption(r){return this._options.find(t=>t instanceof He?t.label===r||t.value===r:!1)}render(){let r,t,e;if(this._value.size===0)r="Select an option...";else if(this._value.size===1){const i=[...this._value][0];r=i?.label||i?.value,t=i?.img,e=i?.icon}else r=`Multiple (${this._value.size})`;return rt`
      <bim-input
        title=${this.label??""}
        .label=${this.label}
        .icon=${this.icon}
        .vertical=${this.vertical}
      >
        <div class="input" @click=${()=>this.visible=!this.visible}>
          <bim-label
            .img=${t}
            .icon=${e}
            style="overflow: hidden;"
            >${r}</bim-label
          >
          <svg
            style="flex-shrink: 0; fill: var(--bim-dropdown--c, var(--bim-ui_bg-contrast-100))"
            xmlns="http://www.w3.org/2000/svg"
            height="1.125rem"
            viewBox="0 0 24 24"
            width="1.125rem"
            fill="#9ca3af"
          >
            <path d="M0 0h24v24H0V0z" fill="none" />
            <path d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z" />
          </svg>
          <bim-context-menu
            ${ai(this._contextMenu)}
            .visible=${this.visible}
            @hidden=${()=>{this.visible&&(this.visible=!1)}}
          >
            <slot @slotchange=${this.onSlotChange}></slot>
          </bim-context-menu>
        </div>
      </bim-input>
    `}};$w.styles=[kr.scrollbar,te`
      :host {
        --bim-input--bgc: var(
          --bim-dropdown--bgc,
          var(--bim-ui_bg-contrast-20)
        );
        --bim-input--olw: 2px;
        --bim-input--olc: transparent;
        --bim-input--bdrs: var(--bim-ui_size-4xs);
        flex: 1;
        display: block;
      }

      :host([visible]) {
        --bim-input--olc: var(--bim-ui_accent-base);
      }

      .input {
        --bim-label--fz: var(--bim-drodown--fz, var(--bim-ui_size-xs));
        --bim-label--c: var(--bim-dropdown--c, var(--bim-ui_bg-contrast-100));
        height: 100%;
        display: flex;
        flex: 1;
        overflow: hidden;
        column-gap: 0.25rem;
        outline: none;
        cursor: pointer;
        align-items: center;
        justify-content: space-between;
        padding: 0 0.5rem;
      }

      bim-label {
        pointer-events: none;
      }
    `];let Gn=$w;zr([dt({type:String,reflect:!0})],Gn.prototype,"name",2);zr([dt({type:String,reflect:!0})],Gn.prototype,"icon",2);zr([dt({type:String,reflect:!0})],Gn.prototype,"label",2);zr([dt({type:Boolean,reflect:!0})],Gn.prototype,"multiple",2);zr([dt({type:Boolean,reflect:!0})],Gn.prototype,"required",2);zr([dt({type:Boolean,reflect:!0})],Gn.prototype,"vertical",2);zr([dt({type:Boolean,reflect:!0})],Gn.prototype,"visible",1);zr([Zc()],Gn.prototype,"_value",2);var BB=Object.defineProperty,Ww=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&BB(t,e,s),s};const jw=class extends qt{constructor(){super(...arguments),this.floating=!1,this._layouts={},this._updateFunctions={}}set layouts(r){this._layouts=r;const t={};for(const[e,i]of Object.entries(r))for(const s in i.elements)t[e]||(t[e]={}),t[e][s]=n=>{const o=this._updateFunctions[e];if(!o)return;const a=o[s];a&&a(n)};this.updateComponent=t}get layouts(){return this._layouts}getLayoutAreas(r){const{template:t}=r,e=t.split(`
`).map(i=>i.trim()).map(i=>i.split('"')[1]).filter(i=>i!==void 0).flatMap(i=>i.split(/\s+/));return[...new Set(e)].filter(i=>i!=="")}firstUpdated(){this._onLayoutChange=new Event("layoutchange")}render(){if(this.layout){if(this._updateFunctions={},this.layouts[this.layout]){this.innerHTML="",this._updateFunctions[this.layout]={};const r=this._updateFunctions[this.layout],t=this.layouts[this.layout],e=this.getLayoutAreas(t).map(i=>{const s=t.elements[i];if(!s)return null;if(s instanceof HTMLElement)return s.style.gridArea=i,s;if("template"in s){const{template:n,initialState:o}=s,[a,c]=Be.create(n,o);return a.style.gridArea=i,r[i]=c,a}return Be.create(s)}).filter(i=>!!i);this.style.gridTemplate=t.template,this.append(...e),this._onLayoutChange&&this.dispatchEvent(this._onLayoutChange)}}else this._updateFunctions={},this.innerHTML="",this.style.gridTemplate="",this._onLayoutChange&&this.dispatchEvent(this._onLayoutChange);return rt`<slot></slot>`}};jw.styles=te`
    :host {
      display: grid;
      height: 100%;
      width: 100%;
      overflow: hidden;
      box-sizing: border-box;
    }

    /* :host(:not([layout])) {
      display: none;
    } */

    :host([floating]) {
      --bim-panel--bdrs: var(--bim-ui_size-4xs);
      background-color: transparent;
      padding: 1rem;
      gap: 1rem;
      position: absolute;
      pointer-events: none;
      top: 0px;
      left: 0px;
    }

    :host(:not([floating])) {
      --bim-panel--bdrs: 0;
      background-color: var(--bim-ui_bg-contrast-20);
      gap: 1px;
    }
  `;let f0=jw;Ww([dt({type:Boolean,reflect:!0})],f0.prototype,"floating");Ww([dt({type:String,reflect:!0})],f0.prototype,"layout");const Wg=class extends qt{render(){return rt`
      <iconify-icon .icon=${this.icon} height="none"></iconify-icon>
    `}};Wg.styles=te`
    :host {
      height: var(--bim-icon--fz, var(--bim-ui_size-sm));
      width: var(--bim-icon--fz, var(--bim-ui_size-sm));
    }

    iconify-icon {
      height: var(--bim-icon--fz, var(--bim-ui_size-sm));
      width: var(--bim-icon--fz, var(--bim-ui_size-sm));
      color: var(--bim-icon--c);
      transition: all 0.15s;
    }
  `,Wg.properties={icon:{type:String}};let kB=Wg;var VB=Object.defineProperty,Pp=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&VB(t,e,s),s};const Xw=class extends qt{constructor(){super(...arguments),this.vertical=!1,this.onValueChange=new Event("change")}get value(){const r={};for(const t of this.children){const e=t;"value"in e?r[e.name||e.label]=e.value:"checked"in e&&(r[e.name||e.label]=e.checked)}return r}set value(r){const t=[...this.children];for(const e in r){const i=t.find(o=>{const a=o;return a.name===e||a.label===e});if(!i)continue;const s=i,n=r[e];typeof n=="boolean"?s.checked=n:s.value=n}}render(){return rt`
      <div class="parent">
        ${this.label||this.icon?rt`<bim-label .icon=${this.icon}>${this.label}</bim-label>`:null}
        <div class="input">
          <slot></slot>
        </div>
      </div>
    `}};Xw.styles=te`
    :host {
      flex: 1;
      display: block;
    }

    .parent {
      display: flex;
      flex-wrap: wrap;
      column-gap: 1rem;
      row-gap: 0.375rem;
      user-select: none;
      flex: 1;
    }

    :host(:not([vertical])) .parent {
      justify-content: space-between;
    }

    :host([vertical]) .parent {
      flex-direction: column;
    }

    .input {
      overflow: hidden;
      box-sizing: border-box;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      min-height: 1.75rem;
      min-width: 3rem;
      gap: var(--bim-input--g, var(--bim-ui_size-4xs));
      padding: var(--bim-input--p, 0);
      background-color: var(--bim-input--bgc, transparent);
      outline: var(--bim-input--olw, 2px) solid
        var(--bim-input--olc, transparent);
      border-radius: var(--bim-input--bdrs, var(--bim-ui_size-4xs));
      transition: all 0.15s;
    }

    :host(:not([vertical])) .input {
      flex: 1;
      justify-content: flex-end;
    }

    :host(:not([vertical])[label]) .input {
      max-width: fit-content;
    }
  `;let hu=Xw;Pp([dt({type:String,reflect:!0})],hu.prototype,"name");Pp([dt({type:String,reflect:!0})],hu.prototype,"label");Pp([dt({type:String,reflect:!0})],hu.prototype,"icon");Pp([dt({type:Boolean,reflect:!0})],hu.prototype,"vertical");var zB=Object.defineProperty,uu=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&zB(t,e,s),s};const Zw=class extends qt{constructor(){super(...arguments),this.labelHidden=!1,this.iconHidden=!1,this.vertical=!1}get value(){return this.textContent?Np(this.textContent):this.textContent}render(){return rt`
      <div class="parent" .title=${this.textContent??""}>
        ${this.img?rt`<img .src=${this.img} .alt=${this.textContent||""} />`:null}
        ${!this.iconHidden&&this.icon?rt`<bim-icon .icon=${this.icon}></bim-icon>`:null}
        <p><slot></slot></p>
      </div>
    `}};Zw.styles=te`
    :host {
      --bim-icon--c: var(--bim-label--c);
      color: var(--bim-label--c, var(--bim-ui_bg-contrast-60));
      font-size: var(--bim-label--fz, var(--bim-ui_size-xs));
      overflow: hidden;
      display: block;
      white-space: nowrap;
      line-height: 1.1rem;
      transition: all 0.15s;
    }

    .parent {
      display: flex;
      align-items: center;
      column-gap: 0.25rem;
      row-gap: 0.125rem;
      user-select: none;
      height: 100%;
    }

    :host([vertical]) .parent {
      flex-direction: column;
    }

    .parent p {
      margin: 0;
      text-overflow: ellipsis;
      overflow: hidden;
      display: flex;
      align-items: center;
      gap: 0.125rem;
    }

    :host([label-hidden]) .parent p,
    :host(:empty) .parent p {
      display: none;
    }

    img {
      height: 100%;
      aspect-ratio: 1;
      border-radius: 100%;
      margin-right: 0.125rem;
    }

    :host(:not([vertical])) img {
      max-height: var(
        --bim-label_icon--sz,
        calc(var(--bim-label--fz, var(--bim-ui_size-xs)) * 1.8)
      );
    }

    :host([vertical]) img {
      max-height: var(
        --bim-label_icon--sz,
        calc(var(--bim-label--fz, var(--bim-ui_size-xs)) * 4)
      );
    }
  `;let Kc=Zw;uu([dt({type:String,reflect:!0})],Kc.prototype,"img");uu([dt({type:Boolean,attribute:"label-hidden",reflect:!0})],Kc.prototype,"labelHidden");uu([dt({type:String,reflect:!0})],Kc.prototype,"icon");uu([dt({type:Boolean,attribute:"icon-hidden",reflect:!0})],Kc.prototype,"iconHidden");uu([dt({type:Boolean,reflect:!0})],Kc.prototype,"vertical");var YB=Object.defineProperty,GB=Object.getOwnPropertyDescriptor,fs=(r,t,e,i)=>{for(var s=i>1?void 0:i?GB(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&YB(t,e,s),s};const qw=class extends qt{constructor(){super(...arguments),this._value=0,this.vertical=!1,this.slider=!1,this._input=mc(),this.onValueChange=new Event("change")}set value(r){this.setValue(r.toString())}get value(){return this._value}onChange(r){r.stopPropagation();const{value:t}=this._input;t&&this.setValue(t.value)}setValue(r){const{value:t}=this._input;let e=r;if(e=e.replace(/[^0-9.-]/g,""),e=e.replace(/(\..*)\./g,"$1"),e.endsWith(".")||(e.lastIndexOf("-")>0&&(e=e[0]+e.substring(1).replace(/-/g,"")),e==="-"||e==="-0"))return;let i=Number(e);Number.isNaN(i)||(i=this.min!==void 0?Math.max(i,this.min):i,i=this.max!==void 0?Math.min(i,this.max):i,this.value!==i&&(this._value=i,t&&(t.value=this.value.toString()),this.requestUpdate(),this.dispatchEvent(this.onValueChange)))}onBlur(){const{value:r}=this._input;r&&Number.isNaN(Number(r.value))&&(r.value=this.value.toString())}onSliderMouseDown(r){document.body.style.cursor="w-resize";const{clientX:t}=r,e=this.value;let i=!1;const s=a=>{var c;i=!0;const{clientX:l}=a,h=this.step??1,u=((c=h.toString().split(".")[1])==null?void 0:c.length)||0,d=1/(this.sensitivity??1),f=(l-t)/d;if(Math.floor(Math.abs(f))!==Math.abs(f))return;const p=e+f*h;this.setValue(p.toFixed(u))},n=()=>{this.slider=!0,this.removeEventListener("blur",n)},o=()=>{document.removeEventListener("mousemove",s),document.body.style.cursor="default",i?i=!1:(this.addEventListener("blur",n),this.slider=!1,requestAnimationFrame(()=>this.focus())),document.removeEventListener("mouseup",o)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",o)}onFocus(r){r.stopPropagation();const t=e=>{e.key==="Escape"&&(this.blur(),window.removeEventListener("keydown",t))};window.addEventListener("keydown",t)}connectedCallback(){super.connectedCallback(),this.min&&this.min>this.value&&(this._value=this.min),this.max&&this.max<this.value&&(this._value=this.max)}focus(){const{value:r}=this._input;r&&r.focus()}render(){const r=rt`
      ${this.pref||this.icon?rt`<bim-label
            style="pointer-events: auto"
            @mousedown=${this.onSliderMouseDown}
            .icon=${this.icon}
            >${this.pref}</bim-label
          >`:null}
      <input
        ${ai(this._input)}
        type="text"
        aria-label=${this.label||this.name||"Number Input"}
        size="1"
        @input=${o=>o.stopPropagation()}
        @change=${this.onChange}
        @blur=${this.onBlur}
        @focus=${this.onFocus}
        .value=${this.value.toString()}
      />
      ${this.suffix?rt`<bim-label
            style="pointer-events: auto"
            @mousedown=${this.onSliderMouseDown}
            >${this.suffix}</bim-label
          >`:null}
    `,t=this.min??-1/0,e=this.max??1/0,i=100*(this.value-t)/(e-t),s=rt`
      <style>
        .slider-indicator {
          width: ${`${i}%`};
        }
      </style>
      <div class="slider" @mousedown=${this.onSliderMouseDown}>
        <div class="slider-indicator"></div>
        ${this.pref||this.icon?rt`<bim-label
              style="z-index: 1; margin-right: 0.125rem"
              .icon=${this.icon}
              >${`${this.pref}: `}</bim-label
            >`:null}
        <bim-label style="z-index: 1;">${this.value}</bim-label>
        ${this.suffix?rt`<bim-label style="z-index: 1;">${this.suffix}</bim-label>`:null}
      </div>
    `,n=`${this.label||this.name||this.pref?`${this.label||this.name||this.pref}: `:""}${this.value}${this.suffix??""}`;return rt`
      <bim-input
        title=${n}
        .label=${this.label}
        .icon=${this.icon}
        .vertical=${this.vertical}
      >
        ${this.slider?s:r}
      </bim-input>
    `}};qw.styles=te`
    :host {
      --bim-input--bgc: var(
        --bim-number-input--bgc,
        var(--bim-ui_bg-contrast-20)
      );
      --bim-input--olw: var(--bim-number-input--olw, 2px);
      --bim-input--olc: var(--bim-number-input--olc, transparent);
      --bim-input--bdrs: var(--bim-number-input--bdrs, var(--bim-ui_size-4xs));
      --bim-input--p: 0 0.375rem;
      flex: 1;
      display: block;
    }

    :host(:focus) {
      --bim-input--olw: var(--bim-number-input--olw, 2px);
      --bim-input--olc: var(
        --bim-number-inputfocus--c,
        var(--bim-ui_accent-base)
      );
    }

    :host(:not([slider])) bim-label {
      --bim-label--c: var(
        --bim-number-input_affixes--c,
        var(--bim-ui_bg-contrast-60)
      );
      --bim-label--fz: var(
        --bim-number-input_affixes--fz,
        var(--bim-ui_size-xs)
      );
    }

    p {
      margin: 0;
      padding: 0;
    }

    input {
      background-color: transparent;
      outline: none;
      border: none;
      padding: 0;
      flex-grow: 1;
      text-align: right;
      font-family: inherit;
      font-feature-settings: inherit;
      font-variation-settings: inherit;
      font-size: var(--bim-number-input--fz, var(--bim-ui_size-xs));
      color: var(--bim-number-input--c, var(--bim-ui_bg-contrast-100));
    }

    :host([suffix]:not([pref])) input {
      text-align: left;
    }

    :host([slider]) {
      --bim-input--p: 0;
    }

    :host([slider]) .slider {
      --bim-label--c: var(--bim-ui_bg-contrast-100);
    }

    .slider {
      position: relative;
      display: flex;
      justify-content: center;
      width: 100%;
      height: 100%;
      padding: 0 0.5rem;
    }

    .slider-indicator {
      height: 100%;
      background-color: var(--bim-ui_main-base);
      position: absolute;
      top: 0;
      left: 0;
      border-radius: var(--bim-input--bdrs, var(--bim-ui_size-4xs));
    }

    bim-input {
      display: flex;
    }

    bim-label {
      pointer-events: none;
    }
  `;let Li=qw;fs([dt({type:String,reflect:!0})],Li.prototype,"name",2);fs([dt({type:String,reflect:!0})],Li.prototype,"icon",2);fs([dt({type:String,reflect:!0})],Li.prototype,"label",2);fs([dt({type:String,reflect:!0})],Li.prototype,"pref",2);fs([dt({type:Number,reflect:!0})],Li.prototype,"min",2);fs([dt({type:Number,reflect:!0})],Li.prototype,"value",1);fs([dt({type:Number,reflect:!0})],Li.prototype,"step",2);fs([dt({type:Number,reflect:!0})],Li.prototype,"sensitivity",2);fs([dt({type:Number,reflect:!0})],Li.prototype,"max",2);fs([dt({type:String,reflect:!0})],Li.prototype,"suffix",2);fs([dt({type:Boolean,reflect:!0})],Li.prototype,"vertical",2);fs([dt({type:Boolean,reflect:!0})],Li.prototype,"slider",2);var HB=Object.defineProperty,$B=Object.getOwnPropertyDescriptor,du=(r,t,e,i)=>{for(var s=i>1?void 0:i?$B(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&HB(t,e,s),s};const Qw=class extends qt{constructor(){super(...arguments),this.onValueChange=new Event("change"),this._hidden=!1,this.headerHidden=!1,this.valueTransform={},this.activationButton=document.createElement("bim-button")}set hidden(r){this._hidden=r,this.activationButton.active=!r,this.dispatchEvent(new Event("hiddenchange"))}get hidden(){return this._hidden}get value(){return Vh(this,this.valueTransform)}set value(r){const t=[...this.children];for(const e in r){const i=t.find(n=>{const o=n;return o.name===e||o.label===e});if(!i)continue;const s=i;s.value=r[e]}}connectedCallback(){super.connectedCallback(),this.activationButton.active=!this.hidden,this.activationButton.onclick=()=>this.hidden=!this.hidden}disconnectedCallback(){super.disconnectedCallback(),this.activationButton.remove()}collapseSections(){const r=this.querySelectorAll("bim-panel-section");for(const t of r)t.collapsed=!0}expandSections(){const r=this.querySelectorAll("bim-panel-section");for(const t of r)t.collapsed=!1}render(){return this.activationButton.icon=this.icon,this.activationButton.label=this.label||this.name,this.activationButton.tooltipTitle=this.label||this.name,rt`
      <div class="parent">
        ${this.label||this.name||this.icon?rt`<bim-label .icon=${this.icon}>${this.label}</bim-label>`:null}
        <div class="sections">
          <slot></slot>
        </div>
      </div>
    `}};Qw.styles=[kr.scrollbar,te`
      :host {
        display: flex;
        border-radius: var(--bim-ui_size-base);
        background-color: var(--bim-ui_bg-base);
        overflow: auto;
      }

      :host([hidden]) {
        display: none;
      }

      .parent {
        display: flex;
        flex: 1;
        flex-direction: column;
        pointer-events: auto;
        overflow: auto;
      }

      .parent bim-label {
        --bim-label--c: var(--bim-panel--c, var(--bim-ui_bg-contrast-80));
        --bim-label--fz: var(--bim-panel--fz, var(--bim-ui_size-sm));
        font-weight: 600;
        padding: 1rem;
        flex-shrink: 0;
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([header-hidden]) .parent bim-label {
        display: none;
      }

      .sections {
        display: flex;
        flex-direction: column;
        overflow: auto;
      }

      ::slotted(bim-panel-section:not(:last-child)) {
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      }
    `];let jo=Qw;du([dt({type:String,reflect:!0})],jo.prototype,"icon",2);du([dt({type:String,reflect:!0})],jo.prototype,"name",2);du([dt({type:String,reflect:!0})],jo.prototype,"label",2);du([dt({type:Boolean,reflect:!0})],jo.prototype,"hidden",1);du([dt({type:Boolean,attribute:"header-hidden",reflect:!0})],jo.prototype,"headerHidden",2);var WB=Object.defineProperty,fu=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&WB(t,e,s),s};const Kw=class extends qt{constructor(){super(...arguments),this.onValueChange=new Event("change"),this.valueTransform={}}get value(){const r=this.parentElement;let t;return r instanceof jo&&(t=r.valueTransform),Object.values(this.valueTransform).length!==0&&(t=this.valueTransform),Vh(this,t)}set value(r){const t=[...this.children];for(const e in r){const i=t.find(n=>{const o=n;return o.name===e||o.label===e});if(!i)continue;const s=i;s.value=r[e]}}onHeaderClick(){this.fixed||(this.collapsed=!this.collapsed)}render(){const r=this.label||this.icon||this.name||this.fixed,t=rt`<svg
      xmlns="http://www.w3.org/2000/svg"
      height="1.125rem"
      viewBox="0 0 24 24"
      width="1.125rem"
    >
      <path d="M0 0h24v24H0V0z" fill="none" />
      <path d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z" />
    </svg>`,e=rt`<svg
      xmlns="http://www.w3.org/2000/svg"
      height="1.125rem"
      viewBox="0 0 24 24"
      width="1.125rem"
    >
      <path d="M0 0h24v24H0z" fill="none" />
      <path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z" />
    </svg>`,i=this.collapsed?t:e,s=rt`
      <div
        class="header"
        title=${this.label??""}
        @click=${this.onHeaderClick}
      >
        ${this.label||this.icon||this.name?rt`<bim-label .icon=${this.icon}>${this.label}</bim-label>`:null}
        ${this.fixed?null:i}
      </div>
    `;return rt`
      <div class="parent">
        ${r?s:null}
        <div class="components">
          <slot></slot>
        </div>
      </div>
    `}};Kw.styles=[kr.scrollbar,te`
      :host {
        display: block;
        pointer-events: auto;
      }

      :host(:not([fixed])) .header:hover {
        --bim-label--c: var(--bim-ui_accent-base);
        color: var(--bim-ui_accent-base);
        cursor: pointer;
      }

      :host(:not([fixed])) .header:hover svg {
        fill: var(--bim-ui_accent-base);
      }

      .header {
        --bim-label--fz: var(--bim-ui_size-sm);
        --bim-label--c: var(--bim-ui_bg-contrast-80);
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-weight: 600;
        height: 1.5rem;
        padding: 0.75rem 1rem;
      }

      .header svg {
        fill: var(--bim-ui_bg-contrast-80);
      }

      .title {
        display: flex;
        align-items: center;
        column-gap: 0.5rem;
      }

      .title p {
        font-size: var(--bim-ui_size-sm);
      }

      .components {
        display: flex;
        flex-direction: column;
        row-gap: 0.75rem;
        padding: 0.125rem 1rem 1rem;
      }

      :host(:not([fixed])[collapsed]) .components {
        display: none;
        height: 0px;
      }

      bim-label {
        pointer-events: none;
      }
    `];let Jc=Kw;fu([dt({type:String,reflect:!0})],Jc.prototype,"icon");fu([dt({type:String,reflect:!0})],Jc.prototype,"label");fu([dt({type:String,reflect:!0})],Jc.prototype,"name");fu([dt({type:Boolean,reflect:!0})],Jc.prototype,"fixed");fu([dt({type:Boolean,reflect:!0})],Jc.prototype,"collapsed");var jB=Object.defineProperty,pu=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&jB(t,e,s),s};const Jw=class extends qt{constructor(){super(...arguments),this.vertical=!1,this.onValueChange=new Event("change"),this._canEmitEvents=!1,this._value=document.createElement("bim-option"),this.onOptionClick=r=>{this._value=r.target,this.dispatchEvent(this.onValueChange);for(const t of this.children)t instanceof He&&(t.checked=t===r.target)}}get _options(){return[...this.querySelectorAll("bim-option")]}set value(r){const t=this.findOption(r);if(t){for(const e of this._options)e.checked=e===t;this._value=t,this._canEmitEvents&&this.dispatchEvent(this.onValueChange)}}get value(){return this._value.value}onSlotChange(r){const t=r.target.assignedElements();for(const e of t)e instanceof He&&(e.noMark=!0,e.removeEventListener("click",this.onOptionClick),e.addEventListener("click",this.onOptionClick))}findOption(r){return this._options.find(t=>t instanceof He?t.label===r||t.value===r:!1)}firstUpdated(){const r=[...this.children].find(t=>t instanceof He&&t.checked);r&&(this._value=r)}render(){return rt`
      <bim-input
        .vertical=${this.vertical}
        .label=${this.label}
        .icon=${this.icon}
      >
        <slot @slotchange=${this.onSlotChange}></slot>
      </bim-input>
    `}};Jw.styles=te`
    :host {
      --bim-input--bgc: var(--bim-ui_bg-contrast-20);
      --bim-input--g: 0;
      --bim-option--jc: center;
      flex: 1;
      display: block;
    }

    ::slotted(bim-option) {
      border-radius: 0;
    }

    ::slotted(bim-option[checked]) {
      --bim-label--c: var(--bim-ui_main-contrast);
      background-color: var(--bim-ui_main-base);
    }
  `;let tl=Jw;pu([dt({type:String,reflect:!0})],tl.prototype,"name");pu([dt({type:String,reflect:!0})],tl.prototype,"icon");pu([dt({type:String,reflect:!0})],tl.prototype,"label");pu([dt({type:Boolean,reflect:!0})],tl.prototype,"vertical");pu([Zc()],tl.prototype,"_value");const XB=()=>rt`
    <style>
      div {
        display: flex;
        gap: 0.375rem;
        border-radius: 0.25rem;
        min-height: 1.25rem;
      }

      [data-type="row"] {
        background-color: var(--bim-ui_bg-contrast-10);
        animation: row-loading 1s linear infinite alternate;
        padding: 0.5rem;
      }

      [data-type="cell"] {
        background-color: var(--bim-ui_bg-contrast-20);
        flex: 0.25;
      }

      @keyframes row-loading {
        0% {
          background-color: var(--bim-ui_bg-contrast-10);
        }
        100% {
          background-color: var(--bim-ui_bg-contrast-20);
        }
      }
    </style>
    <div style="display: flex; flex-direction: column;">
      <div data-type="row" style="gap: 2rem">
        <div data-type="cell" style="flex: 1"></div>
        <div data-type="cell" style="flex: 2"></div>
        <div data-type="cell" style="flex: 1"></div>
        <div data-type="cell" style="flex: 0.5"></div>
      </div>
      <div style="display: flex;">
        <div data-type="row" style="flex: 1">
          <div data-type="cell" style="flex: 0.5"></div>
        </div>
        <div data-type="row" style="flex: 2">
          <div data-type="cell" style="flex: 0.75"></div>
        </div>
        <div data-type="row" style="flex: 1">
          <div data-type="cell"></div>
        </div>
        <div data-type="row" style="flex: 0.5">
          <div data-type="cell" style="flex: 0.75"></div>
        </div>
      </div>
      <div style="display: flex;">
        <div data-type="row" style="flex: 1">
          <div data-type="cell" style="flex: 0.75"></div>
        </div>
        <div data-type="row" style="flex: 2">
          <div data-type="cell"></div>
        </div>
        <div data-type="row" style="flex: 1">
          <div data-type="cell" style="flex: 0.5"></div>
        </div>
        <div data-type="row" style="flex: 0.5">
          <div data-type="cell" style="flex: 0.5"></div>
        </div>
      </div>
      <div style="display: flex;">
        <div data-type="row" style="flex: 1">
          <div data-type="cell"></div>
        </div>
        <div data-type="row" style="flex: 2">
          <div data-type="cell" style="flex: 0.5"></div>
        </div>
        <div data-type="row" style="flex: 1">
          <div data-type="cell" style="flex: 0.75"></div>
        </div>
        <div data-type="row" style="flex: 0.5">
          <div data-type="cell" style="flex: 0.7s5"></div>
        </div>
      </div>
    </div>
  `,ZB=()=>rt`
    <style>
      .loader {
        grid-area: Processing;
        position: relative;
        padding: 0.125rem;
      }
      .loader:before {
        content: "";
        position: absolute;
      }
      .loader .loaderBar {
        position: absolute;
        top: 0;
        right: 100%;
        bottom: 0;
        left: 0;
        background: var(--bim-ui_main-base);
        /* width: 25%; */
        width: 0;
        animation: borealisBar 2s linear infinite;
      }

      @keyframes borealisBar {
        0% {
          left: 0%;
          right: 100%;
          width: 0%;
        }
        10% {
          left: 0%;
          right: 75%;
          width: 25%;
        }
        90% {
          right: 0%;
          left: 75%;
          width: 25%;
        }
        100% {
          left: 100%;
          right: 0%;
          width: 0%;
        }
      }
    </style>
    <div class="loader">
      <div class="loaderBar"></div>
    </div>
  `;var qB=Object.defineProperty,QB=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&qB(t,e,s),s};const t_=class extends qt{constructor(){super(...arguments),this.column="",this.columnIndex=0,this.rowData={}}get data(){return this.column?this.rowData[this.column]:null}render(){return rt`
      <style>
        :host {
          grid-area: ${this.column??"unset"};
        }
      </style>
      <slot></slot>
    `}};t_.styles=te`
    :host {
      padding: 0.375rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    :host([data-column-index="0"]) {
      justify-content: normal;
    }

    :host([data-column-index="0"]:not([data-cell-header]))
      ::slotted(bim-label) {
      text-align: left;
    }

    ::slotted(*) {
      --bim-input--bgc: transparent;
      --bim-input--olc: var(--bim-ui_bg-contrast-20);
      --bim-input--olw: 1px;
    }

    ::slotted(bim-input) {
      --bim-input--olw: 0;
    }

    ::slotted(bim-label) {
      white-space: normal;
      text-align: center;
    }
  `;let e_=t_;QB([dt({type:String,reflect:!0})],e_.prototype,"column");var KB=Object.defineProperty,JB=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&KB(t,e,s),s};const i_=class extends qt{constructor(){super(...arguments),this._groups=[],this.data=[],this.table=this.closest("bim-table")}toggleGroups(r,t=!1){for(const e of this._groups)e.childrenHidden=typeof r>"u"?!e.childrenHidden:!r,t&&e.toggleChildren(r,t)}render(){return this._groups=[],rt`
      <slot></slot>
      ${this.data.map(r=>{const t=document.createElement("bim-table-group");return this._groups.push(t),t.table=this.table,t.data=r,t})}
    `}};i_.styles=te`
    :host {
      --bim-button--bgc: transparent;
      position: relative;
      grid-area: Children;
    }

    :host([hidden]) {
      display: none;
    }

    ::slotted(.branch.branch-vertical) {
      top: 0;
      bottom: 1.125rem;
    }
  `;let s_=i_;JB([dt({type:Array,attribute:!1})],s_.prototype,"data");var t7=Object.defineProperty,e7=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&t7(t,e,s),s};const n_=class extends qt{constructor(){super(...arguments),this.data={data:{}},this.childrenHidden=!0,this.table=this.closest("bim-table")}connectedCallback(){super.connectedCallback(),this.table&&this.table.expanded?this.childrenHidden=!1:this.childrenHidden=!0}toggleChildren(r,t=!1){this._children&&(this.childrenHidden=typeof r>"u"?!this.childrenHidden:!r,t&&this._children.toggleGroups(r,t))}render(){if(!this.table)throw new Error("TableGroup: parent table wasn't found!");const r=this.table.getGroupIndentation(this.data)??0,t=rt`
      ${this.table.noIndentation?null:rt`
            <style>
              .branch-vertical {
                left: ${r+(this.table.selectableRows?1.9375:.5625)}rem;
              }
            </style>
            <div class="branch branch-vertical"></div>
          `}
    `,e=document.createDocumentFragment();pc(t,e);let i=null;this.table.noIndentation||(i=document.createElement("div"),i.classList.add("branch","branch-horizontal"),i.style.left=`${r-1+(this.table.selectableRows?2.05:.5625)}rem`);let s=null;if(!this.table.noIndentation){const a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("height","9.5"),a.setAttribute("width","7.5"),a.setAttribute("viewBox","0 0 4.6666672 7.3333333");const c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d","m 1.7470835,6.9583848 2.5899999,-2.59 c 0.39,-0.39 0.39,-1.02 0,-1.41 L 1.7470835,0.36838483 c -0.63,-0.62000003 -1.71000005,-0.18 -1.71000005,0.70999997 v 5.17 c 0,0.9 1.08000005,1.34 1.71000005,0.71 z"),a.append(c);const l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("height","6.5"),l.setAttribute("width","9.5"),l.setAttribute("viewBox","0 0 5.9111118 5.0175439");const h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttribute("d","M -0.33616196,1.922522 2.253838,4.5125219 c 0.39,0.39 1.02,0.39 1.41,0 L 6.2538379,1.922522 c 0.6200001,-0.63 0.18,-1.71000007 -0.7099999,-1.71000007 H 0.37383804 c -0.89999997,0 -1.33999997,1.08000007 -0.71,1.71000007 z"),l.append(h),s=document.createElement("div"),s.addEventListener("click",u=>{u.stopPropagation(),this.toggleChildren()}),s.classList.add("caret"),s.style.left=`${(this.table.selectableRows?1.5:.125)+r}rem`,this.childrenHidden?s.append(a):s.append(l)}const n=document.createElement("bim-table-row");this.data.children&&!this.childrenHidden&&n.append(e),n.table=this.table,n.data=this.data.data,this.table.dispatchEvent(new CustomEvent("rowcreated",{detail:{row:n}})),s&&this.data.children&&n.append(s),r!==0&&(!this.data.children||this.childrenHidden)&&i&&n.append(i);let o;if(this.data.children){o=document.createElement("bim-table-children"),this._children=o,o.table=this.table,o.data=this.data.children;const a=document.createDocumentFragment();pc(t,a),o.append(a)}return rt`
      <div class="parent">${n} ${this.childrenHidden?null:o}</div>
    `}};n_.styles=te`
    :host {
      position: relative;
    }

    .parent {
      display: grid;
      grid-template-areas: "Data" "Children";
    }

    .branch {
      position: absolute;
      z-index: 1;
    }

    .branch-vertical {
      border-left: 1px dotted var(--bim-ui_bg-contrast-40);
    }

    .branch-horizontal {
      top: 50%;
      width: 1rem;
      border-bottom: 1px dotted var(--bim-ui_bg-contrast-40);
    }

    .caret {
      position: absolute;
      z-index: 2;
      transform: translateY(-50%) rotate(0deg);
      top: 50%;
      display: flex;
      width: 0.95rem;
      height: 0.95rem;
      justify-content: center;
      align-items: center;
      cursor: pointer;
    }

    .caret svg {
      fill: var(--bim-ui_bg-contrast-60);
    }
  `;let r_=n_;e7([dt({type:Boolean,attribute:"children-hidden",reflect:!0})],r_.prototype,"childrenHidden");var i7=Object.defineProperty,el=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&i7(t,e,s),s};const o_=class extends qt{constructor(){super(...arguments),this.selected=!1,this.columns=[],this.hiddenColumns=[],this.data={},this.isHeader=!1,this.table=this.closest("bim-table"),this.onTableColumnsChange=()=>{this.table&&(this.columns=this.table.columns)},this.onTableColumnsHidden=()=>{this.table&&(this.hiddenColumns=this.table.hiddenColumns)},this._observer=new IntersectionObserver(r=>{this._intersecting=r[0].isIntersecting},{rootMargin:"36px"})}get _columnNames(){return this.columns.filter(r=>!this.hiddenColumns.includes(r.name)).map(r=>r.name)}get _columnWidths(){return this.columns.filter(r=>!this.hiddenColumns.includes(r.name)).map(r=>r.width)}get _isSelected(){var r;return(r=this.table)==null?void 0:r.selection.has(this.data)}onSelectionChange(r){if(!this.table)return;const t=r.target;this.selected=t.value,t.value?(this.table.selection.add(this.data),this.table.dispatchEvent(new CustomEvent("rowselected",{detail:{data:this.data}}))):(this.table.selection.delete(this.data),this.table.dispatchEvent(new CustomEvent("rowdeselected",{detail:{data:this.data}})))}connectedCallback(){super.connectedCallback(),this._observer.observe(this),this.table&&(this.columns=this.table.columns,this.hiddenColumns=this.table.hiddenColumns,this.table.addEventListener("columnschange",this.onTableColumnsChange),this.table.addEventListener("columnshidden",this.onTableColumnsHidden),this.toggleAttribute("selected",this._isSelected))}disconnectedCallback(){super.disconnectedCallback(),this._observer.unobserve(this),this.table&&(this.columns=[],this.hiddenColumns=[],this.table.removeEventListener("columnschange",this.onTableColumnsChange),this.table.removeEventListener("columnshidden",this.onTableColumnsHidden),this.toggleAttribute("selected",!1))}compute(){if(!this.table)throw new Error("TableRow: parent table wasn't found!");const r=this.table.getRowIndentation(this.data)??0,t=this.isHeader?this.data:this.table.applyDataTransform(this.data)??this.data,e=[];for(const i in t){if(this.hiddenColumns.includes(i))continue;const s=t[i];let n;if(typeof s=="string"||typeof s=="boolean"||typeof s=="number"?(n=document.createElement("bim-label"),n.textContent=String(s)):s instanceof HTMLElement?n=s:(n=document.createDocumentFragment(),pc(s,n)),!n)continue;const o=document.createElement("bim-table-cell");o.append(n),o.column=i,this._columnNames.indexOf(i)===0&&(o.style.marginLeft=`${this.table.noIndentation?0:r+.75}rem`);const a=this._columnNames.indexOf(i);o.setAttribute("data-column-index",String(a)),o.toggleAttribute("data-no-indentation",a===0&&this.table.noIndentation),o.toggleAttribute("data-cell-header",this.isHeader),o.rowData=this.data,this.table.dispatchEvent(new CustomEvent("cellcreated",{detail:{cell:o}})),e.push(o)}return this.style.gridTemplateAreas=`"${this.table.selectableRows?"Selection":""} ${this._columnNames.join(" ")}"`,this.style.gridTemplateColumns=`${this.table.selectableRows?"1.6rem":""} ${this._columnWidths.join(" ")}`,rt`
      ${!this.isHeader&&this.table.selectableRows?rt`<bim-checkbox
            @change=${this.onSelectionChange}
            .checked=${this._isSelected}
            style="align-self: center; justify-self: center"
          ></bim-checkbox>`:null}
      ${e}
      <slot></slot>
    `}render(){return rt`${this._intersecting?this.compute():rt``}`}};o_.styles=te`
    :host {
      position: relative;
      grid-area: Data;
      display: grid;
      min-height: 2.25rem;
      transition: all 0.15s;
    }

    ::slotted(.branch.branch-vertical) {
      top: 50%;
      bottom: 0;
    }

    :host([selected]) {
      background-color: color-mix(
        in lab,
        var(--bim-ui_bg-contrast-20) 30%,
        var(--bim-ui_main-base) 10%
      );
    }
  `;let Xo=o_;el([dt({type:Boolean,reflect:!0})],Xo.prototype,"selected");el([dt({attribute:!1})],Xo.prototype,"columns");el([dt({attribute:!1})],Xo.prototype,"hiddenColumns");el([dt({attribute:!1})],Xo.prototype,"data");el([dt({type:Boolean,attribute:"is-header",reflect:!0})],Xo.prototype,"isHeader");el([Zc()],Xo.prototype,"_intersecting");var s7=Object.defineProperty,n7=Object.getOwnPropertyDescriptor,Us=(r,t,e,i)=>{for(var s=i>1?void 0:i?n7(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&s7(t,e,s),s};const a_=class extends qt{constructor(){super(...arguments),this._filteredData=[],this.headersHidden=!1,this.minColWidth="4rem",this._columns=[],this._textDelimiters={comma:",",tab:"	"},this._queryString=null,this._data=[],this.expanded=!1,this.preserveStructureOnFilter=!1,this.indentationInText=!1,this.dataTransform={},this.selectableRows=!1,this.selection=new Set,this.noIndentation=!1,this.loading=!1,this._errorLoading=!1,this._onColumnsHidden=new Event("columnshidden"),this._hiddenColumns=[],this._stringFilterFunction=(r,t)=>Object.values(t.data).some(e=>String(e).toLowerCase().includes(r.toLowerCase())),this._queryFilterFunction=(r,t)=>{let e=!1;const i=Hg(r)??[];for(const s of i){if("queries"in s){e=!1;break}const{condition:n,value:o}=s;let{key:a}=s;if(a.startsWith("[")&&a.endsWith("]")){const c=a.replace("[","").replace("]","");a=c,e=Object.keys(t.data).filter(l=>l.includes(c)).map(l=>my(t.data[l],n,o)).some(l=>l)}else e=my(t.data[a],n,o);if(!e)break}return e}}set columns(r){const t=[];for(const e of r){const i=typeof e=="string"?{name:e,width:`minmax(${this.minColWidth}, 1fr)`}:e;t.push(i)}this._columns=t,this.computeMissingColumns(this.data),this.dispatchEvent(new Event("columnschange"))}get columns(){return this._columns}get _headerRowData(){const r={};for(const t of this.columns){const{name:e}=t;r[e]=String(e)}return r}get value(){return this._filteredData}set queryString(r){this.toggleAttribute("data-processing",!0),this._queryString=r&&r.trim()!==""?r.trim():null,this.updateFilteredData(),this.toggleAttribute("data-processing",!1)}get queryString(){return this._queryString}set data(r){this._data=r,this.updateFilteredData(),this.computeMissingColumns(r)&&(this.columns=this._columns)}get data(){return this._data}get dataAsync(){return new Promise(r=>{setTimeout(()=>{r(this.data)})})}set hiddenColumns(r){this._hiddenColumns=r,setTimeout(()=>{this.dispatchEvent(this._onColumnsHidden)})}get hiddenColumns(){return this._hiddenColumns}updateFilteredData(){this.queryString?(Hg(this.queryString)?(this.filterFunction=this._queryFilterFunction,this._filteredData=this.filter(this.queryString)):(this.filterFunction=this._stringFilterFunction,this._filteredData=this.filter(this.queryString)),this.preserveStructureOnFilter&&(this._expandedBeforeFilter===void 0&&(this._expandedBeforeFilter=this.expanded),this.expanded=!0)):(this.preserveStructureOnFilter&&this._expandedBeforeFilter!==void 0&&(this.expanded=this._expandedBeforeFilter,this._expandedBeforeFilter=void 0),this._filteredData=this.data)}computeMissingColumns(r){let t=!1;for(const e of r){const{children:i,data:s}=e;for(const n in s)this._columns.map(o=>typeof o=="string"?o:o.name).includes(n)||(this._columns.push({name:n,width:`minmax(${this.minColWidth}, 1fr)`}),t=!0);if(i){const n=this.computeMissingColumns(i);n&&!t&&(t=n)}}return t}generateText(r="comma",t=this.value,e="",i=!0){const s=this._textDelimiters[r];let n="";const o=this.columns.map(a=>a.name);if(i){this.indentationInText&&(n+=`Indentation${s}`);const a=`${o.join(s)}
`;n+=a}for(const[a,c]of t.entries()){const{data:l,children:h}=c,u=this.indentationInText?`${e}${a+1}${s}`:"",d=o.map(p=>l[p]??""),f=`${u}${d.join(s)}
`;n+=f,h&&(n+=this.generateText(r,c.children,`${e}${a+1}.`,!1))}return n}get csv(){return this.generateText("comma")}get tsv(){return this.generateText("tab")}applyDataTransform(r){const t={};for(const i of Object.keys(this.dataTransform)){const s=this.columns.find(n=>n.name===i);s&&s.forceDataTransform&&(i in r||(r[i]=""))}const e=r;for(const i in e){const s=this.dataTransform[i];s?t[i]=s(e[i],r):t[i]=r[i]}return t}downloadData(r="BIM Table Data",t="json"){let e=null;if(t==="json"&&(e=new File([JSON.stringify(this.value,void 0,2)],`${r}.json`)),t==="csv"&&(e=new File([this.csv],`${r}.csv`)),t==="tsv"&&(e=new File([this.tsv],`${r}.tsv`)),!e)return;const i=document.createElement("a");i.href=URL.createObjectURL(e),i.download=e.name,i.click(),URL.revokeObjectURL(i.href)}getRowIndentation(r,t=this.value,e=0){for(const i of t){if(i.data===r)return e;if(i.children){const s=this.getRowIndentation(r,i.children,e+1);if(s!==null)return s}}return null}getGroupIndentation(r,t=this.value,e=0){for(const i of t){if(i===r)return e;if(i.children){const s=this.getGroupIndentation(r,i.children,e+1);if(s!==null)return s}}return null}connectedCallback(){super.connectedCallback(),this.dispatchEvent(new Event("connected"))}disconnectedCallback(){super.disconnectedCallback(),this.dispatchEvent(new Event("disconnected"))}async loadData(r=!1){if(this._filteredData.length!==0&&!r||!this.loadFunction)return!1;this.loading=!0;try{const t=await this.loadFunction();return this.data=t,this.loading=!1,this._errorLoading=!1,!0}catch(t){if(this.loading=!1,this._filteredData.length!==0)return!1;const e=this.querySelector("[slot='error-loading']"),i=e?.querySelector("[data-table-element='error-message']");return t instanceof Error&&i&&t.message.trim()!==""&&(i.textContent=t.message),this._errorLoading=!0,!1}}filter(r,t=this.filterFunction??this._stringFilterFunction,e=this.data){const i=[];for(const s of e)if(t(r,s)){if(this.preserveStructureOnFilter){const n={data:s.data};if(s.children){const o=this.filter(r,t,s.children);o.length&&(n.children=o)}i.push(n)}else if(i.push({data:s.data}),s.children){const n=this.filter(r,t,s.children);i.push(...n)}}else if(s.children){const n=this.filter(r,t,s.children);this.preserveStructureOnFilter&&n.length?i.push({data:s.data,children:n}):i.push(...n)}return i}get _missingDataElement(){return this.querySelector("[slot='missing-data']")}render(){if(this.loading)return XB();if(this._errorLoading)return rt`<slot name="error-loading"></slot>`;if(this._filteredData.length===0&&this._missingDataElement)return rt`<slot name="missing-data"></slot>`;const r=document.createElement("bim-table-row");r.table=this,r.isHeader=!0,r.data=this._headerRowData,r.style.gridArea="Header",r.style.position="sticky",r.style.top="0",r.style.zIndex="5";const t=document.createElement("bim-table-children");return t.table=this,t.data=this.value,t.style.gridArea="Body",t.style.backgroundColor="transparent",rt`
      <div class="parent">
        ${this.headersHidden?null:r} ${ZB()}
        <div style="overflow-x: hidden; grid-area: Body">${t}</div>
      </div>
    `}};a_.styles=[kr.scrollbar,te`
      :host {
        position: relative;
        overflow: auto;
        display: block;
        pointer-events: auto;
      }

      :host(:not([data-processing])) .loader {
        display: none;
      }

      .parent {
        display: grid;
        grid-template:
          "Header" auto
          "Processing" auto
          "Body" 1fr
          "Footer" auto;
        overflow: auto;
        height: 100%;
      }

      .parent > bim-table-row[is-header] {
        color: var(--bim-table_header--c, var(--bim-ui_bg-contrast-100));
        background-color: var(
          --bim-table_header--bgc,
          var(--bim-ui_bg-contrast-20)
        );
      }

      .controls {
        display: flex;
        gap: 0.375rem;
        flex-wrap: wrap;
        margin-bottom: 0.5rem;
      }
    `];let ps=a_;Us([Zc()],ps.prototype,"_filteredData",2);Us([dt({type:Boolean,attribute:"headers-hidden",reflect:!0})],ps.prototype,"headersHidden",2);Us([dt({type:String,attribute:"min-col-width",reflect:!0})],ps.prototype,"minColWidth",2);Us([dt({type:Array,attribute:!1})],ps.prototype,"columns",1);Us([dt({type:Array,attribute:!1})],ps.prototype,"data",1);Us([dt({type:Boolean,reflect:!0})],ps.prototype,"expanded",2);Us([dt({type:Boolean,reflect:!0,attribute:"selectable-rows"})],ps.prototype,"selectableRows",2);Us([dt({attribute:!1})],ps.prototype,"selection",2);Us([dt({type:Boolean,attribute:"no-indentation",reflect:!0})],ps.prototype,"noIndentation",2);Us([dt({type:Boolean,reflect:!0})],ps.prototype,"loading",2);Us([Zc()],ps.prototype,"_errorLoading",2);var r7=Object.defineProperty,o7=Object.getOwnPropertyDescriptor,Lp=(r,t,e,i)=>{for(var s=i>1?void 0:i?o7(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&r7(t,e,s),s};const c_=class extends qt{constructor(){super(...arguments),this._defaultName="__unnamed__",this.name=this._defaultName,this._hidden=!1}set hidden(r){this._hidden=r,this.dispatchEvent(new Event("hiddenchange"))}get hidden(){return this._hidden}connectedCallback(){super.connectedCallback();const{parentElement:r}=this;if(r&&this.name===this._defaultName){const t=[...r.children].indexOf(this);this.name=`${this._defaultName}${t}`}}render(){return rt` <slot></slot> `}};c_.styles=te`
    :host {
      display: block;
      height: 100%;
    }

    :host([hidden]) {
      display: none;
    }
  `;let Bi=c_;Lp([dt({type:String,reflect:!0})],Bi.prototype,"name",2);Lp([dt({type:String,reflect:!0})],Bi.prototype,"label",2);Lp([dt({type:String,reflect:!0})],Bi.prototype,"icon",2);Lp([dt({type:Boolean,reflect:!0})],Bi.prototype,"hidden",1);var a7=Object.defineProperty,c7=Object.getOwnPropertyDescriptor,il=(r,t,e,i)=>{for(var s=i>1?void 0:i?c7(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&a7(t,e,s),s};const l_=class extends qt{constructor(){super(...arguments),this._switchers=[],this.bottom=!1,this.switchersHidden=!1,this.floating=!1,this.switchersFull=!1,this.onTabHiddenChange=r=>{const t=r.target;t instanceof Bi&&!t.hidden&&(t.removeEventListener("hiddenchange",this.onTabHiddenChange),this.tab=t.name,t.addEventListener("hiddenchange",this.onTabHiddenChange))}}set tab(r){this._tab=r;const t=[...this.children],e=t.find(i=>i instanceof Bi&&i.name===r);for(const i of t){if(!(i instanceof Bi))continue;i.hidden=e!==i;const s=this.getTabSwitcher(i.name);s&&s.toggleAttribute("data-active",!i.hidden)}}get tab(){return this._tab}getTabSwitcher(r){return this._switchers.find(t=>t.getAttribute("data-name")===r)}createSwitchers(){this._switchers=[];for(const r of this.children){if(!(r instanceof Bi))continue;const t=document.createElement("div");t.addEventListener("click",()=>{this.tab===r.name?this.toggleAttribute("tab",!1):this.tab=r.name}),t.setAttribute("data-name",r.name),t.className="switcher";const e=document.createElement("bim-label");e.textContent=r.label??"",e.icon=r.icon,t.append(e),this._switchers.push(t)}}onSlotChange(r){this.createSwitchers();const t=r.target.assignedElements(),e=t.find(i=>i instanceof Bi?this.tab?i.name===this.tab:!i.hidden:!1);e&&e instanceof Bi&&(this.tab=e.name);for(const i of t){if(!(i instanceof Bi)){i.remove();continue}i.removeEventListener("hiddenchange",this.onTabHiddenChange),e!==i&&(i.hidden=!0),i.addEventListener("hiddenchange",this.onTabHiddenChange)}}render(){return rt`
      <div class="parent">
        <div class="switchers">${this._switchers}</div>
        <div class="content">
          <slot @slotchange=${this.onSlotChange}></slot>
        </div>
      </div>
    `}};l_.styles=[kr.scrollbar,te`
      * {
        box-sizing: border-box;
      }

      :host {
        background-color: var(--bim-ui_bg-base);
        display: block;
        overflow: auto;
      }

      .parent {
        display: grid;
        grid-template: "switchers" auto "content" 1fr;
        height: 100%;
      }

      :host([bottom]) .parent {
        grid-template: "content" 1fr "switchers" auto;
      }

      .switchers {
        display: flex;
        height: 2.25rem;
        font-weight: 600;
        grid-area: switchers;
      }

      .switcher {
        --bim-label--c: var(--bim-ui_bg-contrast-80);
        background-color: var(--bim-ui_bg-base);
        cursor: pointer;
        pointer-events: auto;
        padding: 0rem 0.75rem;
        display: flex;
        justify-content: center;
        transition: all 0.15s;
      }

      :host([switchers-full]) .switcher {
        flex: 1;
      }

      .switcher:hover,
      .switcher[data-active] {
        --bim-label--c: var(--bim-ui_main-contrast);
        background-color: var(--bim-ui_main-base);
      }

      .switchers bim-label {
        pointer-events: none;
      }

      :host([switchers-hidden]) .switchers {
        display: none;
      }

      .content {
        grid-area: content;
        overflow: auto;
      }

      :host(:not([bottom])) .content {
        border-top: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([bottom]) .content {
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host(:not([tab])) .content {
        display: none;
      }

      :host([floating]) {
        background-color: transparent;
      }

      :host([floating]) .switchers {
        justify-self: center;
        overflow: auto;
      }

      :host([floating]:not([bottom])) .switchers {
        border-radius: var(--bim-ui_size-2xs) var(--bim-ui_size-2xs) 0 0;
        border-top: 1px solid var(--bim-ui_bg-contrast-20);
        border-left: 1px solid var(--bim-ui_bg-contrast-20);
        border-right: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([floating][bottom]) .switchers {
        border-radius: 0 0 var(--bim-ui_size-2xs) var(--bim-ui_size-2xs);
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
        border-left: 1px solid var(--bim-ui_bg-contrast-20);
        border-right: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([floating]:not([tab])) .switchers {
        border-radius: var(--bim-ui_size-2xs);
        border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([floating][bottom]:not([tab])) .switchers {
        border-top: 1px solid var(--bim-ui_bg-contrast-20);
      }

      :host([floating]) .content {
        border: 1px solid var(--bim-ui_bg-contrast-20);
        border-radius: var(--bim-ui_size-2xs);
        background-color: var(--bim-ui_bg-base);
      }
    `];let Zo=l_;il([Zc()],Zo.prototype,"_switchers",2);il([dt({type:Boolean,reflect:!0})],Zo.prototype,"bottom",2);il([dt({type:Boolean,attribute:"switchers-hidden",reflect:!0})],Zo.prototype,"switchersHidden",2);il([dt({type:Boolean,reflect:!0})],Zo.prototype,"floating",2);il([dt({type:String,reflect:!0})],Zo.prototype,"tab",1);il([dt({type:Boolean,attribute:"switchers-full",reflect:!0})],Zo.prototype,"switchersFull",2);/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Iy=r=>r??Se;var l7=Object.defineProperty,h7=Object.getOwnPropertyDescriptor,Hn=(r,t,e,i)=>{for(var s=i>1?void 0:i?h7(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&l7(t,e,s),s};const h_=class extends qt{constructor(){super(...arguments),this._inputTypes=["date","datetime-local","email","month","password","search","tel","text","time","url","week","area"],this.value="",this.vertical=!1,this._type="text",this.onValueChange=new Event("input")}set type(r){this._inputTypes.includes(r)&&(this._type=r)}get type(){return this._type}get query(){return Hg(this.value)}onInputChange(r){r.stopPropagation();const t=r.target;clearTimeout(this._debounceTimeoutID),this._debounceTimeoutID=setTimeout(()=>{this.value=t.value,this.dispatchEvent(this.onValueChange)},this.debounce)}focus(){setTimeout(()=>{var r;const t=(r=this.shadowRoot)==null?void 0:r.querySelector("input");t?.focus()})}render(){return rt`
      <bim-input
        .name=${this.name}
        .icon=${this.icon}
        .label=${this.label}
        .vertical=${this.vertical}
      >
        ${this.type==="area"?rt` <textarea
              aria-label=${this.label||this.name||"Text Input"}
              .value=${this.value}
              .rows=${this.rows??5}
              placeholder=${Iy(this.placeholder)}
              @input=${this.onInputChange}
            ></textarea>`:rt` <input
              aria-label=${this.label||this.name||"Text Input"}
              .type=${this.type}
              .value=${this.value}
              placeholder=${Iy(this.placeholder)}
              @input=${this.onInputChange}
            />`}
      </bim-input>
    `}};h_.styles=[kr.scrollbar,te`
      :host {
        --bim-input--bgc: var(--bim-ui_bg-contrast-20);
        flex: 1;
        display: block;
      }

      input,
      textarea {
        font-family: inherit;
        background-color: transparent;
        border: none;
        width: 100%;
        padding: var(--bim-ui_size-3xs);
        color: var(--bim-text-input--c, var(--bim-ui_bg-contrast-100));
      }

      input {
        outline: none;
        height: 100%;
        padding: 0 var(--bim-ui_size-3xs); /* Override padding */
        border-radius: var(--bim-text-input--bdrs, var(--bim-ui_size-4xs));
      }

      textarea {
        line-height: 1.1rem;
        resize: vertical;
      }

      :host(:focus) {
        --bim-input--olc: var(--bim-ui_accent-base);
      }

      /* :host([disabled]) {
      --bim-input--bgc: var(--bim-ui_bg-contrast-20);
    } */
    `];let ms=h_;Hn([dt({type:String,reflect:!0})],ms.prototype,"icon",2);Hn([dt({type:String,reflect:!0})],ms.prototype,"label",2);Hn([dt({type:String,reflect:!0})],ms.prototype,"name",2);Hn([dt({type:String,reflect:!0})],ms.prototype,"placeholder",2);Hn([dt({type:String,reflect:!0})],ms.prototype,"value",2);Hn([dt({type:Boolean,reflect:!0})],ms.prototype,"vertical",2);Hn([dt({type:Number,reflect:!0})],ms.prototype,"debounce",2);Hn([dt({type:Number,reflect:!0})],ms.prototype,"rows",2);Hn([dt({type:String,reflect:!0})],ms.prototype,"type",1);var u7=Object.defineProperty,d7=Object.getOwnPropertyDescriptor,u_=(r,t,e,i)=>{for(var s=i>1?void 0:i?d7(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&u7(t,e,s),s};const d_=class extends qt{constructor(){super(...arguments),this.rows=2,this._vertical=!1}set vertical(r){this._vertical=r,this.updateChildren()}get vertical(){return this._vertical}updateChildren(){const r=this.children;for(const t of r)this.vertical?t.setAttribute("label-hidden",""):t.removeAttribute("label-hidden")}render(){return rt`
      <style>
        .parent {
          grid-auto-flow: ${this.vertical?"row":"column"};
          grid-template-rows: repeat(${this.rows}, 1fr);
        }
      </style>
      <div class="parent">
        <slot @slotchange=${this.updateChildren}></slot>
      </div>
    `}};d_.styles=te`
    .parent {
      display: grid;
      gap: 0.25rem;
    }

    ::slotted(bim-button[label]:not([vertical])) {
      --bim-button--jc: flex-start;
    }

    ::slotted(bim-button) {
      --bim-label--c: var(--bim-ui_bg-contrast-80);
    }
  `;let Mp=d_;u_([dt({type:Number,reflect:!0})],Mp.prototype,"rows",2);u_([dt({type:Boolean,reflect:!0})],Mp.prototype,"vertical",1);var f7=Object.defineProperty,p7=Object.getOwnPropertyDescriptor,Dp=(r,t,e,i)=>{for(var s=i>1?void 0:i?p7(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&f7(t,e,s),s};const f_=class extends qt{constructor(){super(...arguments),this._vertical=!1,this._labelHidden=!1}set vertical(r){this._vertical=r,this.updateChildren()}get vertical(){return this._vertical}set labelHidden(r){this._labelHidden=r,this.updateChildren()}get labelHidden(){return this._labelHidden}updateChildren(){const r=this.children;for(const t of r)t instanceof Mp&&(t.vertical=this.vertical),t.toggleAttribute("label-hidden",this.vertical)}render(){return rt`
      <div class="parent">
        <div class="children">
          <slot @slotchange=${this.updateChildren}></slot>
        </div>
        ${!this.labelHidden&&(this.label||this.icon)?rt`<bim-label .icon=${this.icon}>${this.label}</bim-label>`:null}
      </div>
    `}};f_.styles=te`
    :host {
      --bim-label--fz: var(--bim-ui_size-xs);
      --bim-label--c: var(--bim-ui_bg-contrast-60);
      display: block;
      flex: 1;
    }

    :host(:not([vertical])) ::slotted(bim-button[vertical]) {
      --bim-icon--fz: var(--bim-ui_size-5xl);
      min-height: 3.75rem;
    }

    ::slotted(bim-button) {
      --bim-label--c: var(--bim-ui_bg-contrast-80);
    }

    .parent {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      align-items: center;
      padding: 0.5rem;
      height: 100%;
      box-sizing: border-box;
      justify-content: space-between;
    }

    :host([vertical]) .parent {
      flex-direction: row-reverse;
    }

    :host([vertical]) .parent > bim-label {
      writing-mode: tb;
    }

    .children {
      display: flex;
      gap: 0.25rem;
    }

    :host([vertical]) .children {
      flex-direction: column;
    }
  `;let sl=f_;Dp([dt({type:String,reflect:!0})],sl.prototype,"label",2);Dp([dt({type:String,reflect:!0})],sl.prototype,"icon",2);Dp([dt({type:Boolean,reflect:!0})],sl.prototype,"vertical",1);Dp([dt({type:Boolean,attribute:"label-hidden",reflect:!0})],sl.prototype,"labelHidden",1);var m7=Object.defineProperty,I7=Object.getOwnPropertyDescriptor,p0=(r,t,e,i)=>{for(var s=i>1?void 0:i?I7(t,e):t,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=(i?o(t,e,s):o(s))||s);return i&&s&&m7(t,e,s),s};const p_=class extends qt{constructor(){super(...arguments),this.labelsHidden=!1,this._vertical=!1,this._hidden=!1}set vertical(r){this._vertical=r,this.updateSections()}get vertical(){return this._vertical}set hidden(r){this._hidden=r,this.dispatchEvent(new Event("hiddenchange"))}get hidden(){return this._hidden}updateSections(){const r=this.children;for(const t of r)t instanceof sl&&(t.labelHidden=this.vertical&&!Oi.config.sectionLabelOnVerticalToolbar,t.vertical=this.vertical)}render(){return rt`
      <div class="parent">
        <slot @slotchange=${this.updateSections}></slot>
      </div>
    `}};p_.styles=te`
    :host {
      --bim-button--bgc: transparent;
      background-color: var(--bim-ui_bg-base);
      border-radius: var(--bim-ui_size-2xs);
      display: block;
    }

    :host([hidden]) {
      display: none;
    }

    .parent {
      display: flex;
      width: min-content;
      pointer-events: auto;
    }

    :host([vertical]) .parent {
      flex-direction: column;
    }

    :host([vertical]) {
      width: min-content;
      border-radius: var(--bim-ui_size-2xs);
      border: 1px solid var(--bim-ui_bg-contrast-20);
    }

    ::slotted(bim-toolbar-section:not(:last-child)) {
      border-right: 1px solid var(--bim-ui_bg-contrast-20);
      border-bottom: none;
    }

    :host([vertical]) ::slotted(bim-toolbar-section:not(:last-child)) {
      border-bottom: 1px solid var(--bim-ui_bg-contrast-20);
      border-right: none;
    }
  `;let Up=p_;p0([dt({type:String,reflect:!0})],Up.prototype,"icon",2);p0([dt({type:Boolean,attribute:"labels-hidden",reflect:!0})],Up.prototype,"labelsHidden",2);p0([dt({type:Boolean,reflect:!0})],Up.prototype,"vertical",1);var g7=Object.defineProperty,E7=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&g7(t,e,s),s};const m_=class extends qt{constructor(){super(),this._onResize=new Event("resize"),new ResizeObserver(()=>{setTimeout(()=>{this.dispatchEvent(this._onResize)})}).observe(this)}render(){return rt`
      <div class="parent">
        <slot></slot>
      </div>
    `}};m_.styles=te`
    :host {
      display: grid;
      min-width: 0;
      min-height: 0;
      height: 100%;
    }

    .parent {
      overflow: hidden;
      position: relative;
    }
  `;let I_=m_;E7([dt({type:String,reflect:!0})],I_.prototype,"name");/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const g_="important",C7=" !"+g_,bo=mw(class extends Iw{constructor(r){var t;if(super(r),r.type!==pw.ATTRIBUTE||r.name!=="style"||((t=r.strings)==null?void 0:t.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(r){return Object.keys(r).reduce((t,e)=>{const i=r[e];return i==null?t:t+`${e=e.includes("-")?e:e.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${i};`},"")}update(r,[t]){const{style:e}=r.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(t)),this.render(t);for(const i of this.ft)t[i]==null&&(this.ft.delete(i),i.includes("-")?e.removeProperty(i):e[i]=null);for(const i in t){const s=t[i];if(s!=null){this.ft.add(i);const n=typeof s=="string"&&s.endsWith(C7);i.includes("-")||n?e.setProperty(i,n?s.slice(0,-11):s,n?g_:""):e[i]=s}}return Po}}),b7=r=>{const{components:t}=r,e=t.get(DE);return rt`
    <bim-button
      data-ui-id="import-ifc"
      label="Load IFC"
      icon="mage:box-3d-fill"
      @click=${()=>{const i=document.createElement("input");i.type="file",i.accept=".ifc",i.onchange=async()=>{if(i.files===null||i.files.length===0)return;const s=i.files[0],n=s.name.replace(".ifc","");i.remove();const o=await s.arrayBuffer(),a=new Uint8Array(o);await e.load(a,!0,n)},i.click()}}
    ></bim-button>
  `},T7=r=>Be.create(b7,r),y7=Object.freeze(Object.defineProperty({__proto__:null,loadIfc:T7},Symbol.toStringTag,{value:"Module"})),v7={...y7},R7=r=>{const{components:t,actions:e,tags:i}=r,s=e?.dispose??!0,n=e?.download??!0,o=e?.visibility??!0,a=i?.schema??!0,c=i?.viewDefinition??!0,l=t.get(Bt),h=({detail:u})=>{const{cell:d}=u;d.style.padding="0.25rem 0"};return rt`
    <bim-table ${ai(u=>{if(!u)return;const d=u;d.hiddenColumns=["modelID"];const f=[];for(const[,p]of l.groups){if(!p)continue;const m={data:{Name:p.name||p.uuid,modelID:p.uuid}};f.push(m)}d.dataTransform={Name:(p,m)=>{const{modelID:g}=m;if(typeof g!="string")return p;const I=l.groups.get(g);if(!I)return g;const C={};for(const w of I.items)C[w.id]=w.ids;let b;const{schema:E}=I.ifcMetadata;a&&E&&(b=rt`
            <bim-label style="background-color: var(--bim-ui_main-base); padding: 0 0.25rem; color: var(--bim-ui_main-contrast); border-radius: 0.25rem;">${E}</bim-label>
            `);let T;if(c&&"viewDefinition"in I.ifcMetadata){const w=I.ifcMetadata.viewDefinition;T=rt`
            ${w.split(",").map(F=>rt`<bim-label style="background-color: var(--bim-ui_main-base); padding: 0 0.25rem; color: var(--bim-ui_main-contrast); border-radius: 0.25rem;">${F}</bim-label>`)}
          `}let A;s&&(A=rt`<bim-button @click=${()=>l.disposeGroup(I)} icon="mdi:delete"></bim-button>`);let S;o&&(S=rt`<bim-button @click=${w=>{const F=t.get(eu),D=w.target;F.set(D.hasAttribute("data-model-hidden"),C),D.toggleAttribute("data-model-hidden"),D.icon=D.hasAttribute("data-model-hidden")?"mdi:eye-off":"mdi:eye"}} icon="mdi:eye"></bim-button>`);let _;return n&&(_=rt`<bim-button @click=${()=>{const w=document.createElement("input");w.type="file",w.accept=".ifc",w.multiple=!1,w.addEventListener("change",async()=>{if(!(w.files&&w.files.length===1))return;const F=w.files[0],D=await F.arrayBuffer(),R=await t.get(CR).saveToIfc(I,new Uint8Array(D)),O=new File([R],F.name),y=document.createElement("a");y.href=URL.createObjectURL(O),y.download=O.name,y.click(),URL.revokeObjectURL(y.href)}),w.click()}} icon="flowbite:download-solid"></bim-button>`),rt`
         <div style="display: flex; flex: 1; gap: var(--bim-ui_size-4xs); justify-content: space-between; overflow: auto;">
          <div style="display: flex; flex-wrap: wrap; align-items: center; gap: 0 var(--bim-ui_size-4xs); flex-grow: 1; overflow: auto;">
            <div style="min-height: 1.75rem; overflow: auto; display: flex;">
              <bim-label style="white-space: normal;">${p}</bim-label>
            </div>
            <div style="display: flex; flex-wrap: wrap; gap: var(--bim-ui_size-4xs); overflow: auto;">
              ${b}
              ${T}
            </div>
          </div>
          <div style="display: flex; align-self: flex-start; flex-shrink: 0;">
            ${_}
            ${S}
            ${A}
          </div>
         </div>
        `}},d.data=f})} @cellcreated=${h} headers-hidden no-indentation>
      <bim-label slot="missing-data" style="--bim-icon--c: gold" icon="ic:round-warning">
        No models has been loaded yet
      </bim-label>
    </bim-table>
  `},A7=(r,t=!0)=>{const e=Be.create(R7,r);if(t){const{components:i}=r,s=i.get(Bt),[,n]=e;s.onFragmentsLoaded.add(()=>setTimeout(()=>n())),s.onFragmentsDisposed.add(()=>n())}return e},S7=Object.freeze(Object.defineProperty({__proto__:null,modelsList:A7},Symbol.toStringTag,{value:"Module"})),E_=["Name","ContainedInStructure","ForLayerSet","LayerThickness","HasProperties","HasAssociations","HasAssignments","HasPropertySets","PredefinedType","Quantities","ReferencedSource","Identification",r=>r.includes("Value"),r=>r.startsWith("Material"),r=>r.startsWith("Relating"),r=>{const t=["IsGroupedBy","IsDecomposedBy"];return r.startsWith("Is")&&!t.includes(r)}];async function uf(r,t,e,i=E_,s=!1){const n=r.get(pe),o=await t.getProperties(e);if(!o)return{data:{Entity:`${e} properties not found...`}};const a=n.relationMaps[t.uuid],c={data:{}};for(const l in o){const h=i.map(d=>typeof d=="string"?l===d:d(l)).includes(!0);if(!(l==="type"||h))continue;const u=o[l];if(u)if(u.type===5){c.children||(c.children=[]);const d=await uf(r,t,u.value,i,s);c.children.push(d)}else if(typeof u=="object"&&!Array.isArray(u)){const{value:d,type:f}=u;if(s)f===1||f===2||f===3||(c.data[l]=d);else{const p=typeof d=="number"?Number(d.toFixed(3)):d;c.data[l]=p}}else if(Array.isArray(u))for(const d of u){if(d.type!==5)continue;c.children||(c.children=[]);const f=await uf(r,t,d.value,i,s);c.children.push(f)}else if(l==="type"){const d=Ar[u];c.data.Entity=d}else c.data[l]=u}if(a&&a.get(o.expressID)){const l=a.get(o.expressID);for(const h of i){const u=[];if(typeof h=="string"){const d=n._inverseAttributes.indexOf(h);d!==-1&&u.push(d)}else{const d=n._inverseAttributes.filter(f=>h(f));for(const f of d){const p=n._inverseAttributes.indexOf(f);u.push(p)}}for(const d of u){const f=l.get(d);if(f)for(const p of f){const m=await uf(r,t,p,i,s);c.children||(c.children=[]),c.children.push(m)}}}}return c}const w7=r=>{const{components:t,fragmentIdMap:e,attributesToInclude:i,editable:s,tableDefinition:n}=r,o=t.get(Bt);let a;return typeof i=="function"?a=i(E_):a=i,rt`<bim-table ${ai(async c=>{if(!c)return;const l=c,h=[],u=[];for(const d in e){const f=o.list.get(d);if(!(f&&f.group))continue;const p=f.group,m=u.find(g=>g.model===p);if(m)for(const g of e[d])m.expressIDs.add(g);else{const g={model:p,expressIDs:new Set(e[d])};u.push(g)}}for(const d of u){const{model:f,expressIDs:p}=d;for(const m of p){const g=await uf(t,f,m,a,s);h.push(g)}}l.dataTransform=n,l.data=h,l.columns=[{name:"Entity",width:"minmax(15rem, 1fr)"}]})}></bim-table>`},_7=r=>Be.create(w7,r),F7=Object.freeze(Object.defineProperty({__proto__:null,entityAttributes:_7},Symbol.toStringTag,{value:"Module"}));let qn;const O7=r=>{const{components:t,classifications:e}=r,i=t.get(Fh),s=t.get(eu);qn||(qn=document.createElement("bim-table"),qn.headersHidden=!0,qn.hiddenColumns=["system"],qn.columns=["Name",{name:"Actions",width:"auto"}],qn.dataTransform={Actions:(o,a)=>{const{system:c,Name:l}=a;if(!(typeof c=="string"&&typeof l=="string"))return o;const h=i.list[c];if(!(h&&h[l]))return o;const u=h[l],{map:d}=u;return rt`
          <div>
            <bim-checkbox checked @change=${f=>{const p=f.target;s.set(p.value,d)}}></bim-checkbox>
          </div>
        `}});const n=[];for(const o of e){const a=typeof o=="string"?o:o.system,c=typeof o=="string"?o:o.label,l=i.list[a];l&&n.push({data:{Name:c,system:a},children:Object.keys(l).map(h=>({data:{Name:h,system:a,Actions:""}}))})}return qn.data=n,rt`${qn}`},x7=(r,t=!0)=>{const e=Be.create(O7,r);if(t){const{components:i}=r,s=i.get(Bt),[,n]=e;s.onFragmentsDisposed.add(()=>n())}return e},N7=Object.freeze(Object.defineProperty({__proto__:null,classificationTree:x7},Symbol.toStringTag,{value:"Module"})),C_=async(r,t,e)=>{var i,s,n,o;const a=r.get(pe),c={data:{Name:(i=e.Name)==null?void 0:i.value},children:[{data:{Name:"Identification",Value:(s=e.Identification)==null?void 0:s.value}},{data:{Name:"Name",Value:(n=e.Name)==null?void 0:n.value}},{data:{Name:"Description",Value:(o=e.Description)==null?void 0:o.value}}]},l=a.getEntityRelations(t,e.expressID,"IsNestedBy");if(!l)return c;c.children||(c.children=[]);const h=[];c.children.push({data:{Name:"Tasks"},children:h});for(const u of l){const d=await t.getProperties(u);if(!d)continue;const f=await C_(r,t,d);h.push(f)}return c},P7=async(r,t,e)=>{const i=[];for(const s of e){const n=await C_(r,t,s);i.push(n)}return{data:{Name:"Tasks"},children:i}},L7=async(r,t)=>{var e,i,s,n;const o={data:{Name:"Classifications"}};for(const a of t){const{value:c}=a.ReferencedSource,l=await r.getProperties(c);if(!l)continue;const h={data:{Name:(e=l.Name)==null?void 0:e.value},children:[{data:{Name:"Identification",Value:((i=a.Identification)==null?void 0:i.value)||((s=a.ItemReference)==null?void 0:s.value)}},{data:{Name:"Name",Value:(n=a.Name)==null?void 0:n.value}}]};o.children||(o.children=[]),o.children.push(h)}return o},M7=async(r,t)=>{var e,i,s,n,o,a;const c={data:{Name:"Materials"}};for(const l of t){if(l.type===qy){const h=(e=l.ForLayerSet)==null?void 0:e.value,u=await r.getProperties(h);if(!u)continue;for(const d of u.MaterialLayers){const{value:f}=d,p=await r.getProperties(f);if(!p)continue;const m=await r.getProperties((i=p.Material)==null?void 0:i.value);if(!m)continue;const g={data:{Name:"Layer"},children:[{data:{Name:"Thickness",Value:(s=p.LayerThickness)==null?void 0:s.value}},{data:{Name:"Material",Value:(n=m.Name)==null?void 0:n.value}}]};c.children||(c.children=[]),c.children.push(g)}}if(l.type===Ky)for(const h of l.Materials){const{value:u}=h,d=await r.getProperties(u);if(!d)continue;const f={data:{Name:"Name",Value:(o=d.Name)==null?void 0:o.value}};c.children||(c.children=[]),c.children.push(f)}if(l.type===Qy){const h={data:{Name:"Name",Value:(a=l.Name)==null?void 0:a.value}};c.children||(c.children=[]),c.children.push(h)}}return c},D7={IFCLENGTHMEASURE:"LENGTHUNIT",IFCAREAMEASURE:"AREAUNIT",IFCVOLUMEMEASURE:"VOLUMEUNIT",IFCPLANEANGLEMEASURE:"PLANEANGLEUNIT"},U7={MILLIMETRE:{symbol:"mm",digits:0},METRE:{symbol:"m",digits:2},KILOMETRE:{symbol:"km",digits:2},SQUARE_METRE:{symbol:"m",digits:2},CUBIC_METRE:{symbol:"m",digits:2},DEGREE:{symbol:"",digits:2},RADIAN:{symbol:"rad",digits:2},GRAM:{symbol:"g",digits:0},KILOGRAM:{symbol:"kg",digits:2},MILLISECOND:{symbol:"ms",digits:0},SECOND:{symbol:"s",digits:0}},b_=async(r,t)=>{var e,i,s;const n=Object.values(await r.getAllPropertiesOfType(sE))[0];let o;for(const a of n.Units){const c=await r.getProperties(a.value);if(c&&((e=c.UnitType)==null?void 0:e.value)===D7[t]){o=`${((i=c.Prefix)==null?void 0:i.value)??""}${((s=c.Name)==null?void 0:s.value)??""}`;break}}return o?U7[o]:null},B7=async(r,t,e)=>{var i,s;const{displayUnits:n}=e,o={data:{Name:"PropertySets"}};for(const a of t){const c={data:{Name:(i=a.Name)==null?void 0:i.value}};if(a.type===pi){for(const l of a.HasProperties){const{value:h}=l,u=await r.getProperties(h);if(!u)continue;const d=Object.keys(u).find(g=>g.includes("Value"));if(!(d&&u[d]))continue;let f=u[d].value,p="";if(n){const{name:g}=u[d],I=await b_(r,g)??{};p=I.symbol,f=u[d].value,typeof f=="number"&&I.digits&&(f=f.toFixed(I.digits))}const m={data:{Name:(s=u.Name)==null?void 0:s.value,Value:`${f} ${p??""}`}};c.children||(c.children=[]),c.children.push(m)}c.children&&(o.children||(o.children=[]),o.children.push(c))}}return o},k7=async(r,t,e)=>{var i,s;const{displayUnits:n}=e,o={data:{Name:"QuantitySets"}};for(const a of t){const c={data:{Name:(i=a.Name)==null?void 0:i.value}};if(a.type===Ks){for(const l of a.Quantities){const{value:h}=l,u=await r.getProperties(h);if(!u)continue;const d=Object.keys(u).find(g=>g.includes("Value"));if(!(d&&u[d]))continue;let f=u[d].value,p="";if(n){const{name:g}=u[d],I=await b_(r,g)??{};p=I.symbol,f=u[d].value,typeof f=="number"&&I.digits&&(f=f.toFixed(I.digits))}const m={data:{Name:(s=u.Name)==null?void 0:s.value,Value:`${f} ${p??""}`}};c.children||(c.children=[]),c.children.push(m)}c.children&&(o.children||(o.children=[]),o.children.push(c))}}return o},V7=["OwnerHistory","ObjectPlacement","CompositionType"],T_=async(r,t)=>{const e={groupName:"Attributes",includeClass:!1,...t},{groupName:i,includeClass:s}=e,n={data:{Name:i}};s&&(n.children||(n.children=[]),n.children.push({data:{Name:"Class",Value:Ar[r.type]}}));for(const o in r){if(V7.includes(o))continue;const a=r[o];if(a&&typeof a=="object"&&!Array.isArray(a)){if(a.type===eF)continue;const c={data:{Name:o,Value:a.value}};n.children||(n.children=[]),n.children.push(c)}}return n},Ic=(r,...t)=>{r.children||(r.children=[]),r.children.push(...t)},z7=async(r,t,e,i,s)=>{const n=r.get(pe).getEntityRelations(t,e,"IsDefinedBy");if(n){const o=[],a=[];for(const h of n){const u=await t.getProperties(h);u&&(u.type===pi&&o.push(u),u.type===Ks&&a.push(u))}const c=await B7(t,o,s);c.children&&Ic(i,c);const l=await k7(t,a,s);l.children&&Ic(i,l)}},Y7=async(r,t,e,i)=>{const s=r.get(pe).getEntityRelations(t,e,"HasAssociations");if(s){const n=[],o=[];for(const l of s){const h=await t.getProperties(l);h&&(h.type===Me&&n.push(h),(h.type===qy||h.type===iF||h.type===sF||h.type===Qy||h.type===Ky)&&o.push(h))}const a=await L7(t,n);a.children&&Ic(i,a);const c=await M7(t,o);c.children&&Ic(i,c)}},G7=async(r,t,e,i)=>{const s=r.get(pe).getEntityRelations(t,e,"HasAssignments");if(s){const n=[];for(const a of s){const c=await t.getProperties(a);c&&c.type===nF&&n.push(c)}const o=await P7(r,t,n);o.children&&Ic(i,o)}},H7=async(r,t,e,i)=>{const s=r.get(pe).getEntityRelations(t,e,"ContainedInStructure");if(s&&s[0]){const n=s[0],o=await t.getProperties(n);if(o){const a=await T_(o,{groupName:"SpatialContainer"});Ic(i,a)}}};let Gd={};const $7=async(r,t,e)=>{var i;const s=r.get(pe),n=r.get(Bt),o=n.getModelIdMap(t);Object.keys(t).length===0&&(Gd={});const a=[];for(const c in o){const l=n.groups.get(c);if(!l)continue;const h=s.relationMaps[l.uuid];if(!h)continue;c in Gd||(Gd[c]=new Map);const u=Gd[c],d=o[c];for(const f of d){let p=u.get(f);if(p){a.push(p);continue}const m=await l.getProperties(f);if(!m)continue;p={data:{Name:(i=m.Name)==null?void 0:i.value}},a.push(p),u.set(f,p);const g=await T_(m,{includeClass:!0});p.children||(p.children=[]),p.children.push(g),h.get(f)&&(await z7(r,l,f,p,e),await Y7(r,l,f,p),await G7(r,l,f,p),await H7(r,l,f,p))}}return a},W7=r=>{const t={emptySelectionWarning:!0,...r},{components:e,fragmentIdMap:i,emptySelectionWarning:s}=t;return rt`
    <bim-table @cellcreated=${({detail:n})=>{const{cell:o}=n;o.column==="Name"&&!("Value"in o.rowData)&&(o.style.gridColumn="1 / -1")}} ${ai(async n=>{if(!n)return;const o=n;o.columns=[{name:"Name",width:"12rem"}],o.headersHidden=!0,o.loadFunction=()=>$7(e,i,r),await o.loadData(!0)&&o.dispatchEvent(new Event("datacomputed"))})}>
      ${s?rt`
            <bim-label slot="missing-data" style="--bim-icon--c: gold" icon="ic:round-warning">
              Select some elements to display its properties
            </bim-label>
            `:null}
      <bim-label slot="error-loading" style="--bim-icon--c: #e72e2e" icon="bxs:error-alt">
        Something went wrong with the properties
      </bim-label>
    </bim-table>
  `},j7=r=>Be.create(W7,r),X7=Object.freeze(Object.defineProperty({__proto__:null,elementProperties:j7},Symbol.toStringTag,{value:"Module"})),jg=async(r,t,e,i)=>{var s;const n=[],o=r.get(pe),a=await t.getProperties(e);if(!a)return n;const{type:c}=a,l={data:{Entity:Ar[c],Name:(s=a.Name)==null?void 0:s.value,modelID:t.uuid,expressID:e}};for(const h of i){const u=o.getEntityRelations(t,e,h);if(!u)continue;l.children||(l.children=[]),l.data.relations=JSON.stringify(u);const d={};for(const f of u){const p=await jg(r,t,f,i);for(const m of p)if(m.data.relations)l.children.push(m);else{const g=t.data.get(f);if(!g){l.children.push(m);continue}const I=g[1][1],C=Ar[I];C in d||(d[C]=[]),m.data.Entity=m.data.Name,delete m.data.Name,d[C].push(m)}}for(const f in d){const p=d[f],m=p.map(I=>I.data.expressID),g={data:{Entity:f,modelID:t.uuid,relations:JSON.stringify(m)},children:p};l.children.push(g)}}return n.push(l),n},Z7=async(r,t,e,i)=>{const s=r.get(pe),n=[];for(const o of t){let a;if(i)a={data:{Entity:o.name!==""?o.name:o.uuid},children:await jg(r,o,i,e)};else{const c=s.relationMaps[o.uuid],l=await o.getAllPropertiesOfType(Bo);if(!(c&&l))continue;const{expressID:h}=Object.values(l)[0];a={data:{Entity:o.name!==""?o.name:o.uuid},children:await jg(r,o,h,e)}}n.push(a)}return n};let un;const q7=(r,t)=>{const e=r.get(Bt),{modelID:i,expressID:s,relations:n}=t;if(!i)return null;const o=e.groups.get(i);return o?o.getFragmentMap([s,...JSON.parse(n??"[]")]):null},Q7=r=>{const{components:t,models:e,expressID:i}=r,s=r.selectHighlighterName??"select",n=r.hoverHighlighterName??"hover";un||(un=document.createElement("bim-table"),un.hiddenColumns=["modelID","expressID","relations"],un.columns=["Entity","Name"],un.headersHidden=!0,un.addEventListener("cellcreated",({detail:a})=>{const{cell:c}=a;c.column==="Entity"&&!("Name"in c.rowData)&&(c.style.gridColumn="1 / -1")})),un.addEventListener("rowcreated",a=>{a.stopImmediatePropagation();const{row:c}=a.detail,l=t.get(Xc),h=q7(t,c.data);h&&Object.keys(h).length!==0&&(c.onmouseover=()=>{n&&(c.style.backgroundColor="var(--bim-ui_bg-contrast-20)",l.highlightByID(n,h,!0,!1,l.selection[s]??{}))},c.onmouseout=()=>{c.style.backgroundColor="",l.clear(n)},c.onclick=()=>{s&&l.highlightByID(s,h,!0,!0)})});const o=r.inverseAttributes??["IsDecomposedBy","ContainsElements"];return Z7(t,e,o,i).then(a=>un.data=a),rt`${un}`},K7=(r,t=!0)=>{const e=Be.create(Q7,r);if(t){const[,i]=e,{components:s}=r,n=s.get(Bt),o=s.get(pe),a=()=>i({models:n.groups.values()});o.onRelationsIndexed.add(a),n.onFragmentsDisposed.add(a)}return e},J7=Object.freeze(Object.defineProperty({__proto__:null,relationsTree:K7},Symbol.toStringTag,{value:"Module"})),Zl=(r,t)=>[...r.get(PE).list.values()].find(e=>e.world===t),tk=(r,t)=>rt`
    <bim-color-input @input=${e=>{const i=e.target;r.color=new Rt(i.color)}} color=${t}></bim-color-input>
  `,ek=(r,t)=>{const{postproduction:e}=r,i=e.n8ao.configuration;return rt`
    <bim-color-input @input=${s=>{const n=s.target;i.color=new Rt(n.color)}} color=${t}></bim-color-input>
  `},ik=(r,t)=>{const{color:e,opacity:i}=JSON.parse(t),{postproduction:s}=r,{customEffects:n}=s;return rt`
    <bim-color-input @input=${o=>{const{color:a,opacity:c}=o.target;n.lineColor=new Rt(a).getHex(),c&&(n.opacity=c/100)}} color=${e} opacity=${i*100}></bim-color-input>
  `},sk=(r,t)=>rt`
    <bim-color-input @input=${e=>{const i=e.target,s=new Rt(i.color);r.material.uniforms.uColor.value=s}} color=${t}></bim-color-input>
  `,nk=(r,t)=>{const{postproduction:e}=r;return rt`
    <bim-checkbox @change=${i=>{const s=i.target;e.setPasses({ao:s.checked})}} .checked=${t}></bim-checkbox>
  `},rk=(r,t)=>{const{postproduction:e}=r;return rt`
    <bim-checkbox @change=${i=>{const s=i.target;e.setPasses({gamma:s.checked})}} .checked=${t}></bim-checkbox>
  `},ok=(r,t)=>{const{postproduction:e}=r;return rt`
    <bim-checkbox @change=${i=>{const s=i.target;e.setPasses({custom:s.checked})}} .checked=${t}></bim-checkbox>
  `},Qn=(r,t,e,i=()=>{})=>rt`
    <bim-checkbox .checked="${e}" @change="${s=>{const n=s.target.checked;r[t]=n,i(n)}}"></bim-checkbox> 
  `,me=(r,t,e,i)=>{const s={slider:!1,min:0,max:100,step:1,prefix:null,suffix:null,onInputSet:()=>{},...i},{slider:n,min:o,max:a,step:c,suffix:l,prefix:h,onInputSet:u}=s;return rt`
    <bim-number-input
      .pref=${h}
      .suffix=${l}
      .slider=${n} 
      min=${o} 
      value="${e}" 
      max=${a} 
      step=${c} 
      @change="${d=>{const f=d.target.value;r[t]=f,u(f)}}"
    ></bim-number-input> 
  `},ak=r=>{const{components:t}=r,e=t.get($o);return rt`
    <bim-table @cellcreated=${({detail:i})=>{const s=i.cell.parentNode;if(!s)return;const n=s.querySelector("bim-table-cell[column='Name']"),o=s.querySelector("bim-table-cell[column='Value']");n&&!o&&(n.style.gridColumn="1 / -1")}} ${ai(async i=>{var s,n,o,a,c;if(!i)return;const l=i;l.preserveStructureOnFilter=!0,l.dataTransform={Value:(u,d)=>{const f=d.World,p=e.list.get(f);if(!p)return u;const{scene:m,camera:g,renderer:I}=p,C=d.Name;if(C==="Grid"&&d.IsGridConfig&&typeof u=="boolean"){const b=Zl(t,p);return b?Qn(b,"visible",u):u}if(C==="Color"&&d.IsGridConfig&&typeof u=="string"){const b=Zl(t,p);return b?sk(b,u):u}if(C==="Distance"&&d.IsGridConfig&&typeof u=="number"){const b=Zl(t,p);return b?me(b.material.uniforms.uDistance,"value",u,{slider:!0,min:300,max:1e3}):u}if(C==="Size"&&d.IsGridConfig&&typeof u=="string"){const b=Zl(t,p);if(!b)return u;const{x:E,y:T}=JSON.parse(u),A=me(b.material.uniforms.uSize1,"value",E,{slider:!0,suffix:"m",prefix:"A",min:1,max:20}),S=me(b.material.uniforms.uSize2,"value",T,{slider:!0,suffix:"m",prefix:"B",min:1,max:20});return rt`
            <div style="display: flex; gap: 0.25rem; width: 100%; flex-wrap: wrap">${A}${S}</div>
          `}if(C==="Near Frustum"&&g.three instanceof hr&&typeof u=="number"){const b=g.three;return me(g.three,"near",u,{slider:!0,min:.1,max:10,step:.1,onInputSet:()=>b.updateProjectionMatrix()})}if(C==="Far Frustum"&&g.three instanceof hr&&typeof u=="number"){const b=g.three;return me(g.three,"far",u,{slider:!0,min:300,max:2e3,step:10,onInputSet:()=>b.updateProjectionMatrix()})}if(C==="Field of View"&&g.three instanceof hr&&typeof u=="number"){const b=g.three;return me(g.three,"fov",u,{slider:!0,min:10,max:120,onInputSet:()=>b.updateProjectionMatrix()})}if(C==="Invert Drag"&&g.hasCameraControls()&&typeof u=="boolean")return Qn(g.controls,"dollyDragInverted",u);if(C==="Dolly Speed"&&g.hasCameraControls()&&typeof u=="number")return me(g.controls,"dollySpeed",u,{slider:!0,min:.5,max:3,step:.1});if(C==="Truck Speed"&&g.hasCameraControls()&&typeof u=="number")return me(g.controls,"truckSpeed",u,{slider:!0,min:.5,max:6,step:.1});if(C==="Smooth Time"&&g.hasCameraControls()&&typeof u=="number")return me(g.controls,"smoothTime",u,{slider:!0,min:.01,max:2,step:.01});if(C==="Intensity"&&typeof u=="number"){if(d.Light&&typeof d.Light=="string"){const b=m.three.children.find(E=>E.uuid===d.Light);return b&&b instanceof al?me(b,"intensity",u,{slider:!0,min:0,max:10,step:.1}):u}if(d.IsAOConfig&&I instanceof ce)return me(I.postproduction.n8ao.configuration,"intensity",u,{slider:!0,max:16,step:.1})}if(C==="Color"&&typeof u=="string"){const b=d.Light,E=m.three.children.find(T=>T.uuid===b);if(E&&E instanceof al)return tk(E,u);if(d.IsAOConfig&&I instanceof ce)return ek(I,u)}if(C==="Ambient Oclussion"&&typeof u=="boolean"&&d.IsAOConfig&&I instanceof ce)return nk(I,u);if(C==="Half Resolution"&&d.IsAOConfig&&I instanceof ce&&typeof u=="boolean")return Qn(I.postproduction.n8ao.configuration,"halfRes",u);if(C==="Screen Space Radius"&&d.IsAOConfig&&I instanceof ce&&typeof u=="boolean")return Qn(I.postproduction.n8ao.configuration,"screenSpaceRadius",u);if(C==="Radius"&&d.IsAOConfig&&I instanceof ce&&typeof u=="number")return me(I.postproduction.n8ao.configuration,"aoRadius",u,{slider:!0,max:2,step:.1});if(C==="Denoise Samples"&&d.IsAOConfig&&I instanceof ce&&typeof u=="number")return me(I.postproduction.n8ao.configuration,"denoiseSamples",u,{slider:!0,min:1,max:16});if(C==="Samples"&&d.IsAOConfig&&I instanceof ce&&typeof u=="number")return me(I.postproduction.n8ao.configuration,"aoSamples",u,{slider:!0,min:1,max:16});if(C==="Denoise Radius"&&d.IsAOConfig&&I instanceof ce&&typeof u=="number")return me(I.postproduction.n8ao.configuration,"denoiseRadius",u,{slider:!0,min:0,max:16,step:.1});if(C==="Distance Falloff"&&d.IsAOConfig&&I instanceof ce&&typeof u=="number")return me(I.postproduction.n8ao.configuration,"distanceFalloff",u,{slider:!0,min:0,max:4,step:.1});if(C==="Directional Light"&&d.Light&&typeof d.Light=="string"&&typeof u=="boolean"){const b=m.three.children.find(E=>E.uuid===d.Light);return b&&b instanceof al?Qn(b,"visible",u):u}if(C==="Ambient Light"&&d.Light&&typeof d.Light=="string"&&typeof u=="boolean"){const b=m.three.children.find(E=>E.uuid===d.Light);return b&&b instanceof al?Qn(b,"visible",u):u}if(C==="Position"&&d.Light&&typeof d.Light=="string"&&typeof u=="string"){const b=m.three.children.find(F=>F.uuid===d.Light);if(!(b&&b instanceof al))return u;const{x:E,y:T,z:A}=JSON.parse(u),S=me(b.position,"x",E,{slider:!0,prefix:"X",suffix:"m",min:-50,max:50}),_=me(b.position,"y",T,{slider:!0,prefix:"Y",suffix:"m",min:-50,max:50}),w=me(b.position,"z",A,{slider:!0,prefix:"Z",suffix:"m",min:-50,max:50});return rt`
            <div style="display: flex; gap: 0.25rem; width: 100%; flex-wrap: wrap">${S}${_}${w}</div>
          `}return C==="Custom Effects"&&d.IsCEConfig&&I instanceof ce&&typeof u=="boolean"?ok(I,u):C==="Color"&&d.IsOutlineConfig&&I instanceof ce&&typeof u=="string"?ik(I,u):C==="Tolerance"&&d.IsOutlineConfig&&I instanceof ce&&typeof u=="number"?me(I.postproduction.customEffects,"tolerance",u,{slider:!0,min:0,max:6,step:.01}):C==="Outline"&&d.IsOutlineConfig&&I instanceof ce&&typeof u=="boolean"?Qn(I.postproduction.customEffects,"outlineEnabled",u):C==="Gloss"&&d.IsGlossConfig&&I instanceof ce&&typeof u=="boolean"?Qn(I.postproduction.customEffects,"glossEnabled",u):C==="Min"&&d.IsGlossConfig&&I instanceof ce&&typeof u=="number"?me(I.postproduction.customEffects,"minGloss",u,{slider:!0,min:-.5,max:.5,step:.01}):C==="Max"&&d.IsGlossConfig&&I instanceof ce&&typeof u=="number"?me(I.postproduction.customEffects,"maxGloss",u,{slider:!0,min:-.5,max:.5,step:.01}):C==="Exponent"&&d.IsGlossConfig&&I instanceof ce&&typeof u=="number"?me(I.postproduction.customEffects,"glossExponent",u,{slider:!0,min:0,max:5,step:.01}):C==="Gamma Correction"&&d.IsGammaConfig&&I instanceof ce&&typeof u=="boolean"?rk(I,u):u}};const h=[];for(const[,u]of e.list){const{scene:d,camera:f,renderer:p}=u,m=Zl(t,u),g={data:{Name:u instanceof Qv&&u.name||u.uuid},children:[]};if(d){const I={data:{Name:"Scene"}};if(m){const E=`#${m.material.uniforms.uColor.value.getHexString()}`,T=JSON.stringify({x:m.material.uniforms.uSize1.value,y:m.material.uniforms.uSize2.value}),A={data:{Name:"Grid",Value:m.three.visible,World:u.uuid,IsGridConfig:!0},children:[{data:{Name:"Color",Value:E,World:u.uuid,IsGridConfig:!0}},{data:{Name:"Size",Value:T,World:u.uuid,IsGridConfig:!0}},{data:{Name:"Distance",Value:m.material.uniforms.uDistance.value,World:u.uuid,IsGridConfig:!0}}]};I.children||(I.children=[]),I.children.push(A)}const C=d.three.children.filter(E=>E instanceof Ny);for(const E of C){const T={data:{Name:"Directional Light",Value:E.visible,World:u.uuid,Light:E.uuid},children:[{data:{Name:"Position",Value:JSON.stringify(E.position),World:u.uuid,Light:E.uuid}},{data:{Name:"Intensity",Value:E.intensity,World:u.uuid,Light:E.uuid}},{data:{Name:"Color",Value:`#${E.color.getHexString()}`,World:u.uuid,Light:E.uuid}}]};I.children||(I.children=[]),I.children.push(T)}const b=d.three.children.filter(E=>E instanceof Py);for(const E of b){const T={data:{Name:"Ambient Light",Value:E.visible,World:u.uuid,Light:E.uuid},children:[{data:{Name:"Intensity",Value:E.intensity,World:u.uuid,Light:E.uuid}},{data:{Name:"Color",Value:`#${E.color.getHexString()}`,World:u.uuid,Light:E.uuid}}]};I.children||(I.children=[]),I.children.push(T)}I.children&&((s=I.children)==null?void 0:s.length)>0&&((n=g.children)==null||n.push(I))}if(f.three instanceof hr){const I={data:{Name:"Perspective Camera"},children:[{data:{Name:"Near Frustum",Value:f.three.near,World:u.uuid}},{data:{Name:"Far Frustum",Value:f.three.far,World:u.uuid}},{data:{Name:"Field of View",Value:f.three.fov,World:u.uuid}}]};if(f.hasCameraControls()){const{controls:C}=f,b={dollyDragInverted:"Invert Drag",dollySpeed:"Dolly Speed",truckSpeed:"Truck Speed",smoothTime:"Smooth Time"};for(const E in b){const T=C[E];T!=null&&((o=I.children)==null||o.push({data:{Name:b[E],Value:T,World:u.uuid}}))}}(a=g.children)==null||a.push(I)}if(p instanceof ce){const{postproduction:I}=p,C=I.n8ao.configuration,b={data:{Name:"Renderer"},children:[{data:{Name:"Gamma Correction",Value:I.settings.gamma??!1,World:u.uuid,IsGammaConfig:!0}},{data:{Name:"Ambient Oclussion",Value:I.settings.ao??!1,World:u.uuid,IsAOConfig:!0},children:[{data:{Name:"Samples",Value:C.aoSamples,World:u.uuid,IsAOConfig:!0}},{data:{Name:"Color",Value:`#${C.color.getHexString()}`,World:u.uuid,IsAOConfig:!0}},{data:{Name:"Half Resolution",Value:C.halfRes,World:u.uuid,IsAOConfig:!0}},{data:{Name:"Screen Space Radius",Value:C.screenSpaceRadius,World:u.uuid,IsAOConfig:!0}},{data:{Name:"Radius",Value:C.aoRadius,World:u.uuid,IsAOConfig:!0}},{data:{Name:"Intensity",Value:C.intensity,World:u.uuid,IsAOConfig:!0}},{data:{Name:"Distance Falloff",Value:C.distanceFalloff,World:u.uuid,IsAOConfig:!0}},{data:{Name:"Denoise Samples",Value:C.denoiseSamples,World:u.uuid,IsAOConfig:!0}},{data:{Name:"Denoise Radius",Value:C.denoiseRadius,World:u.uuid,IsAOConfig:!0}}]},{data:{Name:"Custom Effects",Value:I.settings.custom??!1,World:u.uuid,IsCEConfig:!0},children:[{data:{Name:"Gloss",Value:I.customEffects.glossEnabled,World:u.uuid,IsGlossConfig:!0},children:[{data:{Name:"Min",Value:I.customEffects.minGloss,World:u.uuid,IsGlossConfig:!0}},{data:{Name:"Max",Value:I.customEffects.maxGloss,World:u.uuid,IsGlossConfig:!0}},{data:{Name:"Exponent",Value:I.customEffects.glossExponent,World:u.uuid,IsGlossConfig:!0}}]},{data:{Name:"Outline",Value:I.customEffects.outlineEnabled,World:u.uuid,IsOutlineConfig:!0},children:[{data:{Name:"Color",get Value(){const E=new Rt(I.customEffects.lineColor),T=I.customEffects.opacity;return JSON.stringify({color:`#${E.getHexString()}`,opacity:T})},World:u.uuid,IsOutlineConfig:!0}},{data:{Name:"Tolerance",Value:I.customEffects.tolerance,World:u.uuid,IsOutlineConfig:!0}}]}]}]};(c=g.children)==null||c.push(b)}h.push(g)}l.columns=[{name:"Name",width:"11rem"}],l.hiddenColumns=["World","Light","IsAOConfig","IsCEConfig","IsGlossConfig","IsOutlineConfig","IsGammaConfig","IsGridConfig"],l.data=h})} headers-hidden expanded>
     <bim-label slot="missing-data" style="--bim-icon--c: gold" icon="ic:round-warning">
        No worlds to configure
      </bim-label>
    </bim-table>
  `},ck=(r,t=!0)=>{const e=Be.create(ak,r);if(t){const[,i]=e,{components:s}=r;s.get($o).list.onItemDeleted.add(()=>i())}return e},lk=Object.freeze(Object.defineProperty({__proto__:null,worldsConfiguration:ck},Symbol.toStringTag,{value:"Module"})),Xa=(r,t)=>{const e=t[r],i=e?.name??r,s=i.trim().split(/\s+/);let n,o;return s[0]&&s[0][0]&&(n=s[0][0].toUpperCase(),s[0][1]&&(o=s[0][1].toUpperCase())),s[1]&&s[1][0]&&(o=s[1][0].toUpperCase()),rt`
    <div style="display: flex; gap: 0.25rem; overflow: hidden;">
      ${!(e!=null&&e.picture)&&(n||o)?rt`
        <bim-label
          style=${bo({borderRadius:"999px",padding:"0.375rem",backgroundColor:"var(--bim-ui_bg-contrast-20)",aspectRatio:"1",fontSize:"0.7rem"})}>${n}${o}</bim-label>
        `:null}
      <bim-label .img=${e?.picture}>${i}</bim-label>
    </div>
  `},Ei={users:{"jhon.doe@example.com":{name:"Jhon Doe"}},priorities:{"On hold":{icon:"flowbite:circle-pause-outline",style:{backgroundColor:"var(--bim-ui_bg-contrast-20)","--bim-icon--c":"#767676"}},Minor:{icon:"mingcute:arrows-down-fill",style:{backgroundColor:"var(--bim-ui_bg-contrast-20)","--bim-icon--c":"#4CAF50"}},Normal:{icon:"fa6-solid:grip-lines",style:{backgroundColor:"var(--bim-ui_bg-contrast-20)","--bim-icon--c":"#FB8C00"}},Major:{icon:"mingcute:arrows-up-fill",style:{backgroundColor:"var(--bim-ui_bg-contrast-20)","--bim-icon--c":"#FF5252"}},Critical:{icon:"ph:warning",style:{backgroundColor:"var(--bim-ui_bg-contrast-20)","--bim-icon--c":"#FB8C00"}}},statuses:{Active:{icon:"prime:circle-fill",style:{backgroundColor:"var(--bim-ui_bg-contrast-20)"}},"In Progress":{icon:"prime:circle-fill",style:{backgroundColor:"#fa89004d","--bim-label--c":"#FB8C00","--bim-icon--c":"#FB8C00"}},"In Review":{icon:"prime:circle-fill",style:{backgroundColor:"#9c6bff4d","--bim-label--c":"#9D6BFF","--bim-icon--c":"#9D6BFF"}},Done:{icon:"prime:circle-fill",style:{backgroundColor:"#4CAF504D","--bim-label--c":"#4CAF50","--bim-icon--c":"#4CAF50"}},Closed:{icon:"prime:circle-fill",style:{backgroundColor:"#414141","--bim-label--c":"#727272","--bim-icon--c":"#727272"}}},types:{Clash:{icon:"gg:close-r",style:{backgroundColor:"var(--bim-ui_bg-contrast-20)","--bim-icon--c":"#FB8C00"}},Issue:{icon:"mdi:bug-outline",style:{backgroundColor:"var(--bim-ui_bg-contrast-20)","--bim-icon--c":"#FF5252"}},Failure:{icon:"mdi:bug-outline",style:{backgroundColor:"var(--bim-ui_bg-contrast-20)","--bim-icon--c":"#FF5252"}},Inquiry:{icon:"majesticons:comment-line",style:{backgroundColor:"var(--bim-ui_bg-contrast-20)","--bim-icon--c":"#FF5252"}},Fault:{icon:"ph:warning",style:{backgroundColor:"var(--bim-ui_bg-contrast-20)","--bim-icon--c":"#FF5252"}},Remark:{icon:"ph:note-blank-bold",style:{backgroundColor:"var(--bim-ui_bg-contrast-20)","--bim-icon--c":"#FB8C00"}},Request:{icon:"mynaui:edit-one",style:{backgroundColor:"var(--bim-ui_bg-contrast-20)","--bim-icon--c":"#9D6BFF"}}}},Za={padding:"0.25rem 0.5rem",borderRadius:"999px","--bim-label--c":"var(--bim-ui_bg-contrast-100)"};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const zf=globalThis,Yf=zf.trustedTypes,gy=Yf?Yf.createPolicy("lit-html",{createHTML:r=>r}):void 0,y_="$lit$",lr=`lit$${Math.random().toFixed(9).slice(2)}$`,v_="?"+lr,hk=`<${v_}>`,Lo=document,zh=()=>Lo.createComment(""),Yh=r=>r===null||typeof r!="object"&&typeof r!="function",m0=Array.isArray,uk=r=>m0(r)||typeof r?.[Symbol.iterator]=="function",oI=`[ 	
\f\r]`,ql=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Ey=/-->/g,Cy=/>/g,io=RegExp(`>|${oI}(?:([^\\s"'>=/]+)(${oI}*=${oI}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),by=/'/g,Ty=/"/g,R_=/^(?:script|style|textarea|title)$/i,dk=r=>(t,...e)=>({_$litType$:r,strings:t,values:e}),I0=dk(1),gc=Symbol.for("lit-noChange"),Fe=Symbol.for("lit-nothing"),yy=new WeakMap,mo=Lo.createTreeWalker(Lo,129);function A_(r,t){if(!m0(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return gy!==void 0?gy.createHTML(t):t}const fk=(r,t)=>{const e=r.length-1,i=[];let s,n=t===2?"<svg>":t===3?"<math>":"",o=ql;for(let a=0;a<e;a++){const c=r[a];let l,h,u=-1,d=0;for(;d<c.length&&(o.lastIndex=d,h=o.exec(c),h!==null);)d=o.lastIndex,o===ql?h[1]==="!--"?o=Ey:h[1]!==void 0?o=Cy:h[2]!==void 0?(R_.test(h[2])&&(s=RegExp("</"+h[2],"g")),o=io):h[3]!==void 0&&(o=io):o===io?h[0]===">"?(o=s??ql,u=-1):h[1]===void 0?u=-2:(u=o.lastIndex-h[2].length,l=h[1],o=h[3]===void 0?io:h[3]==='"'?Ty:by):o===Ty||o===by?o=io:o===Ey||o===Cy?o=ql:(o=io,s=void 0);const f=o===io&&r[a+1].startsWith("/>")?" ":"";n+=o===ql?c+hk:u>=0?(i.push(l),c.slice(0,u)+y_+c.slice(u)+lr+f):c+lr+(u===-2?a:f)}return[A_(r,n+(r[e]||"<?>")+(t===2?"</svg>":t===3?"</math>":"")),i]};class Gh{constructor({strings:t,_$litType$:e},i){let s;this.parts=[];let n=0,o=0;const a=t.length-1,c=this.parts,[l,h]=fk(t,e);if(this.el=Gh.createElement(l,i),mo.currentNode=this.el.content,e===2||e===3){const u=this.el.content.firstChild;u.replaceWith(...u.childNodes)}for(;(s=mo.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const u of s.getAttributeNames())if(u.endsWith(y_)){const d=h[o++],f=s.getAttribute(u).split(lr),p=/([.?@])?(.*)/.exec(d);c.push({type:1,index:n,name:p[2],strings:f,ctor:p[1]==="."?mk:p[1]==="?"?Ik:p[1]==="@"?gk:Bp}),s.removeAttribute(u)}else u.startsWith(lr)&&(c.push({type:6,index:n}),s.removeAttribute(u));if(R_.test(s.tagName)){const u=s.textContent.split(lr),d=u.length-1;if(d>0){s.textContent=Yf?Yf.emptyScript:"";for(let f=0;f<d;f++)s.append(u[f],zh()),mo.nextNode(),c.push({type:2,index:++n});s.append(u[d],zh())}}}else if(s.nodeType===8)if(s.data===v_)c.push({type:2,index:n});else{let u=-1;for(;(u=s.data.indexOf(lr,u+1))!==-1;)c.push({type:7,index:n}),u+=lr.length-1}n++}}static createElement(t,e){const i=Lo.createElement("template");return i.innerHTML=t,i}}function Ec(r,t,e=r,i){var s,n;if(t===gc)return t;let o=i!==void 0?(s=e._$Co)==null?void 0:s[i]:e._$Cl;const a=Yh(t)?void 0:t._$litDirective$;return o?.constructor!==a&&((n=o?._$AO)==null||n.call(o,!1),a===void 0?o=void 0:(o=new a(r),o._$AT(r,e,i)),i!==void 0?(e._$Co??(e._$Co=[]))[i]=o:e._$Cl=o),o!==void 0&&(t=Ec(r,o._$AS(r,t.values),o,i)),t}class pk{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:e},parts:i}=this._$AD,s=(t?.creationScope??Lo).importNode(e,!0);mo.currentNode=s;let n=mo.nextNode(),o=0,a=0,c=i[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new mu(n,n.nextSibling,this,t):c.type===1?l=new c.ctor(n,c.name,c.strings,this,t):c.type===6&&(l=new Ek(n,this,t)),this._$AV.push(l),c=i[++a]}o!==c?.index&&(n=mo.nextNode(),o++)}return mo.currentNode=Lo,s}p(t){let e=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}}class mu{get _$AU(){var t;return((t=this._$AM)==null?void 0:t._$AU)??this._$Cv}constructor(t,e,i,s){this.type=2,this._$AH=Fe,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return e!==void 0&&t?.nodeType===11&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=Ec(this,t,e),Yh(t)?t===Fe||t==null||t===""?(this._$AH!==Fe&&this._$AR(),this._$AH=Fe):t!==this._$AH&&t!==gc&&this._(t):t._$litType$!==void 0?this.$(t):t.nodeType!==void 0?this.T(t):uk(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==Fe&&Yh(this._$AH)?this._$AA.nextSibling.data=t:this.T(Lo.createTextNode(t)),this._$AH=t}$(t){var e;const{values:i,_$litType$:s}=t,n=typeof s=="number"?this._$AC(t):(s.el===void 0&&(s.el=Gh.createElement(A_(s.h,s.h[0]),this.options)),s);if(((e=this._$AH)==null?void 0:e._$AD)===n)this._$AH.p(i);else{const o=new pk(n,this),a=o.u(this.options);o.p(i),this.T(a),this._$AH=o}}_$AC(t){let e=yy.get(t.strings);return e===void 0&&yy.set(t.strings,e=new Gh(t)),e}k(t){m0(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,s=0;for(const n of t)s===e.length?e.push(i=new mu(this.O(zh()),this.O(zh()),this,this.options)):i=e[s],i._$AI(n),s++;s<e.length&&(this._$AR(i&&i._$AB.nextSibling,s),e.length=s)}_$AR(t=this._$AA.nextSibling,e){var i;for((i=this._$AP)==null?void 0:i.call(this,!1,!0,e);t&&t!==this._$AB;){const s=t.nextSibling;t.remove(),t=s}}setConnected(t){var e;this._$AM===void 0&&(this._$Cv=t,(e=this._$AP)==null||e.call(this,t))}}class Bp{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,e,i,s,n){this.type=1,this._$AH=Fe,this._$AN=void 0,this.element=t,this.name=e,this._$AM=s,this.options=n,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=Fe}_$AI(t,e=this,i,s){const n=this.strings;let o=!1;if(n===void 0)t=Ec(this,t,e,0),o=!Yh(t)||t!==this._$AH&&t!==gc,o&&(this._$AH=t);else{const a=t;let c,l;for(t=n[0],c=0;c<n.length-1;c++)l=Ec(this,a[i+c],e,c),l===gc&&(l=this._$AH[c]),o||(o=!Yh(l)||l!==this._$AH[c]),l===Fe?t=Fe:t!==Fe&&(t+=(l??"")+n[c+1]),this._$AH[c]=l}o&&!s&&this.j(t)}j(t){t===Fe?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class mk extends Bp{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===Fe?void 0:t}}class Ik extends Bp{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==Fe)}}class gk extends Bp{constructor(t,e,i,s,n){super(t,e,i,s,n),this.type=5}_$AI(t,e=this){if((t=Ec(this,t,e,0)??Fe)===gc)return;const i=this._$AH,s=t===Fe&&i!==Fe||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,n=t!==Fe&&(i===Fe||s);s&&this.element.removeEventListener(this.name,this,i),n&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e;typeof this._$AH=="function"?this._$AH.call(((e=this.options)==null?void 0:e.host)??this.element,t):this._$AH.handleEvent(t)}}class Ek{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){Ec(this,t)}}const vy=zf.litHtmlPolyfillSupport;vy?.(Gh,mu),(zf.litHtmlVersions??(zf.litHtmlVersions=[])).push("3.2.1");const Ck=(r,t,e)=>{const i=e?.renderBefore??t;let s=i._$litPart$;if(s===void 0){const n=e?.renderBefore??null;i._$litPart$=s=new mu(t.insertBefore(zh(),n),n,void 0,e??{})}return s._$AI(r),s};/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const bk=r=>r.strings===void 0;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Tk={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},yk=r=>(...t)=>({_$litDirective$:r,values:t});let vk=class{constructor(r){}get _$AU(){return this._$AM._$AU}_$AT(r,t,e){this._$Ct=r,this._$AM=t,this._$Ci=e}_$AS(r,t){return this.update(r,t)}update(r,t){return this.render(...t)}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ih=(r,t)=>{var e;const i=r._$AN;if(i===void 0)return!1;for(const s of i)(e=s._$AO)==null||e.call(s,t,!1),Ih(s,t);return!0},Gf=r=>{let t,e;do{if((t=r._$AM)===void 0)break;e=t._$AN,e.delete(r),r=t}while(e?.size===0)},S_=r=>{for(let t;t=r._$AM;r=t){let e=t._$AN;if(e===void 0)t._$AN=e=new Set;else if(e.has(r))break;e.add(r),Sk(t)}};function Rk(r){this._$AN!==void 0?(Gf(this),this._$AM=r,S_(this)):this._$AM=r}function Ak(r,t=!1,e=0){const i=this._$AH,s=this._$AN;if(s!==void 0&&s.size!==0)if(t)if(Array.isArray(i))for(let n=e;n<i.length;n++)Ih(i[n],!1),Gf(i[n]);else i!=null&&(Ih(i,!1),Gf(i));else Ih(this,r)}const Sk=r=>{r.type==Tk.CHILD&&(r._$AP??(r._$AP=Ak),r._$AQ??(r._$AQ=Rk))};let wk=class extends vk{constructor(){super(...arguments),this._$AN=void 0}_$AT(r,t,e){super._$AT(r,t,e),S_(this),this.isConnected=r._$AU}_$AO(r,t=!0){var e,i;r!==this.isConnected&&(this.isConnected=r,r?(e=this.reconnected)==null||e.call(this):(i=this.disconnected)==null||i.call(this)),t&&(Ih(this,r),Gf(this))}setValue(r){if(bk(this._$Ct))this._$Ct._$AI(r,this);else{const t=[...this._$Ct._$AH];t[this._$Ci]=r,this._$Ct._$AI(t,this,0)}}disconnected(){}reconnected(){}};/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Xg=()=>new _k;let _k=class{};const aI=new WeakMap,Fk=yk(class extends wk{render(r){return Fe}update(r,[t]){var e;const i=t!==this.Y;return i&&this.Y!==void 0&&this.rt(void 0),(i||this.lt!==this.ct)&&(this.Y=t,this.ht=(e=r.options)==null?void 0:e.host,this.rt(this.ct=r.element)),Fe}rt(r){if(this.isConnected||(r=void 0),typeof this.Y=="function"){const t=this.ht??globalThis;let e=aI.get(t);e===void 0&&(e=new WeakMap,aI.set(t,e)),e.get(this.Y)!==void 0&&this.Y.call(this.ht,void 0),e.set(this.Y,r),r!==void 0&&this.Y.call(this.ht,r)}else this.Y.value=r}get lt(){var r,t;return typeof this.Y=="function"?(r=aI.get(this.ht??globalThis))==null?void 0:r.get(this.Y):(t=this.Y)==null?void 0:t.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}}),Ok={dueDate:r=>{if(typeof r=="string"&&r.trim()!=="")return new Date(r)},status:r=>{if(Array.isArray(r)&&r.length!==0)return r[0]},type:r=>{if(Array.isArray(r)&&r.length!==0)return r[0]},priority:r=>{if(Array.isArray(r)&&r.length!==0)return r[0]},stage:r=>{if(Array.isArray(r)&&r.length!==0)return r[0]},assignedTo:r=>{if(Array.isArray(r)&&r.length!==0)return r[0]},labels:r=>{if(Array.isArray(r))return new Set(r)}},w_=r=>{const{components:t,topic:e,value:i,onCancel:s,onSubmit:n,styles:o}=r,a=n??(()=>{}),c=t.get(De),l=i?.title??e?.title??Xs.default.title,h=i?.status??e?.status??Xs.default.status,u=i?.type??e?.type??Xs.default.type,d=i?.priority??e?.priority??Xs.default.priority,f=i?.assignedTo??e?.assignedTo??Xs.default.assignedTo,p=i?.labels??e?.labels??Xs.default.labels,m=i?.stage??e?.stage??Xs.default.stage,g=i?.description??e?.description??Xs.default.description,I=e!=null&&e.dueDate?e.dueDate.toISOString().split("T")[0]:null,C=new Set([...c.config.statuses]);h&&C.add(h);const b=new Set([...c.config.types]);u&&b.add(u);const E=new Set([...c.config.priorities]);d&&E.add(d);const T=new Set([...c.config.users]);f&&T.add(f);const A=new Set([...c.config.labels]);if(p)for(const y of p)A.add(y);const S=new Set([...c.config.stages]);m&&S.add(m);const _=Xg(),w=async()=>{const{value:y}=_;if(!y)return;const U=Vh(y,Ok);if(e)e.set(U),await a(e);else{const H=c.create(U);await a(H)}},F=Xg(),D=y=>{const{value:U}=F;if(!U)return;const H=y.target;U.disabled=H.value.trim()===""},R=`btn-${Oi.newRandomId()}`,O=`btn-${Oi.newRandomId()}`;return rt`
    <div ${ai(_)} style="display: flex; flex-direction: column; gap: 0.75rem;">
      <div style="display: flex; gap: 0.375rem">
        <bim-text-input @input=${D} vertical label="Title" name="title" .value=${l}></bim-text-input>
        ${e?rt`
            <bim-dropdown vertical label="Status" name="status" required>
              ${[...C].map(y=>rt`<bim-option label=${y} .checked=${h===y}></bim-option>`)}
            </bim-dropdown>`:rt``}
      </div>
      <div style="display: flex; gap: 0.375rem">
        <bim-dropdown vertical label="Type" name="type" required>
          ${[...b].map(y=>rt`<bim-option label=${y} .checked=${u===y}></bim-option>`)}
        </bim-dropdown>
        <bim-dropdown vertical label="Priority" name="priority">
          ${[...E].map(y=>rt`<bim-option label=${y} .checked=${d===y}></bim-option>`)}
        </bim-dropdown>
      </div>
      <div style="display: flex; gap: 0.375rem">
        <bim-dropdown vertical label="Labels" name="labels" multiple>
          ${[...A].map(y=>rt`<bim-option label=${y} .checked=${p?[...p].includes(y):!1}></bim-option>`)}
        </bim-dropdown>
        <bim-dropdown vertical label="Assignee" name="assignedTo">
          ${[...T].map(y=>{const U=o!=null&&o.users?o.users[y]:null,H=U?U.name:y,k=U?.picture;return rt`<bim-option label=${H} value=${y} .img=${k} .checked=${f===y}></bim-option>`})}
        </bim-dropdown>
      </div>
      <div style="display: flex; gap: 0.375rem">
        <bim-text-input vertical type="date" label="Due Date" name="dueDate" .value=${I}></bim-text-input> 
        <bim-dropdown vertical label="Stage" name="stage">
          ${[...S].map(y=>rt`<bim-option label=${y} .checked=${m===y}></bim-option>`)}
        </bim-dropdown>
      </div>
      <bim-text-input vertical label="Description" name="description" type="area" .value=${g??null}></bim-text-input>
      <div style="justify-content: right; display: flex; gap: 0.375rem">
        <style>
          #${O} {
            background-color: transparent;
          }

          #${O}:hover {
            --bim-label--c: #FF5252;
          }

          #${R}:hover {
            background-color: #329936;
          }
        </style>
        <bim-button id=${O} style="flex: 0" @click=${s} label="Cancel"></bim-button>
        <bim-button id=${R} style="flex: 0" @click=${w} ${ai(F)} label=${e?"Update Topic":"Add Topic"} icon=${e?"tabler:refresh":"mi:add"}></bim-button>
      </div>
    </div>
  `},xk=r=>{const{components:t,dataStyles:e,onTopicEnter:i}=r,s=t.get(De),n=r.topics??s.list.values();return rt`
    <bim-table no-indentation ${ai(o=>{if(!o)return;const a=o;a.hiddenColumns.length===0&&(a.hiddenColumns=["Guid"]),a.columns=["Title"],a.dataTransform={Title:(c,l)=>{const{Guid:h}=l;if(typeof h!="string")return c;const u=s.list.get(h);if(!u)return c;const d=`btn-${Oi.newRandomId()}`;return rt`
          <div style="display: flex; overflow: hidden;">
            <style>
              #${d} {
                background-color: transparent
              }

              #${d}:hover {
                --bim-label--c: var(--bim-ui_accent-base)
              }
            </style>
            <bim-button @click=${()=>{i&&i(u)}} id=${d} icon="iconamoon:enter-duotone"></bim-button>
            <bim-label>${c}</bim-label>
          </div>
        `},Priority:c=>{if(typeof c!="string")return c;const l=(e?.priorities??Ei.priorities)[c];return rt`
          <bim-label
            .icon=${l?.icon}
            style=${bo({...Za,...l?.style})}
          >${c}
          </bim-label>
        `},Status:c=>{if(typeof c!="string")return c;const l=(e?.statuses??Ei.statuses)[c];return rt`
          <bim-label
            .icon=${l?.icon}
            style=${bo({...Za,...l?.style})}
          >${c}
          </bim-label>
        `},Type:c=>{if(typeof c!="string")return c;const l=(e?.types??Ei.types)[c];return rt`
          <bim-label
            .icon=${l?.icon}
            style=${bo({...Za,...l?.style})}
          >${c}
          </bim-label>
        `},Author:c=>typeof c!="string"?c:Xa(c,e?.users??Ei.users),Assignee:c=>typeof c!="string"?c:Xa(c,e?.users??Ei.users)},a.data=[...n].map(c=>{var l;return{data:{Guid:c.guid,Title:c.title,Status:c.status,Description:c.description??"",Author:c.creationAuthor,Assignee:c.assignedTo??"",Date:c.creationDate.toDateString(),DueDate:((l=c.dueDate)==null?void 0:l.toDateString())??"",Type:c.type,Priority:c.priority??""}}})})}>
      <bim-label slot="missing-data" icon="ph:warning-fill" style="--bim-icon--c: gold;">There are no topics to display</bim-label>
    </bim-table>
  `},__=(r,t=!0)=>{const e=Be.create(xk,r);if(t){const{components:i,topics:s}=r,[,n]=e,o=i.get(De);if(o.list.onItemUpdated.add(()=>n()),o.list.onItemDeleted.add(()=>n()),s)for(const a of s)a.relatedTopics.onItemAdded.add(()=>n()),a.relatedTopics.onItemDeleted.add(()=>n()),a.relatedTopics.onCleared.add(()=>n());else o.list.onItemSet.add(()=>n())}return e},Nk=Object.freeze(Object.defineProperty({__proto__:null,topicsList:__},Symbol.toStringTag,{value:"Module"})),Pk=r=>{const{topic:t,styles:e,viewpoint:i}=r,s={delete:!0,...r.actions};return rt`
    <bim-table no-indentation ${ai(n=>{if(!n)return;const o=n;o.headersHidden=!0,o.hiddenColumns=["guid","author"],o.dataTransform={Comment:(c,l)=>{const{guid:h}=l;if(typeof h!="string")return c;const u=t.comments.get(h);if(!u)return c;const d=()=>{t.comments.delete(h)},f=`btn-${Oi.newRandomId()}`;return rt`
          <div style="display: flex; flex-direction: column; gap: 0.25rem; flex: 1">
            <div style="display: flex; justify-content: space-between;">
              <div style="display: flex; gap: 0.375rem;">
                ${Xa(u.author,e??Ei.users)}
                <bim-label style="color: var(--bim-ui_bg-contrast-40)">@ ${u.date.toDateString()}</bim-label>
              </div>
              <div>
                <style>
                  #${f} {
                    background-color: transparent;
                    --bim-label--c: var(--bim-ui_bg-contrast-60)
                  }

                  #${f}:hover {
                    --bim-label--c: #FF5252;
                  }
                </style>
                ${s!=null&&s.delete?rt`<bim-button @click=${d} id=${f} icon="majesticons:delete-bin"></bim-button>`:null}
              </div>
            </div>
            <bim-label style="margin-left: 1.7rem; white-space: normal">${u.comment}</bim-label>
          </div>
        `}};let a=t.comments.values();i&&(a=[...t.comments.values()].filter(c=>c.viewpoint===i)),o.data=[...a].map(c=>({data:{guid:c.guid,Comment:c.comment,author:(()=>{const l=e;if(!l)return c.author;const h=l[c.author];return h?.name??c.author})()}}))})}>
      <bim-label slot="missing-data" icon="ph:warning-fill" style="--bim-icon--c: gold;">This topic has no comments</bim-label>
    </bim-table>
  `},F_=(r,t=!0)=>{const e=Be.create(Pk,r);if(t){const{topic:i}=r,[s,n]=e;i.comments.onItemSet.add(()=>n()),i.comments.onItemUpdated.add(()=>n()),i.comments.onItemDeleted.add(()=>n()),i.comments.onCleared.add(()=>n())}return e},Lk=Object.freeze(Object.defineProperty({__proto__:null,topicComments:F_},Symbol.toStringTag,{value:"Module"})),Mk=r=>{var t;const{components:e,topic:i}=r,s={selectComponents:!0,colorizeComponent:!0,resetColors:!0,updateCamera:!0,delete:!0,unlink:!!i,...r.actions},n=e.get(Zi),o=((t=r.topic)==null?void 0:t.viewpoints)??n.list.keys(),a=[];for(const c of o){const l=n.list.get(c);l&&a.push(l)}return rt`
    <bim-table no-indentation ${ai(c=>{if(!c)return;const l=c;l.addEventListener("cellcreated",({detail:h})=>{const{cell:u}=h;u.style.padding="0.25rem"}),l.headersHidden=!0,l.hiddenColumns=["Guid"],l.columns=["Title",{name:"Actions",width:"auto"}],l.dataTransform={Actions:(h,u)=>{const{Guid:d}=u;if(!(d&&typeof d=="string"))return d||"";const f=n.list.get(d);return f?rt`
          <bim-button icon="ph:eye-fill" @click=${()=>f.go()}></bim-button>
          ${Object.values(s).includes(!0)?rt`
                <bim-button icon="prime:ellipsis-v">
                  <bim-context-menu>
                    ${s.selectComponents?rt`<bim-button label="Select Components" @click=${()=>console.log(f.selection)}></bim-button> `:null}
                    ${s.colorizeComponent?rt`<bim-button label="Colorize Components" @click=${()=>f.applyColors()}></bim-button> `:null}
                    ${s.resetColors?rt`<bim-button label="Reset Colors" @click=${()=>f.resetColors()}></bim-button> `:null}
                    ${s.updateCamera?rt`<bim-button label="Update Camera" @click=${()=>f.updateCamera()}></bim-button> `:null}
                    ${s.unlink?rt`<bim-button .disabled=${!i} label="Unlink" @click=${()=>i?.viewpoints.delete(f.guid)}></bim-button> `:null}
                    ${s.delete?rt`<bim-button label="Delete" @click=${()=>n.list.delete(f.guid)}></bim-button>`:null}
                  </bim-context-menu>
                </bim-button>
              `:null}
        `:d}},l.data=a.map((h,u)=>({data:{Guid:h.guid,Title:h.title??`Viewpoint ${r.topic?u+1:""}`,Actions:""}}))})}>
      <bim-label slot="missing-data" icon="ph:warning-fill" style="--bim-icon--c: gold;">No viewpoints to show</bim-label>
    </bim-table>
  `},O_=(r,t=!0)=>{const e=Be.create(Mk,r),{components:i,topic:s}=r;if(t){const[,n]=e,o=i.get(Zi);o.list.onItemUpdated.add(()=>n()),o.list.onItemDeleted.add(()=>n()),o.list.onCleared.add(()=>n()),s?(s.viewpoints.onItemAdded.add(()=>n()),s.viewpoints.onItemDeleted.add(()=>n()),s.viewpoints.onCleared.add(()=>n())):o.list.onItemSet.add(()=>n())}return e},Dk=Object.freeze(Object.defineProperty({__proto__:null,viewpointsList:O_},Symbol.toStringTag,{value:"Module"})),g0={...S7,...F7,...N7,...X7,...J7,...lk,...Nk,...Lk,...Dk},Uk=r=>rt`
    <bim-panel-section fixed label="New Topic" name="topic">
      ${w_(r)}
    </bim-panel-section>
  `,Bk=r=>Be.create(Uk,r),kk=Object.freeze(Object.defineProperty({__proto__:null,topic:Bk},Symbol.toStringTag,{value:"Module"}));({...kk});const Vk=(r,t)=>{const{components:e,editing:i,topic:s,styles:n}=r,o={update:!0,...r.actions},a=n?.priorities??Ei.priorities,c=n?.statuses??Ei.statuses,l=n?.types??Ei.types;let h;s!=null&&s.priority&&(h=a[s.priority]);let u;s!=null&&s.type&&(u=l[s.type]);let d;s!=null&&s.type&&(d=c[s.status]);let f,p;return i?f=w_({components:e,topic:s,styles:n,onSubmit:()=>{t({editing:!1})},onCancel:()=>{t({editing:!1})}}):p=rt`
      <div>
        <bim-label>Title</bim-label>
        <bim-label style="--bim-label--c: var(--bim-ui_bg-contrast-100)">${s.title}</bim-label>
      </div>

      ${s.description?rt`
            <div>
              <bim-label>Description</bim-label>
              <bim-label style="--bim-label--c: var(--bim-ui_bg-contrast-100); white-space: normal">${s.description}</bim-label>
            </div>
          `:null}

      <div style="display: flex; gap: 0.375rem">
        <bim-label>Status</bim-label>
        <bim-label .icon=${d?.icon} style=${bo({...Za,...d?.style})}
        >${s.status}
        </bim-label>
      </div>

      <div style="display: flex; gap: 0.375rem">
        <bim-label>Type</bim-label>
        <bim-label .icon=${u?.icon} style=${bo({...Za,...u?.style})}
        >${s.type}
        </bim-label>
      </div>

      ${s.priority?rt`
            <div style="display: flex; gap: 0.375rem">
              <bim-label>Priority</bim-label>
              <bim-label .icon=${h?.icon} style=${bo({...Za,...h?.style})}
              >${s.priority}
              </bim-label>
            </div>`:null}

      <div style="display: flex; gap: 0.375rem">
        <bim-label>Author</bim-label>
        ${Xa(s.creationAuthor,n?.users??Ei.users)}
      </div>

      ${s.assignedTo?rt`
          <div style="display: flex; gap: 0.375rem">
            <bim-label>Assignee</bim-label>
            ${Xa(s.assignedTo,n?.users??Ei.users)}
          </div>`:null}

      ${s.dueDate?rt`
          <div style="display: flex; gap: 0.375rem">
            <bim-label>Due Date</bim-label>
            <bim-label style="--bim-label--c: var(--bim-ui_bg-contrast-100)">${s.dueDate.toDateString()}</bim-label>
          </div>`:null}

      ${s.modifiedAuthor?rt`
          <div style="display: flex; gap: 0.375rem">
            <bim-label>Modified By</bim-label>
            ${Xa(s.modifiedAuthor,n?.users??Ei.users)}
          </div>`:null}

      ${s.modifiedDate?rt`
            <div style="display: flex; gap: 0.375rem">
              <bim-label>Modified Date</bim-label>
              <bim-label style="--bim-label--c: var(--bim-ui_bg-contrast-100)">${s.modifiedDate.toDateString()}</bim-label>
            </div>`:null}

      ${s.labels.size!==0?rt`
          <div style="display: flex; gap: 0.375rem">
            <bim-label>Labels</bim-label>
            <bim-label style="--bim-label--c: var(--bim-ui_bg-contrast-100)">${[...s.labels].join(", ")}</bim-label>
          </div>`:null}

      ${o.update?rt`
              <bim-button @click=${()=>t({editing:!0})} label="Update Information" icon="tabler:refresh"></bim-button> 
            `:null}
    `,rt`
    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
      ${i?f:p}
    </div>
  `},zk=r=>Be.create(Vk,r),Yk=Object.freeze(Object.defineProperty({__proto__:null,topicInformation:zk},Symbol.toStringTag,{value:"Module"})),Gk=(r,t)=>{const{showInput:e,topic:i,styles:s}=r,n={add:!0,delete:!0,...r.actions},o=`input-${Oi.newRandomId()}`,a=`btn-${Oi.newRandomId()}`,c=`btn-${Oi.newRandomId()}`,l=()=>document.getElementById(a),h=()=>document.getElementById(o),u=()=>{const b=h();return b?b.value.trim().length>0:!1},d=()=>{t({showInput:!0})},f=()=>{const b=h(),E=u();b&&E&&(i.createComment(b.value),t({showInput:!1}))},p=()=>{t({showInput:!1})},m=()=>{const b=l();if(b){if(!h()){b.disabled=!0;return}b.disabled=!u()}},g=rt`
    ${n.add?rt`<bim-button @click=${d} label="Add Comment" icon="majesticons:comment-line"></bim-button>`:null}
  `,I=rt`
    <bim-text-input id=${o} @input=${m} @keypress=${b=>{b.code==="Enter"&&b.ctrlKey&&f()}} type="area"></bim-text-input>

    <div style="justify-content: right; display: flex; gap: 0.375rem">
      <style>
        #${a} {
          background-color: #329936;
        }  

        #${c} {
          background-color: transparent;
        }

        #${c}:hover {
          --bim-label--c: #FF5252;
        }
      </style>

      <bim-button style="flex: 0" id=${c} @click=${p} label="Cancel"></bim-button>
      <bim-button style="flex: 0" id=${a} @click=${f} label="Accept" icon="material-symbols:check" disabled></bim-button>
    </div>
  `,[C]=F_({topic:i,actions:n,styles:s??Ei.users});return rt`
    <div style="display: flex; flex-direction: column; gap: 0.5rem">
      ${C}
      ${e?I:g}
    </div>
  `},Hk=r=>Be.create(Gk,r),$k=Object.freeze(Object.defineProperty({__proto__:null,topicComments:Hk},Symbol.toStringTag,{value:"Module"})),Wk=(r,t)=>{const{components:e,topic:i,linking:s}=r,n=e.get(De),o={link:!0,...r.actions},[a,c]=__({components:e,topics:[...i.relatedTopics].map(d=>n.list.get(d)).map(d=>d)});a.headersHidden=!0,a.hiddenColumns=["Guid","Status","Description","Author","Assignee","Date","DueDate","Type","Priority"];const l=()=>rt`
      <bim-text-input placeholder="Search..." debounce="100" @input=${d=>{const f=d.target;f instanceof ms&&(a.queryString=f.value)}}></bim-text-input> 
    `;let h,u;if(s){a.selectableRows=!0,c({topics:void 0});const d=a.data.filter(I=>{const{Guid:C}=I.data;return typeof C!="string"?!1:i.relatedTopics.has(C)}).map(I=>I.data);a.selection=new Set(d);const f=()=>{const I=[...a.selection].map(({Guid:C})=>typeof C!="string"?null:n.list.has(C)?C:null).map(C=>C);i.relatedTopics.clear(),i.relatedTopics.add(...I),t({linking:!1})},p=()=>{t({linking:!1})},m=`btn-${Oi.newRandomId()}`,g=`btn-${Oi.newRandomId()}`;h=rt`
      <div style="display: flex; gap: 0.25rem">
        <style>
          #${m}:hover {
            background-color: #329936;
          }  

          #${g} {
            background-color: transparent;
          }

          #${g}:hover {
            --bim-label--c: #FF5252;
          }
        </style>
        ${l()}
        <div style="display: flex; justify-content: right; gap: 0.25rem">
          <bim-button id=${g} @click=${p} style="flex: 0" label="Cancel" icon="material-symbols:close"></bim-button>
          <bim-button id=${m} @click=${f} style="flex: 0" label="Accept" icon="material-symbols:check"></bim-button>
        </div>
      </div> 
    `}else{a.selectableRows=!1;const d=()=>{t({linking:!0})};u=rt`
      <div style="display: flex; justify-content: right; gap: 0.25rem">
        ${l()}
        ${o.link?rt`<bim-button style="flex: 0" @click=${d} icon="tabler:link"></bim-button>`:null}
      </div> 
    `}return rt`
    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
      ${u}
      ${h}
      ${a}
    </div> 
  `},jk=r=>Be.create(Wk,r),Xk=Object.freeze(Object.defineProperty({__proto__:null,topicRelations:jk},Symbol.toStringTag,{value:"Module"})),Zk=(r,t)=>{const{components:e,topic:i,world:s,linking:n}=r,o={add:!0,link:!0,selectComponents:!0,colorizeComponent:!0,resetColors:!0,updateCamera:!0,delete:!0,unlink:!0,...r.actions},a=e.get(Zi),[c,l]=O_({components:e,topic:i,actions:o}),h=()=>rt`
      <bim-text-input placeholder="Search..." debounce="100" @input=${f=>{const p=f.target;p instanceof ms&&(c.queryString=p.value)}}></bim-text-input> 
    `;let u,d;if(n){c.selectableRows=!0,l({topic:void 0,actions:{delete:!1,updateCamera:!1,colorizeComponent:!1,resetColors:!1}});const f=c.data.filter(C=>{const{Guid:b}=C.data;return typeof b!="string"?!1:i.viewpoints.has(b)}).map(C=>C.data);c.selection=new Set(f);const p=()=>{const C=[...c.selection].map(({Guid:b})=>typeof b!="string"?null:a.list.has(b)?b:null).map(b=>b);i.viewpoints.clear(),i.viewpoints.add(...C),t({linking:!1})},m=()=>{t({linking:!1})},g=`btn-${Oi.newRandomId()}`,I=`btn-${Oi.newRandomId()}`;u=rt`
      <div style="display: flex; gap: 0.25rem">
        <style>
          #${g}:hover {
            background-color: #329936;
          }  

          #${I} {
            background-color: transparent;
          }

          #${I}:hover {
            --bim-label--c: #FF5252;
          }
        </style>
        ${h()}
        <div style="display: flex; justify-content: right; gap: 0.25rem">
          <bim-button id=${I} @click=${m} style="flex: 0" label="Cancel" icon="material-symbols:close"></bim-button>
          <bim-button id=${g} @click=${p} style="flex: 0" label="Accept" icon="material-symbols:check"></bim-button>
        </div>
      </div> 
    `}else{c.selectableRows=!1,l({topic:i,actions:o});const f=()=>{if(!(i&&s&&o.add&&!n))return;const I=a.create(s);i.viewpoints.add(I.guid)},p=()=>{t({linking:!0})},m=rt`<bim-button style="flex: 0" @click=${f} .disabled=${!s} icon="mi:add"></bim-button>`,g=rt`<bim-button style="flex: 0" @click=${p} icon="tabler:link"></bim-button>`;d=rt`
      <div style="display: flex; justify-content: right; gap: 0.25rem">
        ${h()}
        <div style="display: flex; justify-content: right; gap: 0.25rem">
          ${o.add?m:null}
          ${o.link?g:null}
        </div>
      </div> 
    `}return rt`
    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
      ${d}
      ${u}
      ${c}
    </div> 
  `},qk=r=>Be.create(Zk,r),Qk=Object.freeze(Object.defineProperty({__proto__:null,topicViewpoints:qk},Symbol.toStringTag,{value:"Module"}));({...Yk,...$k,...Xk,...Qk});/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const df=globalThis,E0=df.ShadowRoot&&(df.ShadyCSS===void 0||df.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,C0=Symbol(),Ry=new WeakMap;let x_=class{constructor(r,t,e){if(this._$cssResult$=!0,e!==C0)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=r,this.t=t}get styleSheet(){let r=this.o;const t=this.t;if(E0&&r===void 0){const e=t!==void 0&&t.length===1;e&&(r=Ry.get(t)),r===void 0&&((this.o=r=new CSSStyleSheet).replaceSync(this.cssText),e&&Ry.set(t,r))}return r}toString(){return this.cssText}};const Kk=r=>new x_(typeof r=="string"?r:r+"",void 0,C0),b0=(r,...t)=>{const e=r.length===1?r[0]:t.reduce((i,s,n)=>i+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+r[n+1],r[0]);return new x_(e,r,C0)},Jk=(r,t)=>{if(E0)r.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(const e of t){const i=document.createElement("style"),s=df.litNonce;s!==void 0&&i.setAttribute("nonce",s),i.textContent=e.cssText,r.appendChild(i)}},Ay=E0?r=>r:r=>r instanceof CSSStyleSheet?(t=>{let e="";for(const i of t.cssRules)e+=i.cssText;return Kk(e)})(r):r;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:t9,defineProperty:e9,getOwnPropertyDescriptor:i9,getOwnPropertyNames:s9,getOwnPropertySymbols:n9,getPrototypeOf:r9}=Object,Cc=globalThis,Sy=Cc.trustedTypes,o9=Sy?Sy.emptyScript:"",wy=Cc.reactiveElementPolyfillSupport,gh=(r,t)=>r,Hf={toAttribute(r,t){switch(t){case Boolean:r=r?o9:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,t){let e=r;switch(t){case Boolean:e=r!==null;break;case Number:e=r===null?null:Number(r);break;case Object:case Array:try{e=JSON.parse(r)}catch{e=null}}return e}},T0=(r,t)=>!t9(r,t),_y={attribute:!0,type:String,converter:Hf,reflect:!1,hasChanged:T0};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),Cc.litPropertyMetadata??(Cc.litPropertyMetadata=new WeakMap);class Ba extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??(this.l=[])).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,e=_y){if(e.state&&(e.attribute=!1),this._$Ei(),this.elementProperties.set(t,e),!e.noAccessor){const i=Symbol(),s=this.getPropertyDescriptor(t,i,e);s!==void 0&&e9(this.prototype,t,s)}}static getPropertyDescriptor(t,e,i){const{get:s,set:n}=i9(this.prototype,t)??{get(){return this[e]},set(o){this[e]=o}};return{get(){return s?.call(this)},set(o){const a=s?.call(this);n.call(this,o),this.requestUpdate(t,a,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??_y}static _$Ei(){if(this.hasOwnProperty(gh("elementProperties")))return;const t=r9(this);t.finalize(),t.l!==void 0&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(gh("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(gh("properties"))){const e=this.properties,i=[...s9(e),...n9(e)];for(const s of i)this.createProperty(s,e[s])}const t=this[Symbol.metadata];if(t!==null){const e=litPropertyMetadata.get(t);if(e!==void 0)for(const[i,s]of e)this.elementProperties.set(i,s)}this._$Eh=new Map;for(const[e,i]of this.elementProperties){const s=this._$Eu(e,i);s!==void 0&&this._$Eh.set(s,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const s of i)e.unshift(Ay(s))}else t!==void 0&&e.push(Ay(t));return e}static _$Eu(t,e){const i=e.attribute;return i===!1?void 0:typeof i=="string"?i:typeof t=="string"?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var t;this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),(t=this.constructor.l)==null||t.forEach(e=>e(this))}addController(t){var e;(this._$EO??(this._$EO=new Set)).add(t),this.renderRoot!==void 0&&this.isConnected&&((e=t.hostConnected)==null||e.call(t))}removeController(t){var e;(e=this._$EO)==null||e.delete(t)}_$E_(){const t=new Map,e=this.constructor.elementProperties;for(const i of e.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Jk(t,this.constructor.elementStyles),t}connectedCallback(){var t;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(t=this._$EO)==null||t.forEach(e=>{var i;return(i=e.hostConnected)==null?void 0:i.call(e)})}enableUpdating(t){}disconnectedCallback(){var t;(t=this._$EO)==null||t.forEach(e=>{var i;return(i=e.hostDisconnected)==null?void 0:i.call(e)})}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$EC(t,e){var i;const s=this.constructor.elementProperties.get(t),n=this.constructor._$Eu(t,s);if(n!==void 0&&s.reflect===!0){const o=(((i=s.converter)==null?void 0:i.toAttribute)!==void 0?s.converter:Hf).toAttribute(e,s.type);this._$Em=t,o==null?this.removeAttribute(n):this.setAttribute(n,o),this._$Em=null}}_$AK(t,e){var i;const s=this.constructor,n=s._$Eh.get(t);if(n!==void 0&&this._$Em!==n){const o=s.getPropertyOptions(n),a=typeof o.converter=="function"?{fromAttribute:o.converter}:((i=o.converter)==null?void 0:i.fromAttribute)!==void 0?o.converter:Hf;this._$Em=n,this[n]=a.fromAttribute(e,o.type),this._$Em=null}}requestUpdate(t,e,i){if(t!==void 0){if(i??(i=this.constructor.getPropertyOptions(t)),!(i.hasChanged??T0)(this[t],e))return;this.P(t,e,i)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(t,e,i){this._$AL.has(t)||this._$AL.set(t,e),i.reflect===!0&&this._$Em!==t&&(this._$Ej??(this._$Ej=new Set)).add(t)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[n,o]of this._$Ep)this[n]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[n,o]of s)o.wrapped!==!0||this._$AL.has(n)||this[n]===void 0||this.P(n,this[n],o)}let e=!1;const i=this._$AL;try{e=this.shouldUpdate(i),e?(this.willUpdate(i),(t=this._$EO)==null||t.forEach(s=>{var n;return(n=s.hostUpdate)==null?void 0:n.call(s)}),this.update(i)):this._$EU()}catch(s){throw e=!1,this._$EU(),s}e&&this._$AE(i)}willUpdate(t){}_$AE(t){var e;(e=this._$EO)==null||e.forEach(i=>{var s;return(s=i.hostUpdated)==null?void 0:s.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Ej&&(this._$Ej=this._$Ej.forEach(e=>this._$EC(e,this[e]))),this._$EU()}updated(t){}firstUpdated(t){}}Ba.elementStyles=[],Ba.shadowRootOptions={mode:"open"},Ba[gh("elementProperties")]=new Map,Ba[gh("finalized")]=new Map,wy?.({ReactiveElement:Ba}),(Cc.reactiveElementVersions??(Cc.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let To=class extends Ba{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var r;const t=super.createRenderRoot();return(r=this.renderOptions).renderBefore??(r.renderBefore=t.firstChild),t}update(r){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(r),this._$Do=Ck(t,this.renderRoot,this.renderOptions)}connectedCallback(){var r;super.connectedCallback(),(r=this._$Do)==null||r.setConnected(!0)}disconnectedCallback(){var r;super.disconnectedCallback(),(r=this._$Do)==null||r.setConnected(!1)}render(){return gc}};var Fy;To._$litElement$=!0,To.finalized=!0,(Fy=globalThis.litElementHydrateSupport)==null||Fy.call(globalThis,{LitElement:To});const Oy=globalThis.litElementPolyfillSupport;Oy?.({LitElement:To});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const a9={attribute:!0,type:String,converter:Hf,reflect:!1,hasChanged:T0},c9=(r=a9,t,e)=>{const{kind:i,metadata:s}=e;let n=globalThis.litPropertyMetadata.get(s);if(n===void 0&&globalThis.litPropertyMetadata.set(s,n=new Map),n.set(e.name,r),i==="accessor"){const{name:o}=e;return{set(a){const c=t.get.call(this);t.set.call(this,a),this.requestUpdate(o,c,r)},init(a){return a!==void 0&&this.P(o,void 0,r),a}}}if(i==="setter"){const{name:o}=e;return function(a){const c=this[o];t.call(this,a),this.requestUpdate(o,c,r)}}throw Error("Unsupported decorator location: "+i)};function gi(r){return(t,e)=>typeof e=="object"?c9(r,t,e):((i,s,n)=>{const o=s.hasOwnProperty(n);return s.constructor.createProperty(n,o?{...i,wrapped:!0}:i),o?Object.getOwnPropertyDescriptor(s,n):void 0})(r,t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function l9(r){return gi({...r,state:!0,attribute:!1})}class h9 extends ws{constructor(t=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Ot(.5,.5),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof Element&&e.element.parentNode!==null&&e.element.parentNode.removeChild(e.element)})})}copy(t,e){return super.copy(t,e),this.element=t.element.cloneNode(!0),this.center=t.center,this}}new M;new ht;new ht;new M;new M;class u9{constructor(t,e){this._group=new vo,this._frustum=new tF,this._frustumMat=new ht,this._regenerateDelay=200,this._regenerateCounter=0,this.material=new xi({color:"#2e3338"}),this.numbers=new vo,this.maxRegenerateRetrys=4,this.gridsFactor=5,this._scaleX=1,this._scaleY=1,this._offsetX=0,this._offsetY=0,this._camera=t,this._container=e;const i=this.newGrid(-1),s=this.newGrid(-2);this.grids={main:i,secondary:s},this._group.add(s,i,this.numbers)}set scaleX(t){this._scaleX=t,this.regenerate()}get scaleX(){return this._scaleX}set scaleY(t){this._scaleY=t,this.regenerate()}get scaleY(){return this._scaleY}set offsetX(t){this._offsetX=t,this.regenerate()}get offsetX(){return this._offsetX}set offsetY(t){this._offsetY=t,this.regenerate()}get offsetY(){return this._offsetY}get(){return this._group}dispose(){const{main:t,secondary:e}=this.grids;t.removeFromParent(),e.removeFromParent(),t.geometry.dispose(),t.material.dispose(),e.geometry.dispose(),e.material.dispose()}regenerate(){if(!this.isGridReady()){if(this._regenerateCounter++,this._regenerateCounter>this.maxRegenerateRetrys)throw new Error("Grid could not be regenerated");setTimeout(()=>this.regenerate,this._regenerateDelay);return}this._regenerateCounter=0,this._camera.updateMatrix(),this._camera.updateMatrixWorld();const t=this._frustumMat.multiplyMatrices(this._camera.projectionMatrix,this._camera.matrixWorldInverse);this._frustum.setFromProjectionMatrix(t);const{planes:e}=this._frustum,i=e[0].constant*-e[0].normal.x,s=e[1].constant*-e[1].normal.x,n=e[2].constant*-e[2].normal.y,o=e[3].constant*-e[3].normal.y,a=Math.abs(i-s),c=Math.abs(o-n),{clientWidth:l,clientHeight:h}=this._container,u=Math.max(l,h),d=Math.max(a,c)/u,f=Math.ceil(Math.log10(a/this.scaleX)),p=Math.ceil(Math.log10(c/this.scaleY)),m=10**(f-2)*this.scaleX,g=10**(p-2)*this.scaleY,I=m*this.gridsFactor,C=g*this.gridsFactor,b=Math.ceil(c/C),E=Math.ceil(a/I),T=Math.ceil(c/g),A=Math.ceil(a/m),S=m*Math.ceil(s/m),_=g*Math.ceil(n/g),w=I*Math.ceil(s/I),F=C*Math.ceil(n/C),D=[...this.numbers.children];for(const gt of D)gt.removeFromParent();this.numbers.children=[];const R=[],O=9*d,y=1e4,U=w+this._offsetX,H=Math.round(Math.abs(U/this.scaleX)*y)/y,k=(E-1)*I,X=Math.round(Math.abs((U+k)/this.scaleX)*y)/y,$=Math.max(H,X).toString().length*O;let et=Math.ceil($/I)*I;for(let gt=0;gt<E;gt++){let Ct=w+gt*I;R.push(Ct,o,0,Ct,n,0),Ct=Math.round(Ct*y)/y,et=Math.round(et*y)/y;const lt=Ct%et;if(!(I<1||C<1)&&Math.abs(lt)>.01)continue;const pt=this.newNumber((Ct+this._offsetX)/this.scaleX),mt=12*d;pt.position.set(Ct,n+mt,0)}for(let gt=0;gt<b;gt++){const Ct=F+gt*C;R.push(s,Ct,0,i,Ct,0);const lt=this.newNumber(Ct/this.scaleY);let pt=12;lt.element.textContent&&(pt+=4*lt.element.textContent.length);const mt=pt*d;lt.position.set(s+mt,Ct,0)}const Y=[];for(let gt=0;gt<A;gt++){const Ct=S+gt*m;Y.push(Ct,o,0,Ct,n,0)}for(let gt=0;gt<T;gt++){const Ct=_+gt*g;Y.push(s,Ct,0,i,Ct,0)}const z=new Kt(new Float32Array(R),3),st=new Kt(new Float32Array(Y),3),{main:K,secondary:Q}=this.grids;K.geometry.setAttribute("position",z),Q.geometry.setAttribute("position",st)}newNumber(t){const e=document.createElement("bim-label");e.textContent=String(Math.round(t*100)/100);const i=new h9(e);return this.numbers.add(i),i}newGrid(t){const e=new Ut,i=new Zg(e,this.material);return i.frustumCulled=!1,i.renderOrder=t,i}isGridReady(){const t=this._camera.projectionMatrix.elements;for(let e=0;e<t.length;e++){const i=t[e];if(Number.isNaN(i))return!1}return!0}}var d9=Object.defineProperty,f9=Object.getOwnPropertyDescriptor,Iu=(r,t,e,i)=>{for(var s=f9(t,e),n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&d9(t,e,s),s};const N_=class extends To{constructor(){super(...arguments),this._grid=null,this._world=null,this.resize=()=>{this._world&&this._grid&&this._grid.regenerate()}}set gridColor(t){if(this._gridColor=t,!(t&&this._grid))return;const e=Number(t.replace("#","0x"));Number.isNaN(e)||this._grid.material.color.setHex(e)}get gridColor(){return this._gridColor}set gridScaleX(t){this._gridScaleX=t,t&&this._grid&&(this._grid.scaleX=t)}get gridScaleX(){return this._gridScaleX}set gridScaleY(t){this._gridScaleY=t,t&&this._grid&&(this._grid.scaleY=t)}get gridScaleY(){return this._gridScaleY}get gridOffsetX(){var t;return((t=this._grid)==null?void 0:t.offsetX)||0}set gridOffsetX(t){this._grid&&(this._grid.offsetX=t)}get gridOffsetY(){var t;return((t=this._grid)==null?void 0:t.offsetY)||0}set gridOffsetY(t){this._grid&&(this._grid.offsetY=t)}set components(t){this.dispose();const e=t.get($o).create();this._world=e,e.scene=new NE(t),e.scene.setup(),e.renderer=new IS(t,this);const i=new mp(t);e.camera=i;const s=new u9(i.threeOrtho,this);this._grid=s,e.scene.three.add(s.get()),i.controls.addEventListener("update",()=>s.regenerate()),setTimeout(async()=>{e.camera.updateAspect(),i.set("Plan"),await i.controls.setLookAt(0,0,100,0,0,0),await i.projection.set("Orthographic"),i.controls.dollySpeed=3,i.controls.draggingSmoothTime=.085,i.controls.maxZoom=1e3,i.controls.zoom(4)})}get world(){return this._world}dispose(){var t;(t=this.world)==null||t.dispose(),this._world=null,this._grid=null}connectedCallback(){super.connectedCallback(),new ResizeObserver(this.resize).observe(this)}disconnectedCallback(){super.disconnectedCallback(),this.dispose()}render(){return I0`<slot></slot>`}};N_.styles=b0`
    :host {
      position: relative;
      display: flex;
      min-width: 0px;
      height: 100%;
      background-color: var(--bim-ui_bg-base);
    }
  `;let gu=N_;Iu([gi({type:String,attribute:"grid-color",reflect:!0})],gu.prototype,"gridColor");Iu([gi({type:Number,attribute:"grid-scale-x",reflect:!0})],gu.prototype,"gridScaleX");Iu([gi({type:Number,attribute:"grid-scale-y",reflect:!0})],gu.prototype,"gridScaleY");Iu([gi({type:Number,attribute:"grid-offset-x",reflect:!0})],gu.prototype,"gridOffsetX");Iu([gi({type:Number,attribute:"grid-offset-y",reflect:!0})],gu.prototype,"gridOffsetY");var p9=Object.defineProperty,Yr=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&p9(t,e,s),s};const P_=class extends To{constructor(){super(...arguments),this._defaults={size:60},this._cssMatrix3D="",this._matrix=new ht,this._onRightClick=new Event("rightclick"),this._onLeftClick=new Event("leftclick"),this._onTopClick=new Event("topclick"),this._onBottomClick=new Event("bottomclick"),this._onFrontClick=new Event("frontclick"),this._onBackClick=new Event("backclick"),this._camera=null,this._epsilon=t=>Math.abs(t)<1e-10?0:t}set camera(t){this._camera=t,this.updateOrientation()}get camera(){return this._camera}updateOrientation(){if(!this.camera)return;this._matrix.extractRotation(this.camera.matrixWorldInverse);const{elements:t}=this._matrix;this._cssMatrix3D=`matrix3d(
      ${this._epsilon(t[0])},
      ${this._epsilon(-t[1])},
      ${this._epsilon(t[2])},
      ${this._epsilon(t[3])},
      ${this._epsilon(t[4])},
      ${this._epsilon(-t[5])},
      ${this._epsilon(t[6])},
      ${this._epsilon(t[7])},
      ${this._epsilon(t[8])},
      ${this._epsilon(-t[9])},
      ${this._epsilon(t[10])},
      ${this._epsilon(t[11])},
      ${this._epsilon(t[12])},
      ${this._epsilon(-t[13])},
      ${this._epsilon(t[14])},
      ${this._epsilon(t[15])})
    `}render(){const t=this.size??this._defaults.size;return I0`
      <style>
        .face,
        .cube {
          width: ${t}px;
          height: ${t}px;
          transform: translateZ(-300px) ${this._cssMatrix3D};
        }

        .face-right {
          translate: ${t/2}px 0 0;
        }

        .face-left {
          translate: ${-t/2}px 0 0;
        }

        .face-top {
          translate: 0 ${t/2}px 0;
        }

        .face-bottom {
          translate: 0 ${-t/2}px 0;
        }

        .face-front {
          translate: 0 0 ${t/2}px;
        }

        .face-back {
          translate: 0 0 ${-t/2}px;
        }
      </style>
      <div class="parent">
        <div class="cube">
          <div
            class="face x-direction face-right"
            @click=${()=>this.dispatchEvent(this._onRightClick)}
          >
            ${this.rightText}
          </div>
          <div
            class="face x-direction face-left"
            @click=${()=>this.dispatchEvent(this._onLeftClick)}
          >
            ${this.leftText}
          </div>
          <div
            class="face y-direction face-top"
            @click=${()=>this.dispatchEvent(this._onTopClick)}
          >
            ${this.topText}
          </div>
          <div
            class="face y-direction face-bottom"
            @click=${()=>this.dispatchEvent(this._onBottomClick)}
          >
            ${this.bottomText}
          </div>
          <div
            class="face z-direction face-front"
            @click=${()=>this.dispatchEvent(this._onFrontClick)}
          >
            ${this.frontText}
          </div>
          <div
            class="face z-direction face-back"
            @click=${()=>this.dispatchEvent(this._onBackClick)}
          >
            ${this.backText}
          </div>
        </div>
      </div>
    `}};P_.styles=b0`
    :host {
      position: absolute;
      z-index: 999;
      bottom: 1rem;
      right: 1rem;
    }

    .parent {
      perspective: 400px;
    }

    .cube {
      position: relative;
      transform-style: preserve-3d;
    }

    .face {
      position: absolute;
      display: flex;
      justify-content: center;
      user-select: none;
      align-items: center;
      cursor: pointer;
      text-align: center;
      transition: all 0.2s;
      color: var(--bim-view-cube--c, white);
      font-size: var(--bim-view-cube--fz, --bim-ui_size-2xl);
    }

    .x-direction {
      // background-color: var(--bim-view-cube_x--bgc, #c93830DD);
      background-color: var(--bim-view-cube_x--bgc, #01a6bcde);
    }

    .x-direction:hover {
      background-color: var(--bim-ui_accent-base, white);
    }

    .y-direction {
      // background-color: var(--bim-view-cube_y--bgc, #54ff19DD);
      background-color: var(--bim-view-cube_y--bgc, #8d0ec8de);
    }

    .y-direction:hover {
      background-color: var(--bim-ui_accent-base, white);
    }

    .z-direction {
      // background-color: var(--bim-view-cube_z--bgc, #3041c9DD);
      background-color: var(--bim-view-cube_z--bgc, #2718afde);
    }

    .z-direction:hover {
      background-color: var(--bim-ui_accent-base, white);
    }

    .face-front {
      transform: rotateX(180deg);
    }

    .face-back {
      transform: rotateZ(180deg);
    }

    .face-top {
      transform: rotateX(90deg);
    }

    .face-bottom {
      transform: rotateX(270deg);
    }

    .face-right {
      transform: rotateY(-270deg) rotateX(180deg);
    }

    .face-left {
      transform: rotateY(-90deg) rotateX(180deg);
    }
  `;let Gr=P_;Yr([gi({type:Number,reflect:!0})],Gr.prototype,"size");Yr([gi({type:String,attribute:"right-text",reflect:!0})],Gr.prototype,"rightText");Yr([gi({type:String,attribute:"left-text",reflect:!0})],Gr.prototype,"leftText");Yr([gi({type:String,attribute:"top-text",reflect:!0})],Gr.prototype,"topText");Yr([gi({type:String,attribute:"bottom-text",reflect:!0})],Gr.prototype,"bottomText");Yr([gi({type:String,attribute:"front-text",reflect:!0})],Gr.prototype,"frontText");Yr([gi({type:String,attribute:"back-text",reflect:!0})],Gr.prototype,"backText");Yr([l9()],Gr.prototype,"_cssMatrix3D");var m9=Object.defineProperty,I9=(r,t,e,i)=>{for(var s=void 0,n=r.length-1,o;n>=0;n--)(o=r[n])&&(s=o(t,e,s)||s);return s&&m9(t,e,s),s};const L_=class extends To{constructor(){super(...arguments),this.world=null,this._components=null,this._viewport=Xg()}set components(t){var e;if(this._components=t,this.components){const i=this.components.get($o);this.world=i.create(),this.world.name=this.name}else(e=this.world)==null||e.dispose(),this.world=null}get components(){return this._components}connectedCallback(){super.connectedCallback(),this.world&&(this.world.enabled=!0)}disconnectedCallback(){super.disconnectedCallback(),this.world&&(this.world.enabled=!1)}dispose(){this.components=null,this.remove()}firstUpdated(){const{value:t}=this._viewport;if(!(this.components&&t&&this.world))return;const e=new NE(this.components);this.world.scene=e,e.setup(),e.three.background=null;const i=new ce(this.components,t);this.world.renderer=i;const{postproduction:s}=i,n=new mp(this.components);this.world.camera=n;const o=this.components.get(PE).create(this.world);o.material.uniforms.uColor.value=new Rt(4342338),o.material.uniforms.uSize1.value=2,o.material.uniforms.uSize2.value=8,s.enabled=!0,s.customEffects.excludedMeshes.push(o.three),s.setPasses({custom:!0,ao:!0,gamma:!0}),s.customEffects.lineColor=1513756}onSlotChange(){const t=new Event("slotchange");this.dispatchEvent(t)}render(){return I0` <bim-viewport ${Fk(this._viewport)}>
      <slot @slotchange=${this.onSlotChange}></slot>
    </bim-viewport>`}};L_.styles=b0``;let g9=L_;I9([gi({type:String,reflect:!0})],g9.prototype,"name");async function E9(){const r=re.get(Bt);if(!yo)return;const t=r.export(yo),e=new Blob([t]),i=URL.createObjectURL(e),s=document.createElement("a");s.href=i,s.download="model_fragments.frag",s.click(),URL.revokeObjectURL(i)}async function C9(){const r=document.createElement("input");r.type="file",r.accept=".frag";const t=new FileReader;t.addEventListener("load",()=>{const e=t.result;if(!(e instanceof ArrayBuffer))return;const i=new Uint8Array(e);re.get(Bt).load(i)}),r.addEventListener("change",()=>{const e=r.files;e&&t.readAsArrayBuffer(e[0])}),r.click()}function b9(){const r=re.get(Bt);for(const[,t]of r.groups)r.disposeGroup(t);yo=void 0}async function T9(r){await re.get(pe).process(r);const e=re.get(Fh);await e.bySpatialStructure(r),e.byEntity(r),xy&&xy({classifications:[{system:"entities",label:"Entities"},{system:"spatialStructures",label:"Spatial Structures"}]})}async function y9(){if(!yo)return;const t=re.get(Xc).selection.select,e=re.get(pe);if(Object.keys(t).length!==0)for(const i in t){const s=t[i];for(const n of s){const o=e.getEntityRelations(yo,n,"IsDefinedBy");if(o)for(const a of o){const c=await yo.getProperties(a);console.log(c)}}}}function v9(){const r=re.get(Xc),t=re.get(Bt),e=r.selection.select;if(Object.keys(e).length!==0)for(const i in e){const s=t.list.get(i),n=e[i];for(const o of n){if(!s)continue;s.hiddenItems.has(o)?s.setVisibility(!0,[o]):s.setVisibility(!1,[o])}}}function R9(){const r=re.get(Xc),t=re.get(eu),e=r.selection.select;t.isolate(e)}function A9(){re.get(eu).set(!0)}function S9(){Si&&(Si.layout!=="classifier"?Si.layout="classifier":Si.layout="main")}function w9(){Si&&(Si.layout="world")}let yo;const y0=document.getElementById("viewer-container"),re=new xE,_9=re.get($o),[F9,xy]=g0.classificationTree({components:re,classifications:[]}),os=_9.create();os.scene=new NE(re);os.renderer=new ce(re,y0);os.camera=new mp(re);re.init();os.renderer.postproduction.enabled=!0;os.camera.controls.setLookAt(12,6,8,0,0,-10);os.camera.updateAspect();os.scene.setup();const O9=re.get(PE);O9.create(os);const x9=re.get(Bt),M_=re.get(DE);await M_.setup();x9.onFragmentsLoaded.add(async r=>{os.scene.three.add(r),r.hasProperties&&await T9(r),yo=r});const D_=re.get(Xc);D_.setup({world:os});D_.zoomToSelection=!0;y0.addEventListener("resize",()=>{os.renderer?.resize(),os.camera.updateAspect()});M_.settings.webIfc.COORDINATE_TO_ORIGIN=!0;gE.init();const Si=Ln.create(()=>Tt`
      <bim-grid
          floating
          style="padding: 20px"
      ></bim-grid>
  `),N9=Ln.create(()=>{const[r,t]=g0.elementProperties({components:re,fragmentIdMap:{}}),e=re.get(Xc);return e.events.select.onHighlight.add(s=>{Si&&(Si.layout="secondary",t({fragmentIdMap:s}),r.expanded=!1)}),e.events.select.onClear.add(()=>{t({fragmentIdMap:{}}),Si&&(Si.layout="main")}),Tt`
      <bim-panel>
          <bim-panel-section name="property" label="Property Information" icon="solar:document-bold" fixed>
              <bim-text-input @input=${s=>{const n=s.target;r.queryString=n.value}} placeholder="Search..."></bim-text-input>
              ${r}
          </bim-panel-section>
      </bim-panel>
  `}),P9=Ln.create(()=>Tt`
      <bim-panel style="width: 400px;">
          <bim-panel-section name="classifier" label="Classifier" icon="solar:document-bold" fixed>
              <bim-label>Classifications</bim-label>
              ${F9}
          </bim-panel-section>
      </bim-panel>
  `),L9=Ln.create(()=>{const[r]=g0.worldsConfiguration({components:re});return Tt`
      <bim-panel>
          <bim-panel-section name="world" label="World Information" icon="solar:document-bold" fixed>
              <bim-text-input @input=${e=>{const i=e.target;r.queryString=i.value}} placeholder="Search..."></bim-text-input>
              ${r}
          </bim-panel-section>
      </bim-panel>
  `}),Hd=Ln.create(()=>{const[r]=v7.loadIfc({components:re});return r.tooltipTitle="Load IFC",r.label="",Tt`
    <bim-toolbar style="justify-self: center;">
      <!-- Importing IFC files -->
      <bim-toolbar-section label="Import">
        ${r}
      </bim-toolbar-section>
      <!-- Fragments -->
      <bim-toolbar-section label="Fragments">
        <bim-button tooltip-title="Import" icon="mdi:cube" @click=${C9}></bim-button>
        <bim-button tooltip-title="Export" icon="tabler:package-export" @click=${E9}></bim-button>
        <bim-button tooltip-title="Dispose" icon="tabler:trash" @click=${b9}></bim-button>
        <!-- TO DO: there is to add two more buttons to export and import properties from IFC Files -->
      </bim-toolbar-section>
      <!-- Selection Buttons -->
      <bim-toolbar-section label="Selection">
        <bim-button tooltip-title="Visibility" icon="mdi:eye" @click=${v9}></bim-button>
        <bim-button tooltip-title="Isolate" icon="mdi:filter" @click=${R9}></bim-button>
        <bim-button tooltip-title="Show all" icon="tabler:eye-filled" @click=${A9}></bim-button>
      </bim-toolbar-section>
      <!-- Properties -->
      <bim-toolbar-section label="Properties">
        <bim-button tooltip-title="Show" icon="clarity:list-line" @click=${y9}></bim-button>
      </bim-toolbar-section>
      <!-- Groups -->
      <bim-toolbar-section label="Groups">
        <bim-button tooltip-title="Classifier" icon="tabler:eye-filled" @click=${S9}></bim-button>
      </bim-toolbar-section>
      <!-- World Update -->
      <bim-toolbar-section label="App">
        <bim-button tooltip-title="World" icon="tabler:brush" @click=${w9}></bim-button>
      </bim-toolbar-section>
    </bim-toolbar>
  `});Si.layouts={main:{template:`
          "empty" 1fr
          "toolbar" auto
          /1fr
      `,elements:{toolbar:Hd}},secondary:{template:`
        "empty elementPropertyPanel" 1fr
        "toolbar toolbar" auto
        /1fr 20rem
    `,elements:{toolbar:Hd,elementPropertyPanel:N9}},world:{template:`
        "empty worldPanel" 1fr
        "toolbar toolbar" auto
        /1fr 20rem
    `,elements:{toolbar:Hd,worldPanel:L9}},classifier:{template:`
        "empty classifierPanel" 1fr
        "toolbar toolbar" auto
        /1fr 20rem
    `,elements:{toolbar:Hd,classifierPanel:P9}}};Si.layout="main";y0.appendChild(Si);
//# sourceMappingURL=index-DDDQdttx.js.map
